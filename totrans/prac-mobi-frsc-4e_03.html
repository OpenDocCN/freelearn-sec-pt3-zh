<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Understanding the Internals of iOS Devices</h1>
                </header>
            
            <article>
                
<p class="mce-root"><span>According to Apple, there were 1.4 billion active Apple devices in 2019, 900 million of which were running on iOS. While iOS is the leading <strong>operating system</strong> (<strong>OS</strong>) for tablets worldwide, Android continues to be the leading OS for smartphones. Regardless of the statistics, if you are a forensic examiner, the chances are that you will need to conduct an examination of an iOS device.</span></p>
<p class="p1">In order to perform a forensic examination of an iOS device, you as the examiner must understand the internal components and inner workings of that device. Developing an understanding of the underlying components of a mobile device will help you understand the criticalities involved in the forensic process, including what data can be acquired, where the data is stored, and what methods can be used to access the data from that device. So, before we delve into the examination of iOS devices, it is necessary to gain an understanding of the different models that exist and their internal components. Throughout this book, we will perform forensic acquisition and analysis on iOS devices, including the iPhone, iPad, and Apple Watch.</p>
<p class="p1">The goal of this chapter is to introduce you to iOS device technology. We will cover details that may often get overlooked but will help you during your forensic investigation. You must understand the different iOS devices and how data is stored on these devices before you can successfully extract it.</p>
<p class="p1">In this chapter, we will cover the following topics in detail:</p>
<ul>
<li>iPhone models and hardware</li>
<li>iPad models and hardware</li>
<li>The <strong>Hierarchical File System</strong> (<strong>HFS</strong>) Plus and <strong>Apple File System</strong> (<strong>APFS</strong>) filesystems </li>
<li>The iPhone OS</li>
</ul>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">iPhone models and hardware</h1>
                </header>
            
            <article>
                
<p class="p1">The iPhone is among the most popular smartphones on the market. Apple released the first-generation iPhone in June 2007. Since the first release, the iPhone became extremely popular due to its many groundbreaking features and usability. The introduction of the iPhone has since redefined the entire world of mobile computing. Consumers have started looking for faster and more efficient phones. Various iPhone models now exist, with different features and storage capabilities to serve consumer requirements.</p>
<p><span>The iPhones released since the third edition of <em>Practical Mobile Forensics—</em>the iPhone XR, XS, XS Max, 11, and 11 Pro—can be challenging when it comes to dealing with filesystem forensic acquisition methods. Just like the devices released since the iPhone 5, there is no method or tool available to physically recover data from these devices, unless they are jailbroken. However, logical acquisition can be obtained if the iPhone is unlocked. Acquisition methods for data extraction are available and will be discussed in <a href="6bdeccbc-e651-43f3-b5ed-4e6d071adec6.xhtml">Chapter 3</a>, <em>Data Acquisition from iOS Devi</em></span><span><em>ces</em>, and <a href="f082adcc-6892-4e66-80cc-49b9752cb56a.xhtml" target="_blank">Chapter 4</a>, <em>Data Acquisition from iOS Backups</em>. Now, let's learn how to identify the correct hardware model.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Identifying the correct hardware model</h1>
                </header>
            
            <article>
                
<p><span>Before examining an iPhone, it is necessary to identify the correct</span> hardware <span>model and the firmware version installed on the device. Knowing the iPhone's details helps you to understand the criticalities and possibilities of obtaining evidence from an iPhone. For example, in many cases, the device passcode is required in order to obtain a logical image. Depending on the iOS version, device model, and passcode complexity, it may be possible to obtain the device passcode using a brute-force attack.</span></p>
<p><span>There are various ways to identify the hardware of a device. The easiest way to identify the hardware of some devices is to observe the </span>m<span>odel number </span><span>displayed on the back of the device. To make this task even simpler, you can use Apple's Knowledge Base articles. More information on iPhone models can be found at</span> <a href="https://support.apple.com/en-in/HT201296">https://support.apple.com/en-in/HT201296</a><span>.</span></p>
<p><span>The firmware version of an iPhone can be found by accessing the</span> <span><span class="packt_screen">Settings</span></span> <span>option and then navigating to</span> <span class="packt_screen">General</span> | <span class="packt_screen">About</span> | <span class="packt_screen">Software </span><span class="packt_screen">Version</span><span>,</span> <span>as shown in the following screenshot. The purpose of the firmware is to enable certain features and assist with the general functioning of the device:</span></p>
<p class="mce-root"/>
<p class="CDPAlignCenter CDPAlign"><img src="assets/bc3b21fd-b272-4a8a-8982-08baade4747f.png" style="width:21.17em;height:17.25em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The iPhone About screen, displaying the software version 13.2</span></div>
<p><span>Alternatively, the <kbd>ideviceinfo</kbd> command-line tool that is available in the</span> <kbd><span>libimobiledevice</span></kbd> <span>software library (<a href="http://www.libimobiledevice.org/">http://www.libimobiledevice.org/</a></span><span>) can be used to identify the iPhone model</span> and <span>its iOS version.</span></p>
<p><span>To obtain the iPhone model and its iOS version information on a Windows 10 workstation, follow these steps:</span></p>
<ol>
<li><span>Download the latest binaries from the following link: <a href="https://dev.azure.com/libimobiledevice-win32/imobiledevice-net/_build/results?buildId=419">https://dev.azure.com/libimobiledevice-win32/imobiledevice-net/_build/results?buildId=419 </a>(click on <span class="packt_screen">Artifacts</span></span> | <span class="packt_screen">B</span><span><span class="packt_screen">inaries</span> to start downloading).</span></li>
<li><span>Unzip the archive with x86 or x64 binaries, depending on your workstation's version.</span></li>
<li>Open Command Prompt and change the directory to the one with binaries (use the <kbd>cd</kbd> command for this).</li>
<li><span>Connect the iPhone to your workstation using a <strong>Universal Serial Bus</strong> (<strong>USB</strong>) cable (for the latest iOS versions, the passcode is also required), and run the</span> <kbd><span>ideviceinfo</span></kbd> <span>command with the</span> <kbd><span>-s</span></kbd> <span>option, as shown in the following code:</span></li>
</ol>
<pre style="padding-left: 60px"><span><strong>$ ideviceinfo -s</strong></span></pre>
<p class="mce-root"/>
<p style="padding-left: 30px"><span>The output of the</span> <kbd><span>ideviceinfo</span></kbd> <span>command displays the iPhone identifier, its internal name, and the iOS version, as shown in the following screenshot:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/8642f4eb-7700-451f-ace7-986d9a784c55.png" style="width:38.83em;height:29.17em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The output from ideviceinfo displaying firmware version 13.2</span></div>
<p><span>Some other tools, such as</span> iExplorer<span>, will provide</span> access <span>to similar iOS device information, as shown in the following screenshot. The methods for recovering</span> iPhone <span>device information will work on iPad devices as well. Here, iExplorer is being used to obtain device information from an iPhone:</span></p>
<p> </p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/cf7c4110-5f8a-40c6-b0ad-efe2a81a3b9d.png" style="width:15.67em;height:22.67em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>iExplorer displaying device info</span></div>
<p><span>Every release of the iPhone comes with improved or newly added features. As previously </span><span>stated in this chapter, knowing the iPhone's details helps you to understand the criticalities and possibilities of obtaining evidence from it. You must know the model of the device to ensure that the tools and methodologies being deployed support that particular iPhone. Additionally, the internal storage size of the iPhone must be determined to ensure that the evidence container is large enough for the entire forensic image. Most tools will not alert you if there is not enough disk space on the evidence drive until space has run out. This will waste time and force you to acquire the device a second time. Finally, the network capabilities of the device must also be noted so that you can properly isolate the device to prevent remote accessing or wiping during the examination. This will be discussed further in</span> <a href="6bdeccbc-e651-43f3-b5ed-4e6d071adec6.xhtml">Chapter 3</a>, <em>Data Acquisition from iOS Devices</em><span>.</span></p>
<p>Again, some familiarity with iPhone device hardware will aid you in determining how to handle the device during a forensic investigation. Certain models enforce full-disk encryption, while older models do not. Encrypted devices require additional steps during an acquisition—if access is even possible. You must be prepared for all hurdles you may be required to clear during the acquisition and analytical stages of the investigation. In addition to this, knowing the capabilities that the iPhone has—and the initial and current iOS version—makes a difference in the data you will be able to recover from the device. Apple is not consistent with data storage locations across iOS versions. Therefore, you must know the original version installed when the phone was first in use to ensure that the forensic tools do not overlook data that could aid in the investigation. </p>
<p><span>More information about identifying iPhone models can be found at </span><a href="https://support.apple.com/en-us/HT201296">https://support.apple.com/en-us/HT201296</a><span>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Understanding the iPhone hardware</h1>
                </header>
            
            <article>
                
<p><span>The iPhone is a collection of modules, chips, and electronic components from different manufacturers. Due to the complexities of the iPhone, the list of hardware components is extensive, and each device should be researched for internal components. </span></p>
<p>For example, the iPhone 11 has an A13 Bionic processor; <span>64 GB, 128 GB, or 256 GB storage; 4 GB of RAM; a 6.1-inch Liquid Retina <strong>liquid-crystal display</strong> (<strong>LCD</strong>); and a dual-lens 12 MP rear camera array.</span></p>
<p><span>Internal images for all iPhones can be found in the teardown section of</span> <a href="https://www.ifixit.com/Device/iPhone">https://www.ifixit.com/Device/iPhone</a><span>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">iPad models and hardware</h1>
                </header>
            
            <article>
                
<p><span>The Apple iPhone changed the way cell phones are produced and used. Similarly, the iPad, a version of the tablet computer introduced in January 2010, quashed the sales of notebooks. With the iPad, individuals can shoot videos, take photos, play music, read books, browse the internet, and do much more. Various iPad models now exist—for example, iPad Air 3 and iPad Pro—with different features and storage capabilities. More information on identifying iPad models can be found at</span> <a href="https://support.apple.com/en-in/HT201471">https://support.apple.com/en-in/HT201471</a><span>.</span></p>
<p><span>As with the iPhone, not all versions of the iPad are supported for filesystem acquisition. Additionally, Apple changes data storage locations in iOS versions, which affects iPad devices as well. You must be aware of the different models, the released and currently installed iOS version, the storage capability, the network access vectors, and more.</span></p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Understanding the iPad hardware</h1>
                </header>
            
            <article>
                
<p><span>One of the key factors of the success of Apple iOS devices is the proper selection of their hardware components. Just like the iPhone, the iPad is also a collection of modules, chips, and electronic components from different manufacturers. Internal images for all iPads can be found in the teardown section of</span> <a href="https://www.ifixit.com/Device/iPad">https://www.ifixit.com/Device/iPad</a><span>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The HFS Plus and APFS filesystems</h1>
                </header>
            
            <article>
                
<p><span>To better understand the forensic process of an iOS device, it is useful to know about the filesystem that is used. Originally, the filesystem used in the iPhone and other Apple iOS devices was</span> <span>HFSX. This is</span> <span>a variation of</span> <span>HFS Plus,</span> <span>with one major difference. HFSX is case-sensitive, whereas HFS Plus is case-insensitive. Other differences will be discussed later in this chapter</span><span>. APFS was introduced in June 2016 as a replacement for HFS Plus and became the default filesystem for iOS devices with the release of iOS 10.3, and for macOS devices with the release of macOS 10.13.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The HFS Plus filesystem</h1>
                </header>
            
            <article>
                
<p>In 1996, Apple developed a new filesystem, HFS, to accommodate the storage of large datasets. In an HFS filesystem, the storage medium is represented as volumes. HFS volumes are divided into logical blocks of 512 bytes. The logical blocks are numbered from first to last on a given volume and will remain static with the same size as physical blocks—that is, 512 bytes. These logical blocks are grouped together into allocation blocks, which are used by the HFS filesystem to track data in a more efficient way. HFS uses a 16-bit value to address allocation blocks, which limits the number of allocation blocks to 65,535. To overcome the inefficient allocation of disk space and some of the limitations of HFS, Apple introduced the HFS Plus filesystem (<a href="http://dubeiko.com/development/FileSystems/HFSPLUS/tn1150.html">http://dubeiko.com/development/FileSystems/HFSPLUS/tn1150.html</a>).</p>
<p>The HFS Plus filesystem was designed to support larger file sizes. Sectors on HFS volumes are usually 512 bytes in size. These sectors form allocation blocks. The number of such blocks depends on the size of the volume. HFS Plus uses block addresses of 32 bits to address allocation blocks. HFS Plus uses <em>journaling</em> by default. Journaling is the process of logging every transaction to the disk, which helps prevent filesystem corruption. The key characteristics of the HFS Plus filesystem include the following: efficient use of disk space, Unicode support for filenames, support for name forks, file compression, journaling, dynamic resizing, dynamic defragmentation, and an ability to boot on OSes other than macOS.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The HFS Plus volume</h1>
                </header>
            
            <article>
                
<p><span>The HFS Plus volume contains a number of internal structures to manage the organization of data. These structures include a header, an alternate header, and five special files: an allocation file, an extents overflow file, a catalog file, an attributes file, and a startup file. Among the five files, three files (the extents overflow file, the catalog file, and the attributes file) use a B-Tree structure. This is a data structure that allows data to be efficiently searched, viewed, modified, or removed. The HFS Plus volume structure is shown in the following diagram:</span></p>
<p> </p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/e433c31a-7e4d-40b6-a58a-756e53a09081.png" style="width:22.92em;height:35.42em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The HFS Plus volume structure</span></div>
<p><span>The volume structure is described as follows:</span></p>
<ul>
<li><span><span class="packt_screen">Reserved (1024 bytes)</span>: This is reserved for bootloader information.</span></li>
<li><strong><span class="packt_screen">Volume Header</span></strong><span>: This stores volume information, such as the size of allocation blocks, a timestamp of when the volume was created, and metadata about each of the five special files.</span></li>
<li><strong><span class="packt_screen">Allocation File</span></strong>: This file is used to track which allocation blocks are in use by the system. The file format consists of <span>1</span> bit for every allocation block. If the bit is set, the block is in use. If it is not set, the block is free.</li>
<li><strong><span class="packt_screen">Extents Overflow File</span></strong><span><span>: This file records the allocation blocks that are allocated when the file size exceeds eight blocks, which helps in locating the actual data when referred. Bad blocks are also recorded in the file.</span></span></li>
<li><strong><span class="packt_screen">Catalog File</span></strong><span>: This file contains information about the hierarchy of files and folders, which is used to locate any file and folder within the volume.</span></li>
<li><strong><span class="packt_screen">Attributes File</span></strong><span>: This file contains inline data attribute records, fork data attribute records, and extension attribute records.</span></li>
<li><strong><span class="packt_screen">Startup File</span></strong><span>: This file contains the information needed to assist in booting a system that does not have HFS Plus support.</span></li>
<li><span class="packt_screen">Alternate Volume Header</span><span>: This is a backup of the volume header, and it's mainly used for disk repairing.</span></li>
<li><span class="packt_screen">Reserved (512 bytes)</span><span>: This is reserved for use by Apple, and it is used during the manufacturing process.</span></li>
</ul>
<p>Next, let's look at the APFS filesystem.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The APFS filesystem</h1>
                </header>
            
            <article>
                
<p>APFS is a new filesystem for <span>iOS, macOS, tvOS, and watchOS. It </span>is a 64-bit filesystem and supports over 9 quintillion files on a single volume. The following is a list of its main features:</p>
<ul>
<li><strong>Clones</strong>: These are i<span>nstantaneous</span> <span>copies of files or directories. Modifications are written elsewhere and continue to share the unmodified blocks; the changes are saved as deltas of the cloned file.</span></li>
<li><strong>Snapshots</strong>: <span><span><strong>Point-in-Time</strong> (<strong>PIT</strong>) read-only instances of the filesystem.</span></span></li>
<li><strong>Space sharing</strong>: <span>This a</span><span><span><span>llows multiple filesystems to share the same underlying free space on a physical volume.</span></span></span></li>
<li><strong>Encryption</strong>: <span>T</span>here are three modes, as follows:
<ul>
<li>No encryption</li>
<li>Single-key encryption</li>
<li>Multi-key encryption with per-file keys for file data and a separate key for sensitive metadata</li>
</ul>
</li>
</ul>
<p style="padding-left: 60px">Depending on the hardware, the <strong>Advanced Encryption Standard-XEX-based tweaked codebook mode with ciphertext stealing</strong> (<span><strong>AES-XTS</strong>) or the <strong>Advanced Encryption Standard</strong><strong>-Cipher Blocker Chaining</strong> (<strong>AES-CBC</strong>) encryption mode is used.</span></p>
<ul>
<li><strong>Crash protection</strong>: This is a <span>novel copy-on-write metadata scheme; it's used to ensure that filesystem updates are crash-protected.</span></li>
<li class="jump"><strong>Sparse files</strong>: <span>These a</span>llow the logical size of files to be greater than the physical space they occupy on the disk.</li>
<li class="jump"><strong>Fast directory sizing</strong>: <span>This q</span><span>uickly computes the total space used by a directory hierarchy, allowing it to be updated as the hierarchy evolves.</span></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The APFS structure</h1>
                </header>
            
            <article>
                
<p>So, APFS is structured in a single container that may contain one or more volumes. The APFS structure is presented in the following diagram:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1321 image-border" src="assets/99f50f83-528f-4476-b8d0-6a5291f5f114.png" style="width:39.92em;height:20.92em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Overview of the APFS structure</div>
<p><span>Each filesystem structure in APFS starts with a block header. The block header starts with a checksum (Fletcher's checksum algorithm is used) for the whole block and also contains the copy-on-write version of the block, the block ID, and the block type.</span></p>
<p>The APFS structure can be explained as follows:</p>
<ul>
<li><span>The <span class="packt_screen">Container Superblock</span> contains information on the block size, the number of blocks and pointers to the space manager for this task, the block IDs of all volumes, and a pointer to a block map B-Tree (which contains entries for each volume, along with its ID and offset).</span></li>
<li><span><strong>Nodes</strong> are used for storing different kinds of entries. They can be part of a B-Tree or exist on their own and can contain either flexible or fixed-sized entries.</span></li>
<li><span>The <span class="packt_screen">Space Man(ager)</span> manages the allocated blocks in the APFS container, and stores the number of free blocks and a pointer to the <span class="packt_screen">Allocation Info File</span>.</span></li>
<li>The <span class="packt_screen"><span><strong>A</strong></span><strong>llocation Info File</strong></span> stores t<span>he allocation file's length, version, and the offset.</span></li>
<li><span>The <strong>B-Trees</strong> manage multiple nodes and contain the offset of the root node.</span></li>
<li><span>A <strong><span class="packt_screen">Volume Superblock</span></strong> contains the name of the volume, its ID, and a timestamp.</span></li>
</ul>
<p><span>As for allocation files, they are simple bitmaps and do not have a block header and type ID.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Disk layout</h1>
                </header>
            
            <article>
                
<p><span>By default, the filesystem is configured as two logical disk partitions: the system (root or firmware) partition and the user data partition.</span></p>
<p><span>The system partition contains the OS and all of the preloaded applications used with the iPhone. The system partition is mounted as read-only unless an OS upgrade is in progress or the device is jailbroken. The partition is updated only when a firmware upgrade is performed on the device. During this process, the entire partition is formatted by iTunes without affecting any of the user data. The system partition takes only a small portion of storage space, normally between 0.8 GB and 4 GB, depending on the size of the NAND drive. As the system partition was designed to remain in a factory state for the entire lifetime of the iPhone, there is typically little useful evidentiary information that can be obtained from it. If the iOS device is jailbroken, the files containing information regarding the jailbreak and user data may be resident on the system partition. Jailbreaking an iOS device allows the user root access to the device, but voids the manufacturer warranty. Jailbreaking will be discussed later in this chapter.</span></p>
<p class="mce-root"/>
<p><span>The user data partition contains all the user-created data, ranging from music and contacts to third-party application data. The user data partition occupies most of the NAND memory and is mounted to the</span> <kbd><span>/private/var</span></kbd> directory <span>on the device. Most of the evidentiary information can be found in this partition. During a filesystem acquisition, the user data partition contents should be captured and saved as a</span> <kbd><span>.tar</span></kbd> <span>file. Acquired data can be easily extracted and parsed by most commercial mobile forensic tools.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The iPhone OS</h1>
                </header>
            
            <article>
                
<p><span>iOS is Apple's most advanced and feature-rich proprietary mobile OS. It was released with the first generation of the iPhone. When introduced, it was named</span> <span>iPhone OS</span><span>, and it was later renamed</span> <span>iOS</span> <span>to reflect the unified nature of the OS that powers all Apple iOS devices, such as the iPhone, iPod touch, iPad, and Apple TV. iOS is derived from core OS X technologies and is streamlined to be compact and efficient for mobile devices.</span></p>
<p><span>It utilizes a multi-touch interface, where simple gestures are used to operate and control the device, such as swiping your finger across the screen to move to the successive page or pinching your fingers to zoom. In simple terms, iOS assists with the general functioning of the device.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The iOS architecture</h1>
                </header>
            
            <article>
                
<p><span>iOS is an intermediary between the device hardware components and the applications on the screen. The applications don't interact with the underlying hardware directly. Instead, they do it through a well-defined system interface that protects them from hardware changes. This abstraction makes it easy to build applications that work on devices with different hardware capabilities.</span></p>
<p><span>The iOS architecture consists of four layers: the <span class="packt_screen">Cocoa Touch</span> layer, the <span class="packt_screen">Media</span> layer, the <span class="packt_screen">Core Services</span> layer, and the <span class="packt_screen">Core OS</span> layer. Each layer consists of several frameworks that help to build an application, as illustrated in the following diagram:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ea1ddfbe-6b37-485c-ac05-f340e04262a9.png" style="width:15.92em;height:16.75em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The iOS layers</span></div>
<p>These layers can be described as follows:</p>
<ul>
<li>
<p><strong><span class="packt_screen">Cocoa Touch</span></strong><span>: This layer contains the key frameworks required to develop the visual interface for iOS applications. Frameworks in this layer provide the basic application infrastructure and support key technologies, such as touch-based input, multitasking, and many high-level system services.</span></p>
</li>
<li>
<p><strong><span class="packt_screen">Media</span></strong><span>: This layer provides the graphics, audio, and video frameworks to create the best multimedia experience available on a mobile device. The technologies in this layer help developers to build applications that look and sound great.</span></p>
</li>
<li>
<p><strong><span class="packt_screen">Core Services</span></strong><span>: This layer provides the fundamental system services that are required for the applications. Not all of these services are used by developers, though many parts of the system are built on top of them. This layer contains technologies that enable support for location services, iCloud, and social media.</span></p>
</li>
<li>
<p><strong><span class="packt_screen">Core OS</span></strong><span>: This layer is the base layer and sits directly on top of the device hardware. This layer deals with low-level functionalities and provides services such as networking (<strong>Berkeley Software Distribution</strong> (<strong>BSD</strong>) sockets), memory management, threading (<strong>Portable Operating System Interface</strong> (<strong>POSIX</strong>) threads), filesystem handling, external accessories access, and <strong>Inter Process Communication</strong> (<strong>IPC</strong>).</span></p>
</li>
</ul>
<p>Now that we have learned about the iOS architecture, let's have a look at iOS security.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">iOS security</h1>
                </header>
            
            <article>
                
<p><span>Newer versions of iOS have been designed with security at their core. At the highest level, the iOS security architecture is as follows:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1229 image-border" src="assets/c38cd4a8-438d-4f8d-9ebb-602e4b1483c9.png" style="width:21.25em;height:47.08em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">The iOS security architecture</div>
<p><span>Apple iOS devices such as iPhone, iPad, and iPod Touch are designed with layers of security. Low-level hardware features safeguard from malware attacks, and the high-level OS features prevent unauthorized use. A brief overview of the iOS security features is provided in the following sections.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Passcodes, Touch ID, and Face ID</h1>
                </header>
            
            <article>
                
<p><span>Passcodes restrict unauthorized access to the device. Once a passcode is set, each time you turn on or wake up the device, it will ask for the passcode to access the device. iOS devices support simple as well as complex passcodes. iOS 9 released the option to use a six-digit simple passcode instead of the legacy four-digit option. The iPhone 5S and later also supports Touch ID fingerprints as a passcode, which are backed up with a simple or complex passcode. The iPhone X and later support a new biometric way of locking the device—Face ID—so that users can use their faces as the passcodes. And it's even more secure, as the chance that a stranger will unlock your iPhone with Touch ID is 1 in 50,000, but with Face ID it is 1 in 1,000,000.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Code signing</h1>
                </header>
            
            <article>
                
<p>Code signing prevents users from downloading and installing unauthorized applications on the device. Apple says the following about it:</p>
<div class="packt_quote"><em>"Code Signing is the process by which your compiled iOS application is sealed and identified as yours. Also, iOS devices won't run an application or load a library unless it is signed by a trusted party. To ensure that all apps come from a known and approved source and have not been tampered with, iOS requires that all executable code be signed using an Apple-issued certificate."</em></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Sandboxing</h1>
                </header>
            
            <article>
                
<p>Sandboxing mitigates post-code-execution exploitation by placing the application into a tightly restricted area. Applications installed on the iOS device are sandboxed, and one application cannot access the data stored by another. Essentially, a sandbox is a mechanism that enforces fine-grained controls that limit an application's access to files, network resources, hardware, and more.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Encryption</h1>
                </header>
            
            <article>
                
<p>On iOS devices (starting with the iPhone 4), the entire filesystem is encrypted with a filesystem key, which is computed from the device's unique hardware key. This key is stored in effaceable storage, which exists between the OS and hardware levels of the device. This is the reason that <strong>Joint Test Action Group</strong> (<strong>JTAG</strong>) and chip-off methods are not useful acquisition methods, as the entire data dump will be encrypted.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data protection</h1>
                </header>
            
            <article>
                
<p>Data protection is designed to protect data at rest and to make offline attacks difficult. It allows applications to leverage the user's device passcode, in concert with the device hardware encryption, to generate a strong encryption key. Later, the strong encryption key is used to encrypt the data stored on the disk. This key protects data from unauthorized access when the device is locked, so critical information is secured even if the device is compromised.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Address Space Layout Randomization (ASLR)</h1>
                </header>
            
            <article>
                
<p>ASLR is an exploit mitigation technique introduced with iOS 4.3. ASLR randomizes the application object's location in the memory, making it difficult to exploit the memory corruption vulnerabilities.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Privilege separation</h1>
                </header>
            
            <article>
                
<p>iOS runs with the <strong>principle of least privilege</strong> (<strong>PoLP</strong>). It contains two user roles: <em>root</em> and <em>mobile</em>. The most important processes in the system run with root user privileges. All other applications to which the user has direct access, such as the browser and third-party applications, run with mobile user privileges.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Stack-smashing protection</h1>
                </header>
            
            <article>
                
<p>Stack-smashing protection is an exploit mitigation mechanism. It protects the device against buffer overflow attacks by placing a random and known value (called a stack canary) between a buffer and the control data on the stack.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data Execution Prevention (DEP)</h1>
                </header>
            
            <article>
                
<p>DEP is an exploit mitigation technique mechanism through which a processor can distinguish the portions of memory that are executable code from data. For example, in a code injection attack, an attacker tries to inject a vector and execute it. But DEP prevents this because it recognizes the injected part as data and not code.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data wiping</h1>
                </header>
            
            <article>
                
<p><span>iOS provides the <span class="packt_screen">Erase All Content and Settings</span> option to wipe the data on an iPhone. This type of data wipe erases user settings and information by removing the encryption</span> <span>keys that protect the data. As the encryption keys are erased from the device, it is not possible to recover the deleted data, not even during forensic investigations. Other wiping methods are available that overwrite the data in the device memory. More information on wiping can be found at <a href="https://support.apple.com/en-in/HT201274">https://support.apple.com/en-in/HT201274</a>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Activation Lock</h1>
                </header>
            
            <article>
                
<p><span class="packt_screen">Activation Lock</span>, introduced with iOS 7, is a theft deterrent that works by leveraging <span class="packt_screen">Find My iPhone</span>. When Find My iPhone is enabled, it enables <span class="packt_screen">Activation Lock</span>, and a user's Apple ID and password will be required to turn off Find My iPhone, to erase the device, and to reactivate it.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The App Store</h1>
                </header>
            
            <article>
                
<p>The App Store is an application distribution platform for iOS, developed and maintained by Apple. It is a centralized online store where users can browse and download both free and paid apps. These apps expand the functionality of a mobile device. <span>As of the first quarter of 2019</span>, there were 2.2 million applications in the App Store.</p>
<p>Apps available in the App Store are generally written by third-party developers. Developers use Xcode and the iOS <strong>software development kit</strong> (<strong>SDK</strong>) to develop applications. Later, they submit the app to Apple for approval. Apple follows an extensive review process to check the app against the company's guidelines. If Apple approves the app, it is published to the App Store, where users can download or buy it. The strict review process makes the App Store less prone to malware, but not 100% secure.</p>
<p class="mce-root"/>
<p>XcodeGhost, the Apple malware that infected 50 applications within the Apple App Store, was detected in September 2015. This malware was built into Xcode, which made it harder to detect, and was reported to affect more than 500 million users worldwide. Once detected, Apple immediately removed the infected applications.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Jailbreaking</h1>
                </header>
            
            <article>
                
<p>Jailbreaking is the process of removing limitations imposed by Apple's mobile OS through the use of software and hardware exploits. Jailbreaking permits unsigned code to run and gain root access on the OS. The most common reason for jailbreaking is to expand the limited feature set imposed by Apple's App Store and to install unapproved apps. Jailbreaking can aid in forensic acquisition but will void the user's warranty, potentially <em>brick</em> the device, and may not support being restored to the factory settings.</p>
<div class="packt_infobox">If you jailbreak a device, it's best to assume that it will forever be jailbroken and the warranty is no longer valid.</div>
<p>Many publicly available jailbreaking tools add an unofficial application installer to the device, such as Cydia, which allows users to install many third-party applications, tools, tweaks, and apps from an online file repository. The software downloaded from Cydia opens up endless possibilities on a device that a non-jailbroken device would never be able to do. The most popular jailbreaking tools are Pangu, TaiG, Electra, and Unc0ver. Not all iOS versions are jailbreakable. The following table will help you to choose the appropriate jailbreak tool according to the device you have and its iOS version:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="width: 202px">
<p><strong>Version</strong></p>
</td>
<td style="width: 208px">
<p><strong>Release date</strong></p>
</td>
<td style="width: 227px">
<p><strong>Tool</strong></p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iPhone OS 1.0</p>
</td>
<td style="width: 208px">
<p>June 29, 2007</p>
</td>
<td style="width: 227px">
<p>(no name)</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iPhone OS 2.0</p>
</td>
<td style="width: 208px">
<p>July 11, 2008</p>
</td>
<td style="width: 227px">
<p>PwnageTool</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iPhone OS 3.0</p>
</td>
<td style="width: 208px">
<p>June 17, 2009</p>
</td>
<td style="width: 227px">
<p>PwnageTool</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 4.0</p>
</td>
<td style="width: 208px">
<p>June 21, 2010</p>
</td>
<td style="width: 227px">
<p>PwnageTool</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 5.0</p>
</td>
<td style="width: 208px">
<p>October 12, 2011</p>
</td>
<td style="width: 227px">
<p>redsn0w</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 6.0</p>
</td>
<td style="width: 208px">
<p>September 19, 2012</p>
</td>
<td style="width: 227px">
<p>redsn0w</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 7.0 - 7.0.6</p>
</td>
<td style="width: 208px">
<p>September 18, 2013</p>
</td>
<td style="width: 227px">
<p>evasi0n7</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 7.1 - 7.1.2</p>
</td>
<td style="width: 208px">
<p>May 29, 2014</p>
</td>
<td style="width: 227px">
<p>Pangu</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 8.0 - 8.1</p>
</td>
<td style="width: 208px">
<p>September 17, 2014</p>
</td>
<td style="width: 227px">
<p>Pangu8</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 8.1.1 - 8.4</p>
</td>
<td style="width: 208px">
<p>November 17, 2014</p>
</td>
<td style="width: 227px">
<p>TaiG, PP Jailbreak</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 8.4.1</p>
</td>
<td style="width: 208px">
<p>August 13, 2015</p>
</td>
<td style="width: 227px">
<p><br/>
EtasonJB</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p><span>iOS </span>9.0 </p>
</td>
<td style="width: 208px">
<p><span>September 16, 2015</span></p>
</td>
<td style="width: 227px">
<p><span>Pangu9</span></p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p><span>iOS 9.1</span></p>
</td>
<td style="width: 208px">
<p><span>October 21, 2015</span></p>
</td>
<td style="width: 227px">
<p><span>Pangu9</span></p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 9.3.5</p>
</td>
<td style="width: 208px">
<p>August 25, 2016</p>
</td>
<td style="width: 227px">
<p>Phoenix</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p><span>iOS </span>10.0 - 10.1.1</p>
</td>
<td style="width: 208px">
<p><span>September 13, 2016</span></p>
</td>
<td style="width: 227px">
<p><span>Yalu</span></p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 11.0 - 11.1.2</p>
</td>
<td style="width: 208px">
<p>September 19, 2017</p>
</td>
<td style="width: 227px">
<p>LiberiOS</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 11.0 - 11.1.2</p>
</td>
<td style="width: 208px">
<p>September 19, 2017</p>
</td>
<td style="width: 227px">
<p>Electra1112</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 11.0 - 11.4.1</p>
</td>
<td style="width: 208px">
<p>July 7, 2018</p>
</td>
<td style="width: 227px">
<p>Electra1131</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 11.0 - 11.4.1</p>
</td>
<td style="width: 208px">
<p>October 14, 2018</p>
</td>
<td style="width: 227px">
<p>Unc0ver</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 12.0 - 12.2, 12.4 - 12.4.2</p>
</td>
<td style="width: 208px">
<p>September 17, 2019</p>
</td>
<td style="width: 227px">
<p>Chimera, Unc0ver</p>
</td>
</tr>
<tr>
<td style="width: 202px">
<p>iOS 12.3 - 13.2.3</p>
</td>
<td style="width: 208px">
<p>November 10, 2019</p>
</td>
<td style="width: 227px">
<p>checkra1n</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>We have now learned about the jailbreaking process and have had a look at the different jailbreaking tools currently available.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>The first step in the forensic examination of an iOS device should be identifying the device model. The model of an iOS device can be used to help you as the examiner develop an understanding of the underlying components and capabilities of the device, which can be used to drive the methods for acquisition and examination. Legacy iOS devices should not be disregarded, because they may surface as part of an investigation. You must be aware of all iOS devices, as old devices are sometimes still in use and may be tied to a criminal investigation.</p>
<p>The next chapter will provide tools that will aid in obtaining data from iOS devices to later forensically examine. Not all tools are created equal, so it's important to know the best tools to get the job done properly.</p>


            </article>

            
        </section>
    </body></html>