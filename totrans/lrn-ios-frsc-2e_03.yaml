- en: Chapter 3. Evidence Acquisition from iDevices
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第3章：从 iDevices 获取证据
- en: The purpose of this chapter is to introduce techniques and tools used for the
    acquisition of data from an iDevice. In the first part of the chapter, we will
    go through the boot process, the data security features, and the encryption used
    by Apple. The second part deals with the different acquisition methods **Apple
    File Conduit** (**AFC**) protocol, iTunes backup, Apple File Relay protocol, and
    physical), providing a description of state-of-the-art techniques for cracking
    or bypassing the lock code. Finally, in the last part, we will introduce the concept
    of jailbreaking, which is useful for the physical acquisition of the latest devices.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的目的是介绍用于从 iDevice 获取数据的技术和工具。在本章的第一部分，我们将讲解启动过程、数据安全特性和 Apple 使用的加密技术。第二部分则涉及不同的获取方法，包括
    **Apple 文件通道**（**AFC**）协议、iTunes 备份、Apple 文件中继协议和物理获取等，并提供了破解或绕过锁定代码的先进技术的描述。最后，在最后一部分，我们将介绍越狱的概念，这对于最新设备的物理数据获取非常有用。
- en: iOS boot process and operating modes
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: iOS 启动过程和操作模式
- en: 'The boot process of an iOS device is composed of three steps: **Low Level Bootloader**
    (**LLB**), **iBoot**, and **iOS kernel**. To guarantee the integrity of the different
    components, all the steps involved in the boot process are signed. The signature
    for LLB is verified by the Apple Root CA public key, contained in the Boot ROM
    code. Then, LLB verifies and executes iBoot, which then verifies and executes
    the iOS kernel. Consequently, all the components are signed by Apple. There are
    a lot of studies, papers, and books related to the iOS boot process and on how
    to overcome the protection implemented by Apple (you can find all the details
    in *[Appendix A](apa.html "Appendix A. References")*, *References*). We suggest
    that you read the latest version of the Apple paper *iOS Security*, *Apple*, *May
    2016*.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: iOS 设备的启动过程由三个步骤组成：**低级引导加载程序**（**LLB**）、**iBoot** 和 **iOS 内核**。为了保证不同组件的完整性，启动过程中涉及的所有步骤都会进行签名。LLB
    的签名通过包含在 Boot ROM 代码中的 Apple 根证书公钥进行验证。然后，LLB 验证并执行 iBoot，iBoot 接着验证并执行 iOS 内核。因此，所有组件都由
    Apple 签名。关于 iOS 启动过程以及如何绕过 Apple 实施的保护措施，已经有许多研究、论文和书籍（所有细节可以在 *[附录 A](apa.html
    "附录 A. 参考文献")* 和 *参考文献* 中找到）。我们建议您阅读 Apple 的最新论文 *iOS 安全性*，*Apple*，*2016年5月*。
- en: 'From the point of view of a forensic analyst, it is important to know that
    iDevices can operate in the following three different modes:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 从取证分析师的角度来看，了解 iDevice 可以在以下三种不同模式下运行是很重要的：
- en: '**Normal**: This mode is the traditional iOS user interface.'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**正常模式**：这是传统的 iOS 用户界面模式。'
- en: '**Recovery**: This mode is used to perform activation and upgrades on an iDevice.
    It can be activated by holding down the Home button on a powered off device and
    connecting it to a computer via the USB cable.'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**恢复模式**：此模式用于在 iDevice 上执行激活和升级。通过在设备关闭时按住 Home 键并通过 USB 电缆将其连接到计算机来激活此模式。'
- en: '**Device firmware upgrade** (**DFU**): This mode is used by an iDevice during
    the iOS upgrades and when one of the processes in verification boot chain fails.
    It can be activated by holding down the Home and the Power button together (with
    the device powered on or off) for 10 seconds, and then it is necessary to release
    the Power button and hold the Home button for 10 seconds more.'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**设备固件升级模式**（**DFU**）：此模式在 iOS 升级过程中或当验证启动链中的某个过程失败时，iDevice 会进入该模式。通过同时按住
    Home 键和 Power 键 10 秒钟（无论设备是开机还是关机），然后松开 Power 键并继续按住 Home 键 10 秒钟，即可激活此模式。'
- en: Both Recovery and DFU modes are really useful for the physical acquisition of
    iDevices, as we will show later in the dedicated section.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 恢复模式和 DFU 模式对于 iDevices 的物理数据获取非常有用，正如我们稍后在专门部分中展示的那样。
- en: iOS data security
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: iOS 数据安全
- en: A complete description of iOS data security is out of the scope of this book,
    but we wish to give you just an overview (taken from the Apple paper *iOS Security*
    and from Christian D'Orazio's thesis; refer to *[Appendix A](apa.html "Appendix A. References")*,
    *References*) of the hardware and software security features.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本书并不涵盖 iOS 数据安全的完整描述，但我们希望为您提供一个概览（摘自 Apple 的 *iOS 安全性* 论文和 Christian D'Orazio
    的论文；请参阅 *[附录 A](apa.html "附录 A. 参考文献")*，*参考文献*）有关硬件和软件安全特性。
- en: Hardware security features
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 硬件安全特性
- en: Every iDevice, starting from iPhone 3GS, has a dedicated AES 256-bit crypto
    engine built in between the flash storage and the main system memory. The purposes
    of this processor are to accelerate the encryption and decryption operations and
    to protect user data so that it remains encrypted on the device's flash memory.
    A **unique ID** (**UID**) is associated with each device and allows data to be
    cryptographically tied to a particular device. The UID cannot be read directly
    and it is used as an AES 256-bit key to generate encryption keys that protect
    user data. These encryption keys, known as **EMF** and **Dkey** (**Class D Key**),
    are stored in a specific area of the flash memory called **PLOG block** (or **Effaceable
    Storage**). When the device deletes this area it makes the whole volume unreadable
    and the content is completely and definitely encrypted, with no way to recover
    it.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 从iPhone 3GS开始，每台iDevice设备都内置了一个专用的AES 256位加密引擎，该引擎位于闪存存储和主系统内存之间。这个处理器的目的是加速加密和解密操作，并保护用户数据，使其在设备的闪存上保持加密状态。每个设备都与一个**唯一ID**（**UID**）相关联，允许将数据加密地绑定到特定设备。UID无法直接读取，并且它被用作AES
    256位密钥来生成保护用户数据的加密密钥。这些加密密钥被称为**EMF**和**Dkey**（**Class D Key**），存储在闪存的特定区域，称为**PLOG块**（或**可删除存储**）。当设备删除此区域时，整个卷会变得无法读取，内容完全加密且无法恢复。
- en: File data protection
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 文件数据保护
- en: 'As described by Apple in the paper *iOS Security* (refer to *[Appendix A](apa.html
    "Appendix A. References")*, *References*):'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 如苹果在文档 *iOS Security* 中所描述（参考 *[附录A](apa.html "附录 A. 参考资料")*, *参考资料*）：
- en: '*"In addition to the hardware encryption features built into iOS devices, Apple
    uses a technology called Data Protection to further protect data stored in flash
    memory on the device."*'
  id: totrans-15
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*“除了iOS设备内建的硬件加密功能外，苹果还使用一种叫做数据保护的技术来进一步保护设备上闪存存储的数据。”*'
- en: 'Apple implements an encrypted HFS+ volume, in which each file is assigned to
    a class, depending on the type of data and the security level required. The paper
    also states that:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 苹果实现了加密的HFS+卷，其中每个文件会根据数据类型和所需的安全级别分配一个类别。文中还指出：
- en: '*"Every time a file on the data partition is created, Data Protection creates
    a new 256-bit key (the per-file key) and gives it to the hardware AES engine,
    which uses the key to encrypt the file as it is written to flash memory using
    AES CBC mode."*'
  id: totrans-17
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*“每当数据分区上的文件被创建时，数据保护会生成一个新的256位密钥（每个文件的密钥），并将其交给硬件AES引擎，后者使用该密钥在使用AES CBC模式写入闪存时对文件进行加密。”*'
- en: 'The per-file key is then wrapped with the key of the class to which the file
    belongs. The wrapped per-file key is stored in the `cprotect` attribute, which
    is part of the file''s metadata contained in the `Attributes` file. The paper
    further states that:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，每个文件的密钥会被该文件所属类别的密钥加密。加密后的文件密钥会存储在`cprotect`属性中，该属性是文件元数据的一部分，包含在`Attributes`文件中。文中进一步指出：
- en: '*"When a file is opened, its metadata is decrypted with the filesystem key,
    revealing the wrapped per-file key and a notation on which class protects it.
    The per-file key is unwrapped with the class key, then supplied to the hardware
    AES engine, which decrypts the file as it is read from flash memory."*'
  id: totrans-19
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*“当一个文件被打开时，它的元数据会使用文件系统密钥解密，从而揭示出加密的每个文件密钥以及标明保护它的类别的注释。每个文件的密钥通过类别密钥解密，然后提供给硬件AES引擎，后者在从闪存读取文件时进行解密。”*'
- en: 'It is important to note that the filesystem key can be erased, and in that
    case the content of every file becomes definitely unreadable. There are four basic
    classes that use different policies to determine when file content is accessible
    and where the class keys are stored. With the exception of the Dkey, all class
    keys are stored in the `Keybag` system, which is a file that contains master keys
    for each one of the classes available, as shown in the following screenshot:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，文件系统密钥可以被擦除，在这种情况下，每个文件的内容将变得完全无法读取。有四个基本类别使用不同的策略来确定文件内容何时可访问，以及类别密钥存储的位置。除了Dkey外，所有类别密钥都存储在`Keybag`系统中，这是一个包含每个类别主密钥的文件，如下图所示：
- en: '![File data protection](img/image_03_001.jpg)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![文件数据保护](img/image_03_001.jpg)'
- en: Class D offers the lowest security level because the Dkey is not derived from
    the passcode but wrapped in the `PLOG` area with a value (`Key0x835`) that can
    be retrieved by communicating with the kernel. From a forensics point of view,
    it is important to note that all the files created by a native iOS application,
    except e-mail messages and related attachments, belong to Class D. It means that
    all the cryptographic keys required to decrypt a file can be retrieved without
    knowing or cracking the passcode.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: D 类提供最低的安全级别，因为 Dkey 不是从密码派生的，而是被包装在 `PLOG` 区域中，且有一个可以通过与内核通信来检索的值（`Key0x835`）。从取证的角度来看，重要的是要注意，除了电子邮件消息及其附件外，所有由原生
    iOS 应用程序创建的文件都属于 D 类。这意味着，解密文件所需的所有加密密钥都可以在无需知道或破解密码的情况下被检索。
- en: Unique device identifier
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 唯一设备标识符
- en: 'Every single iDevice produced is identified by a **Unique Device ID** (**UDID**),
    as is explained in The iPhone Wiki ([http://theiphonewiki.com/wiki/UDID](http://theiphonewiki.com/wiki/UDID)).
    It can be calculated as the **SHA-1** hash of a particular 60- or 59-character
    long string that can be obtained as follows:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 每一台生产的 iDevice 都有一个 **唯一设备 ID** (**UDID**)，如 [The iPhone Wiki](http://theiphonewiki.com/wiki/UDID)
    所解释的那样。它可以通过以下方法计算得到：对特定的 60 或 59 个字符长的字符串进行 **SHA-1** 哈希运算，且该字符串可以通过以下方式获得：
- en: An 11-character or 12-character long (on newer devices) serial number (exactly
    like it is written in the **Settings** app)
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 11 或 12 个字符长的序列号（在较新的设备上），与 **设置** 应用中显示的一致。
- en: A 15-character long IMEI number without spaces (on older devices), empty string
    for iPod touch and the Wi-Fi model iPad devices, or a 13-character ECID in decimal
    with no leading zeroes (on newer devices)
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个没有空格的 15 个字符的 IMEI 号码（在较老的设备上），对于 iPod touch 和 Wi-Fi 型 iPad 设备为空字符串，或者一个没有前导零的
    13 个字符的十进制 ECID（在较新的设备上）
- en: Note
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意事项
- en: The ECID is the Electronic Chip ID. For more information, refer to [https://theiphonewiki.com/wiki/ECID](https://theiphonewiki.com/wiki/ECID).
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: ECID 是电子芯片 ID。欲了解更多信息，请参阅 [https://theiphonewiki.com/wiki/ECID](https://theiphonewiki.com/wiki/ECID)。
- en: A 17-character long Wi-Fi MAC address (letters in lowercase, including colons).
    For the iPod touch first generation, use `00:00:00:00:00:00`
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 17 个字符长的 Wi-Fi MAC 地址（字母为小写，包括冒号）。对于第一代 iPod touch，使用 `00:00:00:00:00:00`
- en: A 17-character long Bluetooth MAC address (letters in lowercase, including colons)
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 17 个字符长的蓝牙 MAC 地址（字母为小写，包括冒号）
- en: Case study - UDID calculation on iPhone 6s
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 案例研究 - iPhone 6s 上的 UDID 计算
- en: 'On iPhone 6s, the UDID is calculated as follows:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在 iPhone 6s 上，UDID 的计算方法如下：
- en: '![Case study - UDID calculation on iPhone 6s](img/image_03_002.jpg)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - iPhone 6s 上的 UDID 计算](img/image_03_002.jpg)'
- en: 'If the device is unlocked, the serial number, Wi-Fi MAC address, and Bluetooth
    can be obtained by tapping **About** from **Settings** | **General** on the device''s
    main screen, as shown in the following screenshot:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 如果设备已解锁，序列号、Wi-Fi MAC 地址和蓝牙地址可以通过点击设备主屏幕上的 **设置** | **通用** 中的 **关于** 来获取，如下截图所示：
- en: '![Case study - UDID calculation on iPhone 6s](img/image_03_003.jpg)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - iPhone 6s 上的 UDID 计算](img/image_03_003.jpg)'
- en: 'The ECID can be obtained as follows:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: ECID 可以通过以下步骤获得：
- en: Put the device in Recovery mode.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将设备置于恢复模式。
- en: Open Windows **Device Manager**, navigate to **Universal Serial Bus controllers**
    | **Apple Mobile Device USB Driver**, right-click on it, and select **Properties**.
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 Windows **设备管理器**，导航到 **通用串行总线控制器** | **Apple Mobile Device USB 驱动程序**，右键点击它，并选择
    **属性**。
- en: Click on **Details**, search and select **Device Instance Path** in the drop-down
    menu, and copy the text to a text file.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **详细信息**，在下拉菜单中搜索并选择 **设备实例路径**，并将文本复制到文本文件中。
- en: On a Mac OS X, navigate to **System Information** | **System Report** and look
    in the USB entry under **Hardware**.![Case study - UDID calculation on iPhone
    6s](img/image_03_004.jpg)
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Mac OS X 上，导航到 **系统信息** | **系统报告**，并在 **硬件** 下的 USB 条目中查看。![案例研究 - iPhone
    6s 上的 UDID 计算](img/image_03_004.jpg)
- en: 'In this example we have the following entries:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，我们有以下条目：
- en: '**Serial number**: `F17QT811GRY9`'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**序列号**: `F17QT811GRY9`'
- en: '**ECID**: `0016611E28BB0226`'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ECID**: `0016611E28BB0226`'
- en: '**Wi-Fi MAC address**: `1C:5C:F2:7F:7A:20`'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Wi-Fi MAC 地址**: `1C:5C:F2:7F:7A:20`'
- en: '**Bluetooth MAC address**: `1C:5C:F2:7F:7A:21`'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**蓝牙 MAC 地址**: `1C:5C:F2:7F:7A:21`'
- en: Before calculating the UDID, we need to convert the hex value for ECID to a
    decimal number, so `16611E28BB0226` corresponds to `6299231647892006`. Moreover
    the letters in the Wi-Fi MAC address and in the Bluetooth MAC address must be
    converted to lower case.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在计算 UDID 之前，我们需要将 ECID 的十六进制值转换为十进制数字，因此 `16611E28BB0226` 对应 `6299231647892006`。此外，Wi-Fi
    MAC 地址和蓝牙 MAC 地址中的字母必须转换为小写字母。
- en: 'The UDID can be calculated as follows:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: UDID可以按以下方式计算：
- en: '`SHA1(F17QT811GRY962992316478920061c:5c:f2:7f:7a:201c:5c:f2:7f:7a:21) = 3bf682ebc55c5673d586e0273af0dfb72d1994a2`'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '`SHA1(F17QT811GRY962992316478920061c:5c:f2:7f:7a:201c:5c:f2:7f:7a:21) = 3bf682ebc55c5673d586e0273af0dfb72d1994a2`'
- en: 'The calculated value can be verified using iTunes, after connecting the device
    to the computer, as shown in the following screenshot:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 计算得到的值可以通过iTunes进行验证，方法是将设备连接到计算机，如下图所示：
- en: '![Case study - UDID calculation on iPhone 6s](img/image_03_005.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - iPhone 6s上的UDID计算](img/image_03_005.jpg)'
- en: 'Otherwise, the UDID can also be verified using the `ideviceinfo` tool introduced
    in [Chapter 2](ch02.html "Chapter 2. Introduction to iOS Devices"), *Introduction
    to iOS Devices*, as shown in the following screenshot:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 否则，也可以使用`ideviceinfo`工具来验证UDID，该工具在[第2章](ch02.html "第2章：iOS设备简介")《iOS设备简介》中介绍，如下图所示：
- en: '![Case study - UDID calculation on iPhone 6s](img/image_03_006.jpg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - iPhone 6s上的UDID计算](img/image_03_006.jpg)'
- en: Lockdown certificate
  id: totrans-53
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 锁定证书
- en: 'The first time you connect an unlocked iDevice to a computer and run the iTunes
    software, a pairing/sync certificate, known as a **lockdown** certificate, is
    created on the computer''s hard drive. Depending on the operating system in which
    iTunes is installed, lockdown certificates are stored in the following folders:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 第一次将解锁的iDevice连接到计算机并运行iTunes软件时，会在计算机硬盘上创建一个配对/同步证书，称为**锁定**证书。根据iTunes安装的操作系统，锁定证书会存储在以下文件夹中：
- en: '**Windows 7/8/10**: `C:\Program Data\Apple\Lockdown`'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Windows 7/8/10**：`C:\Program Data\Apple\Lockdown`'
- en: '**Windows Vista**: `C:\Users\[username]\AppData\roaming\Apple Computer\Lockdown`'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Windows Vista**：`C:\Users\[用户名]\AppData\roaming\Apple Computer\Lockdown`'
- en: '**Windows XP**: `C:\Documents and Settings\[username]\Application Data\Apple
    Computer\Lockdown`'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Windows XP**：`C:\Documents and Settings\[用户名]\Application Data\Apple Computer\Lockdown`'
- en: '**Mac OS X**: `/var/db/lockdown`'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Mac OS X**：`/var/db/lockdown`'
- en: In older version of Mac OS X lockdown certificates are stored in `/Users/[username]/Library/Lockdown/`.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在旧版本的Mac OS X中，锁定证书存储在`/Users/[用户名]/Library/Lockdown/`目录下。
- en: 'Within these paths, there is a lockdown certificate for each device that was
    ever connected to the computer. The certificate is a `plist` file called `<UDID>.plist`,
    where `UDID` corresponds with the unique identifier of the iDevice, as shown in
    the following screenshot:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些路径下，每个曾经连接到计算机的设备都有一个锁定证书。该证书是一个`plist`文件，名为`<UDID>.plist`，其中`UDID`对应iDevice的唯一标识符，如下图所示：
- en: '![Lockdown certificate](img/image_03_007.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![锁定证书](img/image_03_007.jpg)'
- en: Once the certificate for a specific device has been generated, it remains valid
    until the user resets the device to factory settings. If the device is turned
    on and has been unlocked at least once in the last 48 hours (from iOS 8), the
    certificate can be used to bypass passcode to both obtain a backup and extract
    files through the AFC service. Of fundamental importance to the forensic acquisition
    of data is the fact that the certificate can be copied to another machine.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦为特定设备生成证书，它将一直有效，直到用户将设备重置为出厂设置。如果设备已经开启且在过去48小时内至少解锁过一次（从iOS 8开始），该证书可以绕过密码，既可以获取备份，又可以通过AFC服务提取文件。对于数据取证来说，至关重要的一点是，证书可以被复制到另一台机器上。
- en: Starting from iOS 7.0, when you connect a device, two pop-up authorizations
    are displayed. The first popup appears on the computer in iTunes and it asks the
    user to click on **Continue**.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 从iOS 7.0开始，当你连接设备时，会显示两个弹出授权窗口。第一个弹出窗口出现在计算机上的iTunes中，要求用户点击**继续**。
- en: '![Lockdown certificate](img/image_03_008.jpg)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![锁定证书](img/image_03_008.jpg)'
- en: The second popup appears on the iDevice screen once unlocked, and requires the
    user to click on the **Trust** button to allow pairing with the computer.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个弹出窗口会在iDevice解锁后出现在屏幕上，用户需要点击**信任**按钮以允许与计算机配对。
- en: '![Lockdown certificate](img/image_03_009.jpg)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![锁定证书](img/image_03_009.jpg)'
- en: Search and seizure
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 搜查和扣押
- en: 'If you have to deal with a search and seizure of an iDevice, it is really important
    to perform some steps. We have three scenarios: device turned off, device turned
    on and unlocked at the time of search and seizure, and device turned on and locked
    at the time of search and seizure:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你需要处理iDevice的搜查和扣押，执行一些步骤非常重要。我们有三种情况：设备关闭、设备在搜查和扣押时已经开启且解锁、设备在搜查和扣押时已开启但锁定：
- en: 'If the device is turned on and locked, do the following:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果设备已开启并且已锁定，请执行以下操作：
- en: If the passcode is set, acquire the content from the device as soon as possible
    or keep the device on and in charge.
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果已设置密码，请尽快从设备采集内容，或者保持设备开机并充电。
- en: If the passcode is not set, turn it off.
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果未设置密码，关闭该选项。
- en: If the device is off, leave it off.
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果设备关闭，请保持其关闭。
- en: Set **Auto-Lock** to **Never** from **Settings** | **General** | **Auto-Lock**.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**设置** | **通用** | **自动锁定**中，将**自动锁定**设置为**永不**。
- en: Check whether the passcode is set or not from **Settings** | **Passcode**.
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查是否设置了密码，路径为**设置** | **密码**。
- en: If the device is on and unlocked, turn on **Airplane Mode** in **Settings:**
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果设备已开机且解锁，请在**设置**中打开**飞行模式**：
- en: 'Check if the device displays the **iPhone requires your passcode after restarting**
    message, as shown in the following screenshot:'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 检查设备是否显示**iPhone重启后需要输入密码**的消息，如以下截图所示：
- en: '![Search and seizure](img/image_03_010.jpg)'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![搜索与扣押](img/image_03_010.jpg)'
- en: Turn on **Airplane Mode** using Apple **Control Center**, which can be activated
    with a single swipe, even with locked device if such access has not been disabled
    by the user.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用苹果**控制中心**打开**飞行模式**，通过简单滑动即可激活，即使设备已锁定，只要用户未禁用此访问权限。
- en: Keep the phone on and charging.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保持手机开机并充电。
- en: Seize any computer that could have been used to synchronize or simply authorize
    the iDevice, because there you can possibly find a lockdown certificate that will
    allow access to the data.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 扣押任何可能曾用于同步或简单授权iDevice的计算机，因为在这些设备上，你可能找到一个锁定证书，允许访问数据。
- en: Acquire the data as soon as possible because the lockdown certificate is valid
    only if the device remains on and in any case no more than 48 hours.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 尽快采集数据，因为锁定证书仅在设备保持开机状态且最长不超过48小时有效。
- en: iOS device acquisition
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: iOS设备采集
- en: 'Once you have identified the specific model that you need to acquire, it becomes
    important to understand the best technique to use. The type of acquisition depends
    basically on the following seven parameters:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦确定了需要采集的具体型号，了解使用最佳技术变得至关重要。采集类型基本上取决于以下七个参数：
- en: Device model
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设备型号
- en: iOS version
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: iOS版本
- en: Passcode (not set, simple passcode, or complex passcode)
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密码（未设置、简单密码或复杂密码）
- en: Device status (on or off)
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设备状态（开机或关机）
- en: Availability of a pairing certificate
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是否有配对证书
- en: Presence of a backup password
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是否设置了备份密码
- en: Device jailbroken or not
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设备是否越狱
- en: 'Nowadays, in the forensic community the following four techniques are used
    to access data stored on iDevices:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，在法医界，以下四种技术被用来访问存储在iDevices上的数据：
- en: '**Apple File Conduit**: This technique consists of a direct interaction with
    a powered on device, typically through non-forensic software, and permits obtaining
    a reduced set of the filesystem'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Apple文件通道**：此技术通过与已开机设备的直接交互，通常通过非法医软件，允许获取文件系统的简化版本。'
- en: '**iTunes Backup**: This technique consists of a partial filesystem acquisition
    through the iTunes backup feature or using a forensic acquisition tool that uses
    the iTunes libraries'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**iTunes备份**：此技术通过iTunes备份功能或使用通过iTunes库进行的法医采集工具，进行部分文件系统的采集。'
- en: '**Advanced logical**: This technique is based on Apple File Relay and was introduced
    for the first time by the researcher Jonathan Zdziarski'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**高级逻辑**：此技术基于Apple File Relay，由研究人员Jonathan Zdziarski首次引入。'
- en: '**Physical**: This technique generates a traditional forensic image for both
    the system and data partition'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**物理**：此技术生成一个传统的法医镜像，涵盖系统和数据分区。'
- en: Apple File Conduit acquisition
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Apple文件通道采集
- en: The acquisition through the AFC service can be carried out with all iDevices,
    regardless of the operating system version. It requires that the device is not
    protected with a passcode, the passcode is known, or the analyst has a valid lockdown
    certificate. The conditions and the kind of data that you can get with this kind
    of acquisition have changed a lot through the various versions of iOS.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 通过AFC服务进行的获取可以在所有iDevices上进行，无论操作系统版本如何。要求设备没有设置密码，或者密码已知，或者分析员拥有有效的锁定证书。通过不同版本的iOS，这种获取方式及可获取的数据类型发生了很大变化。
- en: Starting from iOS 9, if the device is unlocked or with a valid lockdown certificate,
    it is only possible to extract multimedia information (photos, videos, music,
    and so on) and the related configuration files (for example, the iTunes library,
    the database of the Photo application, and so on). Moreover, in previous versions
    up to iOS 8.3, it was also possible to access the data folders of third-party
    applications, with the phone unlocked or with a valid lockdown certificate. It
    is also interesting to note that this method allows us to extract the `Crash Reports`
    folder from the device, which contains the error logs generated by the operating
    system and installed applications and the live System Log. Neither of these will
    be present on an acquisition made through iTunes backup, as will be explained
    in [Chapter 6](ch06.html "Chapter 6. Analyzing iOS Devices"), *Analyzing iOS Devices*,
    and in some cases, these files can contain very important information. It is therefore
    advisable to take this into account while choosing the acquisition method.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 从 iOS 9 开始，如果设备解锁或具有有效的锁定证书，则只能提取多媒体信息（照片、视频、音乐等）及相关配置文件（例如，iTunes 库、照片应用的数据库等）。此外，在
    iOS 8.3 及更早版本中，只要设备解锁或具有有效的锁定证书，也可以访问第三方应用程序的数据文件夹。值得注意的是，这种方法还允许我们从设备中提取 `Crash
    Reports` 文件夹，其中包含操作系统和已安装应用程序生成的错误日志以及实时系统日志。通过 iTunes 备份获取的数据中将不包含这些文件，正如在[第六章](ch06.html
    "第六章：分析 iOS 设备")，*分析 iOS 设备*中将解释的那样，某些情况下，这些文件可能包含非常重要的信息。因此，在选择获取方法时，建议考虑这一点。
- en: To make that kind of acquisition, you can use various types of software known
    as iDevice browsers.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 要进行这种类型的获取，可以使用各种被称为 iDevice 浏览器的软件。
- en: Note
  id: totrans-100
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: This activity is performed with a non-forensic tool that also permits writing
    operations, so the analyst must operate very carefully to avoid accidental erasure.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 该操作使用的是非取证工具，且该工具也允许写入操作，因此分析人员必须非常小心操作，以避免意外擦除数据。
- en: 'The most used tools on Windows and Mac for this type of acquisition are **iFunBox**,
    **iTools**, **iBackup Bot**, **iMazing**, **iExplorer**, and **WonderShare Dr.Fone**.
    These tools require the installation of an updated version of iTunes because they
    use its libraries to communicate with the device. Before connecting the device
    to your computer, you should ensure that in **iTunes** | **Preferences** | **Devices**,
    the **Prevent iPods, iPhones, and iPads from syncing automatically** option is
    enabled, as shown in the following screenshot:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Windows 和 Mac 上，最常用的工具有 **iFunBox**、**iTools**、**iBackup Bot**、**iMazing**、**iExplorer**
    和 **WonderShare Dr.Fone**。这些工具需要安装更新版本的 iTunes，因为它们使用 iTunes 的库与设备进行通信。在将设备连接到计算机之前，应确保在
    **iTunes** | **偏好设置** | **设备** 中启用了 **防止 iPods、iPhones 和 iPads 自动同步** 选项，如下图所示：
- en: '![Apple File Conduit acquisition](img/image_03_011.jpg)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![Apple 文件传输获取](img/image_03_011.jpg)'
- en: Case study - AFC acquisition with iBackupBot
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 案例研究 - 使用 iBackupBot 进行 AFC 获取
- en: '**iBackupBot** is a commercial tool for Windows that allows access to connected
    iOS devices to perform both direct extraction via AFC protocol and the generation
    of backups in iTunes format. The trial version allows loading and extracting information
    from the device.'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '**iBackupBot** 是一款用于 Windows 的商业工具，可以访问连接的 iOS 设备，通过 AFC 协议直接提取数据并生成 iTunes
    格式的备份。试用版允许从设备加载和提取信息。'
- en: 'Once the software has been downloaded, installed, and run, simply connect the
    device to acquire and wait for the related information to load. In the following
    screenshot you can see an example related to an **iPad 2 (GSM)** running iOS 8.3,
    which shows the main characteristics of the device (**Serial Number**, **Unique
    Identifier**, **Bluetooth Address**, **Wi-Fi Address**, and so on) and the backup
    encryption configuration status (that is, if it''s enabled or not):'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 下载、安装并运行软件后，只需连接设备以开始获取，等待相关信息加载。在以下截图中，您可以看到与运行 iOS 8.3 的 **iPad 2 (GSM)**
    相关的示例，显示设备的主要特征（**序列号**、**唯一标识符**、**蓝牙地址**、**Wi-Fi 地址**等）以及备份加密配置状态（即是否启用）。
- en: '![Case study - AFC acquisition with iBackupBot](img/image_03_012.jpg)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 iBackupBot 进行 AFC 获取](img/image_03_012.jpg)'
- en: 'Clicking on **User Applications** shows the list of all applications installed
    by the user, reporting the size of the application and of its data, plus the version
    that is currently installed:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 点击 **用户应用程序** 可以查看用户安装的所有应用程序列表，报告应用程序及其数据的大小，以及当前安装的版本：
- en: '![Case study - AFC acquisition with iBackupBot](img/image_03_013.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 iBackupBot 获取 AFC](img/image_03_013.jpg)'
- en: The **App File Sharing** option provides access to application data whose developers
    have decided to share data. This feature is used to allow, typically through iTunes,
    the exchange of files between the device and a computer. All shared files from
    the applications can be extracted directly from the device. The functionality
    is often used in applications where the user needs to create and/or modify the
    contents (for example, the Office Suites app) or manage files (for example, the
    Compression app).
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '**应用文件共享**选项提供了对应用程序数据的访问，这些数据是由开发者决定共享的。这个功能通常通过 iTunes 来允许设备和电脑之间的文件交换。所有从应用程序共享的文件都可以直接从设备中提取。这项功能通常用于需要创建和/或修改内容的应用程序（例如
    Office 套件应用）或管理文件的应用程序（例如压缩应用）。'
- en: The following screenshot shows an example on the WinZip application. By right-clicking
    on one or more files you can export them to a folder on your computer. Pay attention
    to the fact that this access is read-write, and the graphical interface provides
    also a **New Folder** button that allows the creation of content on the device.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了 WinZip 应用程序中的一个示例。通过右键点击一个或多个文件，你可以将它们导出到电脑上的文件夹。请注意，这种访问方式是读写权限，图形界面还提供了一个**新建文件夹**按钮，允许在设备上创建内容。
- en: '![Case study - AFC acquisition with iBackupBot](img/image_03_014.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 iBackupBot 获取 AFC](img/image_03_014.jpg)'
- en: The **Raw File System** option allows you to navigate within the part of the
    device's filesystem that is made available through the AFC protocol. As already
    mentioned, it mainly includes media data (`DCIM` folder), books loaded into the
    iBooks app (`Books` folder), iTunes library (`iTunes_Control` folder), and files
    downloaded by the user or the applications (`Downloads` folder). Similar to the
    previous option, files and folders can be extracted from the device to the computer.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '**原始文件系统**选项允许你在通过 AFC 协议提供的设备文件系统部分内导航。如前所述，它主要包括媒体数据（`DCIM` 文件夹）、加载到 iBooks
    应用中的书籍（`Books` 文件夹）、iTunes 库（`iTunes_Control` 文件夹）以及用户或应用程序下载的文件（`Downloads` 文件夹）。与之前的选项类似，文件和文件夹可以从设备提取到电脑。'
- en: '![Case study - AFC acquisition with iBackupBot](img/image_03_015.jpg)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 iBackupBot 获取 AFC](img/image_03_015.jpg)'
- en: Lastly, the **Tools** option allows the file extraction of the `System Log`
    and the `Crash Report` folder.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，**工具**选项允许提取 `系统日志` 和 `崩溃报告` 文件夹中的文件。
- en: The `System Log` can be exported in text format and contains the latest information
    on the activity of the device. It is useful if extracted in the immediacy or,
    in general, to support the information attached to the acquisition reports and
    demonstrate at least in part the inevitable changes made to the system during
    extraction.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '`系统日志`可以导出为文本格式，包含设备活动的最新信息。如果在即时性情况下提取，它非常有用，通常也可以支持附加到采集报告中的信息，并至少部分证明在提取过程中对系统所做的不可避免的更改。'
- en: '![Case study - AFC acquisition with iBackupBot](img/image_03_016.jpg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 iBackupBot 获取 AFC](img/image_03_016.jpg)'
- en: The `Crash Report` folder can be extracted in a similar way as the previous
    options. Typically, it contains the information about the last 24-48 hours of
    device usage, but the amount of information present is not determinable a priori,
    because it is affected by several parameters. As will be detailed in [Chapter
    6](ch06.html "Chapter 6. Analyzing iOS Devices"), *Analyzing iOS Devices*, these
    logs may contain information that cannot be extracted by other methods.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '`崩溃报告`文件夹可以通过与前述选项相似的方式提取。通常，它包含设备过去24-48小时使用的信息，但信息的具体数量无法预先确定，因为它会受到多个参数的影响。正如在[第6章](ch06.html
    "第6章：分析 iOS 设备")《分析 iOS 设备》中详细描述的那样，*分析 iOS 设备*，这些日志可能包含无法通过其他方法提取的信息。'
- en: '![Case study - AFC acquisition with iBackupBot](img/image_03_017.jpg)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 iBackupBot 获取 AFC](img/image_03_017.jpg)'
- en: iTunes backup
  id: totrans-120
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: iTunes 备份
- en: '**iTunes backup** acquisition allows the analyst to recover more information
    than the AFC acquisition and in a more forensics way as it creates a backup for
    the device without altering any data. Regarding the passcode, the conditions are
    similar to direct acquisition: the analyst must know the passcode or have a valid
    lockdown certificate to perform this kind of acquisition. Before connecting the
    device, you also need to disable automatic syncing in the iTunes software. This
    acquisition can be performed in two ways, *using iTunes* or *using forensic software*.'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '**iTunes 备份** 获取使分析员能够恢复比 AFC 获取更多的信息，并且以更为取证的方式进行，因为它为设备创建备份而不更改任何数据。关于密码条件，类似于直接获取：分析员必须知道密码或拥有有效的锁定证书才能执行此类获取。在连接设备之前，还需要在
    iTunes 软件中禁用自动同步功能。此获取可以通过两种方式执行，*使用 iTunes* 或 *使用取证软件*。'
- en: Acquisition with iTunes
  id: totrans-122
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用 iTunes 进行数据获取
- en: 'The acquisition through iTunes can be done in a very simple way using the backup
    function of the device. Once you start iTunes, you need to click on the name of
    the device to access detailed information. At this point, you need to check how
    the device is configured in relation to the backup operation. There may be the
    following three cases:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 iTunes 进行的获取可以通过设备的备份功能非常简单地完成。一旦启动 iTunes，需要点击设备的名称以访问详细信息。此时，需要检查设备与备份操作的配置情况。可能会有以下三种情况：
- en: The device is configured to perform a local backup not protected by a password
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设备已配置为执行不受密码保护的本地备份
- en: The device is configured to perform a local backup with a password previously
    set by the device owner
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设备已配置为执行带有设备所有者先前设置的密码的本地备份
- en: The device is configured to backup to iCloud
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 该设备已配置为备份到 iCloud
- en: 'In the first two cases, simply click on the **Back Up Now** button to start
    the backup on the computer, as shown in the following screenshot:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 在前两种情况下，只需点击 **立即备份** 按钮即可在计算机上开始备份，如下图所示：
- en: '![Acquisition with iTunes](img/image_03_018.jpg)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![使用 iTunes 获取数据](img/image_03_018.jpg)'
- en: If the user has not chosen a password, the created backup can be analyzed with
    various tools. Otherwise, the analyst needs to crack the backup password before
    starting the analysis. Both the password cracking and backup structures will be
    discussed in [Chapter 4](ch04.html "Chapter 4. Evidence Acquisition and Analysis
    from iTunes Backup"), *Evidence Acquisition and Analysis from iTunes Backup*.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 如果用户没有选择密码，则创建的备份可以使用各种工具进行分析。否则，分析员在开始分析之前需要破解备份密码。密码破解和备份结构将在[第 4 章](ch04.html
    "第 4 章。来自 iTunes 备份的证据获取与分析")，*来自 iTunes 备份的证据获取与分析*中讨论。
- en: In the third case, before starting the backup, the analyst must change the option
    from **iCloud** to **This computer**. In this way, the backup will be performed
    locally and will not overwrite any existing data present in the previous backups
    on iCloud. The data acquisition from iCloud will be explained in [Chapter 5](ch05.html
    "Chapter 5. Evidence Acquisition and Analysis from iCloud"), *Evidence Acquisition
    and Analysis from iCloud*.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 在第三种情况下，在开始备份之前，分析员必须将选项从 **iCloud** 更改为 **此计算机**。这样，备份将在本地执行，并且不会覆盖 iCloud
    上先前备份中的任何现有数据。来自 iCloud 的数据获取将在[第 5 章](ch05.html "第 5 章。来自 iCloud 备份的证据获取与分析")，*来自
    iCloud 备份的证据获取与分析*中解释。
- en: '![Acquisition with iTunes](img/image_03_019.jpg)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![使用 iTunes 获取数据](img/image_03_019.jpg)'
- en: Acquisition with forensic tools
  id: totrans-132
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用取证工具进行数据获取
- en: In the market, there are various forensic tools that can perform backup acquisition,
    for example, Cellebrite UFED 4PC/UFED Touch/UFED Physical Analyzer, Oxygen Forensic®
    Starter/Analyst/Detective, Mobile Phone Examiner, MobilEdit!, Lantern, and XRY.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 市场上有多种取证工具可以执行备份获取，例如 Cellebrite UFED 4PC/UFED Touch/UFED Physical Analyzer、Oxygen
    Forensic® Starter/Analyst/Detective、Mobile Phone Examiner、MobilEdit!、Lantern 和
    XRY。
- en: Note
  id: totrans-134
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: For a detailed reference list, refer to [Appendix B](apb.html "Appendix B. Tools
    for iOS Forensics"), *Tools for iOS Forensics*.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 有关详细的参考列表，请参阅[附录 B](apb.html "附录 B。iOS 取证工具")，*iOS 取证工具*。
- en: Case study - iTunes backup acquisition with Oxygen Forensic Analyst
  id: totrans-136
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 案例研究 - 使用 Oxygen Forensic Analyst 进行 iTunes 备份获取
- en: '**Oxygen Forensic** software is a commercial product that allows forensic analysts
    to perform iTunes backup acquisition of an iOS device. It is available in three
    licensing modes, **Starter**, **Analyst**, and **Detective**.'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '**Oxygen Forensic** 软件是一个商业产品，允许取证分析员执行 iOS 设备的 iTunes 备份获取。它提供三种许可模式，**Starter**、**Analyst**
    和 **Detective**。'
- en: 'To start the extraction, it is necessary to click on the **Connect device**
    button on the main screen, as shown in the following screenshot:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始提取，必须点击主屏幕上的**连接设备**按钮，如下图所示：
- en: '![Case study - iTunes backup acquisition with Oxygen Forensic Analyst](img/image_03_020.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 Oxygen Forensic Analyst 获取 iTunes 备份](img/image_03_020.jpg)'
- en: The software will then begin the extraction procedure, and you can choose the
    type of connection you want to start. You can choose between **Auto device connection**
    and **Manual device selection**, as shown in the following screenshot. For iDevices,
    it is generally sufficient to select the first option.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 软件将开始提取过程，您可以选择开始连接的方式。您可以选择**自动设备连接**或**手动选择设备**，如下图所示。对于 iDevice，通常选择第一个选项即可。
- en: '![Case study - iTunes backup acquisition with Oxygen Forensic Analyst](img/image_03_021.jpg)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 Oxygen Forensic Analyst 获取 iTunes 备份](img/image_03_021.jpg)'
- en: The software starts searching for a connected iDevice. If the device is locked
    with a passcode, the software asks the analyst to insert the passcode or to provide
    a lockdown certificate. The software provides the UDID for the iDevice, so it
    is easier for the analyst to search it on a computer previously synced with the
    device itself. If the analyst knows the passcode, he/she needs to insert it into
    the device, authorize the computer, and click on **I entered the passcode. Press
    to connect**. Otherwise, he/she can choose the **Select lockdown plist** option
    and provide the tool with a valid lockdown certificate.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 软件开始搜索连接的 iDevice。如果设备设置了密码，软件会要求分析员输入密码或提供锁定证书。软件提供 iDevice 的 UDID，这样分析员可以更容易地在之前与该设备同步过的计算机上搜索该设备。如果分析员知道密码，需将其输入设备，授权计算机，并点击**我输入了密码，点击连接**。否则，他/她可以选择**选择锁定
    plist**选项并提供有效的锁定证书。
- en: '![Case study - iTunes backup acquisition with Oxygen Forensic Analyst](img/image_03_022.jpg)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 Oxygen Forensic Analyst 获取 iTunes 备份](img/image_03_022.jpg)'
- en: 'If the certificate is correct, the software displays a confirmation screen
    with a button to start the connection to the device, as shown in the following
    screenshot:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 如果证书正确，软件会显示一个确认界面，提供一个按钮以开始连接设备，如下图所示：
- en: '![Case study - iTunes backup acquisition with Oxygen Forensic Analyst](img/image_03_023.jpg)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 Oxygen Forensic Analyst 获取 iTunes 备份](img/image_03_023.jpg)'
- en: 'At this point, the software displays information specific to the connected
    device (model, IMEI number, iOS version, and boot loader), as shown in the following
    screenshot:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，软件会显示与连接设备相关的信息（如型号、IMEI 号码、iOS 版本和引导加载程序），如下图所示：
- en: '![Case study - iTunes backup acquisition with Oxygen Forensic Analyst](img/image_03_024.jpg)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 Oxygen Forensic Analyst 获取 iTunes 备份](img/image_03_024.jpg)'
- en: The investigator can then enter information about the case, and if known, the
    backup password for the device.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 调查员可以输入案件的相关信息，如果已知，可以输入设备的备份密码。
- en: '![Case study - iTunes backup acquisition with Oxygen Forensic Analyst](img/image_03_025.jpg)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 Oxygen Forensic Analyst 获取 iTunes 备份](img/image_03_025.jpg)'
- en: 'Then, the analyst can select the data they want to extract by choosing the
    ones supported by this method, as shown in the following screenshot:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，分析员可以通过选择此方法支持的数据来选择他们希望提取的数据，如下图所示：
- en: '![Case study - iTunes backup acquisition with Oxygen Forensic Analyst](img/image_03_026.jpg)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 Oxygen Forensic Analyst 获取 iTunes 备份](img/image_03_026.jpg)'
- en: 'When clicking on the **Next** button, the acquisition procedure starts and
    displays a progress bar. It should be noted that during the extraction, the software
    also proceeds with parsing all the data found, including the search for deleted
    records within the database stored in the phone (for example, calls, SMS, chat,
    and so on). For this reason, the acquisition may require a large amount of time,
    but after that the analyst is ready to parse the data within the software, as
    shown in the following screenshot:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**下一步**按钮后，获取过程将开始并显示进度条。需要注意的是，在提取过程中，软件还会解析所有找到的数据，包括在手机中存储的数据库内搜索已删除记录（例如，通话记录、短信、聊天记录等）。因此，获取过程可能需要较长时间，但在此之后，分析员就可以在软件中解析数据，如下图所示：
- en: '![Case study - iTunes backup acquisition with Oxygen Forensic Analyst](img/image_03_027.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用 Oxygen Forensic Analyst 获取 iTunes 备份](img/image_03_027.jpg)'
- en: 'If the device has a backup password previously set by the user, Oxygen can
    work with **Passware Kit Forensic** (if installed on the computer used to acquire
    data) trying to make an attack on the backup password. If the examiner knows the
    password, he/she has the chance to finish the attack and enter it manually. At
    the end of the cracking process, if the password has been detected, the software
    proceeds with the extraction of all the data, in a similar way as described previously.
    If the password is not found, the software extracts only the multimedia content
    (images, video, books, and so on) and does not provide information about the applications
    preinstalled or installed by the user:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 如果设备之前设置了备份密码，Oxygen可以与**Passware Kit Forensic**（如果安装在用来获取数据的计算机上）协同工作，尝试对备份密码进行攻击。如果检查员知道密码，他/她有机会完成攻击并手动输入密码。在破解过程结束时，如果密码被找到，软件将按照之前描述的方式提取所有数据。如果密码未找到，软件仅提取多媒体内容（如图片、视频、书籍等），并且不会提供有关预装或用户安装的应用程序的信息：
- en: '![Case study - iTunes backup acquisition with Oxygen Forensic Analyst](img/image_03_028.jpg)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用Oxygen Forensic Analyst进行iTunes备份获取](img/image_03_028.jpg)'
- en: Advanced logical acquisition
  id: totrans-156
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 高级逻辑获取
- en: 'The advanced logical acquisition method was first introduced by the iOS security
    researcher Jonathan Zdziarski in his tool, **Waterboard**, released in June 2013\.
    The author''s description in his article states:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 高级逻辑获取方法最早是由iOS安全研究员Jonathan Zdziarski在2013年6月发布的工具**Waterboard**中引入的。作者在其文章中的描述如下：
- en: '*"Waterboard is an open source iOS forensic imaging tool, capable of performing
    an advanced logical acquisition of iOS devices by utilizing extended services
    and back doors in Apple''s built-in lockdown services. These services can bypass
    Apple''s mobile backup encryption and other encryption to deliver a clear text
    copy of much of the filesystem to any machine that can or has previously paired
    with the device."*'
  id: totrans-158
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*"Waterboard是一个开源的iOS取证成像工具，能够通过利用Apple内建的锁定服务中的扩展服务和后门，执行iOS设备的高级逻辑获取。这些服务可以绕过Apple的移动备份加密和其他加密，提供大部分文件系统的明文副本到任何能够或曾经与设备配对的机器。"*'
- en: A detailed explanation can be found in the paper *Identifying Back Doors*, *Attack
    Points*, *and Surveillance Mechanisms in iOS Devices*, by *Jonathan Zdziarski*
    (refer to [Appendix A](apa.html "Appendix A. References"), *References*). Currently,
    the Waterboard tool is no longer available and supported by Zdziarski, but there
    are few forensic tools offering the same feature, UFED Physical Analyzer, Oxygen
    Forensics Toolkit, and AccessData MPE.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 详细说明可参见*Jonathan Zdziarski*的论文《识别iOS设备中的后门、攻击点和监控机制》(*Identifying Back Doors*,
    *Attack Points*, *and Surveillance Mechanisms in iOS Devices*)（参见[附录A](apa.html
    "附录A. 参考文献")，*参考文献*）。目前，Waterboard工具已不再由Zdziarski提供和支持，但仍有少数取证工具提供相同功能，如UFED Physical
    Analyzer、Oxygen Forensics Toolkit和AccessData MPE。
- en: This method has been made unavailable starting from iOS 8, also due to the discovery
    of Zdziarski. On devices not yet updated, which are running iOS 7, the method
    is still usable; but even in this case it is necessary that the device is unlocked
    or that a valid lockdown certificate is available.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 从iOS 8开始，由于Zdziarski的发现，这种方法已不再可用。在尚未更新、仍运行iOS 7的设备上，这种方法仍然可用；但即便如此，设备必须解锁或有有效的锁定证书才行。
- en: Case study - advanced logical acquisition with UFED Physical Analyzer
  id: totrans-161
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 案例研究 - 使用UFED Physical Analyzer进行高级逻辑获取
- en: 'UFED Physical Analyzer is a software product from Cellebrite UFED and supplied
    with the purchase of UFED Touch or UFED 4PC. The advanced logical acquisition
    in UFED Physical Analyzer can be started through the main interface of the software
    under the menu item, **iOS Device Extraction** under **Extract**, as shown in
    the following screenshot:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: UFED Physical Analyzer是Cellebrite UFED的一个软件产品，并与UFED Touch或UFED 4PC的购买一起提供。UFED
    Physical Analyzer中的高级逻辑获取可以通过软件主界面的**提取**菜单项下的**iOS设备提取**启动，如下图所示：
- en: '![Case study - advanced logical acquisition with UFED Physical Analyzer](img/image_03_029.jpg)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用UFED Physical Analyzer进行高级逻辑获取](img/image_03_029.jpg)'
- en: The analyst can now choose **Advanced Logical extraction**.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 分析师现在可以选择**高级逻辑提取**。
- en: '![Case study - advanced logical acquisition with UFED Physical Analyzer](img/image_03_030.jpg)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![案例研究 - 使用UFED Physical Analyzer进行高级逻辑获取](img/image_03_030.jpg)'
- en: 'The software requires you to connect the turned-on device using the correct
    cable (30-pin connector or Lightning 8-pin connector), as shown as follows:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - advanced logical acquisition with UFED Physical Analyzer](img/image_03_031.jpg)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
- en: The device must be powered on and unlocked; otherwise, the software displays
    a message stating **The iOS device is locked or untrusted**. To proceed, the analyst
    must unlock the device with the passcode or provide the right lockdown certificate.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - advanced logical acquisition with UFED Physical Analyzer](img/image_03_032.jpg)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
- en: 'The software checks whether a password is set on the backup device and shows
    two possible methods for the acquisition: **Method 1** corresponds to a device
    backup, while **Method 2** allows the analyst to extract data using both the AFC
    protocol and the lockdown service (advanced logical acquisition). If the device
    is jailbroken then **Method 3** will show up to allow a complete filesystem dump.'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - advanced logical acquisition with UFED Physical Analyzer](img/image_03_033.jpg)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
- en: If the device has a backup password with **Method 1**, the analyst must know
    the password or crack it (as explained in [Chapter 4](ch04.html "Chapter 4. Evidence
    Acquisition and Analysis from iTunes Backup"), *Evidence Acquisition and Analysis
    from iTunes Backup*), while with **Method 2**, it is possible to extract part
    of the data even without cracking the backup password. For this reason, when you
    need to acquire a device with a backup password, it is advisable to perform both
    acquisitions. In this way, you can definitely see some information, thanks to
    **Method 2**, and try to recover more details by cracking the encrypted acquisition
    carried out with **Method 1**.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
- en: If the device does not have a backup password then Physical Analyzer will propose
    the option to encrypt the backup with a known password. This is because certain
    files, such as the keychain, are in this case encrypted with the chosen backup
    password and so it is possible to recover more information (that is, user stored
    passwords).
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
- en: Once you select the extraction method, the software initiates the procedure
    requiring the user to set the destination folder. Scanning takes a variable time
    depending on the chosen method (**Method 1** is performed in a single step and
    is faster than **Method 2**, which requires three steps), the memory size of the
    device, and the space occupied by files (especially media files such as pictures,
    videos, music, and so on).
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
- en: Once the acquisition is complete, the software displays a report showing the
    amount of extracted data and the time taken, as shown in the following screenshot.
    From this window, the analyst can choose whether to return to the home screen
    or open the acquisition made in UFED Physical Analyzer for the analysis activities.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - advanced logical acquisition with UFED Physical Analyzer](img/image_03_034.jpg)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
- en: Physical acquisition with forensic tools
  id: totrans-177
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Physical acquisition** allows most of the content from an iOS device to be
    extracted. Unlike the AFC, backup, and advanced logical methods, the analyst can
    obtain a forensic copy of the device''s internal NAND storage and access all the
    files stored there. Some examples of interesting information that can only be
    retrieved through physical acquisition are the e-mail messages and log files of
    the device. The physical acquisition is based on hardware vulnerabilities during
    the boot process. For this reason, this operation is not invasive on the data
    stored on the iDevice because it uploads an alternative operating system directly
    into RAM through which it can launch acquisition commands. Currently, it is supported
    on the first iPhone model 3G/3GS/4, iPad 1, and iPod touch 1/2/3/4.'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
- en: If the device is not protected by a passcode, the physical acquisition can be
    carried out without problems by creating an image of both system and data partitions.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
- en: 'If the iDevice is protected with a passcode, it is necessary to highlight the
    following two cases:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
- en: If the passcode is simple (4 digits), it can be cracked in 20 to 30 minutes,
    depending on the device type
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'If the passcode is complex (multidigit or alphanumeric) the analyst has the
    following two options:'
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Try a brute force or a dictionary attack on the passcode.
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Perform the physical acquisition without cracking the passcode. In this case,
    the physical acquisition will decode all the data whose encryption does not depend
    on the passcode, while other data (for example, e-mail, stored passwords, and
    so on) cannot be decrypted.
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Several forensic tools can perform physical acquisition, such as iPhone data
    protection tools, UFED Physical Analyzer, Elcomsoft iOS Forensic Toolkit, Lantern,
    AccessData MPE+, iXAM, and XRY.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-186
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: For a more comprehensive and detailed list of tools, books, and papers related
    to physical acquisition, refer to [Appendix A](apa.html "Appendix A. References"),
    *References*, and [Appendix B](apb.html "Appendix B. Tools for iOS Forensics"),
    *Tools for iOS Forensics*.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
- en: Case study - physical acquisition with UFED Physical Analyzer
  id: totrans-188
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Physical acquisition using UFED Physical Analyzer can be started through the
    main interface of the software from the menu item **iOS Device Extraction**, under
    **Extract**, as follows:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with UFED Physical Analyzer](img/image_03_035.jpg)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
- en: The device must be powered off and then the analyst can connect the correct
    cable to the computer (and not yet to the iDevice).
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with UFED Physical Analyzer](img/image_03_036-1.jpg)'
  id: totrans-192
  prefs: []
  type: TYPE_IMG
- en: 'Now, the investigator must connect the device in **Recovery** mode. It means
    that they need to press and hold the Home button and connect the device, as shown
    in the following screenshot:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with UFED Physical Analyzer](img/image_03_037-2.jpg)'
  id: totrans-194
  prefs: []
  type: TYPE_IMG
- en: 'The software displays the information related to the device (the **iOS version**,
    **serial number**, **Board**, **IBoot firmware version**, **Chip ID**, and so
    on), as shown in the following screenshot:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with UFED Physical Analyzer](img/image_03_038-1.jpg)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
- en: Now, the device must be set in DFU mode by pressing the **Power** and **Home**
    buttons together, and release the Power button 3 seconds after the device's screen
    becomes black.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with UFED Physical Analyzer](img/image_03_039-1.jpg)'
  id: totrans-198
  prefs: []
  type: TYPE_IMG
- en: 'The software uploads the boot loader in memory and provides the analyst with
    two options: **Physical Extraction** and **File System Extraction**, as shown
    in the following screenshot. The first one extracts a physical image of the encrypted
    data partition, so the extraction can be viewed in UFED Physical Analyzer and
    in other analysis tools. UFED also provides information about the passcode protection.
    If the device is not protected by a passcode, it can start the acquisition immediately
    and decrypt all the files.'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with UFED Physical Analyzer](img/image_03_040-1.jpg)'
  id: totrans-200
  prefs: []
  type: TYPE_IMG
- en: Otherwise, it depends on the passcode type. If the device has a simple passcode
    (four digits), it can be cracked in 20 to 30 minutes (depending on the iDevice
    type) by choosing the **Passcode recovery** option.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with UFED Physical Analyzer](img/image_03_041.jpg)![Case
    study - physical acquisition with UFED Physical Analyzer](img/image_03_042.jpg)![Case
    study - physical acquisition with UFED Physical Analyzer](img/image_03_043.jpg)'
  id: totrans-202
  prefs: []
  type: TYPE_IMG
- en: 'At the end of the cracking stage, the software shows the passcode and gives
    the opportunity to start the acquisition, as follows:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with UFED Physical Analyzer](img/image_03_044.jpg)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
- en: 'If the device has a complex passcode, the analyst has two options: either acquire
    a physical image without cracking the passcode (this means that some data will
    not be available, for example, e-mails, and stored passwords) or try to crack
    the passcode with a dictionary attack.'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with UFED Physical Analyzer](img/image_03_045.jpg)![Case
    study - physical acquisition with UFED Physical Analyzer](img/image_03_046.jpg)![Case
    study - physical acquisition with UFED Physical Analyzer](img/image_03_047.jpg)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
- en: Dealing with a locked iDevice
  id: totrans-207
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The main problem, as already mentioned in the description of the various acquisition
    methods, is the presence of a lock code set by the user.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: 'For devices up to iPhone 4, iPad 1, and iPod touch up to version 4, you can
    work around the presence of a lock code with the ability to load into RAM an operating
    system different from the original iOS: if the passcode is simple (four digits)
    the brute force time is a maximum of 30 minutes, increasing by several orders
    of magnitude (months or years) as the complexity of the passcode increases. In
    any case, for these types of device, the encryption is restricted to certain types
    of file (mainly e-mails and third-party application data), while for the system
    data the encryption does not depend on the passcode: for this reason, a physical
    acquisition allows access to such data.'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
- en: 'For the later devices, that is, all those also compatible with iOS 9, there
    are three available techniques to violate or bypass the passcode lock:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
- en: Use a valid lockdown certificate
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Use a tool that allows submitting the passcode to the device via USB port instead
    of the touch screen
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Get support from companies that developed proprietary techniques able to brute
    force the passcode
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The first technique is applicable to all versions of iOS, including iOS 9\.
    In this case, it is necessary that two conditions are met: the device, even if
    locked, must have been found switched on and maintained in this condition, and
    the same must have been unlocked at least once in the past 48 hours. It is therefore
    clear that this method should be used immediately with respect to the seizure
    or discovery of the device, immediately seeking a computer that may hold a valid
    certificate and proceeding with an acquisition as quickly as possible. The use
    of a valid certificate allows for all devices, including those with iOS 9, the
    acquisition by AFC Protocol, and acquisition through backup. On devices with iOS
    7 it also allows to make the advanced logical acquisition.'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
- en: The second method can be used on all devices but only up to iOS 8.1\. Several
    hardware devices have been made available on the market and are all based, essentially,
    on the principle of passing the passcode via USB and not through the touch screen.
    The best-known and most commonly used forensic software is the UFED User Lock
    Code Recovery Tool by Cellebrite, available in the licenses of the software UFED
    4PC and UFED Touch. It runs on iOS 7\. Other devices, which are not born as forensic
    tools but very much used in the community, are IP-BOX, MFC dongle, SecureView's
    svStrike, and HDB Box.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
- en: 'These devices, through an additional adapter, can also be used on operating
    systems up to iOS 8.1\. It''s important to note that none of these tools manage
    to overcome the limitation, which can be activated by the user, of secure wiping
    after 10 incorrect attempts at entering the code: this limitation stays in place
    also when the code is submitted to the phone through the USB port. For this reason,
    these techniques need to be applied if and only if it is certain that wiping is
    not active on the device.'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
- en: '![Dealing with a locked iDevice](img/image_03_048.jpg)'
  id: totrans-217
  prefs: []
  type: TYPE_IMG
- en: The alternative solution is to get support from some specialized company that
    has developed proprietary techniques to recover the passcode that have not yet
    been implemented in software and hardware on the market. At the time of writing
    this edition of the book, the only company offering this service is Cellebrite
    through the **Cellebrite Advanced Investigative Services** (**CAIS**) center.
    As reported in the company's website ([http://www.cellebrite.com/Pages/cellebrite-unlocking-services-now-available-for-apple-ios-9-and-samsung-galaxy-s6-and-s7-devices](http://www.cellebrite.com/Pages/cellebrite-unlocking-services-now-available-for-apple-ios-9-and-samsung-galaxy-s6-and-s7-devices)),
    the service is available for all devices with a 32-bit processor (that is, iPhone
    4s/5/5c, iPad 2/3G/4G, iPad mini 1G, and iPod touch 5G) with any version of iOS
    8 operating system (that is, 8 - 8.0/8.0.1/8.0.2/8.1/8.1 .1/8.1.2/8.1.3/8.2/8.3/8.4/8.4.1)
    or iOS 9 operating system (that is, 9.0/9.0.1/9.0.2/9.1/9.2/9.2.1/9.3/9.3.1/9.3.2).
    The company ensures that there will be no physical invasiveness on the device
    (that is, there is no need of any hardware intervention) and the non-activation
    of the wiping function after 10 incorrect attempts.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-219
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**From a Real Case**'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
- en: 'At the beginning of 2016, one of the authors of the book was appointed Expert
    Witness from the Court of Milan as part of the criminal proceedings against Alexander
    Boettcher, accused together with his girlfriend Martina Levato, of having made
    four acid attacks against her ex-boyfriends. At the time when the couple was arrested
    (December 2014), Boettcher got his iPhone 5 running iOS 8.0 seized, which was
    locked with a 4-digit passcode that he said he did not remember. At that time,
    there were no known techniques that allowed bypassing the code without activating
    Apple protection systems (for example, wiping encryption keys after 10 incorrect
    entries), and for this reason the prosecutor and the Judiciary Police have decided
    to analyze the other devices, finding a backup on the computer of the suspect
    made in September 2014\. During the hearings in January 2016, it was deemed to
    be useful by the Judges evaluating new possibilities to access the data. They
    then appointed one of the authors asking technical advice to evaluate new possibilities
    in this regard. The consultant therefore decided to contact the CAIS service offered
    by the company Cellebrite and in February 2016 brought the phone to their EU headquarters
    in Munich, Germany, where the passcode was detected after two days of work, allowing
    in this way the acquisition of the device through the backup mode and AFC protocol.
    The news has been the subject of attention by the Italian national press for the
    notoriety of the case, and the international press, given the temporal proximity
    with having Apple vs. FBI (refer, for example, to *Apple-FBI Case: this is how
    the iPhone for the investigation of acid attacks in Milan was unlocked* - [http://www.lastampa.it/2016/03/01/tecnologia/news/come-stato-sbloccato-liphone-nel-caso-delle-aggressioni-con-lacido-a-milano-3hmkkOwVQsiCFtkjjJbt5O/pagina.html](http://www.lastampa.it/2016/03/01/tecnologia/news/come-stato-sbloccato-liphone-nel-caso-delle-aggressioni-con-lacido-a-milano-3hmkkOwVQsiCFtkjjJbt5O/pagina.html),
    and *It Might Cost The FBI Just $ 1.500 To Get Into Terrorist''s iPhone*: [http://www.forbes.com/sites/thomasbrewster/2016/03/23/cellebrite-apple-iphone-fbi-syed-farook-alexander-boettcher/](http://www.forbes.com/sites/thomasbrewster/2016/03/23/cellebrite-apple-iphone-fbi-syed-farook-alexander-boettcher/)).'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
- en: In addition to these techniques, other methods have been used in practice to
    bypass the lock code. The best known are the use of vulnerabilities on the specific
    version of the operating system that allow access to the device's screen (often
    associated with the application Siri), or forcing the generation of a backup to
    iCloud and bringing the device into the proximity of a known Wi-Fi network.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
- en: iOS device jailbreaking
  id: totrans-223
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**iOS jailbreaking** is the process of removing limitations on the iOS devices
    through the use of software and hardware exploits. It enables root access to the
    iOS filesystem and allows additional applications not available in the official
    Apple App Store to be downloaded. Various jailbreaking tools have been developed;
    an always updated list can be found at [http://theiphonewiki.com/wiki/Jailbreak](http://theiphonewiki.com/wiki/Jailbreak).
    Currently, the latest available tools are **Evasi0n** ([http://evasi0n.com/](http://evasi0n.com/))
    for iOS 7, **Taig** ([http://www.taig.com/en/](http://www.taig.com/en/)) for iOS
    8, and **Pangu** ([http://en.pangu.io/](http://en.pangu.io/)) for iOS 7, 8, and
    9.'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
- en: Jailbreaking is an invasive activity on the device system partition, so it cannot
    be considered as a forensic operation. However, it is useful to note that for
    devices after iPhone 4, it is the only way to make a physical acquisition. It
    is therefore necessary that the device is already jailbroken or that the investigator
    can jailbreak it. On newer devices, in order to jailbreak the device, the analyst
    needs to know the passcode, since it requires actions to be performed directly
    on the unlocked device.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
- en: Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit
  id: totrans-226
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: At the time of writing, jailbreaking is supported up to iOS 9.3.3 by Pangu jailbreaking,
    and the **Elcomsoft iOS Forensic Toolkit** (**EIFT**) software is the only commercial
    tool that permits a physical acquisition of a jailbroken device. It currently
    works on both 32- and 64-bit devices, but in the first case, it can extract a
    physical image, while in the second it can recover a full filesystem dump of the
    device. It is important to mention that although a physical image is different
    from a filesystem image, in the current state of the art there is effectively
    no difference between a filesystem and a physical image of these devices from
    a usable content point of view, because the unallocated space of a physical image
    is encrypted, and at the time of writing, there are still no known techniques
    to carve and decrypt from the unallocated space. As a result, you are effectively
    getting the content of a filesystem image with your physical image because you
    can't read the unallocated areas. Moreover, both Cellebrite and MPE+ support getting
    a full filesystem dump of jailbroken devices.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
- en: If the seized device is already jailbroken and the root password was not changed
    by the user (recall from [Chapter 1](ch01.html "Chapter 1. Digital and Mobile
    Forensics"), *Digital and Mobile Forensics*, that the default root password is
    *alpine*) it is also possible to try cracking the passcode.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
- en: This commercial tool can be used both on Windows or Mac. The following screenshots
    show the acquisition procedure performed with EIFT version 2.0 of a jailbroken
    iPad mini first generation with a passcode and iOS 9.0.2.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit](img/image_03_049.jpg)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
- en: 'The wizard is very simple and basically involves the following steps:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
- en: Get the passcode (option `3`)
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Extraction of the encryption keys (option `4`)
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Physical acquisition of the system partition (in plain text) and data partition
    (encrypted) (option `6`)
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Decryption of the data partition with the extracted keys (option `7`)
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The first step loads a tool on the device to crack the passcode and then, with
    a simple passcode in this case, starts the cracking activity. At the end, it prints
    the passcode on the screen and saves it in a `.txt` file.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit](img/image_03_050.jpg)'
  id: totrans-237
  prefs: []
  type: TYPE_IMG
- en: The second step extracts encryption keys from the device; these keys are necessary
    to decrypt the physical acquisition. It saves the decryption keys in a `plist`
    file (default name `keys.plist`) and prints the backup password (if it exists)
    and the AppleID for the device on the screen.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit](img/image_03_051.jpg)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
- en: The third step creates a forensic image of the system and data partition. The
    first one is not encrypted, while the second one is. This step produces in output
    two DD files; the second one needs to be decrypted.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit](img/image_03_052.jpg)'
  id: totrans-241
  prefs: []
  type: TYPE_IMG
- en: The fourth step takes as input the encrypted data partition and the `keys.plist`
    file and produces an unencrypted version of the DD image as output. This image
    can be imported and analyzed in various tools, both specifically for mobile devices
    (for example, UFED Physical Analyzer, Oxygen Forensic, and Internet Evidence Finder)
    or traditional forensics toolkit (for example, Encase, FTK, and X-Ways).
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit](img/image_03_053.jpg)'
  id: totrans-243
  prefs: []
  type: TYPE_IMG
- en: Apple support for law enforcement
  id: totrans-244
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'On a regular basis, Apple publishes a document on its website called *Legal
    Process Guidelines for U.S. Law Enforcement*. These guidelines contain information
    on how to request Apple support to recover information from iCloud or from an
    iDevice, and specify the data that Apple, in some cases, can extract from a passcode-protected
    device. Apple''s latest available version ([https://www.apple.com/privacy/docs/legal-process-guidelines-us.pdf](https://www.apple.com/privacy/docs/legal-process-guidelines-us.pdf))
    states:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
- en: '"For all devices running iOS 8.0 and later versions, Apple will not perform
    iOS data extractions as data extraction tools are no longer effective. The files
    to be extracted are protected by an encryption key that is tied to the user''s
    passcode, which Apple does not possess. For iOS devices running iOS versions earlier
    than iOS 8.0, upon receipt of a valid search warrant issued upon a showing of
    probable cause, Apple can extract certain categories of active data from passcode
    locked iOS devices. Specifically, the user generated active files on an iOS device
    that are contained in Apple''s native apps and for which the data is not encrypted
    using the passcode ("user generated active files"), can be extracted and provided
    to law enforcement on external media. Apple can perform this data extraction process
    on iOS devices running iOS 4 through iOS 7\. Please note the only categories of
    user generated active files that can be provided to law enforcement, pursuant
    to a valid search warrant, are: SMS, iMessage, MMS, photos, videos, contacts,
    audio recording, and call history. Apple cannot provide: e-mail, calendar entries,
    or any third-party app data."'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
- en: This method was used by the South Africa police, who requested help from Apple
    in order to access data stored on Oscar Pistorious' iPhone.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
- en: Apple versus FBI - The San Bernardino shooting case
  id: totrans-248
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In December 2015, 14 innocent people lost their lives in the San Bernardino
    terrorist attack. The shooters, killed by the police, had managed to destroy all
    their devices but one prior to the attack, the work phone of Syed Rizwan Farook.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
- en: 'Farook''s phone was an iPhone 5s, running iOS 8, protected with a four-digit
    pin code, and it was found powered off (although there is quite some confusion
    on this point, as at a first stage the device appeared to have been found powered
    on). As you have learned in this chapter, there is no known technique that''s
    able to bypass and unlock a device in this scenario. The only chance the FBI had
    was to try the luck of guessing/brute forcing the correct PIN within the first
    nine attempts before the device would wipe itself after 10 incorrect PIN entries.
    For this reason, on February 2016, the FBI reached Apple with a compelling order
    ([https://assets.documentcloud.org/documents/2714005/SB-Shooter-Order-Compelling-Apple-Asst-iPhone.pdf](https://assets.documentcloud.org/documents/2714005/SB-Shooter-Order-Compelling-Apple-Asst-iPhone.pdf))
    asking to provide assistance to accomplish the following:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
- en: It will bypass or disable the autoerase function whether or not it has been
    enabled
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: It will enable the FBI to submit passcodes to the SUBJECT DEVICE for testing
    electronically via the physical device port, Bluetooth, Wi-Fi, or other protocol
    available
  id: totrans-252
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: It will ensure that when the FBI submits passcodes to the SUBJECT DEVICE, software
    running on the device will not purposefully introduce any additional delay between
    passcode attempts beyond what is incurred by Apple hardware
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Furthermore, in the court order, it was also specified that Apple's assistance
    may include providing software to the FBI that will be coded by Apple with a unique
    identifier of the phone so that the software would only load and execute on the
    SUBJECT DEVICE. What all this means is that the FBI asked Apple to develop a backdoor
    into iOS devices.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
- en: 'Apple refused to comply with the order stating, in an open letter by its CEO,
    Tim Cook ([http://www.apple.com/customer-letter/](http://www.apple.com/customer-letter/)),
    that:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
- en: '*"The United States government has demanded that Apple take an unprecedented
    step which threatens the security of our customers. We oppose this order, which
    has implications far beyond the legal case at hand. This moment calls for public
    discussion, and we want our customers and people around the country to understand
    what is at stake."*'
  id: totrans-256
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: On March 28, the FBI announced that it had unlocked the suspect's iPhone with
    a third party's help, without giving any further details on the *who* and the
    *how*. Coincidently enough, on the very same day, the FBI cut an order of *$218,004.85*
    to Cellebrite ([https://www.fpds.gov/ezsearch/fpdsportal?q=cellebrite+CONTRACTING_AGENCY_NAME%3A%22FEDERAL+BUREAU+OF+INVESTIGATION%22+PIID%3A%22DJF161200G0004569%22&s=FPDSNG.COM&templateName=1.4.4&indexName=awardfull&x=0&y=0&sortBy=SIGNED_DATE&desc=Y](https://www.fpds.gov/ezsearch/fpdsportal?q=cellebrite+CONTRACTING_AGENCY_NAME%3A%22FEDERAL+BUREAU+OF+INVESTIGATION%22+PIID%3A%22DJF161200G0004569%22&s=FPDSNG.COM&templateName=1.4.4&indexName=awardfull&x=0&y=0&sortBy=SIGNED_DATE&desc=Y)),
    which of course led the speculation on the identity of the third party who was
    able to unlock the iPhone. However, on April 7, the FBI Director, James Comey,
    indicated that the tool had cost more than $1.3 million and the Washington Post
    reported, from an anonymous source, that the FBI had paid professional hackers
    which used a zero-day vulnerability to bypass the 10 PIN attempt limitation, allowing
    the FBI to brute force the four-digit PIN without the risk of wiping the device
    ([https://www.washingtonpost.com/world/national-security/fbi-paid-professional-hackers-one-time-fee-to-crack-san-bernardino-iphone/2016/04/12/5397814a-00de-11e6-9d36-33d198ea26c5_story.html](https://www.washingtonpost.com/world/national-security/fbi-paid-professional-hackers-one-time-fee-to-crack-san-bernardino-iphone/2016/04/12/5397814a-00de-11e6-9d36-33d198ea26c5_story.html)).
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
- en: Leaving out the legal and ethical aspects, there are still a few things worth
    considering. First of all, it is clear that, technically speaking, Apple would
    have been able to comply with the court order, but as the last point on the resolution
    proves, there were other ways to obtain the result. Another point to highlight
    is that the only reason the FBI was able to make such a request is because the
    user had chosen a weak four-digit PIN. If he had picked a complex passcode instead,
    it would have been unfeasible to brute force it even without the 10 attempts limitation
    due to the password derivation function used by Apple (`PBKDF2`), in which the
    encryption routines implement an 80 ms delay to compute the key, resulting in
    six years just to brute force a six-digit alphanumeric key, and as an obvious
    consequence, exponentially more time for longer keys.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
- en: Last but not least, there was one big mistake made by the FBI from a forensics
    point of view. As soon as the iPhone had been recovered, the FBI made the San
    Bernardino County (which was the legal owner of the phone) reset the iCloud password.
    If the iPhone had really been found switched off, this would not have made difference
    since, in order to connect to a Wi-Fi network, a valid access code was required
    to be entered at least once after reboot. However, if the phone was found powered
    on, as it may look like from conflicting statements and testimonies, resetting
    the password made the automatic iCloud backup unfeasible as the iCloud password
    on the phone would still have been the old (at this point invalid) one.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
- en: Finally, this has definitely been a controversial case for different reasons,
    but nevertheless an interesting case study to learn from.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
- en: iOS Acquisition - choose the best method
  id: totrans-261
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As you may have probably understood from reading this chapter, being able to
    choose the right technique to acquire an iOS device is not trivial and it depends
    on many different parameters. In this section we try to list, for each of the
    different device families, the best acquisition method available depending on
    the different versions of the operating system and whether a passcode is set or
    not.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
- en: iPhone 3G/3GS/4, iPad 1
  id: totrans-263
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For these devices, it is always advisable to perform a physical acquisition
    using one of the forensic software that supports it. If a simple passcode is set
    (four digits), it is always possible to crack it in a short time, and therefore
    obtain a forensic image of the device's internal memory (both data and system
    partitions). In the case of a complex passcode being set, it is possible to obtain
    a physical acquisition, although not all files in it will be decrypted.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
- en: iPhone 4s, 5, 5c, iPad 2/3/4, iPad Mini 1
  id: totrans-265
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For these devices, we must distinguish according to the presence of the passcode
    and the operating system version.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
- en: In the case of devices with no passcode, it is always possible to carry out
    the acquisition via the AFC protocol (with varying results depending on the operating
    system version, but always with the ability to extract the Crash Logs) and via
    iTunes backup
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-268
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The user may have set a password on the backup and such a password can be cracked
    offline as described in [Chapter 4](ch04.html "Chapter 4. Evidence Acquisition
    and Analysis from iTunes Backup"), *Evidence Acquisition and Analysis from iTunes
    Backup*.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
- en: On devices with iOS 7, it is also possible to acquire via advanced logical.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
- en: 'In the case of devices protected by passcode, we have several techniques depending
    on the operating system version. Until iOS 7, you can do the following: use a
    lockdown certificate to carry out the acquisition directly (via AFC, advanced
    logical, or Backup), use the Apple service in support of law enforcement, use
    the CAIS service offered by Cellebrite, use a hardware tool to unlock the device
    (for example, IP-BOX) or detect the presence of an iCloud backup (refer to [Chapter
    5](ch05.html "Chapter 5. Evidence Acquisition and Analysis from iCloud"), *Evidence
    Acquisition and Analysis from iCloud* for details). Starting from iOS 8, it is
    no longer possible to get support from Apple, while you still can, with certain
    limitations, use the lockdown certificate (only for backup and AFC acquisitions,
    and only if the phone was found switched on and unlocked at least once in the
    past 48 hours) and hardware devices for unlocking (up to iOS 8.1). The use of
    CAIS service by Cellebrite and iCloud backup is also a viable option.'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
- en: iPhone 5s, 6, 6Plus, 6s, 6s Plus, iPad Air 1/2, iPad Mini 2/3/4, iPad Pro
  id: totrans-272
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Similar to the previous section, an unlocked device can always be acquired via
    the AFC protocol and iTunes backup. For devices such as iPhone 5s, iPad Air, and
    iPad Mini 2 with iOS 7 it is also possible to acquire via advanced logical.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
- en: In the case of locked devices, we have to distinguish by device and operating
    system version.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
- en: For devices such as iPhone 5s, iPad Air, and iPad Mini 2 with iOS 7, it is possible
    to use the lockdown certificate, request support from Apple, or use unlocking
    hardware devices.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
- en: For all devices with iOS 8 or 9, the only practicable roads are using a valid
    lockdown certificate or acquiring iCloud backups.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
- en: Apple TV
  id: totrans-277
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The acquisition of data from Apple TV devices is particularly complex, as there
    are no available native backup procedures. Tests carried out by the authors on
    the Apple TV version 3 have allowed us to understand that the AFC protocol is
    active on the device. Since the device cannot be password protected, this method
    is always applicable.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshots show the general details extracted with the iTools
    software from an Apple TV version 3:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
- en: '![Apple TV](img/image_03_054-1.jpg)'
  id: totrans-280
  prefs: []
  type: TYPE_IMG
- en: Real Time Log permits us to identify the latest activities performed by the
    device (that is, last days of activity, Wi-Fi connection, and so on).
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
- en: '![Apple TV](img/image_03_055-1.jpg)'
  id: totrans-282
  prefs: []
  type: TYPE_IMG
- en: With iTools, it is also possible to extract Crash Logs, which allow the reconstruction
    of a timeline of the device's usage.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
- en: '![Apple TV](img/image_03_056-1.jpg)'
  id: totrans-284
  prefs: []
  type: TYPE_IMG
- en: Finally, it is also possible to extract a limited part of the filesystem containing,
    for example, the iTunes library, from which you can locate the account information
    used and the purchases made.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
- en: '![Apple TV](img/image_03_057-1.jpg)'
  id: totrans-286
  prefs: []
  type: TYPE_IMG
- en: Apple Watch
  id: totrans-287
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The acquisition of the Apple Watch data is still a little explored and tested
    area. Of particular interest is the presentation of Sarah Edwards and Heather
    Mahalik *Times a' Ticking... to Forensicate the Apple Watch*, in 2015\. The presentation
    shows the test results of the analysis of an iPhone backup device synchronized
    with an Apple Watch and the identification of different information of interest
    (information about the device, installed applications, address book, e-mails,
    voicemails, passbook, and so on)
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-289
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we introduced the four most commonly used methods to acquire
    data from iDevices-AFC, iTunes backup, advanced logical, and physical. The backup
    acquisition can be performed on any device but the device needs to be unlocked,
    the analyst needs to know the passcode, or the analyst has a valid lockdown certificate
    extracted from a computer the device was previously synced with. If the user sets
    a password on the backup, the resulting acquisition is encrypted and so the analyst
    needs to try cracking the backup password (this topic is covered in detail in
    [Chapter 4](ch04.html "Chapter 4. Evidence Acquisition and Analysis from iTunes
    Backup"), *Evidence Acquisition and Analysis from iTunes Backup*). If the device
    is locked and the analyst doesn't know the code, or he/she doesn't have a valid
    lockdown certificate, other techniques are available request Apple support (up
    to iOS 7), use a hardware unlocking tool (up to iOS 8.1), use a third-party service
    (up to iOS 9.3.2 and limited to 32-bit devices) or search for a backup on iCloud.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
- en: The advanced logical acquisition can be performed with the same conditions of
    the backup acquisition, but it can bypass the restrictions imposed by the backup
    password and extract the contents in clear text without the need to crack the
    backup password. Apple stopped this method from working starting from iOS 8.0.
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
- en: 'Physical acquisition depends on the device and the operating system installed
    as follows:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
- en: iPhone 2G/3G/3GS and iPod touch 1/2 with iOS 3 don't implement encryption and
    so it is always possible to perform physical acquisition and the lock code can
    be cracked instantaneously. The resulting image is not encrypted. So, it is possible
    to carve deleted records.
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: On iPhone 3GS/4, iPad 1, and iPod touch 3/4 with iOS 4/5/6/7, it is always possible
    to perform physical acquisition. If the lock code is four digits long, it can
    be cracked in less than 20 minutes. So, it is possible to recover all the files.
    If a complex passcode is in use, the analyst can try to crack it with a brute
    force or dictionary attack. If it's not possible to crack it, it is possible to
    perform physical acquisition, and decode the filesystem (with the extracted filesystem
    key) and all the files whose encryption does not depend on passcode.
  id: totrans-294
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: On iPhone 4s/5/5c, iPad2/3/4, iPad mini 1, and iPod touch 5 with iOS 4/5/6/7/8/9,
    physical acquisition is possible only if the device is already jailbroken or if
    it is possible to jailbreak it (this means that the analyst must know the code).
  id: totrans-295
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: On iPhone 5s/6/6 Plus/6s/6s Plus, iPad Air 1/2, iPad mini 2/3/4, and iPad Pro,
    it is not currently possible to perform a physical acquisition although there
    are studies and research on it. If the device is jailbroken it is possible, to
    extract a full filesystem dump.
  id: totrans-296
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In [Chapter 4](ch04.html "Chapter 4. Evidence Acquisition and Analysis from
    iTunes Backup"), *Evidence Acquisition and Analysis from iTunes Backup*, we will
    see how to acquire and analyze forensics evidences in the case of an iTunes Backup.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
- en: Self-test questions
  id: totrans-298
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Q1\. What is the mode in which iOS devices operate to upgrade the operating
    system called?
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
- en: Normal
  id: totrans-300
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Recovery
  id: totrans-301
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Device Firmware Upgrade
  id: totrans-302
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Update
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Q2\. Where are the lockdown certificates stored on Windows 7/8?
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
- en: '`C:\Program Data\Apple\Lockdown`'
  id: totrans-305
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`C:\Users\[username]\AppData\Roaming\Apple Computer\Lockdown`'
  id: totrans-306
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`C:\Users\[username]\AppData\Local\Apple Computer\Lockdown`'
  id: totrans-307
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`C:\Windows\Apple Computer\Lockdown`'
  id: totrans-308
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Q3\. Which of the following tools can be used to perform physical acquisition
    of a jailbroken iPhone 4s?
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
- en: iOS Forensic Toolkit
  id: totrans-310
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Oxygen Forensics Suite
  id: totrans-311
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Cellebrite UFED Touch
  id: totrans-312
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Mobile Phone Examiner
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Q4\. What is the latest iPhone model that can be physically acquired even if
    it is not jailbroken?
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
- en: iPhone 3GS
  id: totrans-315
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: iPhone 4
  id: totrans-316
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: iPhone 5
  id: totrans-317
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: iPhone 6
  id: totrans-318
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Q5\. What is the device identifier for iOS devices called?
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
- en: ECID
  id: totrans-320
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: UDID
  id: totrans-321
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Serial Number
  id: totrans-322
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: MAC Address
  id: totrans-323
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
