- en: Windows 10 Forensics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following recipes:'
  prefs: []
  type: TYPE_NORMAL
- en: Parsing Windows 10 Notifications
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Cortana forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: OneDrive forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dropbox forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows 10 mail app
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows 10 Xbox app
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The advent of Windows 10 has caused controversy among users and forensic investigators
    alike. Many end users have concerns regarding privacy and security, since the
    privacy settings that are automatically set up on devices with Windows 10 are
    not at all strong. Others have expressed concerns about the way Windows machines
    are now forcing users to migrate to Windows 10, even if they are happy with their
    current versions.
  prefs: []
  type: TYPE_NORMAL
- en: From a forensic perspective, Windows 10 presents a number of new and unique
    challenges. Most of the programs have been modified to look and feel more like
    the applications you would see on a smartphone or tablet, and a lot of them behave
    quite differently from their predecessors. The advent of Cortana has given forensic
    investigators even more data to work with, and the amount of data has also increased
    in line with the interconnected nature of many of the applications.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we will look at a few of the common features of Windows 10,
    and how forensic analysts can work with it.
  prefs: []
  type: TYPE_NORMAL
- en: Parsing Windows 10 Notifications
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Windows 10 features notifications, called *Toast* notifications, which pop up
    in the bottom right of the screen. These can be set up for a number of different
    requirements, but are on by default for news relating to application updates and
    security.
  prefs: []
  type: TYPE_NORMAL
- en: It is possible for users to set up notifications to remind themselves of tasks,
    as well as events and email alerts. In this chapter, we will look at the usefulness
    of Windows 10 notifications in forensic investigations, and how to parse them.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Details of notifications are stored in the following location:'
  prefs: []
  type: TYPE_NORMAL
- en: '`\Users\Username\AppData\Local\Microsoft\Windows\Notifications`'
  prefs: []
  type: TYPE_NORMAL
- en: The name of the database will differ depending on the build version of Windows
    10 installed on the machine. From Anniversary onwards, they are stored in `wpndatabase.db`;
    before that, they can be found in `appdb.dat`.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The steps to be followed for parsing Windows 10 notifications are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Download a SQLite manager if you do not have one.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open your SQLite manager and click Open Database.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/80602cca-3eb2-4bc4-a970-913aec310887.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.1\. Adding a database
  prefs: []
  type: TYPE_NORMAL
- en: Browse to `C:\Users\Username\AppData\Local\Microsoft\Windows\Notifications`
    and find the `.db` file in the folder. Open it.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/46988caf-91f6-4b1f-904a-f3e7aff7fb1c.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.2\. The notifications database file
  prefs: []
  type: TYPE_NORMAL
- en: This will show you which notifications have popped up, along with their RecordIDs,
    which can be used to identify other instances of these programs.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A SQLite viewer will show you which programs have notifications popping up on
    a regular basis, and which have been disabled.
  prefs: []
  type: TYPE_NORMAL
- en: In the example below, the user has seen 20 Toast notifications - the small rectangular
    boxes that pop up in the bottom right of the screen. However, there have only
    been five title notifications. This refers to an application's icon as seen on
    the Start menu. If the number of tile notifications is very low, this probably
    means that the user has unpinned a number of programs from the Start menu.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/e1099d51-877c-4d48-9b92-b86227ec28d1.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.3\. Notifications a user has seen
  prefs: []
  type: TYPE_NORMAL
- en: The preceding image shows that the user has only seen one *Badge* notification.
    These are small numbers that pop up on the taskbar alongside a program - a bit
    like the little numerical values you see next to the notifications icons on Facebook
    or Twitter.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/d51fc342-3c52-4d77-b20d-7ee211af2fc2.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.4\. Tiles on the Start menu
  prefs: []
  type: TYPE_NORMAL
- en: If you have turned off icons on the taskbar, you may see these notifications
    when you click on the up arrow next to the Wi-Fi and volume signs.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'SQLite Expert download: [http://www.sqliteexpert.com/download.html](http://www.sqliteexpert.com/download.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'DB Browser for SQLite: [http://sqlitebrowser.org/](http://sqlitebrowser.org/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Cortana forensics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Cortana is Microsoft's voice-activated assistant, but it does much more than
    just respond to commands. Cortana links in across different devices, giving reminders
    when required and *getting to know* the user. It can recognize an individuals
    voice and handwriting, among other things. For this reason, many Windows users
    have turned the Cortana function off due to privacy concerns - particularly because,
    by default on some machines, Cortana is always on, even when the machine is in
    sleep mode.
  prefs: []
  type: TYPE_NORMAL
- en: Cortana can also respond to specific occurrences - for example, a user can instruct
    Cortana to remind them to say something to a person next time they call. This
    is undoubtedly a useful tool for many, and also a mine of forensic information.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Forensically speaking, the most interesting tidbits of information when it
    comes to Cortana can be found in the following location: `C:\Users[User]\AppData\Local\Packages\Microsoft.Windows.Cortana_xxxx\LocalState\ESEDatabase_CortanaCoreInstance\CortanaCoreDb.dat`'
  prefs: []
  type: TYPE_NORMAL
- en: Here you will be able to uncover information such as the locations the user
    has been in, the reminders they have set, where and when those reminders were
    triggered, and where and when the reminders were marked as complete.
  prefs: []
  type: TYPE_NORMAL
- en: This can be of particular interest if your case hinges on putting someone in
    a certain place at a certain time. Likewise, a reminder that has not been marked
    as complete may demonstrate that the users plans changed at the last minute.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You will need a SQLite browser to access the database.
  prefs: []
  type: TYPE_NORMAL
- en: Once you have started up your SQLite browser and accessed the database, you
    will be able to see a table of values which will include useful items such as
    Contact Permissions and Locations.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You can work with this database directly in your SQLite browser, or you can
    export it to a CSV document which can then be opened with Microsoft Excel, Google
    Sheets or another program of your choice.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: It is worth noting that some of the data in the `CortanaCoreDb.dat` file may
    be obscured. Depending on what you are looking for, once you have opened the file
    to ensure it contains some data, you may wish to run it through a more sophisticated
    forensic program to uncover the data.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The `Reminders` section of `CortanaCoreDb.dat` is concerned with calendar reminders,
    which can be a useful way to demonstrate a users intentions. For example, they
    may have set a reminder to tell them to go to a given location at a set time,
    which may place them near a crime scene. If this is then teamed up with actual
    location data from the `CortanaCoreDb.dat` `LocationTriggers` section, it can
    be either damning or absolving evidence.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: It is a good idea to go thoroughly through all the items in the `Cortana` folder
    at the path mentioned above. The most relevant data is likely to be contained
    in `CortanaCoreDb.dat`, however there are certain items - such as geolocation
    searches and some dictation records - that may be found in other parts of the
    folder. As always with forensic examination, it is worth digging through the evidence
    with a fine-toothed comb, at least insofar as time allows.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Cortana works by essentially *listening* to, and being aware of, everything
    that is going on around a computer at a given time. This is even the case when
    the computer is locked, which is particularly of interest in forensic investigations.
    Often a computer user - especially with a laptop - will leave their computer on
    but with the screen sleeping for long periods of time, essentially forgetting
    that it is still turned on.
  prefs: []
  type: TYPE_NORMAL
- en: While this has caused understandable consternation among privacy advocates and
    members of the general public, it can be hugely useful for investigative purposes.
    Snippets of conversations, data about the location of the user, voice searches,
    reminders, and which device a person is using can all be uncovered through the
    methods detailed previously and can provide priceless clues to a persons actions
    and motivations.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Bhupendra Singh; *A Forensic insight into Windows 10 Cortana Search*; *Computers
    & Security Vol. 66*, May 2017
  prefs: []
  type: TYPE_NORMAL
- en: Thomas Rose; *A Forensic Investigation of the Windows Search Feature, Cortana
    and the Notification Centre in Windows 8/8.1 and Windows 10*; BSc dissertation
    2016
  prefs: []
  type: TYPE_NORMAL
- en: OneDrive forensics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: OneDrive is Microsoft's cloud service, which allows users to save their data
    on the cloud and access it from any machine, as long as they are logged in with
    their Microsoft account. Featuring Word, Excel, PowerPoint, Outlook, a calendar,
    contacts, and more, this is a straightforward way for users of Microsoft products
    to ensure that they never lose access to their documents. It is also a great source
    of information and data in forensic investigations.
  prefs: []
  type: TYPE_NORMAL
- en: One way in which OneDrive is especially useful to forensic investigators is
    in instances where a particular device cannot be accessed for one reason or another.
    For example, perhaps a phone has been seized, but it is locked and the passcode
    cannot be retrieved; or perhaps a computer has a password that has proven too
    difficult to bypass. In these instances, if the investigator can gain access to
    a different device owned by the same user, they can often find useful tidbits
    of information in the OneDrive backup files.
  prefs: []
  type: TYPE_NORMAL
- en: In the Windows 10 operating system, OneDrive is the default location to save
    new files, rather than these being saved in My Documents on the local computer,
    which was previously the default. This means that, unless the user has manually
    changed their settings, there should be a wealth of forensic information available
    via OneDrive.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: First of all, it is important to work out how you are going to access your OneDrive
    files. Do you have access to the Windows 10 machine itself, or are you looking
    at an Android backup?
  prefs: []
  type: TYPE_NORMAL
- en: If you are accessing OneDrive using an Android phone, you will find what you
    need in `/mnt/sdcard/Android/data/` under the `com.microsoft.skydrive` folder.
    OneDrive's predecessor was called SkyDrive, hence the name.
  prefs: []
  type: TYPE_NORMAL
- en: If you are accessing OneDrive data using a PC or a laptop running Windows 10,
    you will find what you need in `C:\Users\<USERNAME>\AppData\Local\Microsoft\OneDrive\logs`.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following steps need to be followed to perform forensics on OneDrive:'
  prefs: []
  type: TYPE_NORMAL
- en: Open your forensic software of choice and navigate to the relevant folder, depending
    on whether you are using a smartphone or a computer for forensic analysis (see
    the previous paragraphs for details).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The backend of the OneDrive folder is actually not of particular forensic interest.
    In the `logs` folder listed above you will find two subfolders: `Common` and `Personal`.
    The `Common` folder lists all elements the operating system automatically runs,
    namely `StandaloneUpdater` and `telemetryCache` files. These refer to automated
    updates to OneDrive.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3d6bf499-d95e-4886-9362-8da8817b73b7.png)'
  prefs: []
  type: TYPE_IMG
- en: Fig 10.5 StandaloneUpdater and telemetryCache files in the Common folder
  prefs: []
  type: TYPE_NORMAL
- en: 'The `Personal` folder contains `SyncEngine`, `telemetryCache` and `TraceArchive`
    files. These files are updated automatically every few days. Generally, what can
    be found in them is not of great forensic interest; they are simply automated
    backups of the users computer, but the files themselves do not contain any information.
    The only potential forensic application would be to demonstrate lack of use: for
    example, a frequent computer user who had disappeared and not turned on any of
    their Windows machines would show an unusual lack of activity in the OneDrive
    log files. The files are as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/fba04b95-f38b-47ac-9cec-ff945da12c3b.png)'
  prefs: []
  type: TYPE_IMG
- en: Fig 10.6\. Files found within the Personal folder
  prefs: []
  type: TYPE_NORMAL
- en: Of course, the frontend of OneDrive is quite another matter. This has a wealth
    of information available to forensic examiners if they are able to access it.
    OneDrive files themselves are generally not password-protected, so all you will
    need is the pass code for the device on which they are being accessed in order
    to proceed.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: There is also a Windows OneDrive app on the iTunes app store, so if you know
    that the subject of your investigation uses a mixture of Windows and Apple machines,
    this is worth looking out for.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'There are no restrictions to the types of files that can be uploaded to OneDrive.
    However, the most common ones are those in the Microsoft Office suite: Word documents,
    Excel spreadsheets, PowerPoint presentations and so on. OneDrive files are not
    stored on the local machine, but can be accessed there using the OneDrive app.
    They can also be accessed using a web browser, as long as the computer is connected
    to the internet. As well as computers and smartphones, OneDrive files can also
    be accessed from Xbox consoles.'
  prefs: []
  type: TYPE_NORMAL
- en: Any forensic software that can open traditional Microsoft Office files will
    be able to extract OneDrive files for viewing. Once the information within the
    files has been compared with metadata such as the last accessed date and time,
    it is possible to construct a more thorough outline of the case.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: OneDrive works slightly differently depending on whether a user has a Personal
    or Business account, and it is important to understand these differences as they
    may have a bearing on your forensic investigation.
  prefs: []
  type: TYPE_NORMAL
- en: When OneDrive syncs a file from your computer to the cloud, there is a small
    modification that takes place in OneDrive for Business. This version of OneDrive
    automatically adds a few lines of code to the beginning of documents when they
    are uploaded. This has strong forensic implications as it means that the original
    MD5 hashes don't match, and can also mean that the files themselves grow slightly
    larger in size. This appears to happen whenever such a file is opened, even if
    no modifications are made - it is part of the automated syncing process. So, if
    you are analyzing a OneDrive for Business file, make sure you account for this
    as part of your process, or you may end up with some sticky questions should the
    case go to court!
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Daryabar, Farid; Dehghantanha, Ali; Eterovic-Soric, Brett & Choo, Kim-Kwang
    Raymond; *Forensic Investigation of OneDrive, Box, GoogleDrive and Dropbox Applications
    on Android and iOS Devices*; *Australian Journal of Forensic Sciences*, 48:6,
    615-642, DOI: 10.1080/00450618.2015.1110620'
  prefs: []
  type: TYPE_NORMAL
- en: Dropbox forensics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In an apparent attempt to make user transition between smartphones, tablets,
    and PCs more fluid, in version 8 and up, Microsoft have renamed their programs
    *applications* and have given the desktop a more smartphone-like feel.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/fcd55d0e-5bfb-4ccf-b372-82768afe0a27.png)'
  prefs: []
  type: TYPE_IMG
- en: Fig 10.7\. The Start menu now includes Tiles, which gives the computer more
    of a smartphone feel
  prefs: []
  type: TYPE_NORMAL
- en: Rather than downloading programs from a web browser, users can now shop for
    apps - many of which are free - that make for a smoother user experience.
  prefs: []
  type: TYPE_NORMAL
- en: Dropbox is a file sharing application that allows users to upload files of almost
    any type and easily share them with others. All that is required is an email address
    to sign up. In 2016, Dropbox had 500 million users worldwide, and this number
    is climbing.
  prefs: []
  type: TYPE_NORMAL
- en: Forensically, file sharing between users can provide a wealth of helpful information.
    Lets have a look at how to glean data from the Dropbox app.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Most of the Dropbox information you will require can be viewed with a simple
    SQLite browser, like the one we used in the section on Cortana forensics above.
  prefs: []
  type: TYPE_NORMAL
- en: However, some of the more interesting information may be encrypted, and to access
    that we will need a Dropbox decryptor. Magnet Forensics provide a free one which
    can be downloaded from their website, a link to which can be found at the end
    of the recipe.
  prefs: []
  type: TYPE_NORMAL
- en: You will find all Dropbox-related information in `C:\Users\<USERNAME>\AppData\Local\Microsoft\Dropbox.`
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The steps to be followed for dropbox forensics are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Open your SQLite browser and navigate to: `C:\Users\<USERNAME>\AppData\Local\Microsoft\Dropbox`.
    You will find several `.db` files contained within this folder.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The most interesting file in the folder is `filecache.db`. This lists all files
    and folders within the Dropbox account, as long as they have not been deleted.
    You can find details of how large each file is in `sigstore.db` in the same folder.
    The filecache database is encrypted by default, but this is one of those that
    can be decrypted by Magnet's Dropbox Decryptor, which will allow you to see not
    only the file names but also any associated metadata.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The Dropbox Decryptor will also uncover information from the `config.db` file,
    including the email address the account owner used to register, and a list of
    files that have recently been changed. This is particularly of interest in investigations
    where a person may be trying to cover their tracks. In some cases, Dropbox files
    will have been deleted. Deleted files are not kept on the local machine and so
    cannot be accessed strictly through Windows 10 forensic methods. However, if you
    know the username and password for the account, the web-based version of Dropbox
    does keep these files in the cloud. The amount of time for which they are kept
    depends on the type of account: for free accounts, deleted files are kept for
    30 days; for premium (paid) accounts, they are kept forever.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finding deleted files is easy on Dropbox. All you need to do is hover over the
    Show deleted files option on the right-hand side of the page.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/858f0e72-bb53-47e2-a71c-cfb189b8fa82.png)'
  prefs: []
  type: TYPE_IMG
- en: Fig 10.8\. An option allows users to see deleted files
  prefs: []
  type: TYPE_NORMAL
- en: 'Once you can see the file that has been deleted, you can then click on Restore
    to view it. This will bring up a little box where it is worth clicking on the
    View other versions link under the main text as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/1584c26d-c7f9-4ae0-abdb-5abb251d2cfe.png)'
  prefs: []
  type: TYPE_IMG
- en: Fig 10.9\. The 'View other versions' option can be forensically helpful
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows you how many versions of a file there have been,
    when they were edited, and when the file was deleted:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/54354aae-bb39-4328-94f4-10f68eb46a12.png)'
  prefs: []
  type: TYPE_IMG
- en: Fig:10.10 . You will be able to see names and modification dates of file versions
  prefs: []
  type: TYPE_NORMAL
- en: 'Clicking on each of these in turn will show you a preview version of the file
    itself, which can then be compared against other versions:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/a7258454-25d7-48b5-bccb-72ab29c146b7.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The two versions may be quite different even if they have the same file names,
    as you can see by comparing the figures:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/61852e69-2469-4c3c-aebb-9229560e1615.png)'
  prefs: []
  type: TYPE_IMG
- en: It is then possible to see the contents of each file version
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Dropbox essentially works by backing up files on the cloud, although unlike
    certain other cloud-based applications, it only does so when a user manually adds
    a file, rather than automatically updating the contents of a machine. This can
    be useful for demonstrating intent.
  prefs: []
  type: TYPE_NORMAL
- en: Dropbox forensic techniques work by accessing either the databases left by the
    Dropbox application on the Windows machine, or by the investigator gaining access
    to the online Dropbox account and sifting through the files contained within.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Magnet Forensics Dropbox Decryptor: [https://www.magnetforensics.com/free-tool-dropbox-decryptor/](https://www.magnetforensics.com/free-tool-dropbox-decryptor/)
    (accessed 05/07/17)'
  prefs: []
  type: TYPE_NORMAL
- en: Windows 10 mail app
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Windows 10 Mail app is similar to previous apps in terms of user experience,
    however there is a number of forensic differences. The main one is the way in
    which emails are stored. They are no longer saved as `.eml` files; rather, they
    are now saved as HTML or `.txt` files.
  prefs: []
  type: TYPE_NORMAL
- en: Another neat feature in the new Mail app is the ability to connect to multiple
    accounts. Much like Gmail, Mail now comes with the ability to switch between different
    accounts - and users can now add other email providers such as Gmail and Yahoo
    to their Microsoft Mail apps.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Several forensic tools will be able to extract data from the Mail app. In this
    example, we are going to talk about FTK Imager, but the process of extracting
    data and especially elements such as file paths and folder locations, will be
    the same regardless of which tool you prefer to use.
  prefs: []
  type: TYPE_NORMAL
- en: First of all, open up FTK Imager and add a new evidence item. The data you are
    looking for will be in the `\Users\Username\AppData\Local\Comms` folder.
  prefs: []
  type: TYPE_NORMAL
- en: 'Opening this folder, you will see five subfolders: `Temp`, `Unistore`, `UnistoreDB`,
    `UserDataTempFiles`, and `Volatile`. These are the locations we will be looking
    at in this chapter.'
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The `data` folder contains a wealth of useful information, but it is sequestered
    away in subfolders:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/4e0103ce-c2d0-4e34-990c-5cb3d8a87387.png)'
  prefs: []
  type: TYPE_IMG
- en: Fig 10.11 Some of the subfolders within the â€˜data folder
  prefs: []
  type: TYPE_NORMAL
- en: The subfolders we are particularly interested in for the purposes of this chapter
    are 3 and 7, which refer respectively to mail and attachments. Within these subfolders
    are more subfolders, each ones name corresponding to a letter of the alphabet.
    It is inside these folders that the data we are looking for can be found.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Since the emails are now stored in HTML or plain text, it is easy to view their
    contents. Simply click on the `.dat` files within the alphabetically-named subfolders
    and you will be able to see a preview of the message within FTK. To view any attachments,
    navigate to folder `7` and go through its alphabetical subfolders. These messages
    and attachments can then be exported into a report for your client.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Some emails are not sent, and bits of these may be found in the `UserDataTempFiles`
    folder in `\Users\Username\AppData\Local\Comms`. This data is volatile and frequently
    overwritten, so there may not be anything useful in there. However, on occasion
    you will find fragments of messages from which certain information may be extracted.
  prefs: []
  type: TYPE_NORMAL
- en: One final noteworthy element in the Mail app is the `People` folder. This contains
    all the contacts to whom a user has sent emails to in the past. You can access
    this data in `\Users\Username\AppData\Local\Comms\UniStoreDB\store.vol\Contact`
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The three most interesting elements here are the `Contacts.txt` and `Pcontacts.txt`
    files, which show the names and email addresses of the users contacts. If they
    have stored extra information, such as a contacts address or telephone number,
    this will also be available in plain text within these files.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Mail app is native to the users machine, although an increasing number of
    people are moving to Microsoft's cloud-based service instead, which as discussed
    in the previous section presents certain forensic challenges.
  prefs: []
  type: TYPE_NORMAL
- en: Basic information, such as contacts with whom the user frequently interacts,
    is stored in the `\Users\Username\AppData\Local\Comms` folder so that it can be
    easily recalled when the user wants to send a new message. Luckily, this also
    makes it available for forensic investigation!
  prefs: []
  type: TYPE_NORMAL
- en: Windows 10 Xbox App
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As the name suggests, Windows 10's Xbox application allows users to play Xbox
    games on their Windows 10 machines. At first glance, this may not sound like a
    particularly forensically interesting source of information. However, looking
    under the hood we can find a wealth of data that can be leveraged in investigations.
    This section will take you through how to do that.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The information we are looking for can all be found in the `Packages` directory
    at the following location:'
  prefs: []
  type: TYPE_NORMAL
- en: '`\Users\Username\AppData\Local\LocalState\ModelManager`'
  prefs: []
  type: TYPE_NORMAL
- en: You are looking for the `Xboxlivegamer.xml` file, which contains information
    that may be relevant to your case. Also, since Xbox is a gaming platform and many
    people use it only for leisure purposes, it is one location a user may have overlooked
    if they have taken anti-forensic measures.
  prefs: []
  type: TYPE_NORMAL
- en: Since the vast majority of the files we will be looking at are `.xml` files,
    you do not need any extra forensic software to access the data. However, most
    well-known softwares, such as FTK, EnCase and so on, will be able to examine the
    files and their metadata.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The steps to be followed for Windows 10 Xbox app forensics are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the location listed above and browse through the file list.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Within `Xboxlivegamer.xml` you will find the users profile details, including
    their avatar and email address.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Going down one subfolder, into `\Users\Username\AppData\Local\LocalState\ModelManager\People`,
    will allow you to look at social connections.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To find details of contacts, including messaging, relationships, and information
    about their friends, you will need to look at the `.xml` file that is named after
    the users Xbox ID. You can find this ID in the `Xboxlivegamer.xml` file.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Along with all the usual data on friends, you should also be able to see the
    listed locations of friends, which can be particularly interesting if you are
    trying to establish whether a person is linked in any way to a specific place.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'A very useful place to look is in the `Messaging` subfolder, which contains
    details of all messages sent and received, including timestamps, the users who
    sent or received them, and the messages themselves in plain text:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/2de00045-bb65-4f2b-ad08-bee7e1e75b66.png)'
  prefs: []
  type: TYPE_IMG
- en: Fig:10.11.Message data from the Xbox app
  prefs: []
  type: TYPE_NORMAL
- en: Recording gameplay is something a lot of users do, either to post it on the
    internet later or to refine techniques, or simply to share it with friends. However,
    some people also use this handy built-in feature of the Xbox app to record their
    screens when running various other applications. You can find the recorded gameplay
    data in `\Users\Username\XboxApp\GameDVR\OnThisPC`. Within this folder you should
    see a subfolder called `Videos`, which in turn contains a folder called `Captures`.
    You will then be able to open and play these videos.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Xbox app essentially brings the experience of an Xbox gaming environment
    to a Windows 10 PC. It stores data in plain text and as original video files,
    making it a repository of useful information in forensic examinations.
  prefs: []
  type: TYPE_NORMAL
