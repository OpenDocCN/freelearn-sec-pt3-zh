- en: Chapter 1. Digital and Mobile Forensics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Not long from now, we would be talking mainly, if not solely, about computer
    forensics and computer crimes, such as an attacker breaking into a computer network
    system and stealing data. This would involve two types of offense: unlawful/unauthorized
    access and data theft. As mobile phones became more popular, the new field of
    mobile forensics developed.'
  prefs: []
  type: TYPE_NORMAL
- en: Nowadays, things have changed radically and are still changing at quite a fast
    pace as technology evolves. Digital forensics, which includes all disciplines
    dealing with electronic evidence, is also being applied to common crimes, to those
    that, at least by definition, are not strictly IT crimes. Today, more than ever,
    we live in a society that is fully digitalized and people are equipped with all kinds
    of devices, which have different types of capabilities, but all of them process,
    store, and transmit information (mainly over the Internet). This means that forensic
    investigators have to be able to deal with all these devices.
  prefs: []
  type: TYPE_NORMAL
- en: 'As defined at the first **Digital Forensics Research Workshop** (**DFRWS**)
    in 2001, digital forensics is:'
  prefs: []
  type: TYPE_NORMAL
- en: '*"The use of scientifically derived and proven methods toward the preservation,
    collection, validation, identification, analysis, interpretation, documentation,
    and presentation of digital evidence derived from digital sources for the purpose
    of facilitating or furthering the reconstruction of events found to be criminal,
    or helping to anticipate unauthorized actions shown to be disruptive to planned
    operations."*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'As Casey asserted (**Casey, 2011**):'
  prefs: []
  type: TYPE_NORMAL
- en: '*"In this modern age, it is hard to imagine a crime that does not have a digital
    dimension."*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Criminals of all kinds use technology to facilitate their offenses, communicate
    with their peers, recruit other criminals, launder money, commit credit card fraud,
    gather information on their victims, and so on. This obviously creates new challenges
    for all the different actors involved, such as attorneys, judges, law enforcement
    agents, forensic examiners.
  prefs: []
  type: TYPE_NORMAL
- en: Among the cases solved in recent years, there were kidnappings where the kidnapper
    was caught thanks to a request for ransom sent by e-mail from his mobile phone.
    There have been many cases of industrial espionage in which unfaithful employees
    were hiding projects in the memory cards of their smartphones, cases of drug dealing
    solved thanks to the evidence found in the backup of mobile phones that was on
    computer, and many other such cases. Even the largest robberies of our time are
    now being conducted via computer networks.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, you will learn the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Definition and principles of mobile forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to properly handle digital evidence
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The methodology for the identification and preservation of mobile evidence
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mobile forensics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Mobile forensics is a field of study in digital forensics that focuses on mobile
    devices. Among the different digital forensics fields, mobile forensics is without
    doubt the fastest growing and evolving area of study, having an impact on many
    different situations from corporate to criminal investigations and intelligence
    gathering, which are on the rise. Moreover, the importance of mobile forensics
    is increasing exponentially due to the continuous fast growth of the mobile market.
    One of the most interesting peculiarities of mobile forensics is that mobile devices,
    particularly mobile phones, usually belong to a single individual, while this
    is not always the case with a computer that may be shared among employees of a
    company or members of a family. For this reason, the analysis of mobile phones
    gives access to plenty of personal information.
  prefs: []
  type: TYPE_NORMAL
- en: Another important and interesting aspect that comes with mobile forensics, which
    is both challenging and frustrating at the same time for the analyst, is the multitude
    of different device models and the customized flavors of their operating systems
    available on the market. This makes it very difficult to have a single solution
    (either a tool or process) to address them all.
  prefs: []
  type: TYPE_NORMAL
- en: 'Just think of all the applications people have installed on their smartphones:
    IM clients, web browsers, social network clients, password managers, navigation
    systems, and much more, other than the classic default ones, such as an address
    book, which can provide a lot more information other than just the phone number
    for each contact that has been saved. Moreover, syncing such devices with a computer
    has become a very easy and smooth process, and all user activities, schedules,
    to-do lists, and everything else is stored inside a smartphone. Aren''t these
    enough to profile a person and reconstruct all their recent activities, other
    than building the network of contacts?'
  prefs: []
  type: TYPE_NORMAL
- en: Finally, in addition to a variety of smartphones and operating systems, such
    as Apple iOS, Google Android, Microsoft Windows Phone, and Blackberry OS, there
    is a massive number of so-called feature phones that use older mobile OS systems.
  prefs: []
  type: TYPE_NORMAL
- en: Therefore, it's pretty clear that when talking about mobile/smartphone forensics,
    there is so much more than just printouts of phone calls. In fact, with a complete
    examination, we can retrieve SMSes/MMSes, pictures, videos, installed applications,
    e-mails, geolocation data, and so on-both present and deleted information.
  prefs: []
  type: TYPE_NORMAL
- en: Digital evidence
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As mentioned earlier, on one hand the increasing involvement of mobile devices
    in digital forensics cases has brought a whole new series of challenges and complexities.
    However, on the other hand, this has also resulted in a much greater amount of
    evidence from criminals that it is now being used to reconstruct their activities
    with a more comprehensive level of detail. Moreover, while classical physical
    evidence may be destroyed, digital evidence, most of the time, leaves traces.
  prefs: []
  type: TYPE_NORMAL
- en: 'Over the years, there have been several definitions of what digital evidence
    actually is, some of them focusing particularly on the evidentiary aspects of
    proof to be used in court, such as the one proposed by the **Standard Working
    Group on Digital Evidence** (**SWGDE**), stating that:'
  prefs: []
  type: TYPE_NORMAL
- en: '*"Digital evidence is any information of probative value that is either stored
    or transmitted in a digital form."*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The definition proposed by the **International Organization of Computer Evidence**
    (**IOCE**) states:'
  prefs: []
  type: TYPE_NORMAL
- en: '*"Digital evidence is information stored or transmitted in binary form that
    may be relied on in court."*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The definition given by E. Casey (**Casey, 2000**), refers to digital evidence
    as:'
  prefs: []
  type: TYPE_NORMAL
- en: '*"Physical objects that can establish that a crime has been committed, can
    provide a link between a crime and its victim, or can provide a link between a
    crime and its perpetrator."*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: While all of these are correct, as previously said, all of these definitions
    focus mostly on proofs and tend to disregard data that is extremely useful for
    an investigation.
  prefs: []
  type: TYPE_NORMAL
- en: 'For this reason, and for the purpose of this book, we will refer to the definition
    given by Carrier (**Carrier, 2006**), where digital evidence is defined as:'
  prefs: []
  type: TYPE_NORMAL
- en: '*"Digital data that supports or refutes a hypothesis about digital events or
    the state of digital data."*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: This definition is a more general one, but better matches the current state
    of digital evidence and its value within the entire investigation process.
  prefs: []
  type: TYPE_NORMAL
- en: Also from a standardization point of view, there have been, and still are, many
    attempts to define guidelines and best practices for digital forensics on how
    to handle digital evidence. Other than the several guidelines and special publications
    from NIST, there is a standard from ISO/IEC that was released in 2012, the ISO
    27037 guidelines for identification, collection and/or acquisition, and preservation
    of digital evidence, which is not specific to mobile forensics but is related
    to digital forensics in general, aiming to build a standard procedure for collecting
    and handling digital evidence, which will be legally recognized and accepted in
    court in different countries. This is a really important goal if you consider
    the lack of borders in the Internet era, particularly when it comes to digital
    crimes, where illicit actions can be perpetrated by attackers from anywhere in
    the world. Refer to [Appendix A](apa.html "Appendix A. References"),*References*
    for a more detailed list of standards and best practices.
  prefs: []
  type: TYPE_NORMAL
- en: Handling of mobile evidence
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In order to be useful not only in court but also during the entire investigation
    phase, digital evidence must be collected, preserved, and analyzed in a forensically
    sound manner. This means that each step, from the identification to the reporting,
    has to be carefully and strictly followed. Historically, we are used to referring
    to a methodology as forensically sound if, and only if, it would imply the original
    source of evidence remains unmodified and unaltered. This was mostly true when
    talking about classical computer forensics, in scenarios where the forensic practitioner
    found the computer switched off or had to deal with external hard drives, although
    not completely true even in these situations. However, since the rise of live
    forensics, this concept has become more and more untrue. In fact, methods and
    tools for acquiring memory from live systems inevitably alter, even if just a
    little bit, the target system they are run on. The advent of mobile forensics
    stresses this concept even more, because mobile devices, and smartphones in particular,
    are networked devices that continuously exchange data through several communication
    protocols, such as GSM/CDMA, Wi-Fi, Bluetooth, and so on. Moreover, in order to
    acquire a mobile device, forensic practitioners need to have some degree of interaction
    with the device. Based on the type, a smartphone can need more or less interaction,
    altering in this way the original state of the device.
  prefs: []
  type: TYPE_NORMAL
- en: 'All of this does not mean that preservation of the source evidence is useless,
    but that it is nearly impossible in the field of mobile devices. Therefore, it
    becomes a matter of extreme importance to thoroughly document every step taken
    during the collection, preservation, and acquisition phases. Using this approach,
    forensic practitioners will be able to demonstrate that they have been as unintrusive
    as possible. As Casey states (**Casey, 2011**):'
  prefs: []
  type: TYPE_NORMAL
- en: '*"One of the keys to forensic soundness is documentation. A solid case is built
    on supporting documentation that reports on where the evidence originated and
    how it was handled. From a forensic standpoint, the acquisition process should
    change the original evidence as little as possible and any changes should be documented
    and assessed in the context of the final analytical results."*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'When in the presence of mobile devices to be collected, it is good practice
    for the forensic practitioner to consider the following points:'
  prefs: []
  type: TYPE_NORMAL
- en: Take note of the current location where the device has been found.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Report the device status (switched on or off, broken screen, and so on).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Report date, time, and other information visible on the screen if the device
    is switched on, for example by taking a picture of the screen.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Look very carefully for the presence of memory cards. Although it is not the
    case with iOS devices, generally many mobile phones have a slot for an external
    memory card, where pictures, chat databases, and many other types of user data
    are usually stored.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Look very carefully for the presence of cables related to the mobile phone that
    is being collected, especially if you don't have a full set of cables in your
    lab. Many mobile phones have their own cables to connect to the computer and to
    recharge the battery.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Search for the original **Subscriber Identity Module** (**SIM**) package, because
    that is where the PIN and **PIN unblocking key** (**PUK**) codes are written.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Take pictures of every item before collection.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Modifications to mobile devices can happen not only because of interaction with
    the forensic practitioner, but also due to interaction with the network, voluntarily
    or not. In fact, digital evidence in mobile devices can be lost completely as
    they are susceptible to being overwritten by new data, for example with the smartphone
    receiving an SMS while it is being collected, thus overwriting possible evidence
    previously stored in the same area of memory as the newly arrived SMS, or upon
    receiving a remote wiping command over a wireless network. Most of today's smartphones
    and iOS devices can be configured to be completely wiped remotely.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**From a real case:**'
  prefs: []
  type: TYPE_NORMAL
- en: While searching inside the house of a person under investigation, law enforcement
    agents found and seized, among other things, computers and a smartphone. After
    cataloguing and documenting everything, they put all the material into boxes to
    bring them back to the laboratory. Once back in their laboratory, when acquiring
    the smart phone in order to proceed with the forensics analysis, they noticed
    the smartphone was *empty* and appeared to be *brand new*. The owner had wiped
    it remotely.
  prefs: []
  type: TYPE_NORMAL
- en: 'Therefore, isolating the mobile device from all radio networks is a fundamental
    step in the process of preservation of evidence. There are several ways to achieve
    this, all with their own pros and cons, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Airplane mode**: Enabling Airplane mode on a device requires some sort of
    interaction, which may pose some risks of modification by the forensic practitioner.
    This is one of the best possible options since it implies that all wireless communication
    chips are switched off. In this case, it is always good to document the action
    taken with pictures and/or videos. Normally, this is possible only if the phone
    is not password-protected or the password is known. However, for devices with
    iOS 7 or higher, it is also possible to enable airplane mode by lifting the dock
    from the bottom, where there will be a button with the shape of a plane. This
    is possible only if the **Access on Lock Screen** option is enabled from **Settings**
    | **Control Center**.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Faraday''s bag**: This item is a sort of envelope made of conducting material,
    which blocks out static electric fields and electromagnetic radiation completely
    isolating the device from communicating with external networks. It is based, as
    the name suggests, on Faraday''s law. This is the most common solution, particularly
    useful when the device is being carried from the crime scene to the lab after
    seizure. However, the use of Faraday''s bag will make the phone continuously search
    for a network, which will cause the battery to quickly drain. Unfortunately, it
    is also risky to plug the phone to a power cable outside that will go inside the
    bag, because this may act as antenna. Moreover, it is important to keep in mind
    that when you remove the phone from the bag (once arrived in the lab) it will
    again be exposed to the network. So, you would need either a shielded lab environment
    or a Faraday solution that would allow you to access the phone while it is still
    inside the shielded container, without the need for external power cables.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Jamming**: A jammer is used to prevent a wireless device from communicating
    by sending out radio waves along the same frequencies as that device. In our case,
    it would jam the GSM/UMTS/LTE frequencies that mobile phones use to connect with
    cellular base stations to send/receive data. Be aware that this practice may be
    considered illegal in some countries, since it will also interfere with any other
    mobile device in the range of the jammer, disrupting their communications too.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Switching off the device**: This is a very risky practice because it may
    activate authentication mechanisms, such as PIN codes or passcodes, that are not
    available to the forensic practitioner, or other encryption mechanisms that carry
    with the risk of delaying or even blocking the acquisition of the mobile device.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Removing the SIM card:** In most mobile devices, this operation implies removing
    the battery and therefore all the risks and consequences we just mentioned regarding
    switching off the device; however, in iOS devices this task is quite straightforward
    and easy, and it does not imply removing the battery (in iOS devices this is not
    possible). Moreover, SIM cards can have PIN protection enabled; removing it from
    the phone may lock the SIM card, preventing its content from being displayed.
    However, bear in mind that removing the SIM card will isolate the device only
    from the cellular network, while other networks, such as Wi-Fi or Bluetooth, may
    still be active and therefore need to be addressed.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The following image shows a SIM card extracted from an iPhone with just a clip;
    image taken from [http://www.maclife.com/](http://www.maclife.com/):![Handling
    of mobile evidence](img/image_01_001.jpg)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Preservation of evidence
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Talking about the documentation and preservation of digital evidence, one of
    the most important steps is the correct and comprehensive compilation of the **chain
    of custody**. The purpose of this document is twofold: on one hand, to keep the
    record of each person who handled the evidence, enabling the identification of
    access and movement of potential digital evidence at any given point in time;
    and on the other hand, to maintain documentation demonstrating that the digital
    evidence has not been altered since it was collected while passing through the
    hands of the several analysts listed in the document.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Therefore, some of the information that the chain of custody should contain
    is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: A unique evidence identifier
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Who accessed the evidence and the time and location it took place
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Who checked the evidence in and out of the evidence preservation facility and
    when
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Reasons why the evidence was checked out
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The hash values of the evidence in order to prove that it has not been tampered
    with since it was last assigned to the previous person listed in the chain of
    custody
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Although the forensics investigation must never be performed directly on the
    original device/file, the chain of custody should mention if any unavoidable changes
    to the potential digital evidence had to be performed and the justification for
    the introduction of such changes, as well as the name of the individual responsible
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The following image shows a sample of chain of custody proposed by NIST:![Preservation
    of evidence](img/image_01_002.jpg)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Acquisition of evidence
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Especially in mobile forensics, where visible information may be more volatile,
    and also in classical computer forensics, sometimes there may be an urgency to
    acquire the data available. Information may vanish before it is possible to isolate
    or properly handle the device. In such cases, effective on-scene triage processes
    and tools may preserve evidence that would otherwise be lost. Such processes may
    include taking immediate pictures or videos recording the screen of the device
    before proceeding with any other type of operation.
  prefs: []
  type: TYPE_NORMAL
- en: 'Having said that, once the mobile device has been handled correctly, forensic
    practitioners may proceed with the acquisition of the evidence from the device.
    In mobile forensics, and particularly for iOS devices, there are the following
    three different types of possible acquisition:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Physical**: This is the optimal and most desired option. It involves a physical
    acquisition consisting of an exact *bit-to-bit* copy of the device. This is the
    most comprehensive option since it also allows you to recover potentially deleted
    files.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**FileSystem**: This is the second-best option when physical acquisition is
    not possible for whatever reason. This type of acquisition lets the forensic practitioner
    extract all the files visible at the filesystem level. In this way, it will be
    possible to analyze all active files that would be visible by browsing the filesystem,
    but it will not be possible to recover potentially deleted files.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Logical**: With this type of acquisition, it is possible to extract part
    of the filesystem. It consists recovering the available data by performing the
    backup of the device, via iTunes in the case of iOS devices. Unfortunately, with
    iOS, a logical/backup acquisition does not extract important files such as e-mails,
    geolocation databases, the app cache folder, and so on. Although it is the least
    comprehensive of the three, sometimes this may be the only option available.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The preceding three acquisition methods are the main methods for acquiring an
    iOS device; we will see more about this in detail later. In the following chapters,
    we will dive deep into each of the different methodologies, explaining how to
    behave in every possible situation and we will see most of the different tools
    available for performing the acquisition and further analysis of a physical filesystem
    and logical acquisition.
  prefs: []
  type: TYPE_NORMAL
- en: Mobile forensics, however, may also include the need to adopt some offensive
    security techniques. Depending on the device model and iOS version, in order to
    make a physical acquisition we may need to jailbreak the device, hopefully with
    a tethered technique so that modifications will not be persistent on the device
    and it will be restored once restarted. Even in cases when we can only perform
    an untethered jailbreak, such modifications will affect only the iOS device system
    partition, leaving the user partition unchanged and therefore the evidence preserved.
  prefs: []
  type: TYPE_NORMAL
- en: Another offensive technique we may need to use is password cracking. As we will
    see later, often we may find ourselves faced with a password-protected device.
    Dependent on the model and iOS version, it may be possible to perform brute force
    attacks on the passcode set by the user.
  prefs: []
  type: TYPE_NORMAL
- en: These more invasive techniques will need to be fully documented in the final
    report, detailing methodology, techniques, and tools used. It is very important,
    especially because of their invasiveness, to know well the tools and techniques
    used in order to be able to explain what and where the modifications have happened,
    and why they did not alter the evidence to the point of compromising it. Good
    reporting is key.
  prefs: []
  type: TYPE_NORMAL
- en: Evidence integrity
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'It has been mentioned already multiple times that when handling mobile devices,
    it is basically impossible not to interact with the device and therefore alter,
    to some extent, its current status. However, this does not mean that in mobile
    forensics there is no need or reason to put in place mechanisms of evidence integrity.
    In fact, once the acquisition has been completed, there must be some integrity
    verification mechanism in place for the data that has been extracted from the
    mobile device, be it an iTunes backup, a full physical acquisition, or simply
    a single file. In digital forensics, such a process of verifying the integrity
    of digital evidence is completed by comparing the digital fingerprint of the evidence
    taken at the time of acquisition with the digital fingerprint of the evidence
    in the current state. Such a fingerprint is also known as a **hash value** or
    **message digest**. Hashing functions are specific one-way mathematical functions
    that, given any input of arbitrary length, will produce as a result an output
    of a given fixed length. The same input will always produce the same output. This
    means that even if a single bit is changed, the new hash value will be completely
    different. The following table shows how simply by modifying only the case of
    two characters in the same sentence, the resulting hash value is completely different:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Evidence integrity](img/B05100_01_Tablepageno10.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The two most common algorithms used to calculate hash values are MD5 and SHA-1\.
    The MD5 algorithm produces an output of 128 bits, while the SHA-1 algorithm produces
    an output of 160 bits. The other important characteristic of these type of algorithms
    is that, theoretically, it should be computationally infeasible to be able to
    generate two different inputs that will produce the same hash value, as well as
    to generate a specific message that will match a given hash value. This problem
    is known as **collision**. It has been demonstrated in several studies that it
    is possible to create two different files with the same hash values in both MD5
    and SHA-1 cases. However, it has to be specified that this is true under specific
    controlled conditions that are unlikely to happen in reality. In any case, such
    collisions do not invalidate the use of these hash algorithms for integrity verification.
    Since it is basically impossible to produce two files that have the same MD5 and
    SHA-1 hash value (or in general two hash values generated by two different independent
    algorithms), it is a good practice to generate both MD5 and SHA-1 hash values
    for each piece of digital evidence produced or collected.
  prefs: []
  type: TYPE_NORMAL
- en: SIM cards
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'When conducting forensic examinations of mobile devices, it is also important
    to acquire and analyze the content of the associated SIM cards. The SIM card is
    a type of smart card that allows a mobile device to connect to a cellular network
    through the cryptographic keys embedded in the SIM card itself. The SIM card is
    mainly characterized by the following two different codes that can be retrieved:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Integrated Circuit Card Identification** (**ICCID**): This code is a 20-digit
    code that internationally and univocally identifies each SIM card'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**International Mobile Subscriber Identity** (**IMSI**): This is a unique 15-digit
    number (in some places, as in South Africa, it''s 14), which univocally identifies
    a user inside the mobile network'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Although it is not the case with iOS devices, there might be multiple SIM cards
    that an individual uses with the same device for different purposes, since some
    mobile devices support functioning with dual SIM cards.
  prefs: []
  type: TYPE_NORMAL
- en: In addition, the storage capacity and utilization of SIM cards has increased
    a lot and may contain a large amount of relevant information. Just to give you
    an idea of the amount of data that it could be possible to store (or hide) inside
    a SIM card, consider that inside a 128 KB standard SIM card, it is possible to
    write up to 17 KB of data. The entire **United States Declaration of Independence**
    takes just 11 KB.
  prefs: []
  type: TYPE_NORMAL
- en: Some of the useful information to recover from a SIM card may be the list of
    incoming/outgoing phone calls, contacts information, the SMS content, for which
    it is possible to recover even those that have been deleted, and the location
    of the last cell to which the device was connected.
  prefs: []
  type: TYPE_NORMAL
- en: 'Looking into the details of the SIM card (Gubian, 2007), it is possible to
    see the hierarchical n-ary structure of the filesystem that has three different
    kinds of files, with the content of each file defined in the following GSM technical
    specification (GSM 11.11):'
  prefs: []
  type: TYPE_NORMAL
- en: '**3F = Master File (MF)**: Its structure is composed of just a header and it
    is the root of the filesystem in the SIM card. Its address, which is the offset
    for every other file, is `3F00`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**7F/5F = 7F is a Dedicated File (DF)**: As for the MF, its structure is composed
    just of a header plus EFs. A DF can be compared to a normal folder in our PC.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**2F = Elementary file (EF) under the master file and 6F/4F = 4F is an Elementary
    file under a dedicated file 6F**: The structure of the elementary file is composed
    of a header plus a body, which represents itself (for example, the SMS).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following diagram gives an example of this hierarchical structure (the
    filesystem structure of a SIM):'
  prefs: []
  type: TYPE_NORMAL
- en: '![SIM cards](img/image_01_003.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The GSM technical specification already provides some files with common names.
    Some of the most interesting folders among the standard ones may be `3F00:7F10`
    (`DF_TELECOM`), which contains service-related information and some user data
    such as SMS, and `3F00:7F20` (`DF_GSM`), where information related to the GSM
    network is stored. The ICCID and IMSI mentioned previously can be found at `3F00:2FE2`,
    named `EF_ICCID`, and `3F00:7F20:6F07`, named `EF_IMSI`. The following table presents
    some of the well-known sources of information that can be found inside a SIM card
    and their respective locations:'
  prefs: []
  type: TYPE_NORMAL
- en: '![SIM cards](img/B05100_01_Tablepageno13.jpg)'
  prefs: []
  type: TYPE_IMG
- en: In a SIM card, the access to **each file** (**EF**) is ruled by a certain number
    of privilege levels, which allow or deny certain actions according to the role
    the user has (which is given by the privilege level). Some of the useful privileges
    are `ALWays`, `CHV1`, and `CHV2`. Those are the privileges that allow the owner
    of the SIM card (or anyway the user who knows the codes) to access and modify
    the content of such files. For instance, any file that has one of these privileges
    related to the `UPDATE` command, allows those that know such codes (`CHV1`/`CHV2`)
    to modify the information inside that file.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following table summarizes the access conditions for SIM cards:'
  prefs: []
  type: TYPE_NORMAL
- en: '![SIM cards](img/B05100_01_Tablepageno-14.jpg)'
  prefs: []
  type: TYPE_IMG
- en: SIM security
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Other than ICCID and IMSI, which are mainly related to the SIM card itself,
    the other two important codes useful to know (actually, almost indispensable)
    when conducting an analysis are the PIN code and the PUK code. The PIN code is
    used to authenticate the user to the system, while the PUK code is used to unlock
    the SIM card after three incorrect attempts to insert the PIN code. Therefore,
    brute forcing the PIN is generally ineffective, because three failed PIN attempts
    will result in the SIM being locked.
  prefs: []
  type: TYPE_NORMAL
- en: Fortunately, SIM cards have a PUK and many **network service providers** (**NSP**)
    can provide it to law enforcements with a proper legal authorization signed by
    a judge (warrant), to get around the PIN or to access a locked SIM card.
  prefs: []
  type: TYPE_NORMAL
- en: If an incorrect PUK code is inserted 10 times, the SIM will block itself permanently,
    making its content completely inaccessible. This is something to keep in mind
    before starting a brute force attacks against those two codes.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we gave a general introduction to digital forensics for those
    relatively new to this area of study and a good recap to those already in the
    field, keeping the mobile forensics field specifically in mind. We have seen what
    digital evidence is and how it should be handled, presenting several techniques
    to isolate the mobile device from the network. You should always remember the
    importance of documenting any action taken (chain of custody, final report, and
    so on) and to put in place mechanisms to verify the integrity of the evidence
    (hash values). We also talked about the different acquisition techniques for iOS
    devices, anticipating some terms and technologies that will be covered in full
    detail in the following chapters of this book, from A to Z. Last but not least,
    we talked about the SIM card, how it is structured, and what type of useful information
    we can expect to find inside it.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will start focusing purely on the mobile forensics of
    Apple devices. In particular, you will have an introduction to the iOS devices,
    OS, and the filesystem.
  prefs: []
  type: TYPE_NORMAL
- en: Self-test questions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Q1\. What is the best option to isolate a mobile device before acquisition?
  prefs: []
  type: TYPE_NORMAL
- en: Jammer
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Faraday's bag
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Airplane mode
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Switch off the device
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Q2\. What is the most comprehensive acquisition method?
  prefs: []
  type: TYPE_NORMAL
- en: Logical
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Advanced logical
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Filesystem
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Physical
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Q3\. What is the code that internationally and univocally identifies each SIM
    card called?
  prefs: []
  type: TYPE_NORMAL
- en: IMSI
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: ICCID
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: PUK
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: GSM
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Q4\. How many PUK attempts can we make before the SIM card becomes completely
    inaccessible?
  prefs: []
  type: TYPE_NORMAL
- en: '3'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '5'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '10'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '15'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
