<html><head></head><body>
		<div><h1 id="_idParaDest-309"><em class="italic"><a id="_idTextAnchor323"/>Chapter 14</em>: Malware Analysis</h1>
			<p><em class="italic">"The target of a malware infection is to exploit a system, therefore malware analysis becomes very important as a mechanism to better understand the malware to reduce the probability and impact of future attacks." </em></p>
			<p><em class="italic">– Patricia Herrera, MSc in Cybersecurity</em></p>
			<p><strong class="bold">Malware analysis</strong> is<a id="_idIndexMarker1373"/> considered by many as an offensive security task. However, as a master in defensive security, you must know the basics of this process so that you can leverage it in your defensive security strategy.</p>
			<p>Therefore, while this chapter aims to cover the basics of malware analysis, we will also cover some advanced topics, including a hands-on activity to show you how to perform basic malware analysis, but more importantly, how to gather (and interpret) the most valuable information resulting from the analysis.</p>
			<p>Here are details of the main topics that we will cover in this chapter:</p>
			<ul>
				<li>Importance of malware analysis</li>
				<li>Malware basics, including functionality, objectives, and backdoors</li>
				<li>Types of malware analysis (static, dynamic, and hybrid)</li>
				<li>Categories of malware analysis (static, interactive, automated, and manual)</li>
				<li>An overview of the best malware analysis tools</li>
				<li>Hands-on experience performing basic malware analysis</li>
			</ul>
			<h1 id="_idParaDest-310"><a id="_idTextAnchor324"/>Technical requirements </h1>
			<p>For this chapter, you will need a Windows machine to execute a hands-on analysis of the malware.</p>
			<h1 id="_idParaDest-311"><a id="_idTextAnchor325"/>Why should I analyze malware? </h1>
			<p>Let's start by defining <a id="_idIndexMarker1374"/>malware analysis as a process to analyze malware (software, script, <strong class="bold">Uniform Resource Locator</strong> (<strong class="bold">URL</strong>), and so on) to gather as much information as possible <a id="_idIndexMarker1375"/>about the threat. </p>
			<p>This is considered a very technical task that demands highly skilled professionals, and these resources could be very expensive for companies to afford. Additionally, this task could also be very time-consuming, which increases the cost of performing this analysis even more. However, even companies with strong budgets may not invest in malware analysis, and the reason is that they have not realized the benefits of this investment.</p>
			<p>Therefore, let's start by describing the main benefits and outputs of performing malware analysis.</p>
			<h2 id="_idParaDest-312"><a id="_idTextAnchor326"/>Malware functionality</h2>
			<p>One of the <a id="_idIndexMarker1376"/>main goals of malware analysis is to discover the inner functionality of the malware. This step is of the uttermost importance because <em class="italic">it will support the containment efforts after an infection</em>. The main goals of this step are described here:</p>
			<ul>
				<li>Discover which are the vulnerabilities used by the malware to infect the systems</li>
				<li>Understand the mechanisms used by the malware to spread between systems</li>
				<li>Determine whether the <a id="_idIndexMarker1377"/>malware has any advanced features, such as <em class="italic">self-destruction</em>, <em class="italic">morphing capabilities</em>, <em class="italic">propagation</em>, <strong class="bold">artificial intelligence</strong> (<strong class="bold">AI</strong>), and so on</li>
			</ul>
			<h2 id="_idParaDest-313"><a id="_idTextAnchor327"/>Malware objectives</h2>
			<p>As part of <a id="_idIndexMarker1378"/>this analysis, you will be able to determine the objective of the malware and this will help you to <em class="italic">determine the best mitigation required for each case</em>. Some examples are given here:</p>
			<ul>
				<li>Data exfiltration </li>
				<li>Data corruption</li>
				<li>Data encryption (ransomware)</li>
				<li>Data deletion</li>
				<li>System malfunction (cyberwarfare)</li>
				<li>System disruption (hacktivism)</li>
				<li>System <a id="_idIndexMarker1379"/>damage </li>
			</ul>
			<h2 id="_idParaDest-314"><a id="_idTextAnchor328"/>Malware connections</h2>
			<p>Another key<a id="_idIndexMarker1380"/> aspect of malware analysis is determining <em class="italic">who</em> created the malware and where the exfiltrated data is going. </p>
			<p>This is important for two main reasons. The first is about the legal aspect, because in most countries, the distribution of malware is a crime, and <em class="italic">therefore identifying the group that is trying to compromise your systems is vital</em>. </p>
			<p>The second reason is about using this information to <em class="italic">block and blacklist the </em><strong class="bold">Internet Protocol</strong><em class="italic"> (</em><strong class="bold">IP</strong><em class="italic">) addresses used by the malware as that will prevent further attacks</em>.</p>
			<p>Additionally, this data (IPs, server names, and so on) can be <em class="italic">used as threat intelligence</em> that can be used by open source (crowdsource) systems to prevent attacks in other companies and industries.</p>
			<p>Have a look at the following screenshot:</p>
			<div><div><img src="img/Figure_14.1_B16290.jpg" alt="Figure 14.1 – IP blacklisting&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.1 – IP blacklisting</p>
			<p>As seen in the preceding screenshot, blacklisting IP addresses may help to stop an ongoing attack, but also may prevent future attacks from the same group. It is also important to <a id="_idIndexMarker1381"/>remember that blacklisting will also prevent<a id="_idIndexMarker1382"/> a <strong class="bold">command-and-control</strong> (<strong class="bold">C&amp;C</strong>) attack.</p>
			<h2 id="_idParaDest-315"><a id="_idTextAnchor329"/>Malware backdoors</h2>
			<p>A common<a id="_idIndexMarker1383"/> characteristic of malware is to create backdoors. While the usage and objectives of those backdoors may vary, it is very important to determine any trail of backdoors to <em class="italic">reduce the possibility of further infections or data compromise</em>.</p>
			<h2 id="_idParaDest-316"><a id="_idTextAnchor330"/>Affected systems</h2>
			<p>Another <a id="_idIndexMarker1384"/>important factor to analyze concerns the systems (OS, software, or hardware) that will be impacted by the malware. This is very important because some malware may remain <em class="italic">inactive</em> till a given condition or system is present (for example, Stuxnet).</p>
			<p>Now that you are aware of the benefits and importance of malware analysis, it's time to understand the types of malware analysis, as well as their categories. </p>
			<h1 id="_idParaDest-317"><a id="_idTextAnchor331"/>Types and categories of malware analysis </h1>
			<p>There are a <a id="_idIndexMarker1385"/>considerable number of tools that can be used for malware analysis, so to better understand them, let's start by describing the three types (actually, two) of malware analysis tools.</p>
			<h2 id="_idParaDest-318"><a id="_idTextAnchor332"/>Static malware analysis</h2>
			<p>This type <a id="_idIndexMarker1386"/>of analysis<a id="_idIndexMarker1387"/> is based on a review of the code to determine the potential indication of threats. Those indicators can be hashes, IP addresses, code signatures, code patterns, strings, functions, and so on.</p>
			<p>The main characteristic of this analysis is that it does not execute the code, and while this is an advantage in terms of resources, the scope is also limited because it will not fully test the impact and actions executed by the malware.</p>
			<p>Another downside is that sophisticated malware may include advanced features aimed to bypass this static analysis.</p>
			<h2 id="_idParaDest-319"><a id="_idTextAnchor333"/>Dynamic malware analysis</h2>
			<p>This type<a id="_idIndexMarker1388"/> of testing <a id="_idIndexMarker1389"/>requires more resources in terms of skilled professionals, but also in terms of technology because<a id="_idIndexMarker1390"/> it requires an isolated environment to run a test, called a <strong class="bold">sandbox</strong>.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Sandboxes are very sensitive because if they are not properly configured and isolated, they can cause a catastrophic event. Therefore, they must only be used by experienced and trained experts.</p>
			<p>In this type of testing, the malware is executed on the sandbox to discover almost all characteristics of the malware explained in the previous heading.</p>
			<p>Therefore, the main advantage of dynamic malware analysis is that it provides better insights into the malware, which helps to discover additional information that will be impossible to obtain with static tests.</p>
			<p>However, there are some advanced malware that can bypass <code>xxx.xxx.xxx.xxx</code>—making the dynamic test unreliable.</p>
			<p>To overcome that problem, organizations are now using a hybrid approach.</p>
			<h2 id="_idParaDest-320"><a id="_idTextAnchor334"/>Hybrid malware analysis</h2>
			<p>As seen<a id="_idIndexMarker1391"/> in the following <a id="_idIndexMarker1392"/>screenshot, a hybrid approach is based on a combination of the two methods already explained, to take advantage of their benefits while also covering their weak spots:</p>
			<div><div><img src="img/Figure_14.2_B16290.jpg" alt="Figure 14.2 – Types of malware analysis&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.2 – Types of malware analysis</p>
			<p>As mentioned, an advanced malware may deceive a sandbox by using code to prevent full execution while in the sandbox environment; however, static analysis using <strong class="bold">heuristics</strong> or signatures might be able to detect that behavior, allowing the analyst to modify the sandbox to execute even those <em class="italic">hidden</em> features or actions of the malware. </p>
			<p class="callout-heading">What is heuristic malware analysis?</p>
			<p class="callout">Heuristics were introduced as a way to detect new threats such as unknown malware, modified malware, and even polymorphic malware. They basically work by analyzing the code of a file to look for either pieces of known viruses or common functions or code that are only present on malware, such as encrypting an entire drive, disabling the antivirus, and so on.</p>
			<p>I know <a id="_idIndexMarker1393"/>you want to know more<a id="_idIndexMarker1394"/> about malware tools, but before jumping into them, we need to understand the stages of malware analysis, as this may serve as a way to categorize the different tools available.</p>
			<p>Now, let's explore the different categories of malware analysis.</p>
			<h2 id="_idParaDest-321"><a id="_idTextAnchor335"/>Static properties analysis</h2>
			<p>This is a <a id="_idIndexMarker1395"/>simple type of<a id="_idIndexMarker1396"/> analysis, aimed at analyzing some basic characteristics of the malware (metadata) to understand more about the malware.</p>
			<p>Normally, this is the first step to determine if additional analysis is needed, and even to determine which analysis is more suitable. </p>
			<h2 id="_idParaDest-322"><a id="_idTextAnchor336"/>Interactive behavior analysis</h2>
			<p>Interactive <a id="_idIndexMarker1397"/>behavior <a id="_idIndexMarker1398"/>analysis is a very complex type of analysis in which the analyst interacts with the malware to better understand it (impact, connections, and so on). This type of testing is performed in a protected and isolated environment created specifically to perform this test. This enables the analyst to determine changes caused by the malware in the <strong class="bold">Operating System (OS)</strong>, registry keys, processes, service interdependencies, backdoors, and so on.</p>
			<h2 id="_idParaDest-323"><a id="_idTextAnchor337"/>Fully automated analysis</h2>
			<p>This is a <a id="_idIndexMarker1399"/>set of predetermined<a id="_idIndexMarker1400"/> tests that can be executed over a given malware to gather some additional information. This test is normally <em class="italic">cloud-based</em> (as a service) and provided by a third party.</p>
			<p>One of the main advantages is that it will produce an easy-to-read report, which means that no special skills are required to execute this type of testing. Additionally, this analysis is highly recommended when the company needs to analyze a big number of malware samples in a convenient and quick way.</p>
			<h2 id="_idParaDest-324"><a id="_idTextAnchor338"/>Manual code reversing</h2>
			<p>This is<a id="_idIndexMarker1401"/> probably the most complex type of malware analysis as it requires reverse-engineering the code using debuggers, dissemblers, or compilers.</p>
			<p>In some cases, even advanced cryptographic skills may be required to perform this testing.</p>
			<p>The different categories of malware analysis are shown in the following figure:</p>
			<div><div><img src="img/Figure_14.3_B16290.jpg" alt="Figure 14.3 – Categories of malware analysis&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.3 – Categories of malware analysis</p>
			<p>As highlighted in the preceding figure, code reversing is the most complex and time-consuming analysis.</p>
			<p>OK—now that you are a pro on the concepts of malware analysis (including their categories<a id="_idIndexMarker1402"/> and types of analysis), it's time to move on to the next topic and finally see the tools used to perform malware analysis.</p>
			<h1 id="_idParaDest-325"><a id="_idTextAnchor339"/>Best malware analysis tools</h1>
			<p>Let's do a<a id="_idIndexMarker1403"/> review of the top five tools used for malware analysis. This compilation includes tools from all types and categories of malware analysis.</p>
			<h2 id="_idParaDest-326"><a id="_idTextAnchor340"/>Process Explorer</h2>
			<p>This <a id="_idIndexMarker1404"/>tool is basically a <em class="italic">super task manager</em> that <a id="_idIndexMarker1405"/>provides you with a lot of information about the processes running in your system.</p>
			<p>It tells you the location of the file, the <strong class="bold">autorun</strong> settings, a dedicated performance graph of the process (useful to find anomalous patterns), and, as seen in the following screenshot, it has an option to check every process with the database of <a href="http://VirusTotal.com">VirusTotal.com</a>, which is very useful if you want to test suspicious processes:</p>
			<div><div><img src="img/Figure_14.4_B16290.jpg" alt="Figure 14.4 – Checking a running process using Process Explorer with VirusTotal.com&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.4 – Checking a running process using Process Explorer with VirusTotal.com</p>
			<p>This tool is basic but is free and supported by Microsoft, so it is definitely a good place to start.</p>
			<p>To download it, visit the official site at <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer">https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer</a>.</p>
			<h2 id="_idParaDest-327"><a id="_idTextAnchor341"/>Process Monitor </h2>
			<p><strong class="bold">Process Monitor</strong> (<strong class="bold">ProcMon</strong>) is<a id="_idIndexMarker1406"/> another<a id="_idIndexMarker1407"/> great tool by Microsoft (formerly Sysinternals) that allows you to monitor in real time all activity related to filesystems, processes, and threat activity. The executable file can be downloaded for free through<a id="_idIndexMarker1408"/> this link: <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procmon">https://docs.microsoft.com/en-us/sysinternals/downloads/procmon</a>.</p>
			<p>However, this tool can record thousands of events in a second, so there is a risk that you may bypass an event. However, to overcome this, you can export the results to a <strong class="bold">comma-separated values</strong> (<strong class="bold">CSV</strong>) file<a id="_idIndexMarker1409"/> that you can use to visualize offline, using a<a id="_idIndexMarker1410"/> tool<a id="_idIndexMarker1411"/> such as <em class="italic">ProcDOT</em>.</p>
			<h2 id="_idParaDest-328"><a id="_idTextAnchor342"/>ProcDOT</h2>
			<p>As<a id="_idIndexMarker1412"/> mentioned before, there are great tools, such as <strong class="bold">ProcMon</strong> and <a id="_idIndexMarker1413"/>even <strong class="bold">Wireshark</strong>, that provide great insights to uncover potential malware; however, these two tools produce thousands of records, which makes the process of analysis of the data very complex and time-consuming.</p>
			<p>But here is where <strong class="bold">ProcDOT</strong> comes in, as it enables you to correlate the data from those two sources (ProcMon and Wireshark) using interactive graphs, which greatly helps during the analysis process. Additionally, the tool has the following key features:</p>
			<ul>
				<li>Animation mode (great to easily understand timing aspects)</li>
				<li>Smart following algorithms (help you focus on relevant items)</li>
				<li>Detection and visualization of thread injection</li>
				<li>Correlation of network activities (and the causing processes)</li>
				<li>Activity timeline</li>
				<li>Filters to clean up noise (global- and session-wise)</li>
			</ul>
			<p>The following screenshot shows the output of visual analysis and correlation from ProcDOT:</p>
			<div><div><img src="img/Figure_14.5_B16290.jpg" alt="Figure 14.5 – ProcDOT visual analysis&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.5 – ProcDOT visual analysis</p>
			<p>Oh, and<a id="_idIndexMarker1414"/> this tool <a id="_idIndexMarker1415"/>is also free and available <a id="_idIndexMarker1416"/>at the following link: <a href="https://www.procdot.com/index.htm">https://www.procdot.com/index.htm</a>.</p>
			<h2 id="_idParaDest-329"><a id="_idTextAnchor343"/>Ghidra</h2>
			<p><strong class="bold">Ghidra</strong> is <a id="_idIndexMarker1417"/>a<a id="_idIndexMarker1418"/> great <strong class="bold">software reverse engineering</strong> (<strong class="bold">SRE</strong>) suite<a id="_idIndexMarker1419"/> developed by the <strong class="bold">National Security Agency</strong> (<strong class="bold">NSA</strong>) and<a id="_idIndexMarker1420"/> distributed for free as open software since 2019. One of the main characteristics of the software is its ability to disassemble the code without executing it.</p>
			<p>Additionally, Ghidra also has the following features:</p>
			<ul>
				<li>Multiplatform analysis of compiled code in Windows, macOS, and Linux</li>
				<li>Disassembly, assembly, and decomplication of code, graphing, and scripting</li>
				<li>Support<a id="_idIndexMarker1421"/> for<a id="_idIndexMarker1422"/> multiple <a id="_idIndexMarker1423"/>architectures, including <strong class="bold">Advanced RISC Machines</strong> (<strong class="bold">ARM</strong>), PowerPC, <strong class="bold">Million Instructions Per Second</strong> (<strong class="bold">MIPS</strong>), Java, 6800, x86, x64, <strong class="bold">Reduced Instruction Set Computer</strong> (<strong class="bold">RISC</strong>), and more.</li>
			</ul>
			<p>Installation<a id="_idIndexMarker1424"/> files<a id="_idIndexMarker1425"/> and <strong class="bold">frequently asked questions</strong> (<strong class="bold">FAQ</strong>) can<a id="_idIndexMarker1426"/> be<a id="_idIndexMarker1427"/> found on the official web page, at <a href="https://ghidra-sre.org/">https://ghidra-sre.org/</a>.</p>
			<h2 id="_idParaDest-330"><a id="_idTextAnchor344"/>PeStudio</h2>
			<p><strong class="bold">PeStudio</strong> is a <a id="_idIndexMarker1428"/>great<a id="_idIndexMarker1429"/> tool for <em class="italic">performing static malware analysis on Windows machines</em>.</p>
			<p>A cool feature is that <em class="italic">you don't need to install it</em> as it runs as a portable executable file on Windows. Also, consider that there is a basic version of the software available for free, while there is a premium version that can be purchased for a low price.</p>
			<p>Now, let's do a deep dive into this tool by doing hands-on malware analysis.</p>
			<h1 id="_idParaDest-331"><a id="_idTextAnchor345"/>Performing malware analysis</h1>
			<p>First, let's <a id="_idIndexMarker1430"/>start by downloading the executable files from their site at <a href="https://www.winitor.com/download">https://www.winitor.com/download</a>.</p>
			<p>Once you have the executable files, just double-click on them to run them. Then, you will be able to see the main interface, as shown in the following screenshot:<em class="italic"> </em></p>
			<div><div><img src="img/Figure_14.6_B16290.jpg" alt="Figure 14.6 – PeStudio GUI&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption"> </p>
			<p class="figure-caption">Figure 14.6 – PeStudio GUI</p>
			<p>Now, as seen in<a id="_idIndexMarker1431"/> the preceding screenshot, we just need to drag and drop the file that we want to analyze.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Malware analysis is a dangerous task that may harm your computer or even your entire network, so before starting, you need to follow some security measures, as we highlight next.</p>
			<h2 id="_idParaDest-332"><a id="_idTextAnchor346"/>Security measurements</h2>
			<p>There are some<a id="_idIndexMarker1432"/> security rules that must be followed to reduce the risk when performing malware analysis. Here is a compilation of them:</p>
			<ul>
				<li>Never use your personal or work computer to perform malware analysis.</li>
				<li>Make sure the machine used for testing is isolated from the network.</li>
				<li>The use of an isolated virtual sandbox environment is recommended.</li>
				<li>Use a new sandbox for each analysis wherever possible.</li>
				<li>Use a <strong class="bold">virtual machine</strong> (<strong class="bold">VM</strong>) hosted <a id="_idIndexMarker1433"/>on a machine isolated from the network that has a fresh image installed and with no other data stored.</li>
				<li>Delete the VM when the analysis is complete.</li>
				<li>Create a new VM for each analysis.</li>
				<li>Wipe out the disk of the host computer and perform a new OS installation when dealing with dangerous malware and performing dynamic analysis.</li>
				<li>Once the malware is identified, check if the malware is capable of hiding on the boot sector <a id="_idIndexMarker1434"/>of the <strong class="bold">hard disk drive</strong> (<strong class="bold">HDD</strong>) and if yes, take the necessary remediation steps to completely wipe the malware, because a normal disk wipe may not be sufficient.</li>
			</ul>
			<p>OK—now that<a id="_idIndexMarker1435"/> the safety measures are clear, let's start with the execution of the analysis.</p>
			<h2 id="_idParaDest-333"><a id="_idTextAnchor347"/>Executing the analysis</h2>
			<p>In this case, we<a id="_idIndexMarker1436"/> will perform several types of analyses with different file types so that we can explore the different types of data that we can gather with this tool.</p>
			<p>The idea here is to walk through the tool and determine the information that we need to look for when performing the analysis; therefore, it is an unnecessary risk to perform this example with real malware. Instead, we will use known safe files to perform the analysis.</p>
			<p>For the first one, I will use a registry file (for example, you can use the one on the installation package of PeStudio).</p>
			<p>As you can see in the following screenshot, the main screen will give you some basic information such as hashes (which can be useful to contrast with a database of known hashes):</p>
			<div><div><img src="img/Figure_14.7_B16290.jpg" alt="Figure 14.7 – Basic output from PeStudio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.7 – Basic output from PeStudio</p>
			<p>Additionally, and as seen in <em class="italic">Figure 14.8</em>, there is a great section called <strong class="bold">virustotal</strong> that provides an integration with the VirusTotal <strong class="bold">application programming interface</strong> (<strong class="bold">API</strong>) to tell <a id="_idIndexMarker1437"/>you how this file is rated by different antivirus software. Here, you need to consider that it connects to an external server for this query; therefore, the results here may take some time to be displayed. However, if someone else has already scanned the file, then the output is almost immediate. Now, this also tells you something about the file because if it is not found, then you are either facing a very new threat or a modified file used to attack your infrastructure, so this may serve as evidence that you are under a targeted attack.</p>
			<p>Another interesting piece of data here is the <strong class="bold">age</strong> column because it shows you when it was scanned <a id="_idIndexMarker1438"/>by each antivirus and, as shown in the following screenshot, there is one scan from more than 2 years ago, which means that this file has been out for quite some time:</p>
			<div><div><img src="img/Figure_14.8_B16290.jpg" alt="Figure 14.8 – Scan results from VirusTotal&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.8 – Scan results from VirusTotal</p>
			<p>Now, the <strong class="bold">strings</strong> section is super important because it reads the actual content of the file, so you can explore it without having to open it. For example, in the following screenshot, we can see the value of the registry key:</p>
			<div><div><img src="img/Figure_14.9_B16290.jpg" alt="Figure 14.9 – Checking the value of a registry file without opening it&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.9 – Checking the value of a registry file without opening it</p>
			<p>Another example is that you can determine whether the content of the file has encoded any URL (such as a C&amp;C server), as shown in the following screenshot. Another interesting item to highlight in this screenshot is that the tool also shows long strings, which can be considered a threat. This is very useful because it saves you time by showing you<a id="_idIndexMarker1439"/> this information in a very clean way that would otherwise be very difficult to find (manually):</p>
			<div><div><img src="img/Figure_14.10_B16290.jpg" alt="Figure 14.10 – URL pattern found inside a file&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.10 – URL pattern found inside a file</p>
			<p>OK—now, let's scan a more complex file, such as a <code>.dll</code> file.</p>
			<p>As shown in <em class="italic">Figure 14.11</em>, PeStudio now shows many more categories with a lot of useful information.</p>
			<p>For example, the <strong class="bold">strings</strong> section has a lot of interesting information, such as the following: </p>
			<ul>
				<li>Interaction or actions with registry keys</li>
				<li>Interaction or actions with files including permissions (for example, get file size, delete file, write file, and so on). </li>
				<li>Execution of system actions (open a process, delete a process, and so on)</li>
				<li>Window (GUI) management (close a window, send a popup, get popup data, and so on) </li>
				<li><strong class="bold">Input and output</strong> (<strong class="bold">I/O</strong>) actions (get <a id="_idIndexMarker1440"/>active windows, mouse or keyboard actions, and so on).</li>
			</ul>
			<p>Another important category to review is <code>.dll</code> files associated with this file, which is super important for determining the scope of the malware. Additionally, PeStudio allows you to copy the name of the <code>.dll</code> file. If you are not familiar with <code>.dll</code>, you<a id="_idIndexMarker1441"/> can google it for more help (or go directly to <strong class="bold">Microsoft Developer Network</strong> (<strong class="bold">MSDN</strong>).</p>
			<p>You can see <a id="_idIndexMarker1442"/>an overview of PeStudio here:</p>
			<div><div><img src="img/Figure_14.11_B16290.jpg" alt="Figure 14.11 – Analysis of libraries on PeStudio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.11 – Analysis of libraries on PeStudio</p>
			<p>Now, in the <strong class="bold">sections</strong> category, you would be able to see advanced attributes of the malware, such as whether the file is writable, executable, shareable, or discardable (denoted by an <strong class="bold">X</strong> symbol). Another common characteristic of malware that you can see in this section is self-modifying, which is a common attribute of morphing malware.</p>
			<p>The <strong class="bold">file-header</strong> category also shows a very important piece of information about when the file was compiled. Also, keep in mind that some malware has auto-compiling characteristics, so if you have a very recent date, then you may be facing advanced auto-compiling malware.</p>
			<p>Oh, and one more thing: if any of the antivirus engines of <a href="http://VirusTotal.com">VirusTotal.com</a> detected the file as malware (as seen in the following screenshot), then you have the option to go to the <strong class="bold">virustotal </strong>category<a id="_idIndexMarker1443"/> to get additional information about the malware:</p>
			<div><div><img src="img/Figure_14.12_B16290.jpg" alt="Figure 14.12 – View of VirusTotal scan results on PeStudio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.12 – View of VirusTotal scan results on PeStudio</p>
			<p>The <strong class="bold">virustotal</strong> category also gives you a lot of super useful data that you can correlate against your own analysis. For example, <strong class="bold">virustotal</strong> will show you the registry keys affected, deleted, or updated by the malware, as well as other actions such as the processes <a id="_idIndexMarker1444"/>killed by the malware.</p>
			<p><em class="italic">And before we finish this chapter, remember to always follow the required safety measurements BEFORE performing malware analysis. </em></p>
			<h1 id="_idParaDest-334"><a id="_idTextAnchor348"/>Summary</h1>
			<p>In this chapter, we learned a lot about malware analysis, but more importantly, about how we can gather and understand the outputs from the tools used for the analysis.</p>
			<p>While malware analysis is mostly performed by a specialized team (with specialized tools and environments), the knowledge obtained about this process has given you the skills to better manage a global cybersecurity strategy like a pro!</p>
			<p>Now, it's time to move on to another exciting chapter in which we will learn how to leverage pentesting tools and techniques in defensive security.</p>
			<h1 id="_idParaDest-335"><a id="_idTextAnchor349"/>Further reading</h1>
			<p>To find out more about malware analysis, you can read the following book:</p>
			<p><a href="https://www.packtpub.com/product/mastering-malware-analysis/9781789610789">https://www.packtpub.com/product/mastering-malware-analysis/9781789610789</a></p>
		</div>
	</body></html>