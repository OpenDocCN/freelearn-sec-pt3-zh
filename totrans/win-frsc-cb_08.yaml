- en: Web Browser Forensics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following recipes:'
  prefs: []
  type: TYPE_NORMAL
- en: Mozilla Firefox analysis with BlackBag BlackLight
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Google Chrome analysis with Magnet AXIOM
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Microsoft Internet Explorer and Microsoft Edge analysis with Belkasoft Evidence
    Center
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Extracting web browser data from Pagefile.sys
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: It is hard to imagine a case where web browser artifacts are useless. Child
    abuse material, intellectual property theft, cyber harassment, malware - browser
    artifacts will help to solve all sorts of cases. Nowadays, a huge number of web
    browsers are available. Some provide their users with increased privacy options,
    others do not. But even if the suspect uses a private browser, such as notorious
    Tor, a computer forensic examiner is able to extract some data, for example from
    swap and hibernation files (check the last recipe in this chapter) or a memory
    dump.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we will show you how to perform web browser forensics with
    some forensic tools you have already dealt with, such as Magnet AXIOM and Belkasoft
    Evidence Center, and some new ones, such as BlackBag's BlackLight.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, you will learn how to defeat some anti-forensic techniques using swap
    (`pagefile.sys` and `swapfile.sys`) and hibernation files. Let's go!
  prefs: []
  type: TYPE_NORMAL
- en: Mozilla Firefox analysis with BlackBag's BlackLight
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: BlackBag's BlackLight is a very powerful digital forensic tool which we usually
    use for Mac OS X (macOS) forensicating. But, of course, Mac is not the only platform
    it supports. You can also use it for Android, iOS, and Windows forensics. What's
    more, you can use BlackLight both on Windows and macOS workstations, meaning that
    you can analyze Windows forensic images on a Mac! In this recipe, we will show
    you how to use BlackLight for Mozilla Firefox forensics.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you are not a licensed user of BlackLight, you can request a trial licence
    on the BlackBag website. Use the REQUEST TRIAL button on the BlackLight page,
    fill in your personal information, such as first and last names, phone number,
    city, email, and so on, and click on SUBMIT. You'll get your trial key and product
    download links via email, so make sure you have submitted your real email, ideally
    a government or business one.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now you need to get a folder with Firefox files for analysis. If you have a
    Windows XP system, look here:'
  prefs: []
  type: TYPE_NORMAL
- en: '`C:\Documents and Settings\%USERNAME%\Application Data\Mozilla\Firefox\`'
  prefs: []
  type: TYPE_NORMAL
- en: 'If you are dealing with a Windows Vista system (or later), look here:'
  prefs: []
  type: TYPE_NORMAL
- en: '`C:\Users\admin\AppData\Roaming\Mozilla\Firefox\Profiles\%PROFILE%.default`'
  prefs: []
  type: TYPE_NORMAL
- en: Among other files, you'll find a bunch of valuable SQLite databases. These databases
    contain information about browsing history, downloads and so on, and BlackLight
    will help us to extract and analyze this data.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The steps for Mozilla Firefox analysis are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Open BlackLight and create a new case. To do this, go to File - New Case, or
    just click on the **New...** button, and choose your case location. Once you have
    saved the case, you can start filling in the necessary fields and choose the right
    time zone, as shown in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/62c9911d-741d-4a75-b7f9-a3a65cf7132f.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 8.1\. Case details
  prefs: []
  type: TYPE_NORMAL
- en: Now we are ready to add evidence. Click on the green Add button in front of
    **EVIDENCE**. As we have already exported a Firefox profile folder, click on the
    green Add button again, then the Add folder button, and choose the folder you
    exported.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d4f71c7a-963a-421d-a27a-00c23edbff13.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 8.2\. Adding evidence
  prefs: []
  type: TYPE_NORMAL
- en: Once the data has been processed, you should find the extracted data in the
    **Internet** tab. If, for some reason, this tab does not have the desired contents,
    you can analyze Firefox SQLite databases manually - BlackLight has a powerful
    built-in SQLite browser!
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Let's use it and analyze `places.sqlite` - an SQLite database that contains
    information about the suspect's browsing history. Go to the Browser tab, choose
    the database, and use the Preview feature to examine it with BlackLight SQLite
    browser.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/31eb6a75-59c1-4b50-9f34-3191b3ed3a30.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 8.3\. Manual analysis of 'places.sqlite' SQLite database
  prefs: []
  type: TYPE_NORMAL
- en: Date/Time feature. Have you noticed the **Recovered Fragments** table? This
    can help an examiner to recover deleted data - in our case, deleted web history
    records.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: BlackLight analyzes Firefox databases and extracts available data (including
    deleted data) for further examination, including history, bookmarks, downloads,
    forms data, cookies, and so on. Also, a built-in SQLite browser enables the examiner
    to analyze these databases manually.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'BlackBag BlackLight page: [https://www.blackbagtech.com/blacklight.html](https://www.blackbagtech.com/blacklight.html)'
  prefs: []
  type: TYPE_NORMAL
- en: BlackBag BlackLight Quick Start Guide: [https://www.blackbagtech.com/resources/quickstart-guides/quickstart-guide-blacklight.html](https://www.blackbagtech.com/resources/quickstart-guides/quickstart-guide-blacklight.html)
  prefs: []
  type: TYPE_NORMAL
- en: Google Chrome analysis with Magnet AXIOM
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Google Chrome is another very popular web browser. You will find its artifacts
    during many forensic examinations, not only on Windows systems, but also macOS,
    Linux, and even mobile platforms. With the help of this recipe you will learn
    how to parse Google Chrome artifacts with Magnet AXIOM.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Of course, you can use the whole forensic image as the source, but it is much
    faster to extract the Google Chrome folder from the user''s profile, as this greatly
    reduces the dataset that has to be parsed. Here is where you can find the folders
    you need:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Windows XP:'
  prefs: []
  type: TYPE_NORMAL
- en: '`C:\Documents and Settings\%USERNAME%\Local Settings\Application Data\Google\Chrome`'
  prefs: []
  type: TYPE_NORMAL
- en: 'Windows Vista and above:'
  prefs: []
  type: TYPE_NORMAL
- en: '`C:\Users\%USERNAME%\AppData\Local\Google\Chrome`'
  prefs: []
  type: TYPE_NORMAL
- en: Export the folder, make sure Magnet AXIOM with a valid licence or trial is installed
    on your forensic workstation, and you are ready to go.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Create a new case in AXIOM, use the folder you exported as the evidence source,
    and make sure Google Chrome is chosen in the artifacts list. As soon as all these
    steps are performed, run evidence analysis. It won't take too much time, but you'll
    get lots of useful forensic artifacts. The artifacts extracted in our case are
    shown in the following figure.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/c9fab597-ddd9-4e83-b751-59e768b40fe8.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 8.4\. Google Chrome artifacts extracted with Magnet AXIOM
  prefs: []
  type: TYPE_NORMAL
- en: As you can see in the preceding figure, there are quite a lot of artifacts.
    Let's dive a bit deeper.
  prefs: []
  type: TYPE_NORMAL
- en: '**Chrome Autofill Profiles** are profiles used by Chrome to fill in form fields
    automatically.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Bookmarks** are webpages bookmarked by the user.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Cache Records** are files downloaded by the browser to speed up the loading
    of  webpages. This can include pictures, HTML, javascript, and so on.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Cookies** - small files which contain information about websites visited
    by the user.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Current Session** - information about the current session.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Current Tabs** - tabs opened in the current session.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Downloads** - files downloaded with Google Chrome.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome FavIcons** - favicons from the Chrome address bar.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Keyword Search Terms** - keywords entered by the user.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Last Session** - information about the previous session.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Last Tabs** - tabs opened in the previous session.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Logins** - the user''s login information saved by Chrome.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Shortcuts** - shortcuts for user entered URLs.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Sync Accounts** - user accounts used for syncing to the cloud.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Sync Data** - data synced to the cloud.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Top Sites** - most frequently visited websites.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Web History** - websites the user visited (unique visits only).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Chrome Web Visits** - websites the user visited (all visits).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Also, AXIOM uses a carving technique to recover deleted data from Chrome databases.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Magnet AXIOM finds and parses Google Chrome artifacts from a forensic image,
    drive, folder, or file specified by a digital forensic examiner. Parsed artifacts
    are divided into several groups to make forensicating even more convenient.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Digital Forensics: Artifact Profile Google Chrome:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://www.magnetforensics.com/artifact-profiles/artifact-profile-google-chrome/](https://www.magnetforensics.com/artifact-profiles/artifact-profile-google-chrome/)'
  prefs: []
  type: TYPE_NORMAL
- en: Microsoft Internet Explorer and Microsoft Edge analysis with Belkasoft Evidence
    Center
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Hopefully, you have already added Belkasoft Evidence Center to your Windows
    forensic toolkit. As you will remember, it can help you to carve data out of memory
    dumps. Of course, this is not the only task it can help you to solve. It has robust
    support for hundreds of Windows operating system forensic artifacts, including
    different web browsers. In this recipe, we will show you how to use it for Microsoft
    Internet Explorer and Microsoft Edge forensic analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you already have Belkasoft Evidence Center installed, just start the tool.
    Otherwise, use the trial download link from the *See also* section to obtain a
    trial version of the tool. You will need a Windows 10 image, as we are planning
    to analyze Microsoft Edge data.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The steps for Microsoft Edge analysis and Microsoft Internet Explorer Analysis
    using Belkasoft Evidence Center are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: First of all, let's create a new case. Fill in the case information, choose
    the Root folder (the case folder will be created automatically), and don't forget
    to make sure you choose the right time zone from the drop-down menu. If you want,
    you can add a case description as well.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/918e2b32-a560-4262-b1da-9ba2344e70a9.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 8.5\. Creating a new case in Belkasoft Evidence Center
  prefs: []
  type: TYPE_NORMAL
- en: Now it's time to choose a data source. As you can see in the following figure,
    we have a number of options here. This time, we are going to choose a drive image.
    We have a test image named `Browsers.E01`. If you have created an image of a Windows
    10 drive, you can use it for this recipe, otherwise, find such a system and solidify
    your knowledge by imaging it. Also, you can create a Windows 10 virtual machine
    and use its virtual disk - such disks are also supported by Belkasoft Evidence
    Center.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ecf27ce4-0814-4b4e-93cd-12a8a191640e.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 8.6\. Adding a data source in Belkasoft Evidence Center
  prefs: []
  type: TYPE_NORMAL
- en: Let's choose the forensic artifacts we want to search for. First, click on the Select
    none to uncheck all data types. Now go to Browsers, scroll down to Windows on
    the left pane, and choose Edge, and then Internet Explorer. Don't forget to tick
    the Carve option to extract even more data!
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/fb36bc0f-88ef-467c-a3c2-5791d0b17eb4.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 8.7\. Choosing data types in Belkasoft Evidence Center
  prefs: []
  type: TYPE_NORMAL
- en: Once the image has been processed, you'll see all the results in both the Overview and
    Case Explorer tabs.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7150ce8b-c127-4229-9d2c-e39677ca6c1e.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 8.8\. Overview tab
  prefs: []
  type: TYPE_NORMAL
- en: 'If you dig deeper and analyze browser history artifacts, you will notice that
    all of them are marked as Internet Explorer 10+. This is because both Internet
    Explorer and Edge store history records in the same database, located at: `C:\Users\%USERNAME%\AppData\Local\Microsoft\Windows\WebCache\WebCacheV01.dat`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Also, you can see the Typed URLs section in the preceding figure. These URLs
    are typed by the user directly   into the browser's address bar, and are stored
    in the registry. You can learn more about Windows Registry   forensics in [Chapter
    6](b0744ad4-0b69-4f94-8ba3-ab97e53116f8.xhtml), *Windows Registry Analysis.*
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Belkasoft Evidence Center walks through all files and folders and extracts available
    data from web browsers. If carving is enabled, it also extracts data from unallocated
    space.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Belkasoft Evidence Center download page:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://belkasoft.com/get](https://belkasoft.com/get)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Internet Explorer developer documentation:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://msdn.microsoft.com/en-us/library/hh772401(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/hh772401(v=vs.85).aspx)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Microsoft Edge developer documentation:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://docs.microsoft.com/en-us/microsoft-edge/](https://docs.microsoft.com/en-us/microsoft-edge/)'
  prefs: []
  type: TYPE_NORMAL
- en: Extracting web browser data from Pagefile.sys
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You already know that you can extract quite a lot of useful forensic artifacts
    from a memory dump. But there is more: you can perform memory forensics even without
    a memory dump! There are files on the drive that contain some parts of memory.
    These files are `pagefile.sys`, `swapfile.sys`, and `hiberfil.sys`, and they are
    located at the system root (`C:\`). In this recipe, we will show you how to extract
    browser data from `pagefile.sys` with Belkasoft Evidence Center.'
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: First of all, make sure you have Belkasoft Evidence Center with a valid licence
    (or a trial version) installed on your workstation. Then, use a tool of your choice,
    for example FTK Imager, to export data from your own system or from a forensic
    image you acquired earlier. As soon as you have this, you are ready to go.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The steps to extract web browser data from `Pagefile.sys` are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Start by creating a new case in Belkasoft Evidence Center - you already know
    how to do this. Then, add the `pagefile.sys` file you exported previously as the
    evidence source.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/10d0f627-8459-40bf-a66f-6c26138942e8.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 8.9\. Adding pagefile.sys as the evidence source
  prefs: []
  type: TYPE_NORMAL
- en: 'As we are planning to extract web browser artifacts and are dealing with a
    Windows system, let''s choose corresponding data types, as in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ee364d60-cda0-498c-9e79-30aad4141730.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 8.10\. Choosing data types
  prefs: []
  type: TYPE_NORMAL
- en: Click Finish and the processing will start. Once the processing phase has finished,
    go to the Overview tab and check the results.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/00a6b9f4-44b0-4858-95e5-244a058f0ba7.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 8.11\. Processing results
  prefs: []
  type: TYPE_NORMAL
- en: 'As you can see in the preceding figure, we have 2289 URLs extracted from pagefile.sys!
    Impressive,   isn''t it? You can do the same with two other files: swapfile.sys
    and hiberfil.sys.'
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Belkasoft Evidence Center walks through `Pagefile.sys` and extracts records
    from available web browsers. If a digital forensic examiner chooses more data
    types, it can extract even more data, including images, messages, emails, and
    so on.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: What is the Page File for anyway?
  prefs: []
  type: TYPE_NORMAL
- en: '[https://blogs.technet.microsoft.com/askperf/2007/12/14/what-is-the-page-file-for-anyway/](https://blogs.technet.microsoft.com/askperf/2007/12/14/what-is-the-page-file-for-anyway/)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Analyzing hibernation and page files:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://ru.belkasoft.com/ru/bec/en/Hibernation_And_Page_Files_Investigation.asp](http://ru.belkasoft.com/ru/bec/en/Hibernation_And_Page_Files_Investigation.asp)'
  prefs: []
  type: TYPE_NORMAL
