<html><head></head><body>

  <div class="chapter" title="Chapter 7. Acquisition &#x2013; Approaching Windows Phone and Windows 10 Mobile">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch07"/>Chapter 7. Acquisition – Approaching Windows Phone and Windows 10 Mobile</h1>

        </div>

      </div>

    </div>

    <p>Windows Phone is a newcomer in the mobile market. Microsoft is playing aggressively, selling large numbers of low-cost devices through many wireless carriers. The operating system is optimized to run perfectly even on low-end hardware and it offers a much smoother user experience on cheap phones, compared to the bulkier and heavier Android.</p>

    <p>According to IDC (<a class="ulink" href="http://www.idc.com/prodserv/smartphone-os-market-share.jsp">http://www.idc.com/prodserv/smartphone-os-market-share.jsp</a>), Windows Phone accounts for some 2.6% market share (Q2 2015). 8.8 million units were sold in Q2 of 2015.</p>

    <p>Unlike BlackBerry, whose market share has been dropping year over year, Microsoft manages to grow its user base by selling millions of inexpensive devices in emerging markets, such as India. Windows Phone is a strong third after Google Android and Apple iOS, while BlackBerry barely makes it into the <span class="strong"><strong>Others</strong></span> chart.</p>

    <p>According to Kantar (<a class="ulink" href="http://www.kantarworldpanel.com/smartphone-os-market-share/intro">http://www.kantarworldpanel.com/smartphone-os-market-share/intro</a>), in December 2015 Windows Phone devices accounted for 6.4% of all smartphone sales in Germany (compared to the 20.2% market share of Apple iPhone). In the U.S., Windows Phone accounts for 1.6% of smartphone sales, while iOS enjoys a healthy market share of 39.1%.</p>

    <p>In general, Windows Phone becomes a popular choice in Europe (9.2% in Great Britain and 8.1% in Italy). The Microsoft mobile operating system is uncommon in Asia (1.2% in China and nearly absent in Japan):</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0130.jpeg" alt="Acquisition – Approaching Windows Phone and Windows 10 Mobile"/>

      <div class="caption">

        <p>Source: http://wp7forum.ru/kantar-worldpanel-otchet-po-dole-rynka-mobilnyx-operacionnyx-sistem-za-sentyabr-2014-goda/</p>

      </div>

    </div>

    <p> </p>

    <div class="section" title="Windows Phone security model">

      <div class="titlepage">

        <div>

          <div>

            <h1 class="title" id="toc_1"><a id="ch07lvl1sec43"/>Windows Phone security model</h1>

          </div>

        </div>

      </div>

      <p>A comprehensive whitepaper on the Windows Phone 8 security model is available from Microsoft at <a class="ulink" href="http://download.microsoft.com/download/B/9/A/B9A00269-28D5-4ACA-9E8E-E2E722B35A7D/Windows-Phone-8-1-Security-Overview.pdf">http://download.microsoft.com/download/B/9/A/B9A00269-28D5-4ACA-9E8E-E2E722B35A7D/Windows-Phone-8-1-Security-Overview.pdf</a>.</p>

    </div>

  </div>




  <div class="section" title="Windows Phone physical acquisition">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch07lvl1sec44"/>Windows Phone physical acquisition</h1>

        </div>

      </div>

    </div>

    <p>Apparently, Microsoft did a great job protecting Windows Phone devices. Indeed, Microsoft has full control over the platform (Qualcomm) that is used by the different manufacturers of Windows Phone devices, so unlike Android there can be no sub-standard implementations here. As a result, all Windows Phone devices are roughly equivalent in terms of security. Until very recently, JTAG and chipoff acquisitions were the only methods to acquire most Windows Phones. However, in January 2015, Cellebrite implemented an acquisition module enabling investigators to perform physical acquisition of a lot of Lumia devices. The technology is still at an early stage. There's still a lot to do in parsing the contents. However, the filesystem is NTFS, and the OS is very similar to Windows, so eventually, this will be done.</p>

    <p>Since then, yet another development emerged. <span class="strong"><strong>Windows Phone Internals</strong></span> (<a class="ulink" href="http://www.wpinternals.net/">http://www.wpinternals.net/</a>) developed a bootloader unlock method for Lumia 520, 521, 525, 620, 625, 720, 820, 920, 925, 928, 1020, and 1320. Devices with unlocked bootloaders can be used to boot unsigned code which, in turn, can be used for the purpose of physical acquisition.</p>

  </div>




  <div class="section" title="JTAG forensics on Windows Phone 8.x and Windows 10 Mobile">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch07lvl1sec45"/>JTAG forensics on Windows Phone 8.x and Windows 10 Mobile</h1>

        </div>

      </div>

    </div>

    <p>Similar to Android, most Windows Phone 7.x, 8.x, and Windows 10 Mobile devices can be successfully acquired via the process of JTAG forensics. The process is very similar to that of acquiring Android devices, so refer to JTAG acquisition in the following chapter, JTAG Forensics [p.42].</p>

    <p>The chances of successfully JTAGging a Windows smartphone are very high compared to Android devices. However, things happen to change with regard to JTAG acquisition as Windows Phone 8.x devices upgrade to Windows 10 Mobile.</p>

    <div class="section" title="Windows Phone 8.x device encryption">

      <div class="titlepage">

        <div>

          <div>

            <h2 class="title" id="toc_1"><a id="ch07lvl2sec83"/>Windows Phone 8.x device encryption</h2>

          </div>

        </div>

      </div>

      <p>Windows Phone 8 and 8.1 do not offer a user-configurable setting for encrypting the data partition. According to the official <span class="strong"><strong>Windows Phone 8.1 Security Overview</strong></span> document (which can be downloaded from <a class="ulink" href="https://download.microsoft.com/download/B/9/A/B9A00269-28D5-4ACA-9E8E-E2E722B35A7D/Windows-Phone-8-1-Security-Overview.pdf">https://download.microsoft.com/download/B/9/A/B9A00269-28D5-4ACA-9E8E-E2E722B35A7D/Windows-Phone-8-1-Security-Overview.pdf</a>), internal storage can only be encrypted via a corporate security policy by implementing the <span class="strong"><strong>Require Device Encryption</strong></span> policy. When activated, the policy prevents users from disabling device encryption and forces encryption of internal storage. No escrow keys are created or uploaded to anywhere on the network to allow decrypting the encrypted partition. When enabled, Windows Phone 8.1 devices are encrypted with BitLocker technology using <span class="strong"><strong>Advanced Encryption Standard</strong></span> (<span class="strong"><strong>AES</strong></span>) 128-bit encryption.</p>

      <div class="note" title="Note" style="">

        <div class="inner">

          <h3 class="title" id="toc_2"><a id="note38"/>Note</h3>

          <p> <span class="strong"><strong>Important</strong></span>: There is no user-accessible option anywhere in Windows Phone 8.x settings to enable or disable encryption. Encryption can be only enabled via a pushed corporate policy. As a result, the majority of end-user devices remain unencrypted with no possibility for the user to encrypt data.</p>

        </div>

      </div>

    </div>

    <div class="section" title="Windows 10 Mobile device encryption">

      <div class="titlepage">

        <div>

          <div>

            <h2 class="title" id="toc_3"><a id="ch07lvl2sec84"/>Windows 10 Mobile device encryption</h2>

          </div>

        </div>

      </div>

      <p>This system has changed in Windows 10 Mobile. In this version of the OS, users can enable encryption manually via <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Device encryption</strong></span>:</p>

      <p> </p>

      <div class="mediaobject">

        <img src="0131.jpeg" alt="Windows 10 Mobile device encryption"/>

      </div>

      <p> </p>

      <p>Interestingly, Windows 10 Mobile allows users to disable device encryption after it's been enabled. This is something that is not possible in Android. In order to disable device encryption, users simply turn the slider <span class="strong"><strong>Off</strong></span> on the same configuration screen.</p>

      <p>With regard to JTAG acquisition, encrypted devices present little interest and must be decrypted prior to acquisition. In order to decrypt the device, the correct PIN code must be entered to unlock the device; however, Windows 10 Mobile makes encryption possible even without a PIN code. In Windows 10 Mobile, there is no user-configurable provision to wipe device memory after n unsuccessful login attempts; therefore, hardware-based PIN recovery options are possible for such devices.</p>

    </div>

  </div>




  <div class="section" title="Windows Phone 8/8.1 and Windows 10 Mobile cloud forensics">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch07lvl1sec46"/>Windows Phone 8/8.1 and Windows 10 Mobile cloud forensics</h1>

        </div>

      </div>

    </div>

    <p>Windows Phone 8 and 8.1 devices, as well as devices running Windows 10 Mobile, can use Microsoft OneDrive (formerly SkyDrive) via a Microsoft account (formerly My Windows Phone). Microsoft backups contain information in separate pieces in an obscure format. Manually analyzing this data is difficult even if you happen to know the user's Live ID and password or obtain the backup directly from Microsoft.</p>

    <p>When acquiring data from Microsoft cloud, <span class="strong"><strong>Elcomsoft Phone Breaker</strong></span> downloads information by chunks and creates an artificial backup. This backup mostly utilizes the SQLite format, thus enabling experts to use standard forensic tools to analyze its content. The tool also extracts a list of devices registered with a certain Microsoft account.</p>

    <p>Elcomsoft Phone Breaker can extract the following data for Windows Phone and Windows 10 Mobile devices:</p>

    <div class="itemizedlist">

      <ul class="itemizedlist">

        <li class="listitem" style="list-style-type: disc">Contacts</li>

        <li class="listitem" style="list-style-type: disc">Notes</li>

        <li class="listitem" style="list-style-type: disc">SMS messages</li>

      </ul>

    </div>

    <p>Downloaded data is saved as an archive that contains SQLite databases, as well as a <code class="literal">Manifest.xml</code> file containing information about every device from this user's Microsoft account and listing filenames for every database file.</p>

  </div>




  <div class="section" title="Acquiring Windows Phone backups over the air">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch07lvl1sec47"/>Acquiring Windows Phone backups over the air</h1>

        </div>

      </div>

    </div>

    <p>Elcomsoft Phone Breaker allows downloading Windows Phone data backed up in the cloud under the user's Microsoft account (provided that you know the user's Microsoft account login and password).</p>

    <p>To download Windows Phone data from Microsoft OneDrive, perform the following steps:</p>

    <div class="orderedlist">

      <ol class="orderedlist arabic">

        <li class="listitem">In the <span class="strong"><strong>Tools</strong></span> menu, select the <span class="strong"><strong>Microsoft</strong></span> tab, and click on <span class="strong"><strong>Download Windows Phone data</strong></span>:<p> </p><div class="mediaobject"><img src="0132.jpeg" alt="Acquiring Windows Phone backups over the air"/></div><p> </p></li>

        <li class="listitem">Define the <span class="strong"><strong>User name</strong></span> and <span class="strong"><strong>Password</strong></span> for the Microsoft account that was used for backing the data up. Toggle the view button to display or hide the password:<p> </p><div class="mediaobject"><img src="0133.jpeg" alt="Acquiring Windows Phone backups over the air"/></div><p> </p></li>

        <li class="listitem">Select a location for saving data downloaded from the Microsoft account.<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Click on <span class="strong"><strong>Change user</strong></span> to access data stored under a different Microsoft account</li><li class="listitem" style="list-style-type: disc">Click on <span class="strong"><strong>Download</strong></span> to start downloading data:<p> </p><div class="mediaobject"><img src="0134.jpeg" alt="Acquiring Windows Phone backups over the air"/></div><p> </p></li></ul></div></li>

        <li class="listitem">The download process begins. You can view the number of processed files and the number of errors received during decryption:<p> </p><div class="mediaobject"><img src="0135.jpeg" alt="Acquiring Windows Phone backups over the air"/></div><p> </p></li>

        <li class="listitem">When the decryption is finished, you can view the backup in the location on the local computer to which it was saved by clicking on the <span class="strong"><strong>View</strong></span> button. To view detailed information about decrypted files and errors that occurred during decryption, click on <span class="strong"><strong>Details</strong></span>:<p> </p><div class="mediaobject"><img src="0136.jpeg" alt="Acquiring Windows Phone backups over the air"/></div><p> </p></li>

        <li class="listitem">Click on <span class="strong"><strong>Finish</strong></span> to close the wizard.</li>

      </ol>

    </div>

    <p>The artificially created backup file is now available on your computer for further analysis. You can use <span class="strong"><strong>Elcomsoft Phone Viewer</strong></span> to browse and view the content of this backup. At this time, the tool extracts contacts, messages, and notes (in the MS OneNote format); Elcomsoft Phone Viewer can extract these notes into individual <code class="literal">*.one</code> files.</p>

    <div class="note" title="Note" style="">

      <div class="inner">

        <h3 class="title" id="toc_1"><a id="note39"/>Note</h3>

        <p> <span class="strong"><strong>Note</strong></span>: You can use the same Microsoft account credentials to access other information stored in the user's Microsoft account. This includes e-mail (Hotmail), online cloud storage (OneDrive), Skype contacts and history (Skype), and other services managed under the <span class="strong"><strong>Microsoft Live</strong></span> umbrella. A list of available backups can be viewed by signing into the user's OneDrive account and choosing <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Device backups</strong></span> (<a class="ulink" href="https://onedrive.live.com/Options/DeviceBackups">https://onedrive.live.com/Options/DeviceBackups</a>):</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0137.jpeg" alt="Acquiring Windows Phone backups over the air"/>

        </div>

        <p> </p>

      </div>

    </div>

    <p>You can now open the backup in Elcomsoft Phone Viewer. You'll be able to access contacts, messages, and notes created on all devices synced with the same Microsoft Account:</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0138.jpeg" alt="Acquiring Windows Phone backups over the air"/>

    </div>

    <p> </p>

    <p>The account captured during this session contains backups made by six Windows devices, including Microsoft Lumia 640 and Nokia Lumia 930 phones, a ThinkPad 8 tablet, a Nokia Lumia 2520 tablet running Windows RT, a desktop PC, and a laptop. Once downloaded, the backup can be accessed via the following interface:</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0139.jpeg" alt="Acquiring Windows Phone backups over the air"/>

    </div>

    <p> </p>

    <p>Messages are only available when downloading the information backed up by a Windows smartphone:</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0140.jpeg" alt="Acquiring Windows Phone backups over the air"/>

    </div>

    <p> </p>

    <p>Contacts, on the other hand, are available on all devices and are synced with the user's Outlook / Hotmail / Windows Live account:</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0141.jpeg" alt="Acquiring Windows Phone backups over the air"/>

    </div>

    <p> </p>

    <p>At this time, cloud acquisition options for Windows devices are limited to information seen earlier. The actual device backups (<a class="ulink" href="https://onedrive.live.com/Options/DeviceBackups">https://onedrive.live.com/Options/DeviceBackups</a>) are securely encrypted. Further research is required in order to be able to retrieve and decrypt these backups:</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0142.jpeg" alt="Acquiring Windows Phone backups over the air"/>

    </div>

    <p> </p>

  </div>




  <div class="section" title="Summary">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch07lvl1sec48"/>Summary</h1>

        </div>

      </div>

    </div>

    <p>In this chapter, we talked about Windows forensics as applicable to mobile devices. We also covered the acquisition of Windows Phone 8.x and Windows 10 Mobile smartphones. We discussed cloud acquisition and its limitation on the Windows platform, and learned how to use Elcomsoft Phone Breaker to extract backup data from Microsoft OneDrive. In the next chapter, we'll continue discussing the Windows platform, although this time we'll look into the next class of devices—tablets running the Windows and Windows RT OS.</p>

  </div>

</body></html>