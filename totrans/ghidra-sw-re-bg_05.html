<html><head></head><body><div><p>&#13;
			<h1 id="_idParaDest-54"><em class="italic"><a id="_idTextAnchor063"/>Chapter 4</em>: Using Ghidra Extensions</h1>&#13;
			<p><a id="_idTextAnchor064"/>In this chapter, we will introduce Ghidra extensions or modules. By using Ghidra extensions, you will be able to incorporate new functionalities into Ghidra according to your needs.</p>&#13;
			<p>Extensions are optional components that can extend Ghidra's functionality with experimental or user-contributed Ghidra plugins or analyzers. By using extensions, you can, for instance, integrate other tools into Ghidra, such as Eclipse or IDA Pro.</p>&#13;
			<p>We will continue using the Eclipse IDE for development but we will also need to install Gradle in order to compile Ghidra extensions. Both the Ghidra program and its extensions are prepared to be built using Gradle.</p>&#13;
			<p>By developing extensions or modules (formerly known as contribs), you will be able to make higher contributions to the Ghidra project (such as adding integration with other reverse engineering tools, supporting new file formats and processors, and so on) than developing mere plugins.</p>&#13;
			<p><a id="_idTextAnchor065"/><a id="_idTextAnchor066"/>Finally, you will learn how to use the Eclipse IDE for extension development and how to export a Ghidra extension from Eclipse after the development process.</p>&#13;
			<p>In this chapter, we're going to cover the following main topics: </p>&#13;
			<ul>&#13;
				<li>Installing existing Ghidra extensions</li>&#13;
				<li>Understanding the Ghidra extension skeleton</li>&#13;
				<li>Developing a Ghidra extension</li>&#13;
			</ul>&#13;
			<h1 id="_idParaDest-55"><a id="_idTextAnchor067"/>Technical requirements </h1>&#13;
			<p>The requirements for this chapter are as follow:</p>&#13;
			<ul>&#13;
				<li>Java JDK 11 for x86_64 (available here: <a href="https://adoptopenjdk.net/releases.html?variant=openjdk11&amp;jvmVariant=hotspot">https://adoptopenjdk.net/releases.html?variant=openjdk11&amp;jvmVariant=hotspot</a>)</li>&#13;
				<li>The Eclipse IDE for Java developers (any version supporting JDK 11 available here: <a href="https://www.eclipse.org/downloads/packages/">https://www.eclipse.org/downloads/packages/</a>) as it is the IDE that is officially integrated and supported by Ghidra</li>&#13;
				<li>Gradle (the build automation tool required to compile Ghidra extensions): <a href="https://gradle.org/install/">https://gradle.org/install/</a></li>&#13;
				<li>PyDev 6.3.1 (available here: <a href="https://netix.dl.sourceforge.net/project/pydev/pydev/PyDev%206.3.1/PyDev%206.3.1.zip">https://netix.dl.sourceforge.net/project/pydev/pydev/PyDev%206.3.1/PyDev%206.3.1.zip</a>)</li>&#13;
			</ul>&#13;
			<p>Assuming you have installed Java JDK 11, PyDev 6.3.1, and the Eclipse IDE for Java developers as explained in the previous chapter, you will need some additional software requirements in order to compile the Ghidra extensions: <a href="https://gradle.org/next-steps/?version=5.0&amp;format=bin">https://gradle.org/next-steps/?version=5.0&amp;format=bin</a>.</p>&#13;
			<p>Installing Gradle is a straightforward process. It consists of decompressing the ZIP file in the <code>C:\Gradle\</code> folder (as specified by the official install documentation), then setting the <code>GRADLE_HOME</code> system environment variable to point to <code>C:\Gradle\gradle-5.0</code>, and finally, adding <code>%GRADLE_HOME%\bin</code> to the <code>PATH</code> system environment variable.</p>&#13;
			<p>The GitHub repository containing all the necessary code for this chapter can be found at <a href="https://github.com/PacktPublishing/Ghidra-Software-Reverse-Engineering-for-Beginners/tree/master/Chapter04">https://github.com/PacktPublishing/Ghidra-Software-Reverse-Engineering-for-Beginners/tree/master/Chapter04</a>.</p>&#13;
			<p>Check out the following link to see the Code in Action video: <a href="https://bit.ly/2VTiUfw">https://bit.ly/2VTiUfw</a></p>&#13;
			<p class="callout-heading">Installing Gradle documentation</p>&#13;
			<p class="callout">For more details on installing Gradle, you can refer to the official documentation available online at <a href="https://docs.gradle.org/current/userguide/installation.html">https://docs.gradle.org/current/userguide/installation.html</a>. You can also refer to the offline documentation contained in the Gradle ZIP file: <code>getting-started.html</code>.</p>&#13;
			<h1 id="_idParaDest-56"><a id="_idTextAnchor068"/>Installing existing Ghidra extensions</h1>&#13;
			<p>A Ghidra extension <a id="_idIndexMarker119"/>is a Java code which extends Ghidra in some way and is distributed as an installable package. Ghidra extensions have access to the internals of Ghidra, allowing them to freely extend it.</p>&#13;
			<p>Some ready-to-use extensions are available in the appropriate <code>ghidra_9.1.2\ Extensions\Ghidra</code> folder of your installation of Ghidra:</p>&#13;
			<ul>&#13;
				<li><code>ghidra_9.1.2_PUBLIC_20200212_GnuDisassembler.zip</code></li>&#13;
				<li><code>ghidra_9.1.2_PUBLIC_20200212_sample.zip</code></li>&#13;
				<li><code>ghidra_9.1.2_PUBLIC_20200212_SampleTablePlugin.zip</code></li>&#13;
				<li><code>ghidra_9.1.2_PUBLIC_20200212_SleighDevTools.zip</code></li>&#13;
			</ul>&#13;
			<p>Let's take a look at the steps to install these already-available extensions. Please, open the <code>Chapter04</code> Ghidra project, <code>hello world.gpr</code>, and follow these steps:</p>&#13;
			<ol>&#13;
				<li>These extensions can be easily installed from Ghidra by clicking on <code>Extensions\Ghidra</code> directory of your Ghidra distribution.</p></li>&#13;
				<li>After checking <strong class="bold">SampleTablePlugin</strong> and clicking <strong class="bold">OK</strong>, you will see the following screen, so you will know for sure that you checked the extension:<div><img src="img/B16207_04_002.jpg" alt="Figure 4.2 – Extensions Changed! message after installing SampleTablePlugin&#13;&#10;"/></div><p class="figure-caption"> </p><p class="figure-caption">Figure 4.2 – Extensions Changed! message after installing SampleTablePlugin</p></li>&#13;
				<li>After clicking <strong class="bold">OK</strong> and <a id="_idIndexMarker120"/>manually restarting Ghidra, a prompt message asking to configure the plugin will appear when you open <strong class="bold">CodeBrowser</strong> via <strong class="bold">Tools</strong> | <strong class="bold">Run Tool</strong> | <strong class="bold">CodeBrowser</strong>:<div><img src="img/B16207_04_003.jpg" alt="Figure 4.3 – New Plugins Found! message after installing SampleTablePlugin and restarting Ghidra&#13;&#10;"/></div><p class="figure-caption"> </p><p class="figure-caption">Figure 4.3 – New Plugins Found! message after installing SampleTablePlugin and restarting Ghidra</p></li>&#13;
				<li>By answering affirmatively, we can take the opportunity to configure which plugins we are interested in enabling:<div><img src="img/B16207_04_004.jpg" alt="Figure 4.4 – Sample table plugin configuration&#13;&#10;"/></div><p class="figure-caption"> </p><p class="figure-caption">Figure 4.4 – Sample table plugin configuration</p></li>&#13;
				<li>After this step, a new <a id="_idIndexMarker121"/>option named <strong class="bold">Sample Table Provider</strong> will appear in the <strong class="bold">Window</strong> menu:<div><img src="img/B16207_04_005.jpg" alt="Figure 4.5 – The Sample Table Provider window implemented by the plugin&#13;&#10;"/></div><p class="figure-caption"> </p><p class="figure-caption">Figure 4.5 – The Sample Table Provider window implemented by the plugin</p></li>&#13;
				<li>By clicking on it, you will see that the functionality of Ghidra has been extended with a docking window allowing you to calculate function metrics. In this case, I checked <code>__main</code> function on the disassembly window.<p>You can easily locate the <code>__main</code> function (notice it starts with two <code>_</code> characters) using the <strong class="bold">Filter</strong> option in the <strong class="bold">Symbol Tree</strong> pane:</p></li>&#13;
			</ol>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B16207_04_006.jpg" alt="Figure 4.6 – Using Symbol Tree to locate the __main function in disassembly&#13;&#10;"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="figure-caption">Figure 4.6 – Using Symbol Tree to locate the __main function in disassembly</p>&#13;
			<p>The result of <a id="_idIndexMarker122"/>running the algorithms targeting <code>__main</code> looks as follows:</p>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B16207_04_007.jpg" alt="Figure 4.7 – Sample Table Provider executed over the __main function&#13;&#10;"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="figure-caption"> </p>&#13;
			<p class="figure-caption">Figure 4.7 – Sample Table Provider executed over the __main function</p>&#13;
			<p>In the next section, we will analyze the source code of this Ghidra extension.</p>&#13;
			<h2 id="_idParaDest-57"><a id="_idTextAnchor069"/>Analyzing the code of the Sample Table Provider plugin</h2>&#13;
			<p>Most <a id="_idIndexMarker123"/>Ghidra components are extensible but, when developing, you must first decide what kind of project you are dealing with: analyzer, plugin, loader, filesystem, or exporter.</p>&#13;
			<p>In this case, Sample Table Provider consists of a plugin Ghidra extension. A plugin extension is a program that extends from the <code>ghidra.app.plugin.ProgramPlugin</code> class, allowing it to handle the most common program events and also implement GUI components.</p>&#13;
			<p>Let's look over the code available in the <code>SampleTablePlugin\lib\SampleTablePlugin-src\ghidra\examples</code> directory of <code>ghidra_9.1.2_PUBLIC_20200212_SampleTablePlugin.zip</code>.</p>&#13;
			<p>The plugin part of Sample Table Provider is implemented by the <code>SampleTablePlugin.java</code> file, whose class extends from <code>ghidra.app.plugin.ProgramPlugin</code>, allowing you to update its internal <code>currentFunction</code> attribute when an event related to the current function happens, as mentioned in <a href="B16207_03_Final_SK_ePub.xhtml#_idTextAnchor041"><em class="italic">Chapter 3</em></a>, <em class="italic">Ghidra Debug Mode</em>:</p>&#13;
			<pre>public class SampleTablePlugin extends ProgramPlugin {</pre>&#13;
			<pre>    private SampleTableProvider provider;</pre>&#13;
			<pre>    private Function currentF	unction;</pre>&#13;
			<p>As <code>SampleTableModel.java</code> implements the table model by extending from <code>ThreadedTableModelStub</code>, <code>ThreadedTableModelStub</code> admits an abstract data type as a row, allowing you to define a custom class to store the rows. In this case, rows <a id="_idIndexMarker124"/>are objects whose class is <code>FunctionStatsRowObject</code>:</p>&#13;
			<pre>class SampleTableModel extends ThreadedTableModelStub&lt;FunctionStatsRowObject&gt; {</pre>&#13;
			<pre>    private SampleTablePlugin plugin;</pre>&#13;
			<pre>    SampleTableModel(SampleTablePlugin plugin) {</pre>&#13;
			<p>The <code>FunctionStatsRowObject.java</code> class is a Java class containing row fields:</p>&#13;
			<pre>import ghidra.program.model.address.Address;</pre>&#13;
			<pre>import ghidra.program.model.listing.Function;</pre>&#13;
			<pre>public class FunctionStatsRowObject {</pre>&#13;
			<pre>    private final Function function;</pre>&#13;
			<pre>    private final String algorithmName;</pre>&#13;
			<pre>    private int score;</pre>&#13;
			<pre>    FunctionStatsRowObject(Function function, String algorithmName, int score) {</pre>&#13;
			<p>The <code>SampleTableProvider.java</code> class is responsible for painting the table on the screen, filling the content, and defining the behavior when interacting:</p>&#13;
			<pre>public class SampleTableProvider extends ComponentProviderAdapter implements OptionsChangeListener {</pre>&#13;
			<pre>    private SampleTablePlugin plugin;</pre>&#13;
			<pre>    private JComponent component;</pre>&#13;
			<pre>    private GFilterTable&lt;FunctionStatsRowObject&gt; filterTable;</pre>&#13;
			<pre>    private SampleTableModel model;</pre>&#13;
			<pre>    private List&lt;FunctionAlgorithm&gt; discoveredAlgorithms;</pre>&#13;
			<pre>    private GCheckBox[] checkBoxes;</pre>&#13;
			<pre>    private GhidraFileChooserPanel fileChooserPanel;</pre>&#13;
			<pre>    private boolean resetTableData;</pre>&#13;
			<pre>    public SampleTableProvider(SampleTablePlugin plugin) {</pre>&#13;
			<p>The <code>FunctionAlgorithm.java</code> class defines the interface for those classes used to retrieve the data to fill the table:</p>&#13;
			<pre>public interface FunctionAlgorithm extends ExtensionPoint {</pre>&#13;
			<pre>    public int score(Function function, TaskMonitor monitor) throws CancelledException;</pre>&#13;
			<pre>    public String getName();</pre>&#13;
			<pre>}</pre>&#13;
			<p>At last, there are some classes allowing you to calculate the values of the <code>Score</code> column in Sample Table Provider:</p>&#13;
			<ul>&#13;
				<li><code>BasicBlockCount</code><code>erFunctionAlgorithm.java</code></li>&#13;
				<li><code>FunctionAlgorithm.java</code></li>&#13;
				<li><code>ReferenceFunctionAlgorithm.java</code></li>&#13;
				<li><code>SizeFunctionAlgorithm.java</code></li>&#13;
			</ul>&#13;
			<p>For <a id="_idIndexMarker125"/>instance, the <code>SizeFunctionAlgorithm</code> class retrieves the number of addresses contained in the current function to determine the size of the function. The retrieved data, as is evident, is obtained via Ghidra API calls:</p>&#13;
			<pre>import ghidra.program.model.address.AddressSetView;</pre>&#13;
			<pre>import ghidra.program.model.listing.Function;</pre>&#13;
			<pre>import ghidra.util.task.TaskMonitor;</pre>&#13;
			<pre>public class SizeFunctionAlgorithm implements FunctionAlgorithm {</pre>&#13;
			<pre>    @Override</pre>&#13;
			<pre>    public String getName() {</pre>&#13;
			<pre>        return "Function Size";</pre>&#13;
			<pre>    }</pre>&#13;
			<pre>    @Override</pre>&#13;
			<pre>    public int score(Function function, TaskMonitor monitor) {</pre>&#13;
			<pre>        AddressSetView body = function.getBody();</pre>&#13;
			<pre>        return (int) body.getNumAddresses();</pre>&#13;
			<pre>    }</pre>&#13;
			<pre>}</pre>&#13;
			<p>We will delve much deeper into the peculiarities of every kind of extension in <em class="italic">Section 3</em>, <em class="italic">Extending Ghidra</em>.</p>&#13;
			<p class="callout-heading">Ghidra extensions inheritance</p>&#13;
			<p class="callout">Remember that you can search for the classes you are extending from in the source code of Ghidra: <a href="https://github.com/NationalSecurityAgency/ghidra/blob/master/Ghidra/Features/Base/src/main/java/ghidra/app/plugin/ProgramPlugin.java">https://github.com/NationalSecurityAgency/ghidra/blob/master/Ghidra/Features/Base/src/main/java/ghidra/app/plugin/ProgramPlugin.java</a>. These classes are pretty well commented, so you can also check the auto-generated documentation from Ghidra via <strong class="bold">Help</strong> | <strong class="bold">Ghidra API Help</strong>.</p>&#13;
			<p>In this section, you <a id="_idIndexMarker126"/>learned what a Ghidra extension is, how it works internally, and how it looks in Ghidra from the users' perspective. In the next section, we will cover the skeleton of an extension.</p>&#13;
			<h1 id="_idParaDest-58"><a id="_idTextAnchor070"/>Understanding the Ghidra extension skeleton</h1>&#13;
			<p>In the <code>ghidra_9.1.2\Extensions\Ghidra</code> Ghidra <a id="_idIndexMarker127"/>extensions folder, there is also a <code>skeleton</code> folder, which includes five skeleton source code located in <code>ghidra_9.1.2\Ext<a id="_idTextAnchor071"/>ensions\Ghidra\Skeleton\src\main\java\skeleton</code>, which enables us to write any kind of Ghidra extension.</p>&#13;
			<p>Next, we will discuss the different types of plugin extensions by overviewing its skeletons. Those skeletons are available from Eclipse and we will create an extension later using a skeleton in the <em class="italic">Developing a Ghidra extension</em> section.</p>&#13;
			<h2 id="_idParaDest-59"><a id="_idTextAnchor072"/>Analyzers</h2>&#13;
			<p>Analyzers allow us to <a id="_idIndexMarker128"/>extend the Ghidra code <a id="_idIndexMarker129"/>analysis functionality. The skeleton to develop analyzers is available in the <code>SkeletonAnalyzer.java</code> file, which extends from <code>ghidra.app.services.AbstractAnalyzer</code>.</p>&#13;
			<p>The analyzer skeleton <a id="_idIndexMarker130"/>consists of the following elements:</p>&#13;
			<ul>&#13;
				<li>A constructor, which indicates the analyzer's name, its description, and the analyzer's type. In addition, you can call to <code>setSupportOneTimeAnalysis</code> before the call to <code>super</code> to indicate that the analyzer supports it:<pre>public SkeletonAnalyzer() {
        super("My Analyzer", "Analyzer description goes here", AnalyzerType.BYTE_ANALYZER);
}</pre><p>The analyzer's type can be one of the following: <code>BYTE_ANALYZER</code>, <code>DATA_ANALYZER</code>, <code>FUNCTION_ANALYZER</code>, <code>FUNCTION_MODIFIERS_ANALYZER</code>, <code>FUNCTION_SIGNATURES_ANALYZER</code>, <code>INSTRUCTION_ANALYZER</code>, or <code>ONE_SHOT_ANALYZER</code>.</p></li>&#13;
				<li>The <code>getDefaultEnablement</code> method returns a Boolean value indicating whether this analyzer will be enabled all the time.</li>&#13;
				<li>The <code>canAnalyze</code> method returns true if the program can be analyzed. You can check here, for instance, if your analyzer supports the assembly language of the program.</li>&#13;
				<li>If you want to let the user set some options for your analyzer, then you can override the <code>registerOptions</code> method.</li>&#13;
				<li>Finally, when things are added to the program, the method added will get called in order to perform the analysis. <p class="callout-heading">Analyzer tips</p><p class="callout">Don't let <code>getDefaultEnablement</code> return true if your analyzer is not fast enough because it can slow down Ghidra.</p></li>&#13;
			</ul>&#13;
			<p>Analyzers can be <a id="_idIndexMarker131"/>useful, for instance, when analyzing a C++ program to obtain <a id="_idIndexMarker132"/>&#13;
object-oriented programming information.</p>&#13;
			<h2 id="_idParaDest-60"><a id="_idTextAnchor073"/>Filesystems</h2>&#13;
			<p>Filesystems allow us to <a id="_idIndexMarker133"/>extend Ghidra to support <a id="_idIndexMarker134"/>archive files. Examples of archive files are APK, ZIP, RAR, and so on. The skeleton to develop filesystems is available in the <code>SkeletonFileSystem.java</code> file, which extends from <code>GFileSystem</code>. </p>&#13;
			<p>The filesystem skeleton <a id="_idIndexMarker135"/>consists of the following elements:</p>&#13;
			<ul>&#13;
				<li>A constructor. It receives as a parameter the root <a id="_idIndexMarker136"/>of the filesystem as the <strong class="bold">Filesystem Resource Locator</strong> (<strong class="bold">FSRL</strong>) and the filesystem provider.</li>&#13;
				<li>A filesystem implementation is complex. It consists of the following methods: <code>mount</code>, <code>close</code>, <code>getName</code>, <code>getFSRL</code>, <code>isClosed</code>, <code>getFileCount</code>, <code>getRefManager</code>, <code>lookup</code>, <code>getInputStream</code>, <code>getListing</code>, <code>getInfo</code>, and <code>getInfoMap</code>.</li>&#13;
			</ul>&#13;
			<h2 id="_idParaDest-61"><a id="_idTextAnchor074"/>Plugins</h2>&#13;
			<p>Plugins allow us to <a id="_idIndexMarker137"/>extend Ghidra in a lot of ways by <a id="_idIndexMarker138"/>accessing the GUI and the event notification systems. The skeleton to develop plugins is available in the <code>SkeletonPlugin.java</code> file, which extends from <code>ghidra.app.plugin.ProgramPlugin</code>. </p>&#13;
			<p>The plugin skeleton <a id="_idIndexMarker139"/>consists of the following elements:</p>&#13;
			<ul>&#13;
				<li>A constructor. It receives the parent tool as a parameter and allows us to customize or remove both the provider and the help of the plugin.</li>&#13;
				<li>An <code>init</code> method allowing us to acquire services if needed.</li>&#13;
				<li>It also includes an example of a provider extending from <code>ComponentProvider</code>, allowing us to <a id="_idIndexMarker140"/>customize the <a id="_idIndexMarker141"/>GUI and the actions.<p class="callout-heading">Plugin tips</p><p class="callout">If you want to see the complete list of services, please search for <code>ghidra.app.services</code> in Ghidra's Java documentation: <code>/api/ghidra/app/services/package-summary.html</code>.</p></li>&#13;
			</ul>&#13;
			<p>As you can imagine, plugin extensions are very versatile.</p>&#13;
			<h2 id="_idParaDest-62"><a id="_idTextAnchor075"/>Exporters</h2>&#13;
			<p>Exporters allow us to <a id="_idIndexMarker142"/>extend Ghidra by implementing <a id="_idIndexMarker143"/>the ability to export parts of a program available in Ghidra's program database. The skeleton to develop exporters is available in the <code>SkeletonExporter.java</code> file. </p>&#13;
			<p>The exporter <a id="_idIndexMarker144"/>skeleton consists of the following elements:</p>&#13;
			<ul>&#13;
				<li>A constructor. It allows us to set the name of the exporter and also associate a file extension to it.</li>&#13;
				<li>A <code>getOptions</code> method is also available to define custom options if required.</li>&#13;
				<li>A <code>setOptions</code> method to assign custom options, if they exist, to the exporter.</li>&#13;
				<li>An <code>export</code> method where the export operation must be implemented, and returns a Boolean value indicating whether the operation was successful or not.</li>&#13;
			</ul>&#13;
			<p>Some examples of preinstalled Ghidra exporters are the following: <code>AsciiExporter</code>, <code>BinaryExporter</code>, <code>GzfExporter</code>, <code>HtmlExporter</code>, <code>IntelHexExporter</code>, <code>ProjectArchiveExporter</code>, and <code>XmlExporter</code>.</p>&#13;
			<h2 id="_idParaDest-63"><a id="_idTextAnchor076"/>Loaders</h2>&#13;
			<p>Loaders allow <a id="_idIndexMarker145"/>us to extend Ghidra by adding support to new <a id="_idIndexMarker146"/>binary code formats. Examples of binary code formats are <code>SkeletonLoader.java</code> file, which extends from <code>AbstractLibrarySupportLoader</code>.</p>&#13;
			<p>The loader skeleton <a id="_idIndexMarker147"/>consists of the following elements:</p>&#13;
			<ul>&#13;
				<li>A <code>getName</code> method, which must be overridden to return the loader's name.</li>&#13;
				<li>A <code>findSupportedLoadSpecs</code> method, which must return an <code>ArrayList</code> with the specifications of the file if it is able to load it. If it is not able to load it, then it must return an empty <code>ArrayList</code>.</li>&#13;
				<li>A <code>load</code> method where the bulk of the implementation takes place. It loads the bytes from the provider into the program.</li>&#13;
				<li>If the loader has custom options, then you must define them in the <code>getDefaultOptions</code> method and also validate them in the <code>validateOptions</code> method.</li>&#13;
			</ul>&#13;
			<p>In this section, we went over the skeleton for every type of Ghidra extension. Go ahead and modify any skeleton in a way that may help you for development. In the next section, we will cover what Ghidra extension skeletons look like in Eclipse.</p>&#13;
			<h1 id="_idParaDest-64"><a id="_idTextAnchor077"/>Developing a Ghidra extension</h1>&#13;
			<p>In this section, we will <a id="_idIndexMarker148"/>cover how to create a Ghidra extension in Eclipse and then how to export it to Ghidra:</p>&#13;
			<ol>&#13;
				<li value="1">First, to create a new Ghidra extension in Eclipse, click on <strong class="bold">GhidraDev</strong> | <strong class="bold">New</strong> | <strong class="bold">Ghidra Module Project…</strong>:<div><img src="img/B16207_04_008.jpg" alt="Figure 4.8 – Creating a new Ghidra module project&#13;&#10;"/></div><p class="figure-caption">Figure 4.8 – Creating a new Ghidra module project</p></li>&#13;
				<li>Set a name for the Ghidra project as well as the project root directory. In this case, I'm setting <code>MyExtensions</code> as the project name and leaving the default values for <a id="_idIndexMarker149"/>the rest of the parameters:<div><img src="img/B16207_04_009.jpg" alt="Figure 4.9 – Setting the project name&#13;&#10;"/></div><p class="figure-caption">Figure 4.9 – Setting the project name</p></li>&#13;
				<li>As you know from the previous section, Ghidra has some module templates available. Choose those that are useful for your purpose. We are choosing all of them because we want to have all the Ghidra module skeletons. Click on <strong class="bold">Next &gt;</strong> instead of <strong class="bold">Finish</strong> to take two additional and useful steps:<div><img src="img/B16207_04_010.jpg" alt="Figure 4.10 – Choosing the module templates needed for this Ghidra module project&#13;&#10;"/></div><p class="figure-caption">Figure 4.10 – Choosing the module templates needed for this Ghidra module project</p></li>&#13;
				<li>Associate a Ghidra installation <a id="_idIndexMarker150"/>with your module project. This is an important step because the Ghidra module will be generated for this version of Ghidra:<div><img src="img/B16207_04_011.jpg" alt="Figure 4.11 – Associating a Ghidra installation with your module project&#13;&#10;"/></div><p class="figure-caption">Figure 4.11 – Associating a Ghidra installation with your module project</p></li>&#13;
				<li>You can also enable Python by clicking on <strong class="bold">Enable Python</strong> and selecting a Jython interpreter:<div><img src="img/B16207_04_012.jpg" alt="Figure 4.12 – Enabling Python support&#13;&#10;"/></div><p class="figure-caption">Figure 4.12 – Enabling Python support</p><p>You can <a id="_idIndexMarker151"/>configure the Ghidra installation and Python support at any time later by clicking on <strong class="bold">GhidraDev</strong> | <strong class="bold">Link Ghidra…</strong>:</p><p class="figure-caption"> </p><div><img src="img/B16207_04_013.jpg" alt="Figure 4.13 – Linking the Ghidra installation and enabling Python support if desired at any time&#13;&#10;"/></div><p class="figure-caption">Figure 4.13 – Linking the Ghidra installation and enabling Python support if desired at any time</p></li>&#13;
				<li>Develop your Ghidra extension using the Eclipse IDE:</li>&#13;
			</ol>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B16207_04_014.jpg" alt="Figure 4.14 – Developing Ghidra extensions using the Eclipse IDE&#13;&#10;"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="figure-caption">Figure 4.14 – Developing Ghidra extensions using the Eclipse IDE</p>&#13;
			<p>After developing <a id="_idIndexMarker152"/>your Ghidra extension, you can export it to Ghidra using the following steps:</p>&#13;
			<ol>&#13;
				<li value="1">Go to <strong class="bold">File</strong> | <strong class="bold">Export…</strong>, choose <strong class="bold">Ghidra Module Extension</strong>, and click on the <strong class="bold">Next &gt;</strong> button:<div><img src="img/B16207_04_015.jpg" alt="Figure 4.15 – Exporting a Ghidra module extension from Eclipse&#13;&#10;"/></div><p class="figure-caption">Figure 4.15 – Exporting a Ghidra module extension from Eclipse</p></li>&#13;
				<li>Choose <a id="_idIndexMarker153"/>the Ghidra module project you want to export:<div><img src="img/B16207_04_016.jpg" alt="Figure 4.16 – Selecting the Ghidra module project to export&#13;&#10;"/></div><p class="figure-caption">Figure 4.16 – Selecting the Ghidra module project to export</p></li>&#13;
				<li>Set the Gradle installation directory. If you followed the steps explained at the beginning of this chapter, it will be available in the <code>GRADLE_HOME</code> environment variable:</li>&#13;
			</ol>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B16207_04_017.jpg" alt="Figure 4.17 – Setting the Gradle installation directory&#13;&#10;"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="figure-caption">Figure 4.17 – Setting the Gradle installation directory</p>&#13;
			<p>After clicking on <code>dist</code> directory of your Ghidra module project has been generated:</p>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B16207_04_018.jpg" alt="Figure 4.18 – Console output after exporting a Ghidra extension project&#13;&#10;"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="figure-caption">Figure 4.18 – Console output after exporting a Ghidra extension project</p>&#13;
			<p>As explained before, the generated extension will only be valid for the version of Ghidra chosen during the module project creation.</p>&#13;
			<h1 id="_idParaDest-65"><a id="_idTextAnchor078"/>Summary</h1>&#13;
			<p>In this chapter, you learned how to install existing Ghidra extensions and how to drop new ones into Ghidra in order to later install it. We analyzed the code of an example plugin Ghidra extension and also the development templates of every kind of Ghidra extension.Finally, we followed the steps for creating a new Ghidra module project in the Eclipse IDE and also covered how to export our new project to Ghidra.</p>&#13;
			<p>Now, you are able to identify useful extensions and install them. You are also able to understand how the code works and perform modifications and adaptions when needed. Of course, you can also now write your own Ghidra extensions, but you will improve these skills in <em class="italic">Section 3</em>, <em class="italic">Extending Ghidra</em>.</p>&#13;
			<p>In the next chapter of this book, we will cover how to reverse engineer malware using Ghidra, which is a great opportunity to demonstrate how to use this knowledge to solve real-world challenges.</p>&#13;
			<h1 id="_idParaDest-66"><a id="_idTextAnchor079"/>Questions</h1>&#13;
			<ol>&#13;
				<li value="1">What is the difference between Ghidra extensions and Ghidra scripts?</li>&#13;
				<li>If you are analyzing a program developed in C++ (which is an object-oriented programming language), what kind of Ghidra extension can help you to identify classes, methods, and so on?</li>&#13;
				<li>As you know, Ghidra extensions have access to Ghidra internals, which is really powerful. Is it always better to write a Ghidra extension than to write a Ghidra script?</li>&#13;
			</ol>&#13;
			<h1 id="_idParaDest-67"><a id="_idTextAnchor080"/>Further reading</h1>&#13;
			<p>If you want to learn more about the topics covered in this chapter, go ahead and check out the following books and links:</p>&#13;
			<ul>&#13;
				<li>Ghidra advanced development course: <a href="http://ghidra.re/courses/GhidraClass/AdvancedDevelopment/GhidraAdvancedDevelopment_withNotes.html#GhidraAdvancedDevelopment.html">http://ghidra.re/courses/GhidraClass/AdvancedDevelopment/GhidraAdvancedDevelopment_withNotes.html#GhidraAdvancedDevelopment.html</a> </li>&#13;
				<li><em class="italic">Python development</em>, <em class="italic">Burkhard. A Meier</em>, <em class="italic">November 2016</em> [Video]: <a href="https://www.packtpub.com/eu/application-development/python-projects-video">https://www.packtpub.com/eu/application-development/python-projects-video</a></li>&#13;
				<li>PyDev official manual: <a href="http://www.pydev.org/manual.html">http://www.pydev.org/manual.html</a></li>&#13;
				<li><em class="italic">Java Projects – Second Edition</em>, <em class="italic">Peter Verhas</em>, <em class="italic">August 2018</em>: <a href="https://www.packtpub.com/eu/application-development/java-projects-second-edition">https://www.packtpub.com/eu/application-development/java-projects-second-edition</a></li>&#13;
			</ul>&#13;
		</div>&#13;
	</div></body></html>