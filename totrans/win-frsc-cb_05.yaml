- en: Windows Shadow Copies Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following recipes:'
  prefs: []
  type: TYPE_NORMAL
- en: Browsing and copying files from VSCs on a live system with ShadowCopyView
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mounting VSCs from disk images with VSSADMIN and MKLINK
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Processing and analyzing VSC data with Magnet AXIOM
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Shadow copies, also known as volume shadow copies, are backup copies of Windows
    files that are taken during the normal course of use of a machine running on NTFS.
    For the average computer user, shadow copies may be familiar, as they are what
    make it possible to create Windows backups, or to perform system restores when
    something goes wrong.
  prefs: []
  type: TYPE_NORMAL
- en: These have obvious applications for digital forensic practitioners, particularly
    in cases where a suspect may have tried to delete evidence from a machine. By
    restoring the system to its previous state, or by using forensic tools to uncover
    files that are saved in shadow copy locations, forensic practitioners may be able
    to deduce information that an individual has tried to hide.
  prefs: []
  type: TYPE_NORMAL
- en: However, the presence of shadow copies and the ability forensic investigators
    have to uncover the information contained within them does not necessarily mean
    that useful information will be obtained. Many files will simply contain information
    that is irrelevant to the case. Even when shadow copies of useful files are restored,
    the version the investigator can see is only a snapshot of the file. In other
    words, the forensic analyst will only be able to see a single version of a file,
    rather than any changes that may have been made. Shadow copies are frequently
    overwritten by the system, and it is possible in most versions of Windows to turn
    off the ability to create them, which means they are not a failsafe fallback option.
    Having said that, the ability to locate, restore, and comprehend the data contained
    within volume shadow copies is an important part of a digital forensic investigator's
    toolkit. In this chapter, we will demonstrate a few methods that will help you
    get to grips with shadow copies analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Browsing and copying files from VSCs on a live system with ShadowCopyView
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ShadowCopyView is a simple tool developed by **NirSoft** (remember this name!
    They have developed lots of small free tools which are extremely useful for computer
    forensics), which enables digital forensic examiners to browse snapshots created
    by the Windows Volume Shadow Copy Service. It supports even the most recent Windows
    versions (Windows 10, for example), and can be kept on your favorite USB drive,
    which is very important for live forensics and incident response.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Go to NirSoft''s website and click on the All Utilities link on the left. Scroll
    down the page, find the **ShadowCopyView** link, and click it. At the time of
    writing, the most recent version of the tool is 1.05\. Scroll down and you will
    find two download links: 32-bit and 64-bit versions. We recommend that you download
    both, and use them depending on the target system. Unpack the archives you downloaded
    to your flash drive, and you are ready to go.'
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Connect your flash drive to the target system. In our case, it''s Windows 7
    x64, so we will use the 64-bit version of ShadowCopyView. The tool detects available
    VSCs automatically. In our case we have three VSCs available, as you can see in
    the following figure:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/a7e0e87f-ab65-4031-9f52-3fef447ed5ac.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.1\. Volume Shadow Copies detected by ShadowCopyView
  prefs: []
  type: TYPE_NORMAL
- en: The main window of the tool consists of two panes. The first pane displays information
    about detected shadow copies, including name, Explorer path, Volume path, Created
    Time, and so on. The Explorer path means you can browse shadow copies in Windows
    Explorer.
  prefs: []
  type: TYPE_NORMAL
- en: 'Right-click on the VSC you want to browse in Explorer and choose Open In Windows
    Explorer, or just press F2\. Now it''s open in Windows Explorer, as you can see
    in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/9abb53d4-92eb-485d-9463-422e792ef41d.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.2\. A Volume Shadow Copy opened in Windows Explorer
  prefs: []
  type: TYPE_NORMAL
- en: Now, let's get back to ShadowCopyView. The second pane enables you to browse
    available shadow copies. Using this pane, you can export both files and folders.
  prefs: []
  type: TYPE_NORMAL
- en: All you need to do is to right-click a file or a folder, and select the Copy
    Selected Files To... option or just press F8.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: There are some other useful options you can use. For example, if you prefer
    timestamps in the UTC (Coordinated Universal Time) time standard, you can use
    the **GMT** (**Greenwich Mean Time**) time zone. To do this, go to the Options
    menu and select Show Time In GMT.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: UTC or Coordinated Universal Time is the primary standard by which the world
    regulates clocks and time. For example, most parts of European Russia use UTC
    +3 hours.
  prefs: []
  type: TYPE_NORMAL
- en: 'Also, if you want to see the whole properties list of a shadow copy, you can
    right-click it and choose the Properties option, or just press *Alt* + *Enter*.
    Now you see all the properties in one window, as in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/aa74b742-626e-4616-9c21-2488e3c8fb44.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.3\. A Volume Shadow Copy's properties
  prefs: []
  type: TYPE_NORMAL
- en: And the last very useful feature we want to tell you about is keyword searching.
  prefs: []
  type: TYPE_NORMAL
- en: 'Go to **Edit - Find**, or just press *Ctrl* + *F*, and you will see the Find
    window, as in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6a008b3a-640b-465f-ab4d-c613318459b4.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.4\. ShadowCopyView Find window
  prefs: []
  type: TYPE_NORMAL
- en: As you can see, you also have two options to tick. Tick the first one if hits
    must include the whole word only, tick the second if it is important that results
    are returned in uppercase or lowercase letters.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ShadowCopyView detects available Volume Shadow Copies, enabling a computer forensic
    examiner to browse them both via the tool and Windows Explorer, and also allows
    them to search for and export files and folders.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The NirSoft website: [http://www.nirsoft.net/](http://www.nirsoft.net/)'
  prefs: []
  type: TYPE_NORMAL
- en: 'The ShadowCopyView download page: [http://www.nirsoft.net/utils/shadow_copy_view.html](http://www.nirsoft.net/utils/shadow_copy_view.html)'
  prefs: []
  type: TYPE_NORMAL
- en: Mounting VSCs from disk images with VSSADMIN and MKLINK
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: VSSADMIN is a built-in Windows command-line tool capable of displaying Volume
    Shadow Copies. You can use it not only on a running Windows system, but also on
    disk images. In this recipe, we will show you how to do it.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'As the tool we are going to use is built-in, there is no need for installation:
    if you are using Windows, you already have it. So all you need is to mount a forensic
    image, and you already know how to do this from [Chapter 3](cdc042a6-a9ed-423a-96da-96e6d7767d8e.xhtml),
    *Windows Drive Acquisition*. As soon as the image is mounted, you are ready to
    go.'
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The steps to mount VSCs from disk images using VSSADMIN and MKLINK are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Start Windows Command Prompt (don''t forget to run it as Administrator). In
    our case, the boot partition is mounted as `G:\ drive`, so we use the following
    command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](img/6e8b801e-fcfc-4f17-a575-27608839f43d.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.5\. vssadmin list shadows /for=G:\ command output
  prefs: []
  type: TYPE_NORMAL
- en: As you can see in the preceding figure, our forensic image contains a shadow
    copy.
  prefs: []
  type: TYPE_NORMAL
- en: 'The most important part of its properties for us is **Shadow Copy Volume**,
    in our case it''s `\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy7`. Now we are
    ready to use MKLINK to mount the shadow copy we found. Use the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![](img/5a241b81-44d5-48b5-8cad-08237163afe3.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.6\. mklink /D C:\VSC \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy7
    command output
  prefs: []
  type: TYPE_NORMAL
- en: MKLINK creates a folder (you should choose its name and location, and type it
    in as part of the command) and mounts the shadow copy to it, so you can browse
    it like a normal folder. Don't forget the **/D** switch — we need it to create
    a directory symbolic link, not a file.
  prefs: []
  type: TYPE_NORMAL
- en: There is another way to use Windows Explorer for VSC browsing. We need to get
    a VSC path in the following format `\\localhost\G$\@GMT-2016.12.28-20.00.30`
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The first part of the path, `\\localhost\`, will be always the same. The next
    part depends on the drive letter of the boot partition. As you will remember,
    in our case it''s `G:\`, so in the path it is `G$`. For example, if you have `H:\`,
    it''s `H$`, and so on. The last part is based on the VSC''s creation time. You
    can get it from the VSSADMIN output, but it must be converted into GMT. Now just
    type it as a path in Windows Explorer, and the shadow copy will be available for
    examination, as in the following figure:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/2ee34c69-6be4-4c12-9a5e-81be1d03a659.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.7\. A Volume Shadow Copy opened in Windows Explorer
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: VSSADMIN displays available Volume Shadow Copies on a mounted forensic image.
    MKLINK creates a symbolic link to the shadow copy, so a digital forensic examiner
    can browse it in Windows Explorer.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The VSSADMIN page at Misrosoft TechNet: [https://technet.microsoft.com/en-us/library/cc754968(v=ws.11).aspx](https://technet.microsoft.com/en-us/library/cc754968(v=ws.11).aspx)'
  prefs: []
  type: TYPE_NORMAL
- en: 'The MKLINK page at Microsoft TechNet: [https://technet.microsoft.com/en-us/library/cc753194(v=ws.11).aspx](https://technet.microsoft.com/en-us/library/cc753194(v=ws.11).aspx)'
  prefs: []
  type: TYPE_NORMAL
- en: Processing and analyzing VSC data with Magnet AXIOM
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Magnet AXIOM is an all-in-one digital forensics tool by Magnet Forensics, capable
    of extracting (acquiring) and processing data from both computers and mobile devices.
    It supports lots of Windows forensic artifacts, including extracting data from
    Windows Volume Shadow Copies.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'At the time of writing, Magnet Forensics provides a fully functional 30-day
    free trial version of Magnet AXIOM. All you need to do is go to Magnet Forensics''
    website and click on the TRY NOW button. Fill in the form, including your first
    name, last name, email address, phone number, state or province, country, and
    so on and click on REQUEST A FREE TRIAL. Make sure you type your real email: your
    trial key and download link will be sent to this address. Once you get it, download
    the installer and follow its instructions. You are ready to go!'
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The steps to process and analyze data using Magnet AXIOM are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Start the Magnet AXIOM Process.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The first window you will see is CASE DETAILS, as you can see in the following
    figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5fc26f32-6c1e-4278-8491-dac07e3c3345.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.8\. Magnet AXIOM CASE DETAILS window
  prefs: []
  type: TYPE_NORMAL
- en: 'Here, we have four main parts:'
  prefs: []
  type: TYPE_NORMAL
- en: LOCATION FOR CASE FILES - Here, you should choose the Folder name and File path
    being created during processing.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: LOCATION FOR ACQUIRED EVIDENCE - If you plan to acquire drives or mobile devices
    via AXIOM, choose the Folder name and File path for them, or just choose the same
    path as for case files.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CASE INFORMATION - Type in your case number, your name, and the case description.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: REPORT OPTIONS - If you have your own logo or company logo, you can choose it
    by clicking BROWSE. Make sure the image is square, because it will be resized
    to 150x150 pixels.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Once you have filled in all the fields, you can click GO TO EVIDENCE SOURCES.
    You can see the EVIDENCE SOURCES window shown in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/94548459-44b7-4e29-b453-fe10ab7e0fc7.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.9\. Magnet AXIOM EVIDENCE SOURCES window
  prefs: []
  type: TYPE_NORMAL
- en: 'Here, we have two options: ACQUIRE EVIDENCE and LOAD EVIDENCE.'
  prefs: []
  type: TYPE_NORMAL
- en: We are going to use an image we acquired previously, so our choice is the LOAD
    EVIDENCE button. You can use one of the images you acquired in the previous recipes.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The next window is LOAD EVIDENCE, as you can see in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/753e8d29-3fb2-4d2c-bc6c-a3677f281ff1.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.10\. Magnet AXIOM LOAD EVIDENCE window
  prefs: []
  type: TYPE_NORMAL
- en: 'Here, we have a VOLUME SHADOW COPY option - click it. Now we have two more
    options: DRIVE and IMAGE.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'As we noted earlier, we are going to use an image. Once you choose it, you
    can see the list of shadow copies available on the image, as in the following
    figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/31533d54-2a8c-46c1-855f-e414832d1465.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.11\. Volume Shadow Copies list
  prefs: []
  type: TYPE_NORMAL
- en: You can choose one or more shadow copies and go to processing details by clicking
    NEXT. This time, we will skip this step and go straight to artifacts details (click
    the GO TO ARTIFACTS DETAILS button).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'As we are working with a shadow copy, the MOBILE ARTIFACTS option is inactive,
    but we can use the COMPUTER ARTIFACTS option. As in Belkasoft Evidence Center,
    here we have a wide range of artifacts, as you can see in the following figure:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/937de1a6-0c90-438e-8f89-602626b1e0f5.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.12\. Magnet AXIOM SELECT ARTIFACTS TO INCLUDE IN CASE window
  prefs: []
  type: TYPE_NORMAL
- en: For testing purposes, we have included all available artifacts in the case.
    Click the GO TO ANALYZE EVIDENCE button, and the ANALYZE EVIDENCE button right
    after that. This will start Magnet AXIOM Examine.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once processing is finished, you will see the results in Magnet AXIOM Examine.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Magnet AXIOM scans a drive or an image for available Volume Shadow Copies and
    uses them as its evidence source. After it has processed all available data in
    the chosen shadow copies, it extracts forensic artifacts according to the choices
    made by the examiner.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The Magnet Forensics website: [https://www.magnetforensics.com/](https://www.magnetforensics.com/)'
  prefs: []
  type: TYPE_NORMAL
- en: 'The Magnet AXIOM free 30-day trial request page: [https://www.magnetforensics.com/try-magnet-axiom-free-30-days/](https://www.magnetforensics.com/try-magnet-axiom-free-30-days/)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Belkasoft Evidence Center: [https://belkasoft.com/ec](https://belkasoft.com/ec)'
  prefs: []
  type: TYPE_NORMAL
