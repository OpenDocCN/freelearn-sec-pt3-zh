["```\n     $ cd /etc/openvpn/cookbook\n     $ . ./vars\n     $ export KEY_CN=\n     $ export KEY_OU=\n     $ export KEY_NAME=\n     $ export OPENSSL_CONF=/etc/openvpn/cookbook/openssl-\n               1.0.0.cnf\n\n    ```", "```\n     $ openssl req -nodes -newkey rsa:2048 -new -out client.req \\\n     -subj \"/C=NL/O=Cookbook/CN=MyClient\"\n     Generating a 2048 bit RSA private key\n     .......................................++++++\n     ............++++++\n     writing new private key to 'privkey.pem'\n     -----\n\n    ```", "```\n     $ openssl ca -in client.req -out client.crt\n     Using configuration from /etc/openvpn/cookbook/openssl.cnf\n     Enter pass phrase for /etc/openvpn/cookbook/keys/ca.key:\n     [enter CA key password]\n     Check that the request matches the signature\n     Signature ok\n     The Subject's Distinguished Name is as follows\n     countryName           :PRINTABLE:'NL'\n     organizationName      :PRINTABLE:'Cookbook'\n     commonName            :PRINTABLE:'MyClient'\n     Certificate is to be certified until Apr 20 15:08:25 2026 GMT \n            (3650 days)\n     Sign the certificate? [y/n]:y\n     1 out of 1 certificate requests certified, commit? [y/n]y\n     Write out database with 1 new entries\n     Data Base Updated\n\n    ```", "```\n$ openssl req -newkey rsa:1024 -new -out client.req \\\n -subj \"/C=NL/O=Cookbook/CN=MyClient\"\n\n```", "```\nEnter PEM pass phrase:\nVerifying - Enter PEM pass phrase:\n\n```", "```\n    $ cd /etc/openvpn/cookbook/keys\n    $ openssl x509 -subject -enddate -noout -in client1.crt\n     subject= /C=US/O=Cookbook 2.4/CN=client1\n    notAfter=Oct 13 17:54:30 2018 GMT\n\n    ```", "```\n    $ openssl pkcs12 -export -in client1.crt \\\n     -inkey client1.key -out client1.p12\n     Enter Export Password:[Choose a strong password]\n     Verifying - Enter Export Password:[Type the password again]\n    $ chmod 600 client1.p12\n\n    ```", "```\n    $ openssl verify -purpose sslclient -CAfile ca.crt client1.crt\n     client1.crt: OK\n\n    ```", "```\n    $ openssl verify -purpose sslclient -CAfile ca.crt server.crt\n     server.crt: C = US, O = Cookbook 2.4, CN = openvpnserver\n     error 26 at 0 depth lookup:unsupported certificate purpose\n     OK\n\n    ```", "```\n    $ openssl rsa -in client2.key -aes256 -out newclient.key\n     Enter pass phrase for client2.key:[old password]\n     writing RSA key\n     Enter PEM pass phrase:[new password]\n     Verifying - Enter PEM pass phrase:[new password]\n\n    ```", "```\n    $ cd /etc/openvpn/cookbook\n    $ . ./vars\n    $ ./build-key client4\n    [...]\n\n    ```", "```\n    $ ./revoke-full client4\n    Using configuration from /etc/openvpn/cookbook/openssl-\n            1.0.0.cnf\n    Enter pass phrase for /etc/openvpn/cookbook/keys/ca.key:\n    Revoking Certificate 06.\n    Data Base Updated\n    Using configuration from /etc/openvpn/cookbook/openssl-\n            1.0.0.cnf\n    Enter pass phrase for /etc/openvpn/cookbook/keys/ca.key:\n    client4.crt: C = US, O = Cookbook 2.4, CN = client4\n    error 23 at 0 depth lookup:certificate revoked\n\n    ```", "```\n    $ openssl crl -text -noout -in keys/crl.pem\n    Certificate Revocation List (CRL):\n     Version 1 (0x0)\n     Signature Algorithm: sha256WithRSAEncryption\n     Issuer: /C=US/O=Cookbook 2.4/CN=Cookbook 2.4\n                    CA/emailAddress=openvpn@example.com\n     Last Update: Apr 22 15:54:10 2016 GMT\n     Next Update: May 22 15:54:10 2016 GMT\n    Revoked Certificates:\n     Serial Number: 06\n     Revocation Date: Apr 22 15:54:08 2016 GMT\n     Signature Algorithm: sha256WithRSAEncryption\n     12:8a:f0:b4:3e:aa:5b:a1:13:64:41:c7:0b:46:ef:00:99:50:\n     6b:72:b8:2e:ff:93:eb:9b:7e:63:9e:8d:78:63:e8:96:44:30:\n     5b:eb:3d:4a:a4:2a:36:1e:8c:c6:cd:11:63:b1:d5:88:31:46:\n\n    ```", "```\n    [root@server]# cd /etc/openvpn/cookbook\n    [root@server]# cp keys/crl.pem .\n\n    ```", "```\n            crl-verify /etc/openvpn/cookbook/crl.pem \n\n    ```", "```\n    [root@server]# openvpn --config example4-6-server.conf\n\n    ```", "```\n    client\n    proto udp\n            remote openvpnserver.example.com\n            port 1194\n            dev tun\n            nobind\n            remote-cert-tls server\n            tls-auth /etc/openvpn/cookbook/ta.key 1\n            ca       /etc/openvpn/cookbook/ca.crt\n            cert     /etc/openvpn/cookbook/client4.crt\n            key      /etc/openvpn/cookbook/client4.key\n\n    ```", "```\n    [root@client]# openvpn --config example4-6-client.conf\n\n    ```", "```\n[...] TLS_ERROR: BIO read tls_read_plaintext error: error:140890B2:SSL\n routines:SSL3_GET_CLIENT_CERTIFICATE:no certificate returned\n[...] TLS Error: TLS object -> incoming plaintext read error\n[...] TLS Error: TLS handshake failed\n\n```", "```\n    $ cd /etc/openvpn/cookbook\n    $ . ./vars\n    $ export KEY_NAME=\n    $ export OPENSSL_CONF=/etc/openvpn/cookbook/openssl-1.0.0.cnf\n\n    ```", "```\n            $ cd keys\n            $ openssl x509 -serial -noout -in server.crt\n            serial=01\n            $ openssl ca -status 01\n            Using configuration from /etc/openvpn/cookbook/openssl-\n            1.0.0.cnf\n            01=Valid (V)\n\n    ```", "```\n            $ openssl x509 -serial -noout -in client4.crt \n            serial=06\n            $ openssl ca -status 06\n            Using configuration from /etc/openvpn/cookbook/openssl-     \n            1.0.0.cnf\n            08=Revoked (R)\n\n    ```", "```\n    V 181013174924Z            01  unknown  .../CN=openvpnserver\n    R 190117155337Z 160422155408Z  06  unknown  .../CN=client4\n\n    ```", "```\n    E  190117155337Z                 08 unknown .../CN=client4\n\n    ```", "```\n    $ openssl ca -status 06\n    Using configuration from /etc/openvpn/cookbook/openssl-\n            1.0.0.cnf\n    08=Expired (E)\n\n    ```", "```\n              $ openssl ca -gencrl -out crl.pem\n              $ openssl crl -text -noout -in crl.pem  | head -8\n            Certificate Revocation List (CRL):\n                    Version 1 (0x0)\n                Signature Algorithm: sha256WithRSAEncryption\n                    Issuer: /C=US/O=Cookbook 2.4/CN=Cookbook 2.4     \n                    CA/emailAddress=openvpn@example.com\n                    Last Update: Apr 26 15:02:01 2016 GMT\n                    Next Update: May 26 15:02:01 2016 GMT\n            No Revoked Certificates.\n                Signature Algorithm: sha256WithRSAEncryption\n\n    ```", "```\n    $ cd /etc/openvpn/cookbook/\n            $ . ./vars\n            $ ./build-inter IntermediateCA\n\n    ```", "```\n            $ openssl x509 -text -noout -in keys/IntermediateCA.crt \\\n              | grep -C 1 CA\n                        X509v3 Basic Constraints:\n                            CA:TRUE\n                Signature Algorithm: sha1WithRSAEncryption\n\n    ```", "```\n            $ mkdir -m 700 -p IntermediateCA/keys\n            $ cp [a-z]* IntermediateCA\n            $ cd IntermediateCA\n\n    ```", "```\n            export EASY_RSA=/etc/openvpn/cookbook/IntermediateCA \n\n    ```", "```\n            $ . ./vars\n            $ ./clean-all\n            $ cp ../keys/IntermediateCA.crt keys/ca.crt\n            $ cp ../keys/IntermediateCA.key keys/ca.key\n\n    ```", "```\n            $ ./build-key IntermediateClient\n\n    ```", "```\n            $ openssl x509 -subject -issuer -noout -in  \n            keys/IntermediateClient.crt\n     subject= /C=US/O=Cookbook 2.4/CN=IntermediateClient\n               issuer= /C=US/O=Cookbook 2.4/CN=subCA/emailAddress=...\n\n    ```", "```\n            $ cd /etc/openvpn/cookbook\n            $ cat keys/ca.crt IntermediateCA/keys/ca.crt > ca+subca.pem\n            $ cp IntermediateCA/keys/IntermediateClient.{crt,key} .\n            $ openssl verify -CAfile ca+subca.pem IntermediateClient.crt\n            IntermediateClient.crt: OK\n\n    ```", "```\n            tls-server \n            proto udp \n            port 1194 \n            dev tun \n\n            server 192.168.200.0 255.255.255.0 \n\n            ca       /etc/openvpn/cookbook/ca+subca.pem \n            cert     /etc/openvpn/cookbook/server.crt \n            key      /etc/openvpn/cookbook/server.key \n            dh       /etc/openvpn/cookbook/dh1024.pem \n            tls-auth /etc/openvpn/cookbook/ta.key 0 \n\n            persist-key \n            persist-tun \n            keepalive 10 60 \n\n            user  nobody \n            group nobody \n\n            daemon \n            log-append /var/log/openvpn.log \n\n    ```", "```\n            [root@server]# openvpn --config example4-9-server.conf\n\n    ```", "```\n            client \n            proto udp \n            remote openvpnserver.example.com \n            port 1194 \n\n            dev tun \n            nobind \n\n            tls-auth /etc/openvpn/cookbook/ta.key 1 \n            ca       /etc/openvpn/cookbook/ca.crt \n            cert     /etc/openvpn/cookbook/IntermediateClient.crt \n            key      /etc/openvpn/cookbook/IntermediateClient.key \n\n    ```", "```\n            [root@client]# openvpn --config example4-9-client.conf\n\n    ```", "```\n            ... openvpnclient:49283 [IntermediateClient] Peer Connection  \n            Initiated with openvpnclient:49283 \n\n    ```", "```\nopenvpnclient:49286 VERIFY ERROR: depth=0, error=unable to get local issuer certificate: C=US, O=Cookbook 2.4, CN=IntermediateClient \n\n```", "```\ncapath /etc/openvpn/cookbook/ca-dir \n\n```", "```\n$ cd /etc/openvpn/cookbook\n$ mkdir ca-dir\n$ openssl x509 -hash -noout -in keys/ca.crt\nbcd54da9\n\n```", "```\n$ cp keys/ca.crt  ca-dir/bcd54da9.0\n$ cp keys/crl.pem ca-dir/bcd54da9.r0\n\n```", "```\n$ openssl x509 -hash -noout -in IntermediateCA/keys/ca.crt\n1f5e4734\n$ cp IntermediateCA/keys/ca.crt  ca-dir/1f5e4734.0\n$ cp IntermediateCA/keys/crl.pem ca-dir/1f5e4734.r0 \n\n```", "```\n            [root@server]# openvpn --config  basic-udp-server.conf\n\n    ```", "```\n            OpenVPN 2.3.10 x86_64-redhat-linux-gnu [SSL (OpenSSL)] [LZO]         [EPOLL] [PKCS11] [MH] [IPv6] built on Jan  4 2016 \n\n            library versions: OpenSSL 1.0.1e-fips 11 Feb 2013, LZO 2.08 \n\n    ```", "```\n            [root@server]# export LD_LIBRARY_PATH=..../openssl-1.0.1s\n            [root@server]# openvpn --config  basic-udp-server.conf\n\n    ```", "```\n            OpenVPN 2.3.10 x86_64-redhat-linux-gnu [SSL (OpenSSL)] [LZO]          [EPOLL] [PKCS11] [MH] [IPv6] built on Jan  4 2016 \n\n            library versions: OpenSSL 1.0.1s  1 Mar 2016, LZO 2.08 \n\n    ```", "```\n            [root@server]# .../openvpn-2.3.10polarssl/openvpn --config  \n            basic-udp-server.conf\n\n    ```", "```\n            OpenVPN 2.3.10 x86_64-unknown-linux-gnu [SSL (PolarSSL)] [LZO]          [EPOLL] [MH] [IPv6] built on Apr 27 2016 \n\n            library versions: PolarSSL 1.3.16, LZO 2.08 \n\n    ```", "```\n            [root@server]# openvpn --show-ciphers\n\n    ```", "```\n            BF-CBC 128 bit default key (variable) \n            BF-CFB 128 bit default key (variable) (TLS client/server...)  \n            BF-OFB 128 bit default key (variable) (TLS client/server...)  \n            AES-128-CBC 128 bit default key (fixed) \n            AES-128-OFB 128 bit default key (fixed) (TLS client...)  \n            AES-128-CFB 128 bit default key (fixed) (TLS client...) \n            AES-256-CBC 256 bit default key (fixed) \n            AES-256-OFB 256 bit default key (fixed) (TLS client...) \n            AES-256-CFB 256 bit default key (fixed) (TLS client...) \n            AES-128-CFB1 128 bit default key (fixed) (TLS client...) \n            AES-192-CFB1 192 bit default key (fixed) (TLS client...) \n            AES-256-CFB1 256 bit default key (fixed) (TLS client...) \n            AES-128-CFB8 128 bit default key (fixed) (TLS client...) \n            AES-192-CFB8 192 bit default key (fixed) (TLS client...) \n            AES-256-CFB8 256 bit default key (fixed) (TLS client...) \n\n    ```", "```\n            [root@server]# .../openvpn-2.3.10polarssl/openvpn --show-\n            ciphers\n\n    ```", "```\n            AES-128-CBC 128 bit default key \n            AES-192-CBC 192 bit default key \n            AES-256-CBC 256 bit default key \n            BF-CBC 128 bit default key \n            CAMELLIA-128-CBC 128 bit default key \n            CAMELLIA-192-CBC 192 bit default key \n            CAMELLIA-256-CBC 256 bit default key \n            DES-CBC 64 bit default key \n            DES-EDE-CBC 128 bit default key \n            DES-EDE3-CBC 192 bit default key \n\n    ```", "```\n            [root@server]# openvpn --show-digests\n\n    ```", "```\n            MD5 128 bit digest size \n            SHA 160 bit digest size \n            RIPEMD160 160 bit digest size \n            ecdsa-with-SHA1 160 bit digest size \n            SHA224 224 bit digest size \n            SHA256 256 bit digest size \n            SHA384 384 bit digest size \n            SHA512 512 bit digest size \n\n    ```", "```\n            [root@server]# .../openvpn-2.3.10polarssl/openvpn --show-\n            digests\n\n    ```", "```\n            SHA512 512 bit default key \n            SHA384 384 bit default key \n            SHA256 256 bit default key \n            SHA224 224 bit default key \n            SHA1 160 bit default key \n            RIPEMD160 160 bit default key \n            MD5 128 bit default key \n\n    ```", "```\nopenvpn --show-tls\n\n```", "```\n            cipher aes-256-gcm \n            push \"cipher aes-256-gcm\" \n\n    ```", "```\n     [root@server]# openvpn --config example4-10-server.conf\n\n    ```", "```\n     [root@client]# openvpn --config basic-udp-client.conf --\n                verb 4\n            Data Channel Encrypt: Cipher 'BF-CBC' initialized with 128 bit \n            key\n            Data Channel Encrypt: Using 160 bit message hash 'SHA1' for \n            HMAC authentication\n            Data Channel Decrypt: Cipher 'BF-CBC' initialized with 128 bit \n            key\n            Data Channel Decrypt: Using 160 bit message hash 'SHA1' for \n            HMAC authentication\n            Control Channel: TLSv1.2, cipher TLSv1/SSLv3 ECDHE-RSA-AES256-\n            GCM-SHA384, 2048 bit RSA\n            [...]\n            OPTIONS IMPORT: data channel crypto options modified\n            [...]\n            Data Channel Encrypt: Cipher '**AES-256-GCM**' initialized with 256 \n            bit key\n            Data Channel Decrypt: Cipher '**AES-256-GCM**' initialized with 256 \n            bit key\n\n    ```", "```\n     [client]$   ping -c 4  10.200.0.1\n    PING 10.200.0.1 (10.200.0.1) 56(84) bytes of data.\n            64 bytes from 10.200.0.1: icmp_seq=1 ttl=64 time=9.23 ms\n            64 bytes from 10.200.0.1: icmp_seq=2 ttl=64 time=8.78 ms\n            64 bytes from 10.200.0.1: icmp_seq=3 ttl=64 time=10.0 ms\n            64 bytes from 10.200.0.1: icmp_seq=4 ttl=64 time=9.00 ms\n            --- 10.200.0.1 ping statistics ---\n            4 packets transmitted, 4 received, 0% packet loss, time 3004ms\n            rtt min/avg/max/mdev = 8.780/9.259/10.022/0.468 ms\n\n    ```", "```\nccp-ciphers \npush \"auth SHA512\" \n\n```", "```\n     $ export KEY_CN=\n     $ export KEY_OU=\n     $ export KEY_NAME=\n     $ export OPENSSL_CONF=/etc/openvpn/cookbook/openssl-\n            1.0.0.cnf\n     $ openssl ecparam -out cakey_temp.pem \\\n     -name sect571k1 -text -genkey\n     $ openssl ec -in cakey_temp.pem -out ec-ca.key -aes256\n     $ openssl req -new -x509 -out ec-ca.crt -key ec-ca.key\n     -days 3650 -sha512 -extensions v3_ca\n     -subj \"/C=US/O=Cookbook 2.4/CN=Elliptic Curve CA\"\n\n    ```", "```\n     $ openssl req -nodes -sha512 -newkey ec:ec-ca.crt\n     -new -days 400 -out ec-server.req \n     -keyout ec-server.key\n     -subj \"/C=US/O=Cookbook 2.4/CN=ecserver\"\n     $ chmod 600 ec-server.key\n     $ openssl x509 -req \n     -extfile $OPENSSL_CONF \n     -extensions server\n     -out ec-server.crt -sha512 -CA ec-ca.crt \n     -CAkey ec-ca.key  -in ec-server.req \n     -set_serial $RANDOM\n\n    ```", "```\n     $ openssl req -nodes -sha512 \n     -newkey ec:ec-ca.crt\n     -new -days 400 \n     -out ec-client.req -keyout ec-client.key\n     -subj \"/C=US/O=Cookbook 2.4/CN=ecclient\"\n     $ chmod 600 ec-client.key\n     $ openssl x509 -req -extfile $OPENSSL_CONF \n     -extensions usr_cert\n     -out ec-client.crt -sha512 -CA ec-ca.crt \n     -CAkey ec-ca.key -in ec-client.req \n     -set_serial $RANDOM\n\n    ```", "```\n            proto udp \n            port 1194 \n            dev tun \n            server 10.200.0.0 255.255.255.0 \n\n            ca   /etc/openvpn/cookbook/ec-ca.crt \n            cert /etc/openvpn/cookbook/ec-server.crt \n            key  /etc/openvpn/cookbook/ec-server.key \n            dh   /etc/openvpn/cookbook/dh2048.pem \n\n    ```", "```\n     [root@server]# openvpn --config example4-11-server.conf\n\n    ```", "```\n            client \n            proto udp \n            remote openvpnserver.example.com \n            port 1194 \n            dev tun \n            nobind \n\n            ca /etc/openvpn/cookbook/ec-ca.crt \n            cert /etc/openvpn/cookbook/ec-client.crt \n            key /etc/openvpn/cookbook/ec-client.key \n            verb 4  \n\n    ```", "```\n     [root@client]# openvpn --config example4-11-client.conf\n\n    ```", "```\n            Control Channel: TLSv1.2, cipher TLSv1/SSLv3 ECDHE-ECDSA-\n            AES256-GCM-SHA384 \n\n    ```", "```\nControl Channel: TLSv1.2, cipher TLSv1/SSLv3 ECDHE-RSA-AES256-GCM-SHA384, 2048 bit RSA \n\n```", "```\n[root@server]# openvpn --show-curves\nAvailable Elliptic curves:\n[...]\nsecp112r1\nsecp112r2\nsecp521r1\nprime192v1\nprime192v2\n[...]\n\n```", "```\necdh-curve secp521r1\n\n```"]