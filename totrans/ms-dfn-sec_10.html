<html><head></head><body>
		<div><h1 id="_idParaDest-187"><em class="italic"><a id="_idTextAnchor193"/>Chapter 8</em>: Enhancing Your Network Defensive Skills</h1>
			<p><em class="italic">"The digital economy and the knowledge society is supported by immense masses of data that navigate in cyberspace, enabling the interaction between systems, humans and companies. Thus, the future of connected humanity depends on the investment, robustness and cybersecurity of telecommunications networks."</em></p>
			<p><em class="italic">– Luis Adrian Salazar, Former Minister of Science Technology and Telecommunication of Costa Rica</em></p>
			<p>The foundation of a network security strategy should be based on knowledge of the data that is passing through this network.</p>
			<p>You will be amazed by the huge amount of overhead that is passing through your network.</p>
			<p>But most importantly, you will be surprised with the amount of network traffic that flows through your network even when you are not using it. Programs requesting updates, programs sending encoded data to their servers (something that we agree to when we install social media apps such as TikTok and Facebook), and many other things are the cause of this constant flow of data.</p>
			<p>Now let's take a look at all the juicy content that is waiting for you in this chapter:</p>
			<ul>
				<li>Understanding the <em class="italic">phases of a cyber attack.</em></li>
				<li>A deep dive on one of the best tools for your defensive security arsenal: <strong class="bold">Nmap</strong>.</li>
				<li>A collection of guided examples to get hands-on experience on <strong class="bold">Nmap</strong>.</li>
				<li>A walk through the <em class="italic">biggest security flaws and vulnerabilities on wireless networks.</em></li>
				<li>We will create the best-in-class <em class="italic">safety guide for wireless users</em>.</li>
				<li>We will also review another great tool for network analysis: <em class="italic">the mighty Wireshark.</em></li>
				<li>We will look at some vulnerable protocols, plus some <em class="italic">guided demos to show how easy it would be for an attacker to capture sensitive data</em> if those protocols were in use.</li>
				<li>You will also learn the basics about <strong class="bold">IPS</strong> and <strong class="bold">IDS</strong>, and their similarities and differences, and have a quick look at the best free IPS and IDS available to you.</li>
				<li>Plus, this chapter has a <strong class="bold">bonus</strong> – yes, a bonus! – in which you will learn how to <em class="italic">play old-school games, visit an ancient virtual museum, and even watch an ASCII movie for free using Telnet.</em></li>
			</ul>
			<h1 id="_idParaDest-188"><a id="_idTextAnchor194"/>Technical requirements</h1>
			<p>To make the best of this chapter, you need to install Kali Linux. This way, you can play around with the tools that we will overview.</p>
			<p>Kali Linux is very light so you can install it on pretty much any old computer with internet access.</p>
			<p>Another option is to use a virtual machine, but in that case, you may need to tweak some settings (especially network settings) to ensure that all tools will behave as expected.</p>
			<p>All images, including pre-built virtual images for virtual machines, can be found here: <a href="https://www.kali.org/downloads/">https://www.kali.org/downloads/</a>.</p>
			<h1 id="_idParaDest-189"><a id="_idTextAnchor195"/>Using the master tool of network mapping – Nmap</h1>
			<p>First, let's start by understanding the importance of <em class="italic">network mapping tools</em>. </p>
			<p>Cyber attacks<a id="_idIndexMarker859"/> are normally composed of five phases in which network mapping is the core of the second phase, known <a id="_idIndexMarker860"/>as <strong class="bold">scanning</strong>. To better understand this, let's take a quick look at those five phases of a cyber attack.</p>
			<h2 id="_idParaDest-190"><a id="_idTextAnchor196"/>Phases of a cyber attack</h2>
			<p>These phases were not <a id="_idIndexMarker861"/>created as a set of best practices that attackers need to follow; instead, they were designed by cybersecurity professionals to categorize the most common steps that an attacker will be most likely to follow when performing a cyber attack.</p>
			<p>Let me explain those stages by telling the story of an attacker that wants to gather some data from a fictional company<a id="_idIndexMarker862"/> called <strong class="bold">Bravix</strong>.</p>
			<h3>Phase 1 – Reconnaissance</h3>
			<p>First, the attacker needs to acquire <a id="_idIndexMarker863"/>some basic information about Bravix, such as web page name, type of security, basic structure, web services in use, and so on. Additionally, the attacker may also want to get other public information about the company, such as its location and any information about their employees that can be used later in targeted social engineering attacks.</p>
			<p>Normally, all the data is collected manually using public sources such as a simple Google search.</p>
			<h3>Phase 2 – Scanning</h3>
			<p>Now that the <a id="_idIndexMarker864"/>attacker knows the web pages associated with Bravix (<code>bravix.com</code>, <code>store.bravix.com</code>, and <code>mail.bravix.com</code>), it is time to <em class="italic">scan them</em> to collect more technical information that will be used during the attack:</p>
			<ul>
				<li>OS versions.</li>
				<li>IP addresses.</li>
				<li>Web services used.</li>
				<li>Opened ports.</li>
				<li>The version of the <strong class="bold">Content Management System</strong> (<strong class="bold">CMS</strong>). Most web pages now use a CMS as a platform to run their web pages.</li>
			</ul>
			<p>As mentioned, this stage is more technical than the previous one and the attacker will leverage tools such as vulnerability scanners and network scanners to gather this data (<em class="italic">we will see how soon</em>).</p>
			<h3>Phase 3 – Gaining access</h3>
			<p>With all that <a id="_idIndexMarker865"/>information, the attacker can determine the vulnerabilities on the victim's web pages (or web resources) and exploit them to gain access to the data.</p>
			<h3>Phase 4 – Maintaining access</h3>
			<p>This is an optional phase that<a id="_idIndexMarker866"/> is executed in more elaborate attacks in which the attacker wants to harvest more data from the victim; however, in this example, the attacker may just grab the information needed from Bravix's web servers and run.</p>
			<h3>Phase 5 – Covering or deleting their tracks</h3>
			<p>Of course, this<a id="_idIndexMarker867"/> intrusion was illegal, therefore to<a id="_idIndexMarker868"/> avoid jail, the attacker will try to delete any track of this exfiltration of data by deleting any logs that may serve as evidence of this crime. </p>
			<p>The following figure shows the five stages of a cyber attack; however, it is very important to highlight that these phases are not always sequential, and in fact many times they overlap. For example, an attacker may start covering their tracks from the first phase by using a VPN to avoid detection:</p>
			<div><div><img src="img/Figure_8.1_B16290.jpg" alt="Figure 8.1 – Phases of a cyber attack&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.1 – Phases of a cyber attack</p>
			<p>OK; based on what we just learned, we can determine the importance of the <em class="italic">scanning phase</em> because the more information the attacker gathers here, the higher the risk of the attack.</p>
			<p>Therefore, let's understand how we can leverage the same tools that attackers will use against us to proactively protect our systems from attack.</p>
			<h2 id="_idParaDest-191"><a id="_idTextAnchor197"/>Nmap</h2>
			<p>Nmap <a id="_idIndexMarker869"/>is <em class="italic">must-have</em> tool for <em class="italic">network discovery</em> and <em class="italic">security auditing</em> that allows us to do the following:</p>
			<ul>
				<li>Perform an<a id="_idIndexMarker870"/> inventory of our network.</li>
				<li>Gather uptime data for services or hosts.</li>
				<li>Determine the hosts on a given network.</li>
				<li>Determine the services offered (or enabled) by those hosts.</li>
				<li>Determine the OS version of said host machines.</li>
				<li>Determine any packet filters or firewalls in use.</li>
			</ul>
			<p>Basically, Nmap leverages IP packets to gather all of this data and presents it very cleanly using a command-line interface or even a GUI called Zenmap.</p>
			<p>Nmap is <a id="_idIndexMarker871"/>available for most OSes, including Windows, Linux, and macOS, and can be downloaded for free from <a href="https://nmap.org/">https://nmap.org/</a>.</p>
			<p class="callout-heading">Warning</p>
			<p class="callout">Scanning someone's system or network without written authorization from the owner is <em class="italic">illegal</em> in many countries, so before moving any further, make sure you only do these scans on systems for which you are authorized.</p>
			<p>The good news is <a id="_idIndexMarker872"/>that if you want to test your knowledge or simply practice with Nmap, you can use a system that the people behind Nmap have generously created for educational purposes. The page is <a href="http://scanme.nmap.org/">http://scanme.nmap.org/</a>. </p>
			<p>Now, let's see how this works by executing the<a id="_idIndexMarker873"/> basic <code>nmap</code> command on that test server:</p>
			<pre>nmap scanme.nmap.org</pre>
			<p>As shown in <em class="italic">Figure 8.2</em>, the basic command provides very valuable information about the server.</p>
			<p>Here you can see the ports that are open, and the service associated with each port.</p>
			<p>This is very useful when auditing your infrastructure to confirm <em class="italic">that just the required ports and services are open</em> and if there are discrepancies, apply immediate actions to remediate the vulnerability before the bad guys discover it.</p>
			<div><div><img src="img/Figure_8.2_B16290.jpg" alt="Figure 8.2 – nmap basic output&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.2 – nmap basic output</p>
			<p>Now, let's be more <em class="italic">aggressive</em> by adding the <code>-A</code> parameter:</p>
			<pre>nmap -A scanme.nmap.org</pre>
			<p>As shown in <em class="italic">Figure 8.3</em>, the <code>-A</code> parameter<a id="_idIndexMarker874"/> gives us some additional and useful information such as the following:</p>
			<ul>
				<li><strong class="bold">Name and version of the service running on the port</strong>: This is a very important auditing tool that enables you to easily identify outdated and vulnerable services, so that you can contact the server owner to get them patched ASAP. Additionally, and depending on the criticality of the vulnerability (for example, a very old version that may jeopardize the entire infrastructure), you can create a policy that if the service is not patched in <em class="italic">X</em> days, then the server will be removed from the network. This will cover you from having exposed services on your infrastructure but also puts some pressure on the system administrators to ensure that they get the service in question patched ASAP.</li>
				<li><strong class="bold">OS version</strong>: This will help you to determine if an unsupported OS is present in your infrastructure.</li>
			</ul>
			<div><div><img src="img/Figure_8.3_B16290.jpg" alt="Figure 8.3 – nmap -A output&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.3 – nmap -A output</p>
			<p>As we mentioned, <code>Nmap</code> is a great tool for<a id="_idIndexMarker875"/> auditing, and you may need to send these results to the server owner so they can take action. The good news is that you can use this simple command to export the <code>nmap</code> results to a <code>.txt</code> file so that you can easily send it to the server owner as an attachment:</p>
			<pre>nmap -A scanme.nmap.org &gt;&gt; server_audit.txt</pre>
			<p>As you can see in the following figure, the result of the preceding <code>nmap</code> command created a document called <code>server_audit.txt</code> and saved it to your working directory, ready for you to include in your audit results:</p>
			<div><div><img src="img/Figure_8.4_B16290.jpg" alt="Figure 8.4 – nmap result exported to .txt file&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.4 – nmap result exported to .txt file</p>
			<p>You can also target sections of your network by using an IP range. For example, the following command will scan all IPs from <code>192.168.0.1</code> to <code>192.168.0.100</code>:</p>
			<pre>nmap -A -v 192.168.0.1-100</pre>
			<p>Notice that we also included the <code>-v</code> (for <em class="italic">verbose</em>) parameter, which outputs additional information about the process of the scan.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">By default, <code>Nmap</code> scans 1,000 ports, but you can increase, decrease, or specify that number by using parameters such as <code>-F</code> (fast scan of fewer ports), <code>-p</code> (to specify the ports to scan), or <code>-r</code> (to scan all ports in consecutive order).</p>
			<p>There are many more parameters that you can use with <code>nmap</code>. To explore them, simply type the following:</p>
			<pre>nmap --help</pre>
			<p><em class="italic">But there is more!</em> <code>nmap</code> supports scripts created by the community to augment their capabilities, as explained in the next section.</p>
			<h2 id="_idParaDest-192"><a id="_idTextAnchor198"/>Nmap scripts</h2>
			<p>Let's review<a id="_idIndexMarker876"/> some of the best <code>nmap</code> scripts that you can leverage in defensive security.</p>
			<h3>vulners</h3>
			<p>This script will <a id="_idIndexMarker877"/>make your life<a id="_idIndexMarker878"/> easier. It will provide you all <code>Nmap</code> scan.</p>
			<p class="callout-heading">What is a CVE?</p>
			<p class="callout">In <a href="B16290_02_Final_JC_ePub.xhtml#_idTextAnchor035"><em class="italic">Chapter 2</em></a>, <em class="italic">Managing Threats, Vulnerabilities, and Risks</em>, we talked about one of the best places to go to find vulnerabilities: the <strong class="bold">CVE site</strong> at <a href="https://cve.mitre.org/">https://cve.mitre.org/</a>.</p>
			<p>The magical script is called <code>vulners</code> and can be<a id="_idIndexMarker880"/> found on the following link: <a href="https://github.com/vulnersCom/nmap-vulners">https://github.com/vulnersCom/nmap-vulners</a>.</p>
			<p>This script is loaded by default into the<a id="_idIndexMarker881"/> standard <strong class="bold">Nmap Scripting Engine</strong> (<strong class="bold">NSE</strong>) library, so there is no need to install it.</p>
			<p>The command structure is very simple, so let's explain it:</p>
			<pre>nmap -sV --script vulners [--script-args mincvss=&lt;arg_val&gt;] &lt;target&gt;</pre>
			<p>First, we have the standard <code>nmap</code> command, then we use the <code>-sV</code> parameter because the script needs the version to properly gather the CVE.</p>
			<p>Then we call the script by using the <code>--script {script_name}</code> parameter.</p>
			<p>We can optionally use the <code>mincvss</code> script argument to limit the results to CVEs with a score greater than the value provided. An example is as follows:</p>
			<pre>nmap -sV --script vulners scanme.nmap.org</pre>
			<p>Now, the script will look for all CVEs related to that <code>nmap</code> result. Note that the script uses a huge database of more than 250 GB, so the scan may take some minutes to run.</p>
			<p>The following figure shows a <a id="_idIndexMarker882"/>big list of vulnerabilities related to the version of Apache<a id="_idIndexMarker883"/> running on the server:</p>
			<div><div><img src="img/Figure_8.5_B16290.jpg" alt="Figure 8.5 – vulners script result&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.5 – vulners script result</p>
			<p>Also notice that the script provides a link to a web page about the CVE so that you can easily gather more information about the vulnerability.</p>
			<p>As we saw before, you can use the <code>&gt;&gt; {file_name}</code> option at the end of the preceding command to export the result to a <code>.txt</code> file to make it easier to send to the server owner (to get the vulnerabilities fixed ASAP). Also, having the file exported as <code>.txt</code> is great for keeping as evidence for audits.</p>
			<h3>vulscan</h3>
			<p>This is another super cool <a id="_idIndexMarker884"/>script that will search for vulnerabilities related to the version <a id="_idIndexMarker885"/>found in the <code>nmap</code> results.</p>
			<p>By default, the script will look for vulnerabilities on the following databases:</p>
			<ul>
				<li><strong class="bold">scipvuldb.csv</strong> - <a href="https://vuldb.com">https://vuldb.com</a></li>
				<li><strong class="bold">cve.csv</strong> - <a href="https://cve.mitre.org">https://cve.mitre.org</a></li>
				<li><strong class="bold">securityfocus.csv</strong> - <a href="https://www.securityfocus.com/bid/">https://www.securityfocus.com/bid/</a></li>
				<li><strong class="bold">xforce.csv</strong> - <a href="https://exchange.xforce.ibmcloud.com/">https://exchange.xforce.ibmcloud.com/</a></li>
				<li><strong class="bold">expliotdb.csv</strong> - <a href="https://www.exploit-db.com">https://www.exploit-db.com</a></li>
				<li><strong class="bold">openvas.csv</strong> - <a href="http://www.openvas.org">http://www.openvas.org</a></li>
				<li><strong class="bold">securitytracker.csv</strong> - <a href="https://www.securitytracker.com">https://www.securitytracker.com</a> (end-of-life)</li>
				<li><strong class="bold">osvdb.csv </strong>- <a href="http://www.osvdb.org">http://www.osvdb.org</a> (end-of-life)</li>
			</ul>
			<p>Unfortunately, this script is not loaded by default. But no worries, here are the steps to easily install it in Kali Linux:</p>
			<ol>
				<li>Navigate to the <code>nmap</code> <code>scripts</code> directory: <pre><strong class="bold">cd /usr/share/nmap/scripts/</strong></pre></li>
				<li>Create a directory for the installation of the files:<pre><strong class="bold">sudo mkdir vulscan</strong></pre></li>
				<li>Access the directory:<pre><strong class="bold">cd vulscan</strong></pre></li>
				<li>Install the files:<pre><strong class="bold">git clone https://github.com/scipag/vulscan scipag_vulscan</strong>
<strong class="bold">sudo ln -s `pwd`/scipag_vulscan /usr/share/nmap/scripts/vulscan/scipag_vulscan</strong></pre></li>
				<li>Once installed, the script is very simple to run:<pre><strong class="bold">nmap -sV –script vulscan/scipag_vulscan/vulscan.nse scanme.nmap.org</strong></pre></li>
			</ol>
			<p>In this case, as <a id="_idIndexMarker886"/>demonstrated in <a id="_idIndexMarker887"/>the following figure, the script did not find any vulnerability associated with the current version of OpenSSH on those databases:</p>
			<div><div><img src="img/Figure_8.6_B16290.jpg" alt="Figure 8.6 – vulscan script result&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.6 – vulscan script result</p>
			<p>This script can also be run against additional databases. To do that, just add the following argument:</p>
			<pre>--script-args vulscandb=your_own_database</pre>
			<p>As mentioned, one of the cool features of <code>nmap</code> is that you can create your own scripts.</p>
			<p>If you want to learn more about how to create your scripts, I highly recommend the book <em class="italic">Mastering the Nmap Scripting Engine</em> by <em class="italic">Paulino Calderon</em>, available from <em class="italic">Packt</em>.</p>
			<h1 id="_idParaDest-193"><a id="_idTextAnchor199"/>Improving the protection of wireless networks</h1>
			<p>To better explain this, let's split <a id="_idIndexMarker888"/>this section in two.</p>
			<p>In the first part, we will do <em class="italic">a technical deep dive on the most dangerous wireless network vulnerabilities</em> that you need to know.</p>
			<p>The second part will focus on the user, so it will basically be a <em class="italic">user guide to help them to stay secure when using a wireless connection at home</em>. Remember that these kinds of guides are your best bet to reduce the biggest risk to your infrastructure and data, <em class="italic">the inadvertent user</em>.</p>
			<h2 id="_idParaDest-194"><a id="_idTextAnchor200"/>Wireless network vulnerabilities</h2>
			<p>As mentioned, here we<a id="_idIndexMarker889"/> are going to look at the protocols, features, and practices that represent the top vulnerabilities to wireless networks. Due to the recent increase in the number of users working from home, this guide will include vulnerabilities that affect both enterprise and home systems.</p>
			<h3>Wi-Fi Protected Setup (WPS) – the problem</h3>
			<p>This is the perfect example of a tradeoff<a id="_idIndexMarker890"/> between security and usability (or convenience). The reason is that <strong class="bold">WPS</strong> was created to make it easier for non-technical users to connect new devices such as smart TVs, game consoles, and laptops to the network.</p>
			<p>The problem is that the protocol is extremely insecure and has several vulnerabilities that lower the security of your network.</p>
			<p>There are two <a id="_idIndexMarker891"/>main WPS implementations: one is <strong class="bold">PIN based</strong> and the other one is known as <strong class="bold">Push Button Control (PBC</strong>).</p>
			<p>The <strong class="bold">PBC</strong> implementation<a id="_idIndexMarker892"/> includes two methods. One method is initiated by pressing the WPS button on both devices as seen in <em class="italic">Figure 8.7</em>. Normally, here you have to press the WPS button on your Wi-Fi then you press the WPS button on your device to establish the connection.</p>
			<div><div><img src="img/Figure_8.7_B16290.jpg" alt="Figure 8.7 – WPS connection by pressing the button&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.7 – WPS connection by pressing the button</p>
			<p>There is also a hybrid mode in which you have to first open an app on your device to scan for WPS-enabled devices and then press the WPS button on the router to establish the connection, as shown in <em class="italic">Figure 8.8</em>.</p>
			<p>Some routers also have the option to trigger WPS through the router's web interface, but that option is only available on a few models and is used by very few people (because it lacks the usability part of the solution).</p>
			<div><div><img src="img/Figure_8.8_B16290.jpg" alt="Figure 8.8 – WPS hybrid connection mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.8 – WPS hybrid connection mode</p>
			<p>The other WPS implementation is by using a <strong class="bold">PIN code</strong>, which is way easier to remember than your super-long and secure password. </p>
			<p>But wait…. What is the point of <a id="_idIndexMarker893"/>having a super-secure password if we are also going to enable insecure PIN access? This is like having a super-secure one-million-dollar door that can be bypassed by an open window.</p>
			<p class="callout-heading">Why is the PIN method less secure?</p>
			<p class="callout">The PIN is an <a id="_idIndexMarker894"/>8-digit number, which means that the entropy (number of possible password combinations) is really small in contrast to an alphanumeric password in which you can introduce lower- and uppercase letters to significantly increase the entropy. In fact, using a modern cracking engine, an attacker can crack an 8-digit PIN in less than 8 hours.</p>
			<p>But this is not the only vulnerability present on WPS. Researchers also found a couple of vulnerabilities in the cryptographic protocol. One is related to the fact that some of the digits of the PIN are checksums (which can be calculated), reducing the time needed to crack the password. </p>
			<p>The other vulnerability is related to the mechanism used by the protocol to validate the PIN, called a <em class="italic">cryptodance</em>, in <a id="_idIndexMarker895"/>which one of the steps of the validation is not properly encrypted, allowing an attacker to get easy access to the PIN.</p>
			<p>Additionally, researchers also found some correlation between the MAC address and/or the serial number of the router, enabling an attacker to calculate the PIN based on those values.</p>
			<div><div><img src="img/Figure_8.9_B16290.jpg" alt="Figure 8.9 – WPS data pasted on the back of the router&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.9 – WPS data pasted on the back of the router</p>
			<p>As seen in the preceding figure, those<a id="_idIndexMarker896"/> values can be located on a sticker on the back of the router, but an attacker can remotely gather them by leveraging the vulnerabilities of the probe request packets, which are unencrypted and broadcasted by the router, meaning anyone can receive and read them, and they may contain the MAC address as well as the serial number. If you want know more about probe request vulnerabilities, see <a href="B16290_05_Final_JC_ePub.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>,<em class="italic"> Cybersecurity Technologies and Tools</em>,<em class="italic"> </em>under the <em class="italic">Advanced wireless tools for cybersecurity</em> section.</p>
			<h3>WPS – the solution</h3>
			<p>You may be surprised to <a id="_idIndexMarker897"/>know that <em class="italic">WPS is enabled by default</em> on most routers, so you may even have this vulnerability at home without knowing it.</p>
			<p>So, the best recommendation here is <em class="italic">to completely disable WPS</em> from your router (step-by-step instructions will be provided in the <em class="italic">User's safety guide for wireless networks</em> section).</p>
			<p>If for some reason you need to have <a id="_idIndexMarker898"/>WPS enabled, then leave the <strong class="bold">PCB</strong><em class="italic"> enabled</em> and make sure you <em class="italic">disable the PIN option</em> (as it is more vulnerable).</p>
			<p>Also make sure that you <em class="italic">update your router's firmware</em> to ensure that your router contains the latest WPS fixes and security updates.</p>
			<p>There are some legacy routers that will not allow you to disable WPS. In those cases, you have two options:</p>
			<ol>
				<li value="1">Update the <a id="_idIndexMarker899"/>router's firmware to see if the new update gives you the option to disable WPS.</li>
				<li>Change your router immediately.</li>
			</ol>
			<p>Now, let's look at a little-known wireless feature that may bring some vulnerabilities to your network: <strong class="bold">Universal Plug and Play</strong> (<strong class="bold">UPnP</strong>).</p>
			<h3>UPnP – the problem</h3>
			<p><strong class="bold">UPnP</strong> was also created with the<a id="_idIndexMarker900"/> idea of making life easier for users, as it enables the sharing of data between devices on a given network.</p>
			<p>The problem is that this was created mostly for sharing data between <em class="italic">trusted</em> devices on a home network, therefore UPnP does not do authentication and attackers know how to exploit this.</p>
			<p>One of the features of UPnP is port forwarding, and attackers can leverage that vulnerability to take control of computers and use them as proxies during DDoS attacks. This was the case in the famous <em class="italic">Mirai</em> attack<a id="_idIndexMarker901"/> in which this technique prevented security systems from identifying the command and control servers, as thousands of infected machines around the world were used as proxies between the "bot" machines and the real command and controls servers.</p>
			<p>Other examples of<a id="_idIndexMarker902"/> malicious trojans that leverage UPnP vulnerabilities <a id="_idIndexMarker903"/>include the banking trojan <em class="italic">Pinkslipbot</em>, also known as <em class="italic">QakBot</em> or <em class="italic">QBot</em>. These <a id="_idIndexMarker904"/>trojans are very dangerous as they use a keylogger to capture keystrokes and send financial information and credentials to remote command and control servers.</p>
			<h3>UPnP – the solution</h3>
			<p>The best way to protect against all these <a id="_idIndexMarker905"/>vulnerabilities is by <em class="italic">disabling UPnP</em> in your router (step-by-step instructions will be provided in the <em class="italic">User's safety guide for wireless networks</em> section). However, if you really need UPnP (to enhance the experience of a device), then you must follow these tips:</p>
			<ul>
				<li>Check the model of your router on the internet and verify that the manufacturer has released a patch for the latest vulnerabilities related to UPnP. In fact, in late 2020, researchers found a vulnerability called <strong class="bold">CallStranger</strong> that enabled an attacker to exfiltrate data from your systems; therefore<a id="_idIndexMarker906"/>, if you want to have UPnP enabled, you must keep checking for vulnerabilities and make sure you patch them. To find the list of current vulnerabilities, please visit <a href="https://cve.mitre.org">https://cve.mitre.org</a>.</li>
				<li>Filter all external traffic trying to use UPnP.</li>
				<li>Monitor network <a id="_idIndexMarker907"/>traffic to find abuses of UPnP.</li>
			</ul>
			<p>You may have a lot of technical and administrative controls at the office to secure your wireless network, but what about users working from home? Do they have the same level of security on their wireless connection at home?</p>
			<p>This should be a major concern for you because maybe even most of your users are now working from home, therefore it is imperative to establish and distribute clear guidelines (administrative controls) to the users to ensure they have acceptable levels of security to avoid additional risks to business data and systems.</p>
			<h2 id="_idParaDest-195"><a id="_idTextAnchor201"/>User's safety guide for wireless networks</h2>
			<p>As the person in charge of<a id="_idIndexMarker908"/> security for your organization, you must provide guidance to the users to reduce the risks of attack.</p>
			<p>Taking in consideration that most users use Wi-Fi to connect to the internet, then it would be a great idea for you to create a <em class="italic">manual of best practices when using wireless networks</em> and distribute it to all employees.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Also, remember that the key here is to ensure that all users are familiar with these guidelines, so some good ideas would be to create infographics to share by email or to create some cool videos to call people's attention to this campaign. Also, you can designate some influential employees as <em class="italic">security champions</em> to help you disseminate these strategies among all employees.</p>
			<p>Most of the security settings are configured on the Wi-Fi router, so let's start by showing the steps to log on to the administrative console of the Wi-Fi.</p>
			<h3>Accessing your router</h3>
			<p>Here are the five simple steps required to <a id="_idIndexMarker909"/>access your router settings:</p>
			<ol>
				<li value="1">Go to Google and enter the name of your router (brand and model) and the phrase <code>admin password</code>. For example, <code>Linksys E1200 admin password</code>.</li>
				<li>Then click on the relevant link from the manufacturer (in this case, <a href="http://linksys.com">linksys.com</a>).</li>
				<li>As shown in the following figure, the link sent us to the manufacturer support page, which confirms that the default username and password for this router are <code>admin</code>/<code>admin</code>:<div><img src="img/Figure_8.10_B16290.jpg" alt="Figure 8.10 – Default admin username and password&#13;&#10;"/></div><p class="figure-caption">Figure 8.10 – Default admin username and password</p></li>
				<li><em class="italic">To access the router, you just need to type the IP address of the router into your internet browser</em>. In this case, the support page mentions the default IP address; however, that address may change. But don't worry, this is very simple to confirm with the following steps:<p>a. Press <img src="img/Image.png" alt=""/> + <em class="italic">R</em> to launch the <code>cmd</code> and hit <em class="italic">Enter</em> to open Command Prompt.</p><p>b. On Command Prompt, type <code>ipconfig</code> and hit <em class="italic">Enter</em>.</p><p>c. Then look <a id="_idIndexMarker910"/>for the value called <code>192.168.0.1</code>:</p><div><img src="img/Figure_8.11_B16290.jpg" alt="Figure 8.11 – Router's IP address&#13;&#10;"/></div><p class="figure-caption">Figure 8.11 – Router's IP address</p></li>
				<li>Once you type the IP address on your browser, it should prompt you with a login page asking for your credentials. In this example, both the username and password are <code>admin</code>.<p class="callout-heading">Tip</p><p class="callout">All web interfaces are different (depending on the manufacturer), but the information should be the same, so take some time to explore the interface and get familiar with it. Linksys has an emulator that you can use to get familiar with the interface at <a href="http://ui.linksys.com/E1200/1.0.00/">http://ui.linksys.com/E1200/1.0.00/</a>.</p></li>
			</ol>
			<p>Now let's see what attributes you must change here to make your wireless router more secure.</p>
			<h3>Admin password</h3>
			<p>As you just saw, <em class="italic">the password of your router may be very weak</em> (and known to everyone), so the very first step<a id="_idIndexMarker911"/> is to secure the router by changing it. Depending on the router, it could be under a tab called <strong class="bold">Management</strong>,<strong class="bold"> Security</strong>,<strong class="bold"> Login</strong>, or<strong class="bold"> Users</strong>.</p>
			<p class="callout-heading">Tip – Use a passphrase</p>
			<p class="callout">The longer the password, the harder it is for an attacker to crack it, so use a phrase that you can easily remember as your password, for example, <code>I.Love.my.wife.since.2014</code>, or something motivational like <code>I.am.sure.I.will.get.my.masters.in.2021</code>. Of course, these are just examples, but create one that is unique to you with at least 25 characters. As with any other password, using special characters, slang, and popular phrases is better, because then your password will be strong against brute-force and dictionary attacks.</p>
			<h3>Admin user</h3>
			<p>Attackers knows that the<a id="_idIndexMarker912"/> default username to connect to the router is normally <code>admin</code>, however some routers allow you to change that username. So, if you have that option, it is highly recommended that you change that username as it will prevent most attacks as they will be targeted at a nonexistent user.</p>
			<h3>Wireless password</h3>
			<p>As mentioned in the preceding <a id="_idIndexMarker913"/>section, the use of a strong (long) passphrase is recommended for your wireless network. Also, a good practice is to change it at least every 6 months.</p>
			<h3>Wireless security (security mode)</h3>
			<p>Here you have three encryption <a id="_idIndexMarker914"/>options: <strong class="bold">WEP</strong> (highly insecure), <strong class="bold">WPA</strong> (vulnerable), <strong class="bold">WPA2</strong> (recommended).</p>
			<h3>Wireless network name (SSID)</h3>
			<p>By default, the SSID could be<a id="_idIndexMarker915"/> the brand of your wireless router plus some random numbers. This is not only ugly, but also dangerous because everyone will know the model of your router, so attacking it will be easier. So, as a first step, <em class="italic">change the name of your SSID</em> to a name of your preference. Also avoid using your own name in the SSID because that could make you an easier target. Therefore, an SSID like <em class="italic">Harper Family</em> should be avoided.</p>
			<p class="callout-heading">Tip – 2.4 GHz and 5 GHz</p>
			<p class="callout">Most modern routers have two bands (2.4 GHz and 5 GHz) and in most cases, you need to configure them as if they are two different routers (meaning different SSIDs, different security modes, different passphrases, different guest accounts, and so on). Therefore, make sure that all settings are the same on both networks to avoid leaving holes in one of them.</p>
			<h3>Guest accounts</h3>
			<p>Imagine that your neighbor needs to<a id="_idIndexMarker916"/> connect to your Wi-Fi for a minute to send an urgent email. That means that you need to reveal your ultra-secure passphrase, but now your passphrase is saved on their device, so they can connect at any time they want. Now, if you change your passphrase to avoid that, then it means that you will have to re-enter the new passphrase on all your devices. Therefore, to avoid all that trouble, you can enable <strong class="bold">guest accounts</strong>. Guest accounts enable you to create an account for external people, which has a lot of advantages including the following:</p>
			<ul>
				<li>They can be enabled temporarily and then disabled to prevent any further access.</li>
				<li>You can change the password any time you want without affecting your other devices.</li>
				<li>Since you can use them as <em class="italic">temporary</em> accounts, you can create a new password every time that you use them, making it almost impossible to crack.</li>
			</ul>
			<h3>Remote access</h3>
			<p>Some routers have the<a id="_idIndexMarker917"/> option for you to access the management console from a remote location (through the internet). This is very insecure as it opens the doors to attackers to gain access to your router (and then your network and data). Therefore, <em class="italic">always disable the remote access feature.</em></p>
			<h3>Disable WPS (both the button and PIN versions)</h3>
			<p>As mentioned in the<a id="_idIndexMarker918"/> preceding section, WPS is a highly vulnerable protocol that must be disabled (and is normally enabled by default).</p>
			<p>To do so is very simple – just look for <strong class="bold">WPS settings</strong> on your router (as shown in the following figure) and click to disable WPS:</p>
			<div><div><img src="img/Figure_8.12_B16290.jpg" alt="Figure 8.12 – WPS settings&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.12 – WPS settings</p>
			<h4>Disable UPnP</h4>
			<p>Similar to WPS, <strong class="bold">UPnP</strong> is <a id="_idIndexMarker919"/>highly vulnerable and the worst part is that it is enabled by default on most routers, so to prevent that vulnerability, it is highly recommended to disable it, as shown in the following figure:</p>
			<div><div><img src="img/Figure_8.13_B16290.jpg" alt="Figure 8.13 – UPnP settings&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.13 – UPnP settings</p>
			<h3>Fing app</h3>
			<p><strong class="bold">Fing</strong> is a mobile app that <a id="_idIndexMarker920"/>enables you to see all the devices connected to your network.</p>
			<p>This is a great tool to confirm if an unauthorized user is connected to your network and if so, change the router password immediately.</p>
			<p>As seen in <em class="italic">Figure 8.14</em>, <strong class="bold">Fing</strong> gives us a lot of <a id="_idIndexMarker921"/>useful information about the connected devices, such as the following:</p>
			<ul>
				<li>Device name</li>
				<li>Device type</li>
				<li>Device model</li>
				<li>IP address</li>
				<li>Manufacturer or brand</li>
			</ul>
			<div><div><img src="img/Figure_8.14_B16290.jpg" alt="Figure 8.14 – Fing app&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.14 – Fing app</p>
			<h3>Use of NFC tags</h3>
			<p>Another cool idea is that <a id="_idIndexMarker922"/>you can <a id="_idIndexMarker923"/>use <strong class="bold">NFC cards</strong> to store your wireless settings, so instead of typing your secure (long) password, you can just put the tag near the phone and it will automatically connect to your Wi-Fi.</p>
			<p>The other advantage of this method is that you don't need to remember the password, which enables you to use a super-secure passphrase like this:</p>
			<p><em class="italic">ds9*e-sd4SDF-#ta+Dua-43v3r00-#D/*#ef#sfM.?$-#iD2#l¡GE.#d-9#a</em></p>
			<p>As you can see in this guide, once you have the right knowledge about your router, securing your wireless network is a very easy task.</p>
			<p>Now, let's take a look at one of the most famous cybersecurity tools: <strong class="bold">Wireshark</strong>.</p>
			<h1 id="_idParaDest-196"><a id="_idTextAnchor202"/>Introducing Wireshark</h1>
			<p>Wireshark is<a id="_idIndexMarker924"/> one of the best cybersecurity tools used to monitor and secure networks.</p>
			<p>This chapter aims to give you an overview of the tool and the main things that you can achieve with it. However, if you want to learn more about Wireshark, look at the book <em class="italic">Learn Wireshark </em>by<em class="italic"> Lisa Bock</em>, also from <em class="italic">Packt</em>, which has more than 400 pages full of knowledge that will help you to become an expert with this tool.</p>
			<p>The main characteristic of Wireshark is the ability to gather all network traffic passing through a given network adapter and <em class="italic">decode</em> the captured bits into a human-readable format. This is achieved by using decoders or dissectors that are constantly updated by the community.</p>
			<p>Wireshark can be installed on any OS, but as you may know, it comes preinstalled on <strong class="bold">Kali Linux</strong>, so for this example <a id="_idIndexMarker925"/>we are going to use the version on Kali, which in our case is <strong class="bold">3.2.7</strong>.</p>
			<p>The very first step to start capturing our first packets will be <em class="italic">to select the network card that we want to "listen" to</em>. As shown in the following figure, the Wireshark landing page already shows us the available network cards so that we can easily select one and start capturing the packets:</p>
			<div><div><img src="img/Figure_8.15_B16290.jpg" alt="Figure 8.15 – Wireshark's initial screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.15 – Wireshark's initial screen</p>
			<p>However, if you<a id="_idIndexMarker926"/> have several network cards (interfaces), it could be confusing to know which one you need to select.</p>
			<p>The trick here is to click on <strong class="bold">Interfaces</strong>, which will display a window with detailed information about all network interfaces. From there, you can determine which is your active interface by looking at the traffic column.</p>
			<p>If there is no activity on the traffic column, then just ping a server, for example, <code>ping </code><a href="http://www.google.com">www.google.com</a>, and as shown in the following figure, you will start seeing the traffic column move on your active network interface. In this case, we can determine that our active network interface is <strong class="bold">eth0</strong>, so we can click on it and then click on <strong class="bold">Start</strong> to begin the capture of packets:</p>
			<div><div><img src="img/Figure_8.16_B16290.jpg" alt="Figure 8.16 – Active interfaces on Wireshark&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.16 – Active interfaces on Wireshark</p>
			<p>OK, now that we <a id="_idIndexMarker927"/>started the monitoring, let's see what happens when we open a web page.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Most pages have a lot of ads that will make the scan very <em class="italic">noisy</em>, so in order to avoid all the noise, we will open the page of a university for this example. Additionally, using a virtual machine with Kali is great because it does not have all the network overhead carried on Windows systems (if you run Wireshark on a Windows machine, you will see a lot of packets even if you are <em class="italic">supposedly</em> not using the network).</p>
			<p>The following figure shows the output of a scan that we performed on a web page so that you can become familiar with the outputs of the tool and better understand them:</p>
			<div><div><img src="img/Figure_8.17_B16290.jpg" alt="Figure 8.17 – Wireshark scan results&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.17 – Wireshark scan results</p>
			<p>Let's start by <a id="_idIndexMarker928"/>analyzing the outputs from the top of the preceding figure. You will see there that the very first packet is your computer asking the DNS server for the IP of the web page. Here, for example, you can validate that the request is going to the required DNS server – in our case it is going to <code>8.8.8.8</code> (Google's DNS). If you notice another DNS then you may be in the presence of a DNS attack that may reroute your traffic to malicious sites.</p>
			<p>Once we obtained the IP from the DNS server, we start to see some exchange of basic TCP packets. After that, we receive some HTTP packets (which is basically the web page that we requested), and finally, we see some TLS packets, which means that the web page is encrypted with an SSL certificate (HTTPS).</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">You can easily sort the results by column by simply clicking on the name of the column. For example, you can click on the protocol tab to sort all the packets captured by protocol.</p>
			<p>OK, now let's review more advanced ways to leverage Wireshark to enhance your security.</p>
			<h2 id="_idParaDest-197"><a id="_idTextAnchor203"/>Finding users using insecure protocols</h2>
			<p>As you know, users will <a id="_idIndexMarker929"/>always find creative ways to bypass your administrative and technical controls. In those cases, using a monitoring tool such as Wireshark is a great way to find and stop those wrongdoers.</p>
			<h3>Telnet vulnerabilities</h3>
			<p>Telnet<a id="_idIndexMarker930"/> is an old client/server protocol for machine-to-machine communications.</p>
			<p>The problem is that it <a id="_idIndexMarker931"/>does not offer encryption, therefore ALL communication is transmitted as cleartext.</p>
			<p>Due to that risk, Telnet (both server and client) is disabled by default on most systems including Windows and even Kali Linux.</p>
			<p>Therefore, due to this risk, <em class="italic">you must ensure that you have all technical and administrative controls in place to prevent the use of telnet for server login and communications</em>.</p>
			<p>The good news is that you can easily detect if someone is using Telnet with Wireshark by simply filtering your results by protocol.</p>
			<h3>Capturing Telnet data in real time</h3>
			<p>To perform this example, we <a id="_idIndexMarker932"/>first need to install the Telnet client on Kali Linux with the following command:</p>
			<pre>sudo apt-get install telnet</pre>
			<p>Now that the <strong class="bold">Telnet client</strong> is <a id="_idIndexMarker933"/>installed, we can connect to a <strong class="bold">Telnet server</strong>, and for this<a id="_idIndexMarker934"/> example we are going to use an open (and funny) Telnet sever.</p>
			<p class="callout-heading">But wait, didn't you say that Telnet was insecure?</p>
			<p class="callout">Yes, there are several vulnerabilities in Telnet servers and Telnet communications, however installing a Telnet client does not represent a vulnerability on your system.</p>
			<p>Let's go back to Wireshark to set it up to capture all Telnet data, which is a super simple task. As you can see in the following figure, you just need to type <code>telnet</code> in the <strong class="bold">filter</strong> bar to see all Telnet connections in real time:</p>
			<div><div><img src="img/Figure_8.18_B16290.jpg" alt="Figure 8.18 – Wireshark filter field&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.18 – Wireshark filter field</p>
			<p>Now, let's navigate to a test Telnet server and create an account to see if we can capture it.</p>
			<p>To do that, just open a<a id="_idIndexMarker935"/> Terminal on our Kali Linux and type the following to access the Telnet server:</p>
			<pre>telnet telehack.com</pre>
			<p>And, as shown in the following figure, we are now connected to the <strong class="bold">telehack</strong> Telnet server:</p>
			<div><div><img src="img/Figure_8.19_B16290.jpg" alt="Figure 8.19 – Telnet connection open to the telehack.com server&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.19 – Telnet connection open to the telehack.com server</p>
			<p>Now, let's go back to<a id="_idIndexMarker936"/> Wireshark to see what we have captured.</p>
			<p>The results are very interesting and, as highlighted in <em class="italic">Figure 8.20</em>, we were able to capture in plain text all the information that the Telnet server sent (which is the same information that we saw on the command line of <em class="italic">Figure 8.19</em>).</p>
			<div><div><img src="img/Figure_8.20_B16290.jpg" alt="Figure 8.20 – Capture of Telnet packets&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.20 – Capture of Telnet packets</p>
			<p>So, we have proved that<a id="_idIndexMarker937"/> Telnet communications are not secure and can easily be captured. Now, let's see if we can also capture some login details.</p>
			<p>To achieve that, let's create an account by using the <code>login</code> command. Then the system will ask for our username and we need to reply <code>Y</code> to confirm the creation of a new account (see <em class="italic">Figure 8.21</em>).</p>
			<div><div><img src="img/Figure_8.21_B16290.jpg" alt="Figure 8.21 – Creation of an account on a Telnet server&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.21 – Creation of an account on a Telnet server</p>
			<p>Now, as shown in the following figure, the system will ask for a password, so let's enter a random password and hit <em class="italic">Enter</em> to finish the creation of the account:</p>
			<div><div><img src="img/Figure_8.22_B16290.jpg" alt="Figure 8.22 – Password setup over Telnet&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.22 – Password setup over Telnet</p>
			<p>OK, now, let's go back <a id="_idIndexMarker938"/>again to Wireshark and see if it captured the password that we just created on the server.</p>
			<p>You may notice that there are too many packets, and in some cases, it looks like there is one packet per letter. But no worries – to make our lives easier, Wireshark has an option called <strong class="bold">TCP stream</strong> that presents all data in a very user-friendly way. To access that option, just right-click on one of the packets and select <strong class="bold">Follow | TCP Stream</strong> (as shown in the following figure):</p>
			<div><div><img src="img/Figure_8.23_B16290.jpg" alt="Figure 8.23 – TCP Stream option in Wireshark&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.23 – TCP Stream option in Wireshark</p>
			<p>Now Wireshark will present<a id="_idIndexMarker939"/> us a window like in <em class="italic">Figure 8.24</em>, showing all the communication between the client and the server. We can effectively see the password in <em class="italic">cleartext</em>.</p>
			<div><div><img src="img/Figure_8.24_B16290.jpg" alt="Figure 8.24 – Password captured in plain text&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.24 – Password captured in plain text</p>
			<p class="callout-heading">Challenge</p>
			<p class="callout">Try to do the same exercise but over an SSH connection. In that case, you will notice that all packets with data will be encrypted, so the information will be secure.</p>
			<p>Before moving to the next section, let's have a break<em class="italic"> </em>and show you how you can leverage the <strong class="bold">Telnet client</strong> that you just installed to have some fun (and maybe impress some friends).</p>
			<h3>Bonus (having fun with Telnet)</h3>
			<p>There are a lot of Telnet servers out there with funny information<a id="_idIndexMarker940"/> for you to explore (without risk). There are three types:</p>
			<ul>
				<li><strong class="bold">Muds</strong>: Old-school games</li>
				<li><strong class="bold">Bulletin Board Systems </strong>(<strong class="bold">BBSes</strong>): An<a id="_idIndexMarker941"/> old system to share information (Facebook's prehistoric ancestor?)</li>
				<li><strong class="bold">Talkers</strong>: Servers configured to <em class="italic">talk</em> about a given topic such as telling jokes (chatbot's lost grandpa)</li>
			</ul>
			<p>Now, here is a compilation for you to have fun connecting to them (<em class="italic">Just keep in mind that everything you type can be captured, so if you create a user, use a dummy password</em>):</p>
			<ul>
				<li><strong class="bold">Star Wars ASCII animation (in case Netflix is down)</strong>:<pre><strong class="bold">telnet towel.blinkenlights.nl 23</strong></pre></li>
			</ul>
			<div><div><img src="img/Figure_8.25_B16290.jpg" alt="Figure 8.25 – The Star Wars movie over telnet&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.25 – The Star Wars movie over telnet</p>
			<ul>
				<li><strong class="bold">NASA JPL HORIZONS Solar System data</strong>:<pre><strong class="bold">telnet horizons.jpl.nasa.gov 6775</strong></pre></li>
				<li><strong class="bold">Weather via telnet</strong>:<pre><strong class="bold">telnet rainmaker.wunderground.com 3000</strong></pre></li>
				<li><strong class="bold">Telehack </strong><strong class="bold"><a id="_idIndexMarker942"/></strong><strong class="bold">(the one we used in the preceding example, which is considered an internet museum)</strong>:<pre><strong class="bold">telnet telehack.com 23</strong></pre></li>
				<li><strong class="bold">Achaea, Dreams of Devine Land (Game)</strong>:<pre><strong class="bold">telnet achaea.com</strong></pre></li>
				<li><strong class="bold">Free chess game</strong>:<pre><strong class="bold">telnet freechess.org 5000</strong></pre></li>
			</ul>
			<p>The following figure shows a really cool, retro way to play chess… Cool!!!</p>
			<div><div><img src="img/Figure_8.26_B16290.jpg" alt="Figure 8.26 – Telnet chess game&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.26 – Telnet chess game</p>
			<p>OK, enough games for today, now let's go back to keep learning about other insecure protocols.</p>
			<h2 id="_idParaDest-198"><a id="_idTextAnchor204"/>FTP, HTTP, and other unencrypted traffic</h2>
			<p>Telnet is not the only insecure protocol – other unencrypted protocols such as FTP<a id="_idIndexMarker943"/> and HTTP<a id="_idIndexMarker944"/> also send <a id="_idIndexMarker945"/>unencrypted data that can be easily captured.</p>
			<p>As shown in the following figure, the username and password are cle<a id="_idTextAnchor205"/>arly sent over plaintext when logging in to an FTP server:</p>
			<div><div><img src="img/Figure_8.27_B16290.jpg" alt="Figure 8.26 – Telnet chess game&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.27 – FTP username and password captured in plaintext</p>
			<p>Therefore, make sure you<a id="_idIndexMarker946"/> promote the use of more secure protocols such as <strong class="bold">Secure FTP</strong> (<strong class="bold">SFTP</strong>) and <strong class="bold">Secure HTTP</strong> (<strong class="bold">HTTPS</strong>) across <a id="_idIndexMarker947"/>your organization.</p>
			<h2 id="_idParaDest-199"><a id="_idTextAnchor206"/>Wireshark for defensive security</h2>
			<p>Now that you know the basics of <a id="_idIndexMarker948"/>Wireshark, let's see how you can leverage Wireshark in your defensive security role.</p>
			<h3>Awareness campaigns</h3>
			<p>As you just witnessed, the <a id="_idIndexMarker949"/>previous examples are a very good way to show to users and systems administrators <em class="italic">the dangers of not following the policies and using insecure channels to transmit sensitive information</em> (such as usernames and passwords).</p>
			<p>Doing this kind of demonstration live to the employees of your company as part of events such as the annual cybersecurity week will help you to reduce a lot of risks and also to transform those users from security adversaries to security promoters.</p>
			<p>Another means of delivery could be by making videos of the preceding demos and distributing them to your teams as part of the annual cybersecurity mandatory training that your employees <em class="italic">must</em> complete.</p>
			<h3>Advanced network audits</h3>
			<p>Wireshark enables you to<a id="_idIndexMarker950"/> perform a deep analysis of the network to help you achieve the following objectives:</p>
			<ul>
				<li>Compliance audits</li>
				<li>Internal security audits</li>
				<li>Performance analysis</li>
				<li>Network risk assessments</li>
				<li>Malware traffic analysis</li>
				<li>Vulnerability assessments</li>
				<li>Identification of data exfiltration</li>
				<li>Network-hardening analysis</li>
			</ul>
			<p>Those tasks can be performed either by an internal cybersecurity professional or by a service provider (either a third-party company or an external cybersecurity professional).</p>
			<h3>Consulting work</h3>
			<p>Wireshark is a great tool that <a id="_idIndexMarker951"/>can be used by independent consults to provide data-driven advice to companies to improve the security of their data, systems, and networks.</p>
			<h3>Network troubleshooting</h3>
			<p>While you may not be directly in <a id="_idIndexMarker952"/>charge of doing the troubleshooting, it is important for you to know that in many cases, network specialists will use Wireshark to troubleshoot network issues such as latency, availability, and stability.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Wireshark is not an <strong class="bold">intrusion detection system</strong> (<strong class="bold">IDS</strong>), meaning it will not give you an alert when an intruder accesses your network, but it is a great tool to investigate further if an intrusion was detected.</p>
			<p>Don't worry, in the next section we will cover the basics about <strong class="bold">Intrusion Detection Systems </strong>(<strong class="bold">IDSes</strong>) and <strong class="bold">Intrusion Prevention Systems </strong>(<strong class="bold">IPSes</strong>) and even look at a comparison between them.</p>
			<h1 id="_idParaDest-200"><a id="_idTextAnchor207"/>Working with IPS/IDS</h1>
			<p>In this section, we will explain what an <strong class="bold">IDS</strong> and an <strong class="bold">IPS</strong> are, provide some examples of these systems, and also consider the differences between these two similar technologies.</p>
			<h2 id="_idParaDest-201"><a id="_idTextAnchor208"/>What is an IDS?</h2>
			<p>An <strong class="bold">IDS</strong> is <a id="_idIndexMarker953"/>a passive monitoring solution that detects unwanted intrusions in our networks.</p>
			<p>Once the intrusion is detected, the IDS will send an alert to a security analyst for further investigation and action (as shown in the following figure):</p>
			<div><div><img src="img/Figure_8.28_B16290.jpg" alt="Figure 8.28 – IDS representation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.28 – IDS representation</p>
			<p>In terms of deployment, an IDS can be deployed at the host level (HIDS) or network level (NIDS).</p>
			<p>There are two main<a id="_idIndexMarker954"/> IDS engines, one that is based on signatures (examples are classic antiviruses that use a database of signature to detect malicious software), and one that is anomaly-based, which detects intrusions based on deviations from established patterns. In this latter category, there are also systems that leverage cognitive computing to enhance the recognition and identification of these patterns.</p>
			<h2 id="_idParaDest-202"><a id="_idTextAnchor209"/>What is an IPS?</h2>
			<p>An <strong class="bold">IPS</strong> is an <a id="_idIndexMarker955"/>active system that prevents access to your network by unauthorized users.</p>
			<p>As represented in the following figure, an IPS will automatically block any traffic that may be considered a threat to your network:</p>
			<div><div><img src="img/Figure_8.29_B16290.jpg" alt="Figure 8.29 – IPS representation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.29 – IPS representation</p>
			<p>In terms of deployment and the backend (engine) of an IPS, these are very similar to the ones mentioned for IDS.</p>
			<h2 id="_idParaDest-203"><a id="_idTextAnchor210"/>Free IDS/IPS</h2>
			<p>There is no excuse for not having an IDS/IPS – in fact, here are some free IDS/IPS<a id="_idIndexMarker956"/> that you can implement in your infrastructure.</p>
			<h3>Snort</h3>
			<p>Probably the most<a id="_idIndexMarker957"/> famous IPS/IDS, Snort's engine is mostly signature based. The <a id="_idIndexMarker958"/>system comes with a base set of policies, but you can expand this by creating your own.</p>
			<p>You can also integrate Snort with Wireshark to provide alerting capabilities to Wireshark.</p>
			<p>Snort is available on Windows, Fedora, CentOS, FreeBSD, and Kali Linux.</p>
			<p>For more<a id="_idIndexMarker959"/> information, visit <a href="https://www.snort.org/">https://www.snort.org/</a>.</p>
			<h3>Security Onion</h3>
			<p>This is a Linux distribution that<a id="_idIndexMarker960"/> includes an IPS and IDS engine and uses OSSEC for host-based IDS/IPS and <a id="_idIndexMarker961"/>Snort and Suricata for network-based IDS/IPS.</p>
			<p>For more information<a id="_idIndexMarker962"/>, visit their GitHub repo at <a href="https://github.com/Security-Onion-Solutions/security-onion">https://github.com/Security-Onion-Solutions/security-onion</a>.</p>
			<h2 id="_idParaDest-204"><a id="_idTextAnchor211"/>IPS versus IDS</h2>
			<p>The following figure<a id="_idIndexMarker963"/> highlights the main differences between an IPS and IDS, as well as some of the features they have in common:</p>
			<div><div><img src="img/Figure_8.30_B16290.jpg" alt="Figure 8.30 – Differences between IDS and IPS&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption"> </p>
			<p class="figure-caption">Figure 8.30 – Differences between IDS and IPS</p>
			<p>Most experts agree that<a id="_idIndexMarker964"/> each system complements the other, so the best implementation is to deploy them in parallel to enhance the security of your network.</p>
			<h1 id="_idParaDest-205"><a id="_idTextAnchor212"/>Summary</h1>
			<p>In this chapter, we started by reviewing the <em class="italic">different phases of a cyber attack</em>. Then we learned <em class="italic">how to use Nmap to check for vulnerabilities</em> in our infrastructure and make the scanning phase of an attack harder for an attacker.</p>
			<p>Then we reviewed the <em class="italic">most common Wi-Fi vulnerabilities</em> and how to address them. Additionally, we also learned <em class="italic">how to create a Wi-Fi user security guide</em> to reduce risks when using a wireless network. This is a great asset that you can leverage to support your <em class="italic">network security strategy</em> and educate users.</p>
			<p>After that, we moved to a more technical topic and learned <em class="italic">how to use Wireshark</em> to find vulnerabilities and even did a couple of labs to see in real time <em class="italic">how attackers can capture your data</em> (including passwords) when you use insecure protocols.</p>
			<p>And finally, we closed this journey through network security by doing an <em class="italic">overview of IDS and IPS</em>, what they are, some examples of them, and a comparison between them for you to better understand the differences between these two technologies.</p>
			<p>Now, get ready, because in the next chapter we are going to learn <em class="italic">all you need to know about physical security</em>, its associated threats, and how to master the defensive techniques (tools, systems, and methods) to protect against those threats.</p>
		</div>
	</body></html>