- en: '*Chapter 6*: Securing Windows Infrastructures'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*"As an inventor and researcher, I realize that the degree of vulnerability
    of an organization depends on how the infrastructure was implemented, managed,
    and designed,"*'
  prefs: []
  type: TYPE_NORMAL
- en: '*– Sarbajit Rakshit, IBM Master Inventor*'
  prefs: []
  type: TYPE_NORMAL
- en: Almost all companies have Windows systems in their infrastructure, either as
    workstations, servers, or directory services. Therefore, to master the art of
    cybersecurity, you need to know which strategies, techniques, and tools to apply,
    but also *how* and *when* to apply them to achieve the desired level of security
    in your infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: 'To achieve those goals, we are going to cover the following main topics:'
  prefs: []
  type: TYPE_NORMAL
- en: How to apply the best hardening strategies on Windows servers
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creation of your own hardening checklist for Windows servers
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Designing a world-class patching strategy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: An overview of all the different types of patches for Windows systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Best cybersecurity practices for **Active Directory** (**AD**)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A guide to best practices for endpoint security
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: An overview of how to leverage encryption to keep your data secure
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are no hard requirements for this chapter; however, it would be useful
    to have access to a Windows 10 machine to test some of the concepts that we will
    cover through the book (patching, encryption, policies, and so on).
  prefs: []
  type: TYPE_NORMAL
- en: Applying Windows hardening
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nothing is impossible to break; just make it hard enough to make them want another
    target.
  prefs: []
  type: TYPE_NORMAL
- en: As you know, **hardening** is a fancy name for all the techniques used to protect
    a given server from attacks. While hardening is not a bullet-proof solution, its
    aim is to increase the security of a server to an acceptable level to prevent
    the majority of attacks.
  prefs: []
  type: TYPE_NORMAL
- en: In general, a properly hardened server should be protected against all scripted
    or automated attacks.
  prefs: []
  type: TYPE_NORMAL
- en: 'There are normally two ways to apply hardening, as outlined here:'
  prefs: []
  type: TYPE_NORMAL
- en: Applied by a separate team (**information technology** (**IT**) infrastructure)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Another applied by the security team (you)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let's take a look at your responsibilities when hardening is performed by the
    infrastructure team.
  prefs: []
  type: TYPE_NORMAL
- en: Hardening by the infrastructure team
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this case, the hardening is performed (executed) by another team; however,
    you may still be accountable for ensuring that the server is secure, so in that
    case, you need to at least perform the following actions:'
  prefs: []
  type: TYPE_NORMAL
- en: Provide the team with a *checklist* of the minimal hardening required.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Perform regular audits to ensure the servers have the minimal hardening requirements.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let's take a look at how to create a **comprehensive hardening checklist** that
    you can provide to the infrastructure team to ensure that at least the minimum
    required steps are performed.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a hardening checklist
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A hardening checklist will be influenced by several factors, including corporate
    risk appetite, cybersecurity policies, and applicable regulations. Here, we are
    going to review the most common items that must be included to create the ultimate
    **Windows hardening checklist**.
  prefs: []
  type: TYPE_NORMAL
- en: Regardless of who is responsible for performing Windows hardening, this checklist
    will contain the basic items that need to be performed to ensure that your Windows
    servers have the basic protections in place.
  prefs: []
  type: TYPE_NORMAL
- en: Let's now take a look at the required elements of your hardening checklist.
  prefs: []
  type: TYPE_NORMAL
- en: Supported OS versions
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: This is a very important factor to take into consideration because while newer
    versions have a lot of security features, such as the introduction of Windows
    Defender **Advanced Threat Protection** (**ATP**) on Windows Server 2019, older
    versions have lower levels of security and you should therefore try to encourage
    the use of newer versions on new builds.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are some of the rules that should be included in this section of the checklist:'
  prefs: []
  type: TYPE_NORMAL
- en: Never allow unsupported versions of Windows servers in your infrastructure.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Keep an inventory of the server infrastructure, which should include *end-of-support*
    dates.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create a plan to start the migration of future *end-of-support* servers at least
    a year before the effective *end-of-support* date.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create a policy to enforce that all servers must include all updates, patches,
    and service packs before being set in production.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In case you cannot upgrade the servers due to a lack of budget, the recommendation
    is to create a risk letter that includes all the cybersecurity risks associated
    with having that old server in your infrastructure (with the associated costs)
    and present that to upper management. That way, they will either give you the
    budget for the new servers or accept the risk, and in that case, you will have
    your back covered.
  prefs: []
  type: TYPE_NORMAL
- en: Windows services and features
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Windows servers have a set of default services that start automatically at startup.
    While many of those services are required by the OS to function properly, some
    of them are optional and may represent a potential vulnerability.
  prefs: []
  type: TYPE_NORMAL
- en: While newer versions load just the minimal required services, old OS server
    versions may need additional tuning to disable some non-essential services.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are some items to include in the checklist regarding this topic:'
  prefs: []
  type: TYPE_NORMAL
- en: Ask each server owner to create a list of the enabled services, including a
    justification for each particular service.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ask the server owners to perform at least a quarterly validation of the services
    to ensure that unused services are disabled.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ask the server owners to create a *risk justification letter* in case any of
    the services running are listed as *high risk* in the corporate cybersecurity
    policies.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'An example justification list is shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.1 – Services justification list'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.1_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.1 – Services justification list
  prefs: []
  type: TYPE_NORMAL
- en: Additionally, take into consideration that Windows services run in the security
    context of a specific user (local system, local service, or network service accounts).
    However, for *application* and *user services*, the recommendation is to set up
    specific accounts, (locally or in AD) to handle these services with the minimum
    rights.
  prefs: []
  type: TYPE_NORMAL
- en: Ports and protocols
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Similar to services, **ports and protocols** should be maintained at a minimum
    to reduce potential attack vectors.
  prefs: []
  type: TYPE_NORMAL
- en: 'Checklist items include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Ask each server owner to create a list of open ports (including a justification).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ask the server owners to perform at least a quarterly validation of the opened
    ports to ensure that all open ports are in use.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ask the server owners to create a *risk justification letter* in case any of
    the open ports are listed as *high risk* in the corporate cybersecurity policies.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A common technique used by criminals is to scan ports; therefore, following
    those simple steps will considerably enhance the security of your servers.
  prefs: []
  type: TYPE_NORMAL
- en: User management
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Also known as **Identity and Access Management** (**IAM**), this is normally
    handled by a separate team that follows IAM processes to create, delete, and disable
    user **identifiers** (**IDs**).
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are the relevant points for our checklist:'
  prefs: []
  type: TYPE_NORMAL
- en: All user management should be created by the IAM team.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All local users must be created by the IAM team.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All server owners must follow the IAM process (create, delete, disable, and
    update user accounts).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All accounts must have an associated person as the owner.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Accounts should be created based on the **principle of least privilege** (**PoLP**).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Password policies must be enforced by the system (server or Active Directory).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Prevent users from disabling **User Account Control** (**UAC**).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Block Microsoft account login.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Block guest accounts.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Account lockout must be aligned with current cybersecurity policies. As seen
    in the following screenshot, this is configured on the Windows **Local Group Policy
    Editor**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Figure 6.2 – Lockout policy: Windows Group Policy Editor'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.2_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 6.2 – Lockout policy: Windows Group Policy Editor'
  prefs: []
  type: TYPE_NORMAL
- en: Disable the default *admin* account (this account poses a high risk of brute-force
    attacks because account lockout is disabled).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Restrict users with blank passwords.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Additional items will be covered in the *Applying security to AD* section.
  prefs: []
  type: TYPE_NORMAL
- en: Monitoring
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'You need to keep your infrastructure under control at all times, and monitoring
    and logs are key in case any forensics are needed. Therefore, there are a couple
    of important items that should be included in our checklist, as detailed here:'
  prefs: []
  type: TYPE_NORMAL
- en: Ensure *logs* are enabled in all servers.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure that *corporate monitoring systems* are loaded and running on all production
    servers.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Have a look at the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.3 – Audit policies: Windows Group Policy Editor'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.3_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 6.3 – Audit policies: Windows Group Policy Editor'
  prefs: []
  type: TYPE_NORMAL
- en: As seen in the preceding screenshot, those settings can be accessed for configuration
    and verification (audit) on the Windows `Advanced Audit Policy Configuration`
    folder.
  prefs: []
  type: TYPE_NORMAL
- en: Additional considerations for your checklist
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'If available, ensure that **Control flow guard** (**CFG**) and **Data Execution
    Prevention** (**DEP**) are turned on. Normally, they are set to **On by default**,
    but you can check the status by following these steps:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Go to **Windows Defender Security Center**.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **App & browser control**.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Exploit protection settings**.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Go to **System settings**, and you will see options for **Control flow guard****(CFG)**
    and **Data Execution Prevention (DEP)**, as illustrated in the following screenshot:'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 6.4 – Windows embedded exploit protection'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.4_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.4 – Windows embedded exploit protection
  prefs: []
  type: TYPE_NORMAL
- en: Request a strong antivirus solution on the server (this could be a third-party
    solution or Windows Defender).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable **Windows AppLocker**.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure the **Basic Input/Output System** (**BIOS**) is password-protected.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable **Secure Boot**.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All volumes should be NTFS (FAT should not be allowed).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable the sending of unencrypted passwords to third-party **Service Message
    Block** (**SMB**) servers.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Only allow **NTLMv2** on **LAN Manager** authentication level and refuse **LM**
    and **NTLM**.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configure **Microsoft Network Server** to always sign communications digitally.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure that **Anonymous SID/Name translation** is disabled.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Anonymous enumeration of SAM accounts and shares** should be disabled.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Do not allow shared drives to be accessed anonymously.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If available, enable cloud-based protection, such as **Microsoft Operations
    Management Suite** (**OMS**).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure encryption is enabled (**Encrypting File System** (**EFS**) or **BitLocker**).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If the server is hosting some **virtual machines** (**VMs**), make sure that
    **Virtual Machine Trusted Platform Module (TPM)** is enabled as it will support
    advanced security technologies such as **BitLocker drive encryption**.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Now, it's time to see how to create an enterprise patching strategy.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a patching strategy
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'How many times have you heard, "*This attack could be prevented if the systems
    were properly patched*"? And the cost of those attacks was between millions of
    dollars to even bankruptcy, so here, the question is: *Why is this still happening?*'
  prefs: []
  type: TYPE_NORMAL
- en: Well, the answer is because patching is not as simple as it sounds.
  prefs: []
  type: TYPE_NORMAL
- en: The complexity of patching
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let´s take a look at the most common complexity factors associated with patching.
  prefs: []
  type: TYPE_NORMAL
- en: Legacy systems
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Almost all companies have a degree of legacy systems in production. Most of
    the time, this is because some applications were designed to run only on a specific
    OS, and migrating it to a supported OS may cause compatibility issues, so companies
    decided just to accept the risk.
  prefs: []
  type: TYPE_NORMAL
- en: The problem is that in those cases, you may have some unsupported OSes (or even
    apps, services, and protocols) that bring additional risks to your infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: 'The recommendations to patch legacy systems are outlined here:'
  prefs: []
  type: TYPE_NORMAL
- en: Perform testing to determine whether is possible to migrate to a supported OS.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Research alternative systems that can replace said legacy apps.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the first two options are not achievable, then make sure that the system
    has the latest available updates (patches and hotfixes) installed.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Remove all unnecessary apps from the system.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Reduce the enabled ports to the minimum required by the app and disable the
    rest of them.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Disable all unused services.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Disable all unused startup apps.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Disable **Remote Desktop** (**RDP**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Avoid making these servers internet-facing, and if required, apply additional
    security mechanisms such as requiring a **virtual private network** (**VPN**)
    to connect.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Schedule regular maintenance (at least quarterly) to check the server status.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Additionally, it is a good practice to perform regular validation of your server
    environment (at least twice per year) to ensure which of them are still in use
    (and remove any *ghost* or *unused* servers).
  prefs: []
  type: TYPE_NORMAL
- en: Dependencies and compatibility issues
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Most apps have a lot of dependencies such as .NET Framework, the **Java Runtime
    Environment** (**JRE**), **PHP: Hypertext Preprocessor** (**PHP**), and so on,
    which means that to run those apps properly, you need to have those frameworks
    installed and running in the OS.'
  prefs: []
  type: TYPE_NORMAL
- en: Most of the time, those frameworks have **backward compatibility**, meaning
    they will also support apps created for old frameworks. However, this is not always
    true and there are cases in which you need to keep an old framework to keep your
    legacy app running.
  prefs: []
  type: TYPE_NORMAL
- en: 'In those cases, the following is recommended:'
  prefs: []
  type: TYPE_NORMAL
- en: Evaluate the possibility of newer apps to replace legacy ones.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Evaluate, document, and present the risks to upper management to consider whether
    they are willing to accept this risk.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Evaluate the data managed by said app and use that as input to determine the
    impact of the risk.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If there is a high risk involved, search for known vulnerabilities (related
    to that version of said dependency at [https://cve.mitre.org/](https://cve.mitre.org/)
    ) to determine and apply workarounds to reduce the risk of attacks.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Isolate the machine to just host said application to reduce the scope of the
    risk.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now, it's time to show you how to begin creating your patching strategy.
  prefs: []
  type: TYPE_NORMAL
- en: Distribution of tasks (patching roles and assignments)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In most companies, patching is performed by IT infrastructure teams. However,
    in terms of cybersecurity, you may be responsible for ensuring that all servers
    are properly patched, so here are some recommendations to ensure a smooth operation
    between you and the infrastructure team:'
  prefs: []
  type: TYPE_NORMAL
- en: Work together in the creation of a patching chronogram.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create an *RACI matrix* to determine who is *responsible, accountable, consulted,
    and informed* about the installation and deployment of updates on the servers.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Establish a process to request urgent patches and hotfixes.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create a communications plan that includes contact information for the whole
    IT team.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Create a responsibility matrix that includes all relevant information about
    the servers and the teams that support them. You can see an example of a responsibility
    matrix in the following screenshot:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Figure 6.5 – OS support responsibility matrix'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.5_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.5 – OS support responsibility matrix
  prefs: []
  type: TYPE_NORMAL
- en: The preceding OS support responsibility matrix has five columns; however, you
    may extend it as required to include all relevant information.
  prefs: []
  type: TYPE_NORMAL
- en: Also, make sure to define who is responsible for updating those documents, where
    they will be stored, and how often they must be updated.
  prefs: []
  type: TYPE_NORMAL
- en: Distribution and deployment of patches
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: On small infrastructures, this may be a straightforward task, but when you have
    several farms of servers with thousands of servers running a plurality of OSes,
    then this becomes very complex.
  prefs: []
  type: TYPE_NORMAL
- en: 'While this task will be normally performed by the platform team, it''s key
    that you understand how it works for the following reasons:'
  prefs: []
  type: TYPE_NORMAL
- en: There will be cases where you will have to be in charge of managing the updates.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This knowledge will allow you to better adjust your defensive strategy accordingly.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Now, let's take a look at how updates can be deployed.
  prefs: []
  type: TYPE_NORMAL
- en: Windows Server Update Services
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Windows Server Update Services** (**WSUS**) enables you to manage and distribute
    the latest Microsoft product updates through a management console.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Basically, the WSUS server will enable you to do the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Centralize update management
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Update management automation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You can see an overview of the different server roles available in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.6 – Installing WSUS as a Windows server role'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.6_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.6 – Installing WSUS as a Windows server role
  prefs: []
  type: TYPE_NORMAL
- en: As seen in the preceding screenshot, WSUS is a built-in server role. An interesting
    fact is that you can have as many WSUS servers as you want in your infrastructure,
    but at least one needs to connect to **Microsoft Update** to get available update
    information (this is called the **upstream server**).
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs: []
  type: TYPE_NORMAL
- en: Keep in mind that there are many other alternative *patch management tools*
    provided by third parties, such as **SolarWinds Patch Manager**, **AutoPatcher**,
    **Kaseya VSA**, **ManageEngine Patch Connect Plus**, **Ivanti PatchLink**, and
    more.
  prefs: []
  type: TYPE_NORMAL
- en: 'WSUS has two main interfaces, a **command-line interface** (**CLI**) through
    PowerShell, and a built-in visual interface, as seen in the following screenshot,
    that provides a lot of information about the updates to be deployed in your infrastructure,
    the classification of those updates, and more:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.7 – WSUS graphical user interface (GUI)'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.7_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.7 – WSUS graphical user interface (GUI)
  prefs: []
  type: TYPE_NORMAL
- en: Now, deploying the updates is not as easy as just doing a single click. In fact,
    to avoid disruption, companies have a set of rules aimed to avoid the risk of
    disrupting some services during patching. This process is called **change management**.
  prefs: []
  type: TYPE_NORMAL
- en: Change management process
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Big corporations cannot risk their businesses suffering because a failed installation
    of a patch crashed a server, causing millions of dollars in losses. Instead, they
    have a well-organized *change management process* that specifies when a server
    can be accessed for maintenance.
  prefs: []
  type: TYPE_NORMAL
- en: Depending on the company, those *maintenance windows* can be done monthly or
    quarterly, and they are normally planned to be executed on a *time-boxed* period
    that includes a **time-to-recovery** (**TTR**) window to restore the systems back
    to their original state in the case of issues.
  prefs: []
  type: TYPE_NORMAL
- en: OS updates are normally installed during these maintenance windows, so it's
    critical that you become familiar with the change management process to ensure
    that critical updates are installed on the upcoming maintenance window.
  prefs: []
  type: TYPE_NORMAL
- en: Types of patches
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let's review the different types of updates available for Windows-based systems.
  prefs: []
  type: TYPE_NORMAL
- en: Take into consideration that to help you prioritize the deployment, they include
    a categorization based on importance (from a cybersecurity point of view).
  prefs: []
  type: TYPE_NORMAL
- en: 'The categories are **Critical** (meaning they must be installed ASAP), **Required**
    (must be prioritized on the upcoming patching window), and **Minor** (optional
    updates). These updates are explained in more detail here:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Update**: A fix to a specific problem that is considered non-critical, such
    as a non-security-related bug. Since a lack of this update will not impact the
    performance or security of the server, these updates are considered of *minor*
    importance.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Critical update**: This aims to fix a specific *non-security-related* bug.
    Normally, this is released to a wide audience of users. Even if this is not security-related,
    it may fix some issues related to performance and stability, and therefore this
    should be considered *critical*.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Definition update**: This is normally a software update that contains additions
    to a product''s definition database. As seen in the following screenshot, these
    definition databases are often to prevent attacks resulting from malicious code,
    phishing websites, or junk mail:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Figure 6.8 – Windows definition updates'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.8_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.8 – Windows definition updates
  prefs: []
  type: TYPE_NORMAL
- en: Since some of them could prevent some known security attack vectors, they are
    considered a *critical* update.
  prefs: []
  type: TYPE_NORMAL
- en: '**Security update**: This update aims to fix a product-specific, security-related
    vulnerability.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Normally, those vulnerabilities are rated by their severity as critical, important,
    moderate, or low, as indicated in the Microsoft security bulletin.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Windows security updates come with two important documents that give a lot of
    information about the vulnerability. They are the *security bulletin* and a *Microsoft
    Knowledge Base article*, and they provide very useful insights about the vulnerability
    being fixed.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Driver**: Sometimes, Windows provides updates to its catalog of built-in
    drivers (basic drivers) to improve or fix some functionalities. As seen in the
    following screenshot, sometimes these updates are considered by the OS as optional
    drivers as they may not apply to all users:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Figure 6.9 – Windows driver updates'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.9_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.9 – Windows driver updates
  prefs: []
  type: TYPE_NORMAL
- en: Considering that a lack of this update will not jeopardize the integrity or
    current functionalities of the systems, they are considered *minor*.
  prefs: []
  type: TYPE_NORMAL
- en: '**Feature pack**: *New product functionality* that is distributed to users
    before the upcoming full product release. Since these updates are related to *new
    functionality* and not to prevent or fix a given issue or bug, they are considered
    *minor* updates.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Here is a screenshot of **Feature Updates** on Windows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Figure 6.10 – Windows feature updates'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.10_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.10 – Windows feature updates
  prefs: []
  type: TYPE_NORMAL
- en: As seen in the preceding screenshot, when **Feature Updates** is installed,
    there will be a link where you can see details of the new features included on
    that update.
  prefs: []
  type: TYPE_NORMAL
- en: '**Service pack**: Microsoft does a very good job of releasing updates for its
    systems, but that means that over time, there could be a lot of updates available
    for a given OS. Therefore, once there are a certain number of tested hotfixes,
    updates, security updates, and critical updates, they are packed into a service
    pack.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Service packs may also contain other updates, including customer-requested design
    changes or features.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Service packs are a major update of the OS, so it is highly recommended to test
    it first on a testing environment before massively deploying them into production
    servers.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Since they include critical updates for OS stability and security, they are
    considered *critical* updates.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Update rollup/monthly rollup**: A collection of hotfixes, security updates,
    critical updates, and updates that are packaged together for easy deployment.
    This is basically a smaller version of a service pack. The update rollup is normally
    a compilation based on the same feature, while the monthly rollup is based on
    the month when the updates were released. Since they include critical updates
    for OS stability and security, they are considered critical.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Now you have mastered everything there is to know about Windows updates, it
    is time to move to the next topic to learn more about *how to secure AD*.
  prefs: []
  type: TYPE_NORMAL
- en: Applying security to AD
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'While there is not an official guideline or standard for securing AD, here
    is a compilation of the *industry best practices* that you can leverage to enhance
    the security of your AD servers:'
  prefs: []
  type: TYPE_NORMAL
- en: Never install additional software, roles, or services on domain controllers.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Never create local users on domain controllers (user management must be carefully
    handled on domain controllers).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Make sure accounts are created based on PoLP.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Maintain a record (list) of AD privilege accounts that includes owners, rights,
    and other relevant data about the account (to prevent ghost accounts).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Ghost account** is a term used for accounts in which the ownership or usage
    is unclear. While this may not be an issue on small infrastructures, it can become
    a huge problem in big environments in which best practices are not followed and
    you may have dozens of those accounts, which represents a significant risk to
    your infrastructure.'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: AD privilege accounts should not be used to log in to workstations (this increases
    the risk of the account being compromised).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Avoid keeping AD privilege accounts as disabled (the best practice is to remove
    privilege accounts if they are not in use).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All logs should be enabled.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installation of security updates must be prioritized on domain servers.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: As mentioned earlier, the latest version of Windows Server normally contains
    a new set of security features, so when possible, use the latest version of Windows
    Server to host the domain controller.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable **multi-factor authentication** (**MFA**) when possible.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Perform regular reviews (audits) of AD privilege accounts.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: You must ensure you especially protect the three built-in groups in AD that
    possess the highest privilege groups in the directory (enterprise admins, domain
    admins, and administrators).
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Perform regular backups.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure **high availability** (**HA**) by configuring failover clustering. You
    can read more on this at [https://docs.microsoft.com/en-us/windows-server/failover-clustering/failover-clustering-overview](https://docs.microsoft.com/en-us/windows-server/failover-clustering/failover-clustering-overview).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Avoid permanent membership in highly privileged groups. Instead, grant temporary
    membership only when needed.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: When *creating custom groups*, make sure you label them with specific, self-explanatory
    names—for example, *IT-Helpdesk* instead of *Group-x031*.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'SMB version 1 must be disabled. This can be disabled using the Windows Registry
    or, as seen in the following screenshot, this can also be disabled/verified using
    the GUI for turning on/off Windows features:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Figure 6.11 – Windows Features'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.11_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.11 – Windows Features
  prefs: []
  type: TYPE_NORMAL
- en: Additionally, most organizations need to perform administrative tasks on AD
    but from another computer—for example, IT support people doing password resets,
    or network admins doing **Domain Name System** (**DNS**) changes.
  prefs: []
  type: TYPE_NORMAL
- en: These systems are known as **secure administrative hosts**, and we will now
    look at some security best practices that must be applied to them.
  prefs: []
  type: TYPE_NORMAL
- en: Secure administrative hosts
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As mentioned, **secure administrative hosts** are systems (workstations or servers)
    from which privileged accounts can perform administrative tasks in AD.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are some best practices about how you can configure them as a secure platform:'
  prefs: []
  type: TYPE_NORMAL
- en: Enable MFA in those systems.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Review the physical security of those systems to ensure they are in a secure
    zone.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Restrict permissions and prevent the installation of any additional software.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Avoid the installation and usage of email on those systems.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Microsoft even recommends avoiding the installation of Office on these systems.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: They *must* run supported and fully patched OSes.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Universal Serial Bus** (**USB**) ports should be disabled.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: When possible, media readers (**Digital Video Disc** (**DVD**), **Standard Definition**
    (**SD**), and so on) must be removed or disconnected.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Autorun must be disabled.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Make sure that the security features of the secure administrative hosts are
    equal to the domain controller.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Internet browsing must be disabled.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Also, when possible, use VMs as secure administrative hosts. First, they can
    be easily turned off when not in use, and secondly, you can configure them to
    reset to a default snapshot after each use to keep the system clean.
  prefs: []
  type: TYPE_NORMAL
- en: Windows Server Security documentation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Here, you can find additional documentation (including videos) about the several
    layers of protection built into the OS to keep the servers protected against security
    breaches and malicious attacks, and to overall keep the data and infrastructure
    secure: https://docs.microsoft.com/en-us/windows-server/security/security-and-assurance.'
  prefs: []
  type: TYPE_NORMAL
- en: Now that you have learned everything there is to know about **Windows Server
    Security**, it's time to start learning about how to enhance the security of all
    your **Windows workstations** in your infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: Mastering endpoint security
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Most of the best practices that we reviewed for servers are also applicable
    to workstations, so instead of repeating them, let's review some additional security
    mechanisms and tools that are specifically applicable to workstations.
  prefs: []
  type: TYPE_NORMAL
- en: Windows updates
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We already talked about the importance of patching the OS; however, I want
    to highlight that you can leverage WSUS to distribute updates to your workstations.
    Here is a great step-by-step guide created by Microsoft that shows you how to
    configure it: [https://docs.microsoft.com/en-us/windows/deployment/update/waas-manage-updates-wsus](https://docs.microsoft.com/en-us/windows/deployment/update/waas-manage-updates-wsus).'
  prefs: []
  type: TYPE_NORMAL
- en: Why move to Windows 10?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As mentioned, there are many reasons to keep your systems running the latest
    versions of the OS, but here, we are going to highlight some additional aspects
    to consider about why it would be a good idea to migrate to Windows 10.
  prefs: []
  type: TYPE_NORMAL
- en: Windows as a service
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In the past, Microsoft released new versions of Windows every few years, which
    represented some challenges for IT professionals in terms of planning and deployment.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, the new Windows 10 was created based on a concept called Windows as a
    service, which means that instead of creating a new version of Windows (Windows
    11), Microsoft will just keep providing upgrades to Windows 10 through two release
    types: **Feature Updates**, which add new functionality twice per year, and **Quality
    Updates**, which provide security and reliability fixes at least once a month.'
  prefs: []
  type: TYPE_NORMAL
- en: So, with this new approach, Microsoft plans to simplify the lives of IT pros
    and maintain a consistent Windows 10 experience for its customers while ensuring
    their systems have the latest security features and updates.
  prefs: []
  type: TYPE_NORMAL
- en: For additional information about this new model, please visit the official site
    at [https://docs.microsoft.com/en-us/windows/deployment/update/waas-overview](https://docs.microsoft.com/en-us/windows/deployment/update/waas-overview).
  prefs: []
  type: TYPE_NORMAL
- en: Windows 10 security options
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: There are many *security policy settings* that allow you to configure the behavior
    of a Windows 10 machine. They can be either configured locally or in a **Group
    Policy Object** (**GPO**) to all devices that are subject to that GPO.
  prefs: []
  type: TYPE_NORMAL
- en: 'It is key that you become familiar with those policy settings and adjust them
    based on the organizational security policies. Here, you can find a list of all
    security policy settings that includes a brief description and also the recommended
    settings: [https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/security-options](https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/security-options).'
  prefs: []
  type: TYPE_NORMAL
- en: Physical security
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Physical security is one of the most important aspects of endpoint security,
    so here, we will take a look at some minimal recommendations that you need to
    enforce to ensure you keep your systems safe and secure.
  prefs: []
  type: TYPE_NORMAL
- en: As mentioned in [*Chapter 2*](B16290_02_Final_JC_ePub.xhtml#_idTextAnchor035),
    *Managing Threats, Vulnerabilities, and Risks*, there are a lot of vulnerabilities
    related to USB ports that are currently present on most computers as they leverage
    the inherited trust that a computer has on **Human Interface Devices** (**HID**)
    devices (keyboard and mouse). Therefore, we need to ensure that *USB ports are
    not physically reachable to external users (mostly for users who are in customer
    service roles or any other client-facing role)*.
  prefs: []
  type: TYPE_NORMAL
- en: Additionally, you must put in place a plurality of mechanisms to prevent the
    robbery of computers, and we will review them in depth in [*Chapter 9*](B16290_09_Final_JC_ePub.xhtml#_idTextAnchor213),
    *Deep Diving into Physical Security*.
  prefs: []
  type: TYPE_NORMAL
- en: Antivirus solutions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'This is a basic cybersecurity component that you already know about, so there
    is no need to spend much time on this section. Instead, let''s just summarize
    some rules about the use of antivirus solutions, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Use the same antivirus solution across the organization.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Prevent the installation of additional antivirus solutions (using technical
    and administrative controls).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Prevent the disabling or uninstallation of corporate antivirus solutions. When
    possible, this action should flag an alert to the IT security team and management
    (this works as a very good dissuasive component).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Consider Windows Defender as a great corporate antivirus solution.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Keep automatic updates always on (the only exception is when you manage the
    deployment of updates using an internal server).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Administrative controls are all those controls based on rules, policies, and
    regulations. Normally, they are enforced through audits, penalties, or **human
    resources** (**HR**) actions. On the other hand, technical controls are all those
    controls that you can track and enforce by using technology components, such as
    **intrusion prevention systems** (**IPS**), **intrusion detection systems** (**IDS**),
    firewalls, and antivirus solutions.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Keep in mind that there is no perfect antivirus solution. I think that over
    time, you will have your own preferences, which can also be based on need; for
    example, you may like one antivirus solution for your personal use but may have
    a different preference for corporate use (because of advanced tools such as deployment
    options, alerts, and the admin console).
  prefs: []
  type: TYPE_NORMAL
- en: Windows Defender Firewall
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Having **Windows Defender Firewall** on is a good idea as it serves as an additional
    layer of security. As mentioned with antivirus solutions, you must put in some
    administrative and technical controls to prevent and detect whether someone disables
    it.
  prefs: []
  type: TYPE_NORMAL
- en: As you can see in the following screenshot, you can configure the firewall locally
    on each workstation or manage it via **Group Policy**. Additionally, you can also
    see how it has several profiles depending on the network connected.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.12 – Windows Firewall configuration'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.12_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.12 – Windows Firewall configuration
  prefs: []
  type: TYPE_NORMAL
- en: Another common issue is that when there are network issues, the IT helpdesk
    could disable the Windows Defender Firewall as a temporary fix; however, you need
    to create a policy with them to prevent that practice and instead encourage them
    to perform a **root cause analysis** (**RCA**) to determine the real cause of
    the issue without impacting the security of the device.
  prefs: []
  type: TYPE_NORMAL
- en: Application control
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Here, you may face two possibilities: you either remove user permissions to
    install apps or implement technical controls to monitor the apps installed by
    the user. Both options have their pros and cons—for example, restricting user
    permissions may be the easiest way for you from the security side; however, that
    will significantly impact the number of helpdesk tickets related to users needing
    access to install an application (due to business needs). On the other side, if
    you grant admin rights to all users, you will have a higher risk in terms of security
    that you must mitigate by implementing additional security controls.'
  prefs: []
  type: TYPE_NORMAL
- en: URL filtering
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You can apply **Uniform Resource Locator** (**URL**) filtering to prevent users
    from accessing dangerous sites or sites that may impact your network bandwidth.
    Even if this sounds like a joke, a lot of employees access streaming sites or
    apps to watch movies *when connected to the corporate network*, so this also needs
    to be prevented because first, most free streaming sites are full of malware but
    also, that may impact the availability and bandwidth of your network.
  prefs: []
  type: TYPE_NORMAL
- en: Spam filtering
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I know this is super basic, but since this is also super important, please remember
    that besides being configured on the email server, you can also add an extra security
    layer by using the spam filter that is included on most email clients.
  prefs: []
  type: TYPE_NORMAL
- en: Also, you can create some rules to prevent some other email attacks. For example,
    as seen in the following screenshot, you can configure your email to automatically
    tag external emails (for example, by adding the word **EXTERNAL** to the email
    title). This simple action will prevent spoofing and phishing attacks.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.13 – Automatic tagging of external emails'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.13_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.13 – Automatic tagging of external emails
  prefs: []
  type: TYPE_NORMAL
- en: For example, you can easily do this by creating a rule in Office 365 or the
    exchange server. Where you just need to create a new rule, select to apply that
    to all emails from outside the organization, select to whom it should be applied,
    select the action (in this case, **Apply disclaimer to the message**), and you
    are done! Trust me—those very simple steps will save you a lot of headaches.
  prefs: []
  type: TYPE_NORMAL
- en: Client-facing systems
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Depending on your business, you may have systems that will be accessed by external
    users (for example, a computer for users to do some self-service operation). Those
    systems must be isolated from your network (if possible, with their own internet
    connection). But also, they must be secure to protect your customers from attacks.
    Here, the best recommendation is to install software that restores the system
    to an initial state after it is rebooted (such as Deep Freeze). To increase the
    level of security (for example, in financial institutions), you can perform rollback
    after each user uses the system.
  prefs: []
  type: TYPE_NORMAL
- en: Also, the case (depending on the country, they can be named **CPU**, tower,
    and so on) of these computers must be isolated from the user, and just the keyboard,
    screen, and mouse should be accessible to users (to prevent the connection of
    dangerous devices such as keyloggers).
  prefs: []
  type: TYPE_NORMAL
- en: Backups
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You must ensure that users are provided with a backup solution that is preinstalled
    and configured in all workstations.
  prefs: []
  type: TYPE_NORMAL
- en: Also, you need to make sure to create at least a yearly campaign to educate
    users about the importance of backups, the tools available, and the tools that
    are not approved for use.
  prefs: []
  type: TYPE_NORMAL
- en: 'This is extremely important for two reasons: first, you need to make sure all
    users have a backup solution available to keep a secure copy of their files in
    the case of disaster, but also, you must prevent users from using insecure mechanisms
    for backups—for example, non-approved cloud solutions or external USB drives.'
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs: []
  type: TYPE_NORMAL
- en: 'It does not matter if you did several awareness campaigns—rest assured that
    if someone loses their data (because of not having a backup), you will be the
    first to be blamed. So, to prevent this kind of situation, you must ensure that
    the backup policy states: *Performing periodical backups and testing them is a
    user responsibility*. You can also mention: *in the case of errors, it is the
    user''s responsibility to report that to the IT security department by using the
    official (predetermined) channel*.'
  prefs: []
  type: TYPE_NORMAL
- en: Users
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We dedicated all of [*Chapter 4*](B16290_04_Final_JC_ePub.xhtml#_idTextAnchor092),
    *Patching Layer 8,* to talking about users; however, there are some extra steps
    that we need to consider related to some vulnerabilities that may be introduced
    by users, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Users'' personal devices**: You need to implement the necessary technical
    and administrative controls to prevent the connection of users'' personal devices
    (including **Internet of Things** (**IoT**) devices) to your corporate network.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Peripherals**: Any additional device connected to your infrastructure represents
    an additional risk, so to prevent those risks, you must restrict the use of personal
    peripherals on corporate endpoints. From printers to USB keyboards, both can represent
    a security vulnerability, and therefore their usage and installation in a corporate
    environment must be limited. This can be achieved by a clear user policy, plus
    some technical controls, to prevent or alert in the case of the installation of
    personal peripherals.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Securing the data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A stolen laptop can be easily replaced; however, the exposure of sensitive corporate
    information, such as intellectual capital or trade secrets, may be fatal for a
    company and, in some cases, may lead to bankruptcy. Therefore, securing the data
    should be your priority, and encrypting your data is a great way to do it.
  prefs: []
  type: TYPE_NORMAL
- en: Leveraging encryption
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'As a first step, you need to understand the applicable regulations and laws
    to determine whether some specific encryption requirements apply to your organization
    (or a part of it). For example, the following screenshot shows the different encryption
    requirements between the **Payment Card Industry Data Security Standard** (**PCI
    DSS**) and the **Health Insurance Portability and Accountability Act** (**HIPAA**):'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.14 – PCI and HIPAA encryption requirements'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.14_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.14 – PCI and HIPAA encryption requirements
  prefs: []
  type: TYPE_NORMAL
- en: 'However, you should not create your encryption policy based only on compliance
    requirements. Instead, you should create a *robust encryption policy* based on
    the following considerations:'
  prefs: []
  type: TYPE_NORMAL
- en: Implement full disk encryption (for example, BitLocker).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Implement email encryption.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Implement file-level encryption (for sensitive data).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Encrypt backups.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create awareness campaigns to show the importance of encryption and why it must
    be applied at all levels (data at rest, in transit, and so on).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Require encryption as part of the requirements in your **bring your own device**
    (**BYOD**) policy.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Encrypt data in transit by implementing a VPN.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Make sure you implement **Secure Sockets Layer** (**SSL**) on your web pages
    to encrypt data.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure that your communication tools (including corporate chat) enable **peer-to-peer**
    (**P2P**) encryption.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Implement a key management solution (such as **Azure Key Vault**) to safeguard
    cryptographic keys and secrets that cloud applications and services use.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows-based systems have a built-in option to encrypt the hard drive. Additionally,
    advanced versions of Windows 10 came with a tool called **BitLocker** to configure
    encryption settings (including full drive encryption).
  prefs: []
  type: TYPE_NORMAL
- en: Configuring BitLocker
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To enable it, just type `Manage BitLocker` in the Windows search box of the
    start up menu to access the management console, in which you can turn **Windows
    BitLocker** on or off.
  prefs: []
  type: TYPE_NORMAL
- en: Some versions of Windows (such as the Home version) may not have **Windows BitLocker**;
    instead, they will have a simplified system for device encryption. To enable this,
    you need to go to **Start** | **Settings** | **Update & Security** | **Device
    encryption**. If this is not listed there, it means that device encryption is
    unavailable on that version of Windows.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we learned about the best practices and strategies for Windows
    servers and also when to apply them. After that, you learned how to create a hardening
    checklist for Window Server, which will be of great value for us and the teams
    in charge of server management.
  prefs: []
  type: TYPE_NORMAL
- en: Additionally, we reviewed all different types of patches for Windows systems
    and their importance in terms of cybersecurity. Then, you learned how to create
    a patching strategy to keep your infrastructure safe. We also reviewed a great
    collection of best practices to keep your AD secure.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, we looked at the most important practices to keep your Windows workstations
    secure, including how to leverage encryption to increase the level of security
    of your overall infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: Now that you have become a master in all aspects of Windows security, it's time
    to understand everything there is to know about hardening Unix servers, which
    will be covered in the next chapter.
  prefs: []
  type: TYPE_NORMAL
