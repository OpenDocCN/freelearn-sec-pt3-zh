<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Windows Shadow Copies Analysis</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will cover the following recipes:</p>
<ul>
<li><span>Browsing and copying files from VSCs on a live system with ShadowCopyView</span></li>
<li><span>Mounting VSCs from disk images with VSSADMIN and MKLINK</span></li>
<li><span>Processing and analyzing VSC data with Magnet AXIOM</span></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p>Shadow copies, also known as volume shadow copies, are backup copies of Windows files that are taken during the normal course of use of a machine running on NTFS. For the average computer user, shadow copies may be familiar, as they are what make it possible to create Windows backups, or to perform system restores when something goes wrong.</p>
<p>These have obvious applications for digital forensic practitioners, particularly in cases where a suspect may have tried to delete evidence from a machine. By restoring the system to its previous state, or by using forensic tools to uncover files that are saved in shadow copy locations, forensic practitioners may be able to deduce information that an individual has tried to hide.</p>
<p>However, the presence of shadow copies and the ability forensic investigators have to uncover the information contained within them does not necessarily mean that useful information will be obtained. Many files will simply contain information that is irrelevant to the case. Even when shadow copies of useful files are restored, the version the investigator can see is only a snapshot of the file. In other words, the forensic analyst will only be able to see a single version of a file, rather than any changes that may have been made. Shadow copies are frequently overwritten by the system, and it is possible in most versions of Windows to turn off the ability to create them, which means they are not a failsafe fallback option. Having said that, the ability to locate, restore, and comprehend the data contained within volume shadow copies is an important part of a digital forensic investigator's toolkit. In this chapter, we will demonstrate a few methods that will help you get to grips with shadow copies analysis.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Browsing and copying files from VSCs on a live system with ShadowCopyView</h1>
                </header>
            
            <article>
                
<p><span>ShadowCopyView is a simple tool developed by <strong>NirSoft</strong> (remember this name! They have developed lots of small free tools which are extremely useful for computer forensics), which enables digital forensic examiners to browse snapshots created by the Windows Volume Shadow Copy Service. It supports even the most recent Windows versions (Windows 10, for example), and can be kept on your favorite USB drive, which is very important for live forensics and incident response.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Go to NirSoft's website and click on the <span class="packt_screen">All Utilities</span> link on the left. Scroll down the page, find the <span><strong>ShadowCopyView</strong> link, and click it. At the time of writing, the most recent version of the tool is 1.05. Scroll down and you will find two download links: 32-bit and 64-bit versions. We recommend that you download both, and use them depending on the target system. Unpack the archives you downloaded to your flash drive, and you are ready to go.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>Connect your flash drive to the target system. In our case, it's Windows 7 x64, so we will use the 64-bit version of ShadowCopyView. The tool detects available VSCs automatically. In our case we have three VSCs available, as you can see in the following figure:</p>
<div class="CDPAlignCenter CDPAlign"><img height="408" width="548" class="image-border" src="assets/a7e0e87f-ab65-4031-9f52-3fef447ed5ac.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 5.1. Volume Shadow Copies detected by ShadowCopyView</div>
<p class="CDPAlignLeft CDPAlign">The main window of the tool consists of two panes. The first pane displays information about detected shadow copies, including name, <span class="packt_screen">Explorer path</span>, <span class="packt_screen">Volume path</span>, <span class="packt_screen">Created Time</span>, and so on. The <span class="packt_screen">Explorer path</span> means you can browse shadow copies in Windows Explorer.</p>
<ol>
<li>Right-click on the VSC you want to browse in Explorer and choose <span class="packt_screen">Open In Windows Explorer,</span> or just press <span class="packt_screen">F2</span>. Now it's open in Windows Explorer, as you can see in the following figure:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/9abb53d4-92eb-485d-9463-422e792ef41d.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 5.2. A Volume Shadow Copy opened in Windows Explorer</div>
<p style="padding-left: 60px">Now, let's get back to <span>ShadowCopyView. The second pane enables you to browse available shadow copies. Using this pane, you can export both files and folders.</span></p>
<ol start="2">
<li>All you need to do is to right-click a file or a folder, and select the <span class="packt_screen">Copy Selected Files To...</span> option or just press <span class="packt_screen">F8</span>.</li>
<li>There are some other useful options you can use. For example, if you prefer timestamps in the UTC (Coordinated Universal Time) time standard, you can use the <strong>GMT</strong> (<strong>Greenwich Mean Time</strong>) time zone. To do this, go to the <span class="packt_screen">Options</span> menu and select <span class="packt_screen">Show Time In GMT</span>.</li>
</ol>
<div class="packt_infobox"><span>UTC or Coordinated Universal Time is the primary standard by which the world regulates clocks and time. For example, most parts of European Russia use UTC +3 hours.</span></div>
<ol start="4">
<li>Also, if you want to see the whole properties list of a shadow copy, you can right-click it and choose the <span class="packt_screen">Properties</span> option, or just press <em>Alt</em> + <em>Enter</em>. Now you see all the properties in one window, as in the following figure:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="361" width="481" class="image-border" src="assets/aa74b742-626e-4616-9c21-2488e3c8fb44.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 5.3. A Volume Shadow Copy's properties</div>
<p style="padding-left: 90px" class="CDPAlignLeft CDPAlign">And the last very useful feature we want to tell you about is keyword searching.</p>
<ol start="5">
<li>Go to <strong><span class="packt_screen">Edit - Find</span></strong>, or just press <em>Ctrl</em> + <em>F</em>, and you will see the <span class="packt_screen">Find</span> window, as in the following figure:</li>
</ol>
<div class="packt_figref CDPAlignCenter CDPAlign"><img height="111" width="300" class="image-border" src="assets/6a008b3a-640b-465f-ab4d-c613318459b4.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 5.4. <span>ShadowCopyView Find window</span></div>
<ol start="6">
<li>As you can see, you also have two options to tick. Tick the first one if hits must include the whole word only, tick the second if it is important that results are returned in uppercase or lowercase letters.</li>
</ol>
<p> </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p><span>ShadowCopyView detects available Volume Shadow Copies, enabling a computer forensic examiner to browse them both via the tool and Windows Explorer, and also allows them to search for and export files and folders.</span></p>
<p> </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>The NirSoft website: <a href="http://www.nirsoft.net/">http://www.nirsoft.net/</a></p>
<p><span>The ShadowCopyView download page:</span> <a href="http://www.nirsoft.net/utils/shadow_copy_view.html">http://www.nirsoft.net/utils/shadow_copy_view.html</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Mounting VSCs from disk images with VSSADMIN and MKLINK</h1>
                </header>
            
            <article>
                
<p>VSSADMIN is a built-in Windows command-line tool capable of displaying Volume Shadow Copies. You can use it not only on a running Windows system, but also on disk images. In this recipe, we will show you how to do it.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>As the tool we are going to use is built-in, there is no need for installation: if you are using Windows, you already have it. So all you need is to mount a forensic image, and you already know how to do this from <a href="cdc042a6-a9ed-423a-96da-96e6d7767d8e.xhtml" target="_blank">Chapter 3</a>, <em>Windows Drive Acquisition</em>. As soon as the image is mounted, you are ready to go.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>The steps to mount VSCs from disk images using VSSADMIN and MKLINK are as follows:</p>
<ol>
<li>Start Windows Command Prompt (don't forget to run it as Administrator). In our case, the boot partition is mounted as <kbd>G:\ drive</kbd>, so we use the following command:</li>
</ol>
<pre style="padding-left: 60px">
<strong>vssadmin list shadows /for=G:\</strong>
</pre>
<div class="CDPAlignCenter CDPAlign"><img height="210" width="563" class="image-border" src="assets/6e8b801e-fcfc-4f17-a575-27608839f43d.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 5.5. vssadmin list shadows /for=G:\ command output</div>
<p style="padding-left: 60px" class="CDPAlignLeft CDPAlign">As you can see in the preceding figure, our forensic image contains a shadow copy.</p>
<ol start="2">
<li>The most important part of its properties for us is <strong>Shadow Copy Volume</strong>, in our case it's <kbd>\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy7</kbd>. Now we are ready to use MKLINK to mount the shadow copy we found. Use the following command:</li>
</ol>
<pre style="padding-left: 60px">
<strong>mklink /D C:\VSC \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy7</strong>
</pre>
<div class="packt_figref CDPAlignCenter CDPAlign"><img class="image-border" src="assets/5a241b81-44d5-48b5-8cad-08237163afe3.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 5.6. mklink /D C:\VSC \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy7 command output</div>
<p style="padding-left: 60px" class="CDPAlignLeft CDPAlign">MKLINK creates a folder (you should choose its name and location, and type it in as part of the command) and mounts the shadow copy to it, so you can browse it like a normal folder. Don't forget the <strong>/D</strong> switch — we need it to create a directory symbolic link, not a file.</p>
<ol start="3">
<li>There is another way to use Windows Explorer for VSC browsing. We need to get a VSC path in the following format <kbd>\\localhost\G$\@GMT-2016.12.28-20.00.30</kbd></li>
</ol>
<p style="padding-left: 60px">The first part of the path, <kbd>\\localhost\</kbd><span>, will be always the same. The next part depends on the drive letter of the boot partition. As you will remember, in our case it's</span> <kbd>G:\</kbd><span>, so in the path it is</span> <kbd>G$</kbd><span>. F</span><span>or example, if you have</span> <kbd>H:\</kbd><span>, it's</span> <kbd>H$</kbd><span>, and so on. The last part is based on the VSC's creation time. You can get it from the VSSADMIN output, but it must be converted into GMT. Now just type it as a path in Windows Explorer, and the shadow copy will be available for examination, as in</span> the following figure:</p>
<div class="packt_figref CDPAlignCenter CDPAlign"><img height="369" width="547" class="image-border" src="assets/2ee34c69-6be4-4c12-9a5e-81be1d03a659.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>Figure 5.7. A Volume Shadow Copy opened in Windows Explorer</span></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p class="CDPAlignLeft CDPAlign">VSSADMIN displays available Volume Shadow Copies on a mounted forensic image. <span>MKLINK creates a symbolic link to the shadow copy, so a digital forensic examiner can browse it in Windows Explorer.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p class="CDPAlignLeft CDPAlign">The VSSADMIN page at Misrosoft TechNet: <a href="https://technet.microsoft.com/en-us/library/cc754968(v=ws.11).aspx">https://technet.microsoft.com/en-us/library/cc754968(v=ws.11).aspx</a></p>
<p><span>The MKLINK page at Microsoft TechNet:</span> <a href="https://technet.microsoft.com/en-us/library/cc753194(v=ws.11).aspx">https://technet.microsoft.com/en-us/library/cc753194(v=ws.11).aspx</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Processing and analyzing VSC data with Magnet AXIOM</h1>
                </header>
            
            <article>
                
<p>Magnet AXIOM is an all-in-one digital forensics tool by Magnet Forensics, capable of extracting (acquiring) and processing data from both computers and mobile devices. It supports lots of Windows forensic artifacts, including extracting data from Windows Volume Shadow Copies.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>At the time of writing, Magnet Forensics provides a fully functional 30-day free trial version of Magnet AXIOM. All you need to do is go to Magnet Forensics' website and click on the <span class="packt_screen">TRY NOW</span> button. Fill in the form, including your first name, last name, email address, phone number, state or province, country, and so on and click on <span class="packt_screen">REQUEST A FREE TRIAL</span>. Make sure you type your real email: your trial key and download link will be sent to this address. Once you get it, download the installer and follow its instructions. You are ready to go!</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>The steps to process and analyze data using Magnet AXIOM are as follows:</p>
<ol>
<li>Start the Magnet AXIOM Process.</li>
<li>The first window you will see is <span class="packt_screen">CASE DETAILS</span>, as you can see in the following figure:</li>
</ol>
<p><img class="image-border" src="assets/5fc26f32-6c1e-4278-8491-dac07e3c3345.png"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 5.8. Magnet AXIOM CASE DETAILS window</div>
<p>Here, we have four main parts:</p>
<ul>
<li><span class="packt_screen">LOCATION FOR CASE FILES</span> - Here, you should choose the <span class="packt_screen">F</span><span class="packt_screen">older name</span> and <span class="packt_screen">F</span><span class="packt_screen">ile path</span> being created during processing.</li>
<li><span class="packt_screen">LOCATION FOR ACQUIRED EVIDENCE</span> - If you plan to acquire drives or mobile devices via AXIOM, choose the <span class="packt_screen">Folder name</span> and <span class="packt_screen">File path</span> for them, or just choose the same path as for case files.</li>
<li><span class="packt_screen">CASE INFORMATION</span> - Type in your case number, your name, and the case description.</li>
<li><span class="packt_screen">REPORT OPTIONS</span> - If you have your own logo or company logo, you can choose it by clicking <span class="packt_screen">BROWSE</span>. Make sure the image is square, because it will be resized to 150x150 pixels.</li>
</ul>
<ol start="3">
<li>Once you have filled in all the fields, you can click <span class="packt_screen">GO TO EVIDENCE SOURCES</span>. You can see the <span class="packt_screen">EVIDENCE SOURCES</span> window shown in the following figure:</li>
</ol>
<p><img class="image-border" src="assets/94548459-44b7-4e29-b453-fe10ab7e0fc7.png"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 5.9. <span>Magnet AXIOM EVIDENCE SOURCES window</span></div>
<p style="padding-left: 60px" class="mce-root">Here, we have two options: ACQUIRE EVIDENCE and LOAD EVIDENCE.</p>
<ol start="4">
<li>We are going to use an image we acquired previously, so our choice is the <span class="packt_screen">LOAD EVIDENCE</span> button. You can use one of the images you acquired in the previous recipes.</li>
</ol>
<ol start="5">
<li>The next window is <span class="packt_screen">LOAD EVIDENCE</span>, as you can see in the following figure:</li>
</ol>
<p class="CDPAlignCenter CDPAlign packt_figref CDPAlignLeft"><img class="image-border" src="assets/753e8d29-3fb2-4d2c-bc6c-a3677f281ff1.png"/></p>
<div class="CDPAlignCenter packt_figref CDPAlign"><span>Figure 5.10.</span> <span>Magnet AXIOM LOAD EVIDENCE window</span></div>
<ol start="6">
<li>Here, we have a VOLUME SHADOW COPY option - click it. Now we have two more options: <span class="packt_screen">DRIVE</span> <span>and</span> <span class="packt_screen">IMAGE</span><span>.</span></li>
</ol>
<ol start="7">
<li>As we noted earlier, we are going to use an image. Once you choose it, you can see the list of shadow copies available on the image, as in the following figure:</li>
</ol>
<div class="packt_figref CDPAlignCenter CDPAlign"><img class="image-border" src="assets/31533d54-2a8c-46c1-855f-e414832d1465.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 5.11. Volume Shadow Copies list</div>
<ol start="8">
<li>You can choose one or more shadow copies and go to processing details by clicking <span class="packt_screen">NEXT</span>. This time, we will skip this step and go straight to artifacts details (click the <span class="packt_screen">GO TO ARTIFACTS DETAILS</span> button).</li>
</ol>
<p style="padding-left: 60px">As we are working with a shadow copy, the MOBILE ARTIFACTS option is inactive, but we can use the COMPUTER ARTIFACTS option. As in Belkasoft Evidence Center, here we have a wide range of artifacts, as you can see in the following figure:</p>
<p class="packt_figref CDPAlignLeft CDPAlign"><img class="image-border" src="assets/937de1a6-0c90-438e-8f89-602626b1e0f5.png"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>Figure 5.12.</span> <span>Magnet AXIOM SELECT ARTIFACTS TO INCLUDE IN CASE window</span></div>
<ol start="9">
<li>For testing purposes, we have included all available artifacts in the case. Click the <span class="packt_screen">GO TO ANALYZE EVIDENCE</span> button, and the <span class="packt_screen">ANALYZE EVIDENCE</span> button right after that. This will start Magnet AXIOM Examine.</li>
<li>Once processing is finished, you will see the results in <span>Magnet AXIOM Examine.</span></li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Magnet AXIOM scans a drive or an image for available Volume Shadow Copies and uses them as its evidence source. After it has processed all available data in the chosen shadow copies, it extracts forensic artifacts according to the choices made by the examiner.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>The Magnet Forensics website: <a href="https://www.magnetforensics.com/">https://www.magnetforensics.com/</a></p>
<p>The Magnet AXIOM <span>free 30-day trial request page:</span> <a href="https://www.magnetforensics.com/try-magnet-axiom-free-30-days/">https://www.magnetforensics.com/try-magnet-axiom-free-30-days/</a></p>
<p>Belkasoft Evidence Center: <a href="https://belkasoft.com/ec" target="_blank">https://belkasoft.com/ec</a></p>


            </article>

            
        </section>
    </body></html>