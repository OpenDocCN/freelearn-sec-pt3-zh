<html><head></head><body>
		<div><h1 id="_idParaDest-357"><em class="italic"><a id="_idTextAnchor371"/>Chapter 16</em>: Practicing Forensics</h1>
			<p><em class="italic">"Dealing with Digital Evidence is a big challenge for the justice system, especially when we realize the new challenges and risks that it brings, like the remote manipulation of the collected evidence." </em></p>
			<p><em class="italic">– Judge RosibelJara</em></p>
			<p>Digital forensics is a very complex topic because, as you will see in this chapter, evidence can be gathered even if you don't have access to the device. Consequently, to be admitted on trial, digital evidence must comply with a plurality of conditions and regulations to ensure that the digital evidence was handled properly and that it was taken into custody appropriately. Therefore, the role of the digital forensics specialist is key to ensuring the success of the digital forensics process. This chapter aims to give you a very good introduction to the topic and serve as a starting point in case you need to face this process.</p>
			<p>The following topics will be covered in this chapter:</p>
			<ul>
				<li>Introduction to digital forensics</li>
				<li>Digital forensics on defensive security</li>
				<li>Forensics platforms</li>
				<li>Finding evidence</li>
				<li>Mobile forensics</li>
				<li>Managing the evidence</li>
			</ul>
			<h1 id="_idParaDest-358"><a id="_idTextAnchor372"/>Introduction to digital forensics</h1>
			<p><strong class="bold">Digital forensics</strong> (also<a id="_idIndexMarker1528"/> known<a id="_idIndexMarker1529"/> as <strong class="bold">cyber forensics</strong> or just forensics) is the process used to collect, identify, gather, secure, and store data from digital systems that can be used as evidence.</p>
			<p>In our case, we will focus on forensics to detect the use, abuse, intrusion, damage, or modification of computer systems, servers, networks, infrastructures, or data. However, forensics is also used to recover deleted or modified data, so let's take a few minutes to review how <a id="_idIndexMarker1530"/>forensics can be used for that.</p>
			<h2 id="_idParaDest-359"><a id="_idTextAnchor373"/>Forensics to recover deleted or missing data</h2>
			<p>There is<a id="_idIndexMarker1531"/> one part of forensics that is used to collect, identify, and recover deleted data from digital media. </p>
			<p>Usually, data is recovered from non-volatile media storage such as hard drives and USB drives, but it is also possible to gather data from volatile memory such as <strong class="bold">Random Access Memory (RAM)</strong>.</p>
			<p class="callout-heading">Volatile versus non-volatile memory</p>
			<p class="callout">Volatile <a id="_idIndexMarker1532"/>memory such as RAM is a type of memory that only saves the information while it is ON, while non-volatile memory such as hard drives can retain information over a very long time, even when they have no power. Therefore, gathering information from volatile memory is considered a more complex and specialized task.</p>
			<p>Now, let's start by reviewing how to capture data from volatile memory.</p>
			<h3>Recovering data from RAM</h3>
			<p>Due to<a id="_idIndexMarker1533"/> the hardware nature of RAM, recovering <a id="_idIndexMarker1534"/>data from RAM is considered a very complex task. However, there is one tool and one method we can use to achieve this goal. Let's take a look.</p>
			<h4>Microsoft COFEE </h4>
			<p>The <strong class="bold">Microsoft Computer Online Forensics Evidence Extractor</strong> (<strong class="bold">COFEE</strong>) toolkit <a id="_idIndexMarker1535"/>was developed <a id="_idIndexMarker1536"/>and distributed by Microsoft to police agencies to help them collect digital evidence from Microsoft systems.</p>
			<p>The tool is loaded as a live USB and is composed of a <strong class="bold">Graphical User Interface (GUI)</strong> with more than 150 forensics tools, including data stored on volatile memory (RAM).</p>
			<p>A copy of this tool was supposedly leaked on the internet in 2009 and if you are interested in reviewing it, a simple Google search will give you the link to the WikiLeaks page to download it.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Remember that leaked versions of software may contain malicious content, so avoid running it on your main computer. Instead, try using a virtual sandbox environment and take all <a id="_idIndexMarker1537"/>the necessary<a id="_idIndexMarker1538"/> precautions if you decide to download and run this type of software.</p>
			<h4>Cold boot attack</h4>
			<p>This <a id="_idIndexMarker1539"/>is a <a id="_idIndexMarker1540"/>super interesting way to gather data right from the RAM. Let me explain how it works:</p>
			<ol>
				<li>First, you need physical access to the computer.</li>
				<li>Open the computer.</li>
				<li>Cool down the RAM module (this can be done using a freeze spray).</li>
				<li>Cut off the power of the machine.</li>
				<li>Boot up the computer using a lightweight USB bootable <strong class="bold">Operating System (OS)</strong>.</li>
				<li>Perform a memory dump using any available memory dump software or script.</li>
			</ol>
			<p>As illustrated in the following diagram, a limitation of this attack is that the amount of data that's recovered is proportional to the time required. This means that the faster you perform the dump, the more data you can recover.</p>
			<div><div><img src="img/Figure_16.1_B16290.jpg" alt="Figure 16.1 – Correlation between time and data on a cold boot attack&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.1 – Correlation between time and data on a cold boot attack</p>
			<p>As you can imagine, there is a risk of physically destroying the memory, so it is highly recommended that you only use this method in a very controlled space (a lab environment). Also, it only works if the computer you wish to examine is already on.</p>
			<p class="callout-heading">What data can be recovered from RAM?</p>
			<p class="callout">Data that <a id="_idIndexMarker1541"/>can be recovered from RAM includes unsaved documents, drafted<a id="_idIndexMarker1542"/> emails, passwords, chats, usernames, printed documents (print jobs), settings, network or connection settings such as IP and <strong class="bold">Service Set Identifier (SSID)</strong>, and more.</p>
			<p>Now, let's look at the tools and methods we can use to recover data from non-volatile memory.</p>
			<h3>Recovering information from non-volatile memory</h3>
			<p>There <a id="_idIndexMarker1543"/>are many<a id="_idIndexMarker1544"/> tools we can use to recover deleted data from non-volatile memory, such as hard drives. Most of them are very easy to use <a id="_idIndexMarker1545"/>and available with a very user-friendly interface on Windows machines, such as <strong class="bold">Recuva</strong>.</p>
			<p>Additionally, there are more advanced<a id="_idIndexMarker1546"/> tools such as <strong class="bold">Foremost</strong>, which is a tool that's loaded on Kali Linux. We covered the configuration and execution of Foremost in <a href="B16290_05_Final_JC_ePub.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>,<em class="italic"> Cybersecurity Technologies and Tools.</em></p>
			<h3>Digital recovery versus physical recovery</h3>
			<p>To explain <a id="_idIndexMarker1547"/>how data recovery works, let me start by <a id="_idIndexMarker1548"/>explaining how Windows manages the files.</p>
			<p>Windows uses something<a id="_idIndexMarker1549"/> called <strong class="bold">Master File Table</strong> (<strong class="bold">MFT</strong>). This table is like the index of a<a id="_idIndexMarker1550"/> book that tells the <strong class="bold">operating system</strong> (<strong class="bold">OS</strong>) the location of each file by pointing it to the hard drive sector where the file is located. This means that when you want to open a file, the OS checks the MFT for where the file is located and then retrieves the data from the disk.</p>
			<p>As illustrated in the following diagram, to make the computer faster, when you delete a file, the OS deletes the entry on the MFT so that the sector becomes <em class="italic">available</em> to be used by another file. However, the information remains on the hard drive until the OS overwrites that sector with another file:</p>
			<div><div><img src="img/Figure_16.2_B16290.jpg" alt="Figure 16.2 – Windows MFT table structure&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.2 – Windows MFT table structure</p>
			<p>Therefore, what most digital recovery software does is perform a deep scan of the hard drive sectors to recreate the MFT based on the content found on the drive. As an analogy, this is like reading a book to recreate its index (table of contents).</p>
			<p>There are also cases in which the partition or system becomes corrupted. In those cases, the files can easily be retrieved by connecting the hard drive as an external drive to another computer and running the recovery software from there.</p>
			<p>However, there are cases in which the hard drive becomes physically damaged due to all the moving parts that are in constant usage due to rotation and friction, as illustrated in the following diagram. Examples of damage can be a bad head, a head crash, a scratch, or even damage to the rotor. </p>
			<p class="callout-heading">Tip</p>
			<p class="callout">In most cases, hard drive damage is progressive, so if you start noticing noises coming from the computer that sound like clicking or whirring, then it's time to replace the hard drive and save your data before it is too late.</p>
			<p>In all those cases, recovery is possible, but only by experts using special equipment and a properly <a id="_idIndexMarker1551"/>setup lab. Also, note that <a id="_idIndexMarker1552"/>physical recovery is normally expensive. </p>
			<div><div><img src="img/Figure_16.3_B16290.jpg" alt="Figure 16.3 – Moving parts of a hard drive&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.3 – Moving parts of a hard drive</p>
			<p>In regards to <strong class="bold">solid-state drives</strong> (<strong class="bold">SSDs</strong>), those risks of damage are lower because of the absence of <a id="_idIndexMarker1553"/>moving parts. However, if physical damage does occur, the recovery process is more complicated.</p>
			<p>Now, let's focus on computer forensics from the point of view of defensive security to detect <a id="_idIndexMarker1554"/>the <a id="_idIndexMarker1555"/>use, abuse, intrusion, damage, or modification of computer systems, servers, networks, infrastructures, or data.</p>
			<h1 id="_idParaDest-360"><a id="_idTextAnchor374"/>Digital forensics on defensive security</h1>
			<p>When <a id="_idIndexMarker1556"/>talking about forensics in terms of defensive <a id="_idIndexMarker1557"/>security, we must perform forensics in several fields, including the following:</p>
			<ul>
				<li>Data analysis</li>
				<li>Log analysis</li>
				<li>Email forensics</li>
				<li>Database forensics</li>
				<li>Malware forensics </li>
				<li>Memory forensics</li>
				<li>Mobile forensics</li>
				<li>Network forensics</li>
			</ul>
			<p>Now, let's dig deeper into how digital forensics is managed, including the process that's involved. </p>
			<h2 id="_idParaDest-361"><a id="_idTextAnchor375"/>Who should be in charge of digital forensics?</h2>
			<p>There are two main ways<a id="_idIndexMarker1558"/> to manage all this forensics work. While some companies have a forensics specialist to deal with all forensics-related tasks, other companies train an expert in each field to act as a forensic expert. There is also a forensic coordinator who acts as the leader of all forensics activities.</p>
			<h2 id="_idParaDest-362"><a id="_idTextAnchor376"/>The digital forensics process</h2>
			<p>Most<a id="_idIndexMarker1559"/> companies customize their digital forensics process based on their needs and their level of maturity. However, let me present you with the steps that must be followed when performing digital forensics:</p>
			<ul>
				<li><strong class="bold">Data handling and custody</strong>: Managing data during a forensics process is <em class="italic">key</em> to ensuring the success of the results. You need to keep in mind that the data that's collected during this process may be used for prosecution or to take any other legal actions, so you <em class="italic">must</em> ensure that the data is collected based on a standard that's been approved by your justice system. <p>Additionally, you need to apply the required tools and techniques to ensure the data's integrity from when it's collected until it's presented (for example, presenting the data as evidence in a court of justice). One of the most common methods that's used to demonstrate the integrity of the data is by hashing the data that's collected, as mentioned in <a href="B16290_05_Final_JC_ePub.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>, <em class="italic">Cybersecurity Technologies and Tools</em>.</p></li>
				<li><strong class="bold">Data collection</strong>: The first step in any forensics process is to collect <em class="italic">all</em> the data from all<a id="_idIndexMarker1560"/> available sources. This step is incredibly important, so much so that we will review this in depth in the upcoming section.</li>
				<li><strong class="bold">Data analysis</strong>: Here, the analyst starts by filtering the bulk of the information so that the analysis will be performed based on relevant information, thus reducing unnecessary efforts. Then, they must use a plurality of tools and methods to analyze the data that's been collected. As we mentioned previously, this analysis can be done on any type of media storage (volatile or non-volatile) and using techniques for digital and physical recovery. The results of the entire forensics process rely on the data and devices being analyzed, so this task must be performed by a certified professional. <p class="callout-heading">Tip</p><p class="callout">If you are interested in getting a certification in forensics, I highly recommend that you visit this site: <a href="https://i2c2x.com/">https://i2c2x.com/</a>.</p></li>
				<li><strong class="bold">Saving or archiving evidence</strong>: A common error is to delete the evidence after the trial. However, that data may still be of value during an appeals process, to identify repeat offenders (this could be key to determining whether someone is an inadvertent user or a malicious insider), or even in threat intelligence to correlate the data against new events to identify further attacks.<p>Therefore, the best practice is to create a section in your data retention policy that determines the required time to archive digital evidence. Notice that in some cases, this policy may be influenced by some regulations or laws.</p></li>
			</ul>
			<div><div><img src="img/Figure_16.4_B16290.jpg" alt="Figure 16.4 – Digital forensics process&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.4 – Digital forensics process</p>
			<p>Now, it is <a id="_idIndexMarker1561"/>time to look at some of the platforms that are used to perform digital forensics and gather digital evidence.</p>
			<h1 id="_idParaDest-363"><a id="_idTextAnchor377"/>Forensics platforms</h1>
			<p>As we <a id="_idIndexMarker1562"/>mentioned previously, the forensics process is a very sensitive task that must be performed with extreme care to ensure the data that's gathered is preserved and that its integrity is guaranteed. </p>
			<p>However, this can't be achieved with a single tool. Instead, a forensics specialist must select the best tool for each scenario based on a plurality of factors, such as the source of the data, the storage type, and the operating system.</p>
			<p>The good news is that to make our lives easier, some operating systems have been designed exclusively to perform forensics activities that are packed with a series of forensics tools.</p>
			<p>Additionally, some of those OSes are available as bootable live CDs or live USBs, which enables us to perform more advanced forensics.</p>
			<p>Now, let's review a collection of some of those forensics OSes.</p>
			<h2 id="_idParaDest-364"><a id="_idTextAnchor378"/>CAINE</h2>
			<p>The <strong class="bold">Computer-Aided Investigative Environment</strong> (<strong class="bold">CAINE</strong>) is<a id="_idIndexMarker1563"/> a <a id="_idIndexMarker1564"/>live GNU/Linux distribution that proves a complete forensic environment that incudes existing software tools as software modules, plus a friendly GUI that supports forensic experts during a digital investigation.</p>
			<div><div><img src="img/Figure_16.5_B16290.jpg" alt="Figure 16.5 – CAINE GUI&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.5 – CAINE GUI</p>
			<p>As <a id="_idIndexMarker1565"/>shown <a id="_idIndexMarker1566"/>in the<a id="_idIndexMarker1567"/> preceding screenshot, CAINE <a id="_idIndexMarker1568"/>is<a id="_idIndexMarker1569"/> preloaded with a considerable number of forensic tools ready to use, including <strong class="bold">The Sleuth Kit</strong>, <strong class="bold">Autopsy</strong>, <strong class="bold">RegRipper</strong>, <strong class="bold">Wireshark</strong>, <strong class="bold">PhotoREC</strong>, and more.</p>
			<p>Their official <a id="_idIndexMarker1570"/>page for downloads is <a href="https://www.caine-live.net/">https://www.caine-live.net/</a>.</p>
			<h2 id="_idParaDest-365"><a id="_idTextAnchor379"/>SIFT Workstation</h2>
			<p>SIFT Workstation<a id="_idIndexMarker1571"/> is a collection of free and<a id="_idIndexMarker1572"/> open source forensic tools for performing detailed digital forensics. There are two ways to install it: one is by downloading a virtual machine that is ready to use, while the other is by installing it directly on an Ubuntu machine:</p>
			<div><div><img src="img/Figure_16.6_B16290.jpg" alt="Figure 16.6 – SIFT Workstation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.6 – SIFT Workstation</p>
			<p>The <a id="_idIndexMarker1573"/>preceding screenshot shows a VM <a id="_idIndexMarker1574"/>installation of SIFT, which can be download from the SANS web page at <a href="https://www.sans.org/tools/sift-workstation/">https://www.sans.org/tools/sift-workstation/</a>.</p>
			<h2 id="_idParaDest-366"><a id="_idTextAnchor380"/>PALADIN</h2>
			<p><strong class="bold">PALADIN</strong> is a <a id="_idIndexMarker1575"/>modified <em class="italic">live</em> Linux distribution <a id="_idIndexMarker1576"/>based on Ubuntu that simplifies various forensics tasks. It comes with a lot of forensics tools divided into 33 categories, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_16.7_B16290.jpg" alt="Figure 16.7 – PALADIN categories of tools&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.7 – PALADIN categories of tools</p>
			<p>For more<a id="_idIndexMarker1577"/> information about the available versions of Paladin, you can visit their site at <a href="https://sumuri.com/software/paladin/">https://sumuri.com/software/paladin/</a>.</p>
			<p>Now that we <a id="_idIndexMarker1578"/>know about the different tools and platforms for digital forensics, let's learn how<a id="_idIndexMarker1579"/> evidence is obtained and the main sources of data to ensure you don't miss a thing during a forensics examination. </p>
			<h1 id="_idParaDest-367"><a id="_idTextAnchor381"/>Finding evidence</h1>
			<p>As soon as you <a id="_idIndexMarker1580"/>discover an attack, there are a lot of things that need to be done with the utmost priority, including restoring the systems and services that have been impacted. However, another critical task is to find and secure all the evidence related to the attack. This task is critical as it allows you to do the following:</p>
			<ul>
				<li>Determine whether the attack was executed by an insider or outsider.</li>
				<li>Determine whether the insider was a malicious insider or an inadvertent user.</li>
				<li>Determine the vulnerability exploited by the attacker.</li>
				<li>Determine the<a id="_idIndexMarker1581"/> impact on business data in terms of the <strong class="bold">confidentiality</strong>, <strong class="bold">integrity</strong>, and <strong class="bold">availability</strong> (<strong class="bold">CIA</strong>) triad.</li>
				<li>Determine the systems or services impacted by the attack.</li>
				<li>Collect evidence to execute legal or corrective actions (from HR).</li>
			</ul>
			<p>Now that you <a id="_idIndexMarker1582"/>know about the importance of collecting evidence, let's look at some best practices regarding the collection process itself.</p>
			<h2 id="_idParaDest-368"><a id="_idTextAnchor382"/>Sources of data</h2>
			<p>As you may<a id="_idIndexMarker1583"/> know, there are a lot of places that you can harvest to gather digital information during a forensics process. The most common type of files that you need to find are log files as they normally record all the events on the device (we covered this topic in <a href="B16290_15_Final_JC_ePub.xhtml#_idTextAnchor350"><em class="italic">Chapter 15</em></a>, <em class="italic">Leveraging Pentesting for Defensive Security</em>).</p>
			<p>A common mistake is to only check for logs on the servers. However, there are a lot of other places that can be a great source of information. We'll look at a few in this section, starting with non-volatile memory.</p>
			<h3>Non-volatile memory</h3>
			<p>As we<a id="_idIndexMarker1584"/> mentioned earlier, it is possible to obtain data from RAM, so in the case of a digital investigation, you may want to do a dump of the RAM to get some extra information before executing other actions or shutting down the server.</p>
			<h3>Deleted data</h3>
			<p>You should <a id="_idIndexMarker1585"/>also search for traces of deleted data on the hard drive. This is especially important for detecting malicious insiders that may try to cover their tracks by deleting logs or similar records. In these cases, you may not be able to retrieve the deleted information, but you may be able to prove that some logs were deleted or altered, and that could become evidence itself.</p>
			<h3>Routers and other network devices</h3>
			<p>This is <a id="_idIndexMarker1586"/>probably<a id="_idIndexMarker1587"/> the second most common place to look for traces after an attack.</p>
			<p>Besides looking for unusual activity, you also need to look for signs of log alterations, such as deleted entries, as they may be indicators of attacks.</p>
			<h3>IoT devices</h3>
			<p>Normally, IoT log<a id="_idIndexMarker1588"/> files are overlooked, but they can be a great source of information, especially if they were used as the point of entry to your infrastructure.</p>
			<h3>Network printers</h3>
			<p>Network<a id="_idIndexMarker1589"/> printers are normally overlooked, but at the end of the day, they are network devices, which means they can potentially be launchpads for attacks. Additionally, the security of those devices is weak, and that is exactly why attackers are targeting more of those devices. </p>
			<p>You will be amazed at all the information that you can collect by checking those logs, including previous attempts to break into your network.</p>
			<h3>Mobile devices</h3>
			<p>Mobile <a id="_idIndexMarker1590"/>devices such as smartphones act as minicomputers and, as such, they can also be used as a point of entry into your corporate network.</p>
			<p>Therefore, it is important to use monitoring software that collects logs about the usage and interactions with mobile devices. If<a id="_idIndexMarker1591"/> your company has a <strong class="bold">Bring Your Own Device</strong> (<strong class="bold">BYOD</strong>) policy, this becomes of extreme importance as the devices are more vulnerable to attacks, so having control over those devices is a must.</p>
			<p>Forensics <a id="_idIndexMarker1592"/>on mobile devices is a big topic, so let's review this topic in detail.</p>
			<h1 id="_idParaDest-369"><a id="_idTextAnchor383"/>Mobile forensics</h1>
			<p>Mobile Forensics<a id="_idIndexMarker1593"/> has become one the biggest areas of specialization in forensics – not just because almost everyone has a smartphone, but because smartphones can collect a huge amount of data.</p>
			<p>The cool thing about mobile forensics is that in some cases, <em class="italic">you don't even need the phone to gather some of the data that's been collected by your smartphone</em>. Let me show you how.</p>
			<h2 id="_idParaDest-370"><a id="_idTextAnchor384"/>Deviceless forensics</h2>
			<p>Smartphones <a id="_idIndexMarker1594"/>gather a lot of information, such as location, messages, searches, frequently visited places, app usage, browsing history, and more, but the most interesting part is that Google (yes, Google) records all that data on their cloud. Let's learn how to access it:</p>
			<ol>
				<li value="1">Go to <a href="https://takeout.google.com">https://takeout.google.com</a>.</li>
				<li>Log in with your user credentials.</li>
				<li>Select the data you want to retrieve.</li>
				<li>Choose how you want the files to be delivered (to a drive, cloud storage, or via a link for a direct download).</li>
				<li>Select whether you want to export the files only this time or if you want to schedule future exports.</li>
				<li>Determine the file type and maximum size per file.</li>
				<li>Click on <strong class="bold">Export</strong>.</li>
			</ol>
			<p>The export depends on the amount of data that Google has collected about you, so take into consideration that in some cases, it could take several hours or even a day to export all your data.</p>
			<div><div><img src="img/Figure_16.8_B16290.jpg" alt="Figure 16.8 – Google Takeout page&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.8 – Google Takeout page</p>
			<p>The type of <a id="_idIndexMarker1595"/>information depends on the Google services that you use. However, while for iPhone users this could be optional, some of the information that's collected here applies to all Android users. You may be surprised by the amount of data being collected about you. For example, in the exported file, you can see not only details about the app's use but when it was used (along with a timestamp). </p>
			<p>The following are some examples of the data that can be exported:</p>
			<ul>
				<li>Information about IoT devices through Google Home</li>
				<li>Calendar entries (including when they were created and deleted)</li>
				<li>Everything about your Google Chrome access (history, settings, and so on)</li>
				<li>Information about the files you print (Google Print)</li>
				<li>Information about purchases and reservations made using Google Search or Maps</li>
				<li>Images and text published on Google communities</li>
				<li>Contact pictures</li>
				<li>Data about registration and activity on your Google account</li>
				<li>All your biometric data that's been compiled by Google Fit, including sleep data, training data, distance walked, and more</li>
				<li>Metadata about your Google searches</li>
				<li>History of purchases made with Google Pay</li>
				<li>Information about the books you've read or purchased on Google Books (including notes and highlights)</li>
				<li>Preferences <a id="_idIndexMarker1596"/>about movies based on Google Play movies (including playlists and even the ratings you've provided for each movie)</li>
				<li>History of shopping (including delivery addresses) based on Google Shop</li>
				<li>History of your chats in Google Hangouts (including attached pictures)</li>
				<li>History of navigation (including preferences and reviews of visited sites) based on Google Maps</li>
				<li>Device configuration, performance data, software version, and more (for Android devices)</li>
				<li>Information about the games you've played (including scores) on Google Play</li>
				<li>Installed apps, ratings, and purchases (Google Play)</li>
				<li>Your location history (based on the data that's been collected by your GPS)</li>
				<li>History of videos searched and watched on YouTube</li>
				<li>And more</li>
			</ul>
			<p>Additionally, as shown in the following screenshot, you have extra parameters to choose from, such as the format of the data to be exported and the items to be included on the export:</p>
			<div><div><img src="img/Figure_16.9_B16290.jpg" alt="Figure 16.9 – Export settings of Google Takeout&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.9 – Export settings of Google Takeout</p>
			<p>For iPhone users, things are a bit different because the privacy policy is more restrictive than that of Android. This means that gathering information that's been saved about the user is more <a id="_idIndexMarker1597"/>complex. Apple does not have a page like this one where the user can request their data, so gathering this type of information from an iPhone may involve sending a legal request directly to Apple to get a warrant to share that user information.</p>
			<h2 id="_idParaDest-371"><a id="_idTextAnchor385"/>Important data sources on mobile devices</h2>
			<p>As we <a id="_idIndexMarker1598"/>mentioned previously, a mobile device collects a lot of data that can be harvested without even having access to the phone. However, if you have access to the phone, you may be able to gather even more information. </p>
			<p>While most books will tell you to gather files such as pictures, calls, messages, and other easily identifiable data, there is a lot more data that can be harvested from a mobile device. So, let's look at my checklist of data to be harvested from mobile devices:</p>
			<ul>
				<li><strong class="bold">Wi-Fi connection data (including a list of known SSIDs)</strong>: This could be very useful in confirming whether the user was at a given place or trying to connect to an unauthorized network.</li>
				<li><strong class="bold">Bluetooth connection data</strong>: This can help determine whether an unapproved device was connected.</li>
				<li><strong class="bold">OS installation details</strong>: This data is very useful for determining whether the device was recently restored to its factory defaults, which can be used as proof that the device data was wiped out.</li>
				<li><strong class="bold">App list</strong>: This can be used to determine whether unauthorized software was installed on the device. For example, this could become especially useful for determining whether third-party software that was installed by an inadvertent user was vulnerable or used to leak any data from the device.</li>
				<li><strong class="bold">OS updates information</strong>: This is very useful for determining whether the device was breached or attacked due to a lack of some security being updated in the OS, or even to demonstrate that the device is still vulnerable, even after being fully patched (which may reveal the presence of a zero-day attack).</li>
				<li><strong class="bold">Rooting, jailbreaking, and other OS modifications</strong>: It is very important to look for traces of jailbreaking or any other unauthorized OS modifications as this could <a id="_idIndexMarker1599"/>represent a breach of corporate policy. This could also be the reason why the device was breached (and an explanation about why the device was unable to prevent the attack).</li>
				<li><strong class="bold">USB connection metadata</strong>: This can help you determine whether the device was connected to an authorized device and whether data exfiltration was performed or attempted.</li>
				<li><strong class="bold">Cloud storage apps and users</strong>: This information can be used during an investigation to determine whether data was exfiltrated to personal cloud storage services (Dropbox, box, OneDrive, and so on).</li>
			</ul>
			<p>This checklist is device-agnostic, but the tools and methods that are used to gather that data vary between devices, OSes, brands, models, and so on.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Depending on the device's OS, this data can be stored by the user. So, it is important to ensure that this gathering activity is performed on all users of the device.</p>
			<h2 id="_idParaDest-372"><a id="_idTextAnchor386"/>Transporting mobile devices</h2>
			<p>Many solutions <a id="_idIndexMarker1600"/>enable you to remotely delete files on a mobile device. Therefore, to avoid any external manipulation of the device, it is recommended to <a id="_idIndexMarker1601"/>use a <strong class="bold">faraday cage</strong> to block any incoming signals and avoid the data on the device being modified.</p>
			<p>Now it is time to look at some guidelines and international best practices regarding managing digital evidence to ensure it can be used in a legal process as valid evidence. </p>
			<h1 id="_idParaDest-373"><a id="_idTextAnchor387"/>Managing the evidence (from a legal perspective)</h1>
			<p><em class="italic">"We must adapt to the digital age and the chain of custody must be also maintained when dealing with digital evidence." </em></p>
			<p><em class="italic">– Lawyer, Angelith Alfaro</em></p>
			<p>As we mentioned <a id="_idIndexMarker1602"/>previously, the very first step when performing forensics is to ensure that the data that's been collected is handled and stored properly. Otherwise, the data may not be admissible in a trial or other legal procedure.</p>
			<p>Some countries may have different regulations or frameworks that must be followed to use digital evidence. However, let me share some of the most common guidelines and regulations in regards to digital evidence that are used around the world.</p>
			<h2 id="_idParaDest-374"><a id="_idTextAnchor388"/>ISO 27037</h2>
			<p>The ISO/IEC 27037:2012 provides<a id="_idIndexMarker1603"/> guidelines <a id="_idIndexMarker1604"/>about identifying, collecting, acquisitioning, and preserving digital evidence.</p>
			<p>The last version was revised in 2018 and it allows you to identify, collect, acquire, and preserve data from a plurality of devices, including, but not limited to, the following:</p>
			<ul>
				<li>Digital storage (non-volatile)</li>
				<li>Mobile devices</li>
				<li>GPS navigation devices</li>
				<li>Digital cameras (including CCTV)</li>
				<li>Network devices</li>
			</ul>
			<p>If you want<a id="_idIndexMarker1605"/> to find <a id="_idIndexMarker1606"/>out more about this standard, you can visit their official site at <a href="https://www.iso.org/standard/44381.html">https://www.iso.org/standard/44381.html</a>.</p>
			<h2 id="_idParaDest-375"><a id="_idTextAnchor389"/>Digital Evidence Policies and Procedures Manual</h2>
			<p>The US <a id="_idIndexMarker1607"/>National<a id="_idIndexMarker1608"/> Institute <a id="_idIndexMarker1609"/>of Justice created<a id="_idIndexMarker1610"/> this manual in 2020 to give law enforcement agencies a guide for developing policies and procedures for collecting, handling, and processing digital evidence:</p>
			<p><a href="https://nij.ojp.gov/library/publications/digital-evidence-policies-and-procedures-manual">https://nij.ojp.gov/library/publications/digital-evidence-policies-and-procedures-manual</a>.</p>
			<h2 id="_idParaDest-376"><a id="_idTextAnchor390"/>FBI's Digital Evidence Policy Guide</h2>
			<p>This<a id="_idIndexMarker1611"/> is <a id="_idIndexMarker1612"/>the <a id="_idIndexMarker1613"/>policy that's used by the <strong class="bold">Federal Bureau of Investigation</strong> (<strong class="bold">FBI</strong>) for handling, reviewing, and processing digital evidence that's been collected during investigations: <a href="https://vault.fbi.gov/digital-evidence-policy-guide">https://vault.fbi.gov/digital-evidence-policy-guide</a>.</p>
			<h2 id="_idParaDest-377"><a id="_idTextAnchor391"/>Regional Computer Forensics Laboratory</h2>
			<p>The <strong class="bold">Regional Computer Forensics Laboratory</strong> (<strong class="bold">RCFL</strong>) program <a id="_idIndexMarker1614"/>is a<a id="_idIndexMarker1615"/> partnership between the FBI and other US federal, state, and local law enforcement agencies that provides forensic services and expertise to support law enforcement agencies in collecting and examining digital evidence. </p>
			<p>They published a <em class="italic">Digital Evidence Field Guide</em> aimed to serve as a guide about handling digital evidence properly. The guide can be found here:</p>
			<p><a href="https://www.rcfl.gov/file-repository/fieldguide_sc.pdf/view">https://www.rcfl.gov/file-repository/fieldguide_sc.pdf/view</a>.</p>
			<h2 id="_idParaDest-378"><a id="_idTextAnchor392"/>US Cybersecurity &amp; Infrastructure Security Agency</h2>
			<p>The<a id="_idIndexMarker1616"/> US <strong class="bold">Cybersecurity &amp; Infrastructure Security Agency</strong> (<strong class="bold">CISA</strong>) published <a id="_idIndexMarker1617"/>a guide to forensics that includes references to applicable laws in the US, as well as a collection of useful <a id="_idIndexMarker1618"/>links regarding forensics:</p>
			<p>https://us-cert.cisa.gov/sites/default/files/publications/forensics.pdf.</p>
			<p>RFC 3227 – Guidelines for Evidence Collection and Archiving</p>
			<p>The <strong class="bold">Internet Engineering Task Force</strong> (<strong class="bold">IETF</strong>) published<a id="_idIndexMarker1619"/> the <a id="_idIndexMarker1620"/>RFC 3227 – <em class="italic">Guidelines for Evidence Collection and Archiving</em>, which <a id="_idIndexMarker1621"/>can be found at the following link: <a href="https://datatracker.ietf.org/doc/html/rfc3227">https://datatracker.ietf.org/doc/html/rfc3227</a>.</p>
			<h1 id="_idParaDest-379"><a id="_idTextAnchor393"/>Summary</h1>
			<p>Digital forensics is a big topic. There are even bachelor's degrees in digital forensics, which confirms how extensive and complex this topic is.</p>
			<p>However, this chapter aimed to give you a deep overview of the topic, plus some considerations that you must follow in case you need to oversee a digital investigation (forensics) in your company.</p>
			<p>So, in this chapter, you learned about the different types of forensics, as well as the different sources of data that you must review during an investigation.</p>
			<p>Additionally, we reviewed the best practices surrounding gathering data and how to manage it properly from a legal point of view.</p>
			<p>Finally, we looked at the uniqueness of mobile forensics and some best practices associated with it.</p>
			<p>Now, it is time to move on to another interesting chapter, in which we will learn how to apply automation to enhance our defensive security strategy.</p>
			<h1 id="_idParaDest-380"><a id="_idTextAnchor394"/>Further reading</h1>
			<p>If you want to get a specialized degree in forensics, there are bachelors as well as certifications in this field. For more information, visit the following sites: </p>
			<ul>
				<li><a href="https://i2c2x.com/">https://i2c2x.com/</a></li>
				<li><a href="https://www.ubalt.edu/cpa/undergraduate-majors-and-minors/majors/cyber-forensics/">https://www.ubalt.edu/cpa/undergraduate-majors-and-minors/majors/cyber-forensics/</a></li>
			</ul>
		</div>
	</body></html>