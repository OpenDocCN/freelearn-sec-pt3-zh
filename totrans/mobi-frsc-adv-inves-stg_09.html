<html><head></head><body>

  <div class="chapter" title="Chapter 9. Acquisition &#x2013; Approaching BlackBerry">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch09"/>Chapter 9. Acquisition – Approaching BlackBerry</h1>

        </div>

      </div>

    </div>

    <p>While BlackBerry's global market share fell to less than one per cent according to Bloomberg (<a class="ulink" href="http://www.bloomberg.com/news/2014-05-28/blackberry-market-share-to-fall-to-0-3-in-2018-idc-says.html">http://www.bloomberg.com/news/2014-05-28/blackberry-market-share-to-fall-to-0-3-in-2018-idc-says.html</a>), many BlackBerry devices are still used in corporate environments.</p>

    <p>Security was always one of the BlackBerry's key points. Information stored in encrypted BlackBerry devices was impossible to extract or decrypt without knowing the correct passcode. However, attacking BlackBerry backups offers a way to recover user data.</p>

    <p>Recovering information from BlackBerry devices depends on which version of the BlackBerry OS the device is running. If the device uses any version of BlackBerry OS prior to BlackBerry 10, the users can configure it to produce offline backups protected with a user-selectable password. If, however, the device is running BlackBerry 10, the backups are stored in an online cloud, and require the original BlackBerry ID and password to access.</p>

    <div class="note" title="Note" style="">

      <div class="inner">

        <h3 class="title" id="toc_1"><a id="note49"/>Note</h3>

        <p>A comprehensive whitepaper on BlackBerry forensics by Shafik Punja (Teel Technologies) and Cindy Murphy (Gillware Digital Forensics) is available at <a class="ulink" href="http://www.nist.gov/forensics/upload/5-Punja-nist-2014-bb-forensics-FULL.pdf">http://www.nist.gov/forensics/upload/5-Punja-nist-2014-bb-forensics-FULL.pdf</a> (Blackberry Forensics, NIST Mobile Forensics Workshop June 2014).</p>

      </div>

    </div>

    <div class="section" title="The history of the BlackBerry OS - BlackBerry 1.0-7.1">

      <div class="titlepage">

        <div>

          <div>

            <h1 class="title" id="toc_2"><a id="ch09lvl1sec57"/>The history of the BlackBerry OS - BlackBerry 1.0-7.1</h1>

          </div>

        </div>

      </div>

      <p>Prior to the release of BlackBerry 10, the now current version of BlackBerry OS, BlackBerry devices could be configured to produce password-protected offline backups (<code class="literal">*.ipd</code> or <code class="literal">*.bbb</code> backup files) when connected to an authorized computer running BlackBerry Desktop Software. It is important to note that these backups were only protected with a user-selectable password. Unlike Apple, BlackBerry has not specified the use of any additional hardware-based encryption keys. As a result, successfully recovering a password is all that is needed to decrypt a BlackBerry backup.</p>

      <p>BlackBerry backups (OS 1.0 to 7.0) are not password protected/encrypted by default. This option must be enabled by the user within the BlackBerry Desktop Software interface. Unencrypted BlackBerry devices can be also acquired via JTAG (compatible models) or chip-off.</p>

      <div class="section" title="BlackBerry 7 JTAG, ISP, and chip-off acquisition">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_3"><a id="ch09lvl2sec105"/>BlackBerry 7 JTAG, ISP, and chip-off acquisition</h2>

            </div>

          </div>

        </div>

        <p>Depending on whether or not <span class="strong"><strong>Content Protection</strong></span> (data encryption, <span class="strong"><strong>Options</strong></span> | <span class="strong"><strong>Security</strong></span> | <span class="strong"><strong>Encryption</strong></span> in BB7) was enabled in a given device, it may or may not be susceptible to advanced acquisition techniques such as JTAG, <span class="strong"><strong>In-system programming</strong></span> (<span class="strong"><strong>ISP</strong></span>), or chip-off. Moreover, these older BlackBerry devices can be unlocked via BES they are attached to. Note that JTAG only works for older devices.</p>

        <p>Depending on whether or not a BlackBerry 7 device was on a BES, decrypting the chip-off dump may or may not be possible. In certain cases, non-BES devices using the built-in encryption (Content Protection) can be dumped via chip-off and successfully decoded by recovering the original password from the SHA1 hash file.</p>

        <div class="note" title="Note" style="">

          <div class="inner">

            <h3 class="title" id="toc_4"><a id="note50"/>Note</h3>

            <p>More information: PGP Encrypted BlackBerrys and Chip-off Forensics <a class="ulink" href="http://securemobile.me/yes-the-blackberry-can-be-cracked-but-how-easily/">http://securemobile.me/yes-the-blackberry-can-be-cracked-but-how-easily/</a>.</p>

          </div>

        </div>

      </div>

      <div class="section" title="Acquiring BlackBerry desktop backups">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_5"><a id="ch09lvl2sec106"/>Acquiring BlackBerry desktop backups</h2>

            </div>

          </div>

        </div>

        <p>We'll use Elcomsoft Phone Breaker to recover the password protecting a BlackBerry backup by performing an attack on the backup files. It is important to note that this attack is only applicable to the <span class="emphasis"><em>classic</em></span> BlackBerry OS up to and including version 7. You can specify one or more different attacks, for example, wordlist (known as password attack), dictionary, brute force,and so on. A combination of attacks makes up a recovery pipeline.</p>

        <p>To recover the password in Elcomsoft Phone Breaker, do the following:</p>

        <div class="orderedlist">

          <ol class="orderedlist arabic">

            <li class="listitem">Open the <span class="strong"><strong>Password Recovery Wizard</strong></span> page.<p> </p><div class="mediaobject"><img src="0151.jpeg" alt="Acquiring BlackBerry desktop backups"/></div><p> </p></li>

            <li class="listitem">Specify the backup file (<code class="literal">.ipd</code> or <code class="literal">.bbb</code>) by either selecting the file with the <span class="strong"><strong>Choose source</strong></span> command or by dragging and dropping the backup file onto the <span class="strong"><strong>Password Recovery Wizard</strong></span> window.<div class="note" title="Note" style=""><div class="inner"><h3 class="title" id="toc_6"><a id="note51"/>Note</h3><p> <span class="strong"><strong>Note</strong></span>: Alternatively, you may use the <span class="strong"><strong>Tools</strong></span> | <span class="strong"><strong>BlackBerry</strong></span> | <span class="strong"><strong>Decrypt backup</strong></span> route, as seen in the following screenshot:</p><p> </p><div class="mediaobject"><img src="0152.jpeg" alt="Acquiring BlackBerry desktop backups"/></div><p> </p></div></div></li>

            <li class="listitem">By default, the tool will list all locally available backups created with BlackBerry Desktop Software. If you are recovering a backup located on the suspect's hard drive, external device, or mounted forensic disk image, you will need to manually specify the location of backup files.</li>

            <li class="listitem">After specifying the backup file, you will need to define the attacks that will be used to break the password. Click on the plus + sign to add various attacks for breaking the password. By default, Dictionary and Brute-Force attacks are added automatically. For more information about attacks and their settings, see the <span class="emphasis"><em>Password recovery attacks</em></span> topic in the online manual.<p> </p><div class="mediaobject"><img src="0153.jpeg" alt="Acquiring BlackBerry desktop backups"/></div><p> </p></li>

            <li class="listitem">You can optionally configure both the Dictionary Attack and Brute-Force by clicking on the gear icon to the right of each method.<p> </p><div class="mediaobject"><img src="0154.jpeg" alt="Acquiring BlackBerry desktop backups"/></div><p> </p><p> </p><div class="mediaobject"><img src="0155.jpeg" alt="Acquiring BlackBerry desktop backups"/></div><p> </p></li>

            <li class="listitem">Click <span class="strong"><strong>Start recovery</strong></span>. Elcomsoft Phone Breaker will begin attacking the password. Estimated time left as well as the currently processed word will be displayed. You can click <span class="strong"><strong>More Info</strong></span> next to the name of the attack to see additional information, such as the number of attempted passwords and the average attack speed.<p> </p><div class="mediaobject"><img src="0156.jpeg" alt="Acquiring BlackBerry desktop backups"/></div><p> </p></li>

            <li class="listitem">If the attack is successful, the discovered password will be displayed in the <span class="strong"><strong>Recovery results</strong></span> window. At this time, you can either decrypt the backup to open it in <span class="strong"><strong>Elcomsoft BlackBerry Backup Explorer</strong></span> (<a class="ulink" href="https://www.elcomsoft.com/ebbe.html">https://www.elcomsoft.com/ebbe.html</a>), or use a third-party forensic tool to decrypt the backup with the discovered password.</li>

          </ol>

        </div>

        <p>That's it, we have successfully recovered a password. This password can now be used to decrypt the backup. In addition, you can break passwords protecting BlackBerry Wallet and Keeper data.</p>

      </div>

      <div class="section" title="Decrypting the backup">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_7"><a id="ch09lvl2sec107"/>Decrypting the backup</h2>

            </div>

          </div>

        </div>

        <p>The following section is applicable to BlackBerry OS backups (BB OS 7 and older).BlackBerry 10 backups are acquired using a different process.</p>

        <p>If you already know (or have previously recovered) the password to BlackBerry backup, EPPB can decrypt it, so you will be able to open decrypted backup files in other software (we recommend usingElcomsoft Blackberry Backup Explorer).</p>

        <p>You need a BlackBerry database<code class="literal">*.ipd</code> file or BlackBerry backup <code class="literal">*.bbb</code> file to decrypt the backup.</p>

        <p>Only BlackBerry smartphone backups can be decrypted; backups made from PlayBook devices have different formats and are not supported yet, so EPPB can only recover the passwords for such files, but cannot decrypt them.</p>

        <p>To decrypt a BlackBerry backup, do the following:</p>

        <div class="orderedlist">

          <ol class="orderedlist arabic">

            <li class="listitem">In the <span class="strong"><strong>Tools</strong></span> menu, select the <span class="strong"><strong>BlackBerry</strong></span> tab.</li>

            <li class="listitem">Select Decrypt backup.</li>

            <li class="listitem">Select either a BlackBerry database file (<code class="literal">*.ipd</code>) or BlackBerry backup file (<code class="literal">*.bbb</code>) by drag-and-dropping it to the <span class="strong"><strong>Decrypt backup</strong></span> window, or click <span class="strong"><strong>Choose backup</strong></span> to navigate to the necessary file manually.<p> </p><div class="mediaobject"><img src="0157.jpeg" alt="Decrypting the backup"/></div><p> </p></li>

            <li class="listitem">When the backup is loaded, you can view the following information about backup:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Backup date</li><li class="listitem" style="list-style-type: disc">Product type</li></ul></div></li>

            <li class="listitem">You can select a different backup by clicking <span class="strong"><strong>Change backup</strong></span> next to the backup name.<p> </p><div class="mediaobject"><img src="0158.jpeg" alt="Decrypting the backup"/></div><p> </p></li>

            <li class="listitem">Define options for backup decryption:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Save decrypted to</strong></span>: Select location for saving the decrypted backup.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Backup password</strong></span>: Enter the password for the backup. Toggle the <span class="strong"><strong>View</strong></span> button to display the password as characters or in asterisks (<span class="strong"><strong>*</strong></span>). Click <span class="strong"><strong>Restore password</strong></span> if you have not restored it yet.</li></ul></div><p> </p><div class="mediaobject"><img src="0159.jpeg" alt="Decrypting the backup"/></div><p> </p></li>

            <li class="listitem">Click <span class="strong"><strong>Decrypt</strong></span>.</li>

            <li class="listitem">The decryption process starts. You can view the number of processed files and the number of errors received during decryption.</li>

            <li class="listitem">When the decryption is finished, you can view the backup in the location on the local computer to which it was saved by clicking the <span class="strong"><strong>View</strong></span> button.<p> </p><div class="mediaobject"><img src="0160.jpeg" alt="Decrypting the backup"/></div><p> </p></li>

            <li class="listitem">Click <span class="strong"><strong>Finish</strong></span> to close the Decrypt backup page.</li>

          </ol>

        </div>

        <p>You have now successfully decrypted the backup, and may proceed to recovering BlackBerry Keeper and Wallet data.</p>

        <div class="note" title="Note" style="">

          <div class="inner">

            <h3 class="title" id="toc_8"><a id="note52"/>Note</h3>

            <p> <span class="strong"><strong>Note</strong></span>: If you are viewing a backup file produced by an older version of Blackberry (before BlackBerry 10), you may use Elcomsoft Blackberry Backup Explorer: <a class="ulink" href="http://www.elcomsoft.com/ebbe.html">http://www.elcomsoft.com/ebbe.html</a> .</p>

          </div>

        </div>

      </div>

      <div class="section" title="BlackBerry Password Keeper and BlackBerry Wallet">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_9"><a id="ch09lvl2sec108"/>BlackBerry Password Keeper and BlackBerry Wallet</h2>

            </div>

          </div>

        </div>

        <p>BlackBerry Password Keeper and BlackBerry Wallet are two built-in apps containing lots of valuable data. Authentication credentials and passwords to websites are kept in BlackBerry Password Keeper, providing users with faster login experience. BlackBerry Wallet keeps credit card numbers, billing and shipping addresses, loyalty and frequent flyer programs,and so on. In general, this information is encrypted with an additional master password.</p>

        <p>BlackBerry Password Keeper and BlackBerry Wallet do not share master passwords (yet nothing prevents users from setting them up with the same password). If a wrong password is entered 10 times in a row, information stored in BlackBerry Password Keeper or Wallet can be permanently erased if a corresponding setting is selected by the user (which is default behavior).</p>

        <div class="note" title="Note" style="">

          <div class="inner">

            <h3 class="title" id="toc_10"><a id="note53"/>Note</h3>

            <p> <span class="strong"><strong>Note</strong></span>: When analyzing offline backups, one should not worry about the 10 unsuccessful attempts erasing the data. In fact, when recovering Keeper and Wallet master passwords, we try millions of passwords—obviously without losing any data stored in the backup.</p>

          </div>

        </div>

        <div class="section" title="BlackBerry Password Keeper">

          <div class="titlepage">

            <div>

              <div>

                <h3 class="title" id="toc_11"><a id="ch09lvl3sec43"/>BlackBerry Password Keeper</h3>

              </div>

            </div>

          </div>

          <p>BlackBerry Password Keeper protects access to users' passwords with a master password. With only one password to remember, users are much more likely to maintain unique passwords to different resources such as Web sites, applications, and services. BlackBerry encourages the use of Password Keeper for generating extremely secure random passwords that contain long sequences of letters, numbers, and symbols. The Keeper encrypts users' passwords, and can only decryptthem with the correct Password Keeper master password.</p>

          <p>Passwords stored in BlackBerry Password Keeper are included into full offline backups by default (unless explicitly excluded at the time of backup). The backups themselves are encrypted; however, even when the backup is decrypted, Keeper passwords are still protected with the additional master password.</p>

        </div>

        <div class="section" title="BlackBerry Wallet">

          <div class="titlepage">

            <div>

              <div>

                <h3 class="title" id="toc_12"><a id="ch09lvl3sec44"/>BlackBerry Wallet</h3>

              </div>

            </div>

          </div>

          <p>BlackBerry Wallet keeps certain financial information such as credit card numbers, billing and shipping addresses, frequent flyer numbers, loyalty rewards, and membership card numbers. Wallet is designed to speed up mobile checkout andmake the online purchasing process easier by automatically filling out the required fields.</p>

          <p>Data stored in BlackBerry Wallet is highly sensitive, and is securely encrypted with the Wallet master password. This password is normally different from the BlackBerry backup password, which adds an extra layer of protection.</p>

        </div>

      </div>

      <div class="section" title="BlackBerry security model - breaking a device password">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_13"><a id="ch09lvl2sec109"/>BlackBerry security model - breaking a device password</h2>

            </div>

          </div>

        </div>

        <p>Information stored in classic BlackBerry OS devices is secured with a device password. A device password is requested every time the device is turned on, as well as every time on expiration of Security Timeout (if this option is selected). 10incorrect attempts cause full data wipe, leaving no chance of subsequent recovery. This security feature is one of the hallmarks of the BlackBerry security model. However, the individual security password is <span class="strong"><strong>not enforced</strong></span> and is optional. In other words, a BlackBerry device user does NOT have to enable a device password for BlackBerry devices (this includes BlackBerry 10) unless such protection is enforced via corporate policy (BES, Exchange services,and so on).</p>

        <p>ElcomSoft has discovered a way around the device password. In certain cases, it is possible to attack and recover the device password offline if a user-selectable option to encrypt the contents of a removable media card is selected. If this is the case, investigators can useElcomsoft Phone Breaker to analyze information stored on the media card (microSD) and attack the original device password without the need to use the BlackBerry device itself.</p>

        <p>What is media encryption, and why can it be used to attack a device password? BlackBerry smartphones can optionally encrypt the contents of the SD card. Theoretically, this would not allow attackers to gain access to information stored on the SD card without knowing the correct device password. In reality, the encryption scheme is dependent on the device password and allows attacking said password without using the device itself. It is important to note that SD card encryption is disabled by default, but some users opt for enabling the extra security layer.</p>

        <p>Note that this method only works if the removable media card is encrypted with the <span class="strong"><strong>Security Password</strong></span> option (as opposed to using a hardware-dependent encryption key). An estimated 30 percent of BlackBerry users opt to protect their media cards with this option, making their devices open to this attack.</p>

        <p>There are three possible combinations of this option as defined by BlackBerry, namely the following:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Device Key</strong></span>: Encrypts files using an encryption key for a media card generated by the BlackBerry smartphone</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Security Password</strong></span> or <span class="strong"><strong>Device Password</strong></span> (depending on OS version): Encrypts files using the BlackBerry smartphone password</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Security Password and Device Key</strong></span> or <span class="strong"><strong>Device Password and Device Key</strong></span> (depending on OS version):Encrypts files using an encryption key for a media card and the BlackBerry smartphone password</li>

          </ul>

        </div>

        <p>Elcomsoft Phone Breaker can successfully recover the password if either <span class="strong"><strong>Security Password</strong></span> (Device Password) or <span class="strong"><strong>Security Password and Device Key</strong></span> (Device Password and Device Key) option is specified. However, if the <span class="strong"><strong>Security Password and Device Key</strong></span> was activated, decrypting the content of the media card without the BlackBerry device it was used in is not possible even after recovering the original password.</p>

        <p>BlackBerry 10 always uses media card encryption based on theDevice Key, which has two consequences. Firstly, we can no longer attack device passwords by using the encrypted media card. Secondly, if the user removes the card from the BlackBerry 10 device it was originally used in, no other BlackBerry 10 device will be able to access information stored on that card. As a result, backing up information stored on a media card before moving it to another BlackBerry device is essential.</p>

        <p>More information can be found at:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://blackberry.com/btsc/kb12999">http://blackberry.com/btsc/kb12999</a></li>

            <li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://blackberry.com/btsc/kb25484">http://blackberry.com/btsc/kb25484</a></li>

          </ul>

        </div>

        <p>When using this option, the actual BlackBerry device is not required to perform the attack. All you need is a single file from the SD card. Offline recovery speeds when using a modern computer are extremely high (considering how slow the hardware used in classic BlackBerry OS devices was), delivering tens of millions passwords per second. This means that a reasonably secure seven-character password can be unlocked in less than an hour.</p>

        <p>Knowing the original device password, investigators gain access to information stored in the original BlackBerry device, or can produce a backup file for offline analysis.</p>

      </div>

    </div>

  </div>




  <div class="section" title="Acquiring BlackBerry 10">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch09lvl1sec58"/>Acquiring BlackBerry 10</h1>

        </div>

      </div>

    </div>

    <p>For many years, the QNX-based BlackBerry 10 remained BlackBerry's bread-and-butter operating system. It's used on all new devices; older devices did not receive an upgrade to BB 10 (<a class="ulink" href="http://www.theinquirer.net/inquirer/news/2145581/rim-current-devices-won-t-upgraded-blackberry">http://www.theinquirer.net/inquirer/news/2145581/rim-current-devices-won-t-upgraded-blackberry</a>).</p>

    <p>In January 2013, BlackBerry released a new, revamped version of the OS dubbed BlackBerry 10. Initially only available on a single touchscreen device, BlackBerry Z10, the new OS made it to subsequent devices including BlackBerry Q5, Q10, Q20 (Classic) and Q30 (Passport and Passport SE), touch-screen Z30 and Leap, as well as a counted number of Porsche design models.</p>

    <p>BlackBerry 10 comes with the ability to run Android apps (installable via Amazon app store or Amazon Underground in latest releases); however, the OS lacks support for <span class="strong"><strong>Google Mobile Services</strong></span> (<span class="strong"><strong>GMS</strong></span>) and does not, in general, collect as much information about the user as Google-powered Android.</p>

    <div class="section" title="Getting started">

      <div class="titlepage">

        <div>

          <div>

            <h2 class="title" id="toc_1"><a id="ch09lvl2sec110"/>Getting started</h2>

          </div>

        </div>

      </div>

      <p>Much like iOS, BlackBerry 10 is a closed-source OS. Similar to Apple, BlackBerry manufactures all BB10 handsets in-house using just two chip sets of a single manufacturer. All BlackBerry 10 devices with the exception of BlackBerry passport feature variations of the Qualcomm Snapdragon S4 chip set (found in BlackBerry Q5, Q10, Q20 Classic, Z10, Z30, Z3, Leap, and limited production run Porsche Design units). The Passport is equipped with Snapdragon 801. Just like iOS, all BlackBerry 10 devices are updated at the same time to the latest version of BlackBerry OS. Therefore, there is no platform fragmentation as such, and no platform or manufacturer specific considerations. As such, only a few simple iterations allow determining the best acquisition method.</p>

      <p> <span class="emphasis"><em>Do you know if the device is encrypted?</em></span> If you do know, and the device <span class="emphasis"><em>is not encrypted</em></span>, then ISP or chip-off will deliver the maximum amount of information including deleted data. If you know that the device <span class="emphasis"><em>is encrypted</em></span>, then low-level acquisition techniques will likely not work.</p>

      <div class="note" title="Note" style="">

        <div class="inner">

          <h3 class="title" id="toc_2"><a id="tip54"/>Tip</h3>

          <p> <span class="strong"><strong>Note</strong></span>: In existing versions of BlackBerry 10, encryption is not enforced unless the device is on a BES, and the BES enforces device encryption policy. In addition, on consumer devices that are not on a BES, encryption is off by default. Encryption status of any BlackBerry 10 handset has to be proven on a case by case basis. Please note that this does NOT apply to BlackBerry Android devices (BlackBerry Priv and DTEK50), which have full-disk encryption enforced out of the box.</p>

        </div>

      </div>

      <p> <span class="emphasis"><em>Is the device on a BES?</em></span> Depending on the version of BB10 OS, the device may only be able to employ PGP encryption if it's on a BES; user-selectable <span class="strong"><strong>Data protection</strong></span> may use a different encryption scheme.While decrypting a device that is on a BES can be possible remotely via the BES, breaking through user-selectable encryption is not possible without knowing the correct device password.</p>

      <p> <span class="emphasis"><em>Do you know the password?</em></span> If you know the device password, you may be able to log into the device and make it produce a full backup through BlackBerry Link or a third-party tool. The backup will be encrypted with a key stored online; you will only be able to decrypt the backup if you know the correct BlackBerry ID password.</p>

      <p> <span class="emphasis"><em>Do you have access to a backup?</em></span> If you have access to an existing backup file, you may be able to decrypt it if the original BlackBerry ID password is known. Without this password, decrypting the backup is impossible, as the decryption key is stored on the server.</p>

    </div>

    <div class="section" title="BlackBerry 10 backups">

      <div class="titlepage">

        <div>

          <div>

            <h2 class="title" id="toc_3"><a id="ch09lvl2sec111"/>BlackBerry 10 backups</h2>

          </div>

        </div>

      </div>

      <p>Despite the similar naming convention, BlackBerry 10 is a completely new system that differs from BlackBerry OS in every imaginable way. How much different? It's on the same level as the differences between Symbian and Android.</p>

      <p>The newOS is based on a <span class="strong"><strong>micro kernel architecture</strong></span> (<span class="strong"><strong>QNX</strong></span>), which is substantially different from mono-kernel architectures such as those used in Android and iOS. No wonder that BlackBerry 10 introduced major changes to the OS security model. SD card encryption no longer compromises the device password. Local backups are now handled by BlackBerry Link, and are always encrypted with a highly secure encryption key based on the user's BlackBerry ID as opposed to a user-selectable password. The encryption key is stored deep in the device and cannot be extracted with a chip-off. However, this key can be used to restore (and decrypt) backups on new BlackBerry devices, and thus it can be obtained from BlackBerry servers.</p>

      <p>What exactly happens when the user creates a backup with BlackBerry Link?</p>

      <p> </p>

      <div class="mediaobject">

        <img src="0161.jpeg" alt="BlackBerry 10 backups"/>

        <div class="caption">

          <p>Using BlackBerry Link to back up a BlackBerry Passport</p>

        </div>

      </div>

      <p> </p>

      <p>When setting up a new BlackBerry device with an existing BlackBerry ID, the device connects to a BlackBerry server and receives a binary encryption key tied to that BlackBerry ID. This key is then stored in a secure area in the device. This area is not accessible from the outside and cannot be obtained from eMMC dumps or via chip-off; only BlackBerry OS has access to this key.</p>

      <p>The encryption key is quite secure. Unlike Apple's <code class="literal">securityd</code>, BlackBerry's encryption scheme does not depend on hardware. Instead, the key is tied to the user's BlackBerry ID and is stored on the server. All this allows users to restore a new device with exactly the same data complete with sensitive information. The encryption key is not changed when the user changes or resets their BlackBerry password. The same key is used after hardware upgrades, which proves that the key is not hardware-dependent.</p>

      <p>When the user makes a backup with BlackBerry Link or a third-party tool such as Sachesi or Darcy's BlackBerry Tools, the tool does not receive unencrypted data. Instead, the tool passes a command to the BlackBerry device, and the device itself encrypts information on the fly. The encrypted data is streamed to BlackBerry Link (or an alternative application). Similar to Apple iTunes, BlackBerry Link is not responsible for making backups; it simply receives an encrypted data stream and saves it to a file.</p>

      <p>When restoring the same or new BlackBerry device, the device is initialized with a BlackBerry ID via the BlackBerry server. The encryption key is transmitted from the serverto the device. Only after receiving the encryption key can the device decrypt backups restored via BlackBerry Link. The decryption occurs in the device itself. In BlackBerry 10,the decrypted data never leaves the device.</p>

      <p>The initialization request can be intercepted by emulating a BlackBerry device being activated with a given BlackBerry ID. The BlackBerry ID is stored in the backup file in plain text. If you know the correct password protecting the user's BlackBerry ID account, you can then use Elcomsoft Phone Breaker to acquire the encryption key from the BlackBerry server and instantly decrypt local backups.</p>

      <p>After supplying the user's BlackBerry ID and password, you can decrypt the offline backup with Elcomsoft Phone Breaker. The following categories are available and will be produced:</p>

      <div class="itemizedlist">

        <ul class="itemizedlist">

          <li class="listitem" style="list-style-type: disc">Application data</li>

          <li class="listitem" style="list-style-type: disc">Media files (pictures and videos)</li>

          <li class="listitem" style="list-style-type: disc">Settings</li>

        </ul>

      </div>

      <div class="note" title="Note" style="">

        <div class="inner">

          <h3 class="title" id="toc_4"><a id="note55"/>Note</h3>

          <p> <span class="strong"><strong>Note</strong></span>: BlackBerry 10 can also backup application files (<code class="literal">.bar</code> files). The <code class="literal">.bar</code> files will not be extracted due to copyright reasons.</p>

        </div>

      </div>

      <p>Most information in BlackBerry 10 backups is available in plain text or SQLite format. This can be analyzed with general mobile forensic software.</p>

    </div>

    <div class="section" title="BlackBerry 10 - considering ISP and chip-off forensics">

      <div class="titlepage">

        <div>

          <div>

            <h2 class="title" id="toc_5"><a id="ch09lvl2sec112"/>BlackBerry 10 - considering ISP and chip-off forensics</h2>

          </div>

        </div>

      </div>

      <p>A JTAG port is not available in BlackBerry 10 handsets. However, advanced acquisition techniques such as ISP and chip-off may still be available depending on the device's encryption status.</p>

      <p>With BlackBerry losing its market share, the main reason to buy a BlackBerry is security. As a result, encryption is likely to be enabled on a BlackBerry 10 device being acquired. With encryption enabled, chip-off acquisition of a BlackBerry 10 phone is pointless without a valid decryption key, which cannot be dumped during chip-off.</p>

      <div class="note" title="Note" style="">

        <div class="inner">

          <h3 class="title" id="toc_6"><a id="tip56"/>Tip</h3>

          <p> <span class="strong"><strong>Important</strong></span>: In current versions of BlackBerry 10, encryption is not enabled by default, and needs to be activated by the end user or on the <span class="strong"><strong>BlackBerry Enterprise Server</strong></span> (<span class="strong"><strong>BES</strong></span>) administrator. Encryption status of any BlackBerry 10 handset has to be proven on a case by case basis.</p>

        </div>

      </div>

      <p>If a passcode is known for a particular device, checking whether encryption is enabled is easy:</p>

      <div class="orderedlist">

        <ol class="orderedlist arabic">

          <li class="listitem">Turn on and unlock the device.</li>

          <li class="listitem">On the home screen of the device, swipe down from the top of the screen.</li>

          <li class="listitem">Tap <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Security and </strong></span>Privacy | <span class="strong"><strong>Encryption</strong></span>:<p> </p><div class="mediaobject"><img src="0162.jpeg" alt="BlackBerry 10 - considering ISP and chip-off forensics"/></div><p> </p></li>

          <li class="listitem">Check if any of the following switches are set to <span class="strong"><strong>On</strong></span>:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Device Encryption</li><li class="listitem" style="list-style-type: disc">Media Card Encryption</li></ul></div><p> </p><div class="mediaobject"><img src="0163.jpeg" alt="BlackBerry 10 - considering ISP and chip-off forensics"/></div><p> </p></li>

        </ol>

      </div>

      <p>If a BlackBerry 10 device is locked with an unknown passcode, there is no easy way to verify if its encryption features are activated. One can then attempt performing a chip-off on the phone, in the hope to obtain an unencrypted image.</p>

      <p>We encounter unencrypted BlackBerry 10 devices every once in a while. Statistically, it is extremely rare to see a non-encrypted BlackBerry. However, we've seen multiple reports of successful chip-off acquisitions on new BlackBerry's including BlackBerry Classic, Z10, and Z30 with no issues.</p>

    </div>

    <div class="section" title="Acquiring BlackBerry 10 backups">

      <div class="titlepage">

        <div>

          <div>

            <h2 class="title" id="toc_7"><a id="ch09lvl2sec113"/>Acquiring BlackBerry 10 backups</h2>

          </div>

        </div>

      </div>

      <p>BlackBerry 10 devices use BlackBerry Link to make offline backups. In addition, BlackBerry 10 no longer has the Wallet. However, the Keeper app is still available, and is part of the BlackBerry operating system starting with version 10.3.</p>

      <div class="section" title="Using Elcomsoft Phone Breaker">

        <div class="titlepage">

          <div>

            <div>

              <h3 class="title" id="toc_8"><a id="ch09lvl3sec45"/>Using Elcomsoft Phone Breaker</h3>

            </div>

          </div>

        </div>

        <p>You will need a BlackBerry backup <code class="literal">*.bbb</code> file to decrypt the BlackBerry Link backup. You will also need a password for the BlackBerry ID of the user who created the backup.</p>

        <p>To decrypt a BlackBerry Link backup, do as follows:</p>

        <div class="orderedlist">

          <ol class="orderedlist arabic">

            <li class="listitem">When the backup is loaded, you can view the following information about the backup:</li>

            <li class="listitem">Select the BlackBerry backup file (<code class="literal">*.bbb</code>) by drag-and-dropping it to the <span class="strong"><strong>Decrypt backup</strong></span> window, or click <span class="strong"><strong>Choose backup</strong></span> to navigate to the necessary file manually.</li>

            <li class="listitem">Select <span class="strong"><strong>Decrypt backup</strong></span>.</li>

            <li class="listitem">In the <span class="strong"><strong>Tools</strong></span> menu, select the <span class="strong"><strong>BlackBerry</strong></span> tab.<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Backup date</strong></span>: The local time on the PC/Mac, where backup has been created (we simply do not modify that field as it is extracted from the backup file, that is, show it as is)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Product type</strong></span>: The type of BlackBerry device that was backed up</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>PIN</strong></span>: The ID of the BlackBerry device</li></ul></div><p> </p></li>

            <li class="listitem">You can select a different backup by clicking <span class="strong"><strong>Change backup</strong></span> next to the backup name.<p> </p><div class="mediaobject"><img src="0164.jpeg" alt="Using Elcomsoft Phone Breaker"/></div><p> </p></li>

            <li class="listitem">Define options for backup decryption:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Save decrypted to</strong></span>: Select the location for saving the decrypted backup.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Associated BlackBerry ID user name</strong></span>: The BlackBerry ID (email) of the user who created a backup.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>BB ID password</strong></span>: Enter the password to the BlackBerry ID displayed in italics in <span class="strong"><strong>Associated BlackBerry ID user name</strong></span>. Toggle the <span class="strong"><strong>View</strong></span> button to display the password as characters or in asterisks (<span class="emphasis"><em>*</em></span>).</li></ul></div></li>

            <li class="listitem">Click <span class="strong"><strong>Decrypt</strong></span>.</li>

            <li class="listitem">The decryption process starts.</li>

            <li class="listitem">When the decryption is finished, you can view the backup in the location on the local computer to which it was saved by clicking the <span class="strong"><strong>View</strong></span> button.<p> </p><div class="mediaobject"><img src="0165.jpeg" alt="Using Elcomsoft Phone Breaker"/></div><p> </p></li>

            <li class="listitem">Click <span class="strong"><strong>Finish</strong></span> to close the <span class="strong"><strong>Decrypt backup</strong></span> window.</li>

          </ol>

        </div>

        <p>The backup is now available on your computer for further analysis. You can use Elcomsoft Phone Viewer to browse and view the content of the backup.</p>

      </div>

      <div class="section" title="Using Oxygen Forensic Suite">

        <div class="titlepage">

          <div>

            <div>

              <h3 class="title" id="toc_9"><a id="ch09lvl3sec46"/>Using Oxygen Forensic Suite</h3>

            </div>

          </div>

        </div>

        <p>If you own a license to Oxygen Forensic Suite, you can use the tool's built-in acquisition wizard to import encrypted BlackBerry 10 backups. Oxygen Forensic Suite uses technology from Elcomsoft Phone Breaker to obtain the decryption key from BlackBerry servers using the correct BlackBerry ID and password.</p>

        <div class="orderedlist">

          <ol class="orderedlist arabic">

            <li class="listitem">Use <span class="strong"><strong>Import File</strong></span> | <span class="strong"><strong>Import Blackberry backup </strong></span> | <span class="strong"><strong>Import BB10 backup...</strong></span>.<p> </p><div class="mediaobject"><img src="0166.jpeg" alt="Using Oxygen Forensic Suite"/></div><p> </p></li>

            <li class="listitem">You will be prompted to enter the BlackBerry ID password (<span class="emphasis"><em>not</em></span> the device password):<p> </p><div class="mediaobject"><img src="0167.jpeg" alt="Using Oxygen Forensic Suite"/></div><p> </p></li>

            <li class="listitem">If the correct password is entered (the tool checks it immediately after you click the <span class="strong"><strong>Apply password</strong></span> button), you will be able to fill in case details, after which the following summary screen will appear:<p> </p><div class="mediaobject"><img src="0168.jpeg" alt="Using Oxygen Forensic Suite"/></div><p> </p></li>

            <li class="listitem">Click <span class="strong"><strong>Extract</strong></span>, and the tool will begin decrypting the backup:<p> </p><div class="mediaobject"><img src="0169.jpeg" alt="Using Oxygen Forensic Suite"/></div><p> </p></li>

            <li class="listitem">Depending on the size of the backup, the process may take a reasonably long time. For example, the decryption of a 7.57 GB backup took approximately 25 minutes.</li>

          </ol>

        </div>

      </div>

    </div>

  </div>




  <div class="section" title="Analyzing BlackBerry backups">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch09lvl1sec59"/>Analyzing BlackBerry backups</h1>

        </div>

      </div>

    </div>

    <p>There are many forensic tools on the market that can parse and analyze information stored in BlackBerry backups (provided that the password is known or recovered). ElcomSoft makes the following tools:</p>

    <div class="itemizedlist">

      <ul class="itemizedlist">

        <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Elcomsoft BlackBerry Backup Explorer</strong></span> (BlackBerry 1.0-7.1 only) at <a class="ulink" href="http://www.elcomsoft.com/ebbe.html">http://www.elcomsoft.com/ebbe.html</a></li>

        <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Elcomsoft Phone Viewer</strong></span> (BlackBerry 10, iOS, and Windows Phone) at <a class="ulink" href="http://www.elcomsoft.com/epv.html">http://www.elcomsoft.com/epv.html</a></li>

      </ul>

    </div>

    <p>Elcomsoft BlackBerry Backup Explorer (for backups produced with BlackBerry 1.0 through 7.1) can access encrypted information stored in password-protection backups if the original password is known or recovered with Elcomsoft Phone Breaker. With the tool, you can extract essential information available in BlackBerry backups, analyze, print, and export information. Elcomsoft BlackBerry Backup Explorer is one of the few tools that can take an encrypted backup and decrypt it on-the-fly with the supplied password.</p>

    <p>Elcomsoft Phone Viewer can access decrypted BlackBerry 10 backups. In order to view a BlackBerry 10 backup, first decrypt it with Elcomsoft Phone Breaker. Then open Elcomsoft Phone Viewer and click <span class="strong"><strong>Choose backup</strong></span>:</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0170.jpeg" alt="Analyzing BlackBerry backups"/>

    </div>

    <p> </p>

    <p>The tool defaults to displaying the list of iTunes backups (if available). To load a BlackBerry 10 backup, click <span class="strong"><strong>Choose another</strong></span>:</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0171.jpeg" alt="Analyzing BlackBerry backups"/>

    </div>

    <p> </p>

    <p>From the file dialog that appears, select the BlackBerry 10 backup you are about to view. The tool will import the backup.</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0172.jpeg" alt="Analyzing BlackBerry backups"/>

    </div>

    <p> </p>

    <p>Once the backup is imported, you will see an overview of information available in the device.</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0173.jpeg" alt="Analyzing BlackBerry backups"/>

    </div>

    <p> </p>

    <p>Elcomsoft Phone Viewer allows viewing <span class="strong"><strong>Calendars</strong></span>, <span class="strong"><strong>Calls</strong></span>, <span class="strong"><strong>Contacts</strong></span>, <span class="strong"><strong>Media</strong></span> (pictures and video, including cached images and map tiles), <span class="strong"><strong>Messages</strong></span>, and <span class="strong"><strong>Notes</strong></span>. You'll be able to use filters specifying date range, incoming/outgoing,and so on.</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0174.jpeg" alt="Analyzing BlackBerry backups"/>

    </div>

    <p> </p>

    <p>If you need more analytic features, you can use one of the fully featured mobile forensic tools such as Oxygen Forensic Suite. In particular, Oxygen Forensic Suite enables full-text search through the entire filesystem of the backup.</p>

    <p> </p>

    <div class="mediaobject">

      <img src="0175.jpeg" alt="Analyzing BlackBerry backups"/>

    </div>

    <p> </p>

  </div>




  <div class="section" title="Summary">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch09lvl1sec60"/>Summary</h1>

        </div>

      </div>

    </div>

    <p>In this chapter, we reviewed acquisition methods for two distinct generations of BlackBerry devices: BlackBerry OS 1 through 7 and BlackBerry 10. We learned how to acquire BlackBerry backups depending on the OS, and reviewed a vulnerability allowing us to recover a device passcode if its media card was encrypted in legacy BlackBerry OS devices. We did not look at BlackBerry Android devices, as their acquisition approach would be similar to acquiring any other Android device.</p>

    <p>The next chapter discusses obstacles, special cases, and considerations when acquiring mobile devices.</p>

  </div>

</body></html>