<html><head></head><body>
		<div><h1 id="_idParaDest-114"><a id="_idTextAnchor123"/>Chapter 7: Owning Security Operations</h1>
			<p>You've implemented your vision of an excellent, continuously improving information security strategy, with the appropriate controls to ensure your organization is secure and compliant. Nicely done! How are you going to stay on top of things? In the event of a security event or incident, how will you investigate? What is required to ensure we stay online, keep the organization's assets available, and enable people to work on their day-to-day tasks without interruption? This chapter is devoted to the never-ending task of security operations and how it aligns with the business' vision for the organization.</p>
			<p>We'll look <a id="_idTextAnchor124"/>at the following topics in this chapter:</p>
			<ul>
				<li>Effective strategies in provisioning resources and maintaining assets</li>
				<li>Focusing on availability, disaster recovery, and business continuity activities</li>
				<li>Managing upgrades, patching, and applying security controls</li>
				<li>Investigating events and responding to incidents </li>
				<li>Implementing and utilizing detective controls</li>
				<li>Using security monitoring to improve visibility</li>
				<li>Security monitoring best practices</li>
			</ul>
			<p>Let's get started! First of all, let's look at some effective strategies in provisioning resources and maintaining assets. </p>
			<h1 id="_idParaDest-115"><a id="_idTextAnchor125"/>Effective strategies in provisioning resources and maintaining assets </h1>
			<p>There <a id="_idIndexMarker782"/>was a poll conducted by Automox in companies with <a id="_idIndexMarker783"/>between 500 and 25,000 employees, with over 500 IT and InfoSec professionals answering the questions (<a href="https://www.darkreading.com/vulnerabilities---threats/missing-patches-misconfiguration-top-technical-breach-causes/d/d-id/1337410">https://www.darkreading.com/vulnerabilities---threats/missing-patches-misconfiguration-top-technical-breach-causes/d/d-id/1337410</a>). Automox found that <a id="_idIndexMarker784"/>over 80% had been breached over the past 2 years, and the following numbers show the vulnerability type that was exploited in those breaches:</p>
			<ul>
				<li>Missing operating system patches (30%)</li>
				<li>Missing application patches (28%)</li>
				<li>Operating system misconfiguration (27%)</li>
			</ul>
			<p>The chain of events that occurs after a successful phishing attempt or credential harvest generally involves exploiting one of the preceding vulnerabilities. The brilliant thing is that we can prevent this with the provisioning of approved configurations and ensuring our assets are maintained, with both operating system and application patches and updates.</p>
			<p>This section is all <a id="_idIndexMarker785"/>about how we can ensure that the <a id="_idIndexMarker786"/>assets in our estate are maintained and up to date for their entire life cycle. It's a continual process but saves time and effort and ensures the organization is innovating their offering instead of purely reacting to information security threats and racing to update their legacy software. </p>
			<h2 id="_idParaDest-116"><a id="_idTextAnchor126"/>Provisioning resources</h2>
			<p>Within a digital <a id="_idIndexMarker787"/>estate, information systems are constantly being added, removed, and changed. Unfortunately, this is often done with very little oversight or without any guidance on best practices. </p>
			<p>When we add n<a id="_idTextAnchor127"/>ew assets to our estate, what kind of process is involved? Do we "just do it," without a wider strategy defined? What kind of visibility do we have on our asset versions or operating systems? </p>
			<p>Furthermore, in the era of cloud computing, with provisioning being as easy as a click of a couple of buttons in a web browser, how can we avoid <strong class="bold">shadow IT</strong> (the use of systems, devices, software, or other IT solutions without the approval of the IT department), and be sure that when employees at your organization "spin up a new server," our process is followed, and that our InfoSec strategy is considered?</p>
			<h3>Policies</h3>
			<p>As you've progressed through this book, you'll have become accustomed to my view on policies: the power of <a id="_idIndexMarker788"/>defining your approach in your information security policy documents is paramount. The same is true for the provisioning and maintenance of information systems. We need to be specific in guiding users toward the right answers. You don't necessarily need to define the "approved" versions of operating systems or which features should be disabled directly inside the policy document; in fact, I would recommend against doing so, as it will require continual updates in order to stay relevant. </p>
			<p>Instead, you can point toward another resource that is updated continually, stating something along the lines of "approved operating system versions and configurations can be found here: &lt;link&gt;." Then, in the linked document, it's possible to update and cater the information to match your strategy, without the document upkeep, while ensuring everybody has the correct version of the information security policy available to them. </p>
			<h3>Configuration management</h3>
			<p>When we look <a id="_idIndexMarker789"/>at the aforementioned link that contains the "approved" configurations, how should that be handled? Where do we get the "good" configurations from, and how can we define what <a id="_idIndexMarker790"/>we need in our organization in order <a id="_idIndexMarker791"/>to ensure operations are maintained? </p>
			<p>Thankfully, there <a id="_idIndexMarker792"/>are tools for <strong class="bold">software configuration management</strong>, or <strong class="bold">SCM</strong>. Popular choices <a id="_idIndexMarker793"/>include the <a id="_idIndexMarker794"/>following: </p>
			<ul>
				<li>Microsoft <strong class="bold">System Center Configuration Manager</strong> (<strong class="bold">SCCM</strong>), or <strong class="bold">Configuration Manager</strong></li>
				<li><strong class="bold">SolarWinds Server Configuration Monitor</strong></li>
				<li><strong class="bold">Ansible</strong>/<strong class="bold">Ansible Tower</strong></li>
				<li><strong class="bold">Puppet </strong></li>
				<li><strong class="bold">Chef </strong></li>
			</ul>
			<p>These <a id="_idIndexMarker795"/>tools provide various <a id="_idIndexMarker796"/>features, including the <a id="_idIndexMarker797"/>following:</p>
			<ul>
				<li>Remote management</li>
				<li>Patching </li>
				<li>Software distribution </li>
				<li>Operating system deployment </li>
				<li>Configuration management </li>
				<li>Maintaining software and hardware inventories of each asset</li>
			</ul>
			<p>This can help you as an information security professional in several ways. Consider the fact that you now have a list of assets and the software used by each of those assets. This can help feed into your asset and risk registers and provide accurate real-time information about each asset, along with streamlining point-in-time assessments such as audits. With configuration management, we also ensure to document all changes, in order to easily troubleshoot misconfigurations, outages, performance degradations, and sources of non-compliance to standards, and increase the auditability of an estate. </p>
			<p>Additionally, we <a id="_idIndexMarker798"/>have governance structures available to us in order to set baseline configurations and implement a change control process to ensure that any changes to production systems are done in a systemized, planned way. By implementing these governance controls, such as requiring that an administrator verifies the changes made to any system or network configuration before proceeding (<em class="italic">separation of duties</em>), you reduce the risk of misconfigurations leading to either downtime or security vulnerabilities. </p>
			<p>There may be pushback from operational employees on setting up governance structures, with complaints such as "it goes against our way of working previously," or "it will slow us down." Keep in mind that from the organization's perspective, the time saved from having to restore systems, the money saved from not breaking your <strong class="bold">SLAs</strong>, the prevention of reputational damage, and the peace of mind to move ahead knowing that the estate is properly maintained with checks and balances in place will be worth the slight loss of velocity in making changes (if there even is a loss in velocity in the first place). Automation of the processes can help lift blockers and prevent the types of headaches many employees may predict. </p>
			<p>When we look at effective use of configuration management tools, we should <a id="_idIndexMarker799"/>consider the following practices: </p>
			<ul>
				<li>Ensure to categorize and group systems into a taxonomy that makes sense to your organization. These categories and subcategories are able to be batch-changed, so ensure you and your fellow architects take that into consideration in the design. </li>
				<li>We need to define base configurations that are "approved" and document the reasoning and labeling for each of these configurations. There are organizations such <a id="_idIndexMarker800"/>as the <strong class="bold">Center for Internet Security</strong> (<strong class="bold">CIS</strong>) that offer "hardened images." It's likely that these operating system and application images are aligned with secure configuration guidelines, such as the CIS Benchmarks, enabling quick and easy deployment of secure systems across cloud and on-prem environments, without having to define the requirements <a id="_idIndexMarker801"/>yourself. Further reading can be found at <a href="https://www.cisecurity.org/cis-hardened-images/">https://www.cisecurity.org/cis-hardened-images/</a>.</li>
				<li>When making changes to systems, all information about the change (user, time, changes made, systems affected) should be documented and tracked, and the process should employ an effective <em class="italic">separation of duties</em> principle to ensure breaking changes aren't able to be made by a sole individual. </li>
				<li>Ensure that there is a match between the testing and production environments, from operating systems, software versions, networking configurations, and so on. The better aligned your environments are, the less likely you are to see downtime or unnoticed vulnerabilities when the time comes for moving changes to production. </li>
				<li>It's also possible to automate the process of rolling back or remediation efforts in the <a id="_idIndexMarker802"/>event of a perceived fault. </li>
			</ul>
			<p>With that said, many organizations are <a id="_idIndexMarker803"/>moving toward an idea called <strong class="bold">Infrastructure as Code</strong> (<strong class="bold">IaC</strong>), which closely aligns <a id="_idIndexMarker804"/>with the <strong class="bold">DevOps</strong> and <strong class="bold">Continuous Integration/Continuous Deployment</strong> (<strong class="bold">CI/CD</strong>) methodologies <a id="_idIndexMarker805"/>of IT management and software development. Let's have a look at what IaC offers. </p>
			<h4>Infrastructure as code</h4>
			<p>There is a concept called IaC that is <a id="_idIndexMarker806"/>a hugely beneficial approach from both a security perspective as well as an IT operations perspective. The basic idea of IaC is that your estate is moving more and more away from being physical servers in a specific location and toward a fully virtualized, distributed cloud environment. Therefore, instead of provisioning, managing, scaling, and de-provisioning physical hardware or utilizing the traditional, interactive configuration management tools that are catered to those types of hardware, your estate and all of the information processing facilities within can instead be defined in <em class="italic">machine-readable files</em>, which are <em class="italic">versioned</em> and updated the same way software code is updated, to be referenced by automation software in a hands-off provisioning/scaling/de-provisioning process. </p>
			<p>This idea is tightly coupled with <strong class="bold">DevOps</strong> and <strong class="bold">CI/CD</strong> practices, rather than the more traditional split between IT operations and software developers. The aim of <em class="italic">IaC</em>, and most <em class="italic">DevOps</em> and <em class="italic">CI/CD</em> practices in general, is to increase the velocity of improvements and speed up and improve the efficiency of deployments, with higher-quality software being deployed, by reducing error-laden manual processes. </p>
			<p>Before we touch on IaC tooling and formats, I would like to mention that IaC paradigms often involve leveraging containers and orchestration software, such as <strong class="bold">Docker</strong> and <strong class="bold">Kubernetes</strong>, respectively. </p>
			<p><strong class="bold">Docker</strong> builds <em class="italic">container images</em> based on the <a id="_idIndexMarker807"/>instructions defined inside a <strong class="bold">Dockerfile</strong>, which is a text <a id="_idIndexMarker808"/>file containing all of the commands required for building an image for a system (such as an application and its dependencies) as what is known as a <strong class="bold">container</strong>. Containers are <a id="_idIndexMarker809"/>a lightweight alternative to VMs, having been decoupled from the underlying infrastructure of the server it runs on. With that, one server can be running containers based on thousands of different configurations, with different operating systems and software packages <a id="_idIndexMarker810"/>in each. Further reading on how Docker works can be found here: <a href="https://docs.docker.com/get-started/overview/">https://docs.docker.com/get-started/overview/</a>.</p>
			<p>Further reading on how <em class="italic">Dockerfiles</em> are defined <a id="_idIndexMarker811"/>and written can be found here: <a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">https://docs.docker.com/develop/develop-images/dockerfile_best-practices/</a>. </p>
			<p><strong class="bold">Orchestration software</strong> such as <strong class="bold">Kubernetes</strong> helps <a id="_idIndexMarker812"/>to automate the deployment of these <em class="italic">containers</em> across distributed environments, and aids in the operational aspects of deploying, managing, and scaling containers. The baseline configuration for the way the orchestration software will behave is usually defined in a <strong class="bold">YAML</strong> text file, with further changes being made through either a frontend web app interface or command-line interface tools. Further <a id="_idIndexMarker813"/>reading on Kubernetes can be found here: https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/.</p>
			<p>What's the reason I wanted to briefly delve into these, you ask? I wanted to highlight the requirement from an information security perspective to keep on top of the way your organization <a id="_idIndexMarker814"/>operates. IT changes incredibly fast, and it's important to understand the concepts surrounding new tech in order to ensure the processes and solutions are appropriately secure. In this example, consideration should be made on how to ensure these tools and text files are checked for security concerns, as well as version-controlled. These new ways of packaging and deploying software are increasingly becoming the way your organization's estate is built, and without the proper governance and procedures defined by your organization, they could present new opportunities for malicious actors to exploit vulnerabilities. </p>
			<p>When it comes to IaC, after creating the Dockerfiles/YAML required for packaging and deploying applications in your organization, you will need to ensure the infrastructure the software <a id="_idIndexMarker815"/>is deployed to is configured correctly. Enter <strong class="bold">Continuous Configuration Automation</strong> (<strong class="bold">CCA</strong>) tooling. CCA utilizes the principles of IaC and references IaC<em class="italic"> </em>definition files in order to automate the configuration management aspects of IT we previously referenced.  </p>
			<p>You might ask, "Well, why did you go into configuration management tools earlier if you were just going to tell us that that is the old way of doing things, and there's this new, better way?!"</p>
			<p>The grand thing is, you're generally looking at the same group of tools as before! Some popular CCA tools <a id="_idIndexMarker816"/>include the following: </p>
			<ul>
				<li><strong class="bold">Ansible</strong>/<strong class="bold">Ansible Tower</strong></li>
				<li><strong class="bold">Chef</strong></li>
				<li><strong class="bold">Puppet</strong></li>
				<li><strong class="bold">SaltStack</strong></li>
			</ul>
			<p>Compared to the <a id="_idIndexMarker817"/>previous list, we <a id="_idIndexMarker818"/>can see that there is an <a id="_idIndexMarker819"/>overlap between the <a id="_idIndexMarker820"/>traditional configuration management tools and CCA tools, in Ansible, Chef, and Puppet, among others. These give a traditional "frontend" configuration dashboard, accessible via a browser, and provide the graphical inventory management and reporting we might expect and require from our traditional configuration management tools. </p>
			<p>These <em class="italic">DevOps-focused</em> ideologies, tools, and solutions give developers and system administrators the opportunity to simply "declare" the infrastructure that is to be deployed inside <a id="_idIndexMarker821"/>their code, and automation tooling takes that declaration and then references the predefined "approved" blueprints, which can be configured to ensure compliance with security and regulatory <a id="_idIndexMarker822"/>requirements, (oftentimes called <strong class="bold">policy as code</strong>). </p>
			<p>So, to the same extent that we're able to create our policies for humans to read, we're able to define those same policies into a <em class="italic">machine-readable format</em> and ensure the appropriate configuration is deployed every time, in an automated, error-free way. We now have an auditable, measured, predefined set of "approved" infrastructure and deployment scenarios, which are continually monitored for unauthorized changes, and any circumvention or noncompliance is torn down while simultaneously being replaced with a compliant version. Taking your risks into consideration, this is absolutely beautiful. Additionally, we've sorted many <em class="italic">integrity and availability</em> issues out in the process, providing the tooling is reliable and the solution is well-architected for your organization. </p>
			<p>From a <em class="italic">confidentiality</em> perspective, we're able to automate the creation and declaration of super-strong secrets, tokens, passwords, and keys, which are never handled by individuals, by utilizing a <strong class="bold">secrets management</strong> automation tool <a id="_idIndexMarker823"/>such as <strong class="bold">HashiCorp Vault</strong>. </p>
			<p>With <em class="italic">secrets management</em>, you <a id="_idIndexMarker824"/>are able to programmatically create, revoke, and rotate your organization's secrets in a dynamic way, responding to changes or requirements as set out by policy definitions or detected activity. By doing so, you can automate the efficient encryption of data at rest or in transit, with zero knowledge of the keys, and audit logs of all interactions. Furthermore, automation of the secrets management process can lead to a highly efficient <em class="italic">just-in-time</em> solution for authorization. </p>
			<p>Of course, there are some downsides to the IaC CCA approach. Community repositories with pre-made container configuration <a id="_idIndexMarker825"/>files such as <strong class="bold">Docker Hub</strong> have hundreds of thousands of projects that have been left to "rot." These files contain out-of-date definitions, poor security <a id="_idIndexMarker826"/>practices, or back-doors and malware written into the definition on purpose, waiting for somebody who is in a rush (or unable to properly read and understand the file) to deploy a vulnerability into their estate. </p>
			<p>Keep in mind that this isn't an edge case, either. The threat intelligence team at Palo Alto Networks previously discovered that 65% of the publicly disclosed cloud security incidents in 2019 were the result of misconfigurations by the organization's staff. When they investigated why that number was so high, they uncovered a culture inside the companies utilizing the DevOps methodology that values the velocity of creating new features over governance and security. Combined with that push for velocity, there sit hundreds of thousands of risky templates, available for free, in trusted providers' (such as Docker Hub's) open source, searchable repository libraries. Further reading on the topic can be found here: <a href="https://www.paloaltonetworks.com/company/press/2020/palo-alto-networks-report-finds-poor-security-hygiene-leads-to-escalating-cloud-vulnerabilities">https://www.paloaltonetworks.com/company/press/2020/palo-alto-networks-report-finds-poor-security-hygiene-leads-to-escalating-cloud-vulnerabilities</a>.</p>
			<p>With that taken into consideration, we can agree that IaC doesn't remove the need to implement and follow change control and approval processes, even with a heightened level of speed and automation at the core of things. We have to remember that eliminating these governance steps increases the risk of implementing changes that introduce unknown risks to the organization. </p>
			<p>A few appropriate ideologies for the processes and procedures in an IaC deployment pipeline could include the following: </p>
			<ul>
				<li>Ensuring you have employed the <a id="_idIndexMarker827"/>principle of <em class="italic">least-privilege</em> for your users. You don't want to give them the keys to the castle or the opportunity to turn off features in the pipeline in order to circumvent certain protections and checks along the way. Furthermore, there shouldn't be a way for your users to be able to gain access to the production server they have deployed their code to. </li>
				<li>Security checks and scans can be undertaken for the machine-readable text files that define the infrastructure at multiple stages of the development and deployment process:<p>– DevOps engineers or developers can have their text files scanned right in their IDE, where they write their code, checking for known bad configurations and images. </p><p>– The Git <a id="_idIndexMarker828"/>repository, such as GitHub, GitLab, or Bitbucket, can integrate with a security scanner to check for known misconfigurations or malicious items inside the <a id="_idIndexMarker829"/>files. Solutions such as <strong class="bold">Snyk.io</strong> can be involved in the CI/CD process to ensure the IaC definitions that are being utilized are secure. </p><p>– Tools such as Snyk are able to scan the IaC configuration files to report on vulnerabilities such as the containers running in privileged mode/as a privileged user or not having a memory and CPU limit set. </p><p>– These scans can also check to ensure the infrastructure is running at the most up-to-date and secure operating system and application versions. </p></li>
				<li>The IaC tooling itself should be maintained and we need to ensure that we're running the latest, most secure versions. </li>
			</ul>
			<p>To summarize, with IaC, we are able to implement automated methods for reducing the risk of misconfiguration and outdated infrastructure, including pipeline-based security scans for infrastructure occurring through the change control stages. </p>
			<p>With automation and the appropriate level of testing, you reduce the risk of errors by removing the human element from your deployments, updates, and changes. A good script will execute effectively every single time it's run and requires less hands-on time and effort from your employees. </p>
			<p>These automated solutions should prevent infrastructure from being deployed in the event of an unacceptable level of risk being detected, and it's your job to determine that level of risk as suitable to your organization, and communicate that to the appropriate staff. </p>
			<p>Additionally, with the appropriate level of monitoring and detection of changes, we can ensure systems recover <a id="_idIndexMarker830"/>predictably after an outage or similar event. If, for example, only a single server goes down, we can create rules to automatically deploy a mirror of that server in its place, instead of waiting for a staff member to notice the outage, diagnose the cause for the outage, and remediate the flaw. </p>
			<p>On the topic of outages, I think it's about time to move on to talking about focusing on availabili<a id="_idTextAnchor128"/><a id="_idTextAnchor129"/>ty, disaster recovery, and business continuity. </p>
			<h1 id="_idParaDest-117"><a id="_idTextAnchor130"/>Focusing on availability, disaster recovery, and business continuity</h1>
			<p>We need to <a id="_idIndexMarker831"/>be honest when we <a id="_idIndexMarker832"/>talk about information <a id="_idIndexMarker833"/>security; it's not always about defending against malicious hackers trying to grab our organization's precious intellectual property. In reality, many occasions you will face in your career will be surrounding an outage due to a power cut or a simple software update gone wrong, taking down a production system. </p>
			<p>Just because these threats aren't adversarial, does not imply that they're any less real. The opposite may be true, in fact: we might face outages from non-adversarial events more often than we face malicious actors. Therefore, we <a id="_idIndexMarker834"/>need to ensure that we have effective <a id="_idIndexMarker835"/>change control policies in <a id="_idIndexMarker836"/>place and follow them, and we need to define and rehearse disaster recovery and business continuity processes in order to ensure maximum uptime. </p>
			<h2 id="_idParaDest-118"><a id="_idTextAnchor131"/>Defining, implementing, and testing disaster recovery processes</h2>
			<p>Disaster recovery is all about <a id="_idIndexMarker837"/>establishing the appropriate documentation, planning, and practice required to ensure we can recover from either natural or human-caused disasters and <a id="_idIndexMarker838"/>restore critical <a id="_idIndexMarker839"/>busines<a id="_idTextAnchor132"/>s functions. It <a id="_idIndexMarker840"/>differs from business continuity in that business continuity is focused on ensuring all critical business functions remain online and function regardless of a disruptive event or disaster, while disaster recovery is about restoration. </p>
			<p>For example, as I've discussed in previous chapters, your organization can face natural disasters such as floods, earthquakes, and tornadoes. We have pandemics and warfare activities ongoing globally at the time of writing. You might face a hazardous waste scenario, explosions, or even cyber-attacks that lead to your business either being taken offline or your personnel having to get away from a typical workspace. </p>
			<p>For all of these <a id="_idIndexMarker841"/>disasters, we face the potential for loss. In 2015, the IT <strong class="bold">Disaster Recovery Preparedness</strong> (<strong class="bold">DRP</strong>) Council reported that small businesses could face up to $8,000 of loss from every hour of downtime. Mid-size companies in the same report faced a loss of up to $74,000 per hour, and large enterprises were reported to face up to $700,000 loss for every hour of downtime in the event of a disaster. Further reading can be found here: <a href="https://www.researchgate.net/publication/343063858_PLANNING_FOR_DISASTER_RECOVERY_CAN_LEAD_TO_AVOIDING_DISASTER">https://www.researchgate.net/publication/343063858_PLANNING_FOR_DISASTER_RECOVERY_CAN_LEAD_TO_AVOIDING_DISASTER</a>. </p>
			<p>In order to prepare the appropriate disaster recovery plans, we need some documentation that will seem remarkably familiar, as we have previously mentioned the same things over and over again in this book: </p>
			<ul>
				<li>Clear, straightforward playbooks that can be followed by anybody without distraction. This means clear labeling and ensured availability (even during an outage or offsite scenario). </li>
				<li>Policy documents that clearly state the roles and responsibilities for your organization, in addition to requirements from a business perspective, which could include compliance requirements from regulatory bodies or SLAs. </li>
			</ul>
			<p>Once these documents have been created, it's priority <em class="italic">numero uno</em> to go over these plans – not only as a tabletop simulation but also as a real-life scenario, with actual evacuations and infrastructure and system restorations performed, in order to find any logical or <a id="_idIndexMarker842"/>technical gaps from the theory to the reality. If any gaps <a id="_idIndexMarker843"/>are found, the remediations must <a id="_idIndexMarker844"/>be planned and implemented, and then the test scenario should be recreated to establish the effectiveness of the changes. </p>
			<p>Of course, this is all centered on risk. You focus on your most critical assets and systems and prioritize the restoration activities based on what is critical to the operation of your business. </p>
			<p>Connected closely to disaster recovery, so much that I didn't know which one to speak about first, I would like to very briefly talk about business continuity, even though I've touched on it in previous chapters. </p>
			<h2 id="_idParaDest-119"><a id="_idTextAnchor133"/>Managing business continuity design, planning, and testing</h2>
			<p>A closely <a id="_idIndexMarker845"/>related function to disaster recovery is <a id="_idIndexMarker846"/>business continuity. Business continuity is <a id="_idIndexMarker847"/>focused on ensuring all critical business functions remain online and functional regardless of a disruptive event or disaster. In a way, you might see that disaster recovery is merely a subsection of business continuity. Through establishing all the appropriate documentation, planning, training, and testing required, we're able to ensure our organization is resilient in the face of adversity or in the event of a disruption. </p>
			<p>Something worth considering for both disaster recovery and business continuity is the ideas surrounding hot sites, warm sites, and cold sites.</p>
			<p><strong class="bold">Hot sites</strong> refer to active infrastructure serving as an available and fully redundant mirror of your company's <a id="_idIndexMarker848"/>production systems, decoupled from the original infrastructure to reduce the likelihood of both systems being taken down simultaneously. If you have a hot site ready, it's a matter of lifting and shifting operations over. This is your most expensive option, but the one that is most ready to be engaged in the event of a disruption. </p>
			<p><strong class="bold">Warm sites</strong> are a synced version of <a id="_idIndexMarker849"/>your production systems that are ready to be deployed at a moment's notice, with some delays expected in the provisioning process. The benefit of a warm site is that it's much less expensive to have prepared. </p>
			<p><strong class="bold">Cold sites</strong> can be utilized for <a id="_idIndexMarker850"/>non-critical business operations or if your organization either doesn't face the level of risk to require a hot or warm site or doesn't have the budget to maintain either. Cold sites require provisioning from the bottom-up, but still offer an opportunity to recover quickly from failure or disaster. </p>
			<h2 id="_idParaDest-120"><a id="_idTextAnchor134"/>Implementing and managing physical security</h2>
			<p>As always, I'd <a id="_idIndexMarker851"/>like to briefly mention that physical security should be <a id="_idIndexMarker852"/>taken into consideration as an aspect of your responsibilities as an information security professional. Since the beginning of this book, we've talked about the risks facing your organization in the physical realm, from losses of availability due to severe weather or power outages to malicious actors physically breaching the perimeter and gaining access to confidential information. </p>
			<p>Plans and procedures for the various physical security events must be defined, workshopped, and practiced in order to ensure that your team is able to respond appropriately. Documentation must be held in a place that is easily and readily accessible by any person who might find themselves responsible, and the instructions must be clear and concise, as heightened levels of stress can lead to misinterpretations and confusion. </p>
			<p>As we have previously discussed various aspects of physical security throughout this book, I will keep this section concise and proceed to the summary of this section.  </p>
			<p>In this section, we covered ways we can focus on increasing our systems' availability through defining, implementing, and testing disaster recovery processes, as well as managing business <a id="_idIndexMarker853"/>continuity design, planning, and testing. Now that <a id="_idIndexMarker854"/>we've covered availability concerns, I would like to proceed with managing upgrades, patching, and applying security controls. </p>
			<h1 id="_idParaDest-121"><a id="_idTextAnchor135"/>Managing upgrades, patching, and applying security controls</h1>
			<p>Your <a id="_idIndexMarker855"/>systems will need updating and patching <a id="_idIndexMarker856"/>continually. In a previous section, we looked at <a id="_idIndexMarker857"/>how IaC can help us with the automation of those processes, which is highly beneficial but not always practical. </p>
			<p>Sometimes, we need to take a hands-on approach to provisioning, auditing, updating, and de-provisioning systems, for example, when we transition to newer technology or when we have findings from a penetration test that was undertaken by a third-party. </p>
			<p>Additionally, in <a href="B16611_06_Final_JM_ePub.xhtml#_idTextAnchor112"><em class="italic">Chapter 6</em></a>, <em class="italic">Designing and Managing Security Testing Processes</em>, we covered <em class="italic">web application vulnerability scanners</em>, <em class="italic">network vulnerability scanners</em>, <em class="italic">SAST/ DAST</em>, <em class="italic">dependency scanning</em>, and similar automated scans, which can provide actions into changes that need to be undertaken and upgrades that need to be performed. </p>
			<p>The problem is, how do you ensure that the IT team understands the risks facing the organization and action the list of changes that need to be implemented in order to ensure a more secure estate? </p>
			<h2 id="_idParaDest-122"><a id="_idTextAnchor136"/>Education</h2>
			<p>It's part of our <a id="_idIndexMarker858"/>responsibility as the information security experts at the organization to ensure that the appropriate people are aware and knowledgeable about the risks that they're able to take action against. This can include arranging for security training, but it could also mean scheduling a regular meeting on a weekly, fortnightly, or monthly basis with your IT team(s), in which you present information about a specific risk or pitfall or cover the overall risk posture facing the organization. Take time to explain and help them understand why it matters. This is a key part of your knowledge; otherwise, you're just the grump in the office that makes people waste their time on useless things and doesn't let them plug USB drives into their company laptops. </p>
			<p>Furthermore, these sessions can help you in your understanding of the estate. You can be involved in a dialog where you get useful information about why it might be logical to apply a certain change before another one. You have a wealth of information available to you from the team that manages the day-to-day operations of your assets, and this dialog is incredibly valuable in the quest for continual improvement, which is not only an effective way to be proactive about your digital estate's health but is also a requirement from most of the standards and <a id="_idIndexMarker859"/>obligations your organization will be subject to. </p>
			<p>This kind of knowledge-sharing and openness could be the difference between a successful change or a failure leading to a breach or an outage. With that, let's look at best practices for making changes. </p>
			<h2 id="_idParaDest-123"><a id="_idTextAnchor137"/>Change control</h2>
			<p>As we've previously mentioned, it's <a id="_idIndexMarker860"/>crucial to follow the governance structures and <strong class="bold">change control</strong> processes that have been defined to reduce downtime and improve the ability of your organization's staff to diagnose outages or errors. </p>
			<p>We could delve into this topic for thousands of pages, but I think it's more relevant to focus on security-specific areas of IT and allow you to investigate further into change control processes as a wider IT or organizational control. When we're looking at <em class="italic">change control</em> from an information security perspective, we're looking to avoid misconfigurations, maximize uptime and availability, and document any changes with the appropriate information. </p>
			<p>Valuable steps in a change control process when patching, upgrading, or applying security controls will include the following: </p>
			<ul>
				<li>Identifying and describing the needed change in documentation</li>
				<li>Justifying the change and why it is required from a business perspective </li>
				<li>Estimating the impact that could be seen on the organization and documenting ways to mitigate any negative impact</li>
				<li>Describing a roll-back plan in the event of failure</li>
				<li>Documenting any approvals that are required and recording those approvals</li>
				<li>Planning for communication with staff, partners, customers, or similar parties</li>
				<li>Effective communication <a id="_idIndexMarker861"/>surrounding the planned changes, including the time window and any expected outages</li>
				<li>Implementation and evaluation of the changes</li>
			</ul>
			<p>A great change control process doesn't need to be slow or prohibitive. It's a matter of ensuring we have a plan in place in order to reduce the likelihood of an outage, misconfiguration, or similar information security incident. By ensuring we have the appropriate documentation and planning, we're also ensuring we have all the appropriate resources available to us. </p>
			<p>Large projects will benefit from a defined change control process, such as a security improvement program, for example, which I will briefly cover. </p>
			<h2 id="_idParaDest-124"><a id="_idTextAnchor138"/>Security improvement program</h2>
			<p>Beyond the continual <a id="_idIndexMarker862"/>improvement efforts after a gap analysis or third-party/internal penetration test, it might be revealed that there are aspects of your information security program that are lacking the maturity or effectiveness that is required in terms of risk. A <strong class="bold">security improvement program</strong> is a project of defined information security improvements, which are scheduled, implemented, and tested for their effectiveness over a period of time, taking leaps and bounds toward being a more secure organization with more resilient operations. </p>
			<p>Security improvement programs can cover as many topics as we've covered in this book and beyond, and are an organization-wide effort toward implementing and bolstering controls and reducing risk. </p>
			<p>The idea behind a security improvement program is that we're not simply "sprinkling in" some security-based tasks into the daily, weekly, and monthly tasks that we're always focused on. It's an active decision to <em class="italic">de-prioritize new features</em> and instead focus on raising the level of protection and risk mitigation. Of course, decisions such as this require buy-in from senior management, which will require a defined plan, with estimates for time, cost, risks, and rewards. </p>
			<p>Take your time in planning and estimating for this, because oftentimes it's a difficult decision for leadership to make. However, once you have that buy-in, you will be able to present the plan to the teams, which will help you with each step of your security improvement program, and making it known to those teams that this directive is coming "from the top" is a highly effective method in prioritizing these tasks and gaining buy-in from the boots on the ground. </p>
			<p>Now that we've briefly <a id="_idIndexMarker863"/>spoken about provisioning resources, focusing on availability and business continuity, as well as managing upgrades, patching, and applying security controls, I believe we should move on to the next section, which is about investigating information security events and responding to information security incidents. </p>
			<h1 id="_idParaDest-125"><a id="_idTextAnchor139"/>Investigating events and responding to incidents</h1>
			<p>I think you'd <a id="_idIndexMarker864"/>all agree when I say "by failing to prepare, you are preparing <a id="_idIndexMarker865"/>to fail" in terms of incident response and investigations. Without adequate response plans, playbooks, and documentation, we're destined to be scrambling without any proper direction when we face a breach, outage, or some other information security event.</p>
			<p>We can have incredible software solutions to help identify malicious and risky activity inside our estate, but it's all pointless without an adequate plan for what to respond to and how to respond. </p>
			<p>We should begin the process of defining our incident response plan by defining what constitutes the initiation for a response. What types of information security events will lead to a member of your organization investigating or responding? </p>
			<p>Not all information security incidents are information security breaches, but all information security breaches are information security incidents and information security events. Let me take some <a id="_idIndexMarker866"/>definitions from ISO 27001: </p>
			<ul>
				<li>An <strong class="bold">information security event</strong> is any activity <a id="_idIndexMarker867"/>inside an estate or environment that is indicative of a security policy being violated or a control failing or an unpredicted scenario that has the potential to impact security. </li>
				<li>An <strong class="bold">information security incident</strong> is one or <a id="_idIndexMarker868"/>more <strong class="bold">information security events</strong> in which information security or business operations are compromised. </li>
				<li><strong class="bold">Information security non-compliance</strong> is where a <a id="_idIndexMarker869"/>requirement from a policy, standard, or regulation is not fulfilled. </li>
			</ul>
			<p>So, an <strong class="bold">information security event</strong> has the potential to affect risk, even momentarily. An <strong class="bold">information security incident</strong> is something we know has negatively affected operations or security, such as an outage or confirmed breach, and <strong class="bold">information security non-compliance</strong> is finding that a control hasn't been implemented correctly or a policy is being disregarded in practice. </p>
			<p>Allow me to cover an example of an information security event leading to an information security incident: </p>
			<ul>
				<li><strong class="bold">Event</strong>: A user at your organization <a id="_idIndexMarker870"/>reaches out and says they can't open any of their files and has a notice on their screen. </li>
				<li><strong class="bold">Incident</strong>: After investigation, your <a id="_idIndexMarker871"/>team discovers that the user's laptop has been infected with ransomware. As a result, the incident response playbook for ransomware is initiated and the appropriate team is engaged to respond. </li>
				<li><strong class="bold">Non-compliance</strong>: After investigation and remediation, it was discovered by the incident response team <a id="_idIndexMarker872"/>that the staff member opened an email attachment from an unknown party and that an outdated SMB service wasn't disabled on some machines, due to an oversight by the IT team. </li>
				<li><strong class="bold">Actions</strong>: Phishing and information <a id="_idIndexMarker873"/>security training for staff members has been prioritized and IT has added a roadmap item to implement secure configurations for workstations, including disabling outdated SMB versions. </li>
			</ul>
			<p>As you can see, if we use these definitions for events and incidents, while taking our risks into <a id="_idIndexMarker874"/>consideration, we're able to create procedures for investigating <a id="_idIndexMarker875"/>specific types of events and responding to incidents in a uniform and effective fashion. To do so is about defining your incident response plans, which I would like to go into next. </p>
			<h2 id="_idParaDest-126"><a id="_idTextAnchor140"/>Defining your incident response plans</h2>
			<p>In order to <a id="_idIndexMarker876"/>understand the workflow and requirements, it's integral to create an incident response plan that suits your organization. If you don't create a feasible response to the alerts generated <a id="_idIndexMarker877"/>by your organization's <strong class="bold">Security Information and Event Management</strong> (<strong class="bold">SIEM</strong>) solution, for example, you've essentially wasted money on a tool by not being able to derive value from its use. </p>
			<p>I would like to take this opportunity to discuss what might be some key questions that need answers before you begin your security monitoring activities. </p>
			<p> Some questions we would like to answer can include the following: </p>
			<ul>
				<li><em class="italic">What are the defined roles relating to information security events? </em><p>Some examples of roles may be the CEO, CISO, CTO, MD, SysAdmin, HR manager, and so on. </p></li>
				<li><em class="italic">What are the duties of each role, for each type of event?</em> <p>Some members may be required to communicate with customers, others with law enforcement, customers, or business stakeholders. There may be roles for investigating the event; there may be roles for restoring processes. Tying the roles to specific skillsets is a beneficial solution, and tying those roles to specific job titles and job descriptions allows an approach that makes individuals aware of their responsibilities when they move into a new role. </p></li>
				<li><em class="italic">What is the method for prioritizing security events?</em> <p>Priority should be based on risk, but it's up to you to define these formally in a way that is easily followed by anybody who may find themselves in a situation where they are the "first responder." Educating staff on how to respond to security events and where the documentation may lie is part of incident response, which we have previously touched on in other chapters. </p></li>
				<li><em class="italic">What is the method for documenting security events?</em><p>How we document <a id="_idIndexMarker878"/>security events from discovery to closure is another facet of incident response that we need to define and train our staff effectively for. </p></li>
				<li><em class="italic">What is the method for notifying the appropriate members of the incident response team of an event?</em> <p>Some examples may include email, phone, SMS, or WhatsApp. </p></li>
			</ul>
			<p>When we define a process, we will want to consider guidance for the following steps: </p>
			<ul>
				<li>Investigating an event, including what information to observe and record</li>
				<li>Confirming an incident, including communications and next steps for the appropriate response</li>
				<li>Responding to incidents, which includes isolating or containing the threat and reducing the damage that can be done to the organization</li>
				<li>Restoring operations, ensuring the impact of the incident is minimized to the lowest level possible</li>
				<li>Investigating and reporting, potentially using forensic capabilities, and taking actions to protect against the perpetrator or taking legal action (if applicable)</li>
			</ul>
			<p>If we want a simple set of guidelines for how to respond to information security incidents, we might want to see the following few guides, provided by various governmental <a id="_idIndexMarker879"/>organizations: </p>
			<ul>
				<li>The UK <strong class="bold">National Cyber Security Centre</strong> (<strong class="bold">NCSC</strong>)'s <em class="italic">Small Business Guide: Response &amp; Recovery</em> (<a href="https://www.ncsc.gov.uk/collection/small-business-guidance--response-and-recovery">https://www.ncsc.gov.uk/collection/small-business-guidance--response-and-recovery</a>) </li>
				<li>The European Network and Information Security Agency's <em class="italic">Good Practice Guide for Incident Management</em> (<a href="https://www.enisa.europa.eu/publications/good-practice-guide-for-incident-management">https://www.enisa.europa.eu/publications/good-practice-guide-for-incident-management</a>) </li>
				<li>The National Institute of Standards and Technology's <em class="italic">800-61 Rev. 2</em> (<a href="https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final">https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final</a>) </li>
			</ul>
			<p>You can also leverage <a id="_idIndexMarker880"/>help from an information security consultancy company that offers incident response services. Oftentimes you will pay in advance in order for these organizations to be ready to respond in the event of an incident, and the amount of time utilized from each incident is deducted from your "balance." </p>
			<p>Furthermore, it's important to note that support is available from various governmental departments, depending on the country your organization is operating in. </p>
			<p>Other organizations might feel comfortable with and capable of performing the investigations and responses themselves, witho<a id="_idTextAnchor141"/>ut external help. Let's look at a few points surrounding performing security investigations next. </p>
			<h2 id="_idParaDest-127"><a id="_idTextAnchor142"/>Performing security investigations</h2>
			<p>I'm going to use this <a id="_idIndexMarker881"/>section to discuss how we can manage and conduct security investigations on incidents, and how we might go about reporting incidents. By using a consistent, structured approach, we can ensure a systematic and effective approach to most circumstances. </p>
			<p>To begin with, let's remind ourselves that not all security incidents are significant enough to require an investigation. It's important to document individual events or combined events that have led to an incident, but we don't necessarily need to escalate every documented occurrence and engage the wider organization or contact law-enforcement. Guidance <a id="_idIndexMarker882"/>for what you should report can be found in your local regulations or in resources provided to your organizations from police, national defense forces, cybersecurity departments such as the UK's NCSC, and other similar agencies.</p>
			<p>As an information security professional, it's your responsibility to do the following: </p>
			<ul>
				<li>Identify what <a id="_idIndexMarker883"/>constitutes a <strong class="bold">minor incident</strong> and a <strong class="bold">major incident</strong>. </li>
				<li>Identify the responses to minor incidents and major incidents. </li>
				<li>Ensure all national or regional laws and regulations are complied with, including ensuring that incidents are reported to the appropriate law enforcement parties. </li>
			</ul>
			<p>Some <a id="_idIndexMarker884"/>examples of a <em class="italic">major incident</em> could include the following: </p>
			<ul>
				<li>Crimes such as burglary or damage to organizational property</li>
				<li>Floods, storms, and other weather damage that leads to compromised security or operations</li>
				<li>Unauthorized access to information that is classified as confidential or protected</li>
			</ul>
			<p>Oftentimes, a major incident will require contacting insurance providers, law enforcement, governmental agencies, customers, and other groups. It's important to define and maintain a procedure for these situations and keep them accessible, most likely inside your playbooks and policies for incident response and disaster response. </p>
			<p>Along with the processes, it is important to define roles related to security investigations. Some <a id="_idIndexMarker885"/>examples for roles and their responsibilities could include the following: </p>
			<ul>
				<li>The <em class="italic">CEO</em> and <em class="italic">C-suite</em>, who are ultimately responsible <a id="_idIndexMarker886"/>for responding to security <a id="_idIndexMarker887"/>incidents. This generally includes ensuring there are adequate processes for staff and contractors to report and respond to such incidents, as well as ensuring there are records of past performance and requirements. This is generally done by appointing the appropriate members of staff to focus on such efforts. </li>
				<li>The <em class="italic">CISO</em>, who is the person appointed by the <a id="_idIndexMarker888"/>C-suite to handle the efforts mentioned previously, and is responsible for the following: <p>– Handling processes related to information security incidents</p><p>– Managing information about security incidents, including the outcomes from internal investigations as well as investigations from law enforcement</p><p>– Reporting that information to the C-suite and the senior management team(s)</p></li>
				<li><em class="italic">Senior management</em> team members will be leveraged in the incident response process and will utilize their team of staff <a id="_idIndexMarker889"/>members in the event of a security incident to perform their relevant duties. This could include the head of legal preparing information relating to litigation, the head of HR responding to insider risks, the head of communications preparing statements for the public, and so on. They will generally also be responsible for an area of reporting related to their departments and presenting that information on a regular basis to the CISO. </li>
				<li><em class="italic">Managers</em> have a closer <a id="_idIndexMarker890"/>view of what is happening at the operational level of business activity. They ensure that security incidents are appropriately reported and that employees are prepared for their responsibilities in the event of a security incident requiring a response. </li>
				<li><em class="italic">Employees</em> are the group that is most likely to notice an information security event or incident. They <a id="_idIndexMarker891"/>should be required to understand their responsibilities and the processes they have available to them in the event of detecting a security incident. This can be achieved through education and training. </li>
			</ul>
			<p>I would like to suggest reviewing a document that the international not-for-profit body CREST released. It's a guidance for incident response processes called the <em class="italic">Cyber Security Incident Response Guide</em> (<a href="https://www.crest-approved.org/wp-content/uploads/2014/11/CSIR-Procurement-Guide.pdf">https://www.crest-approved.org/wp-content/uploads/2014/11/CSIR-Procurement-Guide.pdf</a>). </p>
			<p>Inside the linked PDF guide, you <a id="_idIndexMarker892"/>will find guidance on the following: </p>
			<ul>
				<li>Understanding information security incidents, including the following: <p>– How to define an incident</p><p>– How various incidents compare to one another</p><p>– The phases we would expect from an attack</p></li>
				<li>Preparing for information security incidents, including the various challenges we may see in an incident <a id="_idIndexMarker893"/>response undertaking, ways to respond, how to leverage experts in response, and how to build an internal response capability. Beyond that, the document discusses five steps in preparing your organization: <p>– Conducting a criticality assessment for your organization</p><p>– Carrying out threat analysis</p><p>– Considering the implications for your organization, including people, processes, and technologies required</p><p>– Creating a secure environment, including implementing the basic controls required to prevent the most common types of incidents from ever happening</p><p>– Reviewing your posture and testing your readiness for incident response</p></li>
				<li>Responding to information security incidents, including the following: <p>– Identifying incidents</p><p>– Defining objectives</p><p>– Taking action to contain the incident</p><p>– Recovering systems</p></li>
				<li>Following on from information security incidents, including the following: <p>– Investigating the incident further</p><p>– Reporting the <a id="_idIndexMarker894"/>incident to stakeholders</p><p>– Carrying out a post-incident review of the investigation</p><p>– Communicating findings and building on findings</p><p>– Updating information and controls based on the findings</p><p>– Performing analysis to uncover trends</p></li>
				<li>Finally, choosing suppliers to help with handling information security incidents. </li>
			</ul>
			<p>This document will serve as a great resource to you and your organization in the future, and I hope you take my advice and give it a read. </p>
			<p>Now that we've touched on investigating events and responding to incidents, I would like to go into the implementation and utilization of detective controls in your organization. </p>
			<h1 id="_idParaDest-128"><a id="_idTextAnchor143"/>Implementing and utilizing detective controls</h1>
			<p>As is the <a id="_idIndexMarker895"/>nature of IT, we have a constantly mutating landscape of technologies, threats, and techniques to be able to identify and protect against, including <a id="_idIndexMarker896"/>ransomware, DDoS, and infiltration attacks. We need to know what is happening in our estate and implement automated controls for notification in the event of an attack, as well as the active prevention of those threats from being exploited. </p>
			<p>In order to achieve this level of visibility, we need a set of processes and structures surrounding <strong class="bold">security monitoring</strong> and <strong class="bold">security investigations</strong>, and we need to test those processes with staff members and third parties that are responsible for protecting our estate. </p>
			<p>Ultimately, senior management is responsible for <a id="_idIndexMarker897"/>allocating the appropriate resources toward an internal <strong class="bold">Security Operations Center</strong> (<strong class="bold">SOC</strong>) or a <strong class="bold">SOC as a service</strong> from a third <a id="_idIndexMarker898"/>party, as well as having an <strong class="bold">incident response team</strong> ready to be engaged. Once senior management has recognized the importance of these aspects of information security, the responsibility for implementing and maintaining those controls is likely to be delegated to you, the information security professional, at your organization. </p>
			<p>With that responsibility, we need to ensure we take a risk-based strategy, including the following: </p>
			<ul>
				<li>Asset prioritization </li>
				<li>Threat modeling </li>
				<li>A detection budget </li>
				<li>A response budget </li>
			</ul>
			<p>Beyond that, we need to set our strategy for the future and define what types of education and improvements should be undertaken to ensure the organization will remain protected, even in the face of constant change. </p>
			<p>In terms of the present, one of the most effective measures available to information security <a id="_idIndexMarker899"/>professionals in achieving these heightened levels of visibility and <a id="_idIndexMarker900"/>enabling the SOC and information security team to be effective in their endeavors is through security monitoring. Let's discuss what may be involved with that next. </p>
			<h1 id="_idParaDest-129"><a id="_idTextAnchor144"/>Using security monitoring to improve visibility</h1>
			<p>A specifically popular <a id="_idIndexMarker901"/>control for increasing visibility into the ongoings of your digital estate is the implementation of logging and the aggregation of those logs into a SIEM system. </p>
			<p>SIEMs not only provide specialists the ability to investigate logs from your assets in your organization but also, lately they have been able to leverage IPS/IDS features, along with machine learning algorithms to enrich the log data and actively protect against compromise. This shifts the SIEM from being solely a <em class="italic">detective control</em> to being both a <em class="italic">preventative and detective control</em>, giving context and visibility into the previously dark alcoves of a network, along with reactions to mitigate the effectiveness of a threat actor. </p>
			<p>This could include recognizing <a id="_idIndexMarker902"/>patterns and actions such as the <a id="_idIndexMarker903"/>following: </p>
			<ul>
				<li><strong class="bold">Account compromise detection</strong> through <a id="_idIndexMarker904"/>authentication logs. </li>
				<li><strong class="bold">Malware detection</strong> through system <a id="_idIndexMarker905"/>activity, firewall, IDS/IPS, and <strong class="bold">CASB</strong><em class="italic"> (</em><strong class="bold">Cloud Application </strong><strong class="bold"><a id="_idIndexMarker906"/></strong><strong class="bold">Security Broker</strong><em class="italic">)</em> logs. </li>
				<li><strong class="bold">Intrusion detection</strong> through <a id="_idIndexMarker907"/>contextual referencing, such as comparing IDS/IPS and vulnerability databases. </li>
				<li><strong class="bold">Malware host detection</strong> through <a id="_idIndexMarker908"/>outbound connection logs from firewalls and CASBs. </li>
				<li><strong class="bold">Policy violation detection</strong> through <a id="_idIndexMarker909"/>administrative activity, user activity, and change logs. </li>
				<li><strong class="bold">Detecting attacks on external-facing applications</strong> through web application <a id="_idIndexMarker910"/>firewall logs, web or cloud server logs, or application and database server logs. </li>
			</ul>
			<p>In order to understand whether these detections are valid and credible threats, it will be important to prepare certain information to enable your <em class="italic">incident response team</em> and <em class="italic">SOC</em> to compare and reference. </p>
			<p>This information could include the following: </p>
			<ul>
				<li><em class="italic">A list of hosts</em> that are expected in your environment. This helps team members or automated systems to detect unwanted hosts or endpoints in your environment. </li>
				<li>A <em class="italic">baseline log of network activity</em> over a specific duration that could be seen as "normal." The issue with gathering this information is answering the question "What if we're already breached?". The principle of "assuming breach" has become popular across the Zero Trust network idea, but many organizations aren't prepared to take those steps as rapidly as we should hope. </li>
				<li><em class="italic">A list of operating services on each host</em> to serve as a baseline. It can build on your host list mentioned <a id="_idIndexMarker911"/>previously and should include the port numbers and protocols that are expected to be communicated on for that specific host. </li>
				<li><em class="italic">An interactive diagram or visual representation of network functions</em> aligned with the OSI reference model. As previously mentioned, there is a risk of providing tainted data in this process, which actually justifies the existing threats in your network, because they're assumed to be "normal." </li>
			</ul>
			<p>To avoid the pitfalls of providing garbage information that masks the threat already living in your estate, you should consider a project that tackles the following: </p>
			<ul>
				<li>Identifying <em class="italic">all processes and services existing on all servers</em> and specifying what they do</li>
				<li>Identifying <em class="italic">the types of communications</em> that those processes and services would produce and/or receive</li>
				<li>Determining the <em class="italic">criticality of those services</em>, and with that their vulnerabilities and the level of risk associated</li>
				<li>Determining whether any <em class="italic">services are redundant</em> (as in, they are not required)</li>
				<li>Determining whether any <em class="italic">critical services lack redundancy</em> (as in, they are critical, but don't have any fallback measures in-place)</li>
			</ul>
			<p>"Ah, here we go!", you're thinking right now. "Asking us to do the impossible again!"</p>
			<p>For some, trying to get an accurate representation of all the network activity in the estate seems impossible… which is why automated systems are starting to offer the solution instead of asking for teams of people to put aside their daily tasks to dedicate time and effort toward tasks that are as difficult as what we've seen previously. </p>
			<p>Instead, these automated systems are able to "scan" and "detect" the type of activity that has been <a id="_idIndexMarker912"/>found in your estate, and enrich that data with intelligence surrounding malicious activity occurring across other estates globally, and then use that information to notify your SOC and respond to any active threats. </p>
			<p>These solutions may be a more tenable solution for your organization and can help navigate the complexity of your estate, filtering out all of the noise to highlight only the most valuable insights and risk-based detections. These insights can even be turned into reports or "management-style" reports based on key point summaries. </p>
			<p>Some examples of this software can include the following: </p>
			<ul>
				<li>Microsoft Azure Sentinel </li>
				<li>Splunk Enterprise Security </li>
				<li>IBM QRadar Security</li>
				<li>LogRhythm NextGen SIEM Platform </li>
				<li>AT&amp;T Cybersecurity AlienVault USM </li>
				<li>Graylog </li>
			</ul>
			<p>Regardless of the decision you make for which SIEM and intelligence solution is right for your organization, there <a id="_idIndexMarker913"/>are a few best practices that might be worth noting and applying in the early stages of onboarding the solution into your estate and creating processes that are best suited. </p>
			<h1 id="_idParaDest-130"><a id="_idTextAnchor145"/>Security monitoring best practices</h1>
			<p><em class="italic">Security monitoring and SIEM</em> <em class="italic">tools</em> are highly beneficial in both the detection and prevention of serious <a id="_idIndexMarker914"/>threats attempting to exploit your estate and help to ensure your organization is compliant with regulations and requirements while giving measurable insights into where your security posture can improve. </p>
			<p>For systems like these, we want to collect as much information as we can, from both a technical and legal or regulatory perspective, to ensure the highest level of visibility and aggregation and derive meaningful insights from the activity in our estate. This could include <em class="italic">network device and server logs</em>, <em class="italic">Active Directory/IAM logs</em>, <em class="italic">vulnerability scanner and configuration management tool metrics</em>, and so on. </p>
			<p>Additionally, it's important to implement redundancy in this aggregated data and treat it as you would any critical data, where the risk is mitigated with backup and recovery strategies to align with your information security policies. </p>
			<p>There also exist some limitations in <em class="italic">SIEM and security monitoring</em>. Sometimes it isn't feasible to collect certain information or the network and computational throughput isn't able to handle the amount of data in your estate. It's important to note the amount of data you'll be expecting the system to handle before making a decision on the specific solution and vendor appropriate for your organization. </p>
			<p>I would like to cover some particularly important steps to take before leaping headfirst into security monitoring that can help you and your organization avoid common missteps and mistakes. </p>
			<h2 id="_idParaDest-131"><a id="_idTextAnchor146"/>Establish requirements and define workflows</h2>
			<p>Let me ask <a id="_idIndexMarker915"/>you this: how can you <a id="_idIndexMarker916"/>weigh up the features of the solutions available if you don't know what you need from your SIEM? </p>
			<p>First, as with everything, before even deciding on a solution, it's important to do the following: </p>
			<ul>
				<li>Establish your requirements.</li>
				<li>Establish your timeline objectives.</li>
				<li>Define what the ideal workflow looks like to you and your organization. </li>
			</ul>
			<p>Sometimes, vendors will try to highlight features that are of no value to you and only exist to dazzle the unprepared. On the other hand, sometimes vendors will come to you with a better solution that solves more problems than you were expecting or solves your problems in a clever way, which is a great situation to be in. </p>
			<p>When we're establishing our requirements, let's consider the <em class="italic">KISS principle</em> again. Define a reasonable scope to pilot your solution. You don't need to boil the ocean on the first day of having your SIEM implemented, and there's definitely room to roll out your system gradually, allowing for troubleshooting and testing of defined processes. By doing so, you're providing a proof of concept, reducing the likelihood of edge cases, while also demonstrating the benefits of a SIEM system to key decision-makers. </p>
			<p>With that in mind, make sure to keep your end goal in mind, to ensure the solution is able to scale to the <a id="_idIndexMarker917"/>level of data you would <a id="_idIndexMarker918"/>like to cover. This might be measured in <strong class="bold">Events Per Second</strong> (<strong class="bold">EPS</strong>), or maybe <strong class="bold">Gigabytes Per Day</strong> (<strong class="bold">GB/day</strong>). </p>
			<p>While you're considering your requirements, objectives, and workflow, you want to consider your compliance and regulatory requirements. <em class="italic">SIEM</em> is able <a id="_idIndexMarker919"/>to help demonstrate the effectiveness of your other security controls to regulators and auditors. In previous chapters, we discussed creating a list of regulations and standards, as well as the specific requirements for each of the regulations and standards your organization is obligated to comply with, so you'll already have this prepared, right? Right?! </p>
			<p>With this list, you're ready to mention your compliance requirements to the vendor during presentations and demos, ensuring that you are able to collect, retain, and remove information <a id="_idIndexMarker920"/>that is required in order to <a id="_idIndexMarker921"/>stay compliant. It can also help with estimating the amount of storage required for retention purposes, helping streamline the pricing discussions. </p>
			<h2 id="_idParaDest-132"><a id="_idTextAnchor147"/>Define specific rules and ensure their effectiveness</h2>
			<p>Moving on from <a id="_idIndexMarker922"/>establishing your requirements <a id="_idIndexMarker923"/>and defining your workflows for <em class="italic">SIEM</em> and <em class="italic">incident response</em> processes, you are able to define the types of data that are useful to your organization and what they may indicate. Many solutions have various "built-in" indicators, such as the following: </p>
			<ul>
				<li>Authorization failed attempts </li>
				<li>Authorization successes </li>
				<li>User privilege changes </li>
				<li>Application server errors </li>
				<li>Application server performance issues </li>
				<li>Administrator activities </li>
			</ul>
			<p>Furthermore, it's important to define the information you don't want to store or perform SIEM activities on, or perhaps would like to restrict the type of activities on, such as the following: </p>
			<ul>
				<li>PII </li>
				<li>Information that is illegal to collect </li>
				<li>Credit card and banking information </li>
				<li>Passwords </li>
				<li>Encryption keys </li>
			</ul>
			<p>From these definitions and the rules created from the definitions, it's important to regularly test the effectiveness of the solution, to ensure that the expected outcome does indeed occur. This includes <em class="italic">exact-data matching</em> or <em class="italic">near-matching</em>, or <em class="italic">thresholds</em> that need to be passed (for example, this needs to happen more than three times in 1 minute before an alert is created), and so on. It also includes the communications and notifications created from the solution and whether the appropriate people are notified as expected in the defined requirements. </p>
			<p>I'm fairly certain that during the <a id="_idIndexMarker924"/>process of workshopping and defining your requirements and <a id="_idIndexMarker925"/>plans for both <em class="italic">incident response and security monitoring</em>, you'll notice theories that you thought would work but don't. It's your opportunity to start acting on the next best practice, which is to… you guessed it, continuously improve your policies and configuration. </p>
			<h2 id="_idParaDest-133"><a id="_idTextAnchor148"/>Continuously improve your SIEM configuration and incident response policies</h2>
			<p>The IT landscape is <a id="_idIndexMarker926"/>changing faster than nearly anything else ever has in history, and its pace is only accelerating further. What that <a id="_idIndexMarker927"/>means is that solutions become outdated, information about solutions or assets previously deemed as high-quality becomes either difficult to utilize or useless, and new threats appear to exploit or avoid configurations that were previously seen as being bulletproof. </p>
			<p>As a result, we need to set a recurring date in our calendars that focuses entirely on refining the SIEM configuration and incident response policies (among everything else, but let's just talk about SIEM and incident response). We can't just let it rot, and even if we're leveraging a <em class="italic">SaaS</em> solution that gets automatic updates from the vendor, we still need to ensure the current reality of our estate is reflected in the system. </p>
			<p>Now that we've concluded this section about security monitoring, I would like to wrap up with a summary of this chapter. </p>
			<h1 id="_idParaDest-134"><a id="_idTextAnchor149"/>Summary</h1>
			<p>So, now that concludes <a href="B16611_07_Final_JM_ePub.xhtml#_idTextAnchor123"><em class="italic">Chapter 7</em></a>, <em class="italic">Owning Security Operations</em>. I believe we've covered the high-level requirements of information security professionals to handle security operations. As with every section of this book, we have covered many topics, but each one very briefly. Full books can be dedicated to any of this chapter's sections, or even individual paragraphs on their own. I hope this serves to raise interest in learning more about each subject area in the future! </p>
			<p>In this chapter, we covered various important aspects of the daily requirements from an information security operations team. </p>
			<p>First, we looked at effective strategies in provisioning and maintaining assets, including the policies and configuration management steps required, as well as touching on the concept of IaC to streamline and automate these processes. </p>
			<p>Then, we moved on to focusing on availability, disaster recovery, and business continuity activities, including the processes of defining, implementing, and testing disaster recovery and business continuity plans. </p>
			<p>From there, we progressed toward the topics of managing upgrades, patching, and applying security controls in your organization, which included information about education requirements, change control processes, and security improvement programs. </p>
			<p>Then, we delved into investigating events and responding to incidents, including defining incident response plans and performing security investigations. </p>
			<p>Then, to close out the chapter, we looked at implementing and utilizing detective controls, including how to use monitoring to improve visibility inside your estate, leveraging increased levels of logging, aggregating those logs into a SIEM, applying automated logic and machine learning insights to the data, and having that data reviewed by members of a SOC. </p>
			<p>Finally, we looked at security monitoring best practices, including establishing requirements and defining workflows, defining specific rules and ensuring their effectiveness, and continuously improving your SIEM configuration. </p>
			<p>Now, it's only appropriate to move on to our final chapter, <a href="B16611_08_Final_JM_ePub.xhtml#_idTextAnchor150"><em class="italic">Chapter 8</em></a>, <em class="italic">Improving the Security of Software</em>, my personal favorite topic. </p>
		</div>
	</body></html>