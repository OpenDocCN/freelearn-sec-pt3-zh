<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Windows Drive Acquisition</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will cover the following recipes:</p>
<ul>
<li><span>Drive acquisition in E01 format with FTK Imager</span></li>
<li><span>Drive acquisition in RAW format with dc3dd</span></li>
<li><span>Mounting forensic images with Arsenal Image Mounter</span></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p>Before you can begin analysing evidence from a source, it first of all needs to be imaged. This describes a forensic process in which an exact copy of a drive is made. This is an important step, especially if evidence needs to be taken to court, because forensic investigators must be able to demonstrate that they have not altered the evidence in any way.</p>
<p>The term <em>forensic image</em> can refer to either a physical or a logical image. Physical images are precise replicas of the drives they reference, whereas a logical image is a copy of a certain volume within that drive. In general, logical images show what the machineâ€™s user will have seen and dealt with, whereas physical images give a more comprehensive overview of how the device works at a higher level.</p>
<p>A <em>hash value</em> is generated to verify the authenticity of the acquired image. Hash values are essentially cryptographic digital fingerprints which show whether a particular item is an exact copy of another. Altering even the smallest bit of data will generate a completely new hash value, thus demonstrating that the two items are not the same. When a forensic investigator images a drive, they should generate a hash value for both the original drive and the acquired image. Some pieces of forensic software will do this for you.</p>
<p>There are a number of tools available for imaging hard drives, some of which are free and open source. However, the most popular way for forensic analysts to image hard drives is by using one of the more well-known forensic software vendors' solutions. This is because it is imperative to be able to explain how the image was acquired and its integrity, especially if you are working on a case that will be taken to court.</p>
<p>Once you have your image, you will then be able to analyze the digital evidence from a device without directly interfering with the device itself.</p>
<p>In this chapter, we will be looking at various tools that can help you to image a Windows drive, and taking you through the process of acquisition.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Drive acquisition in E01 format with FTK Imager</h1>
                </header>
            
            <article>
                
<p>FTK Imager is an imaging and data preview tool by AccessData which allows an examiner not only to create forensic images in different formats, including RAW, SMART, E01, and AFF, but also to preview data sources in a forensically sound manner. In the first recipe of this chapter, we will show you how to create a forensic image of a hard drive from a Windows system in E01 format.</p>
<div class="packt_infobox">E01 or EnCase's Evidence File is a standard format for forensic images in law enforcement. Such images consist of a header with case info, including acquisition date and time, examiner's name, acquisition notes, and password (optional), a bit-by-bit copy of an acquired drive (consisting of data blocks, verified with its own CRC or Cyclical Redundancy Check), and a footer with MD5 hash for the bitstream.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>First of all, let's download <strong>FTK Imager</strong> from AccessData's website. To do this, go to the <span>Products and Services</span> tab, and after that, to <span class="packt_screen">Product Downloads</span>. Now choose DIGITAL FORENSICS, and then <span class="packt_screen">FTK Imager</span>. At the time of writing, the most up-to-date version is 3.4.3, so click the green <span class="packt_screen">DOWNLOAD PAGE</span> button on the right. Now you should be able to see the download page. Click on <span class="packt_screen">DOWNLOAD NOW</span> and fill in the form. After this, the download link will be sent to the email address that you provided.</p>
<p>The installation process is quite straightforward; all you need to do is just click <span class="packt_screen">Next</span> a few times, so we won't cover it in the recipe.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>There are two ways of initiating the drive imaging process:</p>
<ol>
<li>Using the <span class="packt_screen">Create Disk Image</span> button from the toolbar (Figure 3.1)</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/0c215dce-4ac6-4b97-92e8-83ba8ed40d3d.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 3.1. Create Disk Image button on the toolbar</div>
<ol start="2">
<li>Using the <span class="packt_screen">Create Disk Image...</span> option from the <span class="packt_screen">File</span> menu (Figure 3.2)</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="369" width="220" class="image-border" src="assets/b4a72003-bff9-47c4-89dc-842ff85da717.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 3.2. <span>Create Disk Image... option in the File Menu</span></div>
<p class="CDPAlignLeft CDPAlign">You can choose whichever option you prefer.</p>
<p>The first window you see is <span class="packt_screen">Select Source</span>. Here, you have five options:</p>
<ul>
<li><strong><span class="packt_screen">Physical Drive</span></strong>: This allows you to choose a physical drive as the source, with all partitions and unallocated space.</li>
<li><strong><span class="packt_screen">Logical Drive</span></strong>: This allows you to choose a logical drive as the source, for example <kbd>E:\ drive</kbd>.</li>
<li><strong><span class="packt_screen">Image File</span></strong>: This <span>allows you to choose an image file as the source, for example, if you need to convert your forensic image from one format to another.</span></li>
<li><strong><span class="packt_screen">Contents of a Folder</span></strong>: This allows you to choose a folder as the source. Of course, no deleted files will be included.</li>
<li><strong><span class="packt_screen">Fernico Device</span></strong>: This allows you to restore images from multiple CD/DVDs.</li>
</ul>
<p>Of course we want to image the whole drive to be able to work with deleted data and unallocated space, so:</p>
<ol>
<li>Let's choose the <span class="packt_screen">Physical Drive</span> option.</li>
</ol>
<div class="packt_tip">The evidence source mustn't be altered in any way, so make sure you are using a hardware write blocker. You can use the one from Tableau, for example. These devices allow acquisition of drive contents <span>without creating the possibility of modifying the data.</span></div>
<div class="CDPAlignCenter CDPAlign"><img height="291" width="368" class="image-border" src="assets/75543208-243e-4fcc-b45e-936e516dbc78.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><em>Figure 3.3. FTK Imager Select Source window</em></div>
<ol start="2">
<li>Click <span class="packt_screen">Next</span> and you'll see the next window - <span class="packt_screen">Select Drive</span>.</li>
</ol>
<ol start="3">
<li>Now you should choose the source drive from the drop-down menu, in our case it's <strong>\\.\PHYSICALDRIVE2</strong>.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="291" width="367" class="image-border" src="assets/d4acb6e1-9631-4493-8bc3-3268c9718bff.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 3.4. FTK Imager Select Drive window</div>
<ol start="4">
<li>Now that the source drive has been chosen, click <span class="packt_screen">Finish</span>.</li>
<li>The next window is - <span class="packt_screen">Create Image</span>. We'll get back to this window soon, but for now, just click <span class="packt_screen">Add...</span></li>
<li>It's time to choose the destination image type. As we decided to create our image in <span>EnCase's Evidence File format, let's choose</span> <span class="packt_screen">E01</span><span>.</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="250" width="338" class="image-border" src="assets/120a8641-19a7-49d8-8261-b015321ea3e2.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><em>Figure 3.5. FTK Imager Select Image Type window</em></div>
<ol start="7">
<li>Click <span class="packt_screen">Next</span> and you'll see the <span class="packt_screen">Evidence Item Information</span> window.</li>
</ol>
<p style="padding-left: 60px" class="CDPAlignLeft CDPAlign">Here, we have five fields to fill in: <span class="packt_screen">Case Number</span>, <span class="packt_screen">Evidence Number</span>, <span class="packt_screen">Unique Description</span>, <span class="packt_screen">Examiner,</span> and <span class="packt_screen">Notes</span>. All fields are optional.</p>
<div class="CDPAlignCenter CDPAlign"><img height="261" width="354" class="image-border" src="assets/a692c888-f994-4461-9315-92c67af89c30.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><em><em>Figure 3.6. FTK Imager Evidence Item Information window</em></em></div>
<ol start="8">
<li>Fill in the fields, or skip them if you prefer, then click <span class="packt_screen"><strong>Next</strong>.</span></li>
<li>Now choose the image destination. You can use the <span class="packt_screen">Browse</span> button for this.</li>
<li>Also, you should fill in the image filename.</li>
</ol>
<p style="padding-left: 60px" class="CDPAlignLeft CDPAlign">If you want your forensic image to be split, choose a fragment size (in megabytes). E01 format supports compression, so if you want to reduce the image size, you can use this feature. As you can see in figure 3.7, we have chosen <span class="packt_screen">6</span>. And if you want the data in the image to be secured, use the <span class="packt_screen">AD Encryption feature</span>.</p>
<div class="CDPAlignLeft CDPAlign packt_infobox">AD Encryption is a whole image encryption, so not only is the raw data encrypted, but so is any metadata. Each segment or file of the image is encrypted with a randomly generated image key using AES-256.</div>
<div class="CDPAlignCenter CDPAlign"><img height="265" width="359" class="image-border" src="assets/21d3a62b-600c-437b-917f-b8366c91e4bb.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 3.7. FTK Imager Select Image Destination window</div>
<p style="padding-left: 90px" class="CDPAlignLeft CDPAlign">We are almost done.</p>
<ol start="11">
<li>Click <span class="packt_screen"><strong>Finish</strong></span> and you'll see the <span><span class="packt_screen">Create Image</span> window again.</span></li>
<li><span>Now look at the three options at the bottom of the window.</span></li>
</ol>
<p style="padding-left: 60px" class="CDPAlignLeft CDPAlign"><span>The verification process is very important, so make sure the <span class="packt_screen">Verify images after they are created</span> option is ticked; it helps you to be sure that the source and the image are equal. The <span class="packt_screen">Precalculate Progress Statistics</span> option is also very useful: it will show you the estimated time of arrival during the imaging process. The last option will create directory listings of all files in the image for you, but of course, it takes time, so use it only if you need to.</span></p>
<div class="CDPAlignCenter CDPAlign"><img height="330" width="366" class="image-border" src="assets/c2ab361d-0aca-43b1-8a0c-243b3fe3b5a3.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><em>Figure 3.8. FTK Imager Create Image window</em></div>
<ol start="13">
<li>All you need to do now is click <span class="packt_screen">Start.</span></li>
</ol>
<p style="padding-left: 60px" class="mce-root">Great, the imaging process has been started! Once the image has been created, the verification process starts.</p>
<ol start="14">
<li>Finally, you'll get a <span class="packt_screen">Drive/Image Verify Results</span> window, like the one shown in figure 3.9.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="377" width="581" class="image-border" src="assets/de1a5368-5039-4e88-82ee-a2bd14f8451e.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 3.9. FTK Imager Drive/Image Verify Results window</div>
<p class="CDPAlignLeft CDPAlign">As you can see, in our case the source and the image are identical: both hashes matched. In the folder with the image, you will also find an info file with valuable information such as the drive model, serial number, source data size, sector count, MD5 and SHA1 checksums, and so on.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>FTK Imager uses the physical drive of your choice as the source and creates a bit-by-bit image of it in <span>EnCase's Evidence File format</span>. During the verification process, MD5 and SHA1 hashes of the image and the source are compared.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See more</h1>
                </header>
            
            <article>
                
<p>The FTK Imager download page:</p>
<p><a href="http://accessdata.com/product-download/digital-forensics/ftk-imager-version-3.4.3">http://accessdata.com/product-download/digital-forensics/ftk-imager-version-3.4.3</a></p>
<p>The FTK Imager User Guide:</p>
<p><a href="https://ad-pdf.s3.amazonaws.com/Imager/3_4_3/FTKImager_UG.pdf">https://ad-pdf.s3.amazonaws.com/Imager/3_4_3/FTKImager_UG.pdf</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Drive acquisition in RAW format with dc3dd</h1>
                </header>
            
            <article>
                
<p>DC3DD (by Jesse Kornblum) is a patched version of the classic GNU dd utility with some computer forensics features. For example, <span>the fly</span> hashing <span>with a number of algorithms, such as MD5, SHA-1, SHA-256, and SHA-512, showing the progress of the acquisition process, and</span> so on.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>You can find <span>a compiled standalone version of DC3DD for Windows at SourceForge. Just download the ZIP or 7z archive, unpack it, and you are ready to go.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>The steps for drive acquisition in RAW format using dc3dd are as follows:</p>
<ol>
<li>Open <span class="packt_screen">Windows Command Prompt,</span> change directory (you can use <strong>cd</strong> command to do it) to the one with <kbd>dc3dd.exe</kbd>, and type the following command:</li>
</ol>
<pre style="padding-left: 60px">
<strong>dc3dd.exe if=\\.\PHYSICALDRIVE2 of=X:\147-2017.dd hash=sha256</strong><br/><strong>log=X:\147-2017.log</strong>
</pre>
<ol start="2">
<li>Press <em>Enter</em> and the acquisition process will start.</li>
</ol>
<p>Of course, your command will be a bit different, so let's find out what each part of it means:</p>
<ul>
<li><strong>if</strong> - stands for input file. Originally, dd was a Linux utility, and in case you didn't know, everything is a file in Linux. As you can see in our command, we put the physical drive 2 here (this is the drive we wanted to image, but in your case it may be another drive, depending on the number of drives connected to your workstation).</li>
<li><strong>of</strong> - stands for output file. Here, you should type the destination of your image in RAW format. In our case, it's <kbd>X:\ drive</kbd> and <kbd>147-2017.dd</kbd> file.</li>
<li><strong>hash</strong> - as has already been said, DC3DD supports four hashing algorithms: <span>MD5, SHA-1, SHA-256, and SHA-512. We chose SHA-256, but you can choose whichever one you like.</span></li>
<li><strong>log</strong> - here, you should type the destination for the logs. You will find the image version, image hash, and so on in this file once acquisition is completed.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>DC3DD creates a bit-by-bit image of the source drive in RAW format, so the size of the image will be the same as the source, and it calculates the image hash using an algorithm of the examiner's choice, in our case SHA-256.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>The DC3DD download page:</p>
<p><a href="https://sourceforge.net/projects/dc3dd/files/dc3dd/7.2%20-%20Windows/">https://sourceforge.net/projects/dc3dd/files/dc3dd/7.2%20-%20Windows/</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Mounting forensic images with Arsenal Image Mounter</h1>
                </header>
            
            <article>
                
<p><span>Arsenal Image Mounter is an open source tool developed by Arsenal Recon. It can help a digital forensic examiner to mount a forensic image or virtual machine disk in Windows. It supports both E01 (and EX01) and RAW forensic images, so you can use it with any of the images we created in the previous recipes.</span></p>
<p>It's very important to note that Arsenal Image Mounter mounts <span>the contents of disk images as complete disks.</span> The tool supports all file systems you can find on Windows drives: NTFS, ReFS, FAT32, and exFAT. Also, it has temporary write support for images, which is a very useful feature, for example, if you want to boot the system from the image you are examining.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Go to the <span>Arsenal Image Mounter web page on the Arsenal Recon website and click on the download button to download the ZIP archive. At the time of writing, the latest version of the tool is 2.0.010, so in our case, the archive has the name <strong>Arsenal_Image_Mounter_v2.0.010.0_x64.zip</strong>. Extract it to a location of your choice and you are ready to go, no installation is required.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>There two ways to choose an image for mounting in <span>Arsenal Image Mounter.</span></p>
<ul>
<li><span>You can use the <span class="packt_screen">File</span> menu (and choose <strong>Mount image...</strong>) or</span></li>
<li>The <span><span class="packt_screen">Mount image</span> button, as shown in figure 3.10</span></li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img height="345" width="564" class="image-border" src="assets/7a959659-7f41-48b3-a2e3-bf12ddae565f.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><em>Figure 3.10. Arsenal Image Mounter main window</em></div>
<ol>
<li>When you choose the <span class="packt_screen">Mount image...</span> option from the <span class="packt_screen">File</span> menu or click on the <span class="packt_screen">Mount image</span> button, the <span class="packt_screen">Open</span> window will pop up - here you should choose an image for mounting.</li>
</ol>
<ol start="2">
<li>The next window you will see is <span class="packt_screen">Mount options</span>, like the one in figure 3.11.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="265" width="431" class="image-border" src="assets/207a9009-a7e5-4c46-ab17-4849c6af0406.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 3.11. <em>Arsenal Image Mounter Mount options window</em></div>
<p style="padding-left: 60px">As you can see, there are a few options here:</p>
<ul>
<li><strong><span class="packt_screen">Read only</span></strong> - if you choose this option, the image is mounted in read-only mode, so no write operations are allowed. (Do you still remember that you mustn't alter the evidence in any way? Of course, it's already an image, not the original drive, but nevertheless.)</li>
<li><strong><span class="packt_screen">Fake disk signature</span></strong> - <span>if an all-zero disk signature is found on the image, Arsenal Image Mounter reports a random disk signature to Windows, so it's mounted properly.</span></li>
<li><strong><span class="packt_screen">Write temporary</span></strong> - if you choose this option, the image is mounted in read-write mode, but all modifications are written not in the original image file, but to a temporary differential file instead.</li>
<li><strong><span class="packt_screen">Write original</span></strong> - again, this option mounts the image in read-write mode, but this time the original image file will be modified.</li>
<li><strong><span class="packt_screen">Sector size</span></strong> - this option allows you to choose the sector size.</li>
<li><span class="packt_screen">Create "removable" disk device</span> - this option <span>emulates the attachment of a USB thumb drive.</span></li>
</ul>
<ol start="3">
<li>Choose the options you think you need and click <span class="packt_screen">OK</span>.</li>
</ol>
<p>We decided to mount our image as <span class="packt_screen">Read Only</span>. Now you can see a hard drive icon on the main window of the tool - the image is mounted.</p>
<p>If you mounted only one image and want to unmount it, select the image and click on <span class="packt_screen">Remove selected</span>. If you have a few mounted images and want to unmount all of them, click on the <span class="packt_screen">Remove all</span> button.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Arsenal Image Mounter mounts forensic images or virtual machine disks <span>as complete disks</span> in read-only or read-write mode. Later, a digital forensics examiner can access their contents even with Windows Explorer.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>The Arsenal Image Mounter page on the Arsenal Recon website: <a href="https://arsenalrecon.com/apps/image-mounter/">https://arsenalrecon.com/apps/image-mounter/</a></p>


            </article>

            
        </section>
    </body></html>