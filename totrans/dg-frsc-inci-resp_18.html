<html><head></head><body>
<div id="_idContainer400">
<h1 class="chapter-number" id="_idParaDest-315"><a id="_idTextAnchor323"/><span class="koboSpan" id="kobo.1.1">18</span></h1>
<h1 id="_idParaDest-316"><a id="_idTextAnchor324"/><span class="koboSpan" id="kobo.2.1">Threat Hunting</span></h1>
<p><span class="koboSpan" id="kobo.3.1">The release of Mandiant’s APT1 report provided information security professionals with a deep insight into one of the most experienced and prolific threat groups operating. </span><span class="koboSpan" id="kobo.3.2">The insight into the Chinese PLA Unit 61398 also provided context around these sophisticated threat actors. </span><span class="koboSpan" id="kobo.3.3">The term </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Advanced Persistent Threat</span></strong><span class="koboSpan" id="kobo.5.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.6.1">APT</span></strong><span class="koboSpan" id="kobo.7.1">) became part of the information security </span><a id="_idIndexMarker1662"/><span class="koboSpan" id="kobo.8.1">lexicon. </span><span class="koboSpan" id="kobo.8.2">Information security and incident responders now had insight into threats that conducted their activities without detection, and over a </span><span class="No-Break"><span class="koboSpan" id="kobo.9.1">significant period.</span></span></p>
<p><span class="koboSpan" id="kobo.10.1">With the threat that APTs pose, coupled with the average time even moderately sophisticated groups can spend in a target network, organizations have started to move from passive detection and response to a more active approach, to identify potential threats in the network. </span><span class="koboSpan" id="kobo.10.2">This practice, called threat hunting, is a proactive process, whereby digital forensics techniques are used to conduct analysis on systems and network components to identify and isolate threats that have previously gone undetected. </span><span class="koboSpan" id="kobo.10.3">As with incident response, threat hunting is a combination of processes, technology, and people that does not rely on preconfigured alerting or automated tools, but rather, incorporates various elements of incident response, threat intelligence, and </span><span class="No-Break"><span class="koboSpan" id="kobo.11.1">digital forensics.</span></span></p>
<p><span class="koboSpan" id="kobo.12.1">This chapter will provide an overview of the practice of threat hunting by examining several </span><span class="No-Break"><span class="koboSpan" id="kobo.13.1">key elements:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.14.1">Threat </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">hunting overview</span></span></li>
<li><span class="koboSpan" id="kobo.16.1">Crafting </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">a hypothesis</span></span></li>
<li><span class="koboSpan" id="kobo.18.1">Planning </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">a hunt</span></span></li>
<li><span class="koboSpan" id="kobo.20.1">Digital forensic techniques for </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">threat hunting</span></span></li>
<li><span class="koboSpan" id="kobo.22.1">EDR for </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">threat hunting</span></span></li>
</ul>
<h1 id="_idParaDest-317"><a id="_idTextAnchor325"/><span class="koboSpan" id="kobo.24.1">Threat hunting overview</span></h1>
<p><span class="koboSpan" id="kobo.25.1">Threat hunting is a </span><a id="_idIndexMarker1663"/><span class="koboSpan" id="kobo.26.1">developing discipline, driven in large part by the availability of threat intelligence along with tools, such as </span><strong class="bold"><span class="koboSpan" id="kobo.27.1">Endpoint Detection and Response</span></strong><span class="koboSpan" id="kobo.28.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.29.1">EDR</span></strong><span class="koboSpan" id="kobo.30.1">) and </span><a id="_idIndexMarker1664"/><span class="koboSpan" id="kobo.31.1">SIEM platforms, that can be leveraged to hunt for threats at the scale of today’s modern enterprise architectures. </span><span class="koboSpan" id="kobo.31.2">What has developed out of this is specific working cycles and maturity models that can guide organizations through the process of starting and executing a threat </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">hunting program.</span></span></p>
<h2 id="_idParaDest-318"><a id="_idTextAnchor326"/><span class="koboSpan" id="kobo.33.1">Threat hunt cycle</span></h2>
<p><span class="koboSpan" id="kobo.34.1">Threat </span><a id="_idIndexMarker1665"/><span class="koboSpan" id="kobo.35.1">hunting, like incident response, is a process-driven exercise. </span><span class="koboSpan" id="kobo.35.2">There is not a clearly defined and accepted process in place, but there is a general sequence that threat hunting takes that provides a process that can be followed. </span><span class="koboSpan" id="kobo.35.3">The following diagram combines the various stages of a threat hunt into a process that guides threat hunters through the various activities to facilitate an accurate and </span><span class="No-Break"><span class="koboSpan" id="kobo.36.1">complete hunt:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer392">
<span class="koboSpan" id="kobo.37.1"><img alt="Figure 18.1 – Threat hunt cycle " src="image/B18571_18_001.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.38.1">Figure 18.1 – Threat hunt cycle</span></p>
<h3><span class="koboSpan" id="kobo.39.1">Initiating event</span></h3>
<p><span class="koboSpan" id="kobo.40.1">The</span><a id="_idIndexMarker1666"/><span class="koboSpan" id="kobo.41.1"> threat hunt begins with an initiating event. </span><span class="koboSpan" id="kobo.41.2">Organizations that incorporate threat hunting into their operations may have a process or policy that threat hunting be conducted at a specific cadence or time. </span><span class="koboSpan" id="kobo.41.3">For example, an organization may have a process where the security operations team conducts four or five threat hunts per month, starting on the Monday of every week. </span><span class="koboSpan" id="kobo.41.4">Each one of these separate hunts would be considered the </span><span class="No-Break"><span class="koboSpan" id="kobo.42.1">initiating event.</span></span></p>
<p><span class="koboSpan" id="kobo.43.1">A second type of initiating event is usually driven by some type of threat intelligence alert that comes from an internal or external source. </span><span class="koboSpan" id="kobo.43.2">For example, an organization may receive an alert such as the one shown in the following screenshot. </span><span class="koboSpan" id="kobo.43.3">This alert, from the United States Federal Bureau of Investigation, available at </span><a href="https://www.aha.org/system/files/media/file/2021/05/fbi-tlp-white-report-conti-ransomware-attacks-impact-healthcare-and-first-responder-networks-5-20-21.pdf"><span class="koboSpan" id="kobo.44.1">https://www.aha.org/system/files/media/file/2021/05/fbi-tlp-white-report-conti-ransomware-attacks-impact-healthcare-and-first-responder-networks-5-20-21.pdf</span></a><span class="koboSpan" id="kobo.45.1">, indicates that there are new </span><strong class="bold"><span class="koboSpan" id="kobo.46.1">Indicators of Compromise</span></strong><span class="koboSpan" id="kobo.47.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.48.1">IOCs</span></strong><span class="koboSpan" id="kobo.49.1">) that are associated with the Conti variant of </span><a id="_idIndexMarker1667"/><span class="koboSpan" id="kobo.50.1">ransomware. </span><span class="koboSpan" id="kobo.50.2">An organization may decide to act on this intelligence and begin a hunt through the network for any indicators associated with the IOCs provided as part of </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">the alert:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer393">
<span class="koboSpan" id="kobo.52.1"><img alt="Figure 18.2 – FBI alert " src="image/B18571_18_002.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.53.1">Figure 18.2 – FBI alert</span></p>
<p><span class="koboSpan" id="kobo.54.1">After the</span><a id="_idIndexMarker1668"/><span class="koboSpan" id="kobo.55.1"> initiating event is fully understood, the next phase is to start crafting what to look for during the </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">threat hunt.</span></span></p>
<h3><span class="koboSpan" id="kobo.57.1">Creating a working hypothesis</span></h3>
<p><span class="koboSpan" id="kobo.58.1">Moving on</span><a id="_idIndexMarker1669"/><span class="koboSpan" id="kobo.59.1"> from the initiating event, the threat hunting team then creates a working hypothesis. </span><span class="koboSpan" id="kobo.59.2">Threat hunting is a focused endeavor, meaning that hunt teams do not just start poking through event logs or memory images, looking for whatever they can find. </span><span class="koboSpan" id="kobo.59.3">A working hypothesis—such as </span><em class="italic"><span class="koboSpan" id="kobo.60.1">an APT group has gained control of several systems on the network</span></em><span class="koboSpan" id="kobo.61.1">—is general and provides no specific threat hunting target. </span><span class="koboSpan" id="kobo.61.2">Threat hunters need to focus their attention on the key indicators, whether those indicators come from a persistent threat group or some existing </span><span class="No-Break"><span class="koboSpan" id="kobo.62.1">threat intelligence.</span></span></p>
<p><span class="koboSpan" id="kobo.63.1">A working hypothesis provides the focus. </span><span class="koboSpan" id="kobo.63.2">A better hypothesis would be: </span><em class="italic"><span class="koboSpan" id="kobo.64.1">An APT-style adversary has taken control of the DMZ web servers and is using them as a C2 infrastructure.</span></em><span class="koboSpan" id="kobo.65.1"> This provides a specific target to which the hunt team can then apply digital forensic techniques to determine whether this hypothesis </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">is true.</span></span></p>
<p><span class="koboSpan" id="kobo.67.1">Threat hunts that are initiated via alerts can often find key areas of focus that can be leveraged, to craft a hypothesis. </span><span class="koboSpan" id="kobo.67.2">For example, the previous section contained an alert from the FBI. </span><span class="koboSpan" id="kobo.67.3">In addition to the IOCs associated with Conti, the following text was also in </span><span class="No-Break"><span class="koboSpan" id="kobo.68.1">the alert:</span></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.69.1">The exact infection vector remains unknown, as Ryuk deletes all files related to the dropper used to deploy the malware. </span><span class="koboSpan" id="kobo.69.2">In some cases, Ryuk has been deployed secondary to TrickBot and/or Emotet banking Trojans, which use SMB protocols to propagate through the network and can be used to </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.70.1">steal credentials.</span></em></span></p>
<p><span class="koboSpan" id="kobo.71.1">From this data, the hunt team </span><a id="_idIndexMarker1670"/><span class="koboSpan" id="kobo.72.1">can craft a hypothesis that directly addresses these </span><strong class="bold"><span class="koboSpan" id="kobo.73.1">Tactics, Techniques, and Procedures</span></strong><span class="koboSpan" id="kobo.74.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.75.1">TTP</span></strong><span class="koboSpan" id="kobo.76.1">). </span><span class="koboSpan" id="kobo.76.2">The hypothesis may be: </span><em class="italic"><span class="koboSpan" id="kobo.77.1">An adversary has infected several internal systems and is using a Microsoft SMB protocol to move laterally within the internal network, with the intent of infecting other systems</span></em><span class="koboSpan" id="kobo.78.1">. </span><span class="koboSpan" id="kobo.78.2">Again, this </span><a id="_idIndexMarker1671"/><span class="koboSpan" id="kobo.79.1">sample hypothesis is specific and provides the threat hunters with a concrete area of focus to either prove or disprove </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">the hypothesis.</span></span></p>
<h3><span class="koboSpan" id="kobo.81.1">Leveraging threat intelligence</span></h3>
<p><span class="koboSpan" id="kobo.82.1">In the</span><a id="_idIndexMarker1672"/><span class="koboSpan" id="kobo.83.1"> previous chapter, there was an extensive overview of how cyber threat intelligence can be leveraged during an incident. </span><span class="koboSpan" id="kobo.83.2">As we are applying a variety of incident response and digital forensic techniques in threat hunting, cyber threat intelligence also plays an important role. </span><span class="koboSpan" id="kobo.83.3">Like the working hypothesis, threat intelligence allows the hunt team to further focus attention on specific indicators or TTPs that have been identified through a review of the pertinent threat </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">intelligence available.</span></span></p>
<p><span class="koboSpan" id="kobo.85.1">An example of this marriage between the hypothesis and threat intelligence can be provided by examining the relationship between the banking Trojan Emotet and the infrastructure that </span><span class="No-Break"><span class="koboSpan" id="kobo.86.1">supports it.</span></span></p>
<p><span class="koboSpan" id="kobo.87.1">First, the hypothesis that the hunt team has crafted is: </span><em class="italic"><span class="koboSpan" id="kobo.88.1">Systems within the internal network have been in communication with the Emotet delivery or Command and Control infrastructure</span></em><span class="koboSpan" id="kobo.89.1">. </span><span class="koboSpan" id="kobo.89.2">With that hypothesis in mind, the hunt team can leverage OSINT or commercial feeds to augment their focus. </span><span class="koboSpan" id="kobo.89.3">For example, the following sites have been identified as delivering the </span><span class="No-Break"><span class="koboSpan" id="kobo.90.1">Emotet binary:</span></span></p>
<ul>
<li><a href="https://www.cityvisualization.com/wp-includes/88586"><span class="No-Break"><span class="koboSpan" id="kobo.91.1">https://www.cityvisualization.com/wp-includes/88586</span></span></a></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.92.1">https://87creationsmedia.com/wp-includes/zz90f27</span></span></li>
<li><a href="http://karencupp.com/vur1qw/s0li7q9"><span class="No-Break"><span class="koboSpan" id="kobo.93.1">http://karencupp.com/vur1qw/s0li7q9</span></span></a></li>
<li><a href="http://www.magnumbd.com/wp-includes/w2vn93"><span class="No-Break"><span class="koboSpan" id="kobo.94.1">http://www.magnumbd.com/wp-includes/w2vn93</span></span></a></li>
<li><a href="http://minmi96.xyz/wp-includes/l5vaemt6"><span class="No-Break"><span class="koboSpan" id="kobo.95.1">http://minmi96.xyz/wp-includes/l5vaemt6</span></span></a></li>
</ul>
<p><span class="koboSpan" id="kobo.96.1">From here, the</span><a id="_idIndexMarker1673"/><span class="koboSpan" id="kobo.97.1"> hunt can focus on those systems that would have indications of traffic to </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">those URLs.</span></span></p>
<h3><span class="koboSpan" id="kobo.99.1">Applying forensic techniques</span></h3>
<p><span class="koboSpan" id="kobo.100.1">The next</span><a id="_idIndexMarker1674"/><span class="koboSpan" id="kobo.101.1"> stage in the threat hunt cycle is applying forensic techniques to test the hypothesis. </span><span class="koboSpan" id="kobo.101.2">The bulk of this book has been devoted to using forensic techniques to find indicators in a variety of locations. </span><span class="koboSpan" id="kobo.101.3">In threat hunting, the hunt team will apply those same techniques to various evidence sources to determine whether any indicators </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">are present.</span></span></p>
<p><span class="koboSpan" id="kobo.103.1">For example, in the previous section, five URLs were identified as indicators associated with the malware Emotet. </span><span class="koboSpan" id="kobo.103.2">Threat hunters could leverage several sources of evidence, to determine whether those indicators were present. </span><span class="koboSpan" id="kobo.103.3">For example, an examination of proxy logs would reveal whether any internal systems were connected to any of those URLs. </span><span class="koboSpan" id="kobo.103.4">DNS logs would also be useful, as they would indicate whether any system on the internal network attempted to resolve one or more of the URLs to establish connections. </span><span class="koboSpan" id="kobo.103.5">Finally, firewall logs may be useful in determining whether any connections were made to those URLs or associated </span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">IP addresses.</span></span></p>
<h3><span class="koboSpan" id="kobo.105.1">Identifying new indicators</span></h3>
<p><span class="koboSpan" id="kobo.106.1">During the</span><a id="_idIndexMarker1675"/><span class="koboSpan" id="kobo.107.1"> course of a threat hunt, new indicators may be discovered. </span><span class="koboSpan" id="kobo.107.2">A search of a memory image for a specific family of malware reveals a previously unknown and undetected IP address. </span><span class="koboSpan" id="kobo.107.3">These are the top 10 indicators that may be identified in a </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">threat hunt:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.109.1">Unusual outbound </span><span class="No-Break"><span class="koboSpan" id="kobo.110.1">network traffic</span></span></li>
<li><span class="koboSpan" id="kobo.111.1">Anomalies in privileged </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">user accounts</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.113.1">Geographical anomalies</span></span></li>
<li><span class="koboSpan" id="kobo.114.1">Excessive </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">login failures</span></span></li>
<li><span class="koboSpan" id="kobo.116.1">Excessive database </span><span class="No-Break"><span class="koboSpan" id="kobo.117.1">read volume</span></span></li>
<li><span class="koboSpan" id="kobo.118.1">HTML </span><span class="No-Break"><span class="koboSpan" id="kobo.119.1">response sizes</span></span></li>
<li><span class="koboSpan" id="kobo.120.1">Excessive </span><span class="No-Break"><span class="koboSpan" id="kobo.121.1">file requests</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.122.1">Port-application mismatch</span></span></li>
<li><span class="koboSpan" id="kobo.123.1">Suspicious registry or system </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">file changes</span></span></li>
<li><span class="koboSpan" id="kobo.125.1">DNS</span><a id="_idIndexMarker1676"/> <span class="No-Break"><span class="koboSpan" id="kobo.126.1">request anomalies</span></span></li>
</ul>
<h3><span class="koboSpan" id="kobo.127.1">Enriching the existing hypothesis</span></h3>
<p><span class="koboSpan" id="kobo.128.1">New</span><a id="_idIndexMarker1677"/><span class="koboSpan" id="kobo.129.1"> indicators that are identified during the threat hunt may force the modification of the existing threat hunt hypothesis. </span><span class="koboSpan" id="kobo.129.2">For example, during a threat hunt for indicators of an Emotet infection, threat hunters uncover the use of the Windows system internal tool PsExec, to move laterally in the internal network. </span><span class="koboSpan" id="kobo.129.3">From here, the original hypothesis should be changed to reflect this new technique, and any indicators should be incorporated into the continued </span><span class="No-Break"><span class="koboSpan" id="kobo.130.1">threat hunt.</span></span></p>
<p><span class="koboSpan" id="kobo.131.1">Another option available to threat hunters regarding new indicators that are discovered is to begin a new threat hunt, utilizing the new indicators as the initiating event. </span><span class="koboSpan" id="kobo.131.2">This action is often leveraged when the indicator or TTP identified is well outside the original threat hunting hypothesis. </span><span class="koboSpan" id="kobo.131.3">This is also an option where there may be multiple teams that can be leveraged. </span><span class="koboSpan" id="kobo.131.4">Finally, indicators may also necessitate moving from a threat hunt to incident response. </span><span class="koboSpan" id="kobo.131.5">This is often a necessity in cases where data loss, credential compromise, or the infection of multiple systems has occurred. </span><span class="koboSpan" id="kobo.131.6">It is up to the hunt team to determine at which </span><a id="_idIndexMarker1678"/><span class="koboSpan" id="kobo.132.1">point the existing hypothesis is modified, a new hypothesis is created, or, in the worst-case scenario, an incident </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">is declared.</span></span></p>
<h2 id="_idParaDest-319"><a id="_idTextAnchor327"/><span class="koboSpan" id="kobo.134.1">Threat hunt reporting</span></h2>
<p><a href="B18571_13.xhtml#_idTextAnchor220"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.135.1">Chapter 13</span></em></span></a><span class="koboSpan" id="kobo.136.1"> provided the details </span><a id="_idIndexMarker1679"/><span class="koboSpan" id="kobo.137.1">necessary for incident responders to properly report on their activities and findings. </span><span class="koboSpan" id="kobo.137.2">Reporting a threat hunt is just as critical, as it affords managers and policymakers insight into the tools, techniques, and processes utilized by the hunt team, as well as providing potential justification for additional tools or modifying the existing processes. </span><span class="koboSpan" id="kobo.137.3">The following are some of the key elements of a threat </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">hunt report:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.139.1">Executive summary</span></strong><span class="koboSpan" id="kobo.140.1">: This </span><a id="_idIndexMarker1680"/><span class="koboSpan" id="kobo.141.1">high-level overview of the actions taken, indicators discovered, and whether the hunt proved or disproved the hypothesis provides the decision-makers with a short narrative that can be </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">acted upon.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.143.1">Threat hunt plan</span></strong><span class="koboSpan" id="kobo.144.1">: The </span><a id="_idIndexMarker1681"/><span class="koboSpan" id="kobo.145.1">plan, including the threat hunt hypothesis, should be included as part of the threat hunt report. </span><span class="koboSpan" id="kobo.145.2">This provides the reader with the various details that the threat hunt team utilized during </span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">their work.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.147.1">Forensic report</span></strong><span class="koboSpan" id="kobo.148.1">: As </span><a href="B18571_13.xhtml#_idTextAnchor220"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.149.1">Chapter 13</span></em></span></a><span class="koboSpan" id="kobo.150.1"> explored, there is a great deal of data that is generated by forensic </span><a id="_idIndexMarker1682"/><span class="koboSpan" id="kobo.151.1">tools as well as by the incident responders themselves. </span><span class="koboSpan" id="kobo.151.2">This section of the threat hunt report is the lengthiest, as the detailed examination of each system or evidence source should be documented. </span><span class="koboSpan" id="kobo.151.3">Furthermore, there should be a comprehensive list of all evidence items that were examined as part of </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">the hunt.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.153.1">Findings</span></strong><span class="koboSpan" id="kobo.154.1">: This section </span><a id="_idIndexMarker1683"/><span class="koboSpan" id="kobo.155.1">will indicate whether the hunt team was able to either prove or disprove the hypothesis that had been set at the beginning of the hunt. </span><span class="koboSpan" id="kobo.155.2">In the event that the hypothesis was proved, there should be documentation as to what the follow-on actions were, such as a modification to the hypothesis, a new hypothesis, or whether the incident response capability was engaged. </span><span class="koboSpan" id="kobo.155.3">Finally, any IOCs, </span><strong class="bold"><span class="koboSpan" id="kobo.156.1">Indicators of Attacks</span></strong><span class="koboSpan" id="kobo.157.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.158.1">IOAs</span></strong><span class="koboSpan" id="kobo.159.1">), or</span><a id="_idIndexMarker1684"/><span class="koboSpan" id="kobo.160.1"> TTPs that were found as part of the threat hunt should also </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">be documented.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.162.1">Another key area of the Findings section should be an indication of how the existing process and technology were able to facilitate a detailed threat hunt. </span><span class="koboSpan" id="kobo.162.2">For example, if the threat hunt indicated that Windows event logs were insufficient in terms of time or quantity, this should be indicated in the report. </span><span class="koboSpan" id="kobo.162.3">This type of insight provides the ability to justify additional time and resources spent on creating an environment where sufficient network and system visibility is obtained to facilitate a detailed </span><span class="No-Break"><span class="koboSpan" id="kobo.163.1">threat hunt.</span></span></p>
<p><span class="koboSpan" id="kobo.164.1">One final section of the threat hunt report is a section devoted to non-security or incident-related findings. </span><span class="koboSpan" id="kobo.164.2">Threat hunts may often find vulnerable systems, existing configuration errors, or non-incident-related data points. </span><span class="koboSpan" id="kobo.164.3">These should be reported as part of the</span><a id="_idIndexMarker1685"/><span class="koboSpan" id="kobo.165.1"> threat hunt so that they can </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">be remediated.</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.167.1">Recommendations</span></strong><span class="koboSpan" id="kobo.168.1">: As there </span><a id="_idIndexMarker1686"/><span class="koboSpan" id="kobo.169.1">will often be findings, even on threat hunts that disprove the hypothesis and include no security findings, recommendations to improve future threat hunts, the security posture of the organization, or improvements to system configuration should be included. </span><span class="koboSpan" id="kobo.169.2">It would also be advisable to break these recommendations out into groups. </span><span class="koboSpan" id="kobo.169.3">For example, strategic recommendations may include long-term configuration or security posture improvements that may take an increased number of resources and time to implement. </span><span class="koboSpan" id="kobo.169.4">Tactical recommendations may include short-term or simple improvements to the threat hunt process or systems settings that would improve the fidelity of alerting. </span><span class="koboSpan" id="kobo.169.5">To further classify recommendations, there may be a criticality placed on the recommendations, with those recommendations needed to improve the security posture or to prevent a high-risk attack given higher priority than those recommendations that are simply focused on process improvement or </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">configuration changes.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.171.1">The threat hunt report contains a good deal of data that can be used to continually improve the overall threat hunting process. </span><span class="koboSpan" id="kobo.171.2">Another aspect to consider is which metrics can be reported to senior managers about threat hunts. </span><span class="koboSpan" id="kobo.171.3">Some key data points they may be interested in are the hours utilized, previously unknown indicators identified, infected systems identified, threats identified, and the number of systems contained. </span><span class="koboSpan" id="kobo.171.4">Having data that </span><a id="_idIndexMarker1687"/><span class="koboSpan" id="kobo.172.1">provides indicators of the threat hunt’s ability to identify previously unidentified threats will go a long way to ensuring that this is a continuing practice that becomes a part of the routine security operations of </span><span class="No-Break"><span class="koboSpan" id="kobo.173.1">an organization.</span></span></p>
<h2 id="_idParaDest-320"><a id="_idTextAnchor328"/><span class="koboSpan" id="kobo.174.1">Threat hunting maturity model</span></h2>
<p><span class="koboSpan" id="kobo.175.1">The cybersecurity expert </span><a id="_idIndexMarker1688"/><span class="koboSpan" id="kobo.176.1">David Bianco, the developer of the Pyramid of Pain covered in the previous chapter, developed the threat hunting maturity model while working for the cybersecurity company Sqrrl. </span><span class="koboSpan" id="kobo.176.2">It is important to understand this maturity model in relation to threat hunting, as it provides threat hunters and their organization with a construct in determining the roadmap to maturing the threat hunting process in their organization. </span><span class="koboSpan" id="kobo.176.3">The maturity model is made up of five levels, starting with </span><strong class="bold"><span class="koboSpan" id="kobo.177.1">Hunt Maturity 0</span></strong><span class="koboSpan" id="kobo.178.1"> (or </span><strong class="bold"><span class="koboSpan" id="kobo.179.1">HM0</span></strong><span class="koboSpan" id="kobo.180.1">) and going </span><a id="_idIndexMarker1689"/><span class="koboSpan" id="kobo.181.1">up </span><span class="No-Break"><span class="koboSpan" id="kobo.182.1">to HM4.</span></span></p>
<p><span class="koboSpan" id="kobo.183.1">What follows is a review of the five levels of </span><span class="No-Break"><span class="koboSpan" id="kobo.184.1">the model:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.185.1">HM0 – Initial</span></strong><span class="koboSpan" id="kobo.186.1">: During </span><a id="_idIndexMarker1690"/><span class="koboSpan" id="kobo.187.1">the initial stage, organizations rely exclusively on automated tools such as network- or host-based intrusion prevention/detection systems, antivirus, or SIEM to provide alerts to the threat hunt team. </span><span class="koboSpan" id="kobo.187.2">These alerts are then manually investigated and remediated. </span><span class="koboSpan" id="kobo.187.3">Along with a heavy reliance on alerting, there is no use of threat intelligence indicators at this stage of maturity. </span><span class="koboSpan" id="kobo.187.4">Finally, this maturity level is characterized by a limited ability to collect telemetry from systems. </span><span class="koboSpan" id="kobo.187.5">Organizations at this stage are not able to </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">threat hunt.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.189.1">HM1 – Minimal</span></strong><span class="koboSpan" id="kobo.190.1">: At the </span><a id="_idIndexMarker1691"/><span class="koboSpan" id="kobo.191.1">minimal stage, organizations are collecting more data and, in fact, may have access to a good deal of system telemetry available. </span><span class="koboSpan" id="kobo.191.2">In addition, these organizations manifest the intent to incorporate threat intelligence into their operations but are behind in terms of the latest data and intelligence on threat actors. </span><span class="koboSpan" id="kobo.191.3">Although this group will often still rely on automated alerting, the increased level of system telemetry affords this group the ability to extract threat intelligence indicators from reports and search available data for any matching indicators. </span><span class="koboSpan" id="kobo.191.4">This is the first level at which threat hunting </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">can begin.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.193.1">HM2 – Procedural</span></strong><span class="koboSpan" id="kobo.194.1">: At this</span><a id="_idIndexMarker1692"/><span class="koboSpan" id="kobo.195.1"> stage, the organization is making use of threat hunting procedures that have been developed by other organizations, which are then applied to a specific use case. </span><span class="koboSpan" id="kobo.195.2">For example, an organization may find a presentation or use case write-up concerning lateral movement via a Windows system’s internal tools. </span><span class="koboSpan" id="kobo.195.3">From here, they would extract the pertinent features of this procedure and apply them to their own dataset. </span><span class="koboSpan" id="kobo.195.4">At this stage, the organization is not able to create its own process for threat hunting. </span><span class="koboSpan" id="kobo.195.5">The HM2 stage also represents the most common level of threat hunting maturity for organizations that have threat </span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">hunting programs.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.197.1">HM3 – Innovative</span></strong><span class="koboSpan" id="kobo.198.1">: At this </span><a id="_idIndexMarker1693"/><span class="koboSpan" id="kobo.199.1">maturity level, the threat hunters are developing their own processes. </span><span class="koboSpan" id="kobo.199.2">There is also increased use of various methods outside manual processes, such as machine learning, statistical, and link analysis. </span><span class="koboSpan" id="kobo.199.3">There is a great deal of data that is available at this level </span><span class="No-Break"><span class="koboSpan" id="kobo.200.1">as well.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.201.1">HM4 – Leading</span></strong><span class="koboSpan" id="kobo.202.1">: Representing</span><a id="_idIndexMarker1694"/><span class="koboSpan" id="kobo.203.1"> the bleeding edge of threat hunting, the Leading maturity level incorporates a good deal of the features of HM3 with one significant difference, and that is the use of automation. </span><span class="koboSpan" id="kobo.203.2">Processes that have produced results in the past are automated, providing an opportunity for threat hunters to craft new threat hunting systems that are more adept at keeping pace with </span><span class="No-Break"><span class="koboSpan" id="kobo.204.1">emerging threats.</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.205.1">Threat hunt maturity model</span></p>
<p class="callout"><span class="koboSpan" id="kobo.206.1">The threat hunt maturity model</span><a id="_idIndexMarker1695"/><span class="koboSpan" id="kobo.207.1"> is a useful construct for organizations to identify their current level of maturity, as well as planning for the inclusion of future technology and processes, to keep pace with the very fluid </span><span class="No-Break"><span class="koboSpan" id="kobo.208.1">threat landscape.</span></span></p>
<h1 id="_idParaDest-321"><a id="_idTextAnchor329"/><span class="koboSpan" id="kobo.209.1">Crafting a hypothesis</span></h1>
<p><span class="koboSpan" id="kobo.210.1">In a previous section, we </span><a id="_idIndexMarker1696"/><span class="koboSpan" id="kobo.211.1">explored the importance of crafting a specific and actionable threat hunting hypothesis. </span><span class="koboSpan" id="kobo.211.2">In addition, we looked at how threat intelligence can assist us with crafting a hypothesis. </span><span class="koboSpan" id="kobo.211.3">Another key dataset to leverage when crafting a hypothesis is the MITRE ATT&amp;CK framework. </span><span class="koboSpan" id="kobo.211.4">In terms of crafting a specific hypothesis, this framework is excellent to drill down to a specific data point or points necessary to craft a </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">solid hypothesis.</span></span></p>
<h2 id="_idParaDest-322"><a id="_idTextAnchor330"/><span class="koboSpan" id="kobo.213.1">MITRE ATT&amp;CK</span></h2>
<p><span class="koboSpan" id="kobo.214.1">In </span><a href="B18571_17.xhtml#_idTextAnchor304"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.215.1">Chapter 17</span></em></span></a><span class="koboSpan" id="kobo.216.1"> there was an exploration </span><a id="_idIndexMarker1697"/><span class="koboSpan" id="kobo.217.1">of the MITRE ATT&amp;CK framework, as it pertains to the incorporation of threat intelligence into incident response. </span><span class="koboSpan" id="kobo.217.2">The MITRE ATT&amp;CK framework is also extremely useful in the initial planning and execution of a threat hunt. </span><span class="koboSpan" id="kobo.217.3">The MITRE ATT&amp;CK framework is useful in a variety of areas in threat hunting, but for the purposes of this chapter, the focus will be on two specific use cases. </span><span class="koboSpan" id="kobo.217.4">First will be the use of the framework to craft a specific hypothesis. </span><span class="koboSpan" id="kobo.217.5">Second, the framework can be utilized to determine likely evidence sources that would produce the </span><span class="No-Break"><span class="koboSpan" id="kobo.218.1">best indicators.</span></span></p>
<p><span class="koboSpan" id="kobo.219.1">The first use case, crafting the hypothesis, can be achieved through an examination of the various tactics and techniques of the MITRE ATT&amp;CK framework. </span><span class="koboSpan" id="kobo.219.2">Although descriptive, the tactics are not specific enough to be useful in threat hunt hypothesis creation. </span><span class="koboSpan" id="kobo.219.3">What threat hunters should be focusing attention on are the various techniques that make up a tactic—for example, examining the initial access tactic, which describes the various techniques that adversaries utilize to gain an initial foothold. </span><span class="koboSpan" id="kobo.219.4">The MITRE ATT&amp;CK framework describes these tactics </span><span class="No-Break"><span class="koboSpan" id="kobo.220.1">in detail.</span></span></p>
<p><span class="koboSpan" id="kobo.221.1">Where the MITRE ATT&amp;CK framework can be leveraged for a hypothesis is through the incorporation of one or more of these techniques across various tactics. </span><span class="koboSpan" id="kobo.221.2">For example, if a threat hunt team is concerned about C2 traffic, they can look under TA0011 in the MITRE ATT&amp;CK enterprise tactics. </span><span class="koboSpan" id="kobo.221.3">There are 22 specific techniques that fall under that tactic. </span><span class="koboSpan" id="kobo.221.4">From here, the threat hunt team can select a technique, such as T1132—Data Encoding. </span><span class="koboSpan" id="kobo.221.5">They can then craft a hypothesis that states: </span><em class="italic"><span class="koboSpan" id="kobo.222.1">An adversary has compromised a system on the internal network and is using encoding or compression to obfuscate </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.223.1">C2 traffic</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.225.1">In this instance, the MITRE ATT&amp;CK framework provided a solid foundation for crafting a hypothesis. </span><span class="koboSpan" id="kobo.225.2">What the MITRE ATT&amp;CK framework also provides is an insight into the various threat actor groups and tools that have been identified as using this type of technique. </span><span class="koboSpan" id="kobo.225.3">For example, examining the technique T1132—Data Encoding, located at </span><a href="https://attack.mitre.org/techniques/T1132/"><span class="koboSpan" id="kobo.226.1">https://attack.mitre.org/techniques/T1132/</span></a><span class="koboSpan" id="kobo.227.1">, reveals that threat actor groups such as APT19 and APT33 both use this technique to obfuscate their C2 traffic. </span><span class="koboSpan" id="kobo.227.2">In terms of tools, MITRE indicates that a variety of malware families, such as Linux Rabbit and njRAT, use obfuscation techniques, such as Base64 encoding or encoded URL parameters. </span><span class="koboSpan" id="kobo.227.3">This can further focus a threat hunt on specific threat groups or malware families if the hunt </span><span class="No-Break"><span class="koboSpan" id="kobo.228.1">team wishes.</span></span></p>
<p><span class="koboSpan" id="kobo.229.1">The second way the MITRE ATT&amp;CK framework can be leveraged for threat hunting is by providing guidance on evidence sources. </span><span class="koboSpan" id="kobo.229.2">Going back to the T1132—Data Encoding technique, MITRE indicates that the best data sources for indicators associated with this technique are packet captures, network protocol analysis, process monitoring, and identifying processes that are using network connections. </span><span class="koboSpan" id="kobo.229.3">From here, the threat hunter could leverage packet capture analysis with Moloch or Wireshark, to identify any malicious indicators. </span><span class="koboSpan" id="kobo.229.4">These can be further augmented with an examination of key systems’ memory for network connections and their </span><span class="No-Break"><span class="koboSpan" id="kobo.230.1">associated processes.</span></span></p>
<p><span class="koboSpan" id="kobo.231.1">MITRE</span><a id="_idIndexMarker1698"/><span class="koboSpan" id="kobo.232.1"> will often break down additional details that will assist threat hunt teams in their search for indicators. </span><span class="koboSpan" id="kobo.232.2">Technique 1132 contains additional details concerning this specific technique, as </span><span class="No-Break"><span class="koboSpan" id="kobo.233.1">shown here:</span></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.234.1">Analyze network data for uncommon data flows (for example, a client sending significantly more data than it receives from a server). </span><span class="koboSpan" id="kobo.234.2">Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. </span><span class="koboSpan" id="kobo.234.3">Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.235.1">being used.</span></em></span></p>
<p><span class="koboSpan" id="kobo.236.1">The details regarding the technique, the data sources, and the potential course of action are a great aid to threat hunters, as it affords them the ability to put a laser focus on the threat hunt, the hypothesis, and—finally—a course of action. </span><span class="koboSpan" id="kobo.236.2">These elements go a long way in crafting a plan for the </span><span class="No-Break"><span class="koboSpan" id="kobo.237.1">threat hunt.</span></span></p>
<h1 id="_idParaDest-323"><a id="_idTextAnchor331"/><span class="koboSpan" id="kobo.238.1">Planning a hunt</span></h1>
<p><span class="koboSpan" id="kobo.239.1">Beginning a threat hunt</span><a id="_idIndexMarker1699"/><span class="koboSpan" id="kobo.240.1"> does not require a good deal of planning, but there should be some structure as to how the threat hunt will be conducted, the sources of data, and the period on which the threat hunt will focus. </span><span class="koboSpan" id="kobo.240.2">A brief written plan will address all of the key points necessary and place all of the hunt team on the same focus area so that extraneous data that does not pertain to the threat hunt is minimized. </span><span class="koboSpan" id="kobo.240.3">The following are seven key elements that should be addressed in </span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">any plan:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.242.1">Hypothesis</span></strong><span class="koboSpan" id="kobo.243.1">: A one- or two-sentence</span><a id="_idIndexMarker1700"/><span class="koboSpan" id="kobo.244.1"> hypothesis, which was discussed earlier. </span><span class="koboSpan" id="kobo.244.2">This hypothesis should be clearly understood by all the hunt </span><span class="No-Break"><span class="koboSpan" id="kobo.245.1">team members.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.246.1">MITRE ATT&amp;CK tactic(s)</span></strong><span class="koboSpan" id="kobo.247.1">: In the previous chapter, there was a discussion of the MITRE ATT&amp;CK framework</span><a id="_idIndexMarker1701"/><span class="koboSpan" id="kobo.248.1"> and its application to threat intelligence and incident response. </span><span class="koboSpan" id="kobo.248.2">In this case, the threat hunt should include specific tactics that have been in use by threat actors. </span><span class="koboSpan" id="kobo.248.3">Select the tactics that are most applicable to </span><span class="No-Break"><span class="koboSpan" id="kobo.249.1">the hypothesis.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.250.1">Threat intelligence</span></strong><span class="koboSpan" id="kobo.251.1">: The </span><a id="_idIndexMarker1702"/><span class="koboSpan" id="kobo.252.1">hunt team should leverage as much internally developed and externally sourced threat intelligence as possible. </span><span class="koboSpan" id="kobo.252.2">External sources can either be commercial providers or OSINT. </span><span class="koboSpan" id="kobo.252.3">The threat intelligence should be IOCs, IOAs, and TTPs that are directly related to the hypothesis and the MITRE ATT&amp;CK tactics that were previously identified. </span><span class="koboSpan" id="kobo.252.4">These are the data points that the hunt team will leverage during </span><span class="No-Break"><span class="koboSpan" id="kobo.253.1">the hunt.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.254.1">Evidence sources</span></strong><span class="koboSpan" id="kobo.255.1">: This </span><a id="_idIndexMarker1703"/><span class="koboSpan" id="kobo.256.1">should be a list of the various evidence sources that should be leveraged during the threat hunt. </span><span class="koboSpan" id="kobo.256.2">For example, if the hunt team is looking for indicators of lateral movement via SMB, they may want to leverage NetFlow or selected packet captures. </span><span class="koboSpan" id="kobo.256.3">Other indicators of lateral movement using Remote Desktop can be found within the Windows </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">event logs.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.258.1">Tools</span></strong><span class="koboSpan" id="kobo.259.1">: This section of the plan </span><a id="_idIndexMarker1704"/><span class="koboSpan" id="kobo.260.1">outlines the specific tools that are necessary to review evidence. </span><span class="koboSpan" id="kobo.260.2">For example, </span><a href="B18571_12.xhtml#_idTextAnchor204"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.261.1">Chapter 12</span></em></span></a><span class="koboSpan" id="kobo.262.1"> addressed log file analysis with the open source tool Skadi. </span><span class="koboSpan" id="kobo.262.2">If the threat hunt intends to use this tool, it should be included in </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">the plan.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.264.1">Scope</span></strong><span class="koboSpan" id="kobo.265.1">: This refers to the </span><a id="_idIndexMarker1705"/><span class="koboSpan" id="kobo.266.1">systems that will be included in the threat hunt. </span><span class="koboSpan" id="kobo.266.2">The plan should indicate either a single system or systems, a subnet, or a network segment on which to focus. </span><span class="koboSpan" id="kobo.266.3">In the beginning, threat hunters should focus on a limited number of systems and add more as they become more familiar with the toolset and how much evidence can be examined in the </span><span class="No-Break"><span class="koboSpan" id="kobo.267.1">time given.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.268.1">Timeframe</span></strong><span class="koboSpan" id="kobo.269.1">: As threat</span><a id="_idIndexMarker1706"/><span class="koboSpan" id="kobo.270.1"> hunting often involves a retrospective examination of evidence, it is necessary to set a timeframe upon which the threat hunt team should focus. </span><span class="koboSpan" id="kobo.270.2">For example, if an originating event is relatively new (say, 48 hours), the timeframe indicated in the plan may be limited to the past 72 hours, to address any previously undetected adversarial action. </span><span class="koboSpan" id="kobo.270.3">Other timeframes may widen the threat hunt to 14—or even 30—days, based on the hypothesis and threat </span><span class="No-Break"><span class="koboSpan" id="kobo.271.1">intelligence available.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.272.1">Here is an example threat hunt plan that incorporates these elements into an easy-to-view framework for a threat hunt identifying the presence of </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">Cobalt Strike:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer394">
<span class="koboSpan" id="kobo.274.1"><img alt="Figure 18.3 – Threat hunt plan " src="image/B18571_18_003.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.275.1">Figure 18.3 – Threat hunt plan</span></p>
<p><span class="koboSpan" id="kobo.276.1">This plan</span><a id="_idIndexMarker1707"/><span class="koboSpan" id="kobo.277.1"> outlines a threat hunt for the presence of Cobalt Strike. </span><span class="koboSpan" id="kobo.277.2">The hypothesis and MITRE ATT&amp;CK techniques are clearly defined and set the scope of the overall effort. </span><span class="koboSpan" id="kobo.277.3">From a threat intelligence perspective, the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.278.1">cobaltstrikebot</span></strong><span class="koboSpan" id="kobo.279.1"> is an excellent source of up-to-date IOCs. </span><span class="koboSpan" id="kobo.279.2">Evidence sources and the tool necessary are clearly defined along with the specific scope of telemetry that can be leveraged. </span><span class="koboSpan" id="kobo.279.3">Finally, the analysts have set a 7-day timeframe for this threat hunt. </span><span class="koboSpan" id="kobo.279.4">Due to the prevalence and associated risk of tools such as Cobalt Strike, this type of threat hunt may be conducted weekly, which is reflected in </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">the timeframe.</span></span></p>
<p><span class="koboSpan" id="kobo.281.1">Now that we have a plan, let’s briefly look at how forensic techniques fit into threat hunting and how we can hunt </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">at scale.</span></span></p>
<h1 id="_idParaDest-324"><a id="_idTextAnchor332"/><span class="koboSpan" id="kobo.283.1">Digital forensic techniques for threat hunting</span></h1>
<p><span class="koboSpan" id="kobo.284.1">We have dedicated </span><a id="_idIndexMarker1708"/><span class="koboSpan" id="kobo.285.1">several chapters to digital</span><a id="_idIndexMarker1709"/><span class="koboSpan" id="kobo.286.1"> forensic techniques for both network and endpoint systems. </span><span class="koboSpan" id="kobo.286.2">The challenge with applying these techniques to hunting is that some do not fit with the overall approach to threat hunting. </span><span class="koboSpan" id="kobo.286.3">For example, a hunt organized around identifying malicious script execution cannot rely on individual systems chosen at random but rather the ability to examine all systems across the entire network for </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">matching behaviors.</span></span></p>
<p><span class="koboSpan" id="kobo.288.1">Here are some considerations to consider when examining how to integrate digital forensic techniques into a threat </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">hunting program:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.290.1">Identify your data sources</span></strong><span class="koboSpan" id="kobo.291.1">: If you do not have the ability to leverage firewall connection logs for more than a 24-hour period, it may be difficult to go back far enough to conduct a proper threat hunt of suspicious network connections. </span><span class="koboSpan" id="kobo.291.2">Instead of throwing your hands up, put together some threat research to identify other behaviors that align with your tool selection. </span><span class="koboSpan" id="kobo.291.3">If you can pull in PowerShell logs for the past 10 days, you have a much better chance of detecting post-exploitation frameworks focusing on a search of the Windows event logs than </span><span class="No-Break"><span class="koboSpan" id="kobo.292.1">firewall logs.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.293.1">Focus on scale</span></strong><span class="koboSpan" id="kobo.294.1">: Many of the forensic techniques that we have examined in the previous chapters are executed after some other piece of data indicates that evidence may be contained in a specific system. </span><span class="koboSpan" id="kobo.294.2">Look at the execution of ProcDump, for example. </span><span class="koboSpan" id="kobo.294.3">An alert or other indication from a SIEM will usually point to a specific system to investigate. </span><span class="koboSpan" id="kobo.294.4">What is needed is the ability to scan for this behavior across the network. </span><span class="koboSpan" id="kobo.294.5">This requires the use of tools such as an IDS/IPS, an SIEM, or, as we will discuss next, an EDR tool that allows for </span><span class="No-Break"><span class="koboSpan" id="kobo.295.1">that scale.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.296.1">Just start hunting</span></strong><span class="koboSpan" id="kobo.297.1">: As we</span><a id="_idIndexMarker1710"/><span class="koboSpan" id="kobo.298.1"> saw with the maturity</span><a id="_idIndexMarker1711"/><span class="koboSpan" id="kobo.299.1"> model, you are not going to be at the bleeding edge of threat hunting right out of the gate. </span><span class="koboSpan" id="kobo.299.2">Rather, it is better to start small. </span><span class="koboSpan" id="kobo.299.3">For example, identify the top five threats that actors are leveraging from threat intelligence sources. </span><span class="koboSpan" id="kobo.299.4">Then, focus your evidence collection and analysis. </span><span class="koboSpan" id="kobo.299.5">As you go through this process, you will identify additional data sources and evidence collection tools or techniques that you can later incorporate into </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">the process.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.301.1">Only one of three outcomes</span></strong><span class="koboSpan" id="kobo.302.1">: A final consideration is that hunting has one of three outcomes. </span><span class="koboSpan" id="kobo.302.2">First, you have proven your hypothesis correct and now you must pivot into incident response. </span><span class="koboSpan" id="kobo.302.3">Second, you have not proved your hypothesis but have validated that your tools and techniques were sufficient to come to an accurate conclusion. </span><span class="koboSpan" id="kobo.302.4">Third and final, you were not able to prove or disprove your hypothesis due to a lack of tools, immaturity techniques, or a combination of both. </span><span class="koboSpan" id="kobo.302.5">In any case, there </span><a id="_idIndexMarker1712"/><span class="koboSpan" id="kobo.303.1">is a continuous improvement</span><a id="_idIndexMarker1713"/><span class="koboSpan" id="kobo.304.1"> of your </span><span class="No-Break"><span class="koboSpan" id="kobo.305.1">hunt program.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.306.1">Next, we will briefly look at how EDR platforms help with providing digital forensics </span><span class="No-Break"><span class="koboSpan" id="kobo.307.1">at scale.</span></span></p>
<h1 id="_idParaDest-325"><a id="_idTextAnchor333"/><span class="koboSpan" id="kobo.308.1">EDR for threat hunting</span></h1>
<p><span class="koboSpan" id="kobo.309.1">A group of tools</span><a id="_idIndexMarker1714"/><span class="koboSpan" id="kobo.310.1"> that greatly aid in threat</span><a id="_idIndexMarker1715"/><span class="koboSpan" id="kobo.311.1"> hunting is EDR tools. </span><span class="koboSpan" id="kobo.311.2">These tools build on the existing methodology of antivirus platforms. </span><span class="koboSpan" id="kobo.311.3">Many of these platforms also have the ability to search across the enterprise for specific IOCs and other data points, allowing threat hunt teams to search an extensive number of systems for any matching IOCs. </span><span class="koboSpan" id="kobo.311.4">These tools should be leveraged extensively during a </span><span class="No-Break"><span class="koboSpan" id="kobo.312.1">threat hunt.</span></span></p>
<p><span class="koboSpan" id="kobo.313.1">This type of functionality may be out of the budget of some organizations. </span><span class="koboSpan" id="kobo.313.2">In that case, we can use the previously discussed tool Velociraptor for threat hunting as well. </span><span class="koboSpan" id="kobo.313.3">In this case, let’s look at a threat hunt where the hypothesis is that a previously unidentified threat actor is using RDP to connect to internal systems as their </span><span class="No-Break"><span class="koboSpan" id="kobo.314.1">initial foothold:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.315.1">To start, log into Velociraptor and click on the target symbol in the far-left column. </span><span class="koboSpan" id="kobo.315.2">This will open up the threat </span><span class="No-Break"><span class="koboSpan" id="kobo.316.1">hunting page.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer395">
<span class="koboSpan" id="kobo.317.1"><img alt="Figure 18.4 – Configuring a threat hunt " src="image/B18571_18_004.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.318.1">Figure 18.4 – Configuring a threat hunt</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.319.1">Next, click </span><a id="_idIndexMarker1716"/><span class="koboSpan" id="kobo.320.1">the plus sign to start </span><a id="_idIndexMarker1717"/><span class="koboSpan" id="kobo.321.1">a new </span><span class="No-Break"><span class="koboSpan" id="kobo.322.1">threat hunt.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer396">
<span class="koboSpan" id="kobo.323.1"><img alt="Figure 18.5 – Threat hunt description " src="image/B18571_18_005.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.324.1">Figure 18.5 – Threat hunt description</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.325.1">Enter </span><a id="_idIndexMarker1718"/><span class="koboSpan" id="kobo.326.1">a description</span><a id="_idIndexMarker1719"/><span class="koboSpan" id="kobo.327.1"> and then click </span><strong class="bold"><span class="koboSpan" id="kobo.328.1">Select Artifacts</span></strong><span class="koboSpan" id="kobo.329.1">. </span><span class="koboSpan" id="kobo.329.2">Either scroll or use a keyword search to find the Remote Desktop artifacts listed </span><span class="No-Break"><span class="koboSpan" id="kobo.330.1">as </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.331.1">Windows.EventLogs.RDPAuth</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.332.1">.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer397">
<span class="koboSpan" id="kobo.333.1"><img alt="Figure 18.6 – Setting artifacts to collect " src="image/B18571_18_006.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.334.1">Figure 18.6 – Setting artifacts to collect</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.335.1">Leave the remaining parameters as default and </span><span class="No-Break"><span class="koboSpan" id="kobo.336.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.337.1">Launch</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.338.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.339.1">Select the hunt in the middle pane and then click the </span><strong class="bold"><span class="koboSpan" id="kobo.340.1">Play</span></strong><span class="koboSpan" id="kobo.341.1"> sign in the </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">upper-left corner.</span></span></li>
<li><span class="koboSpan" id="kobo.343.1">Download </span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">the results.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer398">
<span class="koboSpan" id="kobo.345.1"><img alt="Figure 18.7 – Download results " src="image/B18571_18_007.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.346.1">Figure 18.7 – Download results</span></p>
<p><span class="koboSpan" id="kobo.347.1">In this case, we</span><a id="_idIndexMarker1720"/><span class="koboSpan" id="kobo.348.1"> will run through a summary</span><a id="_idIndexMarker1721"/><span class="koboSpan" id="kobo.349.1"> of the results, which is in a CSV document. </span><span class="koboSpan" id="kobo.349.2">We can see in the document the actual RDP connections with associated </span><span class="No-Break"><span class="koboSpan" id="kobo.350.1">IP addresses.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer399">
<span class="koboSpan" id="kobo.351.1"><img alt="Figure 18.8 – Threat hunt results " src="image/B18571_18_008.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.352.1">Figure 18.8 – Threat hunt results</span></p>
<p><span class="koboSpan" id="kobo.353.1">From here, analysts can parse the data and determine what connections require further escalation </span><span class="No-Break"><span class="koboSpan" id="kobo.354.1">and investigation.</span></span></p>
<p><span class="koboSpan" id="kobo.355.1">EDR tools </span><a id="_idIndexMarker1722"/><span class="koboSpan" id="kobo.356.1">allow analysts to conduct threat </span><a id="_idIndexMarker1723"/><span class="koboSpan" id="kobo.357.1">hunting at scale for even the largest networks. </span><span class="koboSpan" id="kobo.357.2">This ability is crucial when hunting threats that can impact a wide variety of systems across the network. </span><span class="koboSpan" id="kobo.357.3">Even without an EDR, tools such as Velociraptor can provide similar functionality that allows analysts to quickly get to the data they need to conduct a proper </span><span class="No-Break"><span class="koboSpan" id="kobo.358.1">threat hunt.</span></span></p>
<h1 id="_idParaDest-326"><a id="_idTextAnchor334"/><span class="koboSpan" id="kobo.359.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.360.1">Eric O’Neill, former FBI intelligence professional and cybersecurity expert, has said: </span><em class="italic"><span class="koboSpan" id="kobo.361.1">When you don’t hunt the threat, the threat hunts you</span></em><span class="koboSpan" id="kobo.362.1">. </span><span class="koboSpan" id="kobo.362.2">This is exactly the sentiment behind threat hunting. </span><span class="koboSpan" id="kobo.362.3">As was explored, the average time from compromise to detection is plenty for adversaries to do significant damage. </span><span class="koboSpan" id="kobo.362.4">Threat detection can be done by understanding the level of maturity in an organization in terms of proactive threat hunting, applying the threat hunt cycle, adequately planning, and—finally—recording the findings. </span><span class="koboSpan" id="kobo.362.5">Taking a proactive stance may reduce the time an adversary has to cause damage and help to possibly ke</span><a id="_idTextAnchor335"/><span class="koboSpan" id="kobo.363.1">ep ahead of the constantly shifting </span><span class="No-Break"><span class="koboSpan" id="kobo.364.1">threat landscape.</span></span></p>
<h1 id="_idParaDest-327"><a id="_idTextAnchor336"/><span class="koboSpan" id="kobo.365.1">Questions</span></h1>
<p><span class="koboSpan" id="kobo.366.1">Answer the following questions to test your knowledge of </span><span class="No-Break"><span class="koboSpan" id="kobo.367.1">this chapter:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.368.1">At what level of the threat hunting maturity model would technologies such as machine learning </span><span class="No-Break"><span class="koboSpan" id="kobo.369.1">be found?</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.370.1">HM0</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.371.1">HM1</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.372.1">HM2</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.373.1">HM3</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.374.1">Which of the following is a top </span><span class="No-Break"><span class="koboSpan" id="kobo.375.1">10 IOC?</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.376.1">IP address</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.377.1">Malware signature</span></span></li><li><span class="koboSpan" id="kobo.378.1">Excessive </span><span class="No-Break"><span class="koboSpan" id="kobo.379.1">file request</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.380.1">URL</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.381.1">A threat hunt-initiating event can be a threat </span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">intelligence report.</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.383.1">True</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.384.1">False</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.385.1">A working hypothesis is a generalized statement regarding the intent of the </span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">threat hunt.</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.387.1">True</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.388.1">False</span></span></li></ol></li>
</ol>
<h1 id="_idParaDest-328"><a id="_idTextAnchor337"/><span class="koboSpan" id="kobo.389.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.390.1">Refer to the following for more details about the topics covered in </span><span class="No-Break"><span class="koboSpan" id="kobo.391.1">this chapter:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.392.1">Your Practical Guide to Threat </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.393.1">Hunting</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.394.1">: </span></span><a href="https://www.threathunting.net/files/hunt-evil-practical-guide-threat-hunting.pdf"><span class="No-Break"><span class="koboSpan" id="kobo.395.1">https://www.threathunting.net/files/hunt-evil-practical-guide-threat-hunting.pdf</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.396.1">Threat hunting with </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.397.1">Velociraptor</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.398.1">: </span></span><a href="https://docs.velociraptor.app/presentations/2022_sans_summit/"><span class="No-Break"><span class="koboSpan" id="kobo.399.1">https:/</span><span id="_idTextAnchor338"/><span id="_idTextAnchor339"/><span class="koboSpan" id="kobo.400.1">/docs.velociraptor.app/presentations/2022_sans_summit/</span></span></a></li>
</ul>
</div>


<div id="_idContainer401">
<h1 id="_idParaDest-329"><a id="_idTextAnchor340"/><span class="koboSpan" id="kobo.1.1">Appendix</span></h1>
<p><span class="koboSpan" id="kobo.2.1">There is a significant number of Windows Event Log types available to IT and security professionals. </span><span class="koboSpan" id="kobo.2.2">This </span><em class="italic"><span class="koboSpan" id="kobo.3.1">Appendix</span></em><span class="koboSpan" id="kobo.4.1"> includes the most critical events that pertain to security and incident investigations and have been provided as </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">a reference.</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-2">
<colgroup>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.6.1">Event ID</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.7.1">Event type</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.8.1">Primary use</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.9.1">Event log</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.10.1">21</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.11.1">Remote desktop services: session </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">logon succeeded.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.13.1">Event correlation, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">movement, scoping</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.15.1">TerminalServices-LocalSession Manager/Operational</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.16.1">25</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.17.1">Remote desktop services: session </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">reconnection succeeded.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.19.1">Event correlation, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">movement, scoping</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.21.1">TerminalServices-LocalSession Manager/Operational</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.22.1">102</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.23.1">This event is logged when the terminal services gateway service requires a valid Secure Sockets Layer (SSL) </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">certificate to</span></span></p>
<p><span class="No-Break"><span class="koboSpan" id="kobo.25.1">accept connections.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.26.1">Event correlation, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">movement, scoping</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.28.1">Microsoft-Windows-Terminal Services-Gateway</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.29.1">106</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.30.1">A user registered a </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">scheduled task.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.32.1">Execution, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.33.1">Windows </span><span class="No-Break"><span class="koboSpan" id="kobo.34.1">task scheduler</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.35.1">107</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.36.1">Task scheduler launched a task due to a </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">time trigger.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.38.1">Execution, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.39.1">Windows </span><span class="No-Break"><span class="koboSpan" id="kobo.40.1">task scheduler</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.41.1">131</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.42.1">The RDP server accepted a new </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">TCP connection.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.44.1">Event correlation, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">movement, scoping</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.46.1">Remote desktop </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">services RdpCoreTs</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.48.1">140</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.49.1">A user updated a </span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">scheduled task.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.51.1">Execution, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.52.1">Windows </span><span class="No-Break"><span class="koboSpan" id="kobo.53.1">task scheduler</span></span></p>
</td>
</tr>
</tbody>
</table>
<table class="No-Table-Style" id="table002">
<colgroup>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.54.1">141</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.55.1">A user deleted a </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">scheduled task.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.57.1">Execution, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.58.1">Windows </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">task scheduler</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.60.1">200</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.61.1">Task scheduler launched the action in the instance of </span><span class="No-Break"><span class="koboSpan" id="kobo.62.1">the task.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.63.1">Execution, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.64.1">Windows </span><span class="No-Break"><span class="koboSpan" id="kobo.65.1">task scheduler</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.66.1">201</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.67.1">Task scheduler successfully completed </span><span class="No-Break"><span class="koboSpan" id="kobo.68.1">a task.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.69.1">Execution, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.70.1">Windows </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">task scheduler</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.72.1">800</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.73.1">Pipeline </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">execution details.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.75.1">Event correlation, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">movement, execution</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.77.1">PowerShell</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.78.1">4103</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.79.1">Executing pipeline.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.80.1">Event correlation, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">movement, execution</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.82.1">PowerShell</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.83.1">1024</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.84.1">RDP</span></span></p>
<p><span class="koboSpan" id="kobo.85.1">ClientActiveX is trying to connect to </span><span class="No-Break"><span class="koboSpan" id="kobo.86.1">a server.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.87.1">Event correlation, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">movement, scoping</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.89.1">Microsoft-Windows-Terminal Services-RDPClient/Operational</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.90.1">4624</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.91.1">An account was successfully </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">logged on.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.93.1">Event correlation (event to user), scoping, user </span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">location identification</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.95.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.96.1">4625</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.97.1">An account failed to </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">log on.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.99.1">Event correlation (event to user), scoping, user </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">location identification</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.101.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.102.1">4634</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.103.1">An account was </span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">logged off.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.105.1">Event correlation (event to user), scoping, user </span><span class="No-Break"><span class="koboSpan" id="kobo.106.1">location identification</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.107.1">Security</span></span></p>
</td>
</tr>
</tbody>
</table>
<table class="No-Table-Style" id="table003">
<colgroup>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.108.1">4647</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.109.1">User initiated </span><span class="No-Break"><span class="koboSpan" id="kobo.110.1">log off.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.111.1">Event correlation (event to user), scoping, user </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">location identification</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.113.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.114.1">4648</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.115.1">A login was attempted using </span><span class="No-Break"><span class="koboSpan" id="kobo.116.1">explicit credentials.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.117.1">Event correlation, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.118.1">movement, scoping</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.119.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.120.1">4672</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.121.1">Special privileges assigned to </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">new login.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.123.1">Escalation </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">of privilege</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.125.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.126.1">4698</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.127.1">A scheduled task </span><span class="No-Break"><span class="koboSpan" id="kobo.128.1">was created.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.129.1">Persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.130.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.131.1">4727</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.132.1">A security- enabled global group </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">was created.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.134.1">Escalation of privilege, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">movement, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.136.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.137.1">4728</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.138.1">A member was added to a security-enabled </span><span class="No-Break"><span class="koboSpan" id="kobo.139.1">global group.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.140.1">Escalation of privilege, </span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">lateral movement</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.142.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.143.1">4737</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.144.1">A security- enabled global group </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">was changed.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.146.1">Escalation of privilege, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.147.1">movement, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.148.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.149.1">4706</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.150.1">A new domain trust </span><span class="No-Break"><span class="koboSpan" id="kobo.151.1">was created.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.152.1">Validation </span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">of controls</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.154.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.155.1">4720</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.156.1">A user account </span><span class="No-Break"><span class="koboSpan" id="kobo.157.1">was created.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.158.1">Escalation of privilege, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.159.1">movement, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.160.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.161.1">4729</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.162.1">A member was removed from a security-enabled </span><span class="No-Break"><span class="koboSpan" id="kobo.163.1">global group.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.164.1">Validation </span><span class="No-Break"><span class="koboSpan" id="kobo.165.1">of controls</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.166.1">Security</span></span></p>
</td>
</tr>
</tbody>
</table>
<table class="No-Table-Style" id="table004">
<colgroup>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.167.1">4754</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.168.1">A security- enabled universal group </span><span class="No-Break"><span class="koboSpan" id="kobo.169.1">was created.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.170.1">Escalation of privilege, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">movement, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.172.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.173.1">4755</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.174.1">A security- enabled universal group </span><span class="No-Break"><span class="koboSpan" id="kobo.175.1">was changed.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.176.1">Escalation of privilege, lateral </span><span class="No-Break"><span class="koboSpan" id="kobo.177.1">movement, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.178.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.179.1">4776</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.180.1">A user account </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">was unlocked.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.182.1">Escalation of </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">privilege, persistence</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.184.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.185.1">5140</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.186.1">A network share object </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">was accessed.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.188.1">Lateral movement</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.189.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.190.1">5145</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.191.1">A network share object was checked to see whether client can be granted </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">desired access.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.193.1">Lateral movement</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.194.1">Security</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.195.1">7045</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.196.1">A new service was installed by </span><span class="No-Break"><span class="koboSpan" id="kobo.197.1">a user.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.198.1">Execution, </span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">lateral movement</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.200.1">Security</span></span></p>
</td>
</tr>
</tbody>
</table>
<p><a id="_idTextAnchor341"/><a id="_idTextAnchor342"/></p>
</div>


<div id="_idContainer402">
<h1 id="_idParaDest-330"><a id="_idTextAnchor343"/><span class="koboSpan" id="kobo.1.1">Assessments</span></h1>
<h1 id="_idParaDest-331"><em class="italic"><a id="_idTextAnchor344"/></em><a href="B18571_01.xhtml#_idTextAnchor013"><em class="italic"><span class="koboSpan" id="kobo.2.1">Chapter 1</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.3.1">A</span></li>
<li><span class="koboSpan" id="kobo.4.1">C</span></li>
<li><span class="koboSpan" id="kobo.5.1">B</span></li>
<li><span class="koboSpan" id="kobo.6.1">A</span></li>
</ol>
<h1 id="_idParaDest-332"><em class="italic"><a id="_idTextAnchor345"/></em><a href="B18571_02.xhtml#_idTextAnchor028"><em class="italic"><span class="koboSpan" id="kobo.7.1">Chapter 2</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.8.1">A</span></li>
<li><span class="koboSpan" id="kobo.9.1">D</span></li>
<li><span class="koboSpan" id="kobo.10.1">B</span></li>
</ol>
<h1 id="_idParaDest-333"><a href="B18571_03.xhtml#_idTextAnchor046"><em class="italic"><span class="koboSpan" id="kobo.11.1">Chapter 3</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.12.1">B</span></li>
<li><span class="koboSpan" id="kobo.13.1">A</span></li>
<li><span class="koboSpan" id="kobo.14.1">D</span></li>
<li><span class="koboSpan" id="kobo.15.1">B</span></li>
</ol>
<h1 id="_idParaDest-334"><em class="italic"><a id="_idTextAnchor346"/></em><a href="B18571_04.xhtml#_idTextAnchor061"><em class="italic"><span class="koboSpan" id="kobo.16.1">Chapter 4</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.17.1">D</span></li>
<li><span class="koboSpan" id="kobo.18.1">A</span></li>
<li><span class="koboSpan" id="kobo.19.1">D</span></li>
<li><span class="koboSpan" id="kobo.20.1">B</span></li>
</ol>
<h1 id="_idParaDest-335"><em class="italic"><a id="_idTextAnchor347"/></em><a href="B18571_05.xhtml#_idTextAnchor084"><em class="italic"><span class="koboSpan" id="kobo.21.1">Chapter 5</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.22.1">C</span></li>
<li><span class="koboSpan" id="kobo.23.1">A</span></li>
<li><span class="koboSpan" id="kobo.24.1">C</span></li>
<li><span class="koboSpan" id="kobo.25.1">A</span></li>
</ol>
<h1 id="_idParaDest-336"><em class="italic"><a id="_idTextAnchor348"/></em><a href="B18571_06.xhtml#_idTextAnchor105"><em class="italic"><span class="koboSpan" id="kobo.26.1">Chapter 6</span></em></a></h1>
<ol>
<li value="1"><span class="No-Break"><span class="koboSpan" id="kobo.27.1">A, C</span></span></li>
<li><span class="koboSpan" id="kobo.28.1">A</span></li>
<li><span class="koboSpan" id="kobo.29.1">A</span></li>
<li><span class="koboSpan" id="kobo.30.1">D</span></li>
</ol>
<h1 id="_idParaDest-337"><em class="italic"><a id="_idTextAnchor349"/></em><a href="B18571_07.xhtml#_idTextAnchor123"><em class="italic"><span class="koboSpan" id="kobo.31.1">Chapter 7</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.32.1">A</span></li>
<li><span class="koboSpan" id="kobo.33.1">B</span></li>
<li><span class="koboSpan" id="kobo.34.1">D</span></li>
<li><span class="koboSpan" id="kobo.35.1">B</span></li>
</ol>
<h1 id="_idParaDest-338"><em class="italic"><a id="_idTextAnchor350"/></em><a href="B18571_08.xhtml#_idTextAnchor136"><em class="italic"><span class="koboSpan" id="kobo.36.1">Chapter 8</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.37.1">D</span></li>
<li><span class="koboSpan" id="kobo.38.1">C</span></li>
<li><span class="koboSpan" id="kobo.39.1">B</span></li>
<li><span class="koboSpan" id="kobo.40.1">A</span></li>
</ol>
<h1 id="_idParaDest-339"><em class="italic"><a id="_idTextAnchor351"/></em><a href="B18571_09.xhtml#_idTextAnchor156"><em class="italic"><span class="koboSpan" id="kobo.41.1">Chapter 9</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.42.1">D</span></li>
<li><span class="koboSpan" id="kobo.43.1">C</span></li>
<li><span class="koboSpan" id="kobo.44.1">A</span></li>
<li><span class="koboSpan" id="kobo.45.1">C</span></li>
</ol>
<h1 id="_idParaDest-340"><em class="italic"><a id="_idTextAnchor352"/></em><a href="B18571_10.xhtml#_idTextAnchor173"><em class="italic"><span class="koboSpan" id="kobo.46.1">Chapter 10</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.47.1">A</span></li>
<li><span class="koboSpan" id="kobo.48.1">B</span></li>
<li><span class="koboSpan" id="kobo.49.1">C</span></li>
<li><span class="koboSpan" id="kobo.50.1">A</span></li>
</ol>
<h1 id="_idParaDest-341"><em class="italic"><a id="_idTextAnchor353"/></em><a href="B18571_11.xhtml#_idTextAnchor188"><em class="italic"><span class="koboSpan" id="kobo.51.1">Chapter 11</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.52.1">A</span></li>
<li><span class="koboSpan" id="kobo.53.1">D</span></li>
<li><span class="koboSpan" id="kobo.54.1">B</span></li>
<li><span class="koboSpan" id="kobo.55.1">C</span></li>
</ol>
<h1 id="_idParaDest-342"><em class="italic"><a id="_idTextAnchor354"/></em><a href="B18571_12.xhtml#_idTextAnchor204"><em class="italic"><span class="koboSpan" id="kobo.56.1">Chapter 12</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.57.1">D</span></li>
<li><span class="koboSpan" id="kobo.58.1">A</span></li>
<li><span class="koboSpan" id="kobo.59.1">B</span></li>
<li><span class="koboSpan" id="kobo.60.1">B</span></li>
</ol>
<h1 id="_idParaDest-343"><a href="B18571_13.xhtml#_idTextAnchor220"><em class="italic"><span class="koboSpan" id="kobo.61.1">Chapter 13</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.62.1">A</span></li>
<li><span class="koboSpan" id="kobo.63.1">B</span></li>
<li><span class="koboSpan" id="kobo.64.1">A</span></li>
<li><span class="koboSpan" id="kobo.65.1">C</span></li>
</ol>
<h1 id="_idParaDest-344"><em class="italic"><a id="_idTextAnchor355"/></em><a href="B18571_14.xhtml#_idTextAnchor239"><em class="italic"><span class="koboSpan" id="kobo.66.1">Chapter 14</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.67.1">D</span></li>
<li><span class="koboSpan" id="kobo.68.1">C</span></li>
<li><span class="koboSpan" id="kobo.69.1">A</span></li>
<li><span class="koboSpan" id="kobo.70.1">B</span></li>
</ol>
<h1 id="_idParaDest-345"><em class="italic"><a id="_idTextAnchor356"/></em><a href="B18571_15.xhtml#_idTextAnchor266"><em class="italic"><span class="koboSpan" id="kobo.71.1">Chapter 15</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.72.1">C</span></li>
<li><span class="koboSpan" id="kobo.73.1">A</span></li>
<li><span class="koboSpan" id="kobo.74.1">A</span></li>
<li><span class="koboSpan" id="kobo.75.1">D</span></li>
</ol>
<h1 id="_idParaDest-346"><em class="italic"><a id="_idTextAnchor357"/></em><a href="B18571_16.xhtml#_idTextAnchor284"><em class="italic"><span class="koboSpan" id="kobo.76.1">Chapter 16</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.77.1">D</span></li>
<li><span class="koboSpan" id="kobo.78.1">A</span></li>
<li><span class="koboSpan" id="kobo.79.1">A</span></li>
<li><span class="koboSpan" id="kobo.80.1">B</span></li>
</ol>
<h1 id="_idParaDest-347"><em class="italic"><a id="_idTextAnchor358"/></em><a href="B18571_17.xhtml#_idTextAnchor304"><em class="italic"><span class="koboSpan" id="kobo.81.1">Chapter 17</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.82.1">A</span></li>
<li><span class="koboSpan" id="kobo.83.1">B</span></li>
<li><span class="koboSpan" id="kobo.84.1">A</span></li>
<li><span class="koboSpan" id="kobo.85.1">C</span></li>
</ol>
<h1 id="_idParaDest-348"><em class="italic"><a id="_idTextAnchor359"/></em><a href="B18571_18.xhtml#_idTextAnchor323"><em class="italic"><span class="koboSpan" id="kobo.86.1">Chapter 18</span></em></a></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.87.1">D</span></li>
<li><span class="koboSpan" id="kobo.88.1">C</span></li>
<li><span class="koboSpan" id="kobo.89.1">A</span></li>
<li><span class="koboSpan" id="kobo.90.1">A</span></li>
</ol>
</div>
</body></html>