<html><head></head><body>
<div id="_idContainer087">
<h1 class="chapter-number" id="_idParaDest-103"><a id="_idTextAnchor105"/><span class="koboSpan" id="kobo.1.1">6</span></h1>
<h1 id="_idParaDest-104"><a id="_idTextAnchor106"/><span class="koboSpan" id="kobo.2.1">Acquiring Host-Based Evidence</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Host systems are the targets of malicious actions far too often. </span><span class="koboSpan" id="kobo.3.2">Host systems represent a possible initial target so that someone can gain a foothold in the network or a pivot point for additional attacks, or the end goal of threat actors. </span><span class="koboSpan" id="kobo.3.3">As a result, incident response analysts should be prepared to investigate these systems. </span><span class="koboSpan" id="kobo.3.4">Modern operating systems such </span><a id="_idIndexMarker521"/><span class="koboSpan" id="kobo.4.1">as Microsoft Windows create a variety of evidentiary artifacts during the execution of an application, when changes to files are made, or when user accounts are added. </span><span class="koboSpan" id="kobo.4.2">All these changes leave traces of activity that can be evaluated by incident response analysts. </span><span class="koboSpan" id="kobo.4.3">The amount of data that’s available to incident response analysts is increasing as storage and memory in even the lowest-cost consumer systems continue to expand. </span><span class="koboSpan" id="kobo.4.4">Commonly available systems are routinely manufactured with extensive memory and storage in terabytes; there is a great deal of data that could assist incident responders in determining a root cause. </span><span class="koboSpan" id="kobo.4.5">As a result, incident response analysts should be prepared to acquire different types of evidence from systems for </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">further analysis.</span></span></p>
<p><span class="koboSpan" id="kobo.6.1">We will cover the following topics in this chapter: </span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.7.1">Preparation</span></span></li>
<li><span class="koboSpan" id="kobo.8.1">Order of volatility </span></li>
<li><span class="koboSpan" id="kobo.9.1">Evidence acquisition </span></li>
<li><span class="koboSpan" id="kobo.10.1">Acquiring </span><span class="No-Break"><span class="koboSpan" id="kobo.11.1">volatile memory</span></span></li>
<li><span class="koboSpan" id="kobo.12.1">Acquiring </span><span class="No-Break"><span class="koboSpan" id="kobo.13.1">non-volatile evidence</span></span></li>
</ul>
<h1 id="_idParaDest-105"><a id="_idTextAnchor107"/><span class="koboSpan" id="kobo.14.1">Preparation</span></h1>
<p><span class="koboSpan" id="kobo.15.1">In terms</span><a id="_idIndexMarker522"/><span class="koboSpan" id="kobo.16.1"> of preparation, incident response analysts should have the necessary tools at their disposal to acquire host-based evidence. </span><span class="koboSpan" id="kobo.16.2">The techniques that will be discussed within this chapter do not rely on any highly-specialized technology, but rather on tools that can be acquired for little or no cost. </span><span class="koboSpan" id="kobo.16.3">It is critical that the tools that are selected for the acquisition of evidence are those that are provided by reputable sources, have been proven effective by other CSIRT personnel, and have been validated for efficacy prior to use. </span><span class="koboSpan" id="kobo.16.4">Outside of software, the only additional hardware that is required is external hard drives and common </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">desktop computers.</span></span></p>
<p><span class="koboSpan" id="kobo.18.1">When </span><a id="_idIndexMarker523"/><span class="koboSpan" id="kobo.19.1">supporting an enterprise environment, it is a good idea for incident response personnel to have a solid understanding of the types of systems that are commonly deployed. </span><span class="koboSpan" id="kobo.19.2">For example, in an enterprise that utilizes strictly Microsoft operating systems, the tools that are available should have the ability to support a wide range of versions of the Microsoft OS. </span><span class="koboSpan" id="kobo.19.3">In other circumstances, incident response personnel may support an enterprise where there is an 80/20 split between Microsoft and Linux systems; incident response personnel should be prepared with tools and techniques that support the acquisition </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">of evidence.</span></span></p>
<p><span class="koboSpan" id="kobo.21.1">Many of the tools and techniques that will be discussed in this chapter require administrator privileges. </span><span class="koboSpan" id="kobo.21.2">Incident responders should be provided with the necessary credentials to perform these tasks. </span><span class="koboSpan" id="kobo.21.3">It should be noted that analysts should only use existing accounts and that adding accounts to a possibly compromised system may make evidence inadmissible in a judicial proceeding. </span><span class="koboSpan" id="kobo.21.4">One technique is for incident response analysts to be given individual credentials that are enabled only during an incident. </span><span class="koboSpan" id="kobo.21.5">This allows the organization to separate the legitimate use of credentials from possible malicious ones. </span><span class="koboSpan" id="kobo.21.6">This also allows the incident response team to recreate their actions. </span><span class="koboSpan" id="kobo.21.7">It is worth noting that highly technical adversaries will often monitor the network they are attacking during an active compromise to determine whether they are being detected. </span><span class="koboSpan" id="kobo.21.8">Therefore, these credentials should not indicate that they are tied to the incident response analysts or other personnel investigating a </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">possible breach.</span></span></p>
<h1 id="_idParaDest-106"><a id="_idTextAnchor108"/><span class="koboSpan" id="kobo.23.1">Order of volatility</span></h1>
<p><span class="koboSpan" id="kobo.24.1">Not all </span><a id="_idIndexMarker524"/><span class="koboSpan" id="kobo.25.1">evidence on a host system is the same. </span><span class="koboSpan" id="kobo.25.2">Volatility is used to describe how data on a host system is maintained after changes such as logoffs or power shutdowns. </span><span class="koboSpan" id="kobo.25.3">Data that will be lost if the system is powered down is referred to as </span><strong class="bold"><span class="koboSpan" id="kobo.26.1">volatile data</span></strong><span class="koboSpan" id="kobo.27.1">. </span><span class="koboSpan" id="kobo.27.2">Volatile data</span><a id="_idIndexMarker525"/><span class="koboSpan" id="kobo.28.1"> can be data in the CPU, routing table, or ARP cache. </span><span class="koboSpan" id="kobo.28.2">One of the most critical pieces of volatile evidence is the memory currently running on the system. </span><span class="koboSpan" id="kobo.28.3">When investigating incidents such as malware infections, the memory in a live system is of critical importance. </span><span class="koboSpan" id="kobo.28.4">Malware leaves a number of key pieces of evidence within the memory of a system and, if lost, can leave the incident response analyst with little or no room to investigate. </span><span class="koboSpan" id="kobo.28.5">This can include such artifacts as registry data, command history, and </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">network connections.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.30.1">Non-volatile data</span></strong><span class="koboSpan" id="kobo.31.1"> is the</span><a id="_idIndexMarker526"/><span class="koboSpan" id="kobo.32.1"> data that is stored on a hard drive and will usually persist </span><a id="_idIndexMarker527"/><span class="koboSpan" id="kobo.33.1">after shutting down. </span><span class="koboSpan" id="kobo.33.2">Non-volatile data includes </span><strong class="bold"><span class="koboSpan" id="kobo.34.1">Master File Table</span></strong><span class="koboSpan" id="kobo.35.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.36.1">MFT</span></strong><span class="koboSpan" id="kobo.37.1">) entries, registry information, and the actual files on the hard drive. </span><span class="koboSpan" id="kobo.37.2">While malware creates evidence </span><a id="_idIndexMarker528"/><span class="koboSpan" id="kobo.38.1">in memory, there are still items of evidentiary value in non-volatile memory. </span><span class="koboSpan" id="kobo.38.2">The following diagram shows the different levels of volatility of digital evidence that should be taken into account when determining the order </span><span class="No-Break"><span class="koboSpan" id="kobo.39.1">of acquisition:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer061">
<span class="koboSpan" id="kobo.40.1"><img alt="" src="image/Image_B18571_06_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.41.1">Figure 6.1 – Digital evidence volatility</span></p>
<p><span class="koboSpan" id="kobo.42.1">In the next section, we will learn how to </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">collect evidence.</span></span></p>
<h1 id="_idParaDest-107"><a id="_idTextAnchor109"/><span class="koboSpan" id="kobo.44.1">Evidence acquisition</span></h1>
<p><span class="koboSpan" id="kobo.45.1">There are a </span><a id="_idIndexMarker529"/><span class="koboSpan" id="kobo.46.1">variety of methods that are used to not only access a potential evidence source but also determine the type of acquisition that can be undertaken. </span><span class="koboSpan" id="kobo.46.2">To define these methods, it is important to have a clear understanding of the manner and type of acquisition that can </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">be utilized:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.48.1">Local</span></strong><span class="koboSpan" id="kobo.49.1">: Having </span><a id="_idIndexMarker530"/><span class="koboSpan" id="kobo.50.1">access to the system under investigation is often a luxury for most enterprises. </span><span class="koboSpan" id="kobo.50.2">Even so, there are many times when incident response analysts or other personnel have direct physical access to the system. </span><span class="koboSpan" id="kobo.50.3">A local acquisition can often be performed via a USB or other device and, in some circumstances, using the </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">system itself.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.52.1">Remote</span></strong><span class="koboSpan" id="kobo.53.1">: In a </span><a id="_idIndexMarker531"/><span class="koboSpan" id="kobo.54.1">remote acquisition, incident response analysts leverage tools and network connections to acquire evidence. </span><span class="koboSpan" id="kobo.54.2">A remote acquisition is an obvious choice if incident response analysts are dealing with geographical challenges. </span><span class="koboSpan" id="kobo.54.3">This can also be useful if incident response analysts cannot be on-site immediately. </span><span class="koboSpan" id="kobo.54.4">(The next chapter will focus on remote </span><span class="No-Break"><span class="koboSpan" id="kobo.55.1">evidence acquisition.)</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.56.1">Live acquisition</span></strong><span class="koboSpan" id="kobo.57.1">: A</span><a id="_idIndexMarker532"/><span class="koboSpan" id="kobo.58.1"> live acquisition of evidence occurs when the incident response analyst acquires the evidence from a system that is currently powered on and running. </span><span class="koboSpan" id="kobo.58.2">Some of the techniques that will be demonstrated in this chapter have to be deployed on a live system (for example, capturing running memory). </span><span class="koboSpan" id="kobo.58.3">Completely acquiring digital evidence from a live system may be a technique that’s necessary for high-availability environments where a suspected system cannot be taken offline. </span><span class="koboSpan" id="kobo.58.4">These techniques allow incident response analysts to acquire and analyze evidence to determine whether a system is </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">indeed compromised.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.60.1">Offline acquisition</span></strong><span class="koboSpan" id="kobo.61.1">: The </span><a id="_idIndexMarker533"/><span class="koboSpan" id="kobo.62.1">offline acquisition method is the one that’s often used by law enforcement agencies to preserve digital evidence on the hard drive. </span><span class="koboSpan" id="kobo.62.2">This technique requires that the system be powered down and the hard drive removed. </span><span class="koboSpan" id="kobo.62.3">Once the drive is accessed, specialized tools are utilized to acquire the hard drive evidence. </span><span class="koboSpan" id="kobo.62.4">There are some drawbacks to focusing strictly on offline acquisition. </span><span class="koboSpan" id="kobo.62.5">First is the loss of any volatile memory. </span><span class="koboSpan" id="kobo.62.6">Second, it may be time-consuming</span><a id="_idIndexMarker534"/><span class="koboSpan" id="kobo.63.1"> to acquire a suspect system’s hard drive, image it, and process the image for investigation. </span><span class="koboSpan" id="kobo.63.2">This may create a situation where incident responders do not have any idea of what has transpired for more than </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">24 hours.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.65.1">Depending </span><a id="_idIndexMarker535"/><span class="koboSpan" id="kobo.66.1">on the type of incident and any constraints in time or geography, incident response analysts should be prepared to perform any of these types of acquisitions. </span><span class="koboSpan" id="kobo.66.2">The best-case scenario is for a CSIRT to have the ability to perform both live and offline acquisition on any suspect system. </span><span class="koboSpan" id="kobo.66.3">This provides the greatest amount of evidence that can be analyzed. </span><span class="koboSpan" id="kobo.66.4">In terms of preparation, analysts should have the necessary tools and experience to conduct evidence acquisition through any of </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">these methods.</span></span></p>
<p><span class="koboSpan" id="kobo.68.1">To perform local acquisition, incident response analysts require an external hard drive or USB drive with sufficient space for the capture of at least the running memory of the system or systems that are being investigated, along with other files if deemed necessary. </span><span class="koboSpan" id="kobo.68.2">In order to ensure the integrity of the evidence being collected, it is advisable to configure the USB drive into two partitions. </span><span class="koboSpan" id="kobo.68.3">The first partition should contain the necessary tools to perform the evidence acquisition, while the second should act as a repository for the evidence. </span><span class="koboSpan" id="kobo.68.4">This also allows the incident response analyst to move evidence to a more permanent form of storage and subsequently, wipe the evidence partition without having to reinstall all </span><span class="No-Break"><span class="koboSpan" id="kobo.69.1">the tools.</span></span></p>
<h2 id="_idParaDest-108"><a id="_idTextAnchor110"/><span class="koboSpan" id="kobo.70.1">Evidence collection procedures</span></h2>
<p><span class="koboSpan" id="kobo.71.1">There </span><a id="_idIndexMarker536"/><span class="koboSpan" id="kobo.72.1">are a number of parallels between </span><a id="_idIndexMarker537"/><span class="koboSpan" id="kobo.73.1">digital forensics and other forensic disciplines such as trace evidence. </span><span class="koboSpan" id="kobo.73.2">The key parallel is that organizations acquiring evidence need to have a procedure that is sound, reproducible, and well documented. </span><span class="koboSpan" id="kobo.73.3">The following are some guidelines for the proper collection of </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">digital evidence:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.75.1">Photograph the system and the general scene</span></strong><span class="koboSpan" id="kobo.76.1">: One of the key pieces of equipment that can save time is a small digital camera. </span><span class="koboSpan" id="kobo.76.2">While it may seem overkill to photograph a system in place, in the event that actions that have been taken by incident responders see the inside of a courtroom, having photos will allow for proper reconstruction of the events. </span><span class="koboSpan" id="kobo.76.3">One word of caution, though, is to make sure that you utilize a separate digital camera. </span><span class="koboSpan" id="kobo.76.4">Utilizing a cell phone may expose the device to discovery in the event of a lawsuit or criminal proceeding. </span><span class="koboSpan" id="kobo.76.5">The best method is to snap all of the photos necessary at a convenient time and place and transfer them to </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">permanent storage.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.78.1">Determine whether the system is powered up</span></strong><span class="koboSpan" id="kobo.79.1">: If the system is powered on, leave</span><a id="_idIndexMarker538"/><span class="koboSpan" id="kobo.80.1"> it on. </span><span class="koboSpan" id="kobo.80.2">If the system is powered off, do not power it on. </span><span class="koboSpan" id="kobo.80.3">Several changes take place when turning a system on or off. </span><span class="koboSpan" id="kobo.80.4">If the system is powered on, the volatile memory will be available for capture. </span><span class="koboSpan" id="kobo.80.5">In addition, in the case of full disk encryption, leaving the system on will allow the responder to still acquire the logical disk volumes. </span><span class="koboSpan" id="kobo.80.6">If the system is turned off, preserving this state ensures that any evidence in the non-volatile memory is preserved. </span><span class="koboSpan" id="kobo.80.7">If incident response personnel feel that the system may be a danger to other systems, simply remove the network connection to </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">isolate it.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.82.1">Acquire the running memory</span></strong><span class="koboSpan" id="kobo.83.1">: This is a critical piece of evidence that can produce a wealth of data concerning running processes, DLLs in use, and network connections. </span><span class="koboSpan" id="kobo.83.2">Due to this, procedures for acquiring memory will be covered extensively in </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">this chapter.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.85.1">Acquire registry and log files</span></strong><span class="koboSpan" id="kobo.86.1">: While these files are non-volatile in nature, having </span><a id="_idIndexMarker539"/><span class="koboSpan" id="kobo.87.1">near-immediate access is beneficial, especially when investigating malware or other </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">exploitation means.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.89.1">Unplug the power from the back of the system</span></strong><span class="koboSpan" id="kobo.90.1">: If the system is a laptop, remove the battery as well. </span><span class="koboSpan" id="kobo.90.2">This preserves the state of </span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">the system.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.92.1">Photograph the back or bottom of the system to capture the model and serial number</span></strong><span class="koboSpan" id="kobo.93.1">: This procedure allows the incident response analyst to capture any information that’s necessary for the chain </span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">of custody.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.95.1">Remove the cover to the system and photograph the hard drive to capture the model and serial number</span></strong><span class="koboSpan" id="kobo.96.1">: Again, this aids in the reconstruction of the chain </span><span class="No-Break"><span class="koboSpan" id="kobo.97.1">of custody.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.98.1">Remove the hard drive from the system and package it in an anti-static bag</span></strong><span class="koboSpan" id="kobo.99.1">: Secure the drive in a sealable envelope or box. </span><span class="koboSpan" id="kobo.99.2">Anti-static bags will protect the</span><a id="_idIndexMarker540"/><span class="koboSpan" id="kobo.100.1"> hard drive, and the packaging should ensure that any attempt to open it will be evident. </span><span class="koboSpan" id="kobo.100.2">This can be facilitated through purpose-designed evidence bags or simple mailing envelopes that can be sealed with tape. </span><span class="koboSpan" id="kobo.100.3">The seizing analyst</span><a id="_idIndexMarker541"/><span class="koboSpan" id="kobo.101.1"> should sign any seals. </span><span class="koboSpan" id="kobo.101.2">Furthermore, indicate the incident number, evidence number, date, time, and seizing analyst somewhere on the exterior of </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">the packaging.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.103.1">Document all actions</span></strong><span class="koboSpan" id="kobo.104.1">: Ensure that dates and times are recorded, as well as which incident response analyst performed the action. </span><span class="koboSpan" id="kobo.104.2">Incident reporting is often the last stage of any response. </span><span class="koboSpan" id="kobo.104.3">As a result, hours or even days can pass before analysts are able to record their actions. </span><span class="koboSpan" id="kobo.104.4">Due to this, pictures and notes that are taken during the initial seizure are invaluable when it comes to reconstructing the sequence </span><span class="No-Break"><span class="koboSpan" id="kobo.105.1">of events.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.106.1">In the next section, we will look at acquiring </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">volatile memory.</span></span></p>
<h1 id="_idParaDest-109"><a id="_idTextAnchor111"/><span class="koboSpan" id="kobo.108.1">Acquiring volatile memory</span></h1>
<p><span class="koboSpan" id="kobo.109.1">Traditional </span><a id="_idIndexMarker542"/><span class="koboSpan" id="kobo.110.1">digital forensics, or what is</span><a id="_idIndexMarker543"/><span class="koboSpan" id="kobo.111.1"> often referred to now as dead box forensics, focuses on the hard disk drive that’s been taken from a shut-down system acting as the primary source of evidence. </span><span class="koboSpan" id="kobo.111.2">This approach works well when addressing criminal activity such as fraud or child exploitation, where image files, word processor documents, and spreadsheets can be discovered in a forensically sound manner. </span><span class="koboSpan" id="kobo.111.3">The issue with this approach is that to properly acquire this evidence, the system has to be powered off, thereby destroying any potential evidence that could be found within the </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">volatile memory.</span></span></p>
<p><span class="koboSpan" id="kobo.113.1">As opposed to traditional criminal activity, incident responders will find that a great deal of evidence for a security incident is contained within the memory of a potentially compromised system. </span><span class="koboSpan" id="kobo.113.2">This is especially true when examining systems that have been infected with malware or exploited by utilizing a common platform such </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">as Metasploit.</span></span></p>
<p><span class="koboSpan" id="kobo.115.1">Key pieces </span><a id="_idIndexMarker544"/><span class="koboSpan" id="kobo.116.1">of trace evidence are often found within the running memory of the compromised system. </span><span class="koboSpan" id="kobo.116.2">As a result, before powering down the system and removing the hard drive, it is critical that the running memory is acquired for processing. </span><span class="koboSpan" id="kobo.116.3">There are several free and commercial tools that can be leveraged by incident response analysts to acquire running memory. </span><span class="koboSpan" id="kobo.116.4">Which tool is used will often be dependent on the techniques and tools used during the analysis phase, which is covered in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.117.1">Chapter 10</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.118.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.119.1">Running memory </span><a id="_idIndexMarker545"/><span class="koboSpan" id="kobo.120.1">can be acquired in two ways. </span><span class="koboSpan" id="kobo.120.2">First, memory can be acquired locally via a USB device or other writable medium that is directly connected to the suspect system. </span><span class="koboSpan" id="kobo.120.3">The other method of acquiring memory is through a remote connection. </span><span class="koboSpan" id="kobo.120.4">This can be facilitated through the use of specialized software that performs the acquisition over a network connection (remote acquisition techniques will be covered in the </span><span class="No-Break"><span class="koboSpan" id="kobo.121.1">next chapter).</span></span></p>
<p><span class="koboSpan" id="kobo.122.1">If an incident response analyst has physical access to a potentially compromised system, they have the option of acquiring the memory and other evidence locally. </span><span class="koboSpan" id="kobo.122.2">This involves the use of tools that are run from a USB device or a similar removable medium that is connected to the potentially compromised system. </span><span class="koboSpan" id="kobo.122.3">From there, the tools are run, and the evidence is collected. </span><span class="koboSpan" id="kobo.122.4">A local acquisition is often conducted in conjunction with seizing the hard drive and other evidence from the system. </span><span class="koboSpan" id="kobo.122.5">There are several tools that are available for </span><a id="_idIndexMarker546"/><span class="koboSpan" id="kobo.123.1">local acquisition. </span><span class="koboSpan" id="kobo.123.2">For</span><a id="_idIndexMarker547"/><span class="koboSpan" id="kobo.124.1"> the purposes of this</span><a id="_idIndexMarker548"/><span class="koboSpan" id="kobo.125.1"> book, three such tools – </span><strong class="bold"><span class="koboSpan" id="kobo.126.1">Exterro’s FTK Imager</span></strong><span class="koboSpan" id="kobo.127.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.128.1">Velocidex’s WinPmem</span></strong><span class="koboSpan" id="kobo.129.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.130.1">Belkasoft’s RamCapturer</span></strong><span class="koboSpan" id="kobo.131.1"> – will </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">be examined.</span></span></p>
<p><span class="koboSpan" id="kobo.133.1">When acquiring memory in this fashion, it is advisable to utilize an external drive with sufficient capacity for multiple files. </span><span class="koboSpan" id="kobo.133.2">Incident response analysts should make use of a USB device with two partitions. </span><span class="koboSpan" id="kobo.133.3">The first of these partitions contains the tools that are necessary to perform the memory acquisition, while the second partition will contain the evidence files. </span><span class="koboSpan" id="kobo.133.4">This way, incident response analysts can be sure that the evidence does not become commingled with </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">their tools.</span></span></p>
<h2 id="_idParaDest-110"><a id="_idTextAnchor112"/><span class="koboSpan" id="kobo.135.1">FTK Imager</span></h2>
<p><span class="koboSpan" id="kobo.136.1">Exterro’s FTK Imager</span><a id="_idIndexMarker549"/><span class="koboSpan" id="kobo.137.1"> is a Windows software platform that performs a variety of</span><a id="_idIndexMarker550"/><span class="koboSpan" id="kobo.138.1"> imaging tasks, including acquiring the running memory of a system. </span><span class="koboSpan" id="kobo.138.2">The software can be </span><a id="_idIndexMarker551"/><span class="koboSpan" id="kobo.139.1">downloaded at </span><a href="https://www.exterro.com/ftk-imager"><span class="koboSpan" id="kobo.140.1">https://www.exterro.com/ftk-imager</span></a><span class="koboSpan" id="kobo.141.1">. </span><span class="koboSpan" id="kobo.141.2">Let’s take a look at </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">this platform:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.143.1">Once downloaded, install the executable in the </span><strong class="bold"><span class="koboSpan" id="kobo.144.1">Tools</span></strong><span class="koboSpan" id="kobo.145.1"> partition of the </span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">USB drive.</span></span></li>
<li><span class="koboSpan" id="kobo.147.1">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.148.1">FTK Imager</span></strong><span class="koboSpan" id="kobo.149.1"> folder and run the executable as an administrator. </span><span class="koboSpan" id="kobo.149.2">(FTK Imager requires the use of drivers and, as a result, requires administrator privileges.) The following window </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">will appear:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer062">
<span class="koboSpan" id="kobo.151.1"><img alt="" src="image/Image_B18571_06_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.152.1">Figure 6.2 – FTK Imager main window</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.153.1">Click on </span><strong class="bold"><span class="koboSpan" id="kobo.154.1">File</span></strong><span class="koboSpan" id="kobo.155.1"> and then on </span><strong class="bold"><span class="koboSpan" id="kobo.156.1">Capture Memory</span></strong><span class="koboSpan" id="kobo.157.1">. </span><span class="koboSpan" id="kobo.157.2">This opens the </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">following window:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer063">
<span class="koboSpan" id="kobo.159.1"><img alt="" src="image/Image_B1857_06_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.160.1">Figure 6.3 – FTK Imager memory capture</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.161.1">Browse </span><a id="_idIndexMarker552"/><span class="koboSpan" id="kobo.162.1">to the </span><strong class="bold"><span class="koboSpan" id="kobo.163.1">Evidence</span></strong><span class="koboSpan" id="kobo.164.1"> partition of the USB drive attached to the</span><a id="_idIndexMarker553"/><span class="koboSpan" id="kobo.165.1"> system and provide a name for the capture file. </span><span class="koboSpan" id="kobo.165.2">This name should be a unique identifier such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.166.1">Laptop1</span></strong><span class="koboSpan" id="kobo.167.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">Evidence Item 1</span></strong><span class="koboSpan" id="kobo.169.1">. </span><span class="koboSpan" id="kobo.169.2">Another option that is useful is to use the system name, such as in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.170.1">Figure 6</span></em></span><em class="italic"><span class="koboSpan" id="kobo.171.1">.3</span></em><span class="koboSpan" id="kobo.172.1">. </span><span class="koboSpan" id="kobo.172.2">Also, check the </span><strong class="bold"><span class="koboSpan" id="kobo.173.1">Include pagefile</span></strong><span class="koboSpan" id="kobo.174.1"> checkbox. </span><span class="koboSpan" id="kobo.174.2">There might not be any information of evidentiary value within the pagefile, but it may become important later during the investigation (the pagefile will be discussed later on, in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.175.1">Chapter 10</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">).</span></span></li>
<li><span class="koboSpan" id="kobo.177.1">Finally, there is the option to create an AD1 file; this is Exterro’s proprietary file format. </span><span class="koboSpan" id="kobo.177.2">This file is for the analysis of the captured image using the FTK analysis program. </span><span class="koboSpan" id="kobo.177.3">For the purposes of this book, the standard output is sufficient for the analysis that will </span><span class="No-Break"><span class="koboSpan" id="kobo.178.1">be performed.</span></span></li>
<li><span class="koboSpan" id="kobo.179.1">Once the configuration details have been set, click on </span><strong class="bold"><span class="koboSpan" id="kobo.180.1">Capture Memory</span></strong><span class="koboSpan" id="kobo.181.1"> and the following screen </span><span class="No-Break"><span class="koboSpan" id="kobo.182.1">will appear:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer064">
<span class="koboSpan" id="kobo.183.1"><img alt="" src="image/Image_B18571_06_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.184.1">Figure 6.4 – FTK Imager memory capture progress</span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.185.1">After </span><a id="_idIndexMarker554"/><span class="koboSpan" id="kobo.186.1">FTK Imager dumps the RAM, it will then extract the pagefile, as </span><a id="_idIndexMarker555"/><span class="koboSpan" id="kobo.187.1">seen in the </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">following figure:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer065">
<span class="koboSpan" id="kobo.189.1"><img alt="" src="image/Image_B18571_06_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.190.1">Figure 6.5 – FTK Imager page file extraction</span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.191.1">After running this, FTK Imager will indicate whether the memory capture was successful </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">or not:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer066">
<span class="koboSpan" id="kobo.193.1"><img alt="" src="image/Image_B18571_06_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.194.1">Figure 6.6 – FTK Imager memory capture success</span></p>
<p><span class="koboSpan" id="kobo.195.1">Examining</span><a id="_idIndexMarker556"/><span class="koboSpan" id="kobo.196.1"> the evidence partition of the evidence drive reveals the two files, as </span><a id="_idIndexMarker557"/><span class="koboSpan" id="kobo.197.1">shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer067">
<span class="koboSpan" id="kobo.199.1"><img alt="" src="image/Image_B18571_06_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.200.1">Figure 6.7 – FTK Imager output files</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.201.1">Memory file size</span></p>
<p class="callout"><span class="koboSpan" id="kobo.202.1">Depending on the system, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.203.1">.mem</span></strong><span class="koboSpan" id="kobo.204.1"> file may not exactly match the onboard RAM of the target system. </span><span class="koboSpan" id="kobo.204.2">In this case, the target system has 16 GB of physical RAM but the </span><strong class="source-inline"><span class="koboSpan" id="kobo.205.1">.mem</span></strong><span class="koboSpan" id="kobo.206.1"> file is nearly 2 GB larger. </span><span class="koboSpan" id="kobo.206.2">This can occur with operating systems that use virtual memory. </span><span class="koboSpan" id="kobo.206.3">In other circumstances, the actual RAM file may be smaller. </span><span class="koboSpan" id="kobo.206.4">This is an expected and </span><span class="No-Break"><span class="koboSpan" id="kobo.207.1">normal occurrence.</span></span></p>
<p><span class="koboSpan" id="kobo.208.1">The one disadvantage that FTK Imager has is that it requires a good deal of access to drivers and has several features. </span><span class="koboSpan" id="kobo.208.2">This makes moving the tool from system to system difficult. </span><span class="koboSpan" id="kobo.208.3">It also significantly reduces the ability to utilize FTK Imager in a script. </span></p>
<h2 id="_idParaDest-111"><a id="_idTextAnchor113"/><span class="koboSpan" id="kobo.209.1">WinPmem</span></h2>
<p><span class="koboSpan" id="kobo.210.1">On the </span><a id="_idIndexMarker558"/><span class="koboSpan" id="kobo.211.1">opposite </span><a id="_idIndexMarker559"/><span class="koboSpan" id="kobo.212.1">side of the spectrum from FTK Imager is WinPmem. </span><span class="koboSpan" id="kobo.212.2">This is a single command line executable that can be executed in the same way that FTK Imager is executed. </span><span class="koboSpan" id="kobo.212.3">The one main difference is that the tool is much easier to script, so it can be deployed across several systems at once or in conjunction with other evidence collection. </span></p>
<p><span class="koboSpan" id="kobo.213.1">WinPmem</span><a id="_idIndexMarker560"/><span class="koboSpan" id="kobo.214.1"> is a free tool that is available </span><span class="No-Break"><span class="koboSpan" id="kobo.215.1">at </span></span><a href="https://github.com/Velocidex/WinPmem"><span class="No-Break"><span class="koboSpan" id="kobo.216.1">https://github.com/Velocidex/WinPmem</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.217.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.218.1">Once downloaded, the executable can be placed anywhere the analyst needs. </span><span class="koboSpan" id="kobo.218.2">WinPmem is a command line tool so let’s examine the specific commands needed to capture the memory of the running system: </span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.219.1">To acquire the physical memory of the target system, open a Windows Command Prompt instance as an administrator. </span><span class="koboSpan" id="kobo.219.2">Typing </span><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">E:\winpmem_mini_x64_rc2.exe -help</span></strong><span class="koboSpan" id="kobo.221.1"> will produce the following </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">help menu:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer068">
<span class="koboSpan" id="kobo.223.1"><img alt="" src="image/Image_B18571_06_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.224.1">Figure 6.8 – WinPmem help menu</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.225.1">Next, configure WinPmem to acquire the memory of the system by running the </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">following command:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.227.1">E:\winpmem_mini_x64_rc2.exe Acc_LT09.raw</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.228.1">The </span><a id="_idIndexMarker561"/><span class="koboSpan" id="kobo.229.1">preceding command tells WinPmem to acquire the raw memory and output it to a file with the name </span><strong class="source-inline"><span class="koboSpan" id="kobo.230.1">Acc_LT09.raw</span></strong><span class="koboSpan" id="kobo.231.1">, which will be created on the evidence </span><a id="_idIndexMarker562"/><span class="koboSpan" id="kobo.232.1">partition of the USB drive in use. </span><span class="koboSpan" id="kobo.232.2">After entering the command, hitting the </span><em class="italic"><span class="koboSpan" id="kobo.233.1">Enter</span></em><span class="koboSpan" id="kobo.234.1"> key will produce </span><span class="No-Break"><span class="koboSpan" id="kobo.235.1">the following:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer069">
<span class="koboSpan" id="kobo.236.1"><img alt="" src="image/Image_B18571_06_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.237.1">Figure 6.9 – WinPmem output</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.238.1">WinPmem then runs through the entire memory structure. </span><span class="koboSpan" id="kobo.238.2">During this process, it will produce the </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">following output:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer070">
<span class="koboSpan" id="kobo.240.1"><img alt="" src="image/Image_B18571_06_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.241.1">Figure 6.10 – WinPmem output</span></p>
<p><span class="koboSpan" id="kobo.242.1">WinPmem</span><a id="_idIndexMarker563"/><span class="koboSpan" id="kobo.243.1"> provides</span><a id="_idIndexMarker564"/><span class="koboSpan" id="kobo.244.1"> the flexibility of a single executable that can be easily copied and deployed across multiple systems. </span><span class="koboSpan" id="kobo.244.2">The obvious drawback is the lack of a GUI. </span><span class="koboSpan" id="kobo.244.3">A good middle ground between FTK Imager and WinPmem is Belkasoft’s </span><span class="No-Break"><span class="koboSpan" id="kobo.245.1">RAM Capturer.</span></span></p>
<h2 id="_idParaDest-112"><a id="_idTextAnchor114"/><span class="koboSpan" id="kobo.246.1">RAM Capturer</span></h2>
<p><span class="koboSpan" id="kobo.247.1">RAM Capturer is</span><a id="_idIndexMarker565"/><span class="koboSpan" id="kobo.248.1"> a free tool provided by the software company Belkasoft. </span><span class="koboSpan" id="kobo.248.2">RAM Capturer</span><a id="_idIndexMarker566"/><span class="koboSpan" id="kobo.249.1"> is a simple tool to utilize and, like FTK Imager and WinPmem, it can be run from a USB. </span><span class="koboSpan" id="kobo.249.2">RAM Capturer combines the simplicity of WinPmem with an easy-to-use GUI like </span><span class="No-Break"><span class="koboSpan" id="kobo.250.1">FTK Imager:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.251.1">Right-click on the </span><strong class="bold"><span class="koboSpan" id="kobo.252.1">RAM Capturer</span></strong><span class="koboSpan" id="kobo.253.1"> executable and choose </span><strong class="bold"><span class="koboSpan" id="kobo.254.1">Run as Administrator</span></strong><span class="koboSpan" id="kobo.255.1">. </span><span class="koboSpan" id="kobo.255.2">This will produce the </span><span class="No-Break"><span class="koboSpan" id="kobo.256.1">following window:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer071">
<span class="koboSpan" id="kobo.257.1"><img alt="" src="image/Image_B18571_06_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.258.1">Figure 6.11 – RAM Capturer start window</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.259.1">The only</span><a id="_idIndexMarker567"/><span class="koboSpan" id="kobo.260.1"> input that’s required for acquisition is to place the path </span><a id="_idIndexMarker568"/><span class="koboSpan" id="kobo.261.1">of the folder where the memory image should be placed. </span><span class="koboSpan" id="kobo.261.2">Once the output has been set, click on the </span><strong class="bold"><span class="koboSpan" id="kobo.262.1">Capture!</span></strong><span class="koboSpan" id="kobo.263.1"> button and let </span><span class="No-Break"><span class="koboSpan" id="kobo.264.1">it run:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer072">
<span class="koboSpan" id="kobo.265.1"><img alt="" src="image/Image_B18571_06_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.266.1">Figure 6.12 – RAM Capturer progress</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.267.1">Once </span><a id="_idIndexMarker569"/><span class="koboSpan" id="kobo.268.1">RAM Capturer completes, the following message </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">will </span></span><span class="No-Break"><a id="_idIndexMarker570"/></span><span class="No-Break"><span class="koboSpan" id="kobo.270.1">appear:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer073">
<span class="koboSpan" id="kobo.271.1"><img alt="" src="image/Image_B18571_06_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.272.1">Figure 6.13 – RAM Capturer completion</span></p>
<p><span class="koboSpan" id="kobo.273.1">When looking at memory acquisition tools, the best approach is to capture as much data as possible as efficiently as possible. </span><span class="koboSpan" id="kobo.273.2">Tools such as FTK Imager are highly reliable and allow for </span><a id="_idIndexMarker571"/><span class="koboSpan" id="kobo.274.1">acquiring not just memory but also other key pieces of evidence. </span><span class="koboSpan" id="kobo.274.2">However, at times, this </span><a id="_idIndexMarker572"/><span class="koboSpan" id="kobo.275.1">may not be possible, and responders will have to use a USB key with a lightweight tool such as RAM Capturer. </span><span class="koboSpan" id="kobo.275.2">The best option is to determine the type of forensic tools that will be used to examine the evidence and then select the appropriate tool to </span><span class="No-Break"><span class="koboSpan" id="kobo.276.1">acquire memory.</span></span></p>
<p><span class="koboSpan" id="kobo.277.1">When looking at acquiring memory, another key factor with these tools that make them useful is that they can also be leveraged if responders do not have physical access to the </span><span class="No-Break"><span class="koboSpan" id="kobo.278.1">suspect system.</span></span></p>
<h2 id="_idParaDest-113"><a id="_idTextAnchor115"/><span class="koboSpan" id="kobo.279.1">Virtual systems</span></h2>
<p><span class="koboSpan" id="kobo.280.1">Other </span><a id="_idIndexMarker573"/><span class="koboSpan" id="kobo.281.1">systems that incident response analysts should prepare to address are virtual machines. </span><span class="koboSpan" id="kobo.281.2">The one distinct advantage that virtual systems have over physical systems is their ability to maintain the current state by either performing a snapshot of the system or simply pausing. </span><span class="koboSpan" id="kobo.281.3">This allows incident response analysts to simply copy the entire file over to an evidence drive for later analysis. </span><span class="koboSpan" id="kobo.281.4">It is recommended that analysts ensure that they conduct a hash of each component of the virtual machine pre- and post-copy to ensure the integrity of </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">the evidence.</span></span></p>
<p><span class="koboSpan" id="kobo.283.1">One key feature of popular virtualization software such as VMware is that the virtual machine utilizes two files for the running memory. </span><span class="koboSpan" id="kobo.283.2">The first of these is the </span><strong class="bold"><span class="koboSpan" id="kobo.284.1">Virtual Memory</span></strong><span class="koboSpan" id="kobo.285.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.286.1">VMEM</span></strong><span class="koboSpan" id="kobo.287.1">) file. </span><span class="koboSpan" id="kobo.287.2">The </span><a id="_idIndexMarker574"/><span class="koboSpan" id="kobo.288.1">VMEM file is the RAM or physical memory of the virtual machine. </span><span class="koboSpan" id="kobo.288.2">The second file is the </span><strong class="bold"><span class="koboSpan" id="kobo.289.1">VMware Suspended State</span></strong><span class="koboSpan" id="kobo.290.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.291.1">VMSS</span></strong><span class="koboSpan" id="kobo.292.1">) file. </span><span class="koboSpan" id="kobo.292.2">The</span><a id="_idIndexMarker575"/><span class="koboSpan" id="kobo.293.1"> VMSS file contains the files that are saved as part of the suspended state of the virtual machine. </span><span class="koboSpan" id="kobo.293.2">Let’s take a look </span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">at this:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.295.1">To acquire the running memory from a VMware virtual machine, pause </span><span class="No-Break"><span class="koboSpan" id="kobo.296.1">the system.</span></span></li>
<li><span class="koboSpan" id="kobo.297.1">Second, transfer the VMSS and VMEM files to a removable media source such as a USB. </span><span class="koboSpan" id="kobo.297.2">VMware software will often include the </span><strong class="source-inline"><span class="koboSpan" id="kobo.298.1">Vmss2Core.exe</span></strong><span class="koboSpan" id="kobo.299.1"> application as part of the installation process. </span><span class="koboSpan" id="kobo.299.2">This application combines the VMSS and VMEM files into a single </span><strong class="source-inline"><span class="koboSpan" id="kobo.300.1">.dmp</span></strong><span class="koboSpan" id="kobo.301.1"> file that can be analyzed with forensic tools. </span><span class="koboSpan" id="kobo.301.2">Both these files are required to create a complete </span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">memory capture.</span></span></li>
<li><span class="koboSpan" id="kobo.303.1">To </span><a id="_idIndexMarker576"/><span class="koboSpan" id="kobo.304.1">create the </span><strong class="source-inline"><span class="koboSpan" id="kobo.305.1">.dmp</span></strong><span class="koboSpan" id="kobo.306.1"> file, run the </span><span class="No-Break"><span class="koboSpan" id="kobo.307.1">following command:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.308.1">C:\Program Files (x86)\VMware\VMware Workstation&gt;vmss2core.exe suspect.vmss suspect.vmem</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.309.1">From here, the responder will have the necessary </span><strong class="source-inline"><span class="koboSpan" id="kobo.310.1">.dmp</span></strong><span class="koboSpan" id="kobo.311.1"> file to </span><span class="No-Break"><span class="koboSpan" id="kobo.312.1">conduct analysis.</span></span></p>
<h1 id="_idParaDest-114"><a id="_idTextAnchor116"/><span class="koboSpan" id="kobo.313.1">Acquiring non-volatile evidence</span></h1>
<p><span class="koboSpan" id="kobo.314.1">Although</span><a id="_idIndexMarker577"/><span class="koboSpan" id="kobo.315.1"> there is a great deal of data running in memory, it is still important to acquire the hard drive from a potentially</span><a id="_idIndexMarker578"/><span class="koboSpan" id="kobo.316.1"> compromised system. </span><span class="koboSpan" id="kobo.316.2">There is a great deal of evidence on these devices, even in the case of malware or other exploitation. </span><span class="koboSpan" id="kobo.316.3">Hard drive evidence becomes even more important when examining potential incidents such as internal malicious action or data loss. </span><span class="koboSpan" id="kobo.316.4">To ensure that this evidence is available and can be utilized in a court of law, incident responders should be well versed in the procedures we’ve discussed in </span><span class="No-Break"><span class="koboSpan" id="kobo.317.1">this chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.318.1">In certain circumstances, incident responders may want to acquire two key pieces of data from suspected compromised systems before shutting down a running system. </span><span class="koboSpan" id="kobo.318.2">While not volatile in nature, the registry keys and event log files can aid analysts during their investigation. </span><span class="koboSpan" id="kobo.318.3">Acquiring these files from an imaged hard drive is largely dependent on the time that’s needed to image and then process the entire hard disk drive. </span><span class="koboSpan" id="kobo.318.4">As a result, there are a few techniques that can be leveraged to acquire these key pieces </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">of evidence.</span></span></p>
<p><span class="koboSpan" id="kobo.320.1">In the event that analysts have access to the system, they can utilize the command line to access the log files by running the </span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.322.1">
C:\wevtutil epl&lt;Log Type&gt; E:\&lt;FileName&gt;.evtx</span></pre>
<p><span class="koboSpan" id="kobo.323.1">This command can be repeated for security, application, and </span><span class="No-Break"><span class="koboSpan" id="kobo.324.1">system logs.</span></span></p>
<h2 id="_idParaDest-115"><a id="_idTextAnchor117"/><span class="koboSpan" id="kobo.325.1">FTK obtaining protected files</span></h2>
<p><span class="koboSpan" id="kobo.326.1">FTK Imager </span><a id="_idIndexMarker579"/><span class="koboSpan" id="kobo.327.1">also allows for the</span><a id="_idIndexMarker580"/><span class="koboSpan" id="kobo.328.1"> capture of registry key settings and other information that can aid in an investigation. </span><span class="koboSpan" id="kobo.328.2">Let’s take </span><span class="No-Break"><span class="koboSpan" id="kobo.329.1">a look:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.330.1">Open FTK Imager and navigate to the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.331.1">File</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.332.1"> tab.</span></span></li>
<li><span class="koboSpan" id="kobo.333.1">Click on </span><strong class="bold"><span class="koboSpan" id="kobo.334.1">Obtain Protected Files</span></strong><span class="koboSpan" id="kobo.335.1">. </span><span class="koboSpan" id="kobo.335.2">The following dialog box </span><span class="No-Break"><span class="koboSpan" id="kobo.336.1">will appear:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer074">
<span class="koboSpan" id="kobo.337.1"><img alt="" src="image/Image_B18571_06_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.338.1">Figure 6.14 – FTK protected files acquisition</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.339.1">Click on </span><strong class="bold"><span class="koboSpan" id="kobo.340.1">Browse...</span></strong><span class="koboSpan" id="kobo.341.1"> and navigate to the evidence </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">file location.</span></span></li>
<li><span class="koboSpan" id="kobo.343.1">Next, click the radio button for </span><strong class="bold"><span class="koboSpan" id="kobo.344.1">Password recovery and all registry files</span></strong><span class="koboSpan" id="kobo.345.1"> and click </span><strong class="bold"><span class="koboSpan" id="kobo.346.1">OK</span></strong><span class="koboSpan" id="kobo.347.1">. </span><span class="koboSpan" id="kobo.347.2">Once the tool completes, the registry and password data will be transferred to the evidence folder. </span><span class="koboSpan" id="kobo.347.3">This command directs FTK Imager so that it obtains the necessary registry files to recover the system passwords. </span><span class="koboSpan" id="kobo.347.4">These include the </span><strong class="source-inline"><span class="koboSpan" id="kobo.348.1">user</span></strong><span class="koboSpan" id="kobo.349.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.350.1">system</span></strong><span class="koboSpan" id="kobo.351.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.352.1">SAM</span></strong><span class="koboSpan" id="kobo.353.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.354.1">NTUSER.DAT</span></strong><span class="koboSpan" id="kobo.355.1"> files. </span><span class="koboSpan" id="kobo.355.2">From here, analysis can take place before the imaging process. </span><span class="koboSpan" id="kobo.355.3">This allows for a more rapid response to </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">an incident.</span></span></li>
</ol>
<h2 id="_idParaDest-116"><a id="_idTextAnchor118"/><span class="koboSpan" id="kobo.357.1">The CyLR response tool</span></h2>
<p><span class="koboSpan" id="kobo.358.1">An</span><a id="_idIndexMarker581"/><span class="koboSpan" id="kobo.359.1"> open source tool that aids </span><a id="_idIndexMarker582"/><span class="koboSpan" id="kobo.360.1">responders in this type of acquisition is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.361.1">CyLR.exe</span></strong><span class="koboSpan" id="kobo.362.1"> application. </span><span class="koboSpan" id="kobo.362.2">This standalone executable, available at </span><a href="https://github.com/orlikoski/CyLR/releases"><span class="koboSpan" id="kobo.363.1">https://github.com/orlikoski/CyLR/releases</span></a><span class="koboSpan" id="kobo.364.1">, can be run from a USB or on the system. </span><span class="koboSpan" id="kobo.364.2">It is a</span><a id="_idIndexMarker583"/><span class="koboSpan" id="kobo.365.1"> small application but can acquire a great deal of evidence that can be leveraged as part of the initial investigation or possibly triage. </span><span class="koboSpan" id="kobo.365.2">Another key feature of </span><strong class="source-inline"><span class="koboSpan" id="kobo.366.1">CyLR.exe</span></strong><span class="koboSpan" id="kobo.367.1"> is its ability to send the data that’s been acquired to a remote system either for storage or processing, as we will demonstrate in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.368.1">Chapter 12</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.369.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.370.1">To acquire the non-volatile log files and other protected files, navigate to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.371.1">CyLR.exe</span></strong><span class="koboSpan" id="kobo.372.1"> executable via Command Prompt and run it as an administrator. </span><span class="koboSpan" id="kobo.372.2">The output directory containing the evidence files will be placed in the same directory as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.373.1">CyLR.exe</span></strong><span class="koboSpan" id="kobo.374.1"> application. </span><span class="koboSpan" id="kobo.374.2">This is handy if you’re running this from a USB device as the output will land directly on </span><span class="No-Break"><span class="koboSpan" id="kobo.375.1">the USB.</span></span></p>
<p><span class="koboSpan" id="kobo.376.1">While the </span><strong class="source-inline"><span class="koboSpan" id="kobo.377.1">CyLR.exe</span></strong><span class="koboSpan" id="kobo.378.1"> application is running, the responder will be able to see the individual files that are </span><span class="No-Break"><span class="koboSpan" id="kobo.379.1">being acquired:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer075">
<span class="koboSpan" id="kobo.380.1"><img alt="" src="image/Image_B18571_06_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.381.1">Figure 6.15 – CyLR output</span></p>
<p><span class="koboSpan" id="kobo.382.1">Depending on the processor and available RAM, </span><strong class="source-inline"><span class="koboSpan" id="kobo.383.1">CyLR.exe</span></strong><span class="koboSpan" id="kobo.384.1"> can be expected to run for a few minutes. </span><span class="koboSpan" id="kobo.384.2">Afterward, the following message </span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">will appear:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer076">
<span class="koboSpan" id="kobo.386.1"><img alt="" src="image/Image_B18571_06_16.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.387.1">Figure 6.16 – CyLR completion message</span></p>
<p><span class="koboSpan" id="kobo.388.1">Finally, a check of the directory where </span><strong class="source-inline"><span class="koboSpan" id="kobo.389.1">CyLR.exe</span></strong><span class="koboSpan" id="kobo.390.1"> was run will reveal a compressed file with the </span><a id="_idIndexMarker584"/><span class="koboSpan" id="kobo.391.1">name of the system</span><a id="_idIndexMarker585"/><span class="koboSpan" id="kobo.392.1"> as the filename. </span><span class="koboSpan" id="kobo.392.2">Uncompressing the file reveals the extensive evidence that </span><span class="No-Break"><span class="koboSpan" id="kobo.393.1">was collected:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer077">
<span class="koboSpan" id="kobo.394.1"><img alt="" src="image/Image_B18571_06_17.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.395.1">Figure 6.17 – CyLR acquired files</span></p>
<p><span class="koboSpan" id="kobo.396.1">The output contains the log files, registry files, and master file table, which will be important in later chapters. </span><span class="koboSpan" id="kobo.396.2">The ability to acquire this data from a simple tool is a major advantage of using </span><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">CyLR.exe</span></strong><span class="koboSpan" id="kobo.398.1"> to acquire evidence before a system is </span><span class="No-Break"><span class="koboSpan" id="kobo.399.1">shut down.</span></span></p>
<h2 id="_idParaDest-117"><a id="_idTextAnchor119"/><span class="koboSpan" id="kobo.400.1">Kroll Artifact Parser and Extractor</span></h2>
<p><span class="koboSpan" id="kobo.401.1">Like CyLR, the </span><strong class="bold"><span class="koboSpan" id="kobo.402.1">Kroll Artifact Parser and Extractor</span></strong><span class="koboSpan" id="kobo.403.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.404.1">KAPE</span></strong><span class="koboSpan" id="kobo.405.1">) is a </span><a id="_idIndexMarker586"/><span class="koboSpan" id="kobo.406.1">digital forensics purpose-designed tool that extracts forensically relevant artifacts and parses them to be analyzed</span><a id="_idIndexMarker587"/><span class="koboSpan" id="kobo.407.1"> using a variety of additional tools. </span><span class="koboSpan" id="kobo.407.2">KAPE utilizes a combination of modules and targets to extract the relevant evidence. </span><span class="koboSpan" id="kobo.407.3">This extraction can be </span><a id="_idIndexMarker588"/><span class="koboSpan" id="kobo.408.1">performed on both live systems and disk images. </span><span class="koboSpan" id="kobo.408.2">KAPE can be downloaded from the Kroll website </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">at </span></span><a href="https://www.kroll.com/en/insights/publications/cyber/kroll-artifact-parser-extractor-kape"><span class="No-Break"><span class="koboSpan" id="kobo.410.1">https://www.kroll.com/en/insights/publications/cyber/kroll-artifact-parser-extractor-kape</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.411.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.412.1">The entire toolset is contained within a single compressed file. </span><span class="koboSpan" id="kobo.412.2">Once downloaded, extract the contents of the folder. </span><span class="koboSpan" id="kobo.412.3">KAPE can be run on the local system or on a USB drive; this allows the analyst to simply attach the USB to the suspect system and execute all commands from there. </span><span class="koboSpan" id="kobo.412.4">There are two executables: </span><strong class="source-inline"><span class="koboSpan" id="kobo.413.1">kape.exe</span></strong><span class="koboSpan" id="kobo.414.1"> is a command-line version </span><a id="_idIndexMarker589"/><span class="koboSpan" id="kobo.415.1">and </span><strong class="source-inline"><span class="koboSpan" id="kobo.416.1">gkape.exe</span></strong><span class="koboSpan" id="kobo.417.1"> is a GUI-based version. </span><span class="koboSpan" id="kobo.417.2">Run </span><strong class="source-inline"><span class="koboSpan" id="kobo.418.1">gkape.exe</span></strong><span class="koboSpan" id="kobo.419.1"> as an administrator and the </span><a id="_idIndexMarker590"/><span class="koboSpan" id="kobo.420.1">following </span><span class="No-Break"><span class="koboSpan" id="kobo.421.1">window appears:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer078">
<span class="koboSpan" id="kobo.422.1"><img alt="" src="image/Image_B18571_06_18.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.423.1">Figure 6.18 – KAPE GUI</span></p>
<p><span class="koboSpan" id="kobo.424.1">The number </span><strong class="bold"><span class="koboSpan" id="kobo.425.1">1</span></strong><span class="koboSpan" id="kobo.426.1"> in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.427.1">Figure 6</span></em></span><em class="italic"><span class="koboSpan" id="kobo.428.1">.18</span></em><span class="koboSpan" id="kobo.429.1"> is where the analyst configures the target selection. </span><span class="koboSpan" id="kobo.429.2">Number </span><strong class="bold"><span class="koboSpan" id="kobo.430.1">2</span></strong><span class="koboSpan" id="kobo.431.1"> shows the target selections. </span><span class="koboSpan" id="kobo.431.2">These are the evidence-collection items that the analysts will select for extraction. </span><span class="koboSpan" id="kobo.431.3">The number </span><strong class="bold"><span class="koboSpan" id="kobo.432.1">3</span></strong><span class="koboSpan" id="kobo.433.1"> indicates where the KAPE command line will appear. </span><span class="koboSpan" id="kobo.433.2">For the following example, KAPE will be run against a live system. </span><span class="koboSpan" id="kobo.433.3">The following will capture the necessary evidence to conduct an initial triage analysis of the target system using a preset </span><span class="No-Break"><span class="koboSpan" id="kobo.434.1">evidence list:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.435.1">In this example, KAPE will be run against the root directory of a Windows system, indicated by the drive letter </span><strong class="source-inline"><span class="koboSpan" id="kobo.436.1">C</span></strong><span class="koboSpan" id="kobo.437.1">. </span><span class="koboSpan" id="kobo.437.2">The output files from the extraction will go to an </span><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">Acct_LT009</span></strong><span class="koboSpan" id="kobo.439.1"> folder on a removable USB drive, as seen in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.440.1">Figure 6</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.441.1">.19</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.442.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer079">
<span class="koboSpan" id="kobo.443.1"><img alt="" src="image/Image_B18571_06_19.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.444.1">Figure 6.19 – Setting target source and destinations</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.445.1">Next, the </span><a id="_idIndexMarker591"/><span class="koboSpan" id="kobo.446.1">analyst needs to select </span><a id="_idIndexMarker592"/><span class="koboSpan" id="kobo.447.1">the target for extraction. </span><span class="koboSpan" id="kobo.447.2">In this case, the analyst is conducting an initial triage and selects the </span><strong class="source-inline"><span class="koboSpan" id="kobo.448.1">!</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.449.1">SANS_Triage</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.450.1"> target:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer080">
<span class="koboSpan" id="kobo.451.1"><img alt="" src="image/Image_B18571_06_20.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.452.1">Figure 6.20 – SANS_Triage target</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.453.1">To see what each of the target selections extracts as artifacts, double-click on the selection. </span><span class="koboSpan" id="kobo.453.2">In this case, the following window displays the </span><span class="No-Break"><span class="koboSpan" id="kobo.454.1">extracted artifacts:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer081">
<span class="koboSpan" id="kobo.455.1"><img alt="" src="image/Image_B18571_06_21.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.456.1">Figure 6.21 – SANS target details</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.457.1">After </span><a id="_idIndexMarker593"/><span class="koboSpan" id="kobo.458.1">selecting the targets, KAPE </span><a id="_idIndexMarker594"/><span class="koboSpan" id="kobo.459.1">provides the command line that will be used. </span><span class="koboSpan" id="kobo.459.2">KAPE can also be run on the command line with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.460.1">kape.exe</span></strong><span class="koboSpan" id="kobo.461.1"> executable. </span><span class="koboSpan" id="kobo.461.2">This allows analysts to craft the command in the GUI and use the output in scripts </span><span class="No-Break"><span class="koboSpan" id="kobo.462.1">if necessary:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer082">
<span class="koboSpan" id="kobo.463.1"><img alt="" src="image/Image_B18571_06_22.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.464.1">Figure 6.22 – KAPE command-line command</span></p>
<p><span class="koboSpan" id="kobo.465.1">The selection output the </span><span class="No-Break"><span class="koboSpan" id="kobo.466.1">following command:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.467.1">.\kape.exe --tsource C: --tdest E:\Acct_LT009 --tflush --target !SANS_Triage –gui</span></strong></pre>
<ol>
<li value="5"><span class="koboSpan" id="kobo.468.1">Once the parameters are set, the analyst clicks on the </span><strong class="bold"><span class="koboSpan" id="kobo.469.1">Execute!</span></strong><span class="koboSpan" id="kobo.470.1"> button. </span><span class="koboSpan" id="kobo.470.2">A new window </span><a id="_idIndexMarker595"/><span class="koboSpan" id="kobo.471.1">will open indicating that any contents of the target or module destination will be destroyed. </span><span class="koboSpan" id="kobo.471.2">Analysts should ensure the contents of the folder for the </span><a id="_idIndexMarker596"/><span class="koboSpan" id="kobo.472.1">artifacts are free of any files. </span><span class="koboSpan" id="kobo.472.2">Click </span><strong class="bold"><span class="koboSpan" id="kobo.473.1">OK</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.474.1">to proceed.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer083">
<span class="koboSpan" id="kobo.475.1"><img alt="" src="image/Image_B18571_06_23.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.476.1">Figure 6.23 – Data destruction warning</span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.477.1">KAPE opens an additional window that shows the progress of artifact identification </span><span class="No-Break"><span class="koboSpan" id="kobo.478.1">and extraction:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer084">
<span class="koboSpan" id="kobo.479.1"><img alt="" src="image/Image_B18571_06_24.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.480.1">Figure 6.24 – KAPE command output</span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.481.1">After </span><a id="_idIndexMarker597"/><span class="koboSpan" id="kobo.482.1">KAPE has finished processing, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.483.1">C</span></strong><span class="koboSpan" id="kobo.484.1"> directory, along with KAPE files, is on the </span><span class="No-Break"><span class="koboSpan" id="kobo.485.1">USB drive:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer085">
<span class="koboSpan" id="kobo.486.1"><img alt="" src="image/Image_B18571_06_25.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.487.1">Figure 6.25 – KAPE targets acquired</span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.488.1">A check </span><a id="_idIndexMarker598"/><span class="koboSpan" id="kobo.489.1">of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.490.1">C</span></strong><span class="koboSpan" id="kobo.491.1"> directory shows some of the artifacts that </span><span class="No-Break"><span class="koboSpan" id="kobo.492.1">were extracted:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer086">
<span class="koboSpan" id="kobo.493.1"><img alt="" src="image/Image_B18571_06_26.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.494.1">Figure 6.26 – Details of KAPE acquired artifacts</span></p>
<p><span class="koboSpan" id="kobo.495.1">Proper</span><a id="_idIndexMarker599"/><span class="koboSpan" id="kobo.496.1"> evidence </span><a id="_idIndexMarker600"/><span class="koboSpan" id="kobo.497.1">handling starts the overall process that aims to determine the root cause of an incident and, potentially, identify the responsible party. </span><span class="koboSpan" id="kobo.497.2">For evidence to be of any use in an incident investigation, it has to be acquired in a sound manner. </span><span class="koboSpan" id="kobo.497.3">Incident responders should have a solid foundation in understanding the various types of acquisition and the tools and techniques that are available and apply those tools and techniques to the various situations that may arise. </span><span class="koboSpan" id="kobo.497.4">By applying solid techniques and properly documenting their actions, incident responders will be in a position to utilize the evidence to not only determine the root cause of an incident but also to back up their actions in a courtroom </span><span class="No-Break"><span class="koboSpan" id="kobo.498.1">if necessary.</span></span></p>
<h1 id="_idParaDest-118"><a id="_idTextAnchor120"/><span class="koboSpan" id="kobo.499.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.500.1">There is a wealth of information on a running system. </span><span class="koboSpan" id="kobo.500.2">Threats such as fileless malware require analysts and incident responders to act quickly while the system is still running. </span><span class="koboSpan" id="kobo.500.3">Capturing this evidence requires both preparation and proper execution of digital forensic tools. </span><span class="koboSpan" id="kobo.500.4">Over the course of this chapter, we examined how understanding the order of volatility of evidence is useful in crafting an acquisition strategy. </span><span class="koboSpan" id="kobo.500.5">We then examined the procedures that should be leveraged in live system acquisition. </span><span class="koboSpan" id="kobo.500.6">Finally, we pivoted into using command-line and GUI tools to acquire the needed artifacts. </span><span class="koboSpan" id="kobo.500.7">These techniques are invaluable to incident responders as they ensure that the evidence acquired is trustworthy </span><span class="No-Break"><span class="koboSpan" id="kobo.501.1">and reliable.</span></span></p>
<p><span class="koboSpan" id="kobo.502.1">In the next chapter, we will look at how to acquire similar evidence from a </span><span class="No-Break"><span class="koboSpan" id="kobo.503.1">remote system.</span></span></p>
<h1 id="_idParaDest-119"><a id="_idTextAnchor121"/><span class="koboSpan" id="kobo.504.1">Questions</span></h1>
<p><span class="koboSpan" id="kobo.505.1">Answer the following questions to test your knowledge of </span><span class="No-Break"><span class="koboSpan" id="kobo.506.1">this chapter:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.507.1">When looking at the order of volatility, which of the following evidence categories should be acquired first? </span><ol><li><span class="koboSpan" id="kobo.508.1">Random Access Memory </span></li><li><span class="koboSpan" id="kobo.509.1">Pagefile or Swap File </span></li><li><span class="koboSpan" id="kobo.510.1">Central Processing Unit, Registers </span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.511.1">Storage Drive</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.512.1">It is a good practice to acquire the pagefile with RAM if using </span><span class="No-Break"><span class="koboSpan" id="kobo.513.1">FTK Imager.</span></span><ol><li><span class="koboSpan" id="kobo.514.1">True </span></li><li><span class="koboSpan" id="kobo.515.1">False </span></li></ol></li>
<li><span class="koboSpan" id="kobo.516.1">When recreating the memory from a virtual system, responders should acquire both the VMSS and VMEM file. </span><ol><li><span class="koboSpan" id="kobo.517.1">True </span></li><li><span class="koboSpan" id="kobo.518.1">False </span></li></ol></li>
</ol>
<h1 id="_idParaDest-120"><a id="_idTextAnchor122"/><span class="koboSpan" id="kobo.519.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.520.1">For more information about the topics covered in this chapter, you can refer to </span><span class="No-Break"><span class="koboSpan" id="kobo.521.1">the following:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.522.1">Order of </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.523.1">Volatility</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.524.1">: </span></span><a href="https://www.forensicswiki.org/wiki/Digital_evidence#Order_of_Volatility"><span class="No-Break"><span class="koboSpan" id="kobo.525.1">https://www.forensicswiki.org/wiki/Digital_evidence#Order_of_Volatility</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.526.1">The Advanced Data Acquisition </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.527.1">Model</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.528.1">: </span></span><a href="https://researchrepository.murdoch.edu.au/id/eprint/14422/"><span class="No-Break"><span class="koboSpan" id="kobo.529.1">https://researchrepository.murdoch.edu.au/id/eprint/14422/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.530.1">Best Practices in Digital Evidence </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.531.1">Collection</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.532.1">: </span></span><a href="https://digital-forensics.sans.org/blog/2009/09/12/best-practices-in-digital-evidence-collection/"><span class="No-Break"><span class="koboSpan" id="kobo.533.1">https://digital-forensics.sans.org/blog/2009/09/12/best-practices-in-digital-evidence-collection/</span></span></a></li>
</ul>
</div>
<div>
<div id="_idContainer088">
</div>
</div>
</body></html>