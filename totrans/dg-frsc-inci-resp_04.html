<html><head></head><body>
<div id="_idContainer040">
<h1 class="chapter-number" id="_idParaDest-61"><a id="_idTextAnchor061"/><span class="koboSpan" id="kobo.1.1">4</span></h1>
<h1 id="_idParaDest-62"><a id="_idTextAnchor062"/><span class="koboSpan" id="kobo.2.1">Investigation Methodology</span></h1>
<p><span class="koboSpan" id="kobo.3.1">So far, the last three chapters have set out the basics of incident response and how digital forensics plays a key role in understanding the nature of an incident. </span><span class="koboSpan" id="kobo.3.2">Another key component of incident response is the investigation component. </span><span class="koboSpan" id="kobo.3.3">An incident investigation is a methodology and process through which analysts form a hypothesis and test that hypothesis to answer questions regarding digital events. </span><span class="koboSpan" id="kobo.3.4">The main data that is fed into the digital investigation process comes from the proper handling and analysis of digital evidence. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.4.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.5.1">.1</span></em><span class="koboSpan" id="kobo.6.1"> shows the relationship between digital forensics, incident response, and incident investigation. </span></p>
<div>
<div class="IMG---Figure" id="_idContainer032">
<span class="koboSpan" id="kobo.7.1"><img alt="" src="image/Image_B18571_04_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.8.1">Figure 4.1 – Relationship between digital forensics, incident investigation and incident response</span></p>
<p><span class="koboSpan" id="kobo.9.1">This chapter will focus on the incident investigation as part of the overall incident response process. </span><span class="koboSpan" id="kobo.9.2">Through these methodologies, analysts will have a road map to follow that will allow them to approach an incident investigation according to an organized and </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">systematic method.</span></span></p>
<p><span class="koboSpan" id="kobo.11.1">This chapter will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.13.1">An intrusion analysis case study: The </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">Cuckoo’s Egg</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Types of incident </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">investigation analysis</span></span></li>
<li><span class="koboSpan" id="kobo.17.1">Functional digital </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">forensics methodology</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">The cyber </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">kill chain</span></span></li>
<li><span class="koboSpan" id="kobo.21.1">A diamond model of </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">intrusion analysis</span></span></li>
</ul>
<h1 id="_idParaDest-63"><a id="_idTextAnchor063"/><span class="koboSpan" id="kobo.23.1">An intrusion analysis case study: The Cuckoo’s Egg</span></h1>
<p><span class="koboSpan" id="kobo.24.1">There have been very many high-profile incidents in the last 30 years, so finding one that encapsulates a good case study for an incident investigation is not difficult. </span><span class="koboSpan" id="kobo.24.2">It may be beneficial to go to the beginning and examine one of the first incident investigations where someone had to</span><a id="_idIndexMarker359"/><span class="koboSpan" id="kobo.25.1"> create methods of gathering evidence and tracking adversaries across the globe. </span><span class="koboSpan" id="kobo.25.2">One aspect of this analysis to keep in mind is that even without a construct, these individuals were able to craft a hypothesis, test it, and analyze the results to come to a conclusion that ultimately helped find </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">the perpetrators.</span></span></p>
<p><span class="koboSpan" id="kobo.27.1">In August 1986, astronomer and systems </span><a id="_idIndexMarker360"/><span class="koboSpan" id="kobo.28.1">administrator at the </span><strong class="bold"><span class="koboSpan" id="kobo.29.1">Lawrence Berkley Laboratory</span></strong><span class="koboSpan" id="kobo.30.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.31.1">LBL</span></strong><span class="koboSpan" id="kobo.32.1">), Cliff Stoll, was handed a mystery by his supervisor. </span><span class="koboSpan" id="kobo.32.2">During a routine audit, the staff at LBL discovered an accounting error by a margin of .75 dollars. </span><span class="koboSpan" id="kobo.32.3">At that time, computer resources were expensive. </span><span class="koboSpan" id="kobo.32.4">Every amount of computing that was used had to be billed to a project or department within the laboratory. </span><span class="koboSpan" id="kobo.32.5">This required very detailed logs of user account activity to be maintained and audited. </span><span class="koboSpan" id="kobo.32.6">A quick check of the error revealed a user account that had been created without any corresponding </span><span class="No-Break"><span class="koboSpan" id="kobo.33.1">billing information.</span></span></p>
<p><span class="koboSpan" id="kobo.34.1">The mystery deepened when the LBL received a message from the National Computer Security Center. </span><span class="koboSpan" id="kobo.34.2">They indicated that a user at LBL was attempting to access systems on the MILNET, the Defense Department’s internal network. </span><span class="koboSpan" id="kobo.34.3">Stoll and his colleagues removed the unauthorized account but the still-unidentified intruder remained. </span><span class="koboSpan" id="kobo.34.4">Stoll’s initial hypothesis was that a student trickster from the nearby University of California was playing an elaborate prank on both the LBL and the various MILNET entities that were connected. </span><span class="koboSpan" id="kobo.34.5">Stoll then began to examine the accounting logs in greater detail to determine who the individual behind the intrusion was. </span><span class="koboSpan" id="kobo.34.6">What followed was a ten-month odyssey through which Stoll traced traffic across the United States and </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">into Europe.</span></span></p>
<p><span class="koboSpan" id="kobo.36.1">After tossing the trickster hypothesis, Stoll’s first step was to create a log of all the activities that he and the other staff at LBL carried out. </span><span class="koboSpan" id="kobo.36.2">At the onset of his investigation, Stoll came upon an aspect of investigating network intrusions that other responders have had to learn the hard way: that an intruder may be able to access emails and other communications while having access to compromised systems. </span><span class="koboSpan" id="kobo.36.3">As a result, Stoll and his team resorted to in-person or telephone communications while keeping up a steady stream of fake emails to keep the intruder feeling confident that they had still not been detected. </span><span class="koboSpan" id="kobo.36.4">This log would come in handy at a later stage of the investigation when a clearer picture of the </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">events emerged.</span></span></p>
<p><span class="koboSpan" id="kobo.38.1">The first major challenge that Stoll and the team would have to contend with was the lack of any visibility into the LBL network and the intruder’s activity. </span><span class="koboSpan" id="kobo.38.2">In 1986, tools such as event logging, packet</span><a id="_idIndexMarker361"/><span class="koboSpan" id="kobo.39.1"> capture, and </span><strong class="bold"><span class="koboSpan" id="kobo.40.1">Intrusion Detection Systems</span></strong><span class="koboSpan" id="kobo.41.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.42.1">IDSs</span></strong><span class="koboSpan" id="kobo.43.1">) did not exist. </span><span class="koboSpan" id="kobo.43.2">Stoll’s solution to this challenge was to string printers on all lines that were leading to the initial point of entry. </span><span class="koboSpan" id="kobo.43.3">These printers would serve as the logging for the unknown intruder’s activity. </span><span class="koboSpan" id="kobo.43.4">After examining one of the intruder’s connections, he was able to determine that the intruder was using the X.25 ports. </span><span class="koboSpan" id="kobo.43.5">From here, Stoll was able to set up a passive tap that</span><a id="_idIndexMarker362"/><span class="koboSpan" id="kobo.44.1"> captured the intruder’s keystrokes and output the data to either a floppy disk or a </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">physical printer.</span></span></p>
<p><span class="koboSpan" id="kobo.46.1">With the ability to monitor the network, Stoll then encountered another challenge: tracing the attacker back to their origin. </span><span class="koboSpan" id="kobo.46.2">At that time, remote connections were done over telephone lines and the ability to trace back a connection was dependent on a collection of phone companies. </span><span class="koboSpan" id="kobo.46.3">Compounding this challenge was the fact that the attacker would often use the LBL connection as a jumping-off point to other networks. </span><span class="koboSpan" id="kobo.46.4">This meant that the connections Stoll was hunting down would only last a few minutes. </span><span class="koboSpan" id="kobo.46.5">Stoll set up several alerts on the system that would page him via a belt pager, at which time he could remote into the LBL systems to begin another trace. </span><span class="koboSpan" id="kobo.46.6">Despite these steps, Stoll and his colleagues were still unable to maintain a connection long enough to determine </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">the source.</span></span></p>
<p><span class="koboSpan" id="kobo.48.1">The solution to this challenge was found in what the attacker was attempting to access. </span><span class="koboSpan" id="kobo.48.2">During his analysis, Stoll observed that the attacker was not only accessing the LBL network but had used the connection to search other networks belonging to the United States military and their associated defense contractors. </span><span class="koboSpan" id="kobo.48.3">The solution that Stoll came up with was based on a suggestion by his then-girlfriend. </span><span class="koboSpan" id="kobo.48.4">In order to keep the intruder connected, Stoll created a series of fake documents with titles that appeared to an outsider to be associated </span><a id="_idIndexMarker363"/><span class="koboSpan" id="kobo.49.1">with the </span><strong class="bold"><span class="koboSpan" id="kobo.50.1">Strategic Defense Initiative</span></strong><span class="koboSpan" id="kobo.51.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.52.1">SDI</span></strong><span class="koboSpan" id="kobo.53.1">) program. </span><span class="koboSpan" id="kobo.53.2">Anyone that was attempting to gain classified information would immediately recognize the strategic importance of these documents. </span><span class="koboSpan" id="kobo.53.3">Additionally, Stoll planted a form letter indicating that hard copy documents were also available by mail. </span><span class="koboSpan" id="kobo.53.4">Access to the files was strictly controlled with alerts placed on them to indicate when the attacker attempted to access them. </span><span class="koboSpan" id="kobo.53.5">This approach worked. </span><span class="koboSpan" id="kobo.53.6">Not only had the yet-to-be-identified intruder spent an hour reading the fictitious files, but they had also sent a request to be added to the mailing list via the </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">post office.</span></span></p>
<p><span class="koboSpan" id="kobo.55.1">The main hurdle that Stoll continually ran into during these 10 months was tracing the attacker’s connections to the LBL network. </span><span class="koboSpan" id="kobo.55.2">The intruder kept up a steady pattern of using a wide range of networks to connect through. </span><span class="koboSpan" id="kobo.55.3">Secondly, the intruder varied their connection times to only stay on for a few minutes at a time. </span><span class="koboSpan" id="kobo.55.4">Through his initial work, Stoll was able to identify a dial-up connection in Oakland, California. </span><span class="koboSpan" id="kobo.55.5">With cooperation from the telephone company, he was able to isolate a connection from a modem that belonged to a defense contractor in McLean, Virginia. </span><span class="koboSpan" id="kobo.55.6">With coordination from the data communications company Tymnet, Stoll and the team were able to trace the connection to the LBL network back </span><a id="_idIndexMarker364"/><span class="No-Break"><span class="koboSpan" id="kobo.56.1">to Germany.</span></span></p>
<p><span class="koboSpan" id="kobo.57.1">It was after Stoll placed the fictitious documents on the LBL systems that he was able to complete his tracing. </span><span class="koboSpan" id="kobo.57.2">Even so, this tracing took a good deal of coordination between Stoll, Tymnet, various universities, and even German law enforcement. </span><span class="koboSpan" id="kobo.57.3">In the end, Stoll’s efforts paid off, as he was able to identify the perpetrators as members of the German Chaos Computer Club. </span><span class="koboSpan" id="kobo.57.4">The individuals were tied to additional break-ins associated with various universities and defense contractors in the </span><span class="No-Break"><span class="koboSpan" id="kobo.58.1">United States.</span></span></p>
<p><span class="koboSpan" id="kobo.59.1">It may seem odd to examine a network intrusion from 1986 but there is still a great deal we can learn from Stoll’s work. </span><span class="koboSpan" id="kobo.59.2">First, this was arguably</span><a id="_idIndexMarker365"/><span class="koboSpan" id="kobo.60.1"> the first publicly documented </span><strong class="bold"><span class="koboSpan" id="kobo.61.1">Advanced Persistent Threat</span></strong><span class="koboSpan" id="kobo.62.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.63.1">APT</span></strong><span class="koboSpan" id="kobo.64.1">) attack. </span><span class="koboSpan" id="kobo.64.2">The subsequent investigation by the FBI and other governmental agencies determined that the Chaos Computer Club was attempting to gain financially by selling intelligence to the </span><strong class="bold"><span class="koboSpan" id="kobo.65.1">Komitet Gosudarstvennoy Bezopasnosti</span></strong><span class="koboSpan" id="kobo.66.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.67.1">KGB</span></strong><span class="koboSpan" id="kobo.68.1">). </span><span class="koboSpan" id="kobo.68.2">An interesting aside is that initially, the KGB had very</span><a id="_idIndexMarker366"/><span class="koboSpan" id="kobo.69.1"> little experience in conducting network intrusions for intelligence purposes. </span><span class="koboSpan" id="kobo.69.2">Stoll uncovered a significant vulnerability that counterintelligence personnel should have been aware of: that adversarial intelligence agencies were now using the emerging internet as an intelligence </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">collection method.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.71.1">Cliff Stoll’s story</span></p>
<p class="callout"><span class="koboSpan" id="kobo.72.1">Cliff Stoll has written and spoken extensively on his experience tracking the LBL hacker. </span><span class="koboSpan" id="kobo.72.2">A copy of his article </span><em class="italic"><span class="koboSpan" id="kobo.73.1">Stalking the Wily Hacker</span></em><span class="koboSpan" id="kobo.74.1"> is included in the supplemental material for this chapter. </span><span class="koboSpan" id="kobo.74.2">Stoll also published a full book, </span><em class="italic"><span class="koboSpan" id="kobo.75.1">The Cuckoo’s Egg</span></em><span class="koboSpan" id="kobo.76.1">. </span><span class="koboSpan" id="kobo.76.2">This is well worth reading, even though the events took place over 35 </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">years ago.</span></span></p>
<p><span class="koboSpan" id="kobo.78.1">A second lesson we can learn from this is that a comprehensive and detailed investigation can lead back to the origin of an attack. </span><span class="koboSpan" id="kobo.78.2">In this case, Stoll could have easily downed the connection and removed the attacker from the network. </span><span class="koboSpan" id="kobo.78.3">Instead, he set out to comprehensively detail the </span><strong class="bold"><span class="koboSpan" id="kobo.79.1">Tactics, Techniques, and Procedures</span></strong><span class="koboSpan" id="kobo.80.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.81.1">TTPs</span></strong><span class="koboSpan" id="kobo.82.1">) of the attacker. </span><span class="koboSpan" id="kobo.82.2">With some deception, he </span><a id="_idIndexMarker367"/><span class="koboSpan" id="kobo.83.1">was further able to tie an individual to a keyboard, a tall order in 1986. </span><span class="koboSpan" id="kobo.83.2">Overall, Stoll showed that through detailed investigation of an intrusion, he and others could uncover details of the wider scope of an attack that went far beyond a .75 cent</span><a id="_idIndexMarker368"/><span class="koboSpan" id="kobo.84.1"> accounting error into global espionage and cold war politics. </span><span class="koboSpan" id="kobo.84.2">These lessons are as salient today as they were in 1986. </span><span class="koboSpan" id="kobo.84.3">Keep this in mind as we examine how intrusion analysis serves as a source for our own understanding of </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">attackers today.</span></span></p>
<h1 id="_idParaDest-64"><a id="_idTextAnchor064"/><span class="koboSpan" id="kobo.86.1">Types of incident investigation analysis</span></h1>
<p><span class="koboSpan" id="kobo.87.1">Digital investigations are not all the same. </span><span class="koboSpan" id="kobo.87.2">There are a variety of reasons that a </span><strong class="bold"><span class="koboSpan" id="kobo.88.1">Computer Security Incident Response Team</span></strong><span class="koboSpan" id="kobo.89.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.90.1">CSIRT</span></strong><span class="koboSpan" id="kobo.91.1">) will stop an investigation based on the time allowed, the type</span><a id="_idIndexMarker369"/><span class="koboSpan" id="kobo.92.1"> of incident, and the overall goal of the investigation. </span><span class="koboSpan" id="kobo.92.2">It makes no sense for two or three CSIRT analysts to spend a full day investigating a small-scale malware outbreak. </span><span class="koboSpan" id="kobo.92.3">On the other hand, a </span><a id="_idIndexMarker370"/><span class="koboSpan" id="kobo.93.1">network intrusion where the adversary has been in the network for three months will require a much more detailed examination of the evidence to determine how the adversary was able to gain access, what information they aggregated and exfiltrated, and what the impact on the organization </span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">has been.</span></span></p>
<p><span class="koboSpan" id="kobo.95.1">The result is that there are several different types of incident investigations conducted by various individuals within an organization. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.96.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.97.1">.2</span></em><span class="koboSpan" id="kobo.98.1"> shows the five layers and the personnel involved, along with the corresponding time and the necessary </span><span class="No-Break"><span class="koboSpan" id="kobo.99.1">investigative resources:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer033">
<span class="koboSpan" id="kobo.100.1"><img alt="" src="image/Image_B18571_04_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.101.1">Figure 4.2 – Types of incident investigation</span></p>
<p><span class="koboSpan" id="kobo.102.1">Let us discuss the five layers </span><span class="No-Break"><span class="koboSpan" id="kobo.103.1">in detail:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.104.1">Detection analysis</span></strong><span class="koboSpan" id="kobo.105.1">: This is the basic</span><a id="_idIndexMarker371"/><span class="koboSpan" id="kobo.106.1"> analysis that is often conducted at the first signs of a security event’s detection. </span><span class="koboSpan" id="kobo.106.2">For example, a security device’s telemetry indicates a network</span><a id="_idIndexMarker372"/><span class="koboSpan" id="kobo.107.1"> connection to a known </span><strong class="bold"><span class="koboSpan" id="kobo.108.1">Command-and-Control</span></strong><span class="koboSpan" id="kobo.109.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.110.1">C2</span></strong><span class="koboSpan" id="kobo.111.1">) server. </span><span class="koboSpan" id="kobo.111.2">A quick check of the dashboard may indicate a localized event or potentially a wider incident. </span><span class="koboSpan" id="kobo.111.3">The detection analysis is often limited to telemetry and a secondary source, such</span><a id="_idIndexMarker373"/><span class="koboSpan" id="kobo.112.1"> as an external threat intelligence feed. </span><span class="koboSpan" id="kobo.112.2">The goal of this analysis is to determine whether the event is an incident that needs to be escalated to the CSIRT </span><span class="No-Break"><span class="koboSpan" id="kobo.113.1">or not.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.114.1">Preliminary analysis</span></strong><span class="koboSpan" id="kobo.115.1">: Security incidents are often ambiguous. </span><span class="koboSpan" id="kobo.115.2">CSIRT and SOC personnel need to develop insight into</span><a id="_idIndexMarker374"/><span class="koboSpan" id="kobo.116.1"> the initial infection, lateral movement, and how the adversary is maintaining control over the compromised system. </span><span class="koboSpan" id="kobo.116.2">The preliminary analysis utilizes tools that rapidly acquire selected evidence and analysis to determine the scope of an incident and provide information to the leadership, which can be used to contain an incident and gain time to decide on the next steps in investigation </span><span class="No-Break"><span class="koboSpan" id="kobo.117.1">and response.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.118.1">Root-cause analysis</span></strong><span class="koboSpan" id="kobo.119.1">: This type of investigation is usually executed in conjunction with containment steps. </span><span class="koboSpan" id="kobo.119.2">The main goal here is to acquire and analyze evidence to </span><a id="_idIndexMarker375"/><span class="koboSpan" id="kobo.120.1">determine how the adversary was able to gain access to the network, what steps they took and what they were, and what the potential impact on the organization was. </span><span class="koboSpan" id="kobo.120.2">The aim of this type of investigation is to remediate vulnerabilities and improve the overall security of the enterprise to lessen the risk of </span><span class="No-Break"><span class="koboSpan" id="kobo.121.1">future intrusions.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.122.1">Intrusion analysis</span></strong><span class="koboSpan" id="kobo.123.1">: Organizations can glean a good deal of insight into the TTPs of an adversary through a </span><a id="_idIndexMarker376"/><span class="koboSpan" id="kobo.124.1">root-cause analysis. </span><span class="koboSpan" id="kobo.124.2">An intrusion analysis goes into greater detail to present a comprehensive picture of how an adversary operated during the network intrusion. </span><span class="koboSpan" id="kobo.124.3">As </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.125.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.126.1">.2</span></em><span class="koboSpan" id="kobo.127.1"> shows, an intrusion analysis will often take a much longer time and more investigative effort than necessary to contain, eradicate, and recover from an incident. </span><span class="koboSpan" id="kobo.127.2">An intrusion analysis does benefit the organization, however, as far as it provides a comprehensive insight into the adversary’s behavior. </span><span class="koboSpan" id="kobo.127.3">This not only explains the adversary’s behavior but also provides valuable intelligence on more advanced adversaries </span><span class="No-Break"><span class="koboSpan" id="kobo.128.1">in general.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.129.1">Attribution analysis</span></strong><span class="koboSpan" id="kobo.130.1">: At the top end in</span><a id="_idIndexMarker377"/><span class="koboSpan" id="kobo.131.1"> terms of time and investigative effort is attribution. </span><span class="koboSpan" id="kobo.131.2">Attribution, simply put, ties an intrusion to a threat actor. </span><span class="koboSpan" id="kobo.131.3">This can be a group such as the Conti ransomware group, Fancy Bear, or, in some cases, such as with the Mandiant APT1 report (</span><a href="https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report.pdf?source=post_page"><span class="koboSpan" id="kobo.132.1">https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report.pdf?source=post_page</span></a><span class="koboSpan" id="kobo.133.1">), intrusion activity may be tied to a </span><a id="_idIndexMarker378"/><span class="koboSpan" id="kobo.134.1">specific unit of the Chinese military, along with specific individuals. </span><span class="koboSpan" id="kobo.134.2">The time and resources necessary for incident attribution are often outside the reach of CSIRTs. </span><span class="koboSpan" id="kobo.134.3">Attribution is most often reserved for cyber threat intelligence purposes. </span><span class="koboSpan" id="kobo.134.4">With that said, there are organizations that leverage the investigative experience, tools, and techniques of CSIRT members, so there is still a good </span><a id="_idIndexMarker379"/><span class="koboSpan" id="kobo.135.1">chance that the team may be engaged in such an analysis. </span></li>
</ul>
<p><span class="koboSpan" id="kobo.136.1">Each one of these analyses has its place in incident investigations. </span><span class="koboSpan" id="kobo.136.2">Which type of analysis is conducted is dependent on several factors: first, the overall goal of the organization. </span><span class="koboSpan" id="kobo.136.3">For example, a network intrusion may be investigated to only determine the root cause, as the organization does not have the time or resources to go any farther. </span><span class="koboSpan" id="kobo.136.4">In other incidents, the organization may have</span><a id="_idIndexMarker380"/><span class="koboSpan" id="kobo.137.1"> legal or compliance requirements that dictate incidents are fully investigated, no matter how long </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">it takes.</span></span></p>
<p><span class="koboSpan" id="kobo.139.1">Second, the evidence available will largely dictate how far analysis can go. </span><span class="koboSpan" id="kobo.139.2">Without a good deal of evidence sources across the network, the ability to conduct a full intrusion analysis will be limited, or even impossible. </span><span class="koboSpan" id="kobo.139.3">Finally, the time available to conduct more intensive analysis is often a factor. </span><span class="koboSpan" id="kobo.139.4">The organization may not have the time or personnel to go in as deeply as a full intrusion analysis could, or it may feel that a root-cause analysis that removes the adversary from the network and prevents future </span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">occurrences suffices.</span></span></p>
<h1 id="_idParaDest-65"><a id="_idTextAnchor065"/><span class="koboSpan" id="kobo.141.1">Functional digital forensic investigation methodology</span></h1>
<p><span class="koboSpan" id="kobo.142.1">There are several different </span><a id="_idIndexMarker381"/><span class="koboSpan" id="kobo.143.1">methodologies for conducting analysis. </span><span class="koboSpan" id="kobo.143.2">The following digital forensics investigation methodology is based on the best practices outlined in the NIST Special Publication 800-61a, which covers incident response, along with Dr. </span><span class="koboSpan" id="kobo.143.3">Peter Stephenson’s End-to-End Digital Investigations methodology. </span><span class="koboSpan" id="kobo.143.4">These two methodologies were further augmented by the research publication </span><em class="italic"><span class="koboSpan" id="kobo.144.1">Getting Physical with the Digital Investigation Process</span></em><span class="koboSpan" id="kobo.145.1"> by Brian Carrier and Eugene </span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">H. </span><span class="koboSpan" id="kobo.146.2">Spafford.</span></span></p>
<p><span class="koboSpan" id="kobo.147.1">The overall approach to this kind of methodology is to apply digital evidence and analysis to either prove or disprove a hypothesis. </span><span class="koboSpan" id="kobo.147.2">For example, an analyst may approach the intrusion based on the initial identification with the hypothesis that the adversary was able to gain an initial foothold on the network through a phishing email. </span><span class="koboSpan" id="kobo.147.3">What is necessary is for the analyst to gather the necessary information from the infected system, endpoint telemetry, and other sources to trace the introduction of malware through </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">an email.</span></span></p>
<p><span class="koboSpan" id="kobo.149.1">The following methodology utilizes 10 distinct phases of an incident investigation to ensure that the data acquired is</span><a id="_idIndexMarker382"/><span class="koboSpan" id="kobo.150.1"> analyzed properly and that the conclusion supports or refutes the </span><span class="No-Break"><span class="koboSpan" id="kobo.151.1">hypothesis created.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer034">
<span class="koboSpan" id="kobo.152.1"><img alt="" src="image/Image_B18571_04_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.153.1">Figure 4.3 – A ten-step investigation methodology</span></p>
<h2 id="_idParaDest-66"><a id="_idTextAnchor066"/><span class="koboSpan" id="kobo.154.1">Identification and scoping</span></h2>
<p><span class="koboSpan" id="kobo.155.1">This is the first stage of an incident investigation, which begins once a detection is made and is declared an incident. </span><span class="koboSpan" id="kobo.155.2">The most likely scenario is that security telemetry such as an </span><strong class="bold"><span class="koboSpan" id="kobo.156.1">Endpoint Detection and Response</span></strong><span class="koboSpan" id="kobo.157.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.158.1">EDR</span></strong><span class="koboSpan" id="kobo.159.1">) platform</span><a id="_idIndexMarker383"/><span class="koboSpan" id="kobo.160.1"> or an IDS indicates that either a behavior, an </span><strong class="bold"><span class="koboSpan" id="kobo.161.1">Indicator of Compromise</span></strong><span class="koboSpan" id="kobo.162.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.163.1">IOC</span></strong><span class="koboSpan" id="kobo.164.1">), or some combination of the</span><a id="_idIndexMarker384"/><span class="koboSpan" id="kobo.165.1"> two has been detected within the environment. </span><span class="koboSpan" id="kobo.165.2">In other circumstances, the identification of an incident can come from a human </span><a id="_idIndexMarker385"/><span class="koboSpan" id="kobo.166.1">source. </span><span class="koboSpan" id="kobo.166.2">For example, an individual may indicate that they clicked on a suspicious link or that their system files have been encrypted with ransomware. </span><span class="koboSpan" id="kobo.166.3">In other human circumstances, an organization may be informed by law enforcement that its confidential information has been found on an </span><span class="No-Break"><span class="koboSpan" id="kobo.167.1">adversary’s infrastructure.</span></span></p>
<p><span class="koboSpan" id="kobo.168.1">In any of these cases, the initial identification should be augmented with an initial examination of telemetry to identify any other systems that may be part of the incident. </span><span class="koboSpan" id="kobo.168.2">This sets the scope or the limits </span><a id="_idIndexMarker386"/><span class="koboSpan" id="kobo.169.1">of the investigation. </span><span class="koboSpan" id="kobo.169.2">An organization does not need to address Linux systems if they were able to identify a Windows binary being used to encrypt Windows operating </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">system hosts.</span></span></p>
<h2 id="_idParaDest-67"><a id="_idTextAnchor067"/><span class="koboSpan" id="kobo.171.1">Collecting evidence</span></h2>
<p><span class="koboSpan" id="kobo.172.1">Once an incident has been identified and scoped, the next stage is to begin gathering evidence. </span><span class="koboSpan" id="kobo.172.2">Evidence that is short-lived should be prioritized, working down the list of volatility that was covered in </span><a href="B18571_03.xhtml#_idTextAnchor046"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.173.1">Chapter 3</span></em></span></a><span class="koboSpan" id="kobo.174.1">. </span><span class="koboSpan" id="kobo.174.2">Incident response and digital forensics personnel should ensure that they preserve as much evidence as possible, even if they do not think that it will be </span><a id="_idIndexMarker387"/><span class="koboSpan" id="kobo.175.1">useful in the early stages of an investigation. </span><span class="koboSpan" id="kobo.175.2">For example, if a network administrator knows that the firewall logs roll over every 24 hours, they should be captured immediately. </span><span class="koboSpan" id="kobo.175.3">If it is determined later that the firewall logs are of no use, they can be easily discarded but if they would have been useful and were not acquired, the organization may have lost some key </span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">data points.</span></span></p>
<p><span class="koboSpan" id="kobo.177.1">The volatility and overall availability of evidence should be addressed in the incident response plan. </span><span class="koboSpan" id="kobo.177.2">For example, policies and procedures should be in place to address the retention of log files for a defined period. </span><span class="koboSpan" id="kobo.177.3">For example, the </span><strong class="bold"><span class="koboSpan" id="kobo.178.1">Payment Card Industry Data Security Standard</span></strong><span class="koboSpan" id="kobo.179.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.180.1">PCI DSS</span></strong><span class="koboSpan" id="kobo.181.1">) requires that </span><a id="_idIndexMarker388"/><span class="koboSpan" id="kobo.182.1">organizations covered by this standard have one year of logs available, with at least 90 days immediately available. </span><span class="koboSpan" id="kobo.182.2">Organizations need to balance storage costs with the potential evidentiary value of </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">certain logs.</span></span></p>
<p><span class="koboSpan" id="kobo.184.1">Several chapters of this book delve into further detail about evidence acquisition. </span><span class="koboSpan" id="kobo.184.2">The main point regarding an incident investigation is to have as complete an evidence acquisition as possible. </span><span class="koboSpan" id="kobo.184.3">The saying goes “the more, the better.” </span><span class="koboSpan" id="kobo.184.4">The last thing that an incident response or digital forensics analyst wants is a critical piece of the incident missing because the organization was not prepared for or able to acquire the evidence in a </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">timely manner.</span></span></p>
<h2 id="_idParaDest-68"><a id="_idTextAnchor068"/><span class="koboSpan" id="kobo.186.1">The initial event analysis</span></h2>
<p><span class="koboSpan" id="kobo.187.1">After the evidence has been acquired, the next stage of the investigative process is to organize and begin to examine the individual events. </span><span class="koboSpan" id="kobo.187.2">This may be difficult given the volume of data, so this is not necessarily a</span><a id="_idIndexMarker389"/><span class="koboSpan" id="kobo.188.1"> detailed examination, which comes later, but rather, the first analysis to determine which data points are of evidentiary value. </span><span class="koboSpan" id="kobo.188.2">For example, in a ransomware case, adversaries often make</span><a id="_idIndexMarker390"/><span class="koboSpan" id="kobo.189.1"> use of scripting languages such as </span><strong class="bold"><span class="koboSpan" id="kobo.190.1">Virtual Basic Scripting</span></strong><span class="koboSpan" id="kobo.191.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.192.1">VBS</span></strong><span class="koboSpan" id="kobo.193.1">) or Base64-encoded PowerShell commands. </span><span class="koboSpan" id="kobo.193.2">A review of the Windows PowerShell logs may indicate the presence of an encoded command. </span><span class="koboSpan" id="kobo.193.3">A PDF or Word document found on an infected system may be examined to indicate the presence of </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">VBS attacks.</span></span></p>
<p><span class="koboSpan" id="kobo.195.1">This first stage is looking for obvious IOCs. </span><span class="koboSpan" id="kobo.195.2">An IOC can be defined as </span><em class="italic"><span class="koboSpan" id="kobo.196.1">a data point that indicates that a system or systems is or was under adversarial control</span></em><span class="koboSpan" id="kobo.197.1">. </span><span class="koboSpan" id="kobo.197.2">IOCs can be divided into three </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">main categories:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.199.1">Atomic indicators</span></strong><span class="koboSpan" id="kobo.200.1">: These are data points that are indicators in and of themselves that cannot be further </span><a id="_idIndexMarker391"/><span class="koboSpan" id="kobo.201.1">broken down into smaller parts, for example, an IP address or domain name that ties back to an adversary’s </span><span class="No-Break"><span class="koboSpan" id="kobo.202.1">C2 infrastructure.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.203.1">Computational indicators</span></strong><span class="koboSpan" id="kobo.204.1">: These are data points that are processed through some computational means, for </span><a id="_idIndexMarker392"/><span class="koboSpan" id="kobo.205.1">example, the SHA256 file hash of a suspected </span><span class="No-Break"><span class="koboSpan" id="kobo.206.1">malware binary.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.207.1">Behavioral</span></strong><span class="koboSpan" id="kobo.208.1">: Behavioral indicators are a combination of both atomic and computational indicators that form a </span><a id="_idIndexMarker393"/><span class="koboSpan" id="kobo.209.1">profile of adversary activity. </span><span class="koboSpan" id="kobo.209.2">Behavioral indicators are often phrases that place the various IOCs together. </span><span class="koboSpan" id="kobo.209.3">For example, the statement the adversary used a web shell with the following SHA256 value: </span><strong class="source-inline"><span class="koboSpan" id="kobo.210.1">7e1861e4bec1b8be6ae5633f87204a8bdbb8f4709b17b5fa14b63abec6c72132</span></strong><span class="koboSpan" id="kobo.211.1">. </span><span class="koboSpan" id="kobo.211.2">An analysis of the web shell indicated that once executed, it would call out to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.212.1">baddomain.ru</span></strong><span class="koboSpan" id="kobo.213.1"> domain, which has been identified as the adversary’s </span><span class="No-Break"><span class="koboSpan" id="kobo.214.1">C2 infrastructure.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.215.1">During this stage of the investigation, there is an increased potential for false positive IOCs in the same data that true IOCs are in. </span><span class="koboSpan" id="kobo.215.2">This is expected at this stage. </span><span class="koboSpan" id="kobo.215.3">The key at this stage of the investigation is to determine what looks suspicious and include it in the investigation. </span><span class="koboSpan" id="kobo.215.4">There will be plenty of opportunities to remove false positives. </span><span class="koboSpan" id="kobo.215.5">A good rule to follow is if you have any doubt about an IOC, include it until such a time that you can positively prove it is either malicious </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">or benign.</span></span></p>
<h2 id="_idParaDest-69"><a id="_idTextAnchor069"/><span class="koboSpan" id="kobo.217.1">The preliminary correlation</span></h2>
<p><span class="koboSpan" id="kobo.218.1">At this point in the investigation, the </span><a id="_idIndexMarker394"/><span class="koboSpan" id="kobo.219.1">analysts should start to detect some patterns, or at least see relationships in the IOCs. </span><span class="koboSpan" id="kobo.219.2">In the preliminary correlation phase, analysts start to marry up indicators that correlate. </span><span class="koboSpan" id="kobo.219.3">As Dr. </span><span class="koboSpan" id="kobo.219.4">Peter Stephenson states, correlation can be </span><span class="No-Break"><span class="koboSpan" id="kobo.220.1">defined as:</span></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.221.1">The comparison of evidentiary information from a variety of sources with the objective of discovering information that stands alone, in concert with other information, or corroborates or is corroborated by other </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.222.1">evidentiary information</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.223.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.224.1">Simply put, the preliminary correlation phase takes the individual events and correlates them into a </span><em class="italic"><span class="koboSpan" id="kobo.225.1">chain of events</span></em><span class="koboSpan" id="kobo.226.1">. </span><span class="koboSpan" id="kobo.226.2">For example, we can take the case of a web shell that has been loaded to a web server. </span><span class="koboSpan" id="kobo.226.3">In this case, there are several specific evidence points that are created. </span><span class="koboSpan" id="kobo.226.4">A web application firewall may see the HTTP POST in the logs. </span><span class="koboSpan" id="kobo.226.5">The POST would also create a date and time stamp on the web server. </span><span class="koboSpan" id="kobo.226.6">An analysis of the web shell may indicate that another external resource is under the control of the adversary. </span><span class="koboSpan" id="kobo.226.7">From these data points, the analyst would be able to </span><a id="_idIndexMarker395"/><span class="koboSpan" id="kobo.227.1">determine the adversary’s IP address from the </span><strong class="bold"><span class="koboSpan" id="kobo.228.1">Internet Information Service</span></strong><span class="koboSpan" id="kobo.229.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.230.1">IIS</span></strong><span class="koboSpan" id="kobo.231.1">) logs, when the web shell was posted, and whether there was any additional adversary infrastructure contained </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">within it.</span></span></p>
<p><span class="koboSpan" id="kobo.233.1">A good way to look at the preliminary correlation phase is the first time that the analyst is saying “</span><em class="italic"><span class="koboSpan" id="kobo.234.1">this happened, then this, and </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.235.1">then this</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.236.1">”.</span></span></p>
<h2 id="_idParaDest-70"><a id="_idTextAnchor070"/><span class="koboSpan" id="kobo.237.1">Event normalization</span></h2>
<p><span class="koboSpan" id="kobo.238.1">Adversary actions on a system may have multiple sources of data. </span><span class="koboSpan" id="kobo.238.2">For example, an adversary</span><a id="_idIndexMarker396"/><span class="koboSpan" id="kobo.239.1"> uses the </span><strong class="bold"><span class="koboSpan" id="kobo.240.1">Remote Desktop Protocol</span></strong><span class="koboSpan" id="kobo.241.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.242.1">RDP</span></strong><span class="koboSpan" id="kobo.243.1">) and compromises credentials to gain access to the domain controller. </span><span class="koboSpan" id="kobo.243.2">There will be entries within the Windows event log related to the RDP </span><a id="_idIndexMarker397"/><span class="koboSpan" id="kobo.244.1">connection and the use of the credentials. </span><span class="koboSpan" id="kobo.244.2">If the adversary traversed a firewall, there would also be a record of the connection in the firewall connection logs. </span><span class="koboSpan" id="kobo.244.3">Again, according to Dr. </span><span class="koboSpan" id="kobo.244.4">Stephenson, the event normalization phase is defined as </span><em class="italic"><span class="koboSpan" id="kobo.245.1">the combination of evidentiary data of the same type from different sources with different vocabularies into a single, integrated terminology that can be used effectivity in the </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.246.1">correlation process</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.248.1">In this stage, the duplicate entries are combined into a single syntax. </span><span class="koboSpan" id="kobo.248.2">In the previous case, the various entries in question can then be combined into a statement regarding the adversary gaining access to</span><a id="_idIndexMarker398"/><span class="koboSpan" id="kobo.249.1"> the system via the Windows RDP. </span></p>
<p><span class="koboSpan" id="kobo.250.1">One challenge that has been an issue in the past with event normalization is the formulation of a global syntax of adversary behaviors, such as the one in the previous example. </span><span class="koboSpan" id="kobo.250.2">To address this, the MITRE</span><a id="_idIndexMarker399"/><span class="koboSpan" id="kobo.251.1"> Corporation has created the </span><strong class="bold"><span class="koboSpan" id="kobo.252.1">Adversarial Tactics, Techniques, and Common Knowledge</span></strong><span class="koboSpan" id="kobo.253.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.254.1">ATT&amp;CK</span></strong><span class="koboSpan" id="kobo.255.1">) framework. </span><span class="koboSpan" id="kobo.255.2">This knowledge base addresses the tactics and techniques used by adversaries to carry out network intrusions. </span><span class="koboSpan" id="kobo.255.3">This knowledge base provides a standard syntax to describe adversary actions and normalize various pieces of evidence. </span><span class="koboSpan" id="kobo.255.4">The ATT&amp;CK knowledge base has become such a mainstay in describing adversaries that you will find it included in </span><a href="B18571_17.xhtml#_idTextAnchor304"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.256.1">Chapter 17</span></em></span></a><span class="No-Break"><span class="koboSpan" id="kobo.257.1">.</span></span></p>
<h2 id="_idParaDest-71"><a id="_idTextAnchor071"/><span class="koboSpan" id="kobo.258.1">Event deconfliction</span></h2>
<p><span class="koboSpan" id="kobo.259.1">There are also times when there are multiple events related to an adversary’s activity. </span><span class="koboSpan" id="kobo.259.2">For example, brute forcing passwords will </span><a id="_idIndexMarker400"/><span class="koboSpan" id="kobo.260.1">produce a significant number of failed login event entries. </span><span class="koboSpan" id="kobo.260.2">A brute-force attempt that records 10,000 failures should be counted as a single event. </span><span class="koboSpan" id="kobo.260.3">Instead of listing all of them, the analyst can simply record the failures during a defined time, such as between 1634 and 1654 UTC on April 10, 2022. </span><span class="koboSpan" id="kobo.260.4">In this way, the overall intent and the adversary action are known without having to include all the </span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">raw data.</span></span></p>
<h2 id="_idParaDest-72"><a id="_idTextAnchor072"/><span class="koboSpan" id="kobo.262.1">The second correlation</span></h2>
<p><span class="koboSpan" id="kobo.263.1">Now that the data has gone through</span><a id="_idIndexMarker401"/><span class="koboSpan" id="kobo.264.1"> an initial correlation and subsequent normalization and deconfliction processes, the analysts have a set of data that is then fed through a second correlation. </span><span class="koboSpan" id="kobo.264.2">This second correlation should produce a much more refined set of data points that can then be fed into the </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">next phase.</span></span></p>
<h2 id="_idParaDest-73"><a id="_idTextAnchor073"/><span class="koboSpan" id="kobo.266.1">The timeline</span></h2>
<p><span class="koboSpan" id="kobo.267.1">The one output of an incident investigation is a timeline of events. </span><span class="koboSpan" id="kobo.267.2">Now that the analysts have the incident events </span><a id="_idIndexMarker402"/><span class="koboSpan" id="kobo.268.1">normalized, deconflicted, and correlated, they should place the events in order. </span><span class="koboSpan" id="kobo.268.2">There is no specialized tool that analysts need; a simple spreadsheet or diagram can be used to craft out the sequence of events that led to the </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">network intrusion.</span></span></p>
<h2 id="_idParaDest-74"><a id="_idTextAnchor074"/><span class="koboSpan" id="kobo.270.1">Kill chain analysis</span></h2>
<p><span class="koboSpan" id="kobo.271.1">At this stage, the analyst should have the </span><a id="_idIndexMarker403"/><span class="koboSpan" id="kobo.272.1">necessary indicators extracted from the evidence, normalized and deconflicted, and in time sequence. </span><span class="koboSpan" id="kobo.272.2">The next phase is to place the IOCs and other evidence into a construct that guides the analyst through an understanding of the relationship of the events to the overall intrusion, along with the interaction between the adversary and the victim organization. </span><span class="koboSpan" id="kobo.272.3">A construct in common usage is the combination of the Lockheed Martin Cyber Kill Chain and the diamond model of intrusion analysis. </span><span class="koboSpan" id="kobo.272.4">Due to their importance, these two methods are covered in the next </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">two sections.</span></span></p>
<h2 id="_idParaDest-75"><a id="_idTextAnchor075"/><span class="koboSpan" id="kobo.274.1">Reporting</span></h2>
<p><span class="koboSpan" id="kobo.275.1">One critical piece that is often overlooked in incident investigations is the reporting piece. </span><span class="koboSpan" id="kobo.275.2">Depending on the type of</span><a id="_idIndexMarker404"/><span class="koboSpan" id="kobo.276.1"> analysis, reports can be detailed and lengthy. </span><span class="koboSpan" id="kobo.276.2">It is therefore critical to keep detailed notes of an incident analyst’s actions and observations throughout the entire process. </span><span class="koboSpan" id="kobo.276.3">It is nearly impossible to reconstruct the entire analysis after several days at the </span><span class="No-Break"><span class="koboSpan" id="kobo.277.1">very end.</span></span></p>
<p><span class="koboSpan" id="kobo.278.1">Incident reporting is often divided into three sections and each one of these addresses the concerns and questions of a specific audience. </span><span class="koboSpan" id="kobo.278.2">The first section is often the executive summary. </span><span class="koboSpan" id="kobo.278.3">This one-to-two-page summary provides a high-level overview of the incident and analysis and details what the impact was. </span><span class="koboSpan" id="kobo.278.4">This allows senior leadership to make decisions for further improvement, along with reporting findings to the board or regulatory </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">oversight bodies.</span></span></p>
<p><span class="koboSpan" id="kobo.280.1">The second section of the report is the technical details. </span><span class="koboSpan" id="kobo.280.2">In this section, the incident response analysts will cover the findings of the investigation, the timeline of the events, and the IOCs. </span><span class="koboSpan" id="kobo.280.3">Another focus of the section will be on the TTPs of the adversary. </span><span class="koboSpan" id="kobo.280.4">This is critical information for both leadership and technical personnel, as it details the sequence of events the adversary took, along with the vulnerabilities that they were able to exploit. </span><span class="koboSpan" id="kobo.280.5">This information is useful for long-term remediation to reduce the likelihood of a similar attack in </span><span class="No-Break"><span class="koboSpan" id="kobo.281.1">the future.</span></span></p>
<p><span class="koboSpan" id="kobo.282.1">The final section of the </span><a id="_idIndexMarker405"/><span class="koboSpan" id="kobo.283.1">report is the recommendations. </span><span class="koboSpan" id="kobo.283.2">As the technical section details, there are often vulnerabilities and other conditions that can be remediated, which would reduce the likelihood of a similar attack in the future. </span><span class="koboSpan" id="kobo.283.3">Detailed strategic and tactical recommendations assist the organization in prioritizing changes to the environment to strengthen </span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">its security.</span></span></p>
<p><span class="koboSpan" id="kobo.285.1">Reporting will be covered in depth later, in </span><a href="B18571_13.xhtml#_idTextAnchor220"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.286.1">Chapter 13</span></em></span></a><span class="No-Break"><span class="koboSpan" id="kobo.287.1">.</span></span></p>
<h1 id="_idParaDest-76"><a id="_idTextAnchor076"/><span class="koboSpan" id="kobo.288.1">The cyber kill chain</span></h1>
<p><span class="koboSpan" id="kobo.289.1">The timeline that </span><a id="_idIndexMarker406"/><span class="koboSpan" id="kobo.290.1">was created as part of the incident investigation provides a view into the sequence of events that the adversary took. </span><span class="koboSpan" id="kobo.290.2">This view is useful but does not have the benefit of context for the events. </span><span class="koboSpan" id="kobo.290.3">Going back to the RDP example, the analyst can point to the date and time of the connection but lacks insight into at which stage of the attack the event took place. </span><span class="koboSpan" id="kobo.290.4">One construct that provides context is placing the events into a </span><em class="italic"><span class="koboSpan" id="kobo.291.1">kill chain</span></em><span class="koboSpan" id="kobo.292.1"> that describes the sequence of events the adversary took to achieve </span><span class="No-Break"><span class="koboSpan" id="kobo.293.1">their goal.</span></span></p>
<p><span class="koboSpan" id="kobo.294.1">The military has used the concept of kill chains to a great extent to describe the process that units must execute to achieve an objective. </span><span class="koboSpan" id="kobo.294.2">One version of this concept was outlined in the United States military’s targeting doctrine of </span><strong class="bold"><span class="koboSpan" id="kobo.295.1">Find, Fix, Track, Target, Engage, Assess</span></strong><span class="koboSpan" id="kobo.296.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.297.1">F2T2EA</span></strong><span class="koboSpan" id="kobo.298.1">). </span><span class="koboSpan" id="kobo.298.2">This </span><a id="_idIndexMarker407"/><span class="koboSpan" id="kobo.299.1">process is described as a </span><em class="italic"><span class="koboSpan" id="kobo.300.1">chain</span></em><span class="koboSpan" id="kobo.301.1"> because it allows a defender to disrupt the process at any one step. </span><span class="koboSpan" id="kobo.301.2">For example, an adversary that you can </span><em class="italic"><span class="koboSpan" id="kobo.302.1">find</span></em><span class="koboSpan" id="kobo.303.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.304.1">fix</span></em><span class="koboSpan" id="kobo.305.1"> but that can slip tracking through subterfuge would go unengaged due to the chain </span><span class="No-Break"><span class="koboSpan" id="kobo.306.1">being broken.</span></span></p>
<p><span class="koboSpan" id="kobo.307.1">In the white paper </span><em class="italic"><span class="koboSpan" id="kobo.308.1">Intelligence-Driven Computer Network Defense Informed by Analysis of Adversary Campaigns and Intrusion Kill Chains</span></em><span class="koboSpan" id="kobo.309.1">, Eric Hutchins, Michael Cloppert, and Rohan Amin outlined a kill chain that specifically addressed cyber intrusions. </span><span class="koboSpan" id="kobo.309.2">In this case, the group </span><a id="_idIndexMarker408"/><span class="koboSpan" id="kobo.310.1">expanded on the existing F2T2EA model and created one that specifically addresses cyber attacks. </span><span class="koboSpan" id="kobo.310.2">At the heart of almost all network intrusions is a threat actor that must craft some form of payload, whether that is malware or another exploit, and have that payload or exploit breach perimeter defenses. </span><span class="koboSpan" id="kobo.310.3">Once inside, the adversary needs to establish persistent access with effective command and control. </span><span class="koboSpan" id="kobo.310.4">Finally, there is always some objective that must be satisfied, such as data theft or destruction. </span><span class="koboSpan" id="kobo.310.5">This chain can be seen in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.311.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.312.1">.4</span></em><span class="koboSpan" id="kobo.313.1">, which outlines the seven stages of the cyber intrusion kill chain: </span><em class="italic"><span class="koboSpan" id="kobo.314.1">Reconnaissance</span></em><span class="koboSpan" id="kobo.315.1">, </span><em class="italic"><span class="koboSpan" id="kobo.316.1">Weaponization</span></em><span class="koboSpan" id="kobo.317.1">, </span><em class="italic"><span class="koboSpan" id="kobo.318.1">Delivery</span></em><span class="koboSpan" id="kobo.319.1">, </span><em class="italic"><span class="koboSpan" id="kobo.320.1">Exploitation</span></em><span class="koboSpan" id="kobo.321.1">, </span><em class="italic"><span class="koboSpan" id="kobo.322.1">Installation</span></em><span class="koboSpan" id="kobo.323.1">, </span><em class="italic"><span class="koboSpan" id="kobo.324.1">Command and Control</span></em><span class="koboSpan" id="kobo.325.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.326.1">Actions </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.327.1">on Objectives</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.328.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer035">
<span class="koboSpan" id="kobo.329.1"><img alt="" src="image/Image_B18571_04_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.330.1">Figure 4.4 – The cyber kill chain</span></p>
<p><span class="koboSpan" id="kobo.331.1">The first stage of the cyber kill chain is the </span><em class="italic"><span class="koboSpan" id="kobo.332.1">Reconnaissance</span></em><span class="koboSpan" id="kobo.333.1"> phase. </span><span class="koboSpan" id="kobo.333.2">On the surface, this stage may appear to simply be the</span><a id="_idIndexMarker409"/><span class="koboSpan" id="kobo.334.1"> identification of and initial information gathering about a target. </span><span class="koboSpan" id="kobo.334.2">The Reconnaissance phase involves a good deal more. </span><span class="koboSpan" id="kobo.334.3">It is best to think of this phase as the preparatory phase of the entire intrusion or campaign. </span><span class="koboSpan" id="kobo.334.4">For example, a nation-state APT group does not choose its targets. </span><span class="koboSpan" id="kobo.334.5">Rather, targets are selected for them by a command authority, such as a nation’s state intelligence service. </span><span class="koboSpan" id="kobo.334.6">This focuses their reconnaissance against their target. </span><span class="koboSpan" id="kobo.334.7">Other groups such as those involved in ransomware attacks will often perform an initial round of reconnaissance against internet-connected organizations to see whether they are able to find a vulnerable target. </span><span class="koboSpan" id="kobo.334.8">One a vulnerable target is identified, they will then conduct a more focused reconnaissance. </span></p>
<p><span class="koboSpan" id="kobo.335.1">This stage also involves the acquisition of tools and infrastructure needed to carry out the intrusion. </span><span class="koboSpan" id="kobo.335.2">This can include the coding of exploits, registering domains, and configuring command-and-control infrastructure. </span><span class="koboSpan" id="kobo.335.3">To target a specific organization, the group may also </span><a id="_idIndexMarker410"/><span class="koboSpan" id="kobo.336.1">compromise a third party as part of the overall intrusion. </span><span class="koboSpan" id="kobo.336.2">A perfect example of this was the Solar Winds compromise, where it is suspected that an APT group associated with the Russian SVR compromised the software manufacturer to carry out attacks on </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">their customers.</span></span></p>
<p><span class="koboSpan" id="kobo.338.1">Once the backend infrastructure is configured, the group will then conduct their reconnaissance of the target. </span><span class="koboSpan" id="kobo.338.2">This reconnaissance can be broken into two major categories. </span><span class="koboSpan" id="kobo.338.3">The first is a technical focus where the threat actor will leverage software tools to footprint the target’s infrastructure, including IP address spaces, domains, and software visible to the internet. </span><span class="koboSpan" id="kobo.338.4">This technical focus can also go even deeper, where threat actors research vulnerabilities in software that they have identified during </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">their reconnaissance.</span></span></p>
<p><span class="koboSpan" id="kobo.340.1">A second focus will often be the organization and employees. </span><span class="koboSpan" id="kobo.340.2">One common way that threat actors will gain access to the internal network is through phishing attacks. </span><span class="koboSpan" id="kobo.340.3">Understanding the target’s primary</span><a id="_idIndexMarker411"/><span class="koboSpan" id="kobo.341.1"> business or function along with the key players can help them craft emails or other phishing schemes that appear legitimate. </span><span class="koboSpan" id="kobo.341.2">For example, identifying a key person in the account-receivable department of the target organization may help the threat actor craft an email that appears legitimate to a target employee. </span><span class="koboSpan" id="kobo.341.3">This can be enhanced further with an understanding of specific products or services an organization offers through an examination of business documents that are made public or descriptions on the </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">target’s website.</span></span></p>
<p><span class="koboSpan" id="kobo.343.1">It can be very difficult to determine the specifics behind reconnaissance activity when conducting an intrusion investigation. </span><span class="koboSpan" id="kobo.343.2">First, much of the reconnaissance will not touch the target’s network or infrastructure. </span><span class="koboSpan" id="kobo.343.3">For example, domain records can be accessed by anyone. </span><span class="koboSpan" id="kobo.343.4">Searches of social media profiles on sites such as LinkedIn are not visible to the defenders or the analysts. </span><span class="koboSpan" id="kobo.343.5">Second, it is next to impossible to identify a threat actor’s IP address from the thousands that may have connected to the target’s website in the past 24 hours. </span><span class="koboSpan" id="kobo.343.6">Finally, the tasking and any other preparation take place outside the view of any network defender and may only be visible during a post-incident </span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">intrusion analysis.</span></span></p>
<p><span class="koboSpan" id="kobo.345.1">The next stage of the kill </span><a id="_idIndexMarker412"/><span class="koboSpan" id="kobo.346.1">chain is the </span><em class="italic"><span class="koboSpan" id="kobo.347.1">Weaponization</span></em><span class="koboSpan" id="kobo.348.1"> phase. </span><span class="koboSpan" id="kobo.348.2">During this phase, the adversary configures their malware or another exploit. </span><span class="koboSpan" id="kobo.348.3">For example, this may be repurposing a banking trojan such as </span><strong class="bold"><span class="koboSpan" id="kobo.349.1">Dridex</span></strong><span class="koboSpan" id="kobo.350.1">, as is </span><a id="_idIndexMarker413"/><span class="koboSpan" id="kobo.351.1">often seen in ransomware attacks. </span><span class="koboSpan" id="kobo.351.2">In other instances, Weaponization may be a long process in which custom malware is crafted for a specific purpose, as was seen with the Stuxnet malware. </span><span class="koboSpan" id="kobo.351.3">Weaponization also includes the packaging of the malware into a container such as a PDF or Microsoft Word document. </span><span class="koboSpan" id="kobo.351.4">For </span><a id="_idIndexMarker414"/><span class="koboSpan" id="kobo.352.1">example, a malicious script that serves as the first stage of an intrusion may be packaged into a </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">Word document.</span></span></p>
<p><span class="koboSpan" id="kobo.354.1">Much like the first phase, Weaponization takes place outside the view of the defender. </span><span class="koboSpan" id="kobo.354.2">The important aspect of analyzing the Weaponization stage of an intrusion is that the analyst will often gain insight into an activity that took place days, weeks, or even months ago when the adversary was crafting their exploit </span><span class="No-Break"><span class="koboSpan" id="kobo.355.1">or malware.</span></span></p>
<p><span class="koboSpan" id="kobo.356.1">The third phase of the kill chain is the </span><em class="italic"><span class="koboSpan" id="kobo.357.1">Delivery</span></em><span class="koboSpan" id="kobo.358.1"> of the </span><a id="_idIndexMarker415"/><span class="koboSpan" id="kobo.359.1">exploit or malware into the defender’s environment. </span><span class="koboSpan" id="kobo.359.2">Delivery methods vary from the tried-and-true phishing emails to drive-by downloads and even the use of physical devices such as USBs. </span><span class="koboSpan" id="kobo.359.3">For analysts, understanding the root cause of an incident is an important part of the chain. </span><span class="koboSpan" id="kobo.359.4">Successful delivery of a payload may be indicative of a failure of some security controls to detect and prevent </span><span class="No-Break"><span class="koboSpan" id="kobo.360.1">the action.</span></span></p>
<p><span class="koboSpan" id="kobo.361.1">Nearly all successful intrusion involves the exploitation of vulnerabilities. </span><span class="koboSpan" id="kobo.361.2">This can be a vulnerability in the human element that makes phishing attacks successful. </span><span class="koboSpan" id="kobo.361.3">In other circumstances, this can be a software</span><a id="_idIndexMarker416"/><span class="koboSpan" id="kobo.362.1"> vulnerability, including the feared zero-day. </span><span class="koboSpan" id="kobo.362.2">In either case, the fourth phase of the kill chain is </span><em class="italic"><span class="koboSpan" id="kobo.363.1">Exploitation</span></em><span class="koboSpan" id="kobo.364.1">. </span><span class="koboSpan" id="kobo.364.2">At this stage, the adversary exploits a vulnerability in the software, the human, or a combination of both. </span><span class="koboSpan" id="kobo.364.3">For example, an adversary can identify a vulnerability within the Microsoft IIS application that they are able to exploit with shell code. </span><span class="koboSpan" id="kobo.364.4">In some intrusions, multiple exploits against vulnerabilities are used in a loop until the adversary can fully exploit the system or systems. </span><span class="koboSpan" id="kobo.364.5">For example, an attacker crafts a phishing email directed at an employee in accounts payable. </span><span class="koboSpan" id="kobo.364.6">This email contains an</span><a id="_idIndexMarker417"/><span class="koboSpan" id="kobo.365.1"> Excel workbook that contains a </span><strong class="bold"><span class="koboSpan" id="kobo.366.1">Visual Basic for Applications</span></strong><span class="koboSpan" id="kobo.367.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.368.1">VBA</span></strong><span class="koboSpan" id="kobo.369.1">) script. </span><span class="koboSpan" id="kobo.369.2">The first exploitation occurs when the individual opens the email and then the Excel spreadsheet. </span><span class="koboSpan" id="kobo.369.3">The next exploitation leverages the inherent vulnerability of Excel to execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.370.1">VBA script.</span></span></p>
<p><span class="koboSpan" id="kobo.371.1">So far in the analysis of the kill chain, the adversary has conducted a reconnaissance of the target, crafted their exploit or malware, and then delivered them to the target. </span><span class="koboSpan" id="kobo.371.2">Leveraging any number of vulnerabilities, they were able to gain an initial foothold into the target network. </span><span class="koboSpan" id="kobo.371.3">The </span><a id="_idIndexMarker418"/><span class="koboSpan" id="kobo.372.1">next stage is to maintain some sort of persistence. </span><span class="koboSpan" id="kobo.372.2">This is where the next stage of the kill chain, </span><em class="italic"><span class="koboSpan" id="kobo.373.1">Installation</span></em><span class="koboSpan" id="kobo.374.1">, comes </span><span class="No-Break"><span class="koboSpan" id="kobo.375.1">into play.</span></span></p>
<p><span class="koboSpan" id="kobo.376.1">The initial infection of a system does not give the adversary the necessary long-term persistence that is needed for an extended intrusion. </span><span class="koboSpan" id="kobo.376.2">Even attacks such as ransomware require an adversary to</span><a id="_idIndexMarker419"/><span class="koboSpan" id="kobo.377.1"> have long-term access to the network for network discovery and to move laterally throughout. </span><span class="koboSpan" id="kobo.377.2">In the </span><em class="italic"><span class="koboSpan" id="kobo.378.1">Installation</span></em><span class="koboSpan" id="kobo.379.1"> phase, the adversary installs files on the system, makes changes to the registry to survive a reboot, or sets up more persistent mechanisms, such as a backdoor. </span><span class="koboSpan" id="kobo.379.2">One aspect to keep in mind when looking at the </span><em class="italic"><span class="koboSpan" id="kobo.380.1">Installation</span></em><span class="koboSpan" id="kobo.381.1"> stage is that not all actions will leave traces on the disk. </span><span class="koboSpan" id="kobo.381.2">There are tools that are leveraged by adversaries that limit the evidence left by running entirely in memory or remaining hidden by not communicating with any </span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">external resources.</span></span></p>
<p><span class="koboSpan" id="kobo.383.1">Once the adversary can establish their persistence, they need to be able to interact with the compromised systems. </span><span class="koboSpan" id="kobo.383.2">This is where </span><a id="_idIndexMarker420"/><span class="koboSpan" id="kobo.384.1">phase six, </span><em class="italic"><span class="koboSpan" id="kobo.385.1">Command and Control</span></em><span class="koboSpan" id="kobo.386.1">, comes into play. </span><span class="koboSpan" id="kobo.386.2">In this stage, the adversary establishes and maintains network connectivity with the compromised systems. </span><span class="koboSpan" id="kobo.386.3">For example, post-exploitation frameworks such as Metasploit and Cobalt Strike allow an adversary to communicate and execute commands on </span><span class="No-Break"><span class="koboSpan" id="kobo.387.1">impacted systems.</span></span></p>
<p><span class="koboSpan" id="kobo.388.1">The final stage, </span><em class="italic"><span class="koboSpan" id="kobo.389.1">Actions on Objectives</span></em><span class="koboSpan" id="kobo.390.1">, is where the</span><a id="_idIndexMarker421"/><span class="koboSpan" id="kobo.391.1"> adversary executes actions after they have effective control of the system. </span><span class="koboSpan" id="kobo.391.2">These actions can vary from sniffing network data for credit cards to the theft of intellectual property. </span><span class="koboSpan" id="kobo.391.3">In some instances, there may be multiple actions that take place. </span><span class="koboSpan" id="kobo.391.4">A sophisticated cybercriminal may gain access to a network and exfiltrate data over a day. </span><span class="koboSpan" id="kobo.391.5">Then, as they are completing their intrusion, they encrypt the systems with ransomware. </span><span class="koboSpan" id="kobo.391.6">The important consideration at the last stage is to include actions that take place after command and control has </span><span class="No-Break"><span class="koboSpan" id="kobo.392.1">been established.</span></span></p>
<h1 id="_idParaDest-77"><a id="_idTextAnchor077"/><span class="koboSpan" id="kobo.393.1">The diamond model of intrusion analysis</span></h1>
<p><span class="koboSpan" id="kobo.394.1">The cyber kill chain provides a</span><a id="_idIndexMarker422"/><span class="koboSpan" id="kobo.395.1"> construct to place adversarial action in the proper stages of an intrusion. </span><span class="koboSpan" id="kobo.395.2">Going deeper requires examining the relationship between the adversary and the victim organization. </span><span class="koboSpan" id="kobo.395.3">The </span><em class="italic"><span class="koboSpan" id="kobo.396.1">diamond model of intrusion analysis</span></em><span class="koboSpan" id="kobo.397.1"> provides </span><a id="_idIndexMarker423"/><span class="koboSpan" id="kobo.398.1">an approach that considers much more detail than the cyber kill chain’s phases. </span><span class="koboSpan" id="kobo.398.2">The diamond model was first created by Sergio Caltagirone, Andrew Pendergast, and Christopher Betz in the white paper </span><em class="italic"><span class="koboSpan" id="kobo.399.1">The Diamond Model of Intrusion Analysis</span></em><span class="koboSpan" id="kobo.400.1">. </span><span class="koboSpan" id="kobo.400.2">A simple way to understand the diamond model is this: </span><em class="italic"><span class="koboSpan" id="kobo.401.1">an adversary deploys a capability over some infrastructure against a victim. </span><span class="koboSpan" id="kobo.401.2">These activities are</span></em><em class="italic"><a id="_idIndexMarker424"/></em><em class="italic"><span class="koboSpan" id="kobo.402.1"> called events and are the atomic features</span></em><span class="koboSpan" id="kobo.403.1">. </span><span class="koboSpan" id="kobo.403.2">What this model does is uncover the relationship between the adversary and the victim and attempt to determine the tools and techniques used to accomplish the </span><span class="No-Break"><span class="koboSpan" id="kobo.404.1">adversary’s goal.</span></span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.405.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.406.1">.5</span></em><span class="koboSpan" id="kobo.407.1"> visualizes the basic structure of the diamond model with the following four vertices: </span><em class="italic"><span class="koboSpan" id="kobo.408.1">Adversary</span></em><span class="koboSpan" id="kobo.409.1">, </span><em class="italic"><span class="koboSpan" id="kobo.410.1">Capability</span></em><span class="koboSpan" id="kobo.411.1">, </span><em class="italic"><span class="koboSpan" id="kobo.412.1">Victim</span></em><span class="koboSpan" id="kobo.413.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.414.1">Infrastructure</span></em><span class="koboSpan" id="kobo.415.1">. </span><span class="koboSpan" id="kobo.415.2">In addition to the four vertices, there are also five </span><a id="_idIndexMarker425"/><span class="koboSpan" id="kobo.416.1">relationships: </span><em class="italic"><span class="koboSpan" id="kobo.417.1">Uses</span></em><span class="koboSpan" id="kobo.418.1">, </span><em class="italic"><span class="koboSpan" id="kobo.419.1">Develops</span></em><span class="koboSpan" id="kobo.420.1">, </span><em class="italic"><span class="koboSpan" id="kobo.421.1">Exploits</span></em><span class="koboSpan" id="kobo.422.1">, </span><em class="italic"><span class="koboSpan" id="kobo.423.1">Connects To</span></em><span class="koboSpan" id="kobo.424.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.425.1">Deploys</span></em><span class="koboSpan" id="kobo.426.1">. </span><span class="koboSpan" id="kobo.426.2">Coupled together, these provide the foundation for describing the relationship of the </span><span class="No-Break"><span class="koboSpan" id="kobo.427.1">four vertices.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer036">
<span class="koboSpan" id="kobo.428.1"><img alt="" src="image/Image_B18571_04_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.429.1">Figure 4.5 – The diamond model</span></p>
<p><span class="koboSpan" id="kobo.430.1">The </span><em class="italic"><span class="koboSpan" id="kobo.431.1">Adversary</span></em><span class="koboSpan" id="kobo.432.1"> vertex describes any information or data concerning the perpetrators of the intrusion activity. </span><span class="koboSpan" id="kobo.432.2">This can be either a group or an individual, which can be further broken down into whether the </span><a id="_idIndexMarker426"/><span class="koboSpan" id="kobo.433.1">adversary is an operator or customer. </span><span class="koboSpan" id="kobo.433.2">An adversary that is defined as a customer is an individual or group that will benefit from the activity. </span><span class="koboSpan" id="kobo.433.3">Sophisticated cyber threat actors will often leverage task division in which one group conducts a specific task. </span><span class="koboSpan" id="kobo.433.4">For example, a malware coder working as part of a ransomware gang would fall into this category. </span><span class="koboSpan" id="kobo.433.5">The customer for the output of this activity can be thought of as a customer. </span><span class="koboSpan" id="kobo.433.6">In other circumstances, an operator can be a lone individual who is conducting their own activities independent of anyone else that will </span><span class="No-Break"><span class="koboSpan" id="kobo.434.1">directly benefit.</span></span></p>
<p><span class="koboSpan" id="kobo.435.1">Data about adversaries can include online personas, such as social media identifiers or email addresses. </span><span class="koboSpan" id="kobo.435.2">In other circumstances, intent or motivation can be brought into the Adversary vertex. </span><span class="koboSpan" id="kobo.435.3">It should be noted that while the intent may be very simple, such as a financially motivated ransomware </span><a id="_idIndexMarker427"/><span class="koboSpan" id="kobo.436.1">attack, in other circumstances, determining the motivation from a single intrusion may </span><span class="No-Break"><span class="koboSpan" id="kobo.437.1">be difficult.</span></span></p>
<p><span class="koboSpan" id="kobo.438.1">The next vertex, </span><em class="italic"><span class="koboSpan" id="kobo.439.1">Capability</span></em><span class="koboSpan" id="kobo.440.1">, describes what tools and tradecraft the adversary can leverage. </span><span class="koboSpan" id="kobo.440.2">The challenge with regards to Capability is that there is a wide spectrum in terms of tools and tradecraft. </span><span class="koboSpan" id="kobo.440.3">For example, a novice adversary may use scripts and well-known hacking tools such as Metasploit or Cobalt Strike to carry out an attack that takes a low degree of skill or experience. </span><span class="koboSpan" id="kobo.440.4">On the other side of the spectrum are the APT groups that can craft custom</span><a id="_idIndexMarker428"/><span class="koboSpan" id="kobo.441.1"> malware that exploits zero-day exploits and that can remain undetected for months or </span><span class="No-Break"><span class="koboSpan" id="kobo.442.1">even years.</span></span></p>
<p><span class="koboSpan" id="kobo.443.1">When discussing Capability, it is important to consider two facets. </span><span class="koboSpan" id="kobo.443.2">First, when discussing tools, keep in mind what falls into the tool category. </span><span class="koboSpan" id="kobo.443.3">Malware is easily categorized as a tool but what about legitimate tools? </span><span class="koboSpan" id="kobo.443.4">For example, PowerShell alone does not represent a capability but using PowerShell to execute an encoded script that downloads a secondary payload would. </span><span class="koboSpan" id="kobo.443.5">The adversary’s goal or intent has a direct impact on what can be considered a capability. </span><span class="koboSpan" id="kobo.443.6">If the tool’s usage furthers this intent, it should be identified as </span><span class="No-Break"><span class="koboSpan" id="kobo.444.1">a capability.</span></span></p>
<p><span class="koboSpan" id="kobo.445.1">Second, despite their sophistication, adversaries will often leverage a few patterns. </span><span class="koboSpan" id="kobo.445.2">For example, an adversary may use a combination of phishing emails and malicious scripts to establish a foothold on a system. </span><span class="koboSpan" id="kobo.445.3">Once a C2 link has been established, you may see commands such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.446.1">whoami.exe</span></strong><span class="koboSpan" id="kobo.447.1"> in a specific order. </span><span class="koboSpan" id="kobo.447.2">It is important to make note of such activity, even though it may </span><span class="No-Break"><span class="koboSpan" id="kobo.448.1">seem mundane.</span></span></p>
<p><span class="koboSpan" id="kobo.449.1">The next vertex is </span><em class="italic"><span class="koboSpan" id="kobo.450.1">Infrastructure</span></em><span class="koboSpan" id="kobo.451.1">. </span><span class="koboSpan" id="kobo.451.2">One aspect of threat actors that often gets lost in the sensationalism and mysticism surrounding the dreaded hacker or APT is this: threat actors are bound by the same constraints of software, hardware, and technology that everyone else is. </span><span class="koboSpan" id="kobo.451.3">They do not exist outside the four corners of technology and thus must operate as we all do. </span><span class="koboSpan" id="kobo.451.4">This is where Infrastructure comes into play. </span><span class="koboSpan" id="kobo.451.5">In this context, Infrastructure refers to a physical or logical mechanism that the adversary uses to deploy their tools or tradecraft. </span><span class="koboSpan" id="kobo.451.6">For example, an adversary may leverage public cloud computing</span><a id="_idIndexMarker429"/><span class="koboSpan" id="kobo.452.1"> resources, such as </span><strong class="bold"><span class="koboSpan" id="kobo.453.1">Amazon Web Services</span></strong><span class="koboSpan" id="kobo.454.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.455.1">AWS</span></strong><span class="koboSpan" id="kobo.456.1">) or Digital Ocean. </span><span class="koboSpan" id="kobo.456.2">From here, they can configure a Cobalt Strike C2 server. </span><span class="koboSpan" id="kobo.456.3">From an analysis, the IP address or domain registration for this server would serve as a data point under the </span><span class="No-Break"><span class="koboSpan" id="kobo.457.1">infrastructure vertex.</span></span></p>
<p><span class="koboSpan" id="kobo.458.1">In </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.459.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.460.1">.6</span></em><span class="koboSpan" id="kobo.461.1">, we have a visualization of the relationship between the four vertices. </span><span class="koboSpan" id="kobo.461.2">The </span><em class="italic"><span class="koboSpan" id="kobo.462.1">Adversary</span></em><span class="koboSpan" id="kobo.463.1"> develops some capability, indicated by </span><em class="italic"><span class="koboSpan" id="kobo.464.1">1</span></em><span class="koboSpan" id="kobo.465.1">, and deploys that capability over an Infrastructure, indicated by </span><em class="italic"><span class="koboSpan" id="kobo.466.1">2</span></em><span class="koboSpan" id="kobo.467.1">, and finally</span><a id="_idIndexMarker430"/><span class="koboSpan" id="kobo.468.1"> connects to the victim, indicated by </span><em class="italic"><span class="koboSpan" id="kobo.469.1">3</span></em><span class="koboSpan" id="kobo.470.1">. </span><span class="koboSpan" id="kobo.470.2">When discussing the </span><em class="italic"><span class="koboSpan" id="kobo.471.1">Victim</span></em><span class="koboSpan" id="kobo.472.1"> vertex, it can be broken down into either an individual or an organization. </span><span class="koboSpan" id="kobo.472.2">Phishing attacks may target a single individual or may be directed at the organization at large. </span><span class="koboSpan" id="kobo.472.3">Adversary capabilities </span><a id="_idIndexMarker431"/><span class="koboSpan" id="kobo.473.1">and infrastructure can also be directed at humans or systems. </span><span class="koboSpan" id="kobo.473.2">The diamond model delineates the human</span><a id="_idIndexMarker432"/><span class="koboSpan" id="kobo.474.1"> victim as an </span><strong class="bold"><span class="koboSpan" id="kobo.475.1">Entity</span></strong><span class="koboSpan" id="kobo.476.1"> and the system component </span><a id="_idIndexMarker433"/><span class="koboSpan" id="kobo.477.1">as </span><span class="No-Break"><span class="koboSpan" id="kobo.478.1">an </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.479.1">Asset</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.480.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer037">
<span class="koboSpan" id="kobo.481.1"><img alt="" src="image/Image_B18571_04_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.482.1">Figure 4.6 – The diamond model relationship</span></p>
<p><span class="koboSpan" id="kobo.483.1">Let’s look at a real-world example where we can express the </span><em class="italic"><span class="koboSpan" id="kobo.484.1">Adversary/Victim</span></em><span class="koboSpan" id="kobo.485.1"> relationship in the diamond model in the context of the execution of a real-world attack. </span><span class="koboSpan" id="kobo.485.2">In this case, we will go ahead and look at an example of a </span><em class="italic"><span class="koboSpan" id="kobo.486.1">Drive-By Compromise</span></em><span class="koboSpan" id="kobo.487.1"> malware delivery technique (T1189 found in the MITRE ATT&amp;CK framework at </span><a href="https://attack.mitre.org/techniques/T1189/"><span class="koboSpan" id="kobo.488.1">https://attack.mitre.org/techniques/T1189/</span></a><span class="koboSpan" id="kobo.489.1">). </span><span class="koboSpan" id="kobo.489.2">In this example, the adversary has set up a website that appears legitimate. </span><span class="koboSpan" id="kobo.489.3">When the site is accessed, the adversary then delivers malicious JavaScript that attempts to exploit a vulnerability in common </span><span class="No-Break"><span class="koboSpan" id="kobo.490.1">internet browsers.</span></span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.491.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.492.1">.7</span></em><span class="koboSpan" id="kobo.493.1"> shows the potential data points that can be extracted during an analysis of the attack. </span><span class="koboSpan" id="kobo.493.2">In this case, we will look at the </span><em class="italic"><span class="koboSpan" id="kobo.494.1">Delivery</span></em><span class="koboSpan" id="kobo.495.1"> phase of the cyber kill chain, which denotes how the adversary will deliver their exploit. </span><span class="koboSpan" id="kobo.495.2">In this case, the adversary leveraged internal capabilities (</span><em class="italic"><span class="koboSpan" id="kobo.496.1">1</span></em><span class="koboSpan" id="kobo.497.1">) to configure a website with the functionality to deliver malicious JavaScript. </span><span class="koboSpan" id="kobo.497.2">Some adversaries have been known to use the Java-based profiler </span><strong class="source-inline"><span class="koboSpan" id="kobo.498.1">RICECURRY</span></strong><span class="koboSpan" id="kobo.499.1"> to determine what vulnerabilities web browsers have and exploit them based on this data. </span><span class="koboSpan" id="kobo.499.2">After </span><a id="_idIndexMarker434"/><span class="koboSpan" id="kobo.500.1">crafting the specific malware delivery mechanism, the infrastructure is configured to host the malicious site. </span><span class="koboSpan" id="kobo.500.2">In this case, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.501.1">badsite.com</span></strong><span class="koboSpan" id="kobo.502.1"> domain (</span><em class="italic"><span class="koboSpan" id="kobo.503.1">2</span></em><span class="koboSpan" id="kobo.504.1">) and the corresponding hosting provider can be included. </span><span class="koboSpan" id="kobo.504.2">Once a victim navigates to the site via a</span><a id="_idIndexMarker435"/><span class="koboSpan" id="kobo.505.1"> browser, they become infected. </span><span class="koboSpan" id="kobo.505.2">In this case, the victim can be represented as a system name (</span><em class="italic"><span class="koboSpan" id="kobo.506.1">3</span></em><span class="koboSpan" id="kobo.507.1">), in this case, </span><strong class="source-inline"><span class="koboSpan" id="kobo.508.1">Lt0769.acme.local</span></strong><span class="koboSpan" id="kobo.509.1">. </span><span class="koboSpan" id="kobo.509.2">Depending on the analysis team’s ability, they may be able to trace the attack to the specific domain that was used as the watering hole attack. </span><span class="koboSpan" id="kobo.509.3">A review of the WHOIS registration information may provide details such as the email address (</span><em class="italic"><span class="koboSpan" id="kobo.510.1">4</span></em><span class="koboSpan" id="kobo.511.1">) that the adversary used to register </span><span class="No-Break"><span class="koboSpan" id="kobo.512.1">the site.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer038">
<span class="koboSpan" id="kobo.513.1"><img alt="" src="image/Image_B18571_04_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.514.1">Figure 4.7 – An example of the diamond model</span></p>
<p><span class="koboSpan" id="kobo.515.1">The diamond model serves as a good construct to show the relationship between the adversary, their capabilities and infrastructure, and the victim. </span><span class="koboSpan" id="kobo.515.2">What is required is the data in which to draw these relationships. </span><span class="koboSpan" id="kobo.515.3">The ability to leverage this construct is dependent on the ability to locate these data points and augment them with external data to map these relationships out. </span><span class="koboSpan" id="kobo.515.4">Regardless of whether or not the victim has this data, the following axioms apply directly to </span><span class="No-Break"><span class="koboSpan" id="kobo.516.1">every intrusion.</span></span></p>
<p><span class="koboSpan" id="kobo.517.1">The diamond model’s utility is derived from how it defines the relationship with each vertex. </span><span class="koboSpan" id="kobo.517.2">This provides a</span><a id="_idIndexMarker436"/><span class="koboSpan" id="kobo.518.1"> context to the overall event, as opposed to just seeing an IP address in the firewall logs. </span><span class="koboSpan" id="kobo.518.2">Digging deeper into that data point has the potential to uncover the infrastructure the adversary uses, its tools, and its capability. </span><span class="koboSpan" id="kobo.518.3">In addition to the construct, the authors of the diamond model have also defined several axioms to keep </span><span class="No-Break"><span class="koboSpan" id="kobo.519.1">in mind.</span></span></p>
<h2 id="_idParaDest-78"><a id="_idTextAnchor078"/><span class="koboSpan" id="kobo.520.1">Diamond model axioms</span></h2>
<p><strong class="bold"><span class="koboSpan" id="kobo.521.1">Axiom 1</span></strong><span class="koboSpan" id="kobo.522.1">: </span><em class="italic"><span class="koboSpan" id="kobo.523.1">For every intrusion event there exists an adversary taking a step towards an intended goal by using a capability over infrastructure against a victim to produce a result</span></em><span class="koboSpan" id="kobo.524.1">. </span><span class="koboSpan" id="kobo.524.2">This is the heart of the </span><a id="_idIndexMarker437"/><span class="koboSpan" id="kobo.525.1">diamond model. </span><span class="koboSpan" id="kobo.525.2">The previous discussion of how indicators of compromise related to each other in the model is represented by this axiom. </span><span class="koboSpan" id="kobo.525.3">The key here is that the adversary has a goal, whether that is to access confidential data or to deploy ransomware into </span><span class="No-Break"><span class="koboSpan" id="kobo.526.1">the environment.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.527.1">Axiom 2</span></strong><span class="koboSpan" id="kobo.528.1">: </span><em class="italic"><span class="koboSpan" id="kobo.529.1">There exists a set of adversaries (insiders, outsiders, individuals, groups, and organizations) that seek to compromise computer systems or networks to further their intent and satisfy their needs</span></em><span class="koboSpan" id="kobo.530.1">. </span><span class="koboSpan" id="kobo.530.2">The second axiom builds upon the key point found in the first axiom, which is that the adversary has a goal. </span><span class="koboSpan" id="kobo.530.3">The second axiom also relates to the previous discussion about the various levels of digital investigation. </span><span class="koboSpan" id="kobo.530.4">A root-cause analysis attempts to answer the </span><em class="italic"><span class="koboSpan" id="kobo.531.1">how</span></em><span class="koboSpan" id="kobo.532.1"> of an intrusion. </span><span class="koboSpan" id="kobo.532.2">An intrusion analysis attempts to answer the question </span><span class="No-Break"><span class="koboSpan" id="kobo.533.1">of </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.534.1">why</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.535.1">.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.536.1">Axiom 3</span></strong><span class="koboSpan" id="kobo.537.1">: </span><em class="italic"><span class="koboSpan" id="kobo.538.1">Every system, and by extension every victim asset, has vulnerabilities and exposures</span></em><span class="koboSpan" id="kobo.539.1">. </span><span class="koboSpan" id="kobo.539.2">It is often repeated that the only secure system is one that is turned off. </span><span class="koboSpan" id="kobo.539.3">Every system has vulnerabilities and exposures that an adversary can exploit. </span><span class="koboSpan" id="kobo.539.4">These vulnerabilities can manifest themselves as features within the operating system that an adversary exploits, such as the ability to dump the </span><strong class="source-inline"><span class="koboSpan" id="kobo.540.1">LSASS.exe</span></strong><span class="koboSpan" id="kobo.541.1"> process from memory, and access to credentials. </span><span class="koboSpan" id="kobo.541.2">Of course, there is also the dreaded zero-day vulnerability, which is exploited before it is </span><span class="No-Break"><span class="koboSpan" id="kobo.542.1">even identified.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.543.1">Axiom 4</span></strong><span class="koboSpan" id="kobo.544.1">: </span><em class="italic"><span class="koboSpan" id="kobo.545.1">Every malicious activity contains two or more phases that must be successfully executed in succession to achieve the desired result</span></em><span class="koboSpan" id="kobo.546.1">. </span><span class="koboSpan" id="kobo.546.2">An adversary may attempt to deploy the first-stage malware against an infrastructure but if the system’s antimalware protection blocks the execution of the malware, the model is incomplete and therefore no compromise has </span><span class="No-Break"><span class="koboSpan" id="kobo.547.1">taken place.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.548.1">Axiom 5</span></strong><span class="koboSpan" id="kobo.549.1">: </span><em class="italic"><span class="koboSpan" id="kobo.550.1">Every intrusion event requires one or more external resources to be satisfied prior to success</span></em><span class="koboSpan" id="kobo.551.1">. </span><span class="koboSpan" id="kobo.551.2">Keep in mind that the adversary is bound to the same rules and protocols as their target organization. </span><span class="koboSpan" id="kobo.551.3">There is no magical set of adversary tradecraft and tools that they use. </span><span class="koboSpan" id="kobo.551.4">In an intrusion, the adversary has to configure a C2 infrastructure, aggregate their tools, register domains, and host malware delivery platforms. </span><span class="koboSpan" id="kobo.551.5">These are all data </span><a id="_idIndexMarker438"/><span class="koboSpan" id="kobo.552.1">points that should be incorporated into any intrusion analysis to gain as complete a picture of the adversary </span><span class="No-Break"><span class="koboSpan" id="kobo.553.1">as possible.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.554.1">Axiom 6</span></strong><span class="koboSpan" id="kobo.555.1">: </span><em class="italic"><span class="koboSpan" id="kobo.556.1">A relationship always exists between the Adversary and their Victim(s) even if distant, fleeting, or indirect</span></em><span class="koboSpan" id="kobo.557.1">. </span><span class="koboSpan" id="kobo.557.2">A concept that is often used in the investigation of criminal activity is victimology or the study of the victim. </span><span class="koboSpan" id="kobo.557.3">Specifically, investigators look at the aspects of the victim, their personality, habits, and lifestyle to determine why they were selected for victimization. </span><span class="koboSpan" id="kobo.557.4">The same thought process can be applied to intrusion analysis. </span><span class="koboSpan" id="kobo.557.5">Whether or not the adversary compromised a web server to mine bitcoin or conducted a months-long intrusion to gain access to confidential data, the adversary has a goal. </span><span class="koboSpan" id="kobo.557.6">This behavior creates </span><span class="No-Break"><span class="koboSpan" id="kobo.558.1">a relationship.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.559.1">Axiom 7</span></strong><span class="koboSpan" id="kobo.560.1">: </span><em class="italic"><span class="koboSpan" id="kobo.561.1">There exists a sub-set of the set of adversaries that have the motivation, resources, and capabilities to sustain malicious effects for a significant length of time against one or more victims while resisting mitigation efforts</span></em><span class="koboSpan" id="kobo.562.1">. </span><span class="koboSpan" id="kobo.562.2">The previous axiom set up the adversary-victim relationship. </span><span class="koboSpan" id="kobo.562.3">Some of these are short in duration, as with a ransomware case where the victim was able to recover. </span><span class="koboSpan" id="kobo.562.4">In other cases, the adversary is able to maintain access to the network despite the victim’s attempts to remove them. </span><span class="koboSpan" id="kobo.562.5">This type of</span><a id="_idIndexMarker439"/><span class="koboSpan" id="kobo.563.1"> relationship is often referred to as a </span><strong class="bold"><span class="koboSpan" id="kobo.564.1">persistent adversary relationship</span></strong><span class="koboSpan" id="kobo.565.1">. </span><span class="koboSpan" id="kobo.565.2">This is the APT that is often discussed in relation to nation states and well-funded adversaries. </span><span class="koboSpan" id="kobo.565.3">In these cases, the adversary can maintain access for a long period of time and take steps to maintain that persistence, even as the victim tries to </span><span class="No-Break"><span class="koboSpan" id="kobo.566.1">remove them.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.567.1">Corollary</span></strong><span class="koboSpan" id="kobo.568.1">: </span><em class="italic"><span class="koboSpan" id="kobo.569.1">There exists varying degrees of adversary persistence predicated on the fundamentals of the Adversary-Victim relationship</span></em><span class="koboSpan" id="kobo.570.1">. </span><span class="koboSpan" id="kobo.570.2">Again, the victim-adversary relationship, along with the goal of the adversary, will dictate the adversary-victim relationship. </span><span class="koboSpan" id="kobo.570.3">The point is that for each intrusion, this relationship </span><span class="No-Break"><span class="koboSpan" id="kobo.571.1">is unique.</span></span></p>
<h2 id="_idParaDest-79"><a id="_idTextAnchor079"/><span class="koboSpan" id="kobo.572.1">A combined diamond model and kill chain intrusion analysis</span></h2>
<p><span class="koboSpan" id="kobo.573.1">The kill chain provides a straightforward method of delineating specific adversary actions that take place during a network intrusion. </span><span class="koboSpan" id="kobo.573.2">What the kill chain lacks is a consistent structure </span><a id="_idIndexMarker440"/><span class="koboSpan" id="kobo.574.1">of the relationship between the </span><a id="_idIndexMarker441"/><span class="koboSpan" id="kobo.575.1">adversaries. </span><span class="koboSpan" id="kobo.575.2">For example, an analysis of an intrusion may uncover a weaponized PDF document attached to an email sent to the comptroller of the company. </span><span class="koboSpan" id="kobo.575.3">While understanding the delivery method is useful in understanding the root cause, going deeper into the intrusion requires further detail. </span><span class="koboSpan" id="kobo.575.4">That is where combining the diamond model into the kill chain comes </span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">into play.</span></span></p>
<p><span class="koboSpan" id="kobo.577.1">The diamond model represents an individual event, in this case, the data around the method the adversary used to deliver their payload. </span><span class="koboSpan" id="kobo.577.2">Integrating a diamond model into each phase of the kill chain provides a much more structured and comprehensive approach to intrusion analysis. </span><span class="koboSpan" id="kobo.577.3">In other words, as </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.578.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.579.1">.8</span></em><span class="koboSpan" id="kobo.580.1"> shows, for each stage of the kill chain, there is a corresponding diamond model in which evidence acquired during the analysis </span><span class="No-Break"><span class="koboSpan" id="kobo.581.1">is placed.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer039">
<span class="koboSpan" id="kobo.582.1"><img alt="" src="image/Image_B18571_04_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.583.1">Figure 4.8 – A combined kill chain and diamond model</span></p>
<p><span class="koboSpan" id="kobo.584.1">The goal should be for each vertex of the diamond model to be identified for each phase of the cyber kill chain. </span><span class="koboSpan" id="kobo.584.2">Obviously, that may only be possible in a perfect world. </span><span class="koboSpan" id="kobo.584.3">Some evidence associated with an intrusion will be unavailable to analysts. </span><span class="koboSpan" id="kobo.584.4">Therefore, a more realistic benchmark is necessary. </span><span class="koboSpan" id="kobo.584.5">Robert Lee, the author of the </span><em class="italic"><span class="koboSpan" id="kobo.585.1">SANS Cyber Threat Intelligence</span></em><span class="koboSpan" id="kobo.586.1"> course, has provided the benchmark of at least one vertex having to contain an evidence item or items for phases two through six to be considered complete. </span><span class="koboSpan" id="kobo.586.2">This does not</span><a id="_idIndexMarker442"/><span class="koboSpan" id="kobo.587.1"> mean that the evidence</span><a id="_idIndexMarker443"/><span class="koboSpan" id="kobo.588.1"> uncovered does not have value but that our confidence in the intrusion analysis is based on uncovering as much detail as possible while balancing </span><span class="No-Break"><span class="koboSpan" id="kobo.589.1">time efforts.</span></span></p>
<p><span class="koboSpan" id="kobo.590.1">Another consideration that you may need to address is circumstances where analysts must investigate and analyze two intrusions into the network. </span><span class="koboSpan" id="kobo.590.2">For example, the first intrusion was a phishing email that contained a malicious document that downloaded a secondary payload designed to exploit a vulnerability in the Windows OS. </span><span class="koboSpan" id="kobo.590.3">This malware was stopped at the Exploitation stage by the antivirus and the intrusion was unsuccessful at reaching the Actions on </span><span class="No-Break"><span class="koboSpan" id="kobo.591.1">Objectives stage.</span></span></p>
<p><span class="koboSpan" id="kobo.592.1">The second intrusion was similar, but instead of the antivirus blocking the malware from executing, it was able to exploit a vulnerability and execute. </span><span class="koboSpan" id="kobo.592.2">The adversary was further able to install a persistence mechanism and configure a C2 channel before being discovered and the system isolated. </span><span class="koboSpan" id="kobo.592.3">In this case, the second intrusion takes precedence over the first and should be investigated first. </span><span class="koboSpan" id="kobo.592.4">If there are resources available, the first intrusion investigation can be run in parallel but if there are additional resources needed for the second investigation, again, that </span><span class="No-Break"><span class="koboSpan" id="kobo.593.1">takes precedence.</span></span></p>
<p><span class="koboSpan" id="kobo.594.1">The technical tools and techniques of intrusion analysis would take a whole book to cover in themselves. </span><span class="koboSpan" id="kobo.594.2">What the diamond model / cyber kill chain methodology does is provide a construct to both guide the analysis and place the evidence items within an appropriate relationship to each other, so that a more comprehensive analysis of the adversary </span><span class="No-Break"><span class="koboSpan" id="kobo.595.1">is conducted.</span></span></p>
<p><span class="koboSpan" id="kobo.596.1">This combined kill chain and diamond model analysis construct is useful for a full intrusion analysis. </span><span class="koboSpan" id="kobo.596.2">Again, the deciding factor of whether an intrusion analysis is successful is dependent on the organization’s ability to aggregate the necessary evidence to populate the specific vertices of the applicable diamond models in their appropriate kill chain phases. </span><span class="koboSpan" id="kobo.596.3">Often, constraints such as evidence volatility, visibility, and lack of expertise reduce the chances of being able to successfully investigate a </span><span class="No-Break"><span class="koboSpan" id="kobo.597.1">network intrusion.</span></span></p>
<h2 id="_idParaDest-80"><a id="_idTextAnchor080"/><span class="koboSpan" id="kobo.598.1">Attribution</span></h2>
<p><span class="koboSpan" id="kobo.599.1">The pinnacle of an incident investigation is attribution. </span><span class="koboSpan" id="kobo.599.2">In attribution, the analysts can directly tie an intrusion to an individual or threat actor group, whether that is an individual, group, or government </span><a id="_idIndexMarker444"/><span class="koboSpan" id="kobo.600.1">organization. </span><span class="koboSpan" id="kobo.600.2">Given that threat actors, especially highly skilled ones, can cover their tracks, attributing an attack is extremely difficult and is largely reserved to governments or private entities that specialize in long-term analysis and have datasets from a large number </span><span class="No-Break"><span class="koboSpan" id="kobo.601.1">of intrusions.</span></span></p>
<p><span class="koboSpan" id="kobo.602.1">For example, the cyber threat intelligence provider Mandiant released the APT1 report in 2013. </span><span class="koboSpan" id="kobo.602.2">This report directly implicated individuals in the second Bureau of the Chinese PLA General Staff’s third Department. </span><span class="koboSpan" id="kobo.602.3">This conclusion took years, based on data from 300 separate indicators and 141 separate organizations that suffered an intrusion. </span><span class="koboSpan" id="kobo.602.4">These numbers are a testament to how much data is required for proper attribution, which is likely outside the reach of analysts within </span><span class="No-Break"><span class="koboSpan" id="kobo.603.1">their organization.</span></span></p>
<p><span class="koboSpan" id="kobo.604.1">These data points are combined with other intrusion analyses where patterns of overlapping capabilities, infrastructure, and victims are identified. </span><span class="koboSpan" id="kobo.604.2">From here, data about the adversary for each intrusion set is used to possibly determine who was behind an intrusion. </span><span class="koboSpan" id="kobo.604.3">Again, this is most often outside the purview of the analyst or analysts investigating intrusions but does come into play with organizations that leverage this type of incident analysis for threat </span><span class="No-Break"><span class="koboSpan" id="kobo.605.1">intelligence purposes.</span></span></p>
<h1 id="_idParaDest-81"><a id="_idTextAnchor081"/><span class="koboSpan" id="kobo.606.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.607.1">Digital forensics does not exist in a vacuum. </span><span class="koboSpan" id="kobo.607.2">The tools and techniques that this book focuses on exist as part of a larger effort. </span><span class="koboSpan" id="kobo.607.3">Without a methodology to test an analyst’s hypothesis, digital forensics is merely the gathering and extraction of data. </span><span class="koboSpan" id="kobo.607.4">Rather, it is critical to understand what type of incident investigation is needed and to determine what methodology is applicable. </span><span class="koboSpan" id="kobo.607.5">To answer the key questions related to an intrusion requires the incorporation of the incident investigation methodology and the diamond model of intrusion analysis. </span><span class="koboSpan" id="kobo.607.6">This combination of these two constructs provides the structure in which analysts can properly examine the evidence and test </span><span class="No-Break"><span class="koboSpan" id="kobo.608.1">their hypothesis.</span></span></p>
<p><span class="koboSpan" id="kobo.609.1">The next chapter will begin the process of evidence acquisition by examining tools and techniques focused on network evidence. </span></p>
<h1 id="_idParaDest-82"><a id="_idTextAnchor082"/><span class="koboSpan" id="kobo.610.1">Questions</span></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.611.1">The type of incident investigation that is concerned with determining whether an event is an incident or </span><span class="No-Break"><span class="koboSpan" id="kobo.612.1">not is:</span></span><ol><li><span class="koboSpan" id="kobo.613.1">Attribution </span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.614.1">Root cause</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.615.1">Detection</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.616.1">Intrusion analysis</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.617.1">What is the first phase of the cyber </span><span class="No-Break"><span class="koboSpan" id="kobo.618.1">kill chain?</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.619.1">Reconnaissance</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.620.1">Weaponization</span></span></li><li><span class="koboSpan" id="kobo.621.1">Command </span><span class="No-Break"><span class="koboSpan" id="kobo.622.1">and Control</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.623.1">Delivery</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.624.1">Obtaining data during the Reconnaissance phase of the cyber kill chain is often difficult due to the lack of any connection to the </span><span class="No-Break"><span class="koboSpan" id="kobo.625.1">target network.</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.626.1">True</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.627.1">False</span></span></li></ol></li>
</ol>
</div>
<div>
<div id="_idContainer041">
</div>
</div>


<div class="Content" id="_idContainer042">
<h1 id="_idParaDest-83"><a id="_idTextAnchor083"/><span class="koboSpan" id="kobo.1.1">Part 2: Evidence Acquisition</span></h1>
<p><span class="koboSpan" id="kobo.2.1">Part 2 will focus on the technical aspects of digital evidence acquisition. </span><span class="koboSpan" id="kobo.2.2">This will include a detailed examination of the tools and techniques that can be leveraged for proper </span><span class="No-Break"><span class="koboSpan" id="kobo.3.1">evidence acquisition.</span></span></p>
<p><span class="koboSpan" id="kobo.4.1">This part comprises the </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">following chapters:</span></span></p>
<ul>
<li><a href="B18571_05.xhtml#_idTextAnchor084"><em class="italic"><span class="koboSpan" id="kobo.6.1">Chapter 5</span></em></a><em class="italic"><span class="koboSpan" id="kobo.7.1">, Collecting Network Evidence</span></em></li>
<li><a href="B18571_06.xhtml#_idTextAnchor105"><em class="italic"><span class="koboSpan" id="kobo.8.1">Chapter 6</span></em></a><em class="italic"><span class="koboSpan" id="kobo.9.1">, Acquiring Host-Based Evidence</span></em></li>
<li><a href="B18571_07.xhtml#_idTextAnchor123"><em class="italic"><span class="koboSpan" id="kobo.10.1">Chapter 7</span></em></a><em class="italic"><span class="koboSpan" id="kobo.11.1">, Remote Evidence Collection</span></em></li>
<li><a href="B18571_08.xhtml#_idTextAnchor136"><em class="italic"><span class="koboSpan" id="kobo.12.1">Chapter 8</span></em></a><em class="italic"><span class="koboSpan" id="kobo.13.1">, Forensic Imaging</span></em></li>
</ul>
</div>
<div>
<div id="_idContainer043">
</div>
</div>
</body></html>