<html><head></head><body>
		<div><h1 id="_idParaDest-224"><em class="italic"><a id="_idTextAnchor231"/>Chapter 10</em>: Applying IoT Security</h1>
			<p><em class="italic">"You wouldn't leave the keys to your car sitting on the hood - without security on IoT devices you're opening yourself up to the risks that come with sharing data with potentially malicious parties" </em></p>
			<p><em class="italic">– Lisa De luca, Prolific IoT inventor and Head of Customer Intelligence at Wayfair technologies.</em></p>
			<p><strong class="bold">Internet of Things</strong> (<strong class="bold">IoT</strong>) devices are becoming very popular because they can make our lives easier. In addition, their cost makes them very accessible to the consumer market. However, these cheap devices bring a lot of opportunities for cybercriminals who are eager to leverage the devices to exploit vulnerabilities.</p>
			<p>Therefore, in this chapter, you will learn how to get ahead of the criminals. You will also learn how to leverage these technologies to create your very own cybersecurity tools, such as the following:</p>
			<ul>
				<li>Your own device to detect rogue access points</li>
				<li>A Raspberry Pi firewall and intrusion detection system</li>
				<li>A powerful honeypot for less than $10</li>
				<li>An IoT device to monitor your web services and network</li>
				<li>An internet ad blocker with Raspberry Pi</li>
			</ul>
			<p>Now, let's take a look at the main topics that we will cover in this chapter:</p>
			<ul>
				<li><em class="italic">An introduction to the Internet of Things,</em> their risks for industrial and home implementations.</li>
				<li>The list with the top 10 <em class="italic">vulnerabilities on IoT devices</em>.</li>
				<li>Explore the most popular types of IoT <em class="italic">network technologies including: LoRaWAN, Sigfox, ZigBee, and more</em>.</li>
				<li>A review of security mechanisms <em class="italic">and best practices to improve the security of IoT devices.</em></li>
				<li>A complete guide on how to <em class="italic">leverage low cost IoT devices to create your own defensive security tools</em>.</li>
				<li>Plus, as a bonus, this chapter tells you <em class="italic">the dangers of unauthorized IoT devices and how you can detect them</em>.</li>
			</ul>
			<h1 id="_idParaDest-225"><a id="_idTextAnchor232"/>Technical requirements</h1>
			<p>There are no technical requirements for this chapter. However, we strongly recommend that you get a Raspberry Pi (model 3 or above) so that you can experiment and create some of the defensive security tools that you will see in this chapter.</p>
			<h1 id="_idParaDest-226"><a id="_idTextAnchor233"/>Understanding the Internet of Things</h1>
			<p>Let's start by defining the IoT as <em class="italic">a collection of devices that are capable of connecting to the internet to share data and resources</em>.</p>
			<p>Some examples could<a id="_idIndexMarker1018"/> be your smartwatch or your smart TV (yes, they like to put the word <em class="italic">smart</em> on IoT devices), but many other devices in your office, such as the copy machine, the printers, and even the coffee machine, could be IoT-enabled devices that need to be analyzed for vulnerabilities before allowing them to be connected to the internet. The following are some examples of IoT devices:</p>
			<div><div><img src="img/Figure_10.1_B16290.jpg" alt="Figure 10.1 – Examples of IoT devices&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.1 – Examples of IoT devices</p>
			<p>Companies are realizing the benefits of connecting devices to the internet. These benefits include the addition of new functionality and the harvesting of data regarding customer use or habits (very useful to improve future products). Additionally, companies can create connected ecosystems by sharing services, data, or features through devices, greatly enhancing user experience.</p>
			<p>But those implementations also bring a plurality of <strong class="bold">risks</strong> that you must know and understand in order to create a strategy to properly protect against them.</p>
			<h2 id="_idParaDest-227"><a id="_idTextAnchor234"/>The risks</h2>
			<p>Most IoT devices<a id="_idIndexMarker1019"/> were created to <em class="italic">enhance</em> the user experience. However, in many cases, those devices were not designed to be <em class="italic">secure</em> by design. This could represent<a id="_idIndexMarker1020"/> a risk to your network and data.</p>
			<p>Let's look at the two main types of IoT implementations and the associated risks of each one.</p>
			<h3>Industrial IoT</h3>
			<p>The main risks in industrial IoT<a id="_idIndexMarker1021"/> environments are as follows:</p>
			<ul>
				<li>Loss of data<a id="_idIndexMarker1022"/> from sensors</li>
				<li>Corruption of data from sensors</li>
				<li>Jamming of sensors</li>
				<li>Industrial espionage</li>
				<li>Device hijacking</li>
				<li>Alteration of data to cause disruption of services (machinery or production plants)</li>
				<li>Alteration of data to cause financial losses (crop loss)</li>
			</ul>
			<h3>Smart houses</h3>
			<p>The main risks in smart house environments<a id="_idIndexMarker1023"/> are as follows:</p>
			<ul>
				<li>Network<a id="_idIndexMarker1024"/> intrusion.</li>
				<li>Disclosure of personal or sensitive data.</li>
				<li>Devices can be used as botnets to launch <strong class="bold">distributed denial of service </strong>(<strong class="bold">DDoS</strong>) attacks.</li>
				<li>Remote access/control of devices.</li>
				<li>Disabling or bypassing of security systems.</li>
				<li>Privacy issues (cameras, microphones, and so on).</li>
			</ul>
			<p>The following image illustrates<a id="_idIndexMarker1025"/> an example of how your IoT<a id="_idIndexMarker1026"/> devices can be hijacked by an attacker. </p>
			<div><div><img src="img/Figure_10.2_B16290.jpg" alt=" Figure 10.2 – Threat landscape of an IoT smart house&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption"> Figure 10.2 – Threat landscape of an IoT smart house</p>
			<p>Now, let's see what the most common <em class="italic">vulnerabilities</em> are that may trigger those <em class="italic">risks</em>.</p>
			<h2 id="_idParaDest-228"><a id="_idTextAnchor235"/>The vulnerabilities</h2>
			<p>Most of the competition<a id="_idIndexMarker1027"/> in the IoT market revolves around <em class="italic">cost</em>. Therefore, companies need to reduce it and, sometimes, this means a lack of security testing, or even of basic security settings on the devices.</p>
			<p>Therefore, there are hundreds (maybe thousands) of IoT devices that are already connected to the internet, with the owners not even being aware of the vulnerabilities they have.</p>
			<p>Now, let's look at the top 10 vulnerabilities found on IoT devices:</p>
			<div><div><img src="img/Figure_10.3_B16290.jpg" alt="Figure 10.3 – Top 10 IoT vulnerabilities&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.3 – Top 10 IoT vulnerabilities</p>
			<p>Now, let's look at the most common<a id="_idIndexMarker1028"/> network protocols used for IoT devices and their associated advantages, risks, and vulnerabi<a id="_idTextAnchor236"/>lities.</p>
			<h1 id="_idParaDest-229"><a id="_idTextAnchor237"/>Understanding IoT networking technologies</h1>
			<p>While some IoT implementations<a id="_idIndexMarker1029"/> use Wi-Fi, the truth is that Wi-Fi has several limitations, especially in terms of energy consumption and network coverage (range). Therefore, a new set of technologies has been developed to overcome that limitation and increase the reach up to 10 kilometers.</p>
			<p>Now, let's take a look at some of those IoT network technologies and the vulnerabilities associated with them.</p>
			<h2 id="_idParaDest-230"><a id="_idTextAnchor238"/>LoRaWAN</h2>
			<p><strong class="bold">LoRaWAN, </strong>also know as<strong class="bold"> LoRa,</strong> is an open standard<a id="_idIndexMarker1030"/> for the implementation of <strong class="bold">low-power wide area networks </strong>(<strong class="bold">LPWANs</strong>).</p>
			<p>One of the main<a id="_idIndexMarker1031"/> advantages of this technology is the ability<a id="_idIndexMarker1032"/> to transfer data over long distances (more than 10 kilometers) with very low power<a id="_idIndexMarker1033"/> consumption. This makes LoRa a great alternative for connecting IoT devices and sensors. Additionally, as seen in the following figure, LoRa devices are really small. This is great for prototyping (and even to integrate into production systems):</p>
			<div><div><img src="img/Figure_10.4_B16290.jpg" alt="Figure 10.4 – LoRa sender and receiver&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.4 – LoRa sender and receiver</p>
			<p>So, long-range coverage and small devices (with low power consumption) sound like the perfect solution to implement IoT networks, but there are also a plurality of vulnerabilities that you need to take into consideration if you plan to have these types of networks in your infrastructure.</p>
			<h3>LoRaWAN security vulnerabilities</h3>
			<p>By design, LoRa is very secure. In fact, authentication and encryption are mandatory. However, devices<a id="_idIndexMarker1034"/> and networks can still be compromised if the implementation is not performed properly.</p>
			<p>Therefore, it is very important to look for <strong class="bold">LoRaWAN CertifiedCM</strong> devices to ensure the device has been tested against<a id="_idIndexMarker1035"/> the standard and works as expected.</p>
			<p>The following is a list of some of the vulnerabilities reported for these devices:</p>
			<ul>
				<li>Some devices may come with hard-coded encryption keys.</li>
				<li>Some devices may use easy-to-guess encryption keys, such as <code>AppKey = device identifier + app identifier</code>, or <code>AppKey = app identifier + device identifier</code>.</li>
				<li>Vulnerable to denial-of-service attacks.</li>
				<li>Vulnerable to ACK spoofing attacks.</li>
				<li>Vulnerable to replay attacks.</li>
				<li>Additionally, there<a id="_idIndexMarker1036"/> are two CVE vulnerabilities associated with LoRa: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-4060">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-4060</a> and <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28349">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28349</a>.</li>
			</ul>
			<p>Remember that new CVEs are uploaded daily, so always check them before any implementation.</p>
			<h2 id="_idParaDest-231"><a id="_idTextAnchor239"/>Zigbee</h2>
			<p>Zigbee is a standard for <strong class="bold">personal area networks</strong> (<strong class="bold">PANs</strong>) developed by the Zigbee Alliance, targeted<a id="_idIndexMarker1037"/> to provide a low-cost, low-power, wireless<a id="_idIndexMarker1038"/> communications solution for short-range<a id="_idIndexMarker1039"/> applications (such as communication between sensors).</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Why is IoT communications protocol security important? In 2017, a group of researchers were able to compromise a network and inject malware by leveraging a vulnerability on a Zigbee implementation of a smart bulb.</p>
			<h3>Zigbee security vulnerabilities</h3>
			<p>The most common<a id="_idIndexMarker1040"/> vulnerabilities on Zigbee networks are the following:</p>
			<ul>
				<li>They are susceptible to availability attacks through signal jamming (this can be easily achieved due to the band used).</li>
				<li>The security is based on the secrecy of this key exchange; therefore, they are susceptible to attacks that sniff the network during the repairing of the keys.</li>
				<li>Some systems do not support the changing of compromised keys, so once a key is compromised you cannot change the keys to lock the intruder out.</li>
				<li>Additional product-related vulnerabilities can be found at the following URL: <a href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=zigbee">https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=zigbee</a>.</li>
			</ul>
			<p>The following figure shows Zigbee modules:</p>
			<div><div><img src="img/Figure_10.5_B16290.jpg" alt="Figure 10.5 – Zigbee modules&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.5 – Zigbee modules</p>
			<p>Remember that, here, we are explaining the standard features and vulnerabilities. However, we highly recommend that you familiarize yourself with the technology before implementing it. </p>
			<p>The good thing is that these devices are really low cost, so you can easily create your own prototypes (with the help of a prototyping board such as Arduino or Raspberry Pi) to determine the best network for your IoT implementation.</p>
			<h2 id="_idParaDest-232"><a id="_idTextAnchor240"/>Sigfox</h2>
			<p><strong class="bold">Sigfox</strong> was developed to send small messages<a id="_idIndexMarker1041"/> a few times a day. This keeps costs<a id="_idIndexMarker1042"/> and power consumption as low as possible. With this technology, you can send up to 140 messages a day (12 bytes for uplink messages and 8 bytes for downlink messages).</p>
			<p>This is especially useful in transferring data from sensors over long distances at a low cost.</p>
			<p>This technology is becoming widely popular, and, as you can see in <em class="italic">Figure 10.6</em>, Sigfox is being implemented all around the globe:</p>
			<div><div><img src="img/Figure_10.6_B16290.jpg" alt="Figure 10.6 – Sigfox coverage map&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.6 – Sigfox coverage map</p>
			<h3>Sigfox security vulnerabilities</h3>
			<p>The most common vulnerabilities<a id="_idIndexMarker1043"/> on Sigfox networks are the following:</p>
			<ul>
				<li>Due to the low bandwidth, some communication may be sent unencrypted. This presents a risk to the data being transferred.</li>
				<li>They are susceptible to availability attacks through signal jamming (this can be easily achieved<a id="_idIndexMarker1044"/> due to the band used).</li>
			</ul>
			<p>Now, let's take a look at a well-known protocol that has been adopted in some IoT implementations. We are talking about <strong class="bold">Bluetooth</strong>.</p>
			<h2 id="_idParaDest-233"><a id="_idTextAnchor241"/>Bluetooth</h2>
			<p>Due to its popularity, Bluetooth<a id="_idIndexMarker1045"/> has become an interesting option<a id="_idIndexMarker1046"/> for IoT manufacturers, because it is low cost and easy to integrate with other devices.</p>
			<p>There is also a version called <strong class="bold">Bluetooth Low Energy </strong>(<strong class="bold">BLE</strong>). This is even better for IoT implementations<a id="_idIndexMarker1047"/> because the power consumption is considerably low.</p>
			<h3>Bluetooth security vulnerabilities</h3>
			<p>BLE includes 128-bit encryption, plus authentication. These are two essential mechanisms<a id="_idIndexMarker1048"/> in security. However, there are still some vulnerabilities related to BLE:</p>
			<ul>
				<li>Devices are vulnerable<a id="_idIndexMarker1049"/> to several attacks when in <strong class="bold">discoverable mode</strong>; therefore, this should <em class="italic">only</em> be used during setup and turned off after that. However, <em class="italic">some devices come with the discoverable option on by default, and do not give you the option to change it</em>. Such devices (normally very low-cost IoT devices) should be avoided.</li>
				<li>There are some vulnerabilities listed on the CVE site about BLE. However, most of them are related to weak<a id="_idIndexMarker1050"/> implementation by the manufacturer and not about the protocol itself. Refer to the following URL: <a href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=ble">https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=ble</a>.</li>
			</ul>
			<p>In 2020, a Tesla Model X was hacked by a cybersecurity expert in just 90 seconds by taking advantage of a massive Bluetooth vulnerability.</p>
			<p>There are other technologies, such as <strong class="bold">NFC</strong>, that are also used on IoT implementations to exchange data<a id="_idIndexMarker1051"/> or trigger actions. Those technologies also need to be analyzed to ensure they will not represent a threat to our data or devices.</p>
			<h2 id="_idParaDest-234"><a id="_idTextAnchor242"/>Security considerations</h2>
			<p>As we just saw, many of these protocols offer enough security mechanisms for IoT networks. However, most of the vulnerabilities found are related to poor implementations. Therefore, the overall security considerations<a id="_idIndexMarker1052"/> for IoT devices are as follows:</p>
			<ul>
				<li>Always research about an IoT device before purchasing it, as it may have poor security implementation or an outdated version of the protocol.</li>
				<li>Perform a feature analysis to determine which is the best option for you in terms of speed, bandwidth, and distance (as seen in <em class="italic">Figure 10.7</em>).</li>
				<li>Make sure that all implementations are carried out by an expert to avoid security holes.</li>
				<li>Be aware of low-cost devices and sensors, as they may lack encryption or other security mechanisms (to reduce cost).</li>
				<li>Isolate the IoT network from your corporate network to avoid additional risks to your main infrastructure.</li>
			</ul>
			<p>The following graph shows a comparison of IoT network protocols:</p>
			<div><div><img src="img/Figure_10.7_B16290.jpg" alt="Figure 10.7 – Comparison of IoT network protocols&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.7 – Comparison of IoT network protocols</p>
			<p>As seen in <em class="italic">Figure 10.7</em>, <em class="italic">there is no one-size-fits-all solution</em>. Instead, every technology has its pros and cons that need to be evaluated in order to determine which is the best solution for you. Remember that availability is one of the factors that you need to evaluate as part of your<a id="_idIndexMarker1053"/> cybersecurity strategy. Therefore, you also need to take into consideration which of these technologies gives you a higher fidelity and a lower risk of lo<a id="_idTextAnchor243"/>sing packets or connections.</p>
			<h1 id="_idParaDest-235"><a id="_idTextAnchor244"/>Improving IoT security</h1>
			<p>Now, let's analyze some additional mechanisms<a id="_idIndexMarker1054"/> and best practices that you can apply to improve the security of IoT devices.</p>
			<h3>Default passwords</h3>
			<p>Change all the default passwords<a id="_idIndexMarker1055"/> of all IoT devices upon installation.</p>
			<p>Also, make sure you select very strong passwords for those devices, consisting of the following properties:</p>
			<ul>
				<li>15 characters long.</li>
				<li>Letters (lower and upper case), numbers, and special characters.</li>
				<li>Avoid the use of common words (also known as dictionary words) like names of countries, months of the year, and so on.</li>
				<li>Change it at least twice a year for home devices and quarterly for business devices.</li>
				<li>Use a password manager for secure and easy management of these passwords.</li>
			</ul>
			<p>However, using a super password is not enough. You should also obfuscate the username to make things<a id="_idIndexMarker1056"/> even harder for the attacker. Let's do this by changing the <strong class="bold">default user</strong>.</p>
			<h3>Default users</h3>
			<p>Default users like <strong class="bold">Admin</strong> are easy<a id="_idIndexMarker1057"/> to guess for attackers, so changing them will make it harder for an attacker.</p>
			<h3>Disable unnecessary features</h3>
			<p>If an IoT device has options, such as remote<a id="_idIndexMarker1058"/> connections to the admin panel or vulnerable services such as Telnet, enabled, then you <em class="italic">must</em> disable them.</p>
			<h3>Insecure systems</h3>
			<p>Before purchasing any IoT devices, you <em class="italic">must</em> check for known vulnerabilities<a id="_idIndexMarker1059"/> on the web (for example, at the following URL: <a href="https://cve.mitre.org/">https://cve.mitre.org/</a>). </p>
			<p>If the vulnerabilities<a id="_idIndexMarker1060"/> are solved (for example, by the company releasing a patch), then it means that the manufacturer takes security seriously. However, if the vulnerability has not been resolved by the manufacturer, then you should look for an alternative, instead of adding a vulnerable device to your network.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">In 2020, a group of researchers used <a href="http://Shodan.io">Shodan.io</a> to find vulnerable printers and used a script to force those vulnerable printers to print a <em class="italic">guide on printer security</em>. </p>
			<p>Additionally, in 2018, more than 50,000 printers started to print a message supporting a YouTuber in another successful mass-scale printer attac<a id="_idTextAnchor245"/>k (see <em class="italic">Figure 10.8</em>):</p>
			<div><div><img src="img/Figure_10.8_B16290.jpg" alt="Figure 10.8 – Letter printed by 50,000 vulnerable printers&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.8 – Letter printed by 50,000 vulnerable printers</p>
			<p>This attack was relatively <em class="italic">harmless</em>. However, imagine if the attacker had sent a command<a id="_idIndexMarker1061"/> to print a copy of <em class="italic">Don Quixote</em> to those 50,000 printers. Then we would be talking about an impact of 50,000,000 pages (this is a <em class="italic">lot</em>).</p>
			<h3>Enabled services and ports</h3>
			<p>IoT devices may come with several services and ports enabled by default. Therefore, you <em class="italic">must</em> define which services<a id="_idIndexMarker1062"/> should have internet access and<a id="_idIndexMarker1063"/> which services should be intranet only.</p>
			<p>For example, you may want a network printer to access the internet to get updates, but remote management access<a id="_idIndexMarker1064"/> and network printer services<a id="_idIndexMarker1065"/> should be disabled if not in use (most of the time, an intranet printer is enough).</p>
			<h3>Data storage</h3>
			<p>Check what kind of data is saved on the device and what type of security is applied to that data. If the data is not securely encrypted when stored, then either disable the saving of data or create a process to delete all data continuously.</p>
			<h3>Secure setup</h3>
			<p>As mentioned, avoid adding<a id="_idIndexMarker1066"/> a device to the network with the default settings, as that could be an easy target for attackers.</p>
			<h3>Physical setup</h3>
			<p>Make sure that those devices<a id="_idIndexMarker1067"/> are not accessible by unauthorized people as an attacker can press the reset button to enable default login and access the system. </p>
			<h3>Separate networks</h3>
			<p>It is always good practice<a id="_idIndexMarker1068"/> to keep your IoT devices in a private network. This ensures that the IoT devices are not accessing any sensitive files.</p>
			<p>Now, let's talk about the good side of IoT devices, and how you can leverage them to create some very cool projects to enhance the security of your network, o<a id="_idTextAnchor246"/>ffice, systems, data, and even your house.</p>
			<h1 id="_idParaDest-236"><a id="_idTextAnchor247"/>Creating cybersecurity hardware using IoT-enabled devices</h1>
			<p><strong class="bold">Raspberry Pi</strong> is one of the most famous<a id="_idIndexMarker1069"/> IoT devices used today<a id="_idIndexMarker1070"/> to create prototypes. </p>
			<p>In fact, there are hundreds<a id="_idIndexMarker1071"/> of cool projects on the internet that you can create with this powerful device.</p>
			<p>As seen in <em class="italic">Figure 10.9</em>, Raspberry Pi<a id="_idIndexMarker1072"/> is a very powerful device with a lot of computing power, packed with all the ports that you need, plus some I/O pins to easily connect a plurality of modules and sensors.</p>
			<p>There are two main versions: the normal Raspberry Pi (currently at version 4), and <strong class="bold">Raspberry Pi Zero</strong>. This is a miniature version of Raspberry Pi that is portable<a id="_idIndexMarker1073"/> and consumes very little power. This c<a id="_idTextAnchor248"/>ould be great for some projects:</p>
			<div><div><img src="img/Figure_10.9_B16290.jpg" alt="Figure 10.9 – Raspberry Pi versions comparison&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.9 – Raspberry Pi versions comparison</p>
			<p>Many of the Raspberry Pi projects available on the internet are related to cyber weapons aimed to attack networks and systems. However, the good news is that there are also a lot of cool projects for <em class="italic">defensive security</em> that you can leverage due to <em class="italic">low cost</em> and <em class="italic">easy implementation, but more importantly because you can have a lot of fun in creating them</em>. So, let's take a look at this awesome compilation of defensive security projects with Raspberry Pi.</p>
			<h3>Detecting rogue access points</h3>
			<p><em class="italic">Rogue access points are a huge threat to our networks, systems, and data</em>.</p>
			<p>They are basically malicious <strong class="bold">access points</strong> designed to mimic one<a id="_idIndexMarker1074"/> of your original access points<a id="_idIndexMarker1075"/> and perform a plurality of attacks.</p>
			<h3>The threat</h3>
			<p>A <strong class="bold">rogue access point</strong> represents a <em class="italic">huge</em> threat<a id="_idIndexMarker1076"/> to your infrastructure and data because it can be used to launch a variety of dangerous attacks, such as the following:</p>
			<ul>
				<li>Man in the middle</li>
				<li>De-authentication attack</li>
				<li>Probe request monitor </li>
				<li>Intercept, inspect, modify and replay web traffic</li>
				<li>Credentials harvesting</li>
				<li>DHCP starvation attack</li>
				<li>Windows Update attack</li>
				<li>ARP poison</li>
				<li>DNS monitoring </li>
				<li>DNS spoof</li>
			</ul>
			<p>Therefore, as you can see, a rogue access point can do a lot of damage to your infrastructure. Luckily, in the past, those attacks were not very common because, as seen in <em class="italic">Figure 10.10</em>, it was difficult to smuggle all the hardware required to perform that attack unnoticed: </p>
			<div><div><img src="img/Figure_10.10_B16290.jpg" alt="Figure 10.10 – Comparison of the old and new types of rogue access point&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.10 – Comparison of the old and new types of rogue access point</p>
			<p>The bad news is that now, an attacker can use a pocket-sized Raspberry Pi as the platform to launch<a id="_idIndexMarker1077"/> these types of attacks. Due to the small size and low power consumption, this can remain physically undetected in the attacker's pocket.</p>
			<p>To perform<a id="_idIndexMarker1078"/> these types of attacks, an attacker can leverage several tools available on the internet such as <strong class="bold">Wifiphisher</strong> (<a href="https://github.com/wifiphisher/wifiphisher">https://github.com/wifiphisher/wifiphisher</a>), or a framework called <strong class="bold">Wifipumpkin3</strong>. This can<a id="_idIndexMarker1079"/> be found at the following URL: <a href="https://github.com/P0cL4bs/wifipumpkin3">https://github.com/P0cL4bs/wifipumpkin3</a>.</p>
			<p>Refer to the following figure:</p>
			<div><div><img src="img/Figure_10.11_B16290.jpg" alt="Figure 10.11 – WiFi-Pumpkin's previous GUI version (deprecated)&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.11 – WiFi-Pumpkin's previous GUI version (deprecated)</p>
			<p>As seen in <em class="italic">Figure 10.11</em>, these tools are very easy to use. This may cause an increase in the number of attacks because<a id="_idIndexMarker1080"/> they can be performed by script kiddies (attackers with minimal knowledge that love to execute simple attacks based on simple tutorials found on the internet).</p>
			<h3>The solution</h3>
			<p>There are a few commercial<a id="_idIndexMarker1081"/> solutions from Cisco and HP, but these solutions <em class="italic">are very expensive</em> and almost impossible to acquire for small and mid-size enterprises.</p>
			<p><em class="italic">But there is good news.</em> A group of clever inventors and masters in cybersecurity from Cenfotec University in Costa Rica used the very same technology used by the attackers to develop<a id="_idIndexMarker1082"/> a low-cost solution that can find rogue access points in your infrastructure. This solution is called the <strong class="bold">Rpi-AWAPS</strong>: </p>
			<div><div><img src="img/Figure_10.12_B16290.jpg" alt="Figure 10.12 – Analysis and controller systems of the Rpi-AWAPS &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.12 – Analysis and controller systems of the Rpi-AWAPS </p>
			<p>To read more about this incredible project, please visit the following link:</p>
			<p><a href="http://www.crbravo.com/rpi-awaps">http://www.crbravo.com/rpi-awaps</a></p>
			<p class="callout-heading">Important note</p>
			<p class="callout"><strong class="bold">Converting a threat into a solution</strong>: The solution created by these masters and inventors is <em class="italic">unique</em> because they <em class="italic">transformed an offensive weapon into a solution and that is the pinnacle of cybersecurity innovation</em>. Also, this awesome tool was published online, so anyone<a id="_idIndexMarker1083"/> can replicate it at a very low cost. If you like this tool, please leave a message to the authors using the preceding link – they will appreciate it!</p>
			<p>Keep in mind that the current implementation of the project is in Spanish, but the team is working on a project to create an English version of the system.</p>
			<h2 id="_idParaDest-237"><a id="_idTextAnchor249"/>Raspberry Pi firewall and intrusion detection system</h2>
			<p>Another cool way<a id="_idIndexMarker1084"/> to leverage a low-cost IoT device is by creating a low-cost firewall or intrusion detection<a id="_idIndexMarker1085"/> system using <strong class="bold">Raspberry Pi</strong>.</p>
			<p>There are several ways to achieve this and, while this is not an enterprise-level solution, it will bring some extra protection<a id="_idIndexMarker1086"/> to small companies with little<a id="_idIndexMarker1087"/> to no budget for cybersecurity. Here are a couple<a id="_idIndexMarker1088"/> of examples that you can follow:</p>
			<ul>
				<li><a href="https://www.instructables.com/Raspberry-Pi-Firewall-and-Intrusion-Detection-Syst/">https://www.instructables.com/Raspberry-Pi-Firewall-and-Intrusion-Detection-Syst/</a></li>
				<li><a href="https://dergipark.org.tr/en/download/article-file/1160762">https://dergipark.org.tr/en/download/article-file/1160762</a></li>
			</ul>
			<p>We can also create<a id="_idIndexMarker1089"/> more specialized security systems with Raspberry Pi, targeted for some specific systems such as <strong class="bold">SCADA</strong>.</p>
			<h2 id="_idParaDest-238"><a id="_idTextAnchor250"/>Defensive security systems for industrial control systems (SCADA) </h2>
			<p>There are also some implementations<a id="_idIndexMarker1090"/> that leverage Raspberry Pi to increase the security of industrial control systems. Here is one example: <a href="http://www.acadpubl.eu/hub/2018-118-21/articles/21e/66.pdf">http://www.acadpubl.eu/hub/2018-118-21/articles/21e/66.pdf</a>.</p>
			<p>There are several<a id="_idIndexMarker1091"/> types of Raspberry Pi, so even if some of the preceding links refer to a specific version of the Pi, you may be still able to run it on the latest Raspberry Pi available. Your Pi may run even better than the one mentioned in the link (in terms of speed, capacity, space, energy consumption, and so on). </p>
			<h2 id="_idParaDest-239"><a id="_idTextAnchor251"/>Secure USB-to-USB copy machine</h2>
			<p>This is a very interesting<a id="_idIndexMarker1092"/> implementation of a Raspberry Pi to reduce the risk of connecting an infected USB device.</p>
			<p>Imagine you are at a conference and someone is offering you some files that you need through a USB device. You know that connecting it to your computer is a risk, but what else can you do?</p>
			<p>The solution is called <strong class="bold">CIRCLean</strong>. This system is based<a id="_idIndexMarker1093"/> on a Raspberry Pi designed by the <strong class="bold">Computer Incident Response Center Luxembourg</strong> (<strong class="bold">CIRCL</strong>) to scan a USB device and disable<a id="_idIndexMarker1094"/> some suspicious files before securely moving the rest of the content to a new USB device. </p>
			<p>Here are their official<a id="_idIndexMarker1095"/> sites in case you want to know more about this project:</p>
			<ul>
				<li><a href="https://circl.lu/projects/CIRCLean/">https://circl.lu/projects/CIRCLean/</a></li>
				<li><a href="https://github.com/CIRCL/Circlean">https://github.com/CIRCL/Circlean</a></li>
			</ul>
			<p>Refer to the following figure:</p>
			<div><div><img src="img/Figure_10.13_B16290.jpg" alt="Figure 10.13 – Step-by-step instructions for CIRCLean&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.13 – Step-by-step instructions for CIRCLean</p>
			<p>Notice how <em class="italic">Figure 10.13</em> describes<a id="_idIndexMarker1096"/> the functionality of the system in a step-by-step approach.</p>
			<h2 id="_idParaDest-240"><a id="_idTextAnchor252"/>Creating a $10 honeypot</h2>
			<p>We all know the value<a id="_idIndexMarker1097"/> of having a honeypot. However, some of the solutions on the market are a bit expensive. But what about a honeypot solution that costs less than a coffee? That definitely sounds attractive. Well, my friend, that is possible with none other than Raspberry Pi.</p>
			<p>In fact, there are several honeypot solutions that you can install on your little (but powerful) new friend, the Pi.</p>
			<h3>OpenCanary</h3>
			<p><strong class="bold">Thinkst Canary</strong> is an awesome honeypot<a id="_idIndexMarker1098"/> device, but unfortunately, not<a id="_idIndexMarker1099"/> everyone can purchase it. The good news is that you can get its most<a id="_idIndexMarker1100"/> important features using the free <strong class="bold">OpenCanary</strong> software.</p>
			<p>You can easily customize a cheap Raspberry Pi to be used as the host for this incredible system.</p>
			<p>OpenCanary allows you<a id="_idIndexMarker1101"/> to natively fake the following services:</p>
			<ul>
				<li>SSH</li>
				<li>FTP</li>
				<li>Git</li>
				<li>HTTP</li>
				<li>MSSQL</li>
				<li>MySQL</li>
				<li>Telnet</li>
				<li>SNMP</li>
				<li>VNC</li>
				<li>And many more!</li>
			</ul>
			<p>Every time someone<a id="_idIndexMarker1102"/> logs on to the OpenCanary server, you will get an instant notification by email of the activity performed (as seen in <em class="italic">Figure 10.14</em>). </p>
			<p>Now, since this is a honeypot and no one should be logging in to it, you know that every login is a hacking attempt:</p>
			<div><div><img src="img/Figure_10.14_B16290.jpg" alt="Figure 10.14 – Intrusion alert – OpenCanary&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.14 – Intrusion alert – OpenCanary</p>
			<p>The official page<a id="_idIndexMarker1103"/> of the project can be found at the following URL: <a href="https://opencanary.readthedocs.io/en/latest/">https://opencanary.readthedocs.io/en/latest/</a>.</p>
			<h3>Cowrie</h3>
			<p>Another option is <strong class="bold">Cowrie</strong>. Cowrie is a medium- to high-interaction SSH and Telnet honeypot designed<a id="_idIndexMarker1104"/> to log brute force attacks and the shell interaction performed<a id="_idIndexMarker1105"/> by the attacker. It can emulate a Unix system in Python or an SSH and Telnet proxy.</p>
			<p>It presents a fully virtualized filesystem with most commands and binaries available to the attacker. All actions are logged, including all the tools used by the attacker (toolkits, trojans, usernames, passwords, and even their location).</p>
			<p>You can visit their site at the following URL: <a href="https://github.com/cowrie/cowrie">https://github.com/cowrie/cowrie</a>.</p>
			<h3>SNARE</h3>
			<p>A smaller option is the <strong class="bold">super next generation advanced reactive honeypot </strong>(<strong class="bold">SNARE</strong>). This <em class="italic">web application honeypot</em> will help you to attract<a id="_idIndexMarker1106"/> and track a lot of bad actors<a id="_idIndexMarker1107"/> from the wild zones of the internet.</p>
			<p>This type of honeypot allows you to host a page while being able to see all the traffic and activities that occur on that page.</p>
			<p>The official site is available at the following URL: <a href="https://github.com/mushorg/snare">https://github.com/mushorg/snare</a>.</p>
			<h2 id="_idParaDest-241"><a id="_idTextAnchor253"/>Advanced monitoring of web apps and networks</h2>
			<p><strong class="bold">Nagios Core</strong> is an open source system that offers network and application monitoring. It monitors hosts<a id="_idIndexMarker1108"/> and services and sends alerts<a id="_idIndexMarker1109"/> in the case of any<a id="_idIndexMarker1110"/> error (and also when the service is back online).</p>
			<p>Nagios Core<a id="_idIndexMarker1111"/> includes the following features:</p>
			<ul>
				<li>Monitor network services (SMTP, POP3, HTTP, NNTP, PING).</li>
				<li>Monitor resources (CPU load, disk usage, and so on).</li>
				<li>Notifications and alerts (via email, pager, or as defined by the user).</li>
				<li>A web interface to view<a id="_idIndexMarker1112"/> network status, notifications, error history, logs, and so on.</li>
			</ul>
			<p>The good news is that there<a id="_idIndexMarker1113"/> is a free version specially created for IoT devices (including Raspberry Pi) called <strong class="bold">NEMS</strong> and, as you can<a id="_idIndexMarker1114"/> see in <em class="italic">Figure 10.15</em>, the interface is really cool:</p>
			<div><div><img src="img/Figure_10.15_B16290.jpg" alt="Figure 10.15 – NEMS running on Raspberry Pi&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.15 – NEMS running on Raspberry Pi</p>
			<p>Here is the link to the site<a id="_idIndexMarker1115"/> of this special Raspberry Pi version: <a href="https://nemslinux.com/download/nagios-for-raspberry-pi-4.php">https://nemslinux.com/download/nagios-for-raspberry-pi-4.php</a>.</p>
			<h2 id="_idParaDest-242"><a id="_idTextAnchor254"/>Creating an internet ad blocker</h2>
			<p>Internet ads<a id="_idIndexMarker1116"/> are not just a pain – they also have several other issues:</p>
			<ul>
				<li>High bandwidth consumption</li>
				<li>Clickbait</li>
				<li>Scams</li>
				<li>Malware</li>
			</ul>
			<p>The good news<a id="_idIndexMarker1117"/> is that you can use <strong class="bold">Pi-hole</strong>. This is a great ad blocker that can protect your entire network<a id="_idIndexMarker1118"/> from ads using Raspberry Pi.</p>
			<p>The project<a id="_idIndexMarker1119"/> page can be found here: <a href="https://pi-hole.net/">https://pi-hole.net/</a>.</p>
			<h2 id="_idParaDest-243"><a id="_idTextAnchor255"/>Access control and physical security systems</h2>
			<p>You can also leverage<a id="_idIndexMarker1120"/> a plurality of IoT devices to create inexpensive devices for access control and physical security based<a id="_idIndexMarker1121"/> on several technologies, such as these:</p>
			<ul>
				<li>Move detection</li>
				<li>Face recognition</li>
				<li>Email alerts</li>
				<li>Alarms and more</li>
			</ul>
			<p>As seen in <em class="italic">Figure 10.15</em>, you can use a plurality<a id="_idIndexMarker1122"/> of IoT-enabled devices for these types of projects, such as a Raspberry Pi loaded<a id="_idTextAnchor256"/> with <strong class="bold">Motion Eye OS</strong>, or even<a id="_idIndexMarker1123"/> cheaper devices<a id="_idIndexMarker1124"/> such as an <strong class="bold">ESP8266</strong> or <strong class="bold">ESP32</strong>:</p>
			<div><div><img src="img/Figure_10.16_B16290.jpg" alt="Figure 10.16 – Raspberry Pi Zero, Orange Pi, and ESP32&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.16 – Raspberry Pi Zero, Orange Pi, and ESP32</p>
			<p>You have learned a lot about all the cool security projects that you can create/develop with these tools. However, any of these devices<a id="_idIndexMarker1125"/> in the wrong hands (including inadvertent users) could represent<a id="_idIndexMarker1126"/> a big risk for the co<a id="_idTextAnchor257"/>mpany's data and systems, so here is a <em class="italic">bonus track</em> that expands on this topic.</p>
			<h1 id="_idParaDest-244"><a id="_idTextAnchor258"/>Bonus track – Understanding the danger of unauthorized IoT devices</h1>
			<p>Another security risk<a id="_idIndexMarker1127"/> is related to the use of unauthorized IoT devices connected to your network. In this case, an inadvertent user may naively connect an IoT device to your network. This may bring a lot of security risks to your network.</p>
			<p>Therefore, you <em class="italic">must</em> have a system in place to detect those unauthorized devices in your network.</p>
			<h2 id="_idParaDest-245"><a id="_idTextAnchor259"/>Detecting unauthorized IoT devices</h2>
			<p>An easy way to detect<a id="_idIndexMarker1128"/> unauthorized IoT devices connected to your network is by checking the manufacturers of the devices connected to your network.</p>
			<p>You can easily achieve<a id="_idIndexMarker1129"/> this using a piece of software called <strong class="bold">Kismet</strong>. As you can see in <em class="italic">Figure 10.17</em>, with Kismet you can scan the devices on your network and see the manufacturer of the device, enabling you to detect unauthorized devices such as a Raspberry Pi, Alexa, Google Home, Amazon Echo, and so on:</p>
			<div><div><img src="img/Figure_10.17_B16290.jpg" alt="Figure 10.17 – Checking the name of the manufacturer using Kismet&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.17 – Checking the name of the manufacturer using Kismet</p>
			<p>This tool is already installed<a id="_idIndexMarker1130"/> on Kali Linux. For more information, visit the following URL: <a href="https://tools.kali.org/wireless-attacks/kismet">https://tools.kali.org/wireless-attacks/kismet</a>.</p>
			<h2 id="_idParaDest-246"><a id="_idTextAnchor260"/>Detecting a Raspberry Pi</h2>
			<p>There are also some tools<a id="_idIndexMarker1131"/> that you can use to identify a specific IoT device. For example, you can use<a id="_idIndexMarker1132"/> a piece of software called <strong class="bold">Raspberry Pi Finder</strong> (developed by <strong class="bold">Adafruit</strong>) that gives you a very<a id="_idIndexMarker1133"/> clean and easy-to-use<a id="_idIndexMarker1134"/> interface to find out whether a Raspberry Pi is connected to your network:</p>
			<div><div><img src="img/Figure_10.18_B16290.jpg" alt="Figure 10.18 – Raspberry Pi Finder&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.18 – Raspberry Pi Finder</p>
			<p>Another cool feature of this tool is that it is available on Windows, Mac, and Linux. For more information, you can visit their official sites: </p>
			<ul>
				<li><a href="https://learn.adafruit.com/the-adafruit-raspberry-pi-finder">https://learn.adafruit.com/the-adafruit-raspberry-pi-finder</a></li>
				<li><a href="https://github.com/adafruit/Adafruit-Pi-Finder">https://github.com/adafruit/Adafruit-Pi-Finder</a></li>
			</ul>
			<p>There is another<a id="_idIndexMarker1135"/> tool to identify a Raspberry Pi in your network. Coincidentally, this tool has the same name<a id="_idIndexMarker1136"/> but was developed by another developer called <strong class="bold">Ivan X</strong>. This utility<a id="_idIndexMarker1137"/> can be found at the following link: <a href="http://ivanx.com/raspberrypi/">http://ivanx.com/raspberrypi/</a>.</p>
			<h2 id="_idParaDest-247"><a id="_idTextAnchor261"/>Disabling rogue Raspberry Pi devices</h2>
			<p>If you want to take<a id="_idIndexMarker1138"/> a step further after detecting a Raspberry Pi, then you can use a tool called <strong class="bold">RPI Hunter</strong>. This tool enables<a id="_idIndexMarker1139"/> you to find out whether a Raspberry Pi is connected to your network<a id="_idIndexMarker1140"/> and then send many payloads to disable the device.</p>
			<p>To learn more about this tool, visit the following link:</p>
			<p><a href="https://github.com/BusesCanFly/rpi-hunter">https://github.com/BusesCanFly/rpi-hunter</a></p>
			<h1 id="_idParaDest-248"><a id="_idTextAnchor262"/>Summary</h1>
			<p>We covered a lot of information in this chapter.</p>
			<p>First, you learned about IoT devices, their associated risks and vulnerabilities, and how to solve them.</p>
			<p>Then, you became familiar with all the different types of IoT network technologies available and their associated vulnerabilities.</p>
			<p>But the best part is that <em class="italic">you learned how to leverage these IoT devices (that most people see as threats) as great tools that you can deploy in your arsenal of defensive security tools</em>.</p>
			<p>Now, it's time to move to another fascinating and very relevant topic these days: <strong class="bold">cloud security</strong> (how to securely deploy and develop apps in the cloud).</p>
			<h1 id="_idParaDest-249"><a id="_idTextAnchor263"/>Further reading</h1>
			<ul>
				<li>If you want to know more about all available Raspberry Pi models and other cool projects, visit their site at the following URL: <a href="https://www.raspberrypi.org/">https://www.raspberrypi.org/</a>.</li>
				<li>If you are curious to learn more about LoRa networks, you can visit their site at the following URL: <a href="https://lora-alliance.org/">https://lora-alliance.org/</a>.</li>
				<li>To learn more about Zigbee, you can visit the following site: <a href="https://zigbeealliance.org/">https://zigbeealliance.org/</a>.</li>
				<li>If you want to learn more about Sigfox, you can visit their official site at the following URL: <a href="https://www.sigfox.com">https://www.sigfox.com</a>.</li>
			</ul>
		</div>
	</body></html>