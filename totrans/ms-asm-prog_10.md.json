["```\n*# As we are interested in 32-bit executable* \n*# on a 32-bit platform we will type:*\ngcc -o legacy legacy.c\n\n*# and on a 64-bit platform we will type:*\ngcc -o legacy legacy.c -m32\n```", "```\nstruct IMAGE_DATA_DIRECTORY\n{\n   DWORD VirtualAddress;\n   DWORD Size;\n}\n```", "```\n*; Tell the assembler we are writing 32-bit code*\nuse32\n\n*; Then specify the address where the procedure*\n*; is expected to be loaded at*\norg 0x414d98\n```", "```\n*; Assign label to the code where jump* \n*; to fgets is performed*\nlabel fgets at 0x414bd8\n\n*; We will discuss this label in just a few seconds*\nlabel __acrt_iob_func at 0x41b180\n```", "```\nfgets_patch:\n  * ; Standard cdecl prolog*\n   push  ebp\n   mov   ebp, esp\n\n   *; Ooops... We need to pass a pointer to* \n *; the stdin as one of the fgets' parameters,*\n *; but we have no idea what this pointer is...*\n```", "```\n *; Get the stdin stream pointer*\n   push  0\n   call  dword[__acrt_iob_func]\n   *; The result is in the EAX register*\n *; Do not forget to fix the stack pointer*\n *; after calling a cdecl procedure*\n   add   esp, 4\n```", "```\n *; Forward the call to fgets()*\n   push  eax             *; stdin*\n   push  128             *; max input length*\n   push  dword [ebp + 8] *; forward pointer to the* \n                        * ; input buffer*\n   call  fgets\n   add   esp, 12\n\n   *; Standard cdecl epilog*\n   mov   esp, ebp\n   pop   ebp\n   ret\n```", "```\n*; First the formatter directive to tell*\n*; the assembler to generate ELF object file*\nformat ELF\n\n*; We want to export our procedure under* \n*; the name \"gets\"*\npublic gets as 'gets'\n\n*; And we need the following symbols to be*\n*; imported from libc*\n*; As you may notice, unlike Windows, the* \n*; \"stdin\" is exported by libc*\nextrn fgets\nextrn stdin\n\n*; As we want to create a shared object*\n*; we better create our own PLT (Procedure*\n*; Linkage Table)*\nsection '.idata' writeable\n   _fgets  dd  fgets\n   _stdin  dd  stdin\n\nsection '.text' executable\n\n*; At last, the procedure*\ngets:\n   *; Standard cdecl prolog*\n   push  ebp\n   mov   ebp, esp\n\n   *; Forward the call to fgets()*\n   mov   eax, [_stdin]\n   push  dword [eax]             ; FILE*\n   push  127                     ; len\n   push  dword [ebp + 8]         ; Buff*\n   call  [_fgets]\n   add   esp, 12\n\n   *; Standard cdecl epilog*\n   mov   esp, ebp\n   pop   ebp\n   ret\n```", "```\n*# On a 32-bit system*\ngcc -o fgets_patch.so fgets_patch.o -shared \n\n*# and on a 64-bit system*\ngcc -o fgets_patch.so fgets_patch.o -shared -m32\n```", "```\nLD_PRELOAD=./fgets_patch.so ./legacy\n```"]