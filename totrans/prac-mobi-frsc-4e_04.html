<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Data Acquisition from iOS Devices</h1>
                </header>
            
            <article>
                
<p>An iOS device that's been recovered from a crime scene can be a rich source of evidence. Think about how personal a smartphone is to a user; nothing else that's digital comes close. We rarely leave our homes or even walk around outside them without our smartphones within arm's reach. It's literally a glimpse into the most personal aspects of a human, almost like a diary of our everyday activity. According to several news references, Oscar Pistorius' iPads were examined by a mobile expert and presented during his trial to show his internet activity hours before the death of his girlfriend. When an iOS device can provide access to a so-called <em>smoking gun</em>, you, as the examiner, must ensure that you know how to properly handle, acquire, and analyze the device.</p>
<p>There are different ways to acquire forensic data from an iOS device. Though each method will have its pluses and minuses, the fundamental principle of any acquisition method is to obtain as much data as possible.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>iOS device operating modes</li>
<li class="mce-root">Password protection and potential bypasses</li>
<li>Logical acquisition</li>
<li>Filesystem acquisition</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Operating modes of iOS devices</h1>
                </header>
            
            <article>
                
<p>Before we dive into forensic techniques and acquisition methods, it's important to know the different operating modes of an iOS device. Many forensic tools and methods require you to place the device in one of the operating modes. Understanding the iOS device's operating modes is required in order to perform a particular action on the device.</p>
<p>While most commercial tools will demonstrate the proper steps to get the device in a particular mode, you must understand what that mode represents. iOS devices are capable of running in different operating modes: normal mode, recovery mode, and <span><strong>Device Firmware Update</strong> (</span><strong>DFU</strong>) mode. Some forensic tools require you to know which mode the device is currently utilizing. We will define each mode in this section.</p>
<div class="packt_infobox">Note that when the term <em>iPhone</em> is mentioned, it should be understood that the statement remains true for all iOS devices.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Normal mode</h1>
                </header>
            
            <article>
                
<p>When an iPhone is switched on, its operating system is booted; this mode is known as normal mode. Most regular activities (calling, texting, and so on) that are performed on an iPhone will be run in normal mode.</p>
<p>When an iPhone is turned on, internally, it goes through a <em>secure boot chain</em>, as shown in the following diagram. This does not occur for jailbroken devices. Each step in the boot-up process contains software components that are cryptographically signed by Apple to ensure integrity:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c0a280cd-095e-427c-997b-87d5fd796bd5.png" style="width:10.75em;height:13.25em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">A secure boot chain of an iPhone in normal mode</div>
<div>
<p class="mceNonEditable"><span>*The boot ROM, in turn, verifies whether the Low-Level Bootloader (LLB) is signed by Apple and loads it. The LLB is loaded and verified by the boot ROM, but this only occurs on devices with an A9 or earlier A-series processor</span></p>
<p class="mceNonEditable"/>
</div>
<p class="mce-root">The <em>boot ROM</em><em>,</em> known as the <em>secure ROM</em>, is <strong>read-only memory</strong> (<strong>ROM</strong>) and is the first significant piece of code that runs on an iPhone (<a href="https://www.apple.com/business/docs/iOS_Security_Guide.pdf" target="_blank">https://www.apple.com/business/docs/iOS_Security_Guide.pdf</a>). An explanation of the boot process for iOS devices is defined in the following steps:</p>
<ol>
<li class="mce-root">The boot ROM code contains the Apple root <span><strong>certificate authority</strong> (</span><strong>CA</strong>) public key, which is used to verify the signature of the next stage before allowing it to load.</li>
<li>When the iPhone is started, the application processor executes the code from the boot ROM.</li>
<li>The boot ROM, in turn, verifies whether the <strong>Low-Level Bootloader</strong> (<strong>LLB</strong>) is signed by Apple and loads it. The LLB is loaded and verified by the boot ROM, but this only occurs on devices with an A9 or earlier A-series processor.</li>
<li>When the LLB finishes its tasks, it verifies and loads the second-stage boot loader (iBoot). iBoot verifies and loads the iOS kernel.</li>
<li>The iOS kernel, in turn, verifies and runs all the user applications.</li>
</ol>
<p class="mce-root">When an iOS device is in this state, it's possible to gain a part that is accessible to the user through forensic acquisition. Most often, this includes a logical acquisition, which will be discussed later in this chapter.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Recovery mode</h1>
                </header>
            
            <article>
                
<p class="mce-root">During the boot-up process, if one step is unable to load or verify the next step, then the boot-up is stopped and the iPhone displays the screen shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/e76ee9a8-c570-4b6a-a1b4-b8bf3a0dba6d.png" style="width:7.33em;height:13.67em;"/></p>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">iOS device recovery mode</div>
<p class="mce-root">This mode is known as recovery mode and is required to perform upgrades or restore the iPhone. To enter recovery mode, perform the following steps:</p>
<ol>
<li>Turn off the device.</li>
<li>Hold down the iPhone Home button and connect the device to a computer via a USB cable. The device should turn on.</li>
<li>Continue holding the Home button until the Connect to iTunes screen appears. Then, you can release the Home button (on a jailbroken iOS device, this screen may appear with different icons). Most forensic tools and extraction methods will alert you regarding the current state of the iOS device.</li>
<li>To exit recovery mode, reboot the iPhone. On iPhone 6s and earlier, this can be completed by holding down the Home and Sleep/Power buttons until the Apple logo appears. On iPhone 7 and iPhone 7 Plus, this can be done by holding <span>th</span>e Side <span>button and</span> Volume Down button together. O<span>n iPhone 8 and later, you do this by clicking the </span>Volume Up <span>button, then clicking the</span> Volume Down <span>button, and then holding down the</span> Side <span>button.</span></li>
</ol>
<div class="mce-root packt_infobox">You can read more about recovery mode on iOS devices at <a href="https://support.apple.com/en-in/HT201263" target="_blank">https://support.apple.com/en-in/HT201263</a>.</div>
<p class="mce-root">Normally, the process of rebooting returns the iPhone from recovery mode to normal mode. This same methodology applies to the Apple Watch. You may experience a situation where the iPhone constantly reboots into recovery mode. This is known as a recovery loop. A recovery loop may occur when the user or examiner attempts to jailbreak the iOS device and an error occurs. To get the device out of a recovery loop, the device must be connected to iTunes so that a backup can be restored to the device.</p>
<div class="mce-root packt_infobox">This makes changes to the evidence, so ensure that you have validated your acquisition methods on a test device prior to attempting to use your methods on real evidence.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">DFU mode</h1>
                </header>
            
            <article>
                
<p class="mce-root">During the boot-up process, if the Boot ROM is unable to load or verify the LLB or iBoot (on newer devices), the iPhone enters <strong>Device Firmware Upgrade</strong> (<strong>DFU</strong>) mode. DFU mode is a low-level diagnostic mode and is designed to perform firmware upgrades for iPhones.</p>
<p class="mce-root"/>
<p class="mce-root">To enter DFU mode, perform the following steps for iPhone 8 and later:</p>
<ol>
<li>Connect the device to your workstation via a USB cable.</li>
<li>Press <span>the Volume Up button </span>and quickly release it.</li>
<li>Press<span> </span><span>the Volume Down button </span>and quickly release it.</li>
<li>Hold the Side button and press the Volume Down button again.</li>
<li>After 5 seconds, release the Side button, but continue holding the Volume Down button until you see the Recovery screen.</li>
</ol>
<p>Follow these steps for iPhone 7:</p>
<ol>
<li>Connect the device to your workstation via a USB cable.</li>
<li><span>At the same time, p</span>ress and hold the Side and Volume Down buttons.</li>
<li>Release the Side button, but continue to hold the Volume Down button until you see the Recovery screen.</li>
</ol>
<p><span>Follow these steps f</span>or iPhone 6s and earlier:</p>
<ol>
<li><span>Connect the device to your workstation via a USB cable.</span></li>
<li>At the same time, press and hold the Home and the Top (or Side) buttons.</li>
<li>Release the Top (or Side) button and continue holding the Home button. </li>
</ol>
<div class="packt_infobox">On iPhone 6s and earlier, nothing will be displayed on the screen when the device is in DFU mode.</div>
<p class="mce-root">To verify whether the iPhone is in DFU mode on macOS, launch a <span class="packt_screen">System Report</span><strong> </strong>and go to the <span class="packt_screen">USB</span> option. You should see something similar to the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/653124b3-6f3d-4e98-a6de-4888459f9038.png" style="width:39.50em;height:27.50em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">The MacBook system information displaying a device in DFU mode</div>
<p>Next, we will have a quick look at the tools that are required to set up the forensic environment.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Setting up the forensic environment</h1>
                </header>
            
            <article>
                
<p>Nowadays, we have a few tools that can be used by mobile forensic examiners to acquire and analyze iOS devices using both macOS and Windows systems as the hosts. For example,<em> Elcomsoft iOS Forensic Toolkit</em> has both macOS and Windows versions; as for free and open source tools, the <kbd>libimobiledevice</kbd> library can be used <span>– </span>not only on macOS and Windows forensic workstations, but even on Linux!</p>
<p>We are going to introduce you to these tools with hands-on exercises, of course, including practical logical and filesystem acquisitions, and even jailbreaking, later in this chapter. But let's start with password protection and potential bypasses, since, without the passcode, we can't extract anything from a modern iOS device.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Password protection and potential bypasses</h1>
                </header>
            
            <article>
                
<p>We want to start with the bad news: <span>if you are examining an iPhone that runs iOS 8 or newer, and especially if it's a newer device, for example, the iPhone 6s, your chances of unlocking it are not good at all.</span></p>
<p>Of course, there are some hardware-based solutions, such as IP-BOX 3, but all of them work only occasionally, and using one of them can even result in bricking the device. With iOS 11, this problem becomes even more severe <span>– </span>even if the device under examination is not passcode protected, you will need the passcode anyway as it must be entered to confirm the trust between the device and your workstation.</p>
<p>So, what should a mobile forensic examiner do? Use the lockdown files! T<span>he lockdown files, which are stored as a <kbd>plist</kbd> file on <em>trusted computers</em>, allow you to trick the device into believing it's unlocked or <em>trusted</em> on the forensic worksta</span><span>tion.</span></p>
<p><span>The lockdown files are located in the following locations:</span></p>
<ul>
<li><span><kbd>/var/db/lockdown</kbd> on macOS</span></li>
<li><span><kbd>C:\ProgramData\Apple\Lockdown</kbd> on Windows 7 and later releases</span></li>
</ul>
<p>You must be aware that unlocking with a lockdown file only works if the device was unlocked with a passcode at least once after the last reboot.</p>
<p>There are also some advanced techniques that exist. These include fingerprint molds to trick Touch ID, masks to trick Face ID, and NAND mirroring to <span>bypass passcode entry limits. </span></p>
<p>The first technique was first demonstrated by <span>Jason Chaikin. He demonstrated how to bypass Touch ID by lifting another person's fingerprint with common molding materials, such as dental mold and Play-Doh.<br/></span></p>
<p>The second technique was demonstrated as a proof of concept by the <span>Vietnamese cybersecurity firm Bkav. They created a mask that can be used to trick the Face ID feature using a combination of three-dimensional printing, makeup, and two-dimensional images.</span></p>
<p>The last technique was demonstrated by <span>Sergei Skorobogatov, a senior research associate at the Cambridge Computer Laboratory's Security Group. This technique allows you to bypass passcode entry limits by soldering off the iPhone's flash memory chip and cloning it. This technique should work on any iOS device up to iPhone 6s Plus.</span></p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Logical acquisition</h1>
                </header>
            
            <article>
                
<p>A logical acquisition captures a part of what is accessible to the user; in other words, what is included in an iTunes backup. It means that we won't get any deleted files, but, thanks to SQLite databases' free lists and unallocated space, we can recover deleted records, including SMS and other chats, browsing history, and so on. We will discuss recovering SQLite data and deleted artifacts in <a href="4f92f4a2-f8f9-4274-96eb-da9174fc6772.xhtml" target="_blank">Chapter 5</a>, <em>iOS Data Analysis and Recovery.</em></p>
<p>Logical acquisition is the simplest way to ascertain whether the device is unlocked as it simply uses the built-in backup mechanism. Most tools and methods that support the logical acquisition of iOS devices will fail if the device is locked. Some think that if a physical image is captured, there is little to no need for a logical acquisition. However, not all data is parsed in a physical image, which is why having access to a logical image, which results in readable data, will assist you in digging deep into the physical image for artifacts to support your forensic investigation.</p>
<p>Logical acquisition is the fastest, easiest, and cheapest way to gain access to data stored on an iOS device. There are a variety of tools, ranging from commercial to free, that are capable of capturing logical images. Most of these tools require that the device be unlocked, or access to the <kbd>plist</kbd> file from the host machine be readily available. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Practical logical acquisition with libimobiledevice</h1>
                </header>
            
            <article>
                
<p>Having the theory under your belt is good, but putting this into practice is much better. Let's create a logical image of an iPhone running iOS 13.2 with <kbd>libimobiledevice</kbd>, which should already be installed on your workstation, as we used it for device information gathering in the previous chapter.</p>
<p>OK, let's start:</p>
<ol>
<li>First of all, let's make our backups encrypted. Connect the iOS device to your workstation and start the Command Prompt. Change the directory to the one containing <kbd>libimobiledevice</kbd> and type in the following command:</li>
</ol>
<pre style="padding-left: 60px" class="p1"><strong><span class="s1">idevicebackup2.exe backup encryption on &lt;your_password&gt;</span></strong></pre>
<ol start="2">
<li>If you see <span class="packt_screen">Backup encryption has been enabled successfully</span>, then you've done everything right and the backups will be encrypted. This will help you, the forensics examiner, to gain more information regarding users' passwords, Safari browsing history, and much more.</li>
</ol>
<p> </p>
<ol start="3">
<li>It's time to create the backup—our iOS device logical image. To do this, type in the following command:</li>
</ol>
<pre style="padding-left: 60px" class="p1"><strong><span class="s1">idevicebackup2 backup --full &lt;the_folder_you_want_the_image_to_be_saved&gt;</span></strong></pre>
<p>That's it. You can see the logical imaging process in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/8eb26ad2-4dd8-4db9-8f43-edc5f7f7ec0f.png" style="width:32.08em;height:22.17em;"/></p>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">iPhone logical imaging with libimobiledevice</div>
<p>Next, let's look at logical acquisition with the Belkasoft Acquisition Tool.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Practical logical acquisition with the Belkasoft Acquisition Tool</h1>
                </header>
            
            <article>
                
<p><span><span>Since l</span></span>ogical acquisition is the most common option for modern iOS devices, we'll demonstrate how to use a few more free tools. The first one is the Belkasoft Acquisition Tool. <span>This tool can be used not only for iOS device acquisition, but also for hard drives, and even cloud data.</span></p>
<p class="mce-root"/>
<p>Let's acquire an iPhone running iOS 13.2.3 using the <span>Belkasoft Acquisition Tool:</span></p>
<ol>
<li>Launch the Belkasoft Acquisition Tool and choose the <span class="packt_screen">Mobile device</span> option:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ecc44deb-2c74-48a8-a99f-cd8f54f2b210.png" style="width:29.50em;height:18.67em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Choosing the source</div>
<ol start="2">
<li>In the next window, choose the <span class="packt_screen">Apple</span> option:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/155f47fb-e14f-495e-b7a0-15458c26170d.png" style="width:37.17em;height:18.92em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Choosing the mobile type</div>
<ol start="3">
<li>Now, choose the acquisition method and the image path:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/29aefeb1-0419-4b44-8286-768b480a10fa.png" style="width:46.25em;height:35.50em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Choosing the acquisition method</div>
<p style="padding-left: 60px">The tool is able to create an iTunes backup if the device isn't jailbroken and perform filesystem extraction if it is.</p>
<p class="mce-root"/>
<ol start="4">
<li>Wait for the task to finish successfully. You will find your device's logical image in the folder you chose in the previous step:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/db5d235f-d6a8-4255-8e6d-ac10d055f52e.png" style="width:46.33em;height:35.58em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Creating the backup</div>
<p>The backup can be analyzed both by Belkasoft Evidence Center and by many other mobile forensic tools.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Practical logical acquisition with Magnet ACQUIRE</h1>
                </header>
            
            <article>
                
<p>Another free tool capable of logical acquisition is <strong>ACQUIRE</strong> from Magnet Forensics. Let's perform a logical acquisition again, this time using a device running iOS 12.2:</p>
<ol>
<li>Launch <span class="packt_screen">Magnet ACQUIRE</span> and choose the device you want to image from the list:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/dd1fe238-1247-4534-9970-2ae71a92c6a0.png" style="width:51.67em;height:38.50em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Choosing the device</div>
<ol start="2">
<li>Choose the type of image you want to acquire. We want to acquire a logical image and our device is not jailbroken, so we are going to choose the <span class="packt_screen">Quick</span> option:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/d166b841-324a-4737-a783-b36cc82d6b66.png"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Choosing the image type</div>
<ol start="3">
<li>You can add a description of the evidence source if needed, and choose the folder where you want the image to be saved:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/3f8d9f8a-86c8-40ed-8bd2-df086b08afb5.png" style="width:49.08em;height:36.00em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Choosing the destination folder, image name, and image information</div>
<ol start="4">
<li>Wait for the tasks to finish successfully; you'll see a summary of the acquisition process:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/11f2a674-f0b8-4a30-81f7-563be3b440f4.png" style="width:41.83em;height:26.00em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Creating the image</div>
<p>All extracted data will be saved to the destination folder in a ZIP archive. Also, the destination folder will contain a TXT file with the acquisition's process log and image information.</p>
<p>The next section will walk you through jailbreaking and filesystem acquisition.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Filesystem acquisition</h1>
                </header>
            
            <article>
                
<p>Secure Enclave has <span>brought new challenges to iOS forensic examiners. We can't extract the encryption keys that are required to decrypt the device image, so performing physical acquisition is useless. But there is filesystem acquisition. Unfortunately, in most cases, it requires the iOS device to be jailbroken. The next section will show you how to jailbreak an iPhone running iOS 11.4.1 with</span> Electra and an iPhone running iOS 13.2 with Checkra1n.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Practical jailbreaking</h1>
                </header>
            
            <article>
                
<p>To perform filesystem acquisition, we need our iOS device to be jailbroken. The steps to jailbreak an iOS device running 11.4.1 are as follows:</p>
<ol>
<li>
<p>Download <kbd>Electra</kbd> from: <a href="https://github.com/coolstar/electra-ipas/raw/master/Electra1141-1.3.2.ipa" target="_blank">https://github.com/coolstar/electra-ipas/raw/master/Electra1141-1.3.2.ipa</a>.</p>
</li>
<li>
<p>Download <kbd>Cydia Impactor</kbd> (<a href="http://www.cydiaimpactor.com/" target="_blank">http://www.cydiaimpactor.com/</a>), run it, and connect the device to your workstation:</p>
</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/3a5e89f6-befb-4614-b972-5a33885ecc2a.png"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Running Cydia Impactor</div>
<ol start="3">
<li>
<p>Drag and drop the <kbd>Electra IPA</kbd> file to the <kbd>Cydia Impactor</kbd> window.</p>
</li>
<li>
<p>Type any Apple ID in the new window (you can register a new one for every device you examine).</p>
</li>
<li>
<p>Log on with this Apple ID to <a href="https://appleid.apple.com/" target="_blank">https://appleid.apple.com/</a> and generate an app-specific password under the <span class="packt_screen">Security</span> section. Paste this password into the next window. Wait for the process to finish.</p>
</li>
</ol>
<p> </p>
<ol start="6">
<li>
<p>On the phone, go to <span class="packt_screen">Settings</span> | <span class="packt_screen">General</span> | <span class="packt_screen">Device Management</span> | <span class="packt_screen">Apple ID</span> and tap <span class="packt_screen">Trust</span>:</p>
</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/d529bb5c-bf6f-4e21-8ad2-1946a8cd8648.png" style="width:47.75em;height:32.33em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Verifying the developer</div>
<ol start="7">
<li>
<p>Put the phone into Airplane mode, turn Siri off, and reboot the device.</p>
</li>
<li>
<p>Tap the <span class="packt_screen">Electra</span> icon on the Springboard and then choose <span class="packt_screen">Jailbreak</span>. If the process finishes successfully, you will find the <span class="packt_screen">Cydia</span> icon on the Springboard:</p>
</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/611a08f6-bede-4da9-b57b-06bca3b79384.png" style="width:37.50em;height:33.33em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Jailbreaking the device</div>
<p>Now, the phone is jailbroken and ready for filesystem acquisition.</p>
<p><span><kbd>Checkra1n</kbd> is based on a bootrom vulnerability and exploit and supports a wide range of iOS devices, even those running the latest (at the time of writing) iOS 13.2. Here are the steps to jailbreak an iOS device running 13.2:</span></p>
<ol>
<li>Download <kbd>Checkra1n</kbd> from: <a href="https://checkra.in/">https://checkra.in/</a>.</li>
<li>Run the application. At the time of writing, <kbd>Checkra1n</kbd> is only available for macOS.</li>
<li>Connect the device and put it into DFU mode:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/370be42e-f715-49dc-8ad7-06e0135ec1ec.png" style="width:33.75em;height:23.92em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Putting the device into DFU mode</div>
<ol start="4">
<li>Wait for the exploitation process to finish:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1230 image-border" src="assets/e16ecd22-6179-4e31-a1aa-3c84fd7a289a.png" style="width:34.75em;height:34.75em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Exploitation process</div>
<p>Once the device has been rebooted, you will find the checkra1n icon on the Springboard <span>–</span> the device is now jailbroken and ready for filesystem acquisition.</p>
<div class="packt_tip packt_infobox">For more jailbreaking techniques, please refer to the <em>Jailbreaking</em> section of <a href="acc4800c-2775-4ca6-9f5f-e447fa5ac0a8.xhtml" target="_blank">Chapter 2</a>, <em>Understanding the Internals of iOS Devices</em>.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Practical filesystem acquisition with free tools</h1>
                </header>
            
            <article>
                
<p>It's time to perform filesystem acquisition. All we'll need is <kbd>iproxy</kbd> from <kbd>libimobiledevice</kbd>:</p>
<ol>
<li>Open a Command Prompt window and run <kbd>iproxy</kbd> with the following parameters:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/8c762d32-cd21-496e-bbf8-773ff72e3413.png" style="width:45.83em;height:6.00em;"/></p>
<ol start="2">
<li>Open another Command Prompt window, change the directory to the one you want your image to be stored in, and run the following command:</li>
</ol>
<pre style="padding-left: 60px"><strong>ssh root@127.0.0.1 -p 4444 "tar -cf - /private/var/" &gt; userdata.tar</strong></pre>
<div class="packt_infobox">To connect via SSH, you will be prompted for the necessary password. The default password for SSH is <em>alpine</em>.</div>
<p>Once the process has finished, you'll find the created filesystem image in the directory you changed to before running the preceding command. It's a TAR archive and can be opened with many archivers, such as 7-Zip:</p>
<p class="mce-root"/>
<p class="CDPAlignCenter CDPAlign"><img src="assets/f5ba6cb7-7d36-4f65-8ea7-bd0da366cb7e.png" style="width:41.50em;height:33.50em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Filesystem image contents</div>
<p>Next, let's look at the <em>Elcomsoft iOS Forensic Toolkit</em>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Practical filesystem acquisition with Elcomsoft iOS Forensic Toolkit</h1>
                </header>
            
            <article>
                
<p>Of course, commercial tools are more stable and reliable. One of the tools that's capable of filesystem acquisition is the Elcomsoft iOS Forensic Toolkit. Here, we are going to acquire a jailbroken iOS device running iOS 12.4.3.</p>
<p class="mce-root"/>
<p>The steps to do this are as follows:</p>
<ol>
<li><span>Connect the device to your workstation and start</span> <kbd>Toolkit.cmd</kbd><span>.</span></li>
<li>Choose the port to use for SSH connection (the default is <kbd>22</kbd>, but since we used checkra1n for jailbreaking, the port is <kbd>44</kbd> instead) and type in the password (the default is <kbd>alpine</kbd>):</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/a87928bc-2348-4f86-9cd2-36c9f4301088.png" style="width:31.50em;height:11.42em;"/></p>
<ol start="3">
<li>To acquire the device filesystem, type <em>F</em>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/cdbd5f6d-d1da-4e92-8184-2f13d900bdca.png" style="width:39.17em;height:27.17em;"/></p>
<ol start="4">
<li>Choose the image name and start the process.</li>
</ol>
<p>Once the process has finished, we'll have a filesystem image ready to be analyzed with a mobile forensic tool of our choice.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>The first step in iOS device forensic examination is to acquire the data from the device. There are several different ways to acquire data from an iOS device. This chapter covered logical and<span> filesystem </span>acquisition techniques, as well as jailbreaking and methods to bypass passcodes. </p>
<p>While filesystem acquisition is the best method for forensically obtaining a majority of the data from iOS devices, backup files may exist or be the only method to extract data from the device.</p>
<p>The next chapter will discuss iOS device backup files in detail, including user, forensic, encrypted, and iCloud backup files, and the methods that you can perform to conduct your forensic examination.</p>


            </article>

            
        </section>
    </body></html>