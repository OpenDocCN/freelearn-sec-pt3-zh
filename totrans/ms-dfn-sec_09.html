<html><head></head><body>
		<div><h1 id="_idParaDest-157"><em class="italic"><a id="_idTextAnchor161"/>Chapter 7</em>: Hardening a Unix Server </h1>
			<p><em class="italic">"A hardened server drastically reduces the attack surface area, therefore minimizing exposure to threats. It helps to get rid of weaker default settings and to meet compliance."</em></p>
			<p><em class="italic"> – Faraz Ahmad, IT security consultant</em></p>
			<p>If you are used to managing <strong class="bold">Windows</strong> systems and servers, then managing <strong class="bold">Unix</strong>-based systems and servers may become a very complex task. But don't worry, we have your back, and we will start from the basics so that you can easily follow this chapter.</p>
			<p>Here, we will be covering the commands used in most Unix-based systems (including <strong class="bold">Linux</strong>). Despite the fact that there might be some differences between Unix systems, the structures and examples in this chapter should apply to the most common Unix systems (including Linux).</p>
			<p>In this chapter, we are going to cover the following main topics:</p>
			<ul>
				<li>A complete guide to Unix services (how they work and how to manage them)</li>
				<li>How permissions work on Unix systems</li>
				<li>A detailed overview of the different types of permissions on Unix systems (file, folder, user, and so on)</li>
				<li>Advanced configuration of permissions using <code>umask</code></li>
				<li>Enhancing your defensive security by using access controls</li>
				<li>Managing access control lists</li>
				<li>Configuring your host-based firewall using <strong class="bold">iptables</strong></li>
				<li>Best practices to leverage log files</li>
			</ul>
			<h1 id="_idParaDest-158"><a id="_idTextAnchor162"/>Technical requirements </h1>
			<p>For this chapter, it is highly recommended that you have a Unix-like system (this could be <strong class="bold">Kali Linux</strong>, <strong class="bold">Debian</strong>, <strong class="bold">Ubuntu</strong>, and so on). This chapter contains a lot of screenshots so that you can see the output of the commands used. However, it will be of great value if you can test those commands yourself while enjoying the book.</p>
			<p>A very good option is to create a <strong class="bold">Virtual Machine</strong> (<strong class="bold">VM</strong>) so you can run it through Kali easily on your computer. In fact, you will find at the end of this chapter the link to the Kali Linux download page. There you can download a preconfigured VM, ready to open in your favorite hypervisor (<strong class="bold">VirtualBox</strong>, <strong class="bold">VMware</strong>, and so on).</p>
			<h1 id="_idParaDest-159"><a id="_idTextAnchor163"/>Securing Unix services</h1>
			<p>Services <a id="_idIndexMarker778"/>are applications that run in the background to perform or support<a id="_idIndexMarker779"/> essential <strong class="bold">Operating System</strong> (<strong class="bold">OS</strong>) tasks. There are <a id="_idIndexMarker780"/>also services<a id="_idIndexMarker781"/> associated<a id="_idIndexMarker782"/> with apps or<a id="_idIndexMarker783"/> services such as <strong class="bold">Apache</strong>, <strong class="bold">Structured Query Language (SQL)</strong>, <strong class="bold">Hypertext Preprocessor (PHP)</strong>, <strong class="bold">Remote Procedure Call (RPC)</strong>, and so on.</p>
			<p>A lot of services are loaded and enabled by default. However, every service enabled and running represents a potential vulnerability that needs to be considered and managed. </p>
			<p>Therefore, to reduce those risks, let's review some of the best practices related to Unix services (plus some additional server setup considerations).</p>
			<h2 id="_idParaDest-160"><a id="_idTextAnchor164"/>Defining the purpose of the server</h2>
			<p>A <a id="_idIndexMarker784"/>Linux server should be dedicated for a single purpose. For example, a print server, FTP, web server, and so on. This simple task will make hardening efforts easier.</p>
			<p>In the past, having dedicated servers was costly and difficult to procure. However, with cloud technologies, having dedicated servers for each purpose is really easy to create and manage and will not represent a significant increase in terms of cost.</p>
			<h2 id="_idParaDest-161"><a id="_idTextAnchor165"/>Secure startup configuration</h2>
			<p>Now that you have<a id="_idIndexMarker785"/> defined the purpose of your server, the next step is to securely configure the OS by removing all unnecessary applications, features, and protocols to avoid unnecessary risks.</p>
			<p>This will also reduce the effort in terms of patching because there will be fewer apps to patch and harden while reducing the number of attack vectors.</p>
			<h2 id="_idParaDest-162"><a id="_idTextAnchor166"/>Managing services</h2>
			<p>The first <a id="_idIndexMarker786"/>step is to determine which services are running and the current status.</p>
			<p>To do this, we can issue the following command: </p>
			<pre>service --status-all</pre>
			<p>This command will run a <code>init</code> script that shows the list of services with the associated status. The status is represented in brackets in which <code>[ + ]</code> means that the service is running, <code>[ - ]</code> means that the service is stopped, and <code>[ ? ]</code> is returned for services that do not return a status.</p>
			<p>As seen in the following figure, services such as SQL and <strong class="bold">Bluetooth</strong> are not essential and therefore they are currently disabled:</p>
			<div><div><img src="img/Figure_7.1_B16290.jpg" alt="Figure 7.1 – List of installed services&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.1 – List of installed services</p>
			<p>To obtain <a id="_idIndexMarker787"/>additional information about the services, you can locate each of the <code>init</code> scripts of the services on <code>/etc/init.d</code>.</p>
			<p>For example, the following figure shows the information about the MySQL <code>init</code> script. This information can be useful when determining whether a service is required or not:</p>
			<div><div><img src="img/Figure_7.2_B16290.jpg" alt="Figure 7.2 – MySQL init script&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.2 – MySQL init script</p>
			<p>Additionally, the <a id="_idIndexMarker788"/>script normally supports the <code>start</code> and <code>stop</code> commands to change the status of the services. For example, we can use the following command to start the <code>ssh</code> service:</p>
			<pre>service ssh start</pre>
			<p>The following figure shows how the <code>ssh</code> service was running, how we can successfully stop it, and how we can verify it with the <code>status</code> command:</p>
			<div><div><img src="img/Figure_7.3_B16290.jpg" alt="Figure 7.3 – Stopping a running process&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.3 – Stopping a running process</p>
			<p>Notice that<a id="_idIndexMarker789"/> the <code>status</code> command also gives you additional interesting information such as process uptime, port, PID, memory used, and so on.</p>
			<h3>Managing services in systemd init</h3>
			<p>Another<a id="_idIndexMarker790"/> way to manage the services is with <code>systemd</code> by using the following commands (we will use a <code>mysql</code> service as an example):</p>
			<ul>
				<li>Checking the status of a service (<code>mysql</code>):<pre><code>inactive</code>), while <em class="italic">Figure 7.5</em> shows the output when the service is <code>active (running)</code>:</p></li>
			</ul>
			<div><div><img src="img/Figure_7.4_B16290.jpg" alt="Figure 7.4 – mysql service status&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.4 – mysql service status</p>
			<ul>
				<li>Starting a service (<code>mysql</code>):<pre><code>mysql</code> service is now running:</p></li>
			</ul>
			<div><div><img src="img/Figure_7.5_B16290.jpg" alt="Figure 7.5 – Running service &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.5 – Running service </p>
			<ul>
				<li>To restart a service (<code>mysql</code>):<pre><strong class="bold">systemctl restart mysql</strong></pre></li>
				<li>To check whether a service is configured to start on the next boot-up (<code>mysql</code>):<pre><strong class="bold">systemctl is-enabled mysql</strong></pre></li>
				<li>To enable the <code>mysql</code> service to run on boot-up:<pre><strong class="bold">systemctl enabled mysql</strong></pre></li>
				<li>To disable the <code>mysql</code> service to run on boot-up:<pre><strong class="bold">systemctl disabled mysql</strong></pre></li>
				<li>To check whether the <code>mysql</code> service is<a id="_idTextAnchor167"/> active:<pre><strong class="bold">systemctl is-active mysql</strong></pre></li>
			</ul>
			<p>Keep in mind<a id="_idIndexMarker792"/> that <code>systemd</code> is present in most Unix distributions, however, if it is not present on the system, you will see the following error:</p>
			<pre>systemctl is not installed
systemctl: command not found</pre>
			<p>Now, let's see how to remove services using <code>systemd</code>.</p>
			<h3>Removing services in systemd init</h3>
			<p>Now, let's see some<a id="_idIndexMarker793"/> additional commands to remove services:</p>
			<ul>
				<li>Stop the servic<a id="_idTextAnchor168"/>e (<code>mysql</code>):<pre><strong class="bold">systemctl stop mysql</strong></pre></li>
				<li>Disable the service (<code>mysql</code>):<pre><strong class="bold">systemctl disable mysql</strong></pre></li>
				<li>Remove the service (<code>mysql</code>):<pre><strong class="bold">rm /etc/systemd/system/mysql</strong></pre></li>
				<li>Reload <code>systemd</code>:<pre><strong class="bold">systemctl daemon-reload</strong></pre></li>
				<li>Run <code>systemd</code>:<pre><strong class="bold">Systemctl reset-failed</strong></pre></li>
			</ul>
			<p>The following <a id="_idIndexMarker794"/>figure shows how you can enable and disable services from startup and also how to check the current status:</p>
			<div><div><img src="img/Figure_7.6_B16290.jpg" alt="Figure 7.6 – Enabling/disabling services &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.6 – Enabling/disabling services </p>
			<p>Now that you know how to manage services, it's time to move on to a very interesting topic about <em class="italic">how permissions work on Unix and how to manage them in a secure way</em>.</p>
			<h1 id="_idParaDest-163"><a id="_idTextAnchor169"/>Applying secure file permissions </h1>
			<p>Unix systems have a <a id="_idIndexMarker795"/>unique way to manage permissions, which is quite different from Windows systems, so let's start with the basics about how permissions work in Unix systems.</p>
			<h2 id="_idParaDest-164"><a id="_idTextAnchor170"/>Understanding ownership and permissions</h2>
			<p>Unix systems have three levels <a id="_idIndexMarker796"/>of file/folder ownership and this can be checked with the <code>ls –l</code> command.</p>
			<p>As seen in the following figure, the <a id="_idIndexMarker797"/>command shows us a lot of information such as hard links, who created the file, the file size, the last modification, and the name of the file or folder, and the most important part of <code>ls</code> is the <strong class="bold">permissions</strong>:</p>
			<div><div><img src="img/Figure_7.7_B16290.jpg" alt="Figure 7.7 – Results of the long listing of files (ls -l) &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.7 – Results of the long listing of files (ls -l) </p>
			<p>Now, let's take a look at the <a id="_idIndexMarker798"/>permissions section, as seen in the following figure. The first section is the type of the file (in this example we have <code>d</code> for directory or folder).</p>
			<p>The other types are as follows:</p>
			<ul>
				<li><code>-</code>: Regular file with different extensions such as <code>.txt</code>, <code>.php</code>, <code>.sh</code>, <code>.py</code>, and so on</li>
				<li><code>l</code>: Symbolic link (or symlink or soft link)</li>
				<li><code>c</code>: <code>char</code> file type</li>
				<li><code>b</code>: Block device file</li>
			</ul>
			<div><div><img src="img/Figure_7.8_B16290.jpg" alt="Figure 7.8 – Permissions on Unix &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.8 – Permissions on Unix </p>
			<p>Then we have the permissions. Here, we have three letters (plus a special char) to represent the permissions (<strong class="bold">read</strong>, <strong class="bold">write</strong>, <strong class="bold">execute</strong>, or <strong class="bold">disable</strong>) for the three different types of user (<strong class="bold">User</strong>, <strong class="bold">Group</strong>, or <strong class="bold">Other</strong>):</p>
			<ul>
				<li><strong class="bold">User</strong>: Is the<a id="_idIndexMarker799"/> owner or creator of the file or folder. By default, this indicates who created the file, however, this can be modified.</li>
				<li><strong class="bold">Group</strong>: This <a id="_idIndexMarker800"/>shows the permissions of the users on the specified group (as seen in <em class="italic">Figure 7.7</em>).</li>
				<li><strong class="bold">Other</strong>: Specifies the permissions of the other users who are not the owner (user) and are not part of the specified group.</li>
			</ul>
			<h3>Examples of permissions</h3>
			<p>As seen in the <a id="_idIndexMarker801"/>preceding section, Unix-like systems have four types of permissions:</p>
			<ul>
				<li><strong class="bold">Read</strong>: User can open the file.</li>
				<li><strong class="bold">Write</strong>: User can modify the content of the file.</li>
				<li><strong class="bold">Execute</strong>: User can execute or run the file from the shell.</li>
				<li><strong class="bold">Disable</strong>: No permissions.</li>
			</ul>
			<p>To better understand this, let's see how the permissions are applied:</p>
			<ul>
				<li><code>---</code>: No permissions</li>
				<li><code>--x</code>: Execute-only permissions</li>
				<li><code>-w-</code>: Write-only permissions</li>
				<li><code>-wx</code>: Write and execute permissions</li>
				<li><code>r--</code>: Read permissions</li>
				<li><code>r-x</code>: Read and execute permissions</li>
				<li><code>rw-</code>: Read and write permissions</li>
				<li><code>rwx</code>: Read, write, and execute permissions</li>
			</ul>
			<p>Now, let's see how this will look for the different users:</p>
			<ul>
				<li><code>rwxr-xr-x</code>: User can read, write, and execute, the group and others can only read and execute.</li>
				<li><code>rwxr-xr—</code>: User can read, write and execute, the group can read and execute, and others can only read.</li>
			</ul>
			<p>Remember that when assigning <a id="_idIndexMarker802"/>permissions, you must do it based on the <strong class="bold">Principle of Least Privilege (PoLP)</strong>.</p>
			<h3>Permissions in numeric mode (octal representation)</h3>
			<p>Unix systems have a very <a id="_idIndexMarker803"/>interesting feature in which permissions can also be represented using numbers, which enables the systems to use math to calculate the permissions. To do that, the system has a value for each permission:</p>
			<ul>
				<li><code>4</code></li>
				<li><code>2</code></li>
				<li><code>1</code></li>
			</ul>
			<p>The following figure represents how values are added to calculate permissions in numeric mode:</p>
			<div><div><img src="img/Figure_7.9_B16290.jpg" alt="Figure 7.9 – Permissions in numeric mode &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.9 – Permissions in numeric mode </p>
			<p>Based on the preceding<a id="_idIndexMarker804"/> table, the permissions will now look like this:</p>
			<ul>
				<li>0 (<code>---</code>): No permissions</li>
				<li>1 (<code>--x</code>): Execute-only permissions</li>
				<li>2 (<code>-w-</code>): Write-only permissions</li>
				<li>3 (<code>-wx</code>): Write and execute permissions</li>
				<li>4 (<code>r--</code>): Read permissions</li>
				<li>5 (<code>r-x</code>): Read and execute permissions</li>
				<li>6 (<code>rw-</code>): Read and write permissions</li>
				<li>7 (<code>rwx</code>): Read, write, and execute permissions</li>
			</ul>
			<p>Over time, using numbers may be easier. However, you must be familiar with both representations of permissions, as some commands may input one or the other.</p>
			<h2 id="_idParaDest-165"><a id="_idTextAnchor171"/>Default permissions</h2>
			<p>When creating files, Unix<a id="_idIndexMarker805"/> systems will assign the current default permissions<a id="_idIndexMarker806"/> to the newly created file and, as a data security professional, you must understand how those permissions are assigned. However, you also must understand how you can customize those settings in case you need to apply more restricted permissions for the newly created files.</p>
			<p>We can see the <em class="italic">permissions</em> of a file using the <code>ls -l {file_name}</code> command, but to see the <em class="italic">default permissions</em> let's create a new file using the <code>touch {file_name}</code> command, and then use the previous (<code>ls -l</code>) command to see the permissions that the system assigned by default.</p>
			<p>We created an example in the following figure that shows the <em class="italic">default permissions</em> of a file in our system. In this case, the default permissions are as follows: </p>
			<ul>
				<li><strong class="bold">User (kali)</strong>: Read and write</li>
				<li><strong class="bold">Group (kali)</strong>: Read</li>
				<li><strong class="bold">Others</strong>: Read</li>
			</ul>
			<div><div><img src="img/Figure_7.10_B16290.jpg" alt="Figure 7.10 – File with no execute permissions &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.10 – File with no execute permissions </p>
			<p>You can play with the <a id="_idIndexMarker807"/>commands to get up to speed with Unix systems (create files, delete the files that you just created, list permissions, and so on), but you can also play with conversions to get more familiar with the numeric mode. For example, you can use the permissions shown in <em class="italic">Figure 7.10</em> and convert them to numeric mode by <a id="_idIndexMarker808"/>using the table in <em class="italic">Figure 7.9</em>. This should give you the numeric representation of those permissions, which is <code>644</code>.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Have you noticed a case in which not even <code>root</code> has execute <code>(x)</code> permissions? If yes, don't panic, as that is normal and it may just indicate that the file is not an executable file.</p>
			<p>The following figure shows an example of a file owned by <code>root</code> with no execute permissions. This, as explained, is expected because a log file is not an executable file:</p>
			<div><div><img src="img/Figure_7.11_B16290.jpg" alt="Figure 7.11 – File with no execute permissions &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.11 – File with no execute permissions </p>
			<p>So far, we have seen how permissions are applied to files. Now, it's time to see how permissions work for directories (folders).</p>
			<h2 id="_idParaDest-166"><a id="_idTextAnchor172"/>Permissions in directories (folders)</h2>
			<p>Files and directories<a id="_idIndexMarker809"/> are managed differently/separately in Unix systems, which means also that the <em class="italic">default permissions are configured separately</em>. So, keep this in mind, as this could represent a security vulnerability if both are not configured properly.</p>
			<p>As shown in the following figure, we created a <code>mkdir {directory_name}</code> directory and then we use the <code>ls -ld</code> command to see the default permissions assigned by the system to the directory:</p>
			<div><div><img src="img/Figure_7.12_B16290.jpg" alt="Figure 7.12 – Unix permissions in directories (folders) &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.12 – Unix permissions in directories (folders) </p>
			<p>As you can see, the permissions are very different from the default permissions applied to the files. Let's make a comparison.</p>
			<p>My current default <a id="_idIndexMarker810"/>permissions on files (<code>rw-r--r--</code>) are as follows: </p>
			<ul>
				<li><strong class="bold">User (kali)</strong>: Read and write</li>
				<li><strong class="bold">Group (kali)</strong>: Read</li>
				<li><strong class="bold">Others</strong>: Read</li>
			</ul>
			<p>My current default permissions on directories (<code>rwxr-xr-x</code>) are as follows:</p>
			<ul>
				<li><strong class="bold">User (kali)</strong>: Read, write, and execute</li>
				<li><strong class="bold">Group (kali)</strong>: Read and execute</li>
				<li><strong class="bold">Others</strong>: Read and execute</li>
			</ul>
			<p>Another important item to clarify is that <em class="italic">permissions are a bit different on directories</em>:</p>
			<ul>
				<li><strong class="bold">Read</strong>: User can list the content of the directory.</li>
				<li><strong class="bold">Write</strong>: User can delete or create files in the directory.</li>
				<li><strong class="bold">Execute</strong>: User can access the directory.<p class="callout-heading">What would happen if a user has no access to a folder but full access to a file inside the folder?</p><p class="callout">Just securing the folder and not the files inside is <em class="italic">not</em> a best practice, as the user may still access the file by using a hard link. So, as a best practice, always apply the proper permissions to the folder and the files contained within it.</p></li>
			</ul>
			<h2 id="_idParaDest-167"><a id="_idTextAnchor173"/>Changing default permissions with umask</h2>
			<p>We can change the<a id="_idIndexMarker811"/> default permissions over files <a id="_idIndexMarker812"/>and directories by using the <code>umask</code> command. </p>
			<p>As seen in the following figure, you can type the <code>umask</code> command and it will tell you the <code>umask</code> value for your session:</p>
			<div><div><img src="img/Figure_7.13_B16290.jpg" alt="Figure 7.13 – Checking default permissions with umask &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.13 – Checking default permissions with umask </p>
			<p>But what does <code>022</code> mean?</p>
			<p>To answer that question, let's first do a refresh of some basics. Unix systems have two default permissions: <code>666</code> for files (meaning everyone can read and write) and <code>777</code> for directories (meaning everyone has read, write, and execute permissions). However, to apply that <code>umask</code>, we just need to subtract <code>022</code> from the default value, which will be something like this:</p>
			<p><strong class="bold">File permissions</strong>: </p>
			<p><em class="italic">666 - 022 = 644</em></p>
			<p>Based on <em class="italic">Figure 7.9</em>, <code>644</code> equals <code>rw-r--r--</code>.</p>
			<p>And as you can see in the following figure, the default permissions for files is exactly that:</p>
			<div><div><img src="img/Figure_7.14_B16290.jpg" alt="Figure 7.14 – Default permissions on files &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.14 – Default permissions on files </p>
			<p><strong class="bold">Directory permissions</strong>:</p>
			<p><em class="italic">777 - 022 = 755</em></p>
			<p>Based on <em class="italic">Figure 7.9</em>, <code>755</code> equals <code>rwxr-xr-x</code></p>
			<p>The following figure confirms that the default permissions for directories that are <code>755</code> equal <code>rwxr-xr-x</code>:</p>
			<div><div><img src="img/Figure_7.15_B16290.jpg" alt="Figure 7.15 – Default permissions on directories&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.15 – Default permissions on directories</p>
			<p>Now, to change<a id="_idIndexMarker813"/> the <code>umask</code> value is very simple. Just type<a id="_idIndexMarker814"/> the <code>umask</code> command and the new value.</p>
			<p>For example, if you want to add a more restrictive value, you can use <code>umask 0027</code>, which will provide the following results:</p>
			<p><strong class="bold">File permissions</strong>: </p>
			<p><em class="italic">666 - 027 = 640</em></p>
			<p>Based on <em class="italic">Figure 7.9</em>, <code>640</code> equals <code>rw-r--r--</code>.</p>
			<p>The result of that is that by default, <em class="italic">others</em> won't be able to access those files.</p>
			<p><strong class="bold">Directory permissions</strong>:</p>
			<p><em class="italic">777 - 027 = 750</em></p>
			<p>Based on <em class="italic">Figure 7.9</em>, <code>750</code> equals <code>rwxr-x---</code>.</p>
			<p>The result of that is that by default, <em class="italic">others</em> won't be able to access or even list the content of directories, as shown in the following figure:</p>
			<div><div><img src="img/Figure_7.16_B16290.jpg" alt="Figure 7.16 – Permission denied error&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.16 – Permission denied error</p>
			<p>Note that, for the previous example of <em class="italic">Figure 7.16</em>, the <code>kali</code> user was not the creator of the file and is not part of the group, and therefore is considered as <em class="italic">others</em>.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">You need to be very careful when using this command as it could leave your system very exposed. For example, you should never use <code>umask 000</code>, as it will grant full permissions (<code>rwx</code>) to everyone for all newly created files and folders.</p>
			<h2 id="_idParaDest-168"><a id="_idTextAnchor174"/>Permissions hierarchy</h2>
			<p>In Unix, the more specific <a id="_idIndexMarker815"/>permission takes precedence over the less specific permission.</p>
			<p>This means that <em class="italic">user</em> permissions take priority over <em class="italic">group</em> permissions, and both <em class="italic">user</em> and <em class="italic">group</em> permissions take priority over <em class="italic">other</em> permissions.</p>
			<p>This could be a bit confusing, so to make this easier, let's see an example in the following figure. There, you can see that we created a directory (<code>akira</code>) with the default <code>rwxr-xr-x</code> permissions, and then we used <code>chmod 077</code> to remove the permissions of the <em class="italic">user</em> from <code>rwx</code> (full access) to <code>---</code> (no access):</p>
			<div><div><img src="img/Figure_7.17_B16290.jpg" alt="Figure 7.17 – Precedence of permissions on Unix &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.17 – Precedence of permissions on Unix </p>
			<p>Now, the directory permissions are <code>---rwxrwx</code>. This is very interesting because the <em class="italic">group</em> and <em class="italic">other</em> have full access, but the <em class="italic">user</em> (who created the directory) does not have the permissions to list or access the file.</p>
			<p>Therefore, this means that due to the permissions hierarchy (precedence), everyone can access this directory except the owner.</p>
			<h2 id="_idParaDest-169"><a id="_idTextAnchor175"/>Comparing directory permissions</h2>
			<p>There may be<a id="_idIndexMarker816"/> cases in which you need to compare the permissions of two directories to find inconsistencies that may lead to a security vulnerability:</p>
			<div><div><img src="img/Figure_7.18_B16290.jpg" alt="Figure 7.18 – Comparing folder permissions &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.18 – Comparing folder permissions </p>
			<p>As seen in the preceding figure, you can use the <code>ls -ld {directory1 directory2}</code> command to see the comparison. In this case, we can see that permissions are not the same and this may require adjustments to prevent unauthorized access.</p>
			<h2 id="_idParaDest-170"><a id="_idTextAnchor176"/>Changing permissions and ownership of a single file</h2>
			<p>Changing <a id="_idIndexMarker817"/>permissions on Unix is very simple. Here, you can <a id="_idIndexMarker818"/>use the <code>chmod</code> command, plus the new permissions in numbers as shown in <em class="italic">Figure 7.17</em>, where we changed the permissions to the <code>akira</code> directory to <code>700</code> equals to <code>rwx----.</code><strong class="bold"> </strong></p>
			<p>The command syntax is as follows:</p>
			<pre>chmod {new_permissions} file_name</pre>
			<p>You can also use the <code>chown</code> command to change the ownership of a file.</p>
			<p>The command syntax is as follows:</p>
			<pre>chown {new_owner} file_name</pre>
			<p>And lastly, we can also change the group owning the file by using the <code>chgrp</code> command.</p>
			<p>The command syntax is as follows:</p>
			<pre>chgrp {new_group} file_name</pre>
			<p>Another interesting command is <code>chattr</code>, which enables the user to change a set of attributes on a file. To see more information about all the attributes that can be changed with this command, visit <a href="http://manpages.org/chattr">http://manpages.org/chattr</a>.</p>
			<h2 id="_idParaDest-171"><a id="_idTextAnchor177"/>Useful commands to search for unwanted permissions</h2>
			<p>There may be <a id="_idIndexMarker819"/>cases in which you need to check the permissions to determine whether they were applied as expected or whether something needs to be corrected (restricted) to maintain the security of the files.</p>
			<p>The following is a list of useful commands that you can leverage to perform this important task:</p>
			<ul>
				<li><strong class="bold">Find all files readable by other</strong>: Display all files within the current directory that are readable by <em class="italic">other</em>. Many of these files are located in hidden directories and are generally harmless. However, if any confidential or sensitive files appear on this list (such as SSH keys), then the permissions must be modified to ensure the confidentiality of the data:<pre><strong class="bold">find . -perm /004 -type f -print0 | xargs -0 ls -l</strong></pre></li>
				<li><strong class="bold">Find all files accessible by other in any way</strong>: This will display all files within your home directory that have read, write, or execute permissions for <em class="italic">other</em>. This is useful for getting a general idea of what other users can access in your home directory and applying any restrictive actions if needed:<pre><strong class="bold">find ~ -perm /007 -type f -print0 | xargs -0 ls -l</strong></pre></li>
				<li><strong class="bold">Find all files writable by other</strong>: Display all files in the specified directory that are writable by <em class="italic">other</em>. <p>All the files on this list must be carefully analyzed to determine whether they need to be writable by <em class="italic">other</em>. Otherwise, the permissions must be adjusted to prevent any impact on the integrity of the data:</p><pre><strong class="bold">find /{directory_name} -perm /002 -type f -print0 | xargs -0 ls -l</strong></pre></li>
				<li><strong class="bold">Find all files executable by user or group, and writable by other</strong>: Display all files in the home directory that are both writable by <em class="italic">other</em> and executable by either the user or the group that owns the file. <p>If you found a file that can be executed by <em class="italic">other</em>, then you must analyze whether there is a valid exception for that behavior. Otherwise, the file permissions need to be changed immediately to prevent any impact on the integrity and availability of the files:</p><pre><strong class="bold">find ~ -perm -102 -type f -print0 | xargs -0 ls -l  # User</strong>
<strong class="bold">find ~ -perm -012 -type f -print0 | xargs -0 ls -l  # Group</strong></pre></li>
				<li><strong class="bold">Find all files not owned by a specific group</strong>: Display all files in the current working <a id="_idIndexMarker820"/>directory that <em class="italic">are not</em> owned by the specified group:<pre><strong class="bold">find . -not -group {group_name} -type f -print0 | xargs -0 ls -l</strong></pre></li>
				<li><strong class="bold">Find all files owned by a specific group</strong>: Display all files in your home directory that <em class="italic">are</em> owned by the specified group:<pre><strong class="bold">find ~ -group {group_name} -type f -print0 | xargs -0 ls -l</strong></pre></li>
			</ul>
			<p>Now that you are a master with permissions on Unix systems, let's see how we expand all that knowledge by leveraging <strong class="bold">Access Control Lists</strong> (<strong class="bold">ACLs</strong>) to enhance the security of your Unix server.</p>
			<h1 id="_idParaDest-172"><a id="_idTextAnchor178"/>Enhancing the protection of the server by improving your access controls</h1>
			<p><strong class="bold">ACLs</strong> enable<a id="_idIndexMarker821"/> Unix administrators to apply detailed fine-tuning of permissions that may not be possible to achieve with the commands specified in the previous section. Therefore, let's explore how to work with ACLs so that you can take advantage of them to enhance the application and management of permissions.</p>
			<h2 id="_idParaDest-173"><a id="_idTextAnchor179"/>Viewing ACLs</h2>
			<p>First, you<a id="_idIndexMarker822"/> can use the <code>getfacl {file_name}</code> command to see the ACL of the specified file.</p>
			<p>The following figure shows an example of a file with and without an ACL. Notice that, when the file has an ACL, it adds a new line with the permissions of the specified user on the ACL, in this case, the <code>cesar</code> user and their associated permissions (<code>rwx</code>):</p>
			<div><div><img src="img/Figure_7.19_B16290.jpg" alt="Figure 7.19 – View of the getfacl command&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.19 – View of the getfacl command</p>
			<p>You can also identify whether a file has an ACL by doing a long listing (<code>ls –l</code>):</p>
			<div><div><img src="img/Figure_7.20_B16290.jpg" alt="Figure 7.20 – Listing of a file with an ACL&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.20 – Listing of a file with an ACL</p>
			<p>The preceding figure shows that the <code>bravo</code> file has a <code>+</code> sign at the end of the permissions, which indicates that the file has an ACL.</p>
			<h2 id="_idParaDest-174"><a id="_idTextAnchor180"/>Managing ACLs</h2>
			<p>To set an <a id="_idIndexMarker823"/>ACL on a file, you can use the <code>setfacl</code> command.</p>
			<p>In the following example, we show the syntax of the command in which we want to create an ACL for the <code>bravo</code> file to provide <code>rwx</code> permissions to the <code>cesar</code> user:</p>
			<pre>setfacl -m u:cesar:rwx bravo</pre>
			<p>You can also create <a id="_idIndexMarker824"/>ACLs for groups by using <code>g</code> (groups) instead of <code>u</code> (user). In the following example, you can see how we are creating an ACL for the <code>bravo</code> file to <em class="italic">add read and write permissions</em> to the <code>managers</code> group:</p>
			<pre>setfacl -m g:managers:rw bravo</pre>
			<p>Now, let's explore more uses of the <code>setfacl</code> command.</p>
			<h2 id="_idParaDest-175"><a id="_idTextAnchor181"/>Default ACL on directories</h2>
			<p>When creating <a id="_idIndexMarker825"/>default ACLs on directories, any files created within that directory will also have that default ACL inherit automatically.</p>
			<p>To achieve this, we are going to use the same <code>setfacl</code> command but with some different parameters. In this example, we are creating a default ACL for the <code>bravito</code> folder to provide read access to <code>cesar</code>:</p>
			<pre>setfacl -m default:u:cesar:r bravito</pre>
			<p>The following figure shows how the <code>bravisimo</code> file inherits the permissions of <code>cesar</code> from the default ACL that we just created for the <code>bravito</code> directory:</p>
			<div><div><img src="img/Figure_7.21_B16290.jpg" alt="Figure 7.21 – Default ACL on a directory&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.21 – Default ACL on a directory</p>
			<p>Now, let's see how you can also use this command to remove an ACL.</p>
			<h2 id="_idParaDest-176"><a id="_idTextAnchor182"/>Removing ACLs </h2>
			<p>To remove a<a id="_idIndexMarker826"/> specific ACL, use the same <code>setfacl</code> command, but replace the <code>-m</code> parameter with <code>–x</code>:</p>
			<pre>setfacl -x u:cesar bravisimo</pre>
			<p>The following figure shows how the ACL for the <code>cesar</code> user was successfully removed: </p>
			<div><div><img src="img/Figure_7.22_B16290.jpg" alt="Figure 7.22 – Removing the ACL of a user&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.22 – Removing the ACL of a user</p>
			<p>However, you may notice that the mask is still there, so the ACL was not completely removed. </p>
			<p>As seen in <em class="italic">Figure 7.23</em>, to completely remove the ACL from the <code>bravo</code> file, you need to use the following command:</p>
			<pre>setfacl -b bravo</pre>
			<p>Also, in the following figure, notice that after issuing this command, the <code>+</code> sign was also removed at the end of the permissions (see the result of <code>ls -l</code>):</p>
			<div><div><img src="img/Figure_7.23_B16290.jpg" alt="Figure 7.23 – Complete removal of the ACL from a file&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.23 – Complete removal of the ACL from a file</p>
			<p>Additionally, you can <a id="_idIndexMarker827"/>also see that <code>mask</code> is no longer present when checking the ACL with the <code>getfacl</code> command.</p>
			<h2 id="_idParaDest-177"><a id="_idTextAnchor183"/>Enhanced access controls</h2>
			<p>There are <a id="_idIndexMarker828"/>additional systems designed to enhance the access <a id="_idIndexMarker829"/>controls by implementing security policies. One of those systems is the well-known <strong class="bold">SELinux</strong>. </p>
			<p>SELinux access controls are determined by a set of policies loaded on the system kernel that enable an improved security mechanism that prevents the change of permissions by careless users or misbehaving applications.</p>
			<p>The installation, configuration, and settings of <em class="italic">SELinux</em> may vary between the different versions of Unix, so<a id="_idIndexMarker830"/> in this case, it is better to check the specific settings for your Unix system by visiting their official site at <a href="http://selinuxproject.org/page/Main_Page">http://selinuxproject.org/page/Main_Page</a>.</p>
			<p>OK, now that you are an expert in managing Unix permissions, it's time to see how you can enhance the security of your Unix machine by leveraging <strong class="bold">host-based firewalls</strong>.</p>
			<h1 id="_idParaDest-178"><a id="_idTextAnchor184"/>Configuring host-based firewalls</h1>
			<p>We are all familiar with<a id="_idIndexMarker831"/> firewalls as devices to regulate incoming and outgoing network traffic to prevent the entry of malicious code or attacks and to prevent the exfiltration of data.</p>
			<p>Host-based firewalls are firewall rules that can be activated at the OS level so that you can apply incoming and outgoing network traffic protection for your system.</p>
			<p>One feature of host-based firewalls is that they are configured per system, offering a higher level of flexibility when needed.</p>
			<p>There are several host-based firewalls for Unix systems, such as <strong class="bold">iptables</strong>, <strong class="bold">firewalld</strong>, <strong class="bold">netfilter</strong>, <strong class="bold">ipfw</strong>, and more. </p>
			<h2 id="_idParaDest-179"><a id="_idTextAnchor185"/>Understanding iptables</h2>
			<p>iptables is used<a id="_idIndexMarker832"/> to set up, maintain, and review the tables of the IPv4 and IPv6 packet filter rules in the Linux kernel.</p>
			<p>To understand iptables, we need to first understand its components.</p>
			<h3>Chains</h3>
			<p>Chains are the set of <a id="_idIndexMarker833"/>rules defined for a particular task.</p>
			<p>iptables uses three sets of rules (chains) to manage traffic: <strong class="bold">input chains</strong>, <strong class="bold">output chains</strong>, and <strong class="bold">forward chains</strong>:</p>
			<ul>
				<li><strong class="bold">Input chains</strong>: These<a id="_idIndexMarker834"/> are the rules applied to incoming traffic from the<a id="_idIndexMarker835"/> network to the local machine.</li>
				<li><strong class="bold">Output chains</strong>: These are <a id="_idIndexMarker836"/>the rules applied to outgoing traffic from the <a id="_idIndexMarker837"/>network to the local machine.</li>
				<li><strong class="bold">Forward chains</strong>: These are<a id="_idIndexMarker838"/> the rules applied to packets that are neither<a id="_idIndexMarker839"/> emitted by the host nor directed to the host. They are the packets that the host is merely routing.</li>
			</ul>
			<h3>Policies</h3>
			<p>iptables uses three policies or actions: <strong class="bold">Accept</strong>, <strong class="bold">Drop</strong>, and <strong class="bold">Reject</strong>:</p>
			<ul>
				<li><strong class="bold">Accept</strong>: Traffic<a id="_idIndexMarker840"/> is accepted and transferred to the application or systems for processing.</li>
				<li><strong class="bold">Drop</strong>: Traffic is<a id="_idIndexMarker841"/> blocked and not processed.</li>
				<li><strong class="bold">Reject</strong>: Similar to Drop, but it <a id="_idIndexMarker842"/>sends a return error to the host that the package was blocked.<p class="callout-heading">Tip</p><p class="callout">Rules in iptables are checked from top to bottom. So, be careful when creating and inserting rules to avoid any accidental bypass.</p></li>
			</ul>
			<p>OK, enough theory, let's see how you can configure them.</p>
			<h2 id="_idParaDest-180"><a id="_idTextAnchor186"/>Configuring iptables</h2>
			<p>We need to start by<a id="_idIndexMarker843"/> checking the current iptables with the following command:</p>
			<pre>sudo iptables -L</pre>
			<p>When running this command, we can see the three chains (<code>INPUT</code>, <code>FORWARD</code>, and <code>OUTPUT</code>), but as seen in the following figure, by default there are no predefined rules:</p>
			<div><div><img src="img/Figure_7.24_B16290.jpg" alt="Figure 7.24 – Default iptables&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.24 – Default iptables</p>
			<p>Now, let's explore the <a id="_idIndexMarker844"/>meaning of each of the columns shown in the preceding figure:</p>
			<ul>
				<li><code>target</code>: Defines the actions (or policies) to be performed (<code>ACCEPT</code>, <code>DROP</code>, <code>REJECT</code>).</li>
				<li><code>prot</code>: Determines which protocol this will be applied to.</li>
				<li><code>source</code>: Address of the source of the packet.</li>
				<li><code>destination</code>: Address of the destination of the packet.</li>
			</ul>
			<p>As you saw in <em class="italic">Figure 7.24</em>, the default policy for all chains (<code>INPUT</code>, <code>FORWARD</code>, and <code>OUTPUT</code>) is <code>ACCEPT</code>. So, let's explore how you can change this.</p>
			<h3>Changing the default policy</h3>
			<p>You can easily change the<a id="_idIndexMarker845"/> default policy for all chains (<code>INPUT</code>, <code>FORWARD</code>, and <code>OUTPUT</code>) to apply more restrictive permissions to a specific chain by using the following command:</p>
			<pre>sudo iptables -P FORWARD DROP</pre>
			<p>The following figure shows the result of the command, and now you can see how the default permissions for the <code>FORWARD</code> chain is <code>DROP</code>:</p>
			<div><div><img src="img/Figure_7.25_B16290.jpg" alt="Figure 7.25 – Default iptables&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.25 – Default iptables</p>
			<p>Now it's time to see how to block incoming traffic with iptables.</p>
			<h3>Blocking incoming traffic with iptables</h3>
			<p>Imagine that<a id="_idIndexMarker846"/> you identify an IP address that is known for sending DDOS attacks (<code>14.14.14.14</code>).</p>
			<p>We can easily block all incoming traffic from that IP address with the following command:</p>
			<pre>sudo iptables -A INPUT -s 14.14.14.14 -j DROP</pre>
			<p>Now, let's explore the parameters of the command:</p>
			<ul>
				<li><code>-A</code>: This is used to append the rule at the end of the chain (you can use <code>-I</code> to append the rule to the top of the chain).</li>
				<li><code>-s</code>: Specifies the source of the packet (in this case, the IP address of the attacker).</li>
				<li><code>-j</code>: Specifies the action or policy to be applied to the packet.</li>
			</ul>
			<div><div><img src="img/Figure_7.26_B16290.jpg" alt="Figure 7.26 – Blocking incoming traffic with iptables&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.26 – Blocking incoming traffic with iptables</p>
			<p>The preceding figure shows the newly created rule on iptables.</p>
			<h3>Whitelisting an IP with iptables</h3>
			<p>We can also use<a id="_idIndexMarker847"/> iptables to whitelist or accept traffic from a given source by using the following command:</p>
			<pre>sudo iptables -I INPUT -s 192.168.1.14 -j ACCEPT</pre>
			<p>The following figure shows the results of the preceding command and how the <code>-I</code> parameter placed the rule on top of the chain:</p>
			<div><div><img src="img/Figure_7.27_B16290.jpg" alt="Figure 7.27 – Whitelisting an address with iptables&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.27 – Whitelisting an address with iptables</p>
			<p>Now, let's see how to remove policies from iptables.</p>
			<h3>Removing all policies from iptables</h3>
			<p>There are many<a id="_idIndexMarker848"/> situations in which you may need to remove all <a id="_idIndexMarker849"/>policies from iptables, for example, if you inherited a new server and the current rules are confusing and you want to use your own super-secure rules. Or, maybe you just want to clear all the mess you made to write a book. The good news is that achieving that is very easy with the following command:</p>
			<pre>sudo iptables -F</pre>
			<p>Now, as seen in the following figure, the iptables were flushed and look like new:</p>
			<div><div><img src="img/Figure_7.28_B16290.jpg" alt="Figure 7.28 – Flushing the iptable rules&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.28 – Flushing the iptable rules</p>
			<p>Flushing iptables is also a common troubleshooting step when facing network issues. However, you must set the required controls to avoid this being performed indiscriminately. Additionally, <em class="italic">any change to iptables should be logged and approved by a security analyst to ensure that another security mechanism is set in its place</em>.</p>
			<p class="callout-heading">Did you notice something in Figure 7.28? </p>
			<p class="callout">I am sure you did – this command just removed the policies that you created, but it did not change the default chain for <code>FORWARD</code> that we established earlier (we changed it from <code>ACCEPT</code> to <code>DROP</code>). So, make sure you pay attention to this when flushing the iptables.</p>
			<p>Now, let's see how you can also use iptables to protect against some threats.</p>
			<h2 id="_idParaDest-181"><a id="_idTextAnchor187"/>SSH brute-force protection with iptables</h2>
			<p>You can use the following<a id="_idIndexMarker850"/> iptables rules to block IP addresses that <a id="_idIndexMarker851"/>attempt more than a given number of SSH connections in <code>X</code> seconds. Here is an example to block an IP address if there are more than eight SSH connections in 45 seconds:</p>
			<pre>iptables -A INPUT -p tcp --dport ssh -m conntrack --ctstate NEW -m recent --set
iptables -A INPUT -p tcp --dport ssh -m conntrack --ctstate NEW -m recent --update --seconds 45 --hitcount 8 -j DROP</pre>
			<p>Notice that the first command is used to track new connections coming in on port <code>22</code> (SSH), while the second command tells iptables to drop packets from a given IP address that has sent eight or more requests in 45 seconds.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">If you want to insert these two rules at the top of your <code>INPUT</code> chain (to trigger them before the rest of your rules), use <code>-I</code> instead of <code>-A</code> as the first parameter.</p>
			<p>Another good option is to use <em class="italic">whitelisting</em> as this enables you to allow one or more IPs to access your server while dropping everything else.</p>
			<p>Here is the command to use this technique:</p>
			<pre>iptables -I INPUT -p tcp -s 10.10.10.10,192.168.1.14 --dport ssh -j ACCEPT
iptables -I INPUT -p tcp --dport ssh -j DROP</pre>
			<p>The preceding example will allow SSH connections ONLY from those two IP addresses while blocking any access from any other IP address.</p>
			<h2 id="_idParaDest-182"><a id="_idTextAnchor188"/>Protecting from port scanning with iptables</h2>
			<p>There are<a id="_idIndexMarker852"/> several ways to protect from port scanning with iptables, however, this is my favorite:</p>
			<pre>iptables -N PORT-PROTECT
iptables -A PORT-PROTECT -p tcp --syn -m limit --limit 2000/hour -j RETURN
iptables -A PORT-PROTECT -m limit --limit 200/hour -j LOG --log-prefix "DROPPED Port scan: "
iptables -A PORT-PROTECT -j DROP
iptables -A INPUT -p tcp --syn -j PORT-PROTECT</pre>
			<p>In this example, we are assuming that there is not a valid reason for a host to send me <code>200 SYN</code> requests in 1 hour, so we can use this as the security trigger parameter. However, you can adjust that number based on your own judgment. </p>
			<p>There are many more things you can do with iptables, such as implementing rules for a specific port to delete a given rule. You can explore these and configure your iptables as needed.</p>
			<p>A best <a id="_idIndexMarker853"/>practice is to perform a regular check of iptables to confirm that the settings were not changed. A common mistake is that system owners or administrators may remove some rules during network troubleshooting. In those cases, the root cause must be investigated to fix the issue, and if an iptable rule must be removed or disabled, then you need to make sure that another control, policy, or system is set in place to cover that potential security gap originated by the removal of the iptable rule. </p>
			<h1 id="_idParaDest-183"><a id="_idTextAnchor189"/>Advanced management of logs</h1>
			<p>As you may know, logs are<a id="_idIndexMarker854"/> records of the activities or actions on a given system, OS, or application. They are really important as a source of truth during investigations to determine what can be the cause of downtime, or any other incident.</p>
			<p>Best practices state that all logs must be enabled to ensure that you keep track of everything that is happening in your system. Remember, logs are the main source of information during audits or forensic analysis, therefore, you need to make sure they are available for them.</p>
			<p>Additionally, nowadays, the cost of storage is really low, so it would be hard for you to justify that a log was disabled to <em class="italic">save space</em>.</p>
			<p>Another good practice is to keep all logs centralized on an external device, so in case of a full system failure or hard drive crash, you will still be able to retrieve the logs. Furthermore, attackers normally cover their tracks by deleting the logs, but having an external copy of the logs will make it harder for the attacker to delete their tracks from them (because the <a id="_idIndexMarker855"/>attacker will have to also compromise the other system where the logs are backed up or centralized).</p>
			<h2 id="_idParaDest-184"><a id="_idTextAnchor190"/>Leveraging the logs</h2>
			<p>A <strong class="bold">Security Information and Event Management (SIEM) system</strong> can collect and leverage all those<a id="_idIndexMarker856"/> logs (data) and, after some training, configuration, and<a id="_idIndexMarker857"/> correlation, transform that data into useful security insights (information and knowledge).</p>
			<p>The value of those systems is that they can analyze huge amounts of data from logs (which is normally wasted) to detect patterns and uncover vulnerabilities. They even have the power to detect ongoing<a id="_idIndexMarker858"/> attacks (including <strong class="bold">advanced persistent threats</strong>).</p>
			<p>Another good feature of SIEM systems is that they allow you to easily find known signs of attacks, for example, the following signs:</p>
			<ul>
				<li>Repeated failed login attempts at the same hour, every <code>X</code> number of days</li>
				<li>An abnormal number of login attempts</li>
				<li>Logins at unusual hours from unknown addresses</li>
				<li>Unknown addresses trying to log in on several systems</li>
				<li>Login attempts with default credentials (<code>admin</code>/<code>admin</code>)</li>
			</ul>
			<p>Also, remember that you can also collect logs from other devices such as routers, proxies, and firewalls. These are extremely important because some of them can alert you about some hard-to-detect attacks, such as a zombie machine infected to carry out crypto mining, DDOS attacks, and more. </p>
			<p>You can also collect valuable information from some <strong class="bold">IoT</strong> devices and <strong class="bold">SCADA</strong> systems. These can provide early warnings, as less-protected systems are normally the doors that criminals use to get into your infrastructure. Detecting this on time may help you to prevent them from gaining access to more valuable assets and data in your infrastructure.</p>
			<h1 id="_idParaDest-185"><a id="_idTextAnchor191"/>Summary</h1>
			<p>Congratulations! You are now a master in securing Unix servers, and let me tell you why.</p>
			<p>First, you learned all about <em class="italic">Unix services</em>, including how they work and how they can be managed.</p>
			<p>We also covered a very complex topic, <em class="italic">Unix permissions</em>, in a very smooth and easy way, including how to handle them using octal representation.</p>
			<p>Then, we also learned about the different <em class="italic">types of permissions</em> on Unix systems, and how to properly manage them.</p>
			<p>Additionally, we reviewed how we can leverage <code>umask</code> for advanced configuration of default permissions.</p>
			<p>You also learned how to enhance the security of your systems by <em class="italic">leveraging access controls</em>, and how to configure them.</p>
			<p>Finally, you also learned what a <em class="italic">host-based firewall</em> is, and how to configure one using <em class="italic">iptables</em>.</p>
			<p>Now, grab a cup of coffee and get prepared, because in the next chapter, you will acquire all the skills that you need to protect your network.</p>
			<h1 id="_idParaDest-186"><a id="_idTextAnchor192"/>Further reading</h1>
			<ul>
				<li>If you want to learn more about SELinux, you can visit its official repository: <a href="https://github.com/SELinuxProject/selinux">https://github.com/SELinuxProject/selinux</a>.</li>
				<li>To learn more about iptable configuration, you can check out the following book: <a href="https://help.ubuntu.com/community/IptablesHowTo">https://help.ubuntu.com/community/IptablesHowTo</a>.</li>
				<li>Here, you can download the latest version of Kali Linux for free: <a href="https://www.kali.org/downloads/">https://www.kali.org/downloads/</a>.</li>
			</ul>
		</div>
	</body></html>