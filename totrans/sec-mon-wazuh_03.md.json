["```\n    $ sudo apt update\n    $ sudo apt install -y apt-transport-https ca-certificates curl gnupg-agent software-properties-common\n    ```", "```\n    $ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\n    $ sudo add-apt-repository \\ \"deb [arch=amd64] https://download.docker.com/linux/ubuntu \\ $(lsb_release -cs) stable\"\n    ```", "```\n    $ sudo apt-get update\n    $ sudo apt install docker-ce –y\n    ```", "```\n    $ sudo usermod -aG docker rajneesh\n    $ sudo usermod -aG docker root\n    $ docker version\n    ```", "```\n    $ sudo systemctl status docker\n    ```", "```\n    $ sudo curl -L \"https://github.com/docker/compose/releases/download/1.29.0/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n    $ sudo chmod +x /usr/local/bin/docker-compose\n    ```", "```\n    $ docker-compose --version\n    ```", "```\n    $ mkdir theHive\n    docker-compose.yml is a configuration file that allows us to configure and launch multiple Docker containers within a single file. Let’s create a docker-compose.yml file with the code shared in the GitHub repository at https://github.com/PacktPublishing/Security-Monitoring-using-Wazuh/blob/main/Chapter%203/theHive_Docker_Compose.yml.You can also find the YML code from the link here: [https://docs.strangebee.com/thehive/setup/installation/docker/](https://docs.strangebee.com/thehive/setup/installation/docker/)\n    ```", "```\n$ docker-compose up -d\n```", "```\n    template.env to .env (on the root directory) and edit the environment variables in the .env file:\n    ```", "```\n    $ cp template.env .env\n    ```", "```\n    $ nano .env \n    and set the MISP_BASEURL to https://<Server_IP>\n    ```", "```\n    MYSQL_HOST=misp_db\n    MYSQL_DATABASE=misp\n    MYSQL_USER=misp\n    MYSQL_PASSWORD=misp\n    MYSQL_ROOT_PASSWORD=misp\n    MISP_ADMIN_EMAIL=admin@admin.test\n    MISP_ADMIN_PASSPHRASE=admin\n    MISP_BASEURL=https://<Server_IP>\n    POSTFIX_RELAY_HOST=relay.fqdn\n    TIMEZONE=Europe/Brussels\n    DATA_DIR=./data\n    ```", "```\n    https://<MISP_Server_IP>.The default credentials are as follows:*   Username: `admin@admin.test`*   Password: `admin`\n    ```", "```\nsudo /var/ossec/framework/python/bin/pip3 install thehive4py\n```", "```\n#!/var/ossec/framework/python/bin/python3\nimport json\nimport sys\nimport os\nimport re\nimport logging\nimport uuid\nfrom thehive4py.api import TheHiveApi\n=\n```", "```\nlvl_threshold=0\nsuricata_lvl_threshold=3\ndebug_enabled = False\ninfo_enabled = True\n```", "```\nsudo chmod 755 /var/ossec/integrations/custom-w2thive.py\nsudo chown root:wazuh /var/ossec/integrations/custom-w2thive.py\n```", "```\nWPYTHON_BIN=\"framework/python/bin/python3\"\nSCRIPT_PATH_NAME=\"$0\"\nDIR_NAME=\"$(cd $(dirname ${SCRIPT_PATH_NAME}); pwd -P)\"\nSCRIPT_NAME=\"$(basename ${SCRIPT_PATH_NAME})\"\n```", "```\ncase ${DIR_NAME} in\n    */active-response/bin | */wodles*)\n        if [ -z \"${WAZUH_PATH}\" ]; then\n            WAZUH_PATH=\"$(cd ${DIR_NAME}/../..; pwd)\"\n        fi\n    PYTHON_SCRIPT=\"${DIR_NAME}/${SCRIPT_NAME}.py\"\n    ;;\n    */bin)\n    if [ -z \"${WAZUH_PATH}\" ]; then\n        WAZUH_PATH=\"$(cd ${DIR_NAME}/..; pwd)\"\n    fi\n    PYTHON_SCRIPT=\"${WAZUH_PATH}/framework/scripts/${SCRIPT_NAME}.py\"\n    ;;\n     */integrations)\n        if [ -z \"${WAZUH_PATH}\" ]; then\n            WAZUH_PATH=\"$(cd ${DIR_NAME}/..; pwd)\"\n        fi\n    PYTHON_SCRIPT=\"${DIR_NAME}/${SCRIPT_NAME}.py\"\n    ;;\nEsac\n```", "```\n${WAZUH_PATH}/${WPYTHON_BIN} ${PYTHON_SCRIPT} $@\n```", "```\nsudo chmod 755 /var/ossec/integrations/custom-w2thive\nsudo chown root:wazuh /var/ossec/integrations/custom-w2thive\n```", "```\n<ossec_config>\n…\n  <integration>\n    <name>custom-w2thive</name>\n    <hook_url>http://TheHive_Server_IP:9000</hook_url>\n    <api_key>RWw/Ii0yE6l+Nnd3nv3o3Uz+5UuHQYTM</api_key>\n    <alert_format>json</alert_format>\n  </integration>\n…\n</ossec_config>\n```", "```\nsudo systemctl restart wazuh-manager\n```"]