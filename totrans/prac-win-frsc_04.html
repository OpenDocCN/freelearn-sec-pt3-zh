<html><head></head><body><div class="chapter" title="Chapter&#xA0;4.&#xA0;Nonvolatile Data Acquisition"><div class="titlepage"><div><div><h1 class="title"><a id="ch04"/>Chapter 4. Nonvolatile Data Acquisition</h1></div></div></div><p>In this chapter, we will discuss the acquisition of <span class="strong"><strong>Hard Disk Drives</strong></span> or <span class="strong"><strong>HDD</strong></span>. Data acquisition is critical because performing analysis on the original hard drive may cause failure on the only hard drive that contains the data or you may write to that original hard drive by mistake.</p><p>So, creating a forensics image from the hard drive must be performed prior to the analysis. The acquisition of the HDD can be either conducted at the incident scene or in the analysis lab, on a live or a powered off system, and over network or locally, as we will see in this chapter.</p><p>In a nutshell, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Forensic image</li><li class="listitem" style="list-style-type: disc">Incident response CDs</li><li class="listitem" style="list-style-type: disc">Live imaging of a hard drive</li><li class="listitem" style="list-style-type: disc">Linux for the imaging of a hard drive</li><li class="listitem" style="list-style-type: disc">Virtualization in data acquisition</li><li class="listitem" style="list-style-type: disc">Evidence integrity</li><li class="listitem" style="list-style-type: disc">Disk wiping in Linux</li></ul></div><div class="section" title="Forensic image"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec21"/>Forensic image</h1></div></div></div><p>Imaging of a hard drive is the process of creating an exact forensic image of the victim or the suspect hard drive in order to conduct the analysis on the imaged hard drive instead of the original one. To create an exact copy of the hard drive, there are two options that can be followed:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Duplication</strong></span>: This is where the destination of this process is the whole hard drive. In some references, this step can be addressed as cloning when the destination hard drive has the same brand, model, and size of the source hard drive. Duplication can be conducted using what are called <span class="strong"><strong>forensic hardware  duplicators</strong></span>. These are hardware devices, which basically have two interfaces for the source and the destination hard drives. Once they start operating, they will just copy blocks of data from the source to the destination regardless of the structure of the filesystem that is used in the source hard drive.<p>Usually, hardware duplication is faster than other software tools as it operates in wire speed. Some duplicators have special capabilities, such as performing some search operations during acquisition, or they can create up to eight duplicates in the same period of time. Duplication can also be performed with software tools, such as <code class="literal">dd</code> if the destination of the tool is a complete hard drive, not a file. This will be discussed later in this chapter.</p></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Imaging</strong></span>: This is where the destination of the hard drive is a container file or image file. This image may have different formats, which will also be discussed later in this chapter.</li></ul></div><p>In the following section, some techniques and tools—which include both software duplication and imaging—will be illustrated.</p></div></div>
<div class="section" title="Incident Response CDs"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec22"/>Incident Response CDs</h1></div></div></div><p>Due to the needed speed in the <span class="strong"><strong>Incident Response</strong></span> (<span class="strong"><strong>IR</strong></span>) process, the usage of incident response CDs can save precious time. IR CDs usually are Linux distributions. These distributions contain many incident response and digital forensic tools, which aim to boot mainly from the target system to acquire different types of possible evidence without the need to disconnect the hard drive.</p><p>This is designed to leave the least traces on the target system, so it boots with write protection enabled by default to all the connected hard drives. This gives the user the ability to grant the write access to the destination hard drive only. It is better to not connect to the destination hard drive until the system boots from the incident response CD. Of course, booting from the IR CD means that the system under investigation is down, and you will start the machine and boot from the CD. No running system memory is available in this case.</p><p>IR CDs also have the ability to acquire the memory and the hard drive of a live system. You need to insert the CD and run the imaging program to acquire the memory and the hard drive.</p><p>In the following sections, we will discuss some examples of the available IR CDs.</p><div class="section" title="DEFT"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec43"/>DEFT</h2></div></div></div><p><span class="strong"><strong>Digital Evidence and Forensics Toolkit</strong></span> (<span class="strong"><strong>DEFT</strong></span>) contains many acquisition and analysis tools that can be used in the on-scene analysis approach when the investigator boots the machine from it:</p><div class="mediaobject"><img src="graphics/image_04_001.jpg" alt="DEFT"/><div class="caption"><p>A booted DEFT CD</p></div></div><p>DEFT also comes with <span class="strong"><strong>Digital Advanced Response Toolkit</strong></span> (<span class="strong"><strong>DART</strong></span>). DART can run in the Windows live system, and it has a good and different collection of tools in each part of the incident response steps. Using DART you can perform the following actions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Acquire the Windows memory and hard drive</li><li class="listitem" style="list-style-type: disc">Perform live data recovery when needed</li><li class="listitem" style="list-style-type: disc">Conduct some forensics analysis on some Windows artifacts</li><li class="listitem" style="list-style-type: disc">Collect information about the running system</li><li class="listitem" style="list-style-type: disc">Monitor the system networking</li></ul></div><p>You can view the DART interface in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_04_002.jpg" alt="DEFT"/><div class="caption"><p>Incident response tool DART</p></div></div></div><div class="section" title="Helix"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec44"/>Helix</h2></div></div></div><p>Helix is an IR CD that has both free and commercial versions. It can work with three operating systems: <span class="strong"><strong>Windows</strong></span>, <span class="strong"><strong>Linux</strong></span>, and <span class="strong"><strong>Mac</strong></span> in live acquisition. This is displayed in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_04_003.jpg" alt="Helix"/><div class="caption"><p>Figure A: Different OS support in Helix in live acquisition</p></div></div><p>Like DEFT, you can boot from the Helix CD in case of a powered off system. In this case, you can clone the hard drive to another hard drive and perform the same function of the hard drive duplicators. Go to <span class="strong"><strong>Applications</strong></span> | <span class="strong"><strong>Acquisition and Analysis</strong></span> | <span class="strong"><strong>Helix pro</strong></span>. In the opened window, you can duplicate the hard drive or image up to four images either from the system memory or the system hard drive. Helix can also calculate the images' hash functions: MD5, SHA1, SHA256, or SHA512, or altogether:</p><div class="mediaobject"><img src="graphics/image_04_004.jpg" alt="Helix"/><div class="caption"><p>Booting from the Helix IR CD</p></div></div></div></div>
<div class="section" title="Live imaging of a hard drive"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec23"/>Live imaging of a hard drive</h1></div></div></div><p>In case of a live system, you will need to do the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Image the volatile data, such as system memory first as discussed earlier</li><li class="listitem" style="list-style-type: disc">Power the system down</li><li class="listitem" style="list-style-type: disc">Disconnect the hard drive</li><li class="listitem" style="list-style-type: disc">Image the hard drive separately</li></ul></div><p>However, in some situations, you will also need to image the hard drive without switching the system off. An example is in case the system is a server that is hosting a critical service that cannot be taken down, or there is an encryption present in the system, which will be reactivated if the system is powered off. This is why live acquisition is the preferred choice all the time.</p><div class="section" title="FTK imager in live hard drive acquisition"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec45"/>FTK imager in live hard drive acquisition</h2></div></div></div><p>In this section, we will use the FTK imager in imaging the hard drive of the live target machine. We will use the FTK image lite (<a class="ulink" href="http://accessdata.com/product-download/digital-forensics/ftk-imager-lite-version-3.1.1">
http://accessdata.com/product-download/digital-forensics/ftk-imager-lite-version-3.1.1
</a>), which doesn't require any installation, to leave least traces in the live system. Navigate to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Create Disk Image</strong></span>.</p><p>From the pop-up window, select one of the following source evidence types:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Physical disk</strong></span>: This is the whole hard drive, starting from the MBR to the last sector of the hard drive</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Logical disk</strong></span>: This is one partition from the hard drive.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Image file</strong></span>: This is if you need to convert an image from one format to another, that is, from the E01 format to a raw format</li></ul></div><p>In our case, we will select the whole physical hard drive. You now need to select the source hard drive, and make sure that you select the right hard drive of the target machine. After this, you will have the option of selecting the type of image that you want. The three most important options are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Raw image format</strong></span>: This is simply a bit-to-bit copy of the hard drive without leaving or adding any single bit. This image format is usually accompanied by a separate file, containing meta information about the image file.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>E01</strong></span>: This is the <span class="strong"><strong>EnCase evidence file</strong></span>. It contains information that is related to the acquisition process, such as the investigator name, the timestamp, and the typed notes during the acquisition. It calculates the checksum for every 32 KB of data, and at the end of the image file, it adds the MD5 hash for the whole bit stream.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>AFF</strong></span>: This is the <span class="strong"><strong>Advanced Forensics Format</strong></span>, and it is used to store disk images and forensics images' metadata. This is not a proprietary but open format, which can be used with any tool for analysis and won't exclusively work with a single tool.</li></ul></div><p>You can still transfer the image from one format to another after the original imaging process. So, we can always select the raw format and then convert to any other format that we will need during the analysis phase. You now need to add the destination information, taking in to consideration that you are working on a live system and have no write protection enabled. Be careful and select the destination folder in the externally attached storage or shared folder over the network.</p><p>There is an option to divide the image into multifiles. You can provide the size of the single file. This option will be very helpful in case you don't have enough storage on a single hard drive and need to divide the image between different hard drives. This will also be useful in case you have a FAT32 formatted volume that can't handle files more than 4 GB in size.</p><p>Also, you can create more than one image in the same process, which will save some time if you have a case with more than one investigator working on it.</p><p>You may choose to verify the image after its creation by calculating the hash function to the image and comparing the result to the hash function's result of the hard drive. In case of a match, the image hasn't been altered. The hash function will be discussed later in this chapter:</p><div class="mediaobject"><img src="graphics/image_04_005.jpg" alt="FTK imager in live hard drive acquisition"/><div class="caption"><p>FTK—selection of the image destination</p></div></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note6"/>Note</h3><p>FTK Imager images the hard drive bit-to-bit to a single file image. You can't image the hard drive to another one like you can do with duplicators.</p></div></div></div><div class="section" title="Imaging over the network with FTK imager"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec46"/>Imaging over the network with FTK imager</h2></div></div></div><p>In some situations, you can't connect to the target system with a USB to run your tools and connect your storage. In this case, you can acquire the system over the network.</p><p>What you need to do is connect your machine to the same network with the target system and make sure the target system can reach your machine using the ping command. From your machine, verify that enough space is available. Now, create a new folder and share this folder with suitable read/write privileges.</p><p>In our example, the shared folder name is <code class="literal">Share</code> and this is located in <code class="literal">C:\</code>. The handler's machine and has been assigned an IP of 192.168.57.128 and the source/target machine is Windows 7:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">To test the shared folder availability, run the <code class="literal">\\192.168.57.128</code> command from the source machine in the <span class="strong"><strong>Run</strong></span> window shown as follows:<div class="mediaobject"><img src="graphics/image_04_006.jpg" alt="Imaging over the network with FTK imager"/><div class="caption"><p>Opening the shared folder</p></div></div></li><li class="listitem">An authentication window must pop up. Enter the machine IP, the username, and the user password:<div class="mediaobject"><img src="graphics/image_04_007.jpg" alt="Imaging over the network with FTK imager"/><div class="caption"><p>Shared folder authentication</p></div></div></li><li class="listitem">If everything went well, you will see a folder named <span class="strong"><strong>Share</strong></span>. Right-click on this folder and select <span class="strong"><strong>Map Network Drive</strong></span>. You can select any drive letter, in our case, we selected the letter <code class="literal">Z</code>:<div class="mediaobject"><img src="graphics/image_04_008.jpg" alt="Imaging over the network with FTK imager"/><div class="caption"><p>Mapping the shared folder</p></div></div></li><li class="listitem">Now from the source machine, run the FTK Lite program, and then open<span class="strong"><strong> Create Disk image</strong></span> from <span class="strong"><strong>File</strong></span>. Follow the same steps and for the location of the image, browse to the mapped network drive; it may ask you to authenticate again:<div class="mediaobject"><img src="graphics/image_04_009.jpg" alt="Imaging over the network with FTK imager"/><div class="caption"><p>Saving the image to the shared folder</p></div></div></li><li class="listitem">After clicking on the <span class="strong"><strong>Finish</strong></span> button, you will notice a progress status bar that represents the already captured data from the overall hard drive size.</li></ol></div><p>On the handler's machine, you will find a file named <code class="literal">image.raw</code>, which is created under the Share shared folder, and you can notice the increase of the file size until it reaches the maximum size of the target machine's hard drive.</p></div><div class="section" title="Incident response CDs in live acquisition"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec47"/>Incident response CDs in live acquisition</h2></div></div></div><p>As discussed earlier, the incident response CDs come with built-in and easy-to-access tools to perform different jobs. One of these jobs is the imaging of the hard drive of the live system, as in the DART tool set and Helix.</p><p>With Helix, if it didn't start automatically in the live system, you can open the program from the suitable operating system folder (<span class="emphasis"><em>Figure A</em></span> in the <span class="emphasis"><em>Helix</em></span> section). The program will work with the same interface, but in case of working from a live system, you won't be able to duplicate the hard drive. The clone option won't be available in the list because the hard drive isn't in a steady state and is constantly changing as a result of the operating system's actions. A verification process takes place after the imaging process. It calculates the hash of the resulting image and compares the value to the hash of the bit stream during the imaging process. If there is a match, it means that there are no errors in the image.</p><p>To acquire the image over the network, Helix has a built-in capability to do so with the same server/client concept. In the destination machine, which is the handler machine, you need to run the network listener from the same <code class="literal">receiver.exe</code> folder:</p><div class="mediaobject"><img src="graphics/image_04_010.jpg" alt="Incident response CDs in live acquisition"/><div class="caption"><p>Helix network listener</p></div></div><p>After providing full information to the listener, start listening to any network connection requests.</p><p>In the source machine, select the destination as the Helix receiver. Then to set up the connection, enter the listener IP, the same port, and the password if any:</p><div class="mediaobject"><img src="graphics/image_04_011.jpg" alt="Incident response CDs in live acquisition"/></div><p>After starting the acquisition process, a new connection will start in the listener, and a new image file can be found at the specified location on the destination machine.</p></div></div>
<div class="section" title="Linux for the imaging of a hard drive"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec24"/>Linux for the imaging of a hard drive</h1></div></div></div><p>Suppose that you already have a dead system and you need to take the machine's hard drive out in order to image it. What you need to do first is make sure that you are connecting the hard drive to your preferred Linux machine via write blocker to prevent any accidental writing to the hard drive, which could change the evidence and make it inadmissible.</p><div class="section" title="The dd tool"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec48"/>The dd tool</h2></div></div></div><p>In the Linux operating system, there is a built-in tool called <code class="literal">dd</code>. The <code class="literal">dd</code> tool is considered to be a forensically sound tool, as it copies blocks of data, regardless of its structure. There are a lot of suggestions of what <code class="literal">dd</code> stands for, but we can say that <code class="literal">dd</code> stands for <span class="strong"><strong>duplicate disk</strong></span> or <span class="strong"><strong>duplicate data</strong></span>, and if someone used it in wrong way it can be <span class="strong"><strong>disk destroyer</strong></span> or <span class="strong"><strong>delete data</strong></span>. This tool can convert and copy files and hard drives.</p><p>Suppose the suspicious hard drive, which is the source and is connected by a write blocker, is mounted as <code class="literal">/dev/sda</code> and the destination hard drive is mounted as <code class="literal">sdb</code>. We have the following two options:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Image the hard drive to a single file, which is useful in space management, transferring the image file between different investigators in the same case, and for case archiving, as mentioned earlier. In this case, you will use the <code class="literal">dd</code> tool with the following using root privileges:<pre class="programlisting">
<span class="strong"><strong>dd conv=sync,noerror bs=64K if=/dev/sda of=/media&#13;
    /Elements/HD_image/image.dd</strong></span>
</pre><p>From here, we can see the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">conv = sync, noerror</code>: This pads the block with nulls to the left if, for some reason, the block couldn't be read; <code class="literal">dd</code> will continue to execute and won't step due to some error.</li><li class="listitem" style="list-style-type: disc"><code class="literal">bs</code>: This is each block size of the transferred data. Considering a big block size may be faster, but choosing the smaller block size is more efficient. Suppose you select <code class="literal">bs</code> to be 4 MB, so if an error occurred in the first sector of 4 MB, it will ignore all the rest of the block which may cause you some important data loss during the imaging process.</li><li class="listitem" style="list-style-type: disc"><code class="literal">if</code>: This is an input file, either a whole hard disk or single partition.</li><li class="listitem" style="list-style-type: disc"><code class="literal">Of</code>: This is an output file.</li><li class="listitem" style="list-style-type: disc"><code class="literal">/media/Elements</code>: This is the mount point of the destination hard drive.</li><li class="listitem" style="list-style-type: disc">In this case, the cursor will be silent until the imaging ends.</li></ul></div></li><li class="listitem" style="list-style-type: disc">Now, there is a way to see the progress of the imaging process, which will help in troubleshooting and detecting any problems that occurred during the acquisition, by pipelining the <code class="literal">dd</code> command with the <code class="literal">pv</code> as the following:<pre class="programlisting">
<span class="strong"><strong>dd conv=sync, noerror bs=64K if=/dev/sda | pv | dd&#13;
    of=/media/Elements/HD_image/image.dd</strong></span>
</pre><p>Here, you will see the moving progress bar, which means that the process is still running the imaged size and the imaging speed:</p><div class="mediaobject"><img src="graphics/image_04_013.jpg" alt="The dd tool"/><div class="caption"><p>dd with the progress status</p></div></div></li></ul></div><div class="section" title="dd over the network"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec3"/>dd over the network</h3></div></div></div><p>You also can use <code class="literal">dd</code> over the network using the <code class="literal">nc</code> netcat. To perform this action, on the destination machine with IP <code class="literal">192.168.57.128</code>, open a listener on port 3333 and pipeline the received data to <code class="literal">dd</code> with the desired location and output file name:</p><pre class="programlisting">
<span class="strong"><strong>nc -l -p 3333 | dd of=/media/root/elements/HD_image&#13;
    /image.raw</strong></span>
</pre><p>Otherwise, you can just direct the output to the desired file:</p><pre class="programlisting">
<span class="strong"><strong>nc -l -p 3333 &gt;  /media/root/elements/HD_image/image.raw</strong></span>
</pre><p>You can see this in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_04_014.jpg" alt="dd over the network"/><div class="caption"><p>dd over the network using netcat (at destination)</p></div></div><p>On the target machine, start the <code class="literal">dd</code> by pipelining the output to the <code class="literal">nc</code> client, as follows:</p><pre class="programlisting">
<span class="strong"><strong>dd conv=sync,noerror bs=64K if=/dev/sda | pv | nc &#13;
    192.168.57.128 3333</strong></span>
</pre><p>The output is as follows:</p><div class="mediaobject"><img src="graphics/image_04_015.jpg" alt="dd over the network"/><div class="caption"><p>dd over the network using netcat (at source)</p></div></div><p>Duplicate the whole hard drive to another hard drive. In this case, you can use all the previous steps, but instead of mentioning the destination file path, you need to mention the hard drive's driver assigned location under <code class="literal">/dev</code>. So,<code class="literal">/media/Elements/HD_image/image.dd</code> will be replaced with<code class="literal">/dev/sdb</code> in the first example.</p><p>Using the <code class="literal">dd</code> tool, you can restore an image to a hard drive. You just need to change the input file to the image and the output file to the hard drive, such as<code class="literal">/dev/sda</code>:</p><pre class="programlisting">
<span class="strong"><strong>dd if=/media/Elements/HD_image/image.dd of=/dev/sda</strong></span>
</pre></div></div></div>
<div class="section" title="Virtualization in data acquisition"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec25"/>Virtualization in data acquisition</h1></div></div></div><p>Virtualization offers great benefits to digital forensics science. In virtualization, everything is a file, including the guest memory and the guest hard drive. What the handler needs to do is to identify the right file of the source that they need to acquire and copy this file to the external storage.</p><p>The snapshot concept that can be found in most of the virtualization programs offers the investigator more images of the machine at different times. This can, if acquired and analyzed, view the timeline behavior of the machine, that is, before and after the malware infection:</p><div class="mediaobject"><img src="graphics/image_04_016.jpg" alt="Virtualization in data acquisition"/><div class="caption"><p>Windows memory files in the virtual machine</p></div></div><p>In the previous image, we can see the <code class="literal">vmem</code> files of the VMware program. VMware is one of the virtualization programs. This image contains the current memory file and two <code class="literal">vmem</code> files for two snapshots taken on two different dates. The size of the files are all the same because this is like the memory dump process, it copies the entire machine's memory.</p></div>
<div class="section" title="Evidence integrity (the hash function)"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec26"/>Evidence integrity (the hash function)</h1></div></div></div><p>What can we do to prove that the evidence hasn't been altered or changed? This step is very important to prove in court, if required, that you didn't add, remove, or edit the evidence during imaging or analysis. Most of the imaging tools come with many hash function implementations, such as MD5, SHA1, and SHA256. The hash function is a mathematical implementation, which is an irreversible or one-way function. This means that if you have input data A and hash function F, you will get <span class="emphasis"><em>F(A) = H</em></span>. However, it's been proved that <span class="emphasis"><em>F'(H) != A</em></span>, where <span class="emphasis"><em>F</em></span> is the hash function and <span class="emphasis"><em>F'</em></span> is any mathematical function. We can't get <span class="emphasis"><em>A</em></span>, the original data, from <span class="emphasis"><em>H</em></span>, the hash digest.</p><p>For example, if we have different strings applied to the same hash function, the hash function must map each string to different hashes:</p><div class="mediaobject"><img src="graphics/image_04_017.jpg" alt="Evidence integrity (the hash function)"/><div class="caption"><p>The hash function</p></div></div><p>As shown in the preceding diagram, each text resulted in a different hash after applying all the texts to the same hash function. Even if the change is a single character, such as <span class="strong"><strong>Handling</strong></span> and <span class="strong"><strong>Handlin</strong></span> in the preceding figure, the output must be very different. If slight changes in the input bring out slight changes in the hashes, the hash function is considered less perfect.</p><p>Hash collision occurs when two different inputs create the same hash when applied to the same hash function. So, it is better to use more than one hash function, such as MD5 and SHA512.</p><p>The length of the hash digest doesn't depend on the input length. Whatever the input length, the hash length will be the same. This is a matter of time and the available processing power and resources. The following table contains some of the famous hash functions with their digest length:</p><div class="informaltable"><table border="1"><colgroup><col/><col/></colgroup><tbody><tr><td>
<p><span class="strong"><strong>Hash algorithm</strong></span></p>
</td><td>
<p><span class="strong"><strong>Digest length</strong></span></p>
</td></tr><tr><td>
<p>MD5</p>
</td><td>
<p>128 bit</p>
</td></tr><tr><td>
<p>SHA-1</p>
</td><td>
<p>160 bit</p>
</td></tr><tr><td>
<p>SHA-256</p>
</td><td>
<p>256 bit</p>
</td></tr><tr><td>
<p>SHA-512</p>
</td><td>
<p>512 bit</p>
</td></tr></tbody></table></div><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>The hash length for different hash algorithms</em></span></p></blockquote></div><p>With FTK Imager, you can select and image to verify them after they are created. This will run the created image against various hash functions and compare the results with the digests created during the imaging process of the source. This will create a small report showing the digest values and whether this is a match or not:</p><div class="mediaobject"><img src="graphics/image_04_018.jpg" alt="Evidence integrity (the hash function)"/><div class="caption"><p>The hash verification in FTK Imager</p></div></div><p>You can prove that you didn't alter the evidence by writing the digest of the received evidence in the chain of custody records.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note7"/>Note</h3><p>In the Linux operating system, there is a built-in function called <span class="strong"><strong>md5sum</strong></span> where you can apply your image to it, and it will calculate the MD5 hash for you.</p></div></div><p>It is worth mentioning that the content of the file is the only factor that affects the hash function, neither the metadata nor the filename affect the hash digest.</p><p>During live disk acquisition, the imaging is running in a specific point of time. No integrity can be preserved in the original disk as the operating system uses it and changes it all the time. However, the evidence integrity can be preserved starting from the first created image of the system disk.</p></div>
<div class="section" title="Disk wiping in Linux"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec27"/>Disk wiping in Linux</h1></div></div></div><p>The investigator can't use the same hard drive for two different hard drives if they are using the duplication way to image the hard drive. This could overlap different files from different cases and will result in unreliable and untrue findings. After completing work on the duplicate hard drive, you must wipe it and prepare it for another case or hard drive. Don't wait until another case is assigned to you; wiping takes a long time.</p><p>This process is equivalent to the imaging process but the source file is a file full of zeros. In the Linux operating system there is a <code class="literal">/dev/zero</code> file. You need to use this file as your input file to the <code class="literal">dd</code> tool, and your output file will be the hard drive that needs to be wiped. Another file that can be used in this process as well is<code class="literal">/dev/null</code>:</p><pre class="programlisting">
<span class="strong"><strong>dd if=/dev/zero of=/dev/sda bs=2K conv=noerror,sync</strong></span>
</pre></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec28"/>Summary</h1></div></div></div><p>In this chapter, we covered some IRCDs and discussed the live acquisition using IRCDs and FTK Imager and imaging over the network using IRCDs and the <code class="literal">dd</code> tool. We also viewed how to preserve evidence integrity and how to wipe a disk for forensic usage.</p><p>In the next chapter, we will discuss how to create a timeline of the system activities and why it is important from a digital forensics prospective.</p></div></body></html>