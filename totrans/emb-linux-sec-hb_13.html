<html><head></head><body><div><div><p>&#13;
			<h1 id="_idParaDest-201" class="chapter-number"><a id="_idTextAnchor400"/>13</h1>&#13;
			<h1 id="_idParaDest-202"><a id="_idTextAnchor401"/>Applying Government Security Standards – System Hardening</h1>&#13;
			<p>Whether your team is trying to give your product a competitive edge over the competition via heightened security or your customer base (i.e., government, military, or other public sector customer) has compliance mandates for all systems that they employ, the application of one or more government standards for security is generally no simple task.</p>&#13;
			<p>For this level of compliance, you must build a solution based on accepted and certified operating systems. This specific compliance action will obviously take most community distributions out of selection for you, as we discussed in <a href="B22104_02.xhtml#_idTextAnchor044"><em class="italic">Chapter 2</em></a>. In this space, the list of Linux operating systems is brutally short. You can count the players in this space with the fingers on one hand (and maybe have a finger or two left over). This is not meant to disparage any distribution whether they are community or commercial. The process is lengthy, expensive, and, beyond a shadow of a doubt, possibly quite frustrating for most. Few distributions have the resources to take this journey with NIST.</p>&#13;
			<p>The good news for you is the list of certified Linux operating systems is expanding, but few can compete with the extensive list of government certifications and standards that are adhered to <a id="_idIndexMarker560"/>like <strong class="bold">Red Hat</strong>® <strong class="bold">Enterprise Linux</strong>® (<strong class="bold">RHEL</strong>) can. It is seen as the de facto standard for Linux in the US government space. The few other players in this space are often clones or derivatives of RHEL, except Ubuntu®, which is the most popular Debian Linux variant.</p>&#13;
			<p>Another factor in this effort that we will explore here is additional tooling that makes the Herculean effort to comply with these security standards even possible. The <strong class="bold">Security Content Automation Protocol</strong> (<strong class="bold">SCAP</strong>) can easily be seen as the most common standard<a id="_idIndexMarker561"/> for the automated application sets of security measures (AKA SCAP server profiles) to a system or application stack. The actual process of implementing these profiles requires tooling. This is where open source comes to the rescue (again). The OpenSCAP projects provide extensive tooling. Many Linux distributions include these packages within their installers and repositories. SCAP definitions provide an industry standard way of applying security standards and remediations. They are the highway towards compliance regardless of the security standard that you are trying to apply. In this chapter, we’ll show you by example how to apply the two <a id="_idIndexMarker562"/>most common standards for server security in the US – FIPS 140-3 and the general <strong class="bold">STIG</strong> (short for <strong class="bold">Secure Technical </strong><strong class="bold">Implementation Guide</strong>).</p>&#13;
			<p>In this chapter, the main sections are:</p>&#13;
			<ul>&#13;
				<li>Adherence to key US government standards</li>&#13;
				<li>How do I implement this?</li>&#13;
				<li>How do I certify my solution?</li>&#13;
			</ul>&#13;
			<p>Let’s move on to our next section, where we will go into some detail as to the details of what you may need to complete the exercises in this chapte<a id="_idTextAnchor402"/>r.</p>&#13;
			<h1 id="_idParaDest-203"><a id="_idTextAnchor403"/>Technical requirements</h1>&#13;
			<p>For the hands-on exercises in this chapter, you will need two RHEL 9.4 (or newer) machines (physical or virtual) both will be clean installations. We will do one of those installations together as an exercise.</p>&#13;
			<p>To achieve this, you will need access to a Red Hat® account (developer or production), installation medi<a id="_idTextAnchor404"/>a, Fedora® Media Writer, and the ability to install/reinstall the operating system on the two machines.</p>&#13;
			<p>Additionally, you will need the ability to download and install additional packages from third-party or government websites. The STIG Viewer tool can be installed <a id="_idTextAnchor405"/>on Windows® or Linux systems. You’ll need this as well, but it does not have to be installed specifically on your lab machines. Check out the book’s GitHub repository for helpful links: <a href="https://github.com/PacktPublishing/The-Embedded-Linux-Security-Handbook/blob/main/Chapter11/Resource_Cheat_Sheet.pdf">https://github.com/PacktPublishing/The-Embedded-Linux-Security-Handbook/blob/main/Chapter11/Resource_Cheat_Sheet.pdf</a>.</p>&#13;
			<p>Let’s move on to the reason <em class="italic">why</em> adherence to security standards might matte<a id="_idTextAnchor406"/>r.</p>&#13;
			<h1 id="_idParaDest-204"><a id="_idTextAnchor407"/>Adherence to key US government standards</h1>&#13;
			<p>Many seek<a id="_idIndexMarker563"/> to maintain their solutions to a higher standard than what may or may not be required. Many can agree with me on this; I applaud that level of commitment to security and to going above and beyond. In doing so, they can easily set their solutions on a higher pedestal against any of their competitors’ solutions. Why? It’s because if the solution meets the arduous security standards of the US military or certain three-letter agencies, then i<a id="_idTextAnchor408"/>t’s definitely good enough for them. Well, one would assume such.</p>&#13;
			<p>Continuing with that thought, I want to highlight by going above and then beyond what is minimally required (or seen as the norm) in a specific industry is yet another excellent method of driving trust within your targeted community base. By raising the bar for yourself and your products, you will ultimately preemptively (and informally) set a new standard for others to attempt to live up to. This will result in easier audits for your customers, who will definitely appreciate a less stressful compliance effort.</p>&#13;
			<p>Adherence to government standards, when not required specifically, can also give your potential customers more peace of mind in choosing your solution. The customers’ auditors may also thank them for executing more due diligence in the selection of your product. It’s a win-win for everyone. That extra effort on your teams’ parts can go a long way to a wider adoption rate of your products.</p>&#13;
			<p>Besides trust and peace of mind, having one less system on their network to worry about is also a plus for your customers. I assure you that they will appreciate that too.</p>&#13;
			<p>Then there’s the flip side of the coin. When compliance is mandated due to your customer base’s requirements, your team will have its work cut out for them. Regardless of where your product falls in the requirements space, the more secure your product is the better the outcomes will be for all involv<a id="_idTextAnchor409"/>ed.</p>&#13;
			<p>Let’s review an earlier discussion in <a href="B22104_02.xhtml#_idTextAnchor044"><em class="italic">Chapter 2</em></a>, when we established the single greatest factor: your target customer base’s compliance needs. Perhaps your product targets a wide stretch of industry verticals.</p>&#13;
			<p>If your user base is in the government sector, your product had better bring its <em class="italic">A</em> game. Failure to comply with the applicable standards imposed upon any system in government infrastructure results in your solution not getting adopted there.</p>&#13;
			<p>Government is just one vertical that requires such attention to detail. Healthcare and financial services also have their own regulatory security standards (albeit not too different from government/military standards).</p>&#13;
			<p>Regardless of <a id="_idIndexMarker564"/>what verticals and sectors you sell into, casting a wider net compliance-wise is just a smart play. Additionally, I feel remiss if I have failed to mention that there is a massive overlap in many security standards across many industries.</p>&#13;
			<p>Let’s get into more importantly how we can start to apply these standards to our solutions successfu<a id="_idTextAnchor410"/>lly.</p>&#13;
			<h1 id="_idParaDest-205"><a id="_idTextAnchor411"/>How do I implement this?</h1>&#13;
			<p>The<a id="_idIndexMarker565"/> answer to the question <em class="italic">How do I implement this?</em> does not have a single answer. The truthful response is <em class="italic">It’s complicated</em>. Maintaining compliance has many touchpoints. It starts at the design table, where you must identify what standards will impact the overall solution. Some can argue that the significant amounts of research time are the greatest amount of time spent on this effort. I disagree. I believe (and I suspect you will too soon enough) that maintaining compliance from release to release long after the measures have been originally implemented in your product is the true heavy lift.</p>&#13;
			<p>There’s also a catch to all of this. Maintaining adherence is not a one-and-done process. Brace for the upcoming frustration because here it comes. Setting a server profile, whether during installation or later on, is not the end but the beginning. Every time you make a change to the configuration, albeit small or large, you must re-scan and confirm compliance. This part of maintenance and testing can be a rather tedious process, but it IS necessary.</p>&#13;
			<p>Let’s explore, in the next few sections, how we implement and maintain standards compliance throughout the lifecycle of your pro<a id="_idTextAnchor412"/>duct.</p>&#13;
			<h2 id="_idParaDest-206"><a id="_idTextAnchor413"/>Implementation of security standards</h2>&#13;
			<p>Security begins <a id="_idIndexMarker566"/>at the design table, but the implementation and maintenance of your security measures is where the proverbial rubber hits the road. Paying close attention to the most minute detail could mean the difference that protects your product from being compromised. Why do we do this (as if we need a reminder)? Perpetual risk mitigation.</p>&#13;
			<p>Our first foray into the implementation of security standards begins with the Linux installers.</p>&#13;
			<p>The enhancements, to <a id="_idIndexMarker567"/>some installers in recent years, do make this process easier on their implementers. But as I have previously stated, it is simply the beginning of a long-term commitment that you and your team have enga<a id="_idTextAnchor414"/>ged in.</p>&#13;
			<h3>Leveraging RHEL server profiles at installation time</h3>&#13;
			<p>The<a id="_idIndexMarker568"/> RHEL installer, Anaconda, has the ability for the end-user to select a predefined set of SCAP Security Guide server profiles. These server profiles represent several governmental agencies and industry standards. Leveraging one of these at installation time is a significant jumpstart to ensuring your system will be compliant with an applicable standard. This doesn’t guarantee that, after you have finished setting up your server, it is 100% compliant. You will still need to confirm compliance as part of your QA process later on.</p>&#13;
			<p>You can select one of the several SCAP profiles (or other standards) in Anaconda during their installation process. Again, this is where I applaud those developers who spent the time to make this arduous process easier for us all.</p>&#13;
			<p>For those who are curious as to which profiles are included, wait no more. Recently, the master list for publicly shared SCAP profiles for virtually all major Linux distributions was moved to GitHub; it can be found via this link: <a href="https://complianceascode.github.io/content-pages/guides/index.html">https://complianceascode.github.io/content-pages/guides/index.html</a>. The list of the SCAP profiles included within the RHEL 9 installer is somewhat extensive. Here’s a curtailed list of what profiles are included in the installer:</p>&#13;
			<ul>&#13;
				<li>Various levels of security (low, medium, high, and enhanced) from the French National Agency for the Security of Information Systems – ANSSI BP-028</li>&#13;
				<li>Various levels of <strong class="bold">Centro Criptológico Nacional</strong> (<strong class="bold">National Cryptologic Center aka CCN</strong>) of Spain defined server security levels</li>&#13;
				<li>Various CIS Benchmark levels</li>&#13;
				<li>The DRAFT unclassified FIPS standard (NIST 800-171)</li>&#13;
				<li>The <strong class="bold">Australian Cyber Security Centre</strong> (<strong class="bold">ACSC</strong>) Essential Eight</li>&#13;
				<li>The ACSC ISM Official</li>&#13;
				<li>The <strong class="bold">Health Insurance Portability and Accountability </strong><strong class="bold">Act</strong> (<strong class="bold">HIPAA</strong>)</li>&#13;
				<li>The Protection Profile for General Purpose Operating Systems</li>&#13;
				<li>PCI-DSS version 3.2.1 Control Baseline</li>&#13;
				<li>The <strong class="bold">Defense Information Systems Agency</strong> (<strong class="bold">DISA</strong>) <strong class="bold">STIG</strong> for RHEL 9 Server and RHEL 9 Server with GUI</li>&#13;
			</ul>&#13;
			<p>Here’s a <a id="_idIndexMarker569"/>screenshot taken while browsing the extensive list of available SCAP profiles during a RHEL 9 installation. It’s impossible to show them all in a single screenshot.</p>&#13;
			<div>&#13;
				<div>&#13;
					<img src="img/B22104_13_01.jpg" alt="Figure 13.1 – Selecting a server profile in the RHEL installer" width="1245" height="897"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.1 – Selecting a server profile in the RHEL i<a id="_idTextAnchor415"/>nstaller</p>&#13;
			<h3>Enabling FIPS mode in RHEL</h3>&#13;
			<p>RHEL 9 has <a id="_idIndexMarker570"/>been focused on the FIPS 140-3 standard since its initial development began several y<a id="_idTextAnchor416"/>ears ago. Red Hat had determined that attempting to add FIPS 140-3 to RHEL 8 (which is FIPS 140-2 certified) would require too much refactoring and as the operating system was within its final five years of its lifecycle, such an effort was untenable. During the final five years of a RHEL release, the operating system is considered to be in maintenance mode, where new features generally are not introduced but security and bug fixes are still implemented.</p>&#13;
			<p>Building a <a id="_idIndexMarker571"/>FIPS-compliant system starts at installation time by placing the installer into FIPS mode. This simple step is achieved by editing one line during the system’s boot process. During installation, append <code>fips=1</code> to the kernel line in the installer boot kernel options. </p>&#13;
			<p>Here’s a screenshot of me setting the kernel boot options within GRUB to allow the installer to boot into FIPS mode:</p>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_02.jpg" alt="Figure 13.2 – Configuring the installer to boot in FIPS mode" width="1158" height="552"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.2 – Configuring the installer to boot in FIPS mode</p>&#13;
			<p>The next step in getting your system closer to FIPS compliance is to select the FIPS SCAP server profile during the installation process.</p>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_03.jpg" alt="Figure 13.3 – Selecting the FIPS server profile during installation" width="1020" height="831"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.3 – Selecting the FIPS server profile during installation</p>&#13;
			<p>Optionally, if <a id="_idIndexMarker572"/>you are like me (detail-oriented) and desire to double-check your work, you could also configure FIPS compliance mode as a post-install process. This same process is needed after any changes to the system have occurred.</p>&#13;
			<p>Let’s see an example of a post-install configuration of enforcing FIPS mode via the command line. This, in itself, is a glaring example of where enterprise distributions (such as RHEL) make the adherence of complex standards easier. In this situation, you would run the following command as root:</p>&#13;
			<pre class="console">&#13;
#  fips-mode-setup</pre>			<p>The output can be extremely lengthy, obscure, and verbose. Feel free to experiment in your lab as you see fit.</p>&#13;
			<p>Now, we can<a id="_idIndexMarker573"/> look at several of the steps we can take to validate FIPS mode before we perform a scan of the system. These are addressed in no particular order, but I’d like to think that the order chosen seems somewhat logical.</p>&#13;
			<p>Ensuring the kernel boot option is set for FIPS support by checking the kernel’s boot options before actually booting Linux. This does not, however, guarantee that all the other configurations required by FIPS 140-3 compliance have been completed. This is simply the start of the journey.</p>&#13;
			<p>In this pictorial example, you can see the configuration for booting, and it clearly shows kernel options... more specifically, the one we care about, <code>fips=1</code>:</p>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_04.jpg" alt="Figure 13.4 – Confirming FIPS mode boot options in GRUB" width="1278" height="590"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.4 – Confirming FIPS mode boot options in GRUB</p>&#13;
			<p>Here’s another <a id="_idIndexMarker574"/>example method of ensuring that FIPS mode is enabled on your RHEL server. This will do a ton of heavy lifting in the configuration for you. </p>&#13;
			<p>You should run the following command to forcibly set the system policy:</p>&#13;
			<pre class="console">&#13;
#  update-crypto-policies  –-set FIPS</pre>			<p>As you might be curious (or gravely concerned) as to where your system stands in terms of adherence to the FIPS 140-3 standard, we’ve provided this example walkthrough on how to check. We will ensure that the validation of FIPS mode is completed (regardless of how it was configured previously):</p>&#13;
			<ol>&#13;
				<li>First, we’ll check to see that FIPS mode is enabled by running the following as root:<pre class="source-code">&#13;
<strong class="bold">#  fips-mode-setup --check</strong></pre><p class="list-inset">This is where you need to pay close attention to the output as you might just get this as your output – and then you still have more work to do. This is normal. Perfection is difficult to achieve. Your output will most likely be like the following, notifying you that you have more work to accomplish:</p><pre class="source-code"><strong class="bold">Installation of FIPS modules is not completed.</strong>&#13;
<strong class="bold">FIPS mode is disabled.</strong></pre></li>				<li>Let’s continue down the path assuming that your system needs more work by the fact that you did not get a favorable response to the last command. We can then run <a id="_idIndexMarker575"/>this next command and (of course) re-verify that FIPS mode is OK on our host. This may also take a little more time than most commands. Please be patient.<pre class="source-code">&#13;
<strong class="bold">#  fips-mode-setup –-enable</strong></pre><p class="list-inset">This command will take some time – expect the output to resemble this:</p><pre class="source-code"><strong class="bold">Kernel initramdisks are being regenerated. This might take some time.</strong>&#13;
<strong class="bold">Setting system policy to FIPS</strong>&#13;
<strong class="bold">Note: System-wide crypto policies are applied on application start-up.</strong>&#13;
<strong class="bold">It is recommended to restart the system for the change of policies</strong>&#13;
<strong class="bold">to fully take place.</strong>&#13;
<strong class="bold">FIPS mode will be enabled.</strong>&#13;
<strong class="bold">Please reboot the system for the setting to take effect.</strong></pre></li>				<li>OK. Things are now better. Because of the results we received from the last command, we had to do some remediation. That’s expected. Let’s reboot as recommended now:<pre class="source-code">&#13;
<strong class="bold">#  reboot</strong></pre></li>				<li>After the system has rebooted, let’s get back to a root prompt and re-run the verification command. Like I continue to say, <em class="italic">trust </em><em class="italic">but verify!</em><pre class="source-code">&#13;
<strong class="bold">#  fips-mode-setup --check</strong>&#13;
<strong class="bold">FIPS mode is enabled.</strong></pre></li>			</ol>&#13;
			<p>We can now breathe<a id="_idIndexMarker576"/> a sigh of relief. We have gone through how to implement FIPS mode and test the results. Now, let’s move on to another set of security measures that comprises DISA’s STIG profiles.</p>&#13;
			<h3>DISA STIG SCAP profiles</h3>&#13;
			<p>Before<a id="_idIndexMarker577"/> we dive deep into the setup of STIG compliant systems, let’s first get to a point where we can actually make sense of the STIG standard’s documentation. This requires you to install a tool from DISA. Yes, you will need another tool just to view the details of the STIGs themselves. The DISA STIG Viewer is a free software tool that runs on Windows and Linux. Sorry everyone – no Mac® support. I’m sure that there’s some interesting backstory explaining <em class="italic">why</em> there’s no Mac support, but I do not know it. This tool is well maintained by the security gurus at DISA and is made publicly accessible to all.</p>&#13;
			<p>First, let’s open up a browser and go to the DISA site, then download the free STIG Viewer tool. The tool can be found at: <a href="https://public.cyber.mil/stigs/srg-stig-tools/">https://public.cyber.mil/stigs/srg-stig-tools/</a>.</p>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_05.jpg" alt="Figure 13.5 – Downloading the STIG Viewer" width="1454" height="396"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.5 – Downloading the STIG Viewer</p>&#13;
			<p>Now that we have this excellent free tool, let’s put it to good use and download the STIG that applies to our example RHEL 9.x lab server. This too is a relatively simple process.</p>&#13;
			<p>Go to <a href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems">https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems</a> and select the RHEL 9 STIG. You may have to go through several other operating <a id="_idIndexMarker578"/>systems’ STIG entries to get there (I believe it’s on the third page).</p>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_06.jpg" alt="Figure 13.6 – Downloading the RHEL 9 STIG SCAP profile" width="1122" height="645"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.6 – Downloading the RHEL 9 STIG SCAP profile</p>&#13;
			<p>In my lab, I have the STIG Viewer on both my Windows laptop and several of my Linux servers. Here’s a screenshot of using the STIG Viewer to drill down into the RHEL 9 STIG library.</p>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_07.jpg" alt="Figure 13.7 – Viewing the RHEL 9 STIG Library" width="1015" height="755"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.7 – Viewing the RHEL 9 STIG Library</p>&#13;
			<p>This is where <a id="_idIndexMarker579"/>I recommend that you spend some time not only getting acclimated with the STIG viewer tool but also using it to examine not just the RHEL 9.x STIG SCAP profile but any others you want to become more intimate with. This tool is priceless.</p>&#13;
			<p>Now that we’ve spent time viewing what profiles we could apply to our product, let’s move on to the tooling that actually allows us to force our systems’ configuration into compliance.</p>&#13;
			<p>Whichever standards you choose to adhere to during your installation (and configuration processes), you will still need to validate the solution in detail as part of your release processes. Let’s take a look at what that ma<a id="_idTextAnchor417"/>y look like.</p>&#13;
			<h2 id="_idParaDest-207"><a id="_idTextAnchor418"/>Validation as part of the QA process</h2>&#13;
			<p>Have I ever said <em class="italic">trust but verify</em> previously? I bet I have. Yes. I’m saying it again.</p>&#13;
			<p>Knowing <a id="_idIndexMarker580"/>where to get the latest information about how to apply SCAP profiles and scanning is important. Since we are focused on these activities and RHEL, here’s the link to Red Hat’s documentation on this process: <a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/security_hardening/scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening#configuration-compliance-tools-in-rhel_scanning-the-system-for-configuratio">https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/security_hardening/scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening#configuration-compliance-tools-in-rhel_scanning-the-system-for-configuration-compliance-and-vulnerabilities</a>.</p>&#13;
			<p class="callout-heading">Tip</p>&#13;
			<p class="callout">You will need an account to log in to view the information.</p>&#13;
			<p>Let’s move on to an exercise where we’ll run ou<a id="_idTextAnchor419"/>r first scan.</p>&#13;
			<h2 id="_idParaDest-208"><a id="_idTextAnchor420"/>Exercise: Installing the OpenSCAP tools and running a scan</h2>&#13;
			<p>During<a id="_idIndexMarker581"/> this exercise, you will install the OpenSCAP tools onto one of<a id="_idIndexMarker582"/> your lab machines, download a RHEL 9 SCAP profile, and run a security scan. Let’s see how to do it:</p>&#13;
			<ol>&#13;
				<li>Get the packages installed:<pre class="source-code">&#13;
<strong class="bold">$  sudo dnf install -y scap-workbench  \</strong>&#13;
<strong class="bold">openscap-utils openscap-engine-sce \</strong>&#13;
<strong class="bold">openscap-scanner scap-security-guide bzip2</strong></pre><p class="list-inset">The output for this one is exceptionally long; however, I’ve truncated it to show the important parts of what was installed:</p><pre class="source-code"><strong class="bold">Updating Subscription Management repositories.</strong>&#13;
<strong class="bold">Last metadata expiration check: 0:04:16 ago on Wed 16 Oct 2024 04:52:00 AM EDT.</strong>&#13;
<strong class="bold">Package openscap-scanner-1:1.3.10-2.el9_3.x86_64 is already installed.</strong>&#13;
<strong class="bold">Package bzip2-1.0.8-8.el9.x86_64 is already installed.</strong>&#13;
<strong class="bold">Dependencies resolved.</strong>&#13;
<strong class="bold">==========================================================</strong>&#13;
<strong class="bold">     ((( output truncated )))</strong>&#13;
<strong class="bold">Installed products updated.</strong>&#13;
<strong class="bold">Installed:</strong>&#13;
<strong class="bold">  adwaita-gtk2-theme-3.28-14.el9.x86_64         gtk2-2.24.33-8.el9.x86_64                        ibus-gtk2-1.5.25-5.el9.x86_64</strong>&#13;
<strong class="bold">  libcanberra-gtk2-0.30-27.el9.x86_64           openscap-engine-sce-1:1.3.10-2.el9_3.x86_64      openscap-utils-1:1.3.10-2.el9_3.x86_64</strong>&#13;
<strong class="bold">  openssh-askpass-8.7p1-38.el9_4.4.x86_64       pcre2-utf16-10.40-5.el9.x86_64                   qt5-qtbase-5.15.9-10.el9_4.x86_64</strong>&#13;
<strong class="bold">  qt5-qtbase-common-5.15.9-10.el9_4.noarch      qt5-qtbase-gui-5.15.9-10.el9_4.x86_64            qt5-qtdeclarative-5.15.9-3.el9.x86_64</strong>&#13;
<strong class="bold">  qt5-qtxmlpatterns-5.15.9-2.el9.x86_64         rpmdevtools-9.5-1.el9.noarch                     scap-workbench-1.2.1-13.el9.x86_64</strong>&#13;
<strong class="bold">  xcb-util-image-0.4.0-19.el9.x86_64            xcb-util-keysyms-0.4.0-17.el9.x86_64             xcb-util-renderutil-0.3.9-20.el9.x86_64</strong>&#13;
<strong class="bold">  xcb-util-wm-0.4.1-22.el9.x86_64</strong>&#13;
<strong class="bold">Complete!</strong></pre></li>				<li>Download a general-purpose SCAP profile for RHEL 9 from Red Hat. Just like with the <a id="_idIndexMarker583"/>STIG SCAP profile we downloaded earlier, this will be an XML file that will be used by the scanning tool:<pre class="source-code">&#13;
<strong class="bold">#  wget -O - https://www.redhat.com/security/data/oval/v2/RHEL9/rhel-9.oval.xml.bz2 | bzip2 --decompress &gt; rhel-9.oval.xml</strong></pre><p class="list-inset">The output<a id="_idIndexMarker584"/> for this one is rather long too; I have truncated it to save space, leaving only some important informational bits here for you:</p><pre class="source-code"><strong class="bold">--2024-10-16 04:59:45--  https://www.redhat.com/security/data/oval/v2/RHEL9/rhel-9.oval.xml.bz2</strong>&#13;
<strong class="bold">Resolving www.redhat.com (www.redhat.com)... 23.37.1.210, 2600:1401:4000:58d::d44, 2600:1401:4000:58b::d44</strong>&#13;
<strong class="bold">Connecting to www.redhat.com (www.redhat.com)|23.37.1.210|:443... connected.</strong>&#13;
<strong class="bold">HTTP request sent, awaiting response... 301 Moved Permanently</strong>&#13;
<strong class="bold">Location: https://security.access.redhat.com/data/oval/v2/RHEL9/rhel-9.oval.xml.bz2 [following]</strong>&#13;
<strong class="bold">--2024-10-16 04:59:45--  https://security.access.redhat.com</strong>&#13;
<strong class="bold">/data/oval/v2/RHEL9/rhel-9.oval.xml.bz2</strong>&#13;
<strong class="bold">Resolving security.access.redhat.com </strong>&#13;
<strong class="bold">(security.access.redhat.com)</strong>&#13;
<strong class="bold">... 23.194.190.138, 23.194.190.193, </strong>&#13;
<strong class="bold">2600:1401:2000::b819:94a8, ...</strong>&#13;
<strong class="bold">Connecting to security.access.redhat.com </strong>&#13;
<strong class="bold">(security.access.redhat.com)|23.194.190.138|:443... connected.</strong>&#13;
<strong class="bold">HTTP request sent, awaiting response... 200 OK</strong>&#13;
<strong class="bold">Length: 444671 (434K) [application/x-bzip2]</strong>&#13;
<strong class="bold">Saving to: 'STDOUT'</strong>&#13;
<strong class="bold">-                                   100%[===============</strong>&#13;
<strong class="bold">=========</strong>&#13;
<strong class="bold">========================================&gt;] 434.25K  --.-KB/s</strong>&#13;
<strong class="bold">    in 0.1s</strong>&#13;
<strong class="bold">2024-10-16 04:59:46 (3.26 MB/s) - written to stdout </strong>&#13;
<strong class="bold">[444671/444671]</strong></pre></li>				<li>Run a <a id="_idIndexMarker585"/>test <a id="_idIndexMarker586"/>scan:<pre class="source-code">&#13;
<strong class="bold">$  oscap-ssh &lt;username&gt;@&lt;hostname&gt; &lt;port&gt; oval eval --report </strong>&#13;
<strong class="bold">&lt;scan-report.html&gt; &lt;path to rhel-9.oval.xml&gt;</strong></pre></li>			</ol>&#13;
			<p class="callout-heading">Important note</p>&#13;
			<p class="callout">The oscap tools (i.e., the <code>openscap-utils</code> package) will have to be installed on the target host as well as the host it is executed from. Substitute your own appropriate username hostname and paths to files as specified. Please be aware that the output from this command’s execution can be excessively long. If you do not have two machines with the tools installed, you can simply run it against your own user account on localhost. The point of this exercise is simply to demonstrate the process.</p>&#13;
			<p class="list-inset">The interactive output for this command is rather lengthy. Again, I have truncated <a id="_idIndexMarker587"/>what <a id="_idIndexMarker588"/>we are displaying here for you:</p>&#13;
			<pre class="source-code">&#13;
<strong class="bold">Connecting to 'mstonge@testmachine' on port '22'...</strong>&#13;
<strong class="bold">mstonge@testmachine's password:</strong>&#13;
<strong class="bold">Connected!</strong>&#13;
<strong class="bold">Copying input file '/home/mstonge/rhel-9.oval.xml' to remote </strong>&#13;
<strong class="bold">working directory '/tmp/tmp.10rp1SVS0z'...</strong>&#13;
<strong class="bold">rhel-9.oval.xml                                                  </strong>&#13;
<strong class="bold">                                         100% 9879KB 336.5MB/s</strong>&#13;
<strong class="bold">   00:00</strong>&#13;
<strong class="bold">Starting the evaluation...</strong>&#13;
<strong class="bold">Definition oval:com.redhat.rhsa:def:20248112: false</strong>&#13;
<strong class="bold">Definition oval:com.redhat.rhsa:def:20248111: false</strong>&#13;
<strong class="bold">     ((( output truncated )))</strong>&#13;
<strong class="bold">Definition oval:com.redhat.rhba:def:20228256: false</strong>&#13;
<strong class="bold">Definition oval:com.redhat.rhba:def:20228077: false</strong>&#13;
<strong class="bold">Definition oval:com.redhat.rhba:def:20225749: false</strong>&#13;
<strong class="bold">Definition oval:com.redhat.rhba:def:20223945: false</strong>&#13;
<strong class="bold">Definition oval:com.redhat.rhba:def:20223893: false</strong>&#13;
<strong class="bold">Evaluation done.</strong>&#13;
<strong class="bold">oscap exit code: 0</strong>&#13;
<strong class="bold">Copying back requested files...</strong>&#13;
<strong class="bold">report.html                                       </strong>&#13;
<strong class="bold">                                                  </strong>&#13;
<strong class="bold">      100%  700KB 241.9MB/s   00:00</strong>&#13;
<strong class="bold">Removing remote temporary directory...</strong>&#13;
<strong class="bold">Disconnecting ssh and removing control ssh socket</strong>&#13;
<strong class="bold"> directory...</strong>&#13;
<strong class="bold">Exit request sent.</strong></pre>			<ol>&#13;
				<li value="4">Next, open<a id="_idIndexMarker589"/> a <a id="_idIndexMarker590"/>browser and view the report.</li>&#13;
			</ol>&#13;
			<p class="callout-heading">Tip</p>&#13;
			<p class="callout">You may wish to copy the report HTML file to a different system for viewing if the graphical desktop is not installed. Review all items. Your output will be different from mine.</p>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_08.jpg" alt="Figure 13.8 – Viewing the scan report HTML file" width="1161" height="936"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.8 – Viewing the scan report HTML file</p>&#13;
			<p>Now that you <a id="_idIndexMarker591"/>have<a id="_idIndexMarker592"/> your first scan report, please take some time to absorb the content and how it is formatted. Make a mental note of any deficiencies it might have found as these are the things we are using this tool to search for. The detailed reporting provided can easily save hours or days of manual checks.</p>&#13;
			<p>Additionally, I highly recommend keeping these reports as artifacts of your build and testing operations as they will become evidence of your due diligence should you submit your products for government certifications.</p>&#13;
			<p>In this exercise, we installed our SCAP tools, downloaded a general-purpose SCAP profile from Red Hat, and then executed our first scan. This process is easily repeated with different SCAP profiles <a id="_idIndexMarker593"/>that you either obtain from NIST, other third <a id="_idIndexMarker594"/>parties, or that you have created yourself. We’ve just seen a great example of command-line scanning tooling displayed.</p>&#13;
			<p>Now that you have executed your first scan from the command line, let’s move on in our journey by looking at graphical tools to assist w<a id="_idTextAnchor421"/>ith profiles and scanning.</p>&#13;
			<h2 id="_idParaDest-209"><a id="_idTextAnchor422"/>Example: Using the OpenSCAP Workbench</h2>&#13;
			<p>In the <a id="_idIndexMarker595"/>previous exercise, we installed several packages. Preemptively, you have already installed the <code>scap-workbench</code> and <code>scap-security-guide</code> packages. When your scanning system is in graphical UI mode, you’ll have the ability to view, edit, and create your own SCAP profiles, run them against hosts, and even automate the remediation of deficiencies found by the scanner.</p>&#13;
			<p>Let’s walk through how we can open and engage with the OpenSCAP workbench in our UI:</p>&#13;
			<ol>&#13;
				<li>First, let’s open the OpenSCAP Workbench application in the Gnome desktop. Go to <strong class="bold">Applications</strong> then select <strong class="bold">SCAP Workbench</strong>.</li>&#13;
			</ol>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_09.jpg" alt="Figure 13.9 – Activating the OpenSCAP Workbench from the Applications Menu in Gnome" width="498" height="323"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.9 – Activating the OpenSCAP Workbench from the Applications Menu in Gnome</p>&#13;
			<ol>&#13;
				<li value="2">Once we <a id="_idIndexMarker596"/>have started the workbench application, we will first be prompted on which SCAP profile to load. Here, we will select <strong class="bold">Other SCAP Content</strong> from the pull-down menu.</li>&#13;
			</ol>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_10.jpg" alt="Figure 13.10 – Selecting “Other SCAP content” from the pull-down menu" width="877" height="362"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.10 – Selecting “Other SCAP content” from the pull-down menu</p>&#13;
			<ol>&#13;
				<li value="3">Next, we’ll select<a id="_idIndexMarker597"/> our previously downloaded RHEL 9 STIG SCAP profile file.</li>&#13;
			</ol>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_11.jpg" alt="Figure 13.11 – Selecting the RHEL 9 STIG SCAP profile (downloaded earlier)" width="909" height="526"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.11 – Selecting the RHEL 9 STIG SCAP profile (downloaded earlier)</p>&#13;
			<p class="list-inset">Before you decide <a id="_idIndexMarker598"/>on your path of execution, here, you can review settings and choose a path forward.</p>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_12.jpg" alt="Figure 13.12 – Getting ready to execute" width="799" height="887"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.12 – Getting ready to execute</p>&#13;
			<p>From this screen, there <a id="_idIndexMarker599"/>are a plethora of actions you can take. You can choose to execute a scan remotely. Others may choose to edit this profile to suit their company’s needs. The obvious path is to execute this scan on a host locally or remotely. Here’s where I shall also point out that this tool can assist you in generating remediation automation once a scan has been completed.</p>&#13;
			<p>The OpenSCAP Workbench is a robust and feature-rich tool that I believe deserves more detail than this book can allocate due to space constraints. If you liked this introduction, do not forget to check out the book’s GitHub repository for additional content on how to leverage this awesome tool and many other resources.</p>&#13;
			<p>Let’s now move on to our next section, where we will discuss implementing security s<a id="_idTextAnchor423"/>cans into your CI/CD chain.</p>&#13;
			<h2 id="_idParaDest-210"><a id="_idTextAnchor424"/>Implementation as part of your continuous integration/continuous deployment (CI/CD) process</h2>&#13;
			<p>This is not just a<a id="_idIndexMarker600"/> repeat of your QA efforts but a review of which standards and certifications you currently maintain and what efforts you may choose to add to your product or cease to maintain.</p>&#13;
			<p>Following updates from the agencies that provide the security standards that your appliance must comply with is crucial in keeping abreast of changes or new regulations.</p>&#13;
			<p>For agile shops, I highly recommend adding these activities to your backlog and ensuring this review takes place at least twice a year. The more often your team performs a review, hopefully, the more security remains in their minds.</p>&#13;
			<p>Additionally, this is where I would also prescriptively recommend having a distinct level of automation in place that runs these scans against any release candidate host. Which automation tools you select is up to you or whatever your employer has already deemed the corporate standard. Perhaps you prefer scripts. Let’s dig into this a little deeper.</p>&#13;
			<p>In the previous exercises, we downloaded the STIG SCAP profile and a general-purpose RHEL SCAP profile, set up a scanning host, and learned how to execute a scan. To make this a more normalized process, I have some recommendations for your CI/CD chain and your product prototypes.</p>&#13;
			<p>Next, I’d like to share some lists of recommendations I have for your build chain, tasks to perform on your prototypes, and more.</p>&#13;
			<p>These are my recommendations for your CI/CD chain:</p>&#13;
			<ul>&#13;
				<li>Build a permanent host for running these OpenSCAP scans</li>&#13;
				<li>Maintain a library of appropriate SCAP profiles</li>&#13;
				<li>Automate the scanning activities and distribution of the results reports</li>&#13;
				<li>Save your scan results as artifacts with your builds/releases for future reference</li>&#13;
				<li>Throw nothing away – maintain an audit trail (always)</li>&#13;
			</ul>&#13;
			<p>These are my recommendations for your prototypes/release candidates:</p>&#13;
			<ul>&#13;
				<li>Start with the highest level of security possible</li>&#13;
				<li>Enable only what sockets, ports, or services are critical to your appliance’s functioning</li>&#13;
				<li>Have non-root service accounts that can run systemd services and be used for support and scanning activities</li>&#13;
				<li>Ensure each host has SSH enabled</li>&#13;
				<li>Ensure that the <code>openscap-utils</code> package is installed</li>&#13;
			</ul>&#13;
			<p>Failure to<a id="_idIndexMarker601"/> integrate and automate compliance scanning into your process in the long term (and maybe the short term too) will negatively impact the quality of your product. My final recommendation is not to ignore security concerns during any stage of your product’s life cycle. Make it a component of every process and, eventually, it will become second nature for you and your product team.</p>&#13;
			<p>Let’s move on to the trophy phase of your efforts: actually ge<a id="_idTextAnchor425"/>tting your product certified.</p>&#13;
			<h1 id="_idParaDest-211"><a id="_idTextAnchor426"/>How do I certify my solution?</h1>&#13;
			<p>The subject of<a id="_idIndexMarker602"/> getting your solution certified probably deserves a whole book on its own. There are so many different types of certifications for different industry and government standards. That said, for our security focus I have chosen to distill this into the holy grail of certifications: the coveted FIPS 140-3 certification with NIST.</p>&#13;
			<p>Not to discourage or dissuade you, but I must mention that several companies have built a business model to <em class="italic">help</em> other businesses navigate this painstaking and lengthy process with the labs and NIST. You can easily find them online with a simple Google search when looking for FIPS certification. Their services will most likely show at the top of all results.</p>&#13;
			<p>FIPS 140-3 certification<a id="_idIndexMarker603"/> is not just a software certification, but a software on specified hardware validation. The testing labs that provide these services to the process use a specific hardware platform for each testing cycle. Which platform that is may vary by the labs themselves.</p>&#13;
			<p>The process is complex, and not without costs. Depending on the security level of your solution’s certification, you could be paying NIST from $1,000 to well over $4,000. This does not include any fees charged by the lab that does the heavy lifting for NIST.</p>&#13;
			<p>To find a NIST-accredited lab, you need to search the NIST website. Here’s a good place to start: <a href="https://www-s.nist.gov/niws/index.cfm?event=directory.search#no-back">https://www-s.nist.gov/niws/index.cfm?event=directory.search#no-back</a>.</p>&#13;
			<p>Once the lab has tested your product and submitted its findings to NIST, the NIST team then reviews all the documentation and hopefully, eventually, issues a certification. The coveted prize can then be searched for as all validated FIPS solutions (and their statuses) can be found at the NIST site shown in the following screenshot.</p>&#13;
			<p>&#13;
				<div>&#13;
					<img src="img/B22104_13_13.jpg" alt="Figure 13.13 – Searching for validated/certified modules" width="1279" height="797"/>&#13;
				</p>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.13 – Searching for validated/certified modules</p>&#13;
			<h2 id="_idParaDest-212"><a id="_idTextAnchor427"/>FIPS certification re-branding by vendors</h2>&#13;
			<p>The <a id="_idIndexMarker604"/>submittal, testing, validation, and certification process can take over two years. For anyone trying to bring a new competitive product to market, this timeframe is unfathomable. Few operating system vendors can lend a hand even if they are certified themselves. Red Hat has a program in which their Embedded Systems partners can leverage their existing certifications for their products that are built upon RHEL. How do I know this? I was one of three founders of the program.</p>&#13;
			<p>A Red Hat partner choosing to take this path can work with the Red Hat Embedded Team, and they will provide appropriate paperwork (i.e., regarding the existing software certifications) that the partner can then take to NIST and their chosen lab to accelerate the process to get their solution certified. With this certification re-branding documentation, the process, which could have taken over two years, may be shortened to a few weeks or a few months as testing an existing certified module is not necessary. This provides extreme value and a pa<a id="_idTextAnchor428"/>th to revenue for that partner.</p>&#13;
			<h1 id="_idParaDest-213"><a id="_idTextAnchor429"/>Summary</h1>&#13;
			<p>We’ve come a long way together in this chapter. We have reviewed how adherence to government standards is important regardless of whether or not your industry dictates so. We’ve also taken a glance at some key standards that transcend many verticals and how to implement the most important ones. Finally, we wrapped up how to certify your appliance with NIST and some of the fun that process will bring you. Your experiences with the examples and exercises should give you newly found confidence that these efforts are not impossible, but very achievable.</p>&#13;
			<p>Let’s move on to our final chapter, where we will discuss our most important resource, our end-users, and how their feedback can assist your processes. We’ll also do a full review of the lessons learned throughout the book.</p>&#13;
		</div>&#13;
	</div></div></body></html>