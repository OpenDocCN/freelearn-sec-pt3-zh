- en: '14'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Ransomware Preparation and Response
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: With the availability of cryptocurrency, threat actors have been given the necessary
    tools to extract payment from victims without fear of being caught. This has led
    directly to the rise of ransomware, an attack where threat actors deploy malware
    that encrypts the victim’s files and extorts payment for the victim to get them
    back. Over the last 10 years, the development of more sophisticated tools and
    techniques to compromise victims has led to ransomware attacks impacting governments,
    large healthcare institutions, and major corporations, all to extract the maximum
    amount of ransom to enrich the various threat actors.
  prefs: []
  type: TYPE_NORMAL
- en: Given the prolific nature of ransomware, it is a good bet that incident responders
    will have to respond to these types of attacks. To address incidents involving
    ransomware more effectively, analysts should be familiar with the tactics and
    techniques, along with the response actions, that will bring them back up and
    running if an attack occurs.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will focus on the background elements, as outlined here:'
  prefs: []
  type: TYPE_NORMAL
- en: History of ransomware
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Conti ransomware case study
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Proper ransomware preparation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Eradication and recovery
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: With a solid foundation in place, we will examine specific investigative and
    analysis techniques in the next chapter.
  prefs: []
  type: TYPE_NORMAL
- en: History of ransomware
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Even though a version of malware that encrypts data has been around since the
    late 1980s, the current explosion in ransomware coincides with the development
    of cryptocurrency. This is the ability to anonymously send and receive digital
    currency that has allowed ransomware threat actors to execute attacks and extract
    payment from their victims while remaining anonymous. Over the past decade, this
    type of attack has gone through an evolution in terms of sophistication but has
    largely remained consistent with some core TTPs, such as an initial infection
    followed by propagating the ransomware and encrypting a user’s files with the
    intent to extract payment for the decryption key. We will briefly discuss some
    of the key variants in this evolution, as seen in the following diagram:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 14.1 – A brief history of ransomware ](img/B18571_14_001.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 14.1 – A brief history of ransomware
  prefs: []
  type: TYPE_NORMAL
- en: CryptoLocker
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The first ransomware attacks took place between September 2013 and May 2014
    and utilized the **CryptoLocker** ransomware variant. This variant was delivered
    via malicious email attachments and the **Gameover ZeuS** botnet. This variant
    of ransomware used the 2,048-bit RSA key to encrypt local files and mapped network
    drives. The attack also informed the victim that their files were encrypted, along
    with directions on how to pay the ransom. The attackers were halted through law
    enforcement intervention that ended up taking down the Gameover ZeuS botnet in
    May 2014\. This intervention even included an indictment of the Russian national
    Evgeniy Bogachev for his alleged involvement in maintaining the botnet associated
    with the attacks.
  prefs: []
  type: TYPE_NORMAL
- en: CryptoWall
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The next major variant to hit victim machines was **CryptoWall**, coming to
    prominence after the demise of the CryptoLocker variant. Much like CryptoLocker,
    this combined Trojan-ransomware variant used a 2,048-bit RSA encryption algorithm
    to encrypt the victim’s files. The primary delivery mechanism of the malware is
    through compressed files containing PDF documents.
  prefs: []
  type: TYPE_NORMAL
- en: CTB-Locker
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: At about the same time the CryptoWall and CryptoLocker variants were prominent,
    the **CTB-Locker** variant was also infecting victims’ systems. Delivered mostly
    through malicious email attachments or fake downloads, this variant did add some
    additional features, such as the use of **The Onion Routing** (**TOR**) network
    for Command and Control, as well as deleting the Volume Shadow Copy of infected
    systems to inhibit recovery.
  prefs: []
  type: TYPE_NORMAL
- en: One additional feature that CTB-Locker leveraged was the affiliate model or
    **Ransomware-as-a-Service** (**RaaS**). In this model, independent threat actors
    are given access to the ransomware and associated tools to conduct the attacks
    with a portion of their ransom being paid to the threat actors running the ransomware
    operation.
  prefs: []
  type: TYPE_NORMAL
- en: TeslaCrypt
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: While most ransomware encrypts a wide variety of files, the **TeslaCrypt** variant
    targeted files associated with online gaming. The initial version of TeslaCrypt
    would encrypt saved games, player profiles, and game modifications. It was only
    in later versions that the variant would encrypt more Microsoft and other common
    files. TeslaCrypt utilized the Angler Adobe Flash exploit to infect systems using
    an asymmetrical encryption key. The initial versions contained a flaw in the encryption
    scheme and decrypters were released by Cisco Talos. In May 2016, the TeslaCrypt
    threat actors ceased their operations and released a decryption key.
  prefs: []
  type: TYPE_NORMAL
- en: SamSam
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The **SamSam** ransomware variant originated in Iran, as indicated by the indictment
    of two Iranian nationals Faramarz Shahi Savandi and Mohammed Mehdi Shah Mansouri.
    Throughout their campaign, the SamSam ransomware infected over 200 organizations
    in the United States, collecting an estimated $6 million from victims. The attacks
    leveraged vulnerabilities in the **Remote Desktop Protocol** (**RDP**) or Java-based
    web servers to gain an initial foothold in the victim’s network. From there, the
    threat actors would move laterally and encrypt as many systems as possible with
    a 2,048-bit RSA encryption algorithm.
  prefs: []
  type: TYPE_NORMAL
- en: Locky
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: One common tactic that’s used by ransomware threat actors is the use of a macro-enabled
    Microsoft Word document. Using phishing techniques, victims are enticed to open
    the document with macros enabled. Once this is done, the macro downloads a Trojan
    virus that encrypts the system. The threat actors behind **Locky** used this technique
    to great effect across a variety of victims. Using either an RSA or AES cipher,
    the malware variant can encrypt files on the drive, removable drives, and network-connected
    drives.
  prefs: []
  type: TYPE_NORMAL
- en: WannaCry
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A short-lived but devastating attack, **WannaCry** was a high-profile attack
    that impacted over 200,000 computers across the globe. This attack used the recently
    disclosed Eternal Blue exploit, which leveraged a vulnerability in the Microsoft
    SMB service using the backdoor tool **DoublePulsar**, which allowed the ransomware
    to install and copy itself to other systems. The WannaCry attack lasted only a
    few hours on May 12, 2017, after a security researcher, Marcus Hutchins, discovered
    a kill switch that prevented additional infections. After additional research,
    the United States and the United Kingdom both attributed the attack to the North
    Korean government.
  prefs: []
  type: TYPE_NORMAL
- en: Ryuk
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Thought to be the work of the Russian cybercriminal group Wizard Spider, Ryuk
    has the distinction of demanding the top three highest payments in 2020\. This
    shows the group behind **Ryuk** targets large organizations for large payouts.
    The ransomware can shut down 180 services and 40 processes to ensure the maximum
    impact on the victim’s systems. The data is encrypted with an AES-256 symmetric
    key that is further encrypted with a 4,096-bit RSA key, making the encrypted files
    near impossible to recover without the key. Making use of the RaaS, Ryuk uses
    **Download-as-a-Service** (**DaaS**), in which the malware coders use a third
    party to deliver the ransomware to the target.
  prefs: []
  type: TYPE_NORMAL
- en: Ryuk also uses a more complex multi-stage attack. In this case, a phishing email
    is sent to a victim. Once the attachment, such as a macro-enabled Word document,
    is opened, an additional tool, referred to as a dropper, is used. These droppers,
    such as BazarBackdoor or Trickbot, will often be used to add additional tools
    for command and control. Once control is established, the ransomware is loaded
    and executed.
  prefs: []
  type: TYPE_NORMAL
- en: Ryuk is closely related to another prolific variant, Conti. This variant represents
    a highly sophisticated tool that combines the elements of ransomware variants
    from past versions into a highly impactful attack.
  prefs: []
  type: TYPE_NORMAL
- en: Conti ransomware case study
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'One of the most prolific ransomware variants to hit is Conti. There are two
    aspects to Conti that make it stand out in terms of threat actors. The first of
    these aspects is that Conti is a RaaS threat actor. This type of threat actor
    uses an affiliate model where highly skilled recruits are found on hacking forums.
    From there, they are provided the tools and techniques necessary to execute the
    initial stage: attack and deploy ransomware. The original coders of the Conti
    variant are then provided a fee of anywhere between 10 to 30 percent of the ransom.'
  prefs: []
  type: TYPE_NORMAL
- en: The second of these is that Conti affiliates will often exfiltrate data, along
    with encrypting files. This data is then held “hostage” by the affiliate for ransom.
    If the victim organization did not pay in time, the data would be released. Conti
    affiliates were even able to use a website both on the internet and on the dark
    web to post the data.
  prefs: []
  type: TYPE_NORMAL
- en: Before being shut down, the Conti variant and the affiliates used a wide variety
    of tools and techniques that serve as a good case study of how ransomware threat
    actors operate. In this case, first, we will look at the affiliate’s background,
    disclosures, and the TTPs that the group and its affiliates use as part of their
    attacks.
  prefs: []
  type: TYPE_NORMAL
- en: Background
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The RaaS model was first observed in December 2019\. The name Conti refers to
    the specific variant of malware that is used, often deployed with the Trickbot
    Trojan developed by the threat actor Wizard Spider. This group, first seen in
    September 2016, is believed to be based in Russia and is a sophisticated financially
    motivated threat actor.
  prefs: []
  type: TYPE_NORMAL
- en: While operational, the RaaS threat actors tied to Conti have attacked a variety
    of organizations, including the government and large enterprises. Even during
    the COVID-19 pandemic, the affiliates had carried out attacks against 16 separate
    healthcare or first-responder networks. Some of these attacks carried a ransom
    of 25 million dollars US.
  prefs: []
  type: TYPE_NORMAL
- en: One key facet of the affiliate model that Conti utilizes is the sophisticated
    task division within the overall organization. There are specific teams that handle
    the technical aspects of initial access and then hand off the remaining work to
    another team. There are also specific teams that handle the ransomware negotiations
    with the victim organization.
  prefs: []
  type: TYPE_NORMAL
- en: 'Conti also added a new element to the already lucrative ransomware threat by
    adding another extortion element to their attacks. Conti set up websites both
    on the publicly available internet and the dark web where they would threaten
    the release of exfiltrated data to the public if their demands were not met. This
    was done to force more pressure on victims to pay the ransom to not only get their
    data decrypted but also save themselves from the embarrassment of public disclosure:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 14.2 – Conti disclosure site ](img/B18571_14_002.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 14.2 – Conti disclosure site
  prefs: []
  type: TYPE_NORMAL
- en: 'On the same website, Conti actors also threatened retaliation for the crisis
    that began with the Russian invasion of Ukraine in 2022\. This declaration was
    followed by increased attacks by the group against targets in Ukraine. The major
    difference was that the attacks were carried out against government networks and
    critical infrastructure in a departure from the ransom extraction motive:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 14.3 – Conti Ukraine response ](img/B18571_14_003.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 14.3 – Conti Ukraine response
  prefs: []
  type: TYPE_NORMAL
- en: In its short 2 years of operations, Conti and its affiliates became a major
    threat to organizations, ranging from government, healthcare, critical infrastructure,
    and large corporations. Their sophisticated model of task division and technical
    ability made it a model for potential future threat actors to emulate. Given this,
    it caught many by surprise when the group ceased its operations in May 2022, shutting
    down its infrastructure, including its disclosure site. Affiliate members then
    went on to other groups. One event may have accelerated the group’s demise and
    that was the disclosure of internal documents and tools by an affiliate member.
  prefs: []
  type: TYPE_NORMAL
- en: Operational disclosure
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'On August 5, 2021, a user with the screen name `m1Geelka` posted to the Russian
    language cybersecurity forum `xss.is` the technical and operational manuals used
    by the Conti ransomware group and its affiliates. The user posted a link to download
    the manuals and software from a file-sharing site for anyone with access to the
    forum. This post was soon deleted but for security researchers, it was a bonanza
    of data and intelligence into the group’s operations:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 14.4 – Conti disclosure ](img/B18571_14_004.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 14.4 – Conti disclosure
  prefs: []
  type: TYPE_NORMAL
- en: 'The disclosures are still currently available at [https://share.vx-underground.org/Conti/](https://share.vx-underground.org/Conti/)
    and include updates from additional disclosures of the Conti group’s TTPs from
    February and March 2022\. For example, the disclosed documents included screen
    captures of the use of tools such as Cobalt Strike, as shown here:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 14.5 – Conti Cobalt Strike use ](img/B18571_14_005.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 14.5 – Conti Cobalt Strike use
  prefs: []
  type: TYPE_NORMAL
- en: The disclosures included other key details of the group’s operations and methods.
    This included chat logs, source code, and manuals related to tool use. The unique
    feature of this disclosure was the near complete picture of the threat actors
    and their affiliate’s operational methods and tools. Using this data, we can get
    a picture of the specific tactics and techniques a sophisticated ransomware group
    can employ and better prepare to defend and detect against them.
  prefs: []
  type: TYPE_NORMAL
- en: Tactics and techniques
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Conti affiliates utilize a variety of tactics and techniques. In this section,
    we will examine some of the more common of these as there is significant overlap
    with those used by affiliates and other ransomware threat actors. For a complete
    breakdown of the TTPs associated with the Conti ransomware variant, consult the
    MITRE ATT&CK profile at [https://attack.mitre.org/software/S0575/](https://attack.mitre.org/software/S0575/).
    For context on an actual Conti ransomware campaign, the **Cybersecurity and Infrastructure
    Agency** (**CISA**) published an advisory concerning the Conti threat actors with
    a detailed breakdown of the MITRE ATT&CK tactics that were observed during over
    a thousand attacks: [https://www.cisa.gov/uscert/sites/default/files/publications/AA21-265A-Conti_Ransomware_TLP_WHITE.pdf](https://www.cisa.gov/uscert/sites/default/files/publications/AA21-265A-Conti_Ransomware_TLP_WHITE.pdf).'
  prefs: []
  type: TYPE_NORMAL
- en: Initial access
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The primary method that Conti leverages is **Spear Phishing campaigns [T1566.001]**
    or the use of **Malicious Links [1566.002]** contained within an email. Emails
    will often contain a macro-enabled Microsoft Word document with a filename deliberately
    chosen to entice a user to open the attachment. In other incidents, the Conti
    affiliates have been known to use compromised credentials to connect to internet-exposed
    systems with RDP enabled. This allows them to establish a foothold within the
    network without the need to send a phishing email.
  prefs: []
  type: TYPE_NORMAL
- en: Other affiliates used pretext calls, where they pretended to be a helpdesk person
    and had the user download a remote access software such as GoToAssist. From there,
    the attacker can place malware or other tools to begin the follow-on actions.
  prefs: []
  type: TYPE_NORMAL
- en: Execution
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Once the macro-enabled Word document is opened, the macro will often execute
    a Windows PowerShell script to execute the **Command and Scripting Interpreter:
    PowerShell [T1059.001]** technique. This script is often used to download a secondary
    payload, often a RAT such as Trickbot, Qbot, or Bazar. This establishes the initial
    foothold into the victim’s network.'
  prefs: []
  type: TYPE_NORMAL
- en: 'A few methods must be used to execute the malware. One technique that’s often
    used by Contin affiliates is to warp the RAT in a DLL file. This file will then
    be placed in a directory. The Windows `rundll32.exe` executable will be used to
    execute the RAT in what is referred to as a **System Binary Proxy Execution: Rundll32
    [T1218.011]**. This technique is still seen in the wild, even though many EDR
    tools can detect such behavior.'
  prefs: []
  type: TYPE_NORMAL
- en: 'It is here that we will also start looking at the tool Cobalt Strike. This
    tool is often found in ransomware incidents and is commonly associated with Conti.
    This tool is a commercial post-exploitation tool that has a wide range of functionality
    within an integrated system. Cobalt Strike also includes other common post-exploitation
    frameworks such as Metasploit and post-exploitation tools such as Mimikatz, which
    can be used for a variety of credential threat and abuse attacks. The overall
    look and feel of the tool are similar to that of Armitage, as shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 14.6 – Cobalt Strike GUI ](img/B18571_14_006.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 14.6 – Cobalt Strike GUI
  prefs: []
  type: TYPE_NORMAL
- en: Cobalt Strike will often be executed alongside or in place of the RAT that is
    executed at this stage of the attack.
  prefs: []
  type: TYPE_NORMAL
- en: Privilege escalation
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Wizard Spider has been observed loading a malicious DLL file into an existing
    or running process in an attack referred to as **Process Injection: Dynamic-link
    Library Injection [T1055.001]**. In this technique, the attacker can inject arbitrary
    code into a running process. This allows the attackers to execute the malicious
    code and bypass detection. Depending on the process written to, the malicious
    code may also be run at elevated privileges.'
  prefs: []
  type: TYPE_NORMAL
- en: Defense evasion
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Modern antivirus and EDR solutions have gotten much better at detecting malware,
    exploits, and other malicious activity on endpoints. Ransomware threat actors
    such as Conti use a variety of methods to ensure that they are not detected and
    stopped. In addition to process injection, the Cobalt Strike platform has additional
    functionality that allows threat actors to maintain stealth. For example, the
    tool uses the **Obfuscated Files or Information [T1027]** technique by hashing
    API Windows API calls so that antivirus or EDR tools do not identify any of the
    suspicious API calls associated with Cobalt Strike usage.
  prefs: []
  type: TYPE_NORMAL
- en: 'One additional defense evasion tactic that is often observed not only with
    Conti but many of the ransomware threat actors is the use of Base64 encoding for
    PowerShell scripts. This provides a measure of obfuscation by doesn’t write specific
    commands to the storage. Instead, it relies on PowerShell to decode and execute
    the commands. For example, the following Windows Event Log entry shows the Base64-encoded
    script:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 14.7 – Base64-encoded PowerShell script ](img/B18571_14_007.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 14.7 – Base64-encoded PowerShell script
  prefs: []
  type: TYPE_NORMAL
- en: Credential access
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Accessing or creating valid credentials with elevated privileges is critical
    to the lateral movement components of ransomware attacks. Conti utilizes a few
    different tools and techniques to gain access to credentials. The first of these
    is the use of the Sysinternals tool `procdump.exe`. This tool is used in the **OS
    Credential Dumping: LSASS Memory [T1003.001]** technique, where it is leveraged
    to dump the **Local Security Authority Subsystem Service** (**LSASS**), which
    contains the Windows OS credentials.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Conti has also used the post-exploitation tool Mimikatz to perform a similar
    type of action as the Windows Sysinternals tool `procdump.exe`. The binary and
    associated files are available on GitHub at [https://github.com/ParrotSec/mimikatz](https://github.com/ParrotSec/mimikatz).
    Mimikatz can also obtain the plaintext passwords of user and administrator accounts
    on the system, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 14.8 – Mimikatz ](img/B18571_14_008.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 14.8 – Mimikatz
  prefs: []
  type: TYPE_NORMAL
- en: Mimikatz can also acquire Kerberos tickets, along with other features, to obtain
    access to valid credentials. Post-exploitation frameworks such as Metasploit and
    Cobalt Strike include Mimikatz.
  prefs: []
  type: TYPE_NORMAL
- en: Discovery
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Once an established foothold has been achieved, ransomware actors such as Conti
    will need to map the internal network to determine the best way to impact as many
    systems as possible. In some instances, this includes running command-line tools
    such as `net localgroup`. Conti has been known to use the network discovery functionality
    within Cobalt Strike. Finally, for more complex networks, you can use the Active
    Directory mapping tool Bloodhound, available at [https://github.com/BloodHoundAD/BloodHound](https://github.com/BloodHoundAD/BloodHound).
    This tool allows the attacker to not only map the network but also provide a visual
    graph. This, in turn, may provide insight into the best attack path.
  prefs: []
  type: TYPE_NORMAL
- en: Lateral movement
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Before executing this tactic, the malicious activity is largely contained to
    a few systems that have either been compromised with the initial execution of
    the RAT or have been compromised by additional tools. The next phase after discovery
    is lateral movement. This is where Conti actors are attempting to compromise as
    many systems as possible so that the impact of the ransomware will be sufficient
    to cause the victim to pay the ransom.
  prefs: []
  type: TYPE_NORMAL
- en: 'Lateral movement for ransomware is largely dependent on having access to credentials,
    often with elevated privileges that allow the use of remote access either through
    the **Server Message Block** (**SMB**) or RDP. In the case of SMB, the specific
    technique is referred to as **Remote Services: SMB/Windows Admin Shares [T1021.002]**.
    In this technique, the attacker will often use the Windows Sysinternals tool PsExec
    to connect to and write to the ADMIN$ network share. They are then able to execute
    additional commands or transfer malicious tools and executables.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Another technique that is often leveraged is **Remote Services: Remote Desktop
    Protocol [1021.001]**. In this case, Conti can leverage the **Virtual Network
    Computing** (**VNC**) functionality of Cobalt Strike to connect to additional
    systems running RDP. From here, they can execute additional commands or place
    additional tools on newly compromised systems.'
  prefs: []
  type: TYPE_NORMAL
- en: An aspect of these techniques is that they depend on having access to legitimate
    administrator-level credentials.
  prefs: []
  type: TYPE_NORMAL
- en: Command and Control
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: One of the key components of the Cobalt Strike post-exploitation tool is its
    ability to customize Command and Control infrastructure. The tool makes use of
    listeners, which are configured by the threat actor. Threat actors can configure
    the listener to use a variety of TCP and UDP protocols such as DNS, HTTP, and
    HTTPS.
  prefs: []
  type: TYPE_NORMAL
- en: 'In addition to the listener, threat actors can also configure an array of malleable
    C2 profiles. These profiles allow the threat actor to obfuscate the C2 traffic
    to bypass detection mechanisms such as intrusion detection or intrusion prevention
    systems. For example, the following section of a malleable profile was taken from
    [https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/amazon.profile](https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/amazon.profile).
    In this profile, the C2 traffic is designed to mimic normal HTTP traffic. One
    specific portion that is worth examining is the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: In this portion of the profile, various settings have been configured. The first
    is the sleep time, which is the interval in seconds when the C2 beacon reaches
    out to the external C2 system for instructions. To bypass IDS systems that look
    for this type of beaconing behavior, a jitter is set. This is a random time that
    can be set that either adds or removes the sleep time so that there is a randomization
    of the beaconing activity. The other key piece of data is the user agent, which
    the profile uses to appear to be a web browser initiating the connection. A casual
    review of any network traffic would show that user agent string.
  prefs: []
  type: TYPE_NORMAL
- en: These malleable profiles are openly available and provide Cobalt Strike with
    the ability to appear like legitimate traffic. In even a small network, this traffic
    between the Cobalt Strike system and the victim systems would blend in with all
    the other traffic that is traversing the ingress/egress point of the network.
  prefs: []
  type: TYPE_NORMAL
- en: Exfiltration
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: One of the key facets of Conti that separated it from other earlier groups or
    campaigns was the theft of data, as well as encryption. In this case, Conti used
    common tools such as WinSCP or PuTTY to send aggregated data via **Secure File
    Transfer Protocol** (**SFTP**) or through the simple HTTPS technique **Exfiltration
    Over Web** **Service [T1567]**.
  prefs: []
  type: TYPE_NORMAL
- en: Impact
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Conti group is associated with the Conti ransomware, which encrypts data
    on infected systems in line with the MITRE ATT&CK technique `CreateIoCompletionPort()`,
    `PostQueuedCompletionStatus()`, and `GetQueuedCompletionPort()` to encrypt files
    with an AES-256 encryption key that is paired with an RSA-4096 public encryption
    key. One unique feature of the Conti variant is that it will bypass `.exe`, `.dll`,
    and `.lnk` files and not encrypt them.
  prefs: []
  type: TYPE_NORMAL
- en: Conti can also execute the **Service Stop [1489]** technique by stopping 146
    separate Windows OS services or processes. These services are related to backups
    and security tools. This allows the ransomware to execute properly and removes
    any ability for the victim to leverage a backup for database or other restoration
    purposes.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, the Conti ransomware can `vssadmin` command. Again, this removes the
    ability of the victim to restore the system after the encryption process. Essentially,
    if Conti is successfully executed, it has an almost certain chance to encrypt
    all but a limited number of files, making the system unusable.
  prefs: []
  type: TYPE_NORMAL
- en: Proper ransomware preparation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Ransomware attacks are devastating to an enterprise. Not many incidents short
    of a natural disaster have the impact that a ransomware attack has. While an APT-style
    network intrusion that aims to gain access to confidential data is severe, they
    often do not leave the entire network encrypted, especially if they are attempting
    to maintain a level of stealth so that the intrusion goes undetected.
  prefs: []
  type: TYPE_NORMAL
- en: In preparing for a ransomware attack, organizations should focus on two specific
    areas. The first is to make the network and endpoints resilient to the impact
    of a ransomware attack. This approach functions under the assumption that the
    threat actor may gain access to a system, but that proper preparation will leave
    them with little in terms of tools or methods to carry their attack any further
    from an initial foothold. The second preparation step is to ensure that the CSIRT
    is familiar with the TTPs of ransomware threat actors and is ready to meet the
    challenge of containing and removing a threat actor from the network.
  prefs: []
  type: TYPE_NORMAL
- en: Ransomware resiliency
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Being resilient against ransomware simply means that we acknowledge that the
    threat exists and has a chance of at least stopping the attack at the endpoint.
    If that does not work, the organization can limit the reach and associated impact
    so that only a few select systems are impacted and normal operations can continue.
    A ransomware resilience strategy should incorporate the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '`rundll32.exe` to execute malicious code. While the use of PowerShell or `rundll32.exe`
    is not in and of itself malicious, the use of the command line to run DLL files
    or Base64-encoded PowerShell is often indicative of malicious behavior.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**System hygiene**: As we saw in the Conti ransomware overview, the group would
    often make use of Windows Sysinternals tools as part of their overall attack.
    Couple that with the use of local administrator accounts and the compromise of
    a single system may pose a significant risk. Systems administrators should ensure
    that deployed endpoints are limited in tools to those that are necessary. Removing
    RDP access, local administrator accounts, and tools such as ProcDump or PsExec
    can make it more difficult to move laterally and infect other systems.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: There are several industry-accepted standards for system hardening, such as
    the **Security Technical Implementation Guides** (**STIGs**), which provide details
    on how to configure and harden a variety of systems. Other guides are available.
    Each organization has to determine its risk and apply the appropriate hardening
    as it sees necessary. The overall goal, no matter how the systems are hardened,
    is to make it difficult for the threat actor to operate in your network.
  prefs: []
  type: TYPE_NORMAL
- en: '**Network topology**: One aspect that stands out concerning ransomware attacks
    that impact the entire network is a “flat” network topology. In this topology,
    all systems can speak to others. For example, a LAN segment for accounts payable
    would be able to reach research and development, even though there is no need
    for these systems to communicate with each other. In short, a flat network allows
    the ransomware threat actor to propagate across the entire enterprise using compromised
    credentials and their tool of choice.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The answer to this is to build a network topology in the same way a shipbuilder
    goes about designing a container ship. Below the waterline, the ship has watertight
    compartments so that if the ship’s hull is compromised, water can only come into
    that compartment alone, keeping the ship above water. The network topology should
    function in much the same way, where different LAN segment communications are
    limited to only necessary communication. The practice of **network segmentation**
    creates specific “watertight” compartments that limit the ability of a threat
    actor to move laterally.
  prefs: []
  type: TYPE_NORMAL
- en: '**Multi-factor authentication**: Remote access is a critical component when
    managing even a small enterprise network. However, the issue is that threat actors
    will often use these to their advantage in spreading ransomware. It is advisable
    to have a **multi-factor authentication** (**MFA**) mechanism in place to limit
    the ability of a threat actor to move laterally if they can compromise an administrator
    account.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Secure backups**: As part of the evolving ransomware threat, we have seen
    groups such as Conti interfere with the ability of organizations to recover from
    a ransomware attack. In the case of Conti, this has included removing the Volume
    Shadow Copy from systems that have been infected. Other groups have even gone
    so far as conducting network discovery to find network-connected **Storage Area
    Networks** (**SANs**) that contained backups and encrypting those as well, essentially
    leaving the organization with no backups. As a result, organizations should assess
    their backup strategy and potentially use offline backups or a cloud solution
    that is in line with their recovery point and recovery time objectives.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Prepping the CSIRT
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'There are a few additional steps related to ransomware that should be included
    in any incident response plan or playbook. The following are some of the key considerations
    when it comes to responding to ransomware:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Rapid isolation or containment**: The most significant risk from ransomware
    is how rapidly it can spread. It can take as little as a few hours for the threat
    actor to complete their objective. To counter this, incident responders should
    ensure that containment can be quickly executed on key technologies such as routers,
    switches, and firewalls. The stumbling block of this rapid containment is the
    need to clear decisions with leadership before such actions take place. This increases
    the time necessary to contain the attack. The best option is to, before an incident,
    discuss under what circumstances the network or security team will cut off communications
    between network segments or the internet so that they have the authority to take
    actions to stem the attack.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Keep up to date on TTPs**: Ransomware threat actors will continually change
    their TTPs to keep ahead of the preventive and detective technology in use in
    modern enterprises. Some of these changes can be subtle and in other instances
    can manifest as significant changes. In either case, threat intelligence sources
    are critical to understanding the threat, how they operate, and how best to align
    preventive and detective controls.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Tabletop exercises**: Finally, one specific action that incident responders
    can take is to craft and facilitate a **tabletop exercise** (**TTX**) for technical
    and leadership that walks through the entire incident life cycle to ensure that
    all units are aligned and key decisions are made before the incident. This ensures
    that actions that are executed during a live incident are preplanned and can decrease
    the time necessary to make key decisions, thereby reducing the incident’s impact.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Eradication and recovery
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If a ransomware attack was successful in an organization, it is important to
    have a plan at hand to bring the organization back up and running as quickly as
    possible. Additionally, as we have seen, these attacks are highly sophisticated
    and involve complex malware that can embed itself deep into the operating system.
    This makes ensuring that the threat has been entirely removed from the network
    difficult. As a result, there are specific ways to contain, eradicate, and recover
    from a ransomware incident that can ensure the best possible outcome.
  prefs: []
  type: TYPE_NORMAL
- en: Containment
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Containing a ransomware incident involves two major actions. The first is to
    remove the capability of the adversary to exercise C2 over compromised systems.
    Adversaries often use a combination of commercial and open source tools such as
    Cobalt Strike or Metasploit, which use a variety of connection types. The goal
    of the initial investigation involves examining systems to identify the nature
    of the C2 infrastructure and communications so that they can be blocked.
  prefs: []
  type: TYPE_NORMAL
- en: The second major action is to remove the ability of the adversary to move laterally
    or to infect additional systems. The key facet of ransomware attacks is the adversary’s
    objective to infect as many systems as possible, thereby increasing the chances
    that a victim will pay the ransom.
  prefs: []
  type: TYPE_NORMAL
- en: Firewall rules
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: For incidents that are not contained within a LAN segment and have the possibility
    of causing enterprise-wide damage, a firewall rule that removes all internet connections
    should be considered until such time the Command and Control mechanism and its
    associated indicators are identified and a more targeted firewall ruleset can
    be configured. The obvious challenge with this type of containment strategy is
    that critical systems will be adversely impacted. Every situation is different,
    and the specific circumstances should be evaluated before taking this step.
  prefs: []
  type: TYPE_NORMAL
- en: Disabling SMB communication
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Adversaries often make use of the SMB function in a Windows enterprise environment.
    Containing a ransomware incident requires removing this functionality. For example,
    you should disable SMBv1 across the entire enterprise permanently (if enabled).
    You should disable SMBv2/v3 temporarily if an alert or triage investigation suggests
    that the protocol is being utilized for lateral movement. Microsoft recommends
    that SMB v2/3 is not permanently disabled. Further guidance from Microsoft is
    available at [https://support.microsoft.com/en-us/help/2696547/detect-enable-disable-smbv1-smbv2-smbv3-in-windows-and-windows-server](https://support.microsoft.com/en-us/help/2696547/detect-enable-disable-smbv1-smbv2-smbv3-in-windows-and-windows-server).
  prefs: []
  type: TYPE_NORMAL
- en: Disabling administrative shares
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Another target of both network exploitation and ransomware attacks is finding
    and accessing network administrative shares. Fortalice Solutions recommends blocking
    admin shares as they are often used by the adversary to spread files or as a source
    for scripts or commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Option 1**: To block admin shares, a recommended solution is to push out
    a GPO preference that applies to the computers to edit the registry:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Create a new `DWORD` value here, named `AutoShareWks`. Leave the value data
    set to Zero. This may require you to restart the host. For further information,
    the following blog provides additional guidance and examples of registry value
    changes: [https://winaero.com/blog/disable-administrative-shares-in-windows-10-windows-8-and-windows-7/](https://winaero.com/blog/disable-administrative-shares-in-windows-10-windows-8-and-windows-7/).'
  prefs: []
  type: TYPE_NORMAL
- en: '**Option 2**: From the Windows command line, enter the following:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Disabling admin shares may cause some adverse impacts. The following blog post
    provides some guidance on what to expect when admin shares are missing: [https://support.microsoft.com/en-us/help/842715/overview-of-problems-that-may-occur-when-administrative-shares-are-missing](https://support.microsoft.com/en-us/help/842715/overview-of-problems-that-may-occur-when-administrative-shares-are-missing).'
  prefs: []
  type: TYPE_NORMAL
- en: Restricting PowerShell use
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Adversaries will often make use of PowerShell as part of delivering ransomware.
    Tools such as PowerSploit are configured to exploit PowerShell’s ability to conduct
    a wide range of actions across the enterprise. If PowerShell must be enabled in
    the environment due to dependent third-party applications, ensure legacy PowerShell
    v2 is disabled as it allows runtime bypassing of the constrained language mode
    and the **Antimalware Scan** **Interface** (**AMSI**).
  prefs: []
  type: TYPE_NORMAL
- en: Restricting remote access
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Remote access applications such as RDP should be disabled until the incident
    is contained or an MFA solution is in place. RDP can be disabled via GPO. One
    concern that is often voiced at this point by incident responders is that removing
    RDP during an incident may impact their ability to acquire evidence. While this
    may be true, the real impact of leaving RDP enabled can be significant. This is
    where tools and techniques for remote evidence capture are critical – it allows
    the responders to remove the ability for attackers to access other systems while
    also allowing the responders to acquire the necessary evidence.
  prefs: []
  type: TYPE_NORMAL
- en: Eradication
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Eradication involves removing the threat actor from the network. This includes
    removing any malware the threat actor implanted, any additional tools that were
    used, and any credentials that may have been compromised. While simple in concept,
    the reality of modern ransomware attacks is that they use a variety of persistence
    mechanisms to ensure that the threat actors continue to have access. Additionally,
    much of the data that is on systems is already encrypted.
  prefs: []
  type: TYPE_NORMAL
- en: The challenge for responders is that without a complete and thorough investigation,
    it is difficult to determine how far the threat actors were able to compromise
    systems. For example, RATs associated with ransomware attacks can place persistence
    mechanisms in scheduled tasks or implant scripts in the registry to execute at
    every startup. Completely reverse-engineering the malware will provide this data
    but the best option is to start fresh.
  prefs: []
  type: TYPE_NORMAL
- en: Removing the threat actor from infected systems often requires a complete rebuild
    from a trusted **Gold Image** or an image that is a known good. The best place
    to start this process is the **Business Continuity Plan** (**BCP**) or **Business
    Resumption Plan** (**BRP**). This outlines how to reconstruct systems from backups
    or reimage and redeploy the image.
  prefs: []
  type: TYPE_NORMAL
- en: Recovery
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Recovery operations should be carefully executed to ensure that an infected
    system is not reintroduced into the network. If there is sufficient evidence,
    a full **root cause analysis** (**RCA**) should be conducted before moving to
    the recovery stage. This ensures that all vulnerabilities or system configurations
    that were exploited by the threat actor are discovered and can be corrected as
    part of the process. Further, systems should only be reintroduced upon a clean
    security tool scan with the appropriate security controls that have been updated
    with the IOCs located during the incident.
  prefs: []
  type: TYPE_NORMAL
- en: Recovery operations can be broken down into two broad categories. The first
    of these is eradicating and redeploying systems to the enterprise architecture.
    In [*Chapter 2*](B18571_02.xhtml#_idTextAnchor028), we discussed the architecture
    necessary to recover from an incident.
  prefs: []
  type: TYPE_NORMAL
- en: Recovery network architecture
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'In [*Chapter 2*](B18571_02.xhtml#_idTextAnchor028), we examined a sample recovery
    architecture for recovering from an incident. The following is a more detailed
    and technical examination of this recovery method, specifically tailored to ransomware:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Configure three separate **Virtual Local Area** **Networks** (**VLANs**):'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Infected VLAN**: This is the network where all infected systems are hosted.
    This can be the production network in circumstances where a large number of systems
    are infected. Ideally, this should be configured as a separate network.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Staging VLAN**: This VLAN is used for incident triage, reimaging, patching,
    security tool installs, and preparing for redeployment:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: The internet should only be enabled for triage, reimaging, software updates,
    and updates to security technology
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Possibility to enable PXE boot for reimaging
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable all security tools such as host intrusion detection, antivirus, or endpoint
    detection and response to detect and quarantine any potential malware or exploits
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Monitor systems for reinfection before moving to clean them
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Clean VLAN**:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: A dully new network with no connection to the “dirty” or “staging” VLANs
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: This will likely involve a new local domain
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Only move systems to here when they are proven to be clean
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: If a domain controller has been compromised, new domain controllers should be
    built from scratch and a known good backup should be deployed on top.
  prefs: []
  type: TYPE_NORMAL
- en: Enterprise password reset
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Many ransomware attacks will impact the domain controllers, along with other
    systems. If the threat actor can identify the domain controller and can compromise
    the `NTDS.DIT` file – the database containing the credentials for the entire enterprise
    – a global password reset will have to be conducted using the following process:'
  prefs: []
  type: TYPE_NORMAL
- en: Change the passwords of all accounts in highly privileged groups.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Roll KRBGT twice (https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/manage/ad-forest-recovery-resetting-the-krbtgt-password).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Change the built-in local admin passwords and possibly deny remote login:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Use Microsoft’s **Local Administrator Password Solution** (**LAPS**) to randomize
    the local administrator password on every endpoint to stop lateral movement and
    store it in Active Directory if it’s manually needed
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Force password change on the next login for all general user accounts.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Disable the ability of the Windows operating system to cache credentials on
    any device where credentials are not needed ([https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-access-do-not-allow-storage-of-passwords-and-credentials-for-network-authentication](https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-access-do-not-allow-storage-of-passwords-and-credentials-for-network-authentication)).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Remote access MFA
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: It is highly recommended that any remote access to systems connected to the
    internal network have MFA enabled. Adversaries are continuing to make use of legitimate
    credentials and accessing remote systems that leverage only a single factor.
  prefs: []
  type: TYPE_NORMAL
- en: Enhanced logging
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'When systems are redeployed, there should be increased monitoring. This will
    increase the likelihood that any systems that may have been compromised and not
    properly recovered can be identified before a significant impact. The following
    are some additional monitoring steps for Windows Event and System logs that are
    important to have forwarded to a SIEM or other log management solution:'
  prefs: []
  type: TYPE_NORMAL
- en: Deploy Sysmon where possible (especially on domain controllers or critical systems).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enable Security Event Log – Permitted a Connection & Bind to Port (5156, 5158
    Event IDs).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enable Security Event Log – IPC$ Connections (5140,5145 Event IDs).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Ensure that PowerShell version 5 has been deployed across all systems. PowerShell
    version 5 allows for enhanced logging, which can help you identify misuse of PowerShell.
    Logging will need to be configured using Group Policy to the following settings:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Turn on Module Logging: Enabled.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Turn on PowerShell Script Block Logging: Enabled.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Turn on Script Execution: Not Configured.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Turn on PowerShell Transcription: Enabled.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Set the default source path for Update-Help: Not Configured.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Local log retention will need to be configured to keep at least 90 days of logs
    present on each server. Logs should forward immediately to the centralized log
    storage system for longer-term retention and analysis.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: It is obvious that recovery is a critical component and that organizations may
    want to get this done as quickly as possible. With that being said, this process
    must be systematic and take the threat into account. Not walking through the recovery
    process in a TTX or rushing the processes increases the chance that a still-infected
    system is reintroduced to the network and the ransomware attack will begin again.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Ransomware is a threat that will be around us for the foreseeable future. In
    this chapter, we looked at the history of ransomware, the common TTPs in use by
    threat actors such as Conti, how to align our incident response to that threat,
    and finally how to contain, eradicate, and recover from it. Understanding these
    TTPs gives us insight into how to detect and prevent such attacks. Understanding
    the response element allows us to respond appropriately and limit the impact.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will examine specific investigative and analysis techniques.
  prefs: []
  type: TYPE_NORMAL
- en: Questions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Answer the following questions to test your knowledge of this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Which threat actor is related to both Ryuk and Conti?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: AtomicSquirrel
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: BadWitch
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Wizard Spider
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: BlackEnergy
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: In the event of a Domain Controller compromise, it is important to perform a
    global password reset.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'True'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: 'False'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: What is the critical component that drives ransomware?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Commonly available RATs
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Cryptocurrency
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Commercial penetration testing tools
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Poor security hygiene
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Threat actor lateral movement can be inhibited by which of the following?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: MFA
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Limiting RDP
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Limiting SMB
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: All of the above
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Refer to the following resources for more details about the topics covered
    in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Preventing* *Ransomware*: [https://www.packtpub.com/product/preventing-ransomware/9781788620604](https://www.packtpub.com/product/preventing-ransomware/9781788620604
    )'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Incident Response Techniques for Ransomware* *Attacks*: https://www.packtpub.com/product/incident-response-techniques-for-ransomware-attacks/9781803240442'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
