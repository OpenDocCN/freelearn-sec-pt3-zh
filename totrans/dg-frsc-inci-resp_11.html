<html><head></head><body>
<div id="_idContainer238">
<h1 class="chapter-number" id="_idParaDest-184"><a id="_idTextAnchor188"/><span class="koboSpan" id="kobo.1.1">11</span></h1>
<h1 id="_idParaDest-185"><a id="_idTextAnchor189"/><span class="koboSpan" id="kobo.2.1">Analyzing System Storage</span></h1>
<p><span class="koboSpan" id="kobo.3.1">So far, the evidence that has been analyzed has focused on those elements that are obtained from the network traffic or the system’s memory. </span><span class="koboSpan" id="kobo.3.2">Even though an incident’s root cause may be ferreted out from these evidence sources, it is important to understand how to obtain evidentiary material from a system’s storage, whether that is removable storage such as USB devices or the larger connected disk drives. </span><span class="koboSpan" id="kobo.3.3">These containers carry a massive amount of data that may be leveraged by incident response analysts to determine a root cause. </span><span class="koboSpan" id="kobo.3.4">It should be noted that this chapter will only be able to scratch the surface as entire volumes have been devoted to the depth of forensic evidence </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">that’s available.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">To provide a better understanding of analyzing system storage, this chapter will focus on the </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">following topics:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.7.1">Forensic platforms</span></strong><span class="koboSpan" id="kobo.8.1">: There are a variety of commercial and open source platforms that we can use to conduct system storage analysis. </span><span class="koboSpan" id="kobo.8.2">This section will address the key features and potential options </span><span class="No-Break"><span class="koboSpan" id="kobo.9.1">we have.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.10.1">Autopsy</span></strong><span class="koboSpan" id="kobo.11.1">: To provide you with an open source platform that can be leveraged in system storage analysis, the majority of this chapter will use the Autopsy tool. </span><span class="koboSpan" id="kobo.11.2">Some of its features will be highlighted by utilizing a </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">test image.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.13.1">Master File Table (MFT) analysis</span></strong><span class="koboSpan" id="kobo.14.1">: Containing a comprehensive list of all the files on the system, the MFT is a key source of data for responders. </span><span class="koboSpan" id="kobo.14.2">This section addresses the extraction and analysis of </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">the MFT.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.16.1">Prefetch analysis</span></strong><span class="koboSpan" id="kobo.17.1">: Determining if a potentially malicious file has been executed is a key piece of incident investigations. </span><span class="koboSpan" id="kobo.17.2">This section will cover extracting a Windows Prefetch file, processing it, and conducting an analysis. </span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.18.1">Registry analysis</span></strong><span class="koboSpan" id="kobo.19.1">: A favorite target of malware coders and other exploits, responders should become familiar with registry analysis. </span><span class="koboSpan" id="kobo.19.2">An overview of how to extract and analyze the registry will be addressed in </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">this section.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.21.1">System storage analysis is a complex process. </span><span class="koboSpan" id="kobo.21.2">The depth and breadth of it cannot be explored in a single chapter; due to this, we hope that this chapter provides some concrete areas of focus with the understanding that responders will gain a better sense of some of the tools that can be employed, as well as an understanding of some of the critical data that can </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">be leveraged.</span></span></p>
<h1 id="_idParaDest-186"><a id="_idTextAnchor190"/><span class="koboSpan" id="kobo.23.1">Forensic platforms</span></h1>
<p><span class="koboSpan" id="kobo.24.1">Over the past 15 years, there </span><a id="_idIndexMarker921"/><span class="koboSpan" id="kobo.25.1">has been an increase in the power of disk </span><a id="_idIndexMarker922"/><span class="koboSpan" id="kobo.26.1">forensics platforms. </span><span class="koboSpan" id="kobo.26.2">For the incident response analyst, there are options as to what type of platform can be leveraged to examine disk drives. </span><span class="koboSpan" id="kobo.26.3">Often, the limiting factor in utilizing these platforms is the cost of more robust systems, when a lower-cost alternative will be just as effective for an incident </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">response team.</span></span></p>
<p><span class="koboSpan" id="kobo.28.1">Several factors should be addressed when examining software for disk analysis. </span><span class="koboSpan" id="kobo.28.2">First, has the platform been tested? </span><span class="koboSpan" id="kobo.28.3">Several organizations test platforms for efficacy, such as the National Institute of Standards and Technology Computer Forensic Tools Testing Program (</span><a href="https://www.cftt.nist.gov/"><span class="koboSpan" id="kobo.29.1">https://www.cftt.nist.gov/</span></a><span class="koboSpan" id="kobo.30.1">). </span><span class="koboSpan" id="kobo.30.2">Second, the tool’s use in criminal and civil proceedings must be examined. </span><span class="koboSpan" id="kobo.30.3">There is no single court-accepted standard, but tools should conform to the rules of evidence. </span><span class="koboSpan" id="kobo.30.4">The use of a platform that has not been tested or does not conform to the rules of evidence may lead to the evidence being excluded from legal proceedings. </span><span class="koboSpan" id="kobo.30.5">In other, more disastrous consequences, it may lead to an analyst arriving at the </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">wrong conclusion.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.32.1">Forensically sound tools</span></p>
<p class="callout"><span class="koboSpan" id="kobo.33.1">An example of an untested and forensically unsound toolset that was used in a criminal proceeding was in the case of The State of Connecticut versus Amero. </span><span class="koboSpan" id="kobo.33.2">In this case, a law enforcement agency utilized unsound forensic methods and tools to convict a woman for allegedly allowing children to see sexually explicit pop-up ads. </span><span class="koboSpan" id="kobo.33.3">A subsequent review of the methods and facts of this case indicated that there were significant deficiencies with the forensic examination. </span><span class="koboSpan" id="kobo.33.4">An excellent examination of this case is also available from the Journal of Digital Forensics, Security, and Law </span><span class="No-Break"><span class="koboSpan" id="kobo.34.1">at </span></span><a href="https://commons.erau.edu/jdfsl/vol7/iss2/5/"><span class="No-Break"><span class="koboSpan" id="kobo.35.1">https://commons.erau.edu/jdfsl/vol7/iss2/5/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.36.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.37.1">One final consideration is how the tool fits into the overall incident response planning. </span><span class="koboSpan" id="kobo.37.2">For example, commercial disk forensics tools are excellent at locating images and web artifacts. </span><span class="koboSpan" id="kobo.37.3">They are also excellent at carving out data from a suspect's drive. </span><span class="koboSpan" id="kobo.37.4">This is often because forensic software is utilized by law enforcement agencies as a tool to investigate child exploitation crimes. </span><span class="koboSpan" id="kobo.37.5">As a result, this capability is paramount to bringing a criminal case against such suspects. </span><span class="koboSpan" id="kobo.37.6">While these are excellent capabilities to have, incident responders may be more interested in tools that can be utilized for keyword searches and timeline</span><a id="_idIndexMarker923"/><span class="koboSpan" id="kobo.38.1"> analysis so that they can reconstruct a series of events before, during, and </span><a id="_idIndexMarker924"/><span class="koboSpan" id="kobo.39.1">after </span><span class="No-Break"><span class="koboSpan" id="kobo.40.1">an incident.</span></span></p>
<p><span class="koboSpan" id="kobo.41.1">While most commercial and free forensic platforms have a variety of features, several common ones can be of use to incident </span><span class="No-Break"><span class="koboSpan" id="kobo.42.1">response personnel:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.43.1">File structure view</span></strong><span class="koboSpan" id="kobo.44.1">: It is </span><a id="_idIndexMarker925"/><span class="koboSpan" id="kobo.45.1">often very important to be </span><a id="_idIndexMarker926"/><span class="koboSpan" id="kobo.46.1">able to view the file structure of the disk under examination. </span><span class="koboSpan" id="kobo.46.2">Forensic platforms should have the ability to view the file structure and allow responders to quickly review files with known locations on a </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">suspect system.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.48.1">Hex viewer</span></strong><span class="koboSpan" id="kobo.49.1">: Having</span><a id="_idIndexMarker927"/><span class="koboSpan" id="kobo.50.1"> the ability to view files in hexadecimal allows responders to have a granular look at the files under examination. </span><span class="koboSpan" id="kobo.50.2">This may be beneficial in cases involving malware or other </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">custom exploits.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.52.1">Web artifacts</span></strong><span class="koboSpan" id="kobo.53.1">: With a</span><a id="_idIndexMarker928"/><span class="koboSpan" id="kobo.54.1"> great deal of data stored on the drive associated with web searching, forensic platforms should have the ability to examine these pieces of data. </span><span class="koboSpan" id="kobo.54.2">This is very handy when examining social engineering attacks where users navigate to a </span><span class="No-Break"><span class="koboSpan" id="kobo.55.1">malicious website.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.56.1">Email carving</span></strong><span class="koboSpan" id="kobo.57.1">: Incident </span><a id="_idIndexMarker929"/><span class="koboSpan" id="kobo.58.1">responders may be called into cases where malicious employees are involved in illegal activities or have committed policy violations. </span><span class="koboSpan" id="kobo.58.2">Often, evidence of this type of conduct is contained within emails on the suspect system. </span><span class="koboSpan" id="kobo.58.3">Having a platform that can pull this data out for immediate view assists the analyst in viewing communication between the suspect system </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">and others.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.60.1">Image viewer</span></strong><span class="koboSpan" id="kobo.61.1">: Often, it </span><a id="_idIndexMarker930"/><span class="koboSpan" id="kobo.62.1">is necessary to view the images that are saved on systems. </span><span class="koboSpan" id="kobo.62.2">As we mentioned previously, law enforcement may utilize this feature to determine whether there is evidence of child exploitation on a system. </span><span class="koboSpan" id="kobo.62.3">Incident responders can utilize these features to determine whether there </span><a id="_idIndexMarker931"/><span class="koboSpan" id="kobo.63.1">has been a </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">policy violation.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.65.1">Metadata</span></strong><span class="koboSpan" id="kobo.66.1">: Key </span><a id="_idIndexMarker932"/><span class="koboSpan" id="kobo.67.1">pieces of data about files such as date and time created, file hashes, and the location of a suspect file on the disk are useful when examining a system associated with an incident. </span><span class="koboSpan" id="kobo.67.2">For example, the time an application is run, taken in conjunction with a piece of malware, may be correlated with network activity, allowing </span><a id="_idIndexMarker933"/><span class="koboSpan" id="kobo.68.1">the analyst to determine the actual </span><span class="No-Break"><span class="koboSpan" id="kobo.69.1">executable run.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.70.1">In terms of </span><a id="_idIndexMarker934"/><span class="koboSpan" id="kobo.71.1">commercial options, the following three platforms are generally accepted as sound and are in use by commercial and government entities all over the world. </span><span class="koboSpan" id="kobo.71.2">Each uses the features we described previously, among other, more </span><span class="No-Break"><span class="koboSpan" id="kobo.72.1">specialized, tools:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.73.1">OpenText EnCase</span></strong><span class="koboSpan" id="kobo.74.1">: Arguably </span><a id="_idIndexMarker935"/><span class="koboSpan" id="kobo.75.1">the preeminent forensics platform, EnCase has a long history of being the platform that’s used in major criminal investigations, such as the BTK Killer. </span><span class="koboSpan" id="kobo.75.2">EnCase is a feature-rich platform that makes it a powerful tool in the hands of a trained analyst. </span><span class="koboSpan" id="kobo.75.3">In addition to disk forensics, EnCase also has integrated features for mobile devices. </span><span class="koboSpan" id="kobo.75.4">This is a powerful capability for organizations that may have to analyze not only disks but also mobile devices in connection with </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">an incident.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.77.1">AccessData Forensic Toolkit</span></strong><span class="koboSpan" id="kobo.78.1">: In </span><a href="B18571_06.xhtml#_idTextAnchor105"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.79.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.80.1">, the FTK Imager tool was utilized to</span><a id="_idIndexMarker936"/><span class="koboSpan" id="kobo.81.1"> acquire disk and memory evidence. </span><span class="koboSpan" id="kobo.81.2">This tool is part of a suite of tools provided by AccessData that have been specifically tailored for disk forensics. </span><span class="koboSpan" id="kobo.81.3">In addition to the imager, Access Data has a full-featured forensic platform that allows responders </span><a id="_idIndexMarker937"/><span class="koboSpan" id="kobo.82.1">to perform a range of tasks associated with an incident. </span><span class="koboSpan" id="kobo.82.2">FTK is in use by law enforcement agencies such as the </span><strong class="bold"><span class="koboSpan" id="kobo.83.1">Federal Bureau of Investigation</span></strong><span class="koboSpan" id="kobo.84.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.85.1">FBI</span></strong><span class="koboSpan" id="kobo.86.1">) and </span><a id="_idIndexMarker938"/><span class="koboSpan" id="kobo.87.1">has proven to be more than effective in assisting responders with </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">incident investigations.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.89.1">X-Ways Forensics</span></strong><span class="koboSpan" id="kobo.90.1">: One drawback of FTK and EnCase is cost. </span><span class="koboSpan" id="kobo.90.2">These platforms can cost </span><a id="_idIndexMarker939"/><span class="koboSpan" id="kobo.91.1">several thousands of dollars per year. </span><span class="koboSpan" id="kobo.91.2">For larger organizations, such as government agencies and large enterprises, the trade-off of cost versus features may not be an issue. </span><span class="koboSpan" id="kobo.91.3">For smaller organizations, these platforms may be cost-prohibitive. </span><span class="koboSpan" id="kobo.91.4">An alternative, feature-rich forensic platform is X-Ways. </span><span class="koboSpan" id="kobo.91.5">This platform can perform a variety of tasks but at a fraction of the cost. </span><span class="koboSpan" id="kobo.91.6">Another great benefit of X-Ways is that it is less resource-intensive and can be run off a USB device, making</span><a id="_idIndexMarker940"/><span class="koboSpan" id="kobo.92.1"> it an alternative platform, especially for </span><span class="No-Break"><span class="koboSpan" id="kobo.93.1">incident response.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.94.1">Each of these platforms has a rich feature set and provides responders with a powerful tool for conducting a wide range of forensic tasks. </span><span class="koboSpan" id="kobo.94.2">The specific tools in each of these platforms are </span><a id="_idIndexMarker941"/><span class="koboSpan" id="kobo.95.1">outside the scope of this book. </span><span class="koboSpan" id="kobo.95.2">As such, it is recommended that responders are trained on how to use these platforms to ensure that they fully understand these </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">tools’ capabilities.</span></span></p>
<h1 id="_idParaDest-187"><a id="_idTextAnchor191"/><span class="koboSpan" id="kobo.97.1">Autopsy</span></h1>
<p><span class="koboSpan" id="kobo.98.1">One alternative</span><a id="_idIndexMarker942"/><span class="koboSpan" id="kobo.99.1"> to </span><a id="_idIndexMarker943"/><span class="koboSpan" id="kobo.100.1">commercial forensics programs is Autopsy. </span><span class="koboSpan" id="kobo.100.2">Autopsy is a GUI-based forensic platform based on the open source The Sleuth Kit toolset. </span><span class="koboSpan" id="kobo.100.3">This open source platform provides features that are commonly found in commercial platforms. </span><span class="koboSpan" id="kobo.100.4">This includes timeline analysis, keyword searching, web and email artifacts, and the ability to filter results on known bad file hashes. </span><span class="koboSpan" id="kobo.100.5">One of its key features is its ease of use. </span><span class="koboSpan" id="kobo.100.6">This allows incident responders to have a light platform that focuses on critical tasks and obtain the critical evidence </span><span class="No-Break"><span class="koboSpan" id="kobo.101.1">that’s needed.</span></span></p>
<h2 id="_idParaDest-188"><a id="_idTextAnchor192"/><span class="koboSpan" id="kobo.102.1">Installing Autopsy</span></h2>
<p><span class="koboSpan" id="kobo.103.1">Several of the Linux </span><a id="_idIndexMarker944"/><span class="koboSpan" id="kobo.104.1">distributions we discussed previously have Autopsy preinstalled. </span><span class="koboSpan" id="kobo.104.2">It is good practice for responders to ensure that the platform they are using is up to date. </span><span class="koboSpan" id="kobo.104.3">For the Windows operating system, download the Microsoft self-installer file located at </span><a href="https://www.sleuthkit.org/autopsy/download.php"><span class="koboSpan" id="kobo.105.1">https://www.sleuthkit.org/autopsy/download.php</span></a><span class="koboSpan" id="kobo.106.1">. </span><span class="koboSpan" id="kobo.106.2">Once downloaded, execute the MSI file and choose an install location. </span><span class="koboSpan" id="kobo.106.3">Once you’ve done this, the application </span><a id="_idIndexMarker945"/><span class="koboSpan" id="kobo.107.1">will be ready </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">to use.</span></span></p>
<h2 id="_idParaDest-189"><a id="_idTextAnchor193"/><span class="koboSpan" id="kobo.109.1">Starting a case</span></h2>
<p><span class="koboSpan" id="kobo.110.1">Once Autopsy</span><a id="_idIndexMarker946"/><span class="koboSpan" id="kobo.111.1"> has been installed, the analyst can open a case with very little pre-configuration. </span><span class="koboSpan" id="kobo.111.2">The following steps will discuss the process of opening a </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">new case:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.113.1">To begin an analysis, ensure that the entire disk image is contained in a single directory. </span><span class="koboSpan" id="kobo.113.2">This allows the entire image to be utilized during </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">the analysis:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer194">
<span class="koboSpan" id="kobo.115.1"><img alt="Figure 11.1 – E01 files " src="image/B18571_11_001.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.116.1">Figure 11.1 – E01 files</span></p>
<p><span class="koboSpan" id="kobo.117.1">In the preceding screenshot, an image file has been taken from a suspect system. </span><span class="koboSpan" id="kobo.117.2">The image has been divided into two separate files. </span><span class="koboSpan" id="kobo.117.3">Looking back to </span><a href="B18571_08.xhtml#_idTextAnchor136"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.118.1">Chapter 8</span></em></span></a><span class="koboSpan" id="kobo.119.1">, imaging applications such as FTK Imager will divide an image into multiple files. </span><span class="koboSpan" id="kobo.119.2">So long as the separate files are in the same directory, Autopsy will be able to take the two files and reconstruct the entire volume that has </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">been imaged.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.121.1">Sample image file</span></p>
<p class="callout"><span class="koboSpan" id="kobo.122.1">For our examination of Autopsy, a sample image file taken from a Windows 10 system can be found at </span><a href="https://cfreds.nist.gov/all/MagnetForensics/2022WindowsMagnetCTF"><span class="koboSpan" id="kobo.123.1">https://cfreds.nist.gov/all/MagnetForensics/2022WindowsMagnetCTF</span></a><span class="koboSpan" id="kobo.124.1">. </span><span class="koboSpan" id="kobo.124.2">For more practice, additional testing images can be downloaded from the Computer Forensic Reference Data Sets located </span><span class="No-Break"><span class="koboSpan" id="kobo.125.1">at </span></span><a href="https://www.cfreds.nist.gov/"><span class="No-Break"><span class="koboSpan" id="kobo.126.1">https://www.cfreds.nist.gov/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.127.1">.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.128.1">Open Autopsy. </span><span class="koboSpan" id="kobo.128.2">The following window will appear; select </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.129.1">New Case</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.130.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer195">
<span class="koboSpan" id="kobo.131.1"><img alt="Figure 11.2 – Autopsy – creating a new case " src="image/B18571_11_002.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.132.1">Figure 11.2 – Autopsy – creating a new case</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.133.1">A second </span><a id="_idIndexMarker947"/><span class="koboSpan" id="kobo.134.1">window will appear where the analyst will input the case’s title. </span><span class="koboSpan" id="kobo.134.2">In addition, the path to Autopsy that will store the files associated with the case can also be set. </span><span class="koboSpan" id="kobo.134.3">This is useful when circumstances dictate that the analyst must place the files in a specific container, including external drives. </span><span class="koboSpan" id="kobo.134.4">Once done, </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.136.1">Next</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer196">
<span class="koboSpan" id="kobo.138.1"><img alt="Figure 11.3 – Autopsy – New Case Information " src="image/B18571_11_003.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.139.1">Figure 11.3 – Autopsy – New Case Information</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.140.1">On the next </span><a id="_idIndexMarker948"/><span class="koboSpan" id="kobo.141.1">window, the responder should input the case number, their name, their contact information, and a brief description of the case in </span><strong class="bold"><span class="koboSpan" id="kobo.142.1">Notes</span></strong><span class="koboSpan" id="kobo.143.1">. </span><span class="No-Break"><span class="koboSpan" id="kobo.144.1">Click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.145.1">Finish</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer197">
<span class="koboSpan" id="kobo.147.1"><img alt="Figure 11.4 – New Case Information – Optional Information " src="image/B18571_11_004.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.148.1">Figure 11.4 – New Case Information – Optional Information</span></p>
<h2 id="_idParaDest-190"><a id="_idTextAnchor194"/><span class="koboSpan" id="kobo.149.1">Adding evidence</span></h2>
<p><span class="koboSpan" id="kobo.150.1">One way to think </span><a id="_idIndexMarker949"/><span class="koboSpan" id="kobo.151.1">of the case is as a container for all the related case data and evidence related to an incident. </span><span class="koboSpan" id="kobo.151.2">Autopsy allows the analyst to add multiple data sources such as disk images and virtual machine disks as well. </span><span class="koboSpan" id="kobo.151.3">At this stage, we will load the </span><strong class="source-inline"><span class="koboSpan" id="kobo.152.1">E01</span></strong><span class="koboSpan" id="kobo.153.1"> file as a </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">data source:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.155.1">Once the case details have been entered, the analyst will need to load the image file that was created previously. </span><span class="koboSpan" id="kobo.155.2">Click on the </span><strong class="bold"><span class="koboSpan" id="kobo.156.1">Add Data Source</span></strong><span class="koboSpan" id="kobo.157.1"> button in the top left-hand corner of the </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">Autopsy window:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer198">
<span class="koboSpan" id="kobo.159.1"><img alt="Figure 11.5 – Add Data Source – Select Host " src="image/B18571_11_005.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.160.1">Figure 11.5 – Add Data Source – Select Host</span></p>
<p><span class="koboSpan" id="kobo.161.1">Autopsy can</span><a id="_idIndexMarker950"/><span class="koboSpan" id="kobo.162.1"> automatically detect the hostname. </span><span class="koboSpan" id="kobo.162.2">If the analyst knows the hostname, it can be added in the </span><strong class="bold"><span class="koboSpan" id="kobo.163.1">Specific new host name</span></strong><span class="koboSpan" id="kobo.164.1"> field. </span><span class="koboSpan" id="kobo.164.2">From a best practices perspective, if known, the host’s name should always be entered. </span><span class="koboSpan" id="kobo.164.3">Once complete, </span><span class="No-Break"><span class="koboSpan" id="kobo.165.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.166.1">Next</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.167.1">.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.168.1">Select the appropriate data source type. </span><span class="koboSpan" id="kobo.168.2">In this case, the examination will be conducted against an image file that was forensically acquired. </span><span class="koboSpan" id="kobo.168.3">Autopsy can also examine </span><strong class="source-inline"><span class="koboSpan" id="kobo.169.1">.vmdk</span></strong><span class="koboSpan" id="kobo.170.1"> files. </span><span class="koboSpan" id="kobo.170.2">This is a handy feature in environments where virtualization is utilized for systems. </span><span class="koboSpan" id="kobo.170.3">This feature allows the analyst to examine a VM file, without having to acquire it via tools such as </span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">FTK Imager:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer199">
<span class="koboSpan" id="kobo.172.1"><img alt="Figure 11.6 – Add Data Source – Select Data Source Type " src="image/B18571_11_006.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.173.1">Figure 11.6 – Add Data Source – Select Data Source Type</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.174.1">Once the </span><a id="_idIndexMarker951"/><span class="koboSpan" id="kobo.175.1">data source type has been selected, browse to the image location. </span><span class="koboSpan" id="kobo.175.2">This folder contains several image files; select the file that ends in </span><strong class="source-inline"><span class="koboSpan" id="kobo.176.1">E01</span></strong><span class="koboSpan" id="kobo.177.1">. </span><span class="koboSpan" id="kobo.177.2">Loading this file will include all the subsequent image files located in that folder. </span><span class="koboSpan" id="kobo.177.3">Next, select the appropriate time zone. </span><span class="koboSpan" id="kobo.177.4">As a matter of best practice, analysts should select a time zone that is uniform across the investigation. </span><span class="koboSpan" id="kobo.177.5">In that case, the best option is to select UTC. </span><span class="koboSpan" id="kobo.177.6">Once done, </span><span class="No-Break"><span class="koboSpan" id="kobo.178.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.179.1">Next</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer200">
<span class="koboSpan" id="kobo.181.1"><img alt="Figure 11.7 – Selecting the E01 file " src="image/B18571_11_007.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.182.1">Figure 11.7 – Selecting the E01 file</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.183.1">The next</span><a id="_idIndexMarker952"/><span class="koboSpan" id="kobo.184.1"> screen allows the analyst to tailor the modules in use. </span><span class="koboSpan" id="kobo.184.2">Depending on the type of investigation, some of these options can go unchecked. </span><span class="koboSpan" id="kobo.184.3">In the beginning, though, the analyst should select all of them to ensure that all the necessary information is available </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">for examination.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.186.1">One other option is to process unallocated space (this is important!). </span><span class="koboSpan" id="kobo.186.2">This captures all the information in the space that’s not currently allocated to data on the hard drive. </span><span class="koboSpan" id="kobo.186.3">There are methods where unallocated space can be utilized to hide information. </span><span class="koboSpan" id="kobo.186.4">Once done, </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.188.1">Next</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.189.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer201">
<span class="koboSpan" id="kobo.190.1"><img alt="Figure 11.8 – Add Data Source – Configure Ingest " src="image/B18571_11_008.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.191.1">Figure 11.8 – Add Data Source – Configure Ingest</span></p>
<p><span class="koboSpan" id="kobo.192.1">This will</span><a id="_idIndexMarker953"/><span class="koboSpan" id="kobo.193.1"> start the </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">processing procedure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer202">
<span class="koboSpan" id="kobo.195.1"><img alt="Figure 11.9 – Data source processing " src="image/B18571_11_009.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.196.1">Figure 11.9 – Data source processing</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.197.1">On the next </span><a id="_idIndexMarker954"/><span class="koboSpan" id="kobo.198.1">screen, verify that the data source has been loaded and click </span><strong class="bold"><span class="koboSpan" id="kobo.199.1">Finish</span></strong><span class="koboSpan" id="kobo.200.1">. </span><span class="koboSpan" id="kobo.200.2">This will start the process of adding the E01 file as a </span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">data source:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer203">
<span class="koboSpan" id="kobo.202.1"><img alt="Figure 11.10 – Data source complete " src="image/B18571_11_010.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.203.1">Figure 11.10 – Data source complete</span></p>
<p><span class="koboSpan" id="kobo.204.1">Autopsy will</span><a id="_idIndexMarker955"/><span class="koboSpan" id="kobo.205.1"> now go through the process of analyzing the files from the image. </span><span class="koboSpan" id="kobo.205.2">Depending on the size of the image, this will take between several minutes and a couple of hours. </span><span class="koboSpan" id="kobo.205.3">The process bar in the lower-right corner of the screen will show its progress. </span><span class="koboSpan" id="kobo.205.4">How long this process takes is often dependent on the processing speed of the computer, as well as the size of the image file(s). </span><span class="koboSpan" id="kobo.205.5">At this point, Autopsy will start to populate the specific fields in the left-hand pane, even though additional processing is taking place. </span><span class="koboSpan" id="kobo.205.6">The lower right-hand corner of the GUI will show the progress of </span><span class="No-Break"><span class="koboSpan" id="kobo.206.1">the processing:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer204">
<span class="koboSpan" id="kobo.207.1"><img alt="Figure 11.11 – Evidence source processing " src="image/B18571_11_011.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.208.1">Figure 11.11 – Evidence source processing</span></p>
<p><span class="koboSpan" id="kobo.209.1">As was stated earlier, processing may take some time, depending on the forensic system’s specifications and the size of the file. </span><span class="koboSpan" id="kobo.209.2">Analysts can conduct some analysis with the </span><a id="_idIndexMarker956"/><span class="koboSpan" id="kobo.210.1">understanding that not all data may </span><span class="No-Break"><span class="koboSpan" id="kobo.211.1">be available.</span></span></p>
<h2 id="_idParaDest-191"><a id="_idTextAnchor195"/><span class="koboSpan" id="kobo.212.1">Navigating Autopsy</span></h2>
<p><span class="koboSpan" id="kobo.213.1">The Autopsy GUI is</span><a id="_idIndexMarker957"/><span class="koboSpan" id="kobo.214.1"> divided into three main sections. </span><span class="koboSpan" id="kobo.214.2">These sections display details relating to the system and specific files. </span><span class="koboSpan" id="kobo.214.3">When Autopsy has finished processing a new case or opening an existing case, the analyst will see the </span><span class="No-Break"><span class="koboSpan" id="kobo.215.1">following window:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer205">
<span class="koboSpan" id="kobo.216.1"><img alt="Figure 11.12 – Autopsy GUI " src="image/B18571_11_012.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.217.1">Figure 11.12 – Autopsy GUI</span></p>
<p><span class="koboSpan" id="kobo.218.1">As shown in the previous screenshot, Autopsy is divided into three main panes. </span><span class="koboSpan" id="kobo.218.2">The first of these is the left-hand pane, which contains the data sources and file structure, as well as search results. </span><span class="koboSpan" id="kobo.218.3">Clicking on the plus (</span><strong class="bold"><span class="koboSpan" id="kobo.219.1">+</span></strong><span class="koboSpan" id="kobo.220.1">) sign expands the results while clicking on the minus (</span><strong class="bold"><span class="koboSpan" id="kobo.221.1">-</span></strong><span class="koboSpan" id="kobo.222.1">) sign collapses them. </span><span class="koboSpan" id="kobo.222.2">This allows the analyst to access the system at a high level, and also drill down to specific elements. </span><span class="koboSpan" id="kobo.222.3">The center pane contains directory listings or results from searches. </span><span class="koboSpan" id="kobo.222.4">For example, the following screenshot shows the </span><strong class="source-inline"><span class="koboSpan" id="kobo.223.1">Program Files</span></strong><span class="koboSpan" id="kobo.224.1"> directory that was located on </span><span class="No-Break"><span class="koboSpan" id="kobo.225.1">the system:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer206">
<span class="koboSpan" id="kobo.226.1"><img alt="Figure 11.13 – Autopsy’s center pane " src="image/B18571_11_013.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.227.1">Figure 11.13 – Autopsy’s center pane</span></p>
<p><span class="koboSpan" id="kobo.228.1">Finally, the bottom pane contains the metadata and other information about individual files contained</span><a id="_idIndexMarker958"/><span class="koboSpan" id="kobo.229.1"> in the center pane. </span><span class="koboSpan" id="kobo.229.2">In this example, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.230.1">desktop.ini</span></strong><span class="koboSpan" id="kobo.231.1"> file has been selected. </span><span class="koboSpan" id="kobo.231.2">Clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.232.1">File Metadata</span></strong><span class="koboSpan" id="kobo.233.1"> tab displays information specific to </span><span class="No-Break"><span class="koboSpan" id="kobo.234.1">that file:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer207">
<span class="koboSpan" id="kobo.235.1"><img alt="Figure 11.14 – File metadata " src="image/B18571_11_014.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.236.1">Figure 11.14 – File metadata</span></p>
<p><span class="koboSpan" id="kobo.237.1">Finally, the file’s hexadecimal content can be viewed by clicking on the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.238.1">Hex</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.239.1"> tab:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer208">
<span class="koboSpan" id="kobo.240.1"><img alt="Figure 11.15 – Hex view " src="image/B18571_11_015.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.241.1">Figure 11.15 – Hex view</span></p>
<p><span class="koboSpan" id="kobo.242.1">This view is excellent if an analyst wants to inspect an application or another file that is suspected of </span><span class="No-Break"><span class="koboSpan" id="kobo.243.1">being malware.</span></span></p>
<p><span class="koboSpan" id="kobo.244.1">What Autopsy offers is the ability to perform some of the actions and analyses that can be found on other commercial platforms. </span><span class="koboSpan" id="kobo.244.2">However, it should be noted that in the case of more complex investigations, it may become necessary to utilize more sophisticated platforms. </span><span class="koboSpan" id="kobo.244.3">Autopsy</span><a id="_idIndexMarker959"/><span class="koboSpan" id="kobo.245.1"> also provides responders that are new to disk forensics with a more user-friendly platform so that they can gain experience with one before they move on to a more sophisticated </span><span class="No-Break"><span class="koboSpan" id="kobo.246.1">commercial solution.</span></span></p>
<h2 id="_idParaDest-192"><a id="_idTextAnchor196"/><span class="koboSpan" id="kobo.247.1">Examining a case</span></h2>
<p><span class="koboSpan" id="kobo.248.1">Once the </span><a id="_idIndexMarker960"/><span class="koboSpan" id="kobo.249.1">case has been processed, the left-hand pane will be populated with the number of artifacts located in </span><span class="No-Break"><span class="koboSpan" id="kobo.250.1">the system:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer209">
<span class="koboSpan" id="kobo.251.1"><img alt="Figure 11.16 – Autopsy’s artifacts pane " src="image/B18571_11_016.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.252.1">Figure 11.16 – Autopsy’s artifacts pane</span></p>
<p><span class="koboSpan" id="kobo.253.1">In the previous </span><a id="_idIndexMarker961"/><span class="koboSpan" id="kobo.254.1">screenshot, there are several items listed under the </span><strong class="bold"><span class="koboSpan" id="kobo.255.1">Data Artifacts</span></strong><span class="koboSpan" id="kobo.256.1"> portion. </span><span class="koboSpan" id="kobo.256.2">These include looking at programs that have been installed, the operating system’s information, and recent documents. </span><span class="koboSpan" id="kobo.256.3">Another key feature of Autopsy is the ability to examine the entire folder structure of the image file. </span><span class="koboSpan" id="kobo.256.4">Clicking on the plus (</span><strong class="bold"><span class="koboSpan" id="kobo.257.1">+</span></strong><span class="koboSpan" id="kobo.258.1">) sign next to </span><strong class="bold"><span class="koboSpan" id="kobo.259.1">Data Sources</span></strong><span class="koboSpan" id="kobo.260.1"> expands the entire folder structure. </span><span class="koboSpan" id="kobo.260.2">This is useful if, through other sources, an analyst can identify the location of a </span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">suspect file:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer210">
<span class="koboSpan" id="kobo.262.1"><img alt="Figure 11.17 – Data Sources " src="image/B18571_11_017.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.263.1">Figure 11.17 – Data Sources</span></p>
<p><span class="koboSpan" id="kobo.264.1">Different data </span><a id="_idIndexMarker962"/><span class="koboSpan" id="kobo.265.1">points can be examined by utilizing Autopsy. </span><span class="koboSpan" id="kobo.265.2">What to search for and how to search for it is often dictated by the type of incident or examination under investigation. </span><span class="koboSpan" id="kobo.265.3">For example, a malware infection that originates from a compromised website may involve examining the system for URLs that the user may have typed in or otherwise accessed via a browser. </span><span class="koboSpan" id="kobo.265.4">Furthermore, the actual file may be located by utilizing information that’s been obtained by examining the system memory, which we covered in the previous chapter. </span><span class="koboSpan" id="kobo.265.5">For example, if an analyst was able to locate a suspect process and was subsequently able to also locate the executable, they may utilize Autopsy to find the last time the executable was launched. </span><span class="koboSpan" id="kobo.265.6">This can provide responders with a time so that they can examine other systems for evidence </span><span class="No-Break"><span class="koboSpan" id="kobo.266.1">of compromise.</span></span></p>
<p><span class="koboSpan" id="kobo.267.1">In another scenario, responders may be tasked with identifying whether an employee accessed confidential files so that they could pass them on to a competitor. </span><span class="koboSpan" id="kobo.267.2">This may involve examining the system for the times and dates when files were accessed, email addresses that may have been used, external cloud storage sites that were accessed, or USB storage that </span><a id="_idIndexMarker963"/><span class="koboSpan" id="kobo.268.1">was connected to the system. </span><span class="koboSpan" id="kobo.268.2">Finally, a full list of these files may provide insight into the confidential documents that </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">were moved.</span></span></p>
<h3><span class="koboSpan" id="kobo.270.1">Web artifacts</span></h3>
<p><span class="koboSpan" id="kobo.271.1">There are several types </span><a id="_idIndexMarker964"/><span class="koboSpan" id="kobo.272.1">of incidents where it may be necessary to</span><a id="_idIndexMarker965"/><span class="koboSpan" id="kobo.273.1"> examine a system for evidence of malicious activity that’s been conducted by a user. </span><span class="koboSpan" id="kobo.273.2">Previously, we mentioned accessing cloud-based storage where a malicious insider had uploaded confidential documents. </span><span class="koboSpan" id="kobo.273.3">In other circumstances, social engineering attacks may have an unsuspecting employee navigate to a compromised website that subsequently downloads malicious software. </span><span class="koboSpan" id="kobo.273.4">In either case, Autopsy provides us with the ability to examine several areas of </span><span class="No-Break"><span class="koboSpan" id="kobo.274.1">web artifacts.</span></span></p>
<p><span class="koboSpan" id="kobo.275.1">The first of these web </span><a id="_idIndexMarker966"/><span class="koboSpan" id="kobo.276.1">artifacts is </span><strong class="bold"><span class="koboSpan" id="kobo.277.1">web history</span></strong><span class="koboSpan" id="kobo.278.1">. </span><span class="koboSpan" id="kobo.278.2">In the event of a social engineering attack that involves a user navigating to a malware delivery site, this data may provide some insight into the specific URL that was navigated to. </span><span class="koboSpan" id="kobo.278.3">This URL can then be extracted and compared with known malicious website lists from internal or external sources. </span><span class="koboSpan" id="kobo.278.4">In other cases, where an insider has accessed an external cloud storage site, the web history may provide evidence of this activity. </span><span class="koboSpan" id="kobo.278.5">Let’s take a look at this case </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">in detail:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.280.1">Clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.281.1">Web History</span></strong><span class="koboSpan" id="kobo.282.1"> section in the left-hand pane opens the center pane and shows detailed information concerning a URL that was accessed by </span><span class="No-Break"><span class="koboSpan" id="kobo.283.1">the system:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer211">
<span class="koboSpan" id="kobo.284.1"><img alt="Figure 11.18 – Web History " src="image/B18571_11_018.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.285.1">Figure 11.18 – Web History</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.286.1">In the preceding screenshot, Autopsy indicates that the website </span><a href="http://hacker-simulator.com"><span class="koboSpan" id="kobo.287.1">hacker-simulator.com</span></a><span class="koboSpan" id="kobo.288.1"> was accessed by this system. </span><span class="koboSpan" id="kobo.288.2">Further information provided by Autopsy allows the analyst to evaluate other information, such as the location of the artifact and what type of browser was used. </span><span class="koboSpan" id="kobo.288.3">This information can be accessed via the </span><strong class="bold"><span class="koboSpan" id="kobo.289.1">Data Artifacts</span></strong><span class="koboSpan" id="kobo.290.1"> tab in the lower </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.291.1">Results</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.292.1"> pane:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer212">
<span class="koboSpan" id="kobo.293.1"><img alt="Figure 11.19 – Web history metadata " src="image/B18571_11_019.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.294.1">Figure 11.19 – Web history metadata</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.295.1">Another </span><a id="_idIndexMarker967"/><span class="koboSpan" id="kobo.296.1">source</span><a id="_idIndexMarker968"/><span class="koboSpan" id="kobo.297.1"> of data that is useful in investigations is </span><strong class="bold"><span class="koboSpan" id="kobo.298.1">Web Downloads</span></strong><span class="koboSpan" id="kobo.299.1"> in the </span><strong class="bold"><span class="koboSpan" id="kobo.300.1">Data Artifacts</span></strong><span class="koboSpan" id="kobo.301.1"> section. </span><span class="koboSpan" id="kobo.301.2">A common technique used by threat actors is to direct users or scripts to download secondary exploits or malware. </span><span class="koboSpan" id="kobo.301.3">This can include hacking tools and other scripts, often using the system’s capability to download from websites. </span><span class="koboSpan" id="kobo.301.4">In this case, if we click on </span><strong class="bold"><span class="koboSpan" id="kobo.302.1">Web Downloads</span></strong><span class="koboSpan" id="kobo.303.1">, we can see the path to the downloaded file, along with the URL the file was </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">downloaded from:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer213">
<span class="koboSpan" id="kobo.305.1"><img alt="Figure 11.20 – Web Downloads " src="image/B18571_11_020.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.306.1">Figure 11.20 – Web Downloads</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.307.1">In addition, Autopsy provides the metadata of the specific downloaded file under</span><a id="_idIndexMarker969"/><span class="koboSpan" id="kobo.308.1"> examination. </span><span class="koboSpan" id="kobo.308.2">Clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.309.1">File Metadata</span></strong><span class="koboSpan" id="kobo.310.1"> tab</span><a id="_idIndexMarker970"/><span class="koboSpan" id="kobo.311.1"> produces the </span><span class="No-Break"><span class="koboSpan" id="kobo.312.1">following data:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer214">
<span class="koboSpan" id="kobo.313.1"><img alt="Figure 11.21 – Web download metadata " src="image/B18571_11_021.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.314.1">Figure 11.21 – Web download metadata</span></p>
<p><span class="koboSpan" id="kobo.315.1">As the preceding screenshot shows, there are some more details concerning the downloaded file. </span><span class="koboSpan" id="kobo.315.2">For example, the analyst can gather time information, file location, and an MD5 hash, which can be utilized to compare any extracted files that are examined further. </span><span class="koboSpan" id="kobo.315.3">In some circumstances, a suspect may decide to delete the browsing history from the system to hide any malicious activity. </span><span class="koboSpan" id="kobo.315.4">Another location that may provide evidence of sites that have been accessed by a malicious insider is web cookies. </span><span class="koboSpan" id="kobo.315.5">These can be accessed in the left-hand pane under </span><strong class="bold"><span class="koboSpan" id="kobo.316.1">Web Cookies</span></strong><span class="koboSpan" id="kobo.317.1">. </span><span class="koboSpan" id="kobo.317.2">Clicking on this produces a list of the cookies that are still on </span><span class="No-Break"><span class="koboSpan" id="kobo.318.1">the system:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer215">
<span class="koboSpan" id="kobo.319.1"><img alt="Figure 11.22 – Web Cookies " src="image/B18571_11_022.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.320.1">Figure 11.22 – Web Cookies</span></p>
<p><span class="koboSpan" id="kobo.321.1">Depending on the type of incident, web artifacts can play an important role. </span><span class="koboSpan" id="kobo.321.2">Autopsy has some functionality for this, but responders may find that other commercial solutions provide a much more robust platform. </span><span class="koboSpan" id="kobo.321.3">Evidence Finder by Magnet Forensics (</span><a href="http://www.magnetforensics.com"><span class="koboSpan" id="kobo.322.1">www.magnetforensics.com</span></a><span class="koboSpan" id="kobo.323.1">) scours</span><a id="_idIndexMarker971"/><span class="koboSpan" id="kobo.324.1"> the entire system for internet artifacts and then presents them in a way that is easy for the analyst to view. </span><span class="koboSpan" id="kobo.324.2">Another key advantage of commercial </span><a id="_idIndexMarker972"/><span class="koboSpan" id="kobo.325.1">solutions such as this is that their functionality is </span><a id="_idIndexMarker973"/><span class="koboSpan" id="kobo.326.1">updated continuously. </span><span class="koboSpan" id="kobo.326.2">Depending on the frequency of internet and web artifact searching, the inclusion of tools such as this may </span><span class="No-Break"><span class="koboSpan" id="kobo.327.1">be beneficial.</span></span></p>
<h3><span class="koboSpan" id="kobo.328.1">Email</span></h3>
<p><span class="koboSpan" id="kobo.329.1">Locating suspect</span><a id="_idIndexMarker974"/><span class="koboSpan" id="kobo.330.1"> emails continues to be a task that incident responders often engage in. </span><span class="koboSpan" id="kobo.330.2">This can include externally caused incidents such as social engineering, where responders may be tasked with locating a suspect email that had malware attached to it. </span><span class="koboSpan" id="kobo.330.3">In other circumstances, malicious insiders may have sent or received communication that was inappropriate or violated company policy. </span><span class="koboSpan" id="kobo.330.4">In those cases, responders may be tasked with recovering those emails so that they can be included in termination proceedings or </span><span class="No-Break"><span class="koboSpan" id="kobo.331.1">legal action.</span></span></p>
<p><span class="koboSpan" id="kobo.332.1">Autopsy can locate emails contained in the system. </span><span class="koboSpan" id="kobo.332.2">From these emails, they may be able to identify one or more suspicious emails and domains that can be further researched to see if they are associated with social engineering or other malicious activity. </span><span class="koboSpan" id="kobo.332.3">Simply click on </span><strong class="bold"><span class="koboSpan" id="kobo.333.1">Keyword Hits</span></strong><span class="koboSpan" id="kobo.334.1"> and then the </span><strong class="bold"><span class="koboSpan" id="kobo.335.1">Email Addresses</span></strong><span class="koboSpan" id="kobo.336.1"> tab in the left-hand pane. </span><span class="koboSpan" id="kobo.336.2">From there, the analyst </span><a id="_idIndexMarker975"/><span class="koboSpan" id="kobo.337.1">can </span><a id="_idIndexMarker976"/><span class="koboSpan" id="kobo.338.1">see the email addresses that are located on </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">the system:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer216">
<span class="koboSpan" id="kobo.340.1"><img alt="Figure 11.23 – Email addresses " src="image/B18571_11_023.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.341.1">Figure 11.23 – Email addresses</span></p>
<p><span class="koboSpan" id="kobo.342.1">Next, let’s look at </span><span class="No-Break"><span class="koboSpan" id="kobo.343.1">attached devices.</span></span></p>
<h3><span class="koboSpan" id="kobo.344.1">Attached devices</span></h3>
<p><span class="koboSpan" id="kobo.345.1">Another key </span><a id="_idIndexMarker977"/><span class="koboSpan" id="kobo.346.1">piece of evidence that may be useful to an analyst is data about when specific devices were attached to the system. </span><span class="koboSpan" id="kobo.346.2">In the scenario of a malicious insider attempting to steal confidential documents, knowing whether they utilized a USB device would be helpful. </span><span class="koboSpan" id="kobo.346.3">Autopsy utilizes the registry settings located on the system to identify the types of devices attached and the last time that they were used. </span><span class="koboSpan" id="kobo.346.4">In this case, the output of clicking </span><strong class="bold"><span class="koboSpan" id="kobo.347.1">Devices Attached</span></strong><span class="koboSpan" id="kobo.348.1"> in the left-hand pane produces the </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">following results:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer217">
<span class="koboSpan" id="kobo.350.1"><img alt="Figure 11.24 – USB devices " src="image/B18571_11_024.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.351.1">Figure 11.24 – USB devices</span></p>
<p><span class="koboSpan" id="kobo.352.1">Drilling down into the </span><strong class="bold"><span class="koboSpan" id="kobo.353.1">Data Artifacts</span></strong><span class="koboSpan" id="kobo.354.1"> tab, the analyst can identify the type of device and the date and time that the USB device </span><span class="No-Break"><span class="koboSpan" id="kobo.355.1">was attached:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer218">
<span class="koboSpan" id="kobo.356.1"><img alt="Figure 11.25 – USB device artifacts " src="image/B18571_11_025.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.357.1">Figure 11.25 – USB device artifacts</span></p>
<p><span class="koboSpan" id="kobo.358.1">Finally, a more detailed examination of the </span><strong class="bold"><span class="koboSpan" id="kobo.359.1">Source File Metadata</span></strong><span class="koboSpan" id="kobo.360.1"> area would show additional data that can be utilized to reconstruct the time that the USB device was accessed on </span><a id="_idIndexMarker978"/><span class="No-Break"><span class="koboSpan" id="kobo.361.1">the system:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer219">
<span class="koboSpan" id="kobo.362.1"><img alt="Figure 11.26 – Device entry metadata " src="image/B18571_11_026.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.363.1">Figure 11.26 – Device entry metadata</span></p>
<p><span class="koboSpan" id="kobo.364.1">Next, let’s look at </span><span class="No-Break"><span class="koboSpan" id="kobo.365.1">deleted files.</span></span></p>
<h3><span class="koboSpan" id="kobo.366.1">Deleted files</span></h3>
<p><span class="koboSpan" id="kobo.367.1">Files that have </span><a id="_idIndexMarker979"/><span class="koboSpan" id="kobo.368.1">been deleted can also be reconstructed, either partially or completely. </span><span class="koboSpan" id="kobo.368.2">The Windows operating system will not delete files when the user selects deletion. </span><span class="koboSpan" id="kobo.368.3">The operating system will mark the space a deleted file takes</span><a id="_idIndexMarker980"/><span class="koboSpan" id="kobo.369.1"> up in the </span><strong class="bold"><span class="koboSpan" id="kobo.370.1">Master File Table</span></strong><span class="koboSpan" id="kobo.371.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.372.1">MTF</span></strong><span class="koboSpan" id="kobo.373.1">) as available to write new files to. </span><span class="koboSpan" id="kobo.373.2">As a result, responders may be able to view deleted files that have not </span><span class="No-Break"><span class="koboSpan" id="kobo.374.1">been overwritten.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.375.1">Solid-state drives</span></p>
<p class="callout"><span class="koboSpan" id="kobo.376.1">As discussed in </span><a href="B18571_08.xhtml#_idTextAnchor136"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.377.1">Chapter 8</span></em></span></a><span class="koboSpan" id="kobo.378.1">, keep in mind the challenge that forensic analysts have when examining </span><strong class="bold"><span class="koboSpan" id="kobo.379.1">solid-state drives</span></strong><span class="koboSpan" id="kobo.380.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.381.1">SSDs</span></strong><span class="koboSpan" id="kobo.382.1">). </span><span class="koboSpan" id="kobo.382.2">Deleted files can often be recovered from traditional </span><a id="_idIndexMarker981"/><span class="koboSpan" id="kobo.383.1">platter hard drives, even after a system is powered down. </span><span class="koboSpan" id="kobo.383.2">With SSDs, the operating system will often remove deleted files to make storing files more efficient. </span><span class="koboSpan" id="kobo.383.3">The following website has an excellent breakdown of this if you want to find out more: </span><a href="https://www.datanarro.com/the-impact-of-ssds-on-digital-"><span class="No-Break"><span class="koboSpan" id="kobo.384.1">https://www.datanarro.com/the-impact-of-ssds-on-digital-</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.385.1"> forensics/</span></span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.387.1">To view the </span><a id="_idIndexMarker982"/><span class="koboSpan" id="kobo.388.1">deleted files on a system, click on </span><strong class="bold"><span class="koboSpan" id="kobo.389.1">Deleted Files</span></strong><span class="koboSpan" id="kobo.390.1"> in the left-hand pane. </span><span class="koboSpan" id="kobo.390.2">From here, the analyst can see all of the files that have been marked </span><span class="No-Break"><span class="koboSpan" id="kobo.391.1">for deletion:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer220">
<span class="koboSpan" id="kobo.392.1"><img alt="Figure 11.27 – Deleted files " src="image/B18571_11_027.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.393.1">Figure 11.27 – Deleted files</span></p>
<p><span class="koboSpan" id="kobo.394.1">From here, the analyst can search through deleted files. </span><span class="koboSpan" id="kobo.394.2">These files may hold evidentiary value. </span><span class="koboSpan" id="kobo.394.3">For example, in the case of malicious insider activity, if several sensitive files are found in the deleted files, all of which have been deleted within the same time, it may be indicative of the insider attempting to cover their tracks by deleting </span><span class="No-Break"><span class="koboSpan" id="kobo.395.1">suspicious files.</span></span></p>
<h3><span class="koboSpan" id="kobo.396.1">Keyword searching</span></h3>
<p><span class="koboSpan" id="kobo.397.1">One key advantage </span><a id="_idIndexMarker983"/><span class="koboSpan" id="kobo.398.1">that forensic applications have is the ability to perform keyword searches. </span><span class="koboSpan" id="kobo.398.2">This is especially advantageous as disk drives have gotten larger and responders would have to parse through an overwhelming quantity of data. </span><span class="koboSpan" id="kobo.398.3">Keywords are often derived from other elements of the investigation or by using external sources. </span><span class="koboSpan" id="kobo.398.4">For example, if an analyst is investigating a malware incident, they may use a suspicious DLL or executable name from the analysis of the memory image. </span><span class="koboSpan" id="kobo.398.5">In other instances, such as a malicious insider being suspected of accessing confidential information, keywords in those documents, either secret or confidential, can be used to see if the suspect used the system to access </span><span class="No-Break"><span class="koboSpan" id="kobo.399.1">those files.</span></span></p>
<p><span class="koboSpan" id="kobo.400.1">Autopsy can perform keyword searches while utilizing an exact or a substring match. </span><span class="koboSpan" id="kobo.400.2">For example, let’s say an analyst has been tasked with determining what evidence can be located concerning the ZeroTier One executable, which had been located in the </span><strong class="bold"><span class="koboSpan" id="kobo.401.1">Web Downloads</span></strong><span class="koboSpan" id="kobo.402.1"> entries. </span><span class="koboSpan" id="kobo.402.2">The analyst is tasked with locating any trace evidence that would indicate that the file was executed and if possible, identify </span><span class="No-Break"><span class="koboSpan" id="kobo.403.1">the user.</span></span></p>
<p><span class="koboSpan" id="kobo.404.1">The analyst would navigate to the top-right corner and input </span><strong class="source-inline"><span class="koboSpan" id="kobo.405.1">ZeroTier One</span></strong><span class="koboSpan" id="kobo.406.1"> in the field. </span><span class="koboSpan" id="kobo.406.2">In this case, an exact match will be utilized. </span><span class="koboSpan" id="kobo.406.3">Once selected, they would click the </span><strong class="bold"><span class="koboSpan" id="kobo.407.1">Search</span></strong><span class="koboSpan" id="kobo.408.1"> button. </span><span class="koboSpan" id="kobo.408.2">The left-hand pane will indicate whether there were any hits on that text. </span><span class="koboSpan" id="kobo.408.3">In this case, the pricing decision has </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">82 hits:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer221">
<span class="koboSpan" id="kobo.410.1"><img alt="Figure 11.28 – Keyword search hits " src="image/B18571_11_028.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.411.1">Figure 11.28 – Keyword search hits</span></p>
<p><span class="koboSpan" id="kobo.412.1">As shown in the preceding screenshot, the center pane will contain a list of the files that contained the hits. </span><span class="koboSpan" id="kobo.412.2">One file that stands out is the </span><strong class="bold"><span class="koboSpan" id="kobo.413.1">Master File Table</span></strong><span class="koboSpan" id="kobo.414.1"> entry. </span><span class="koboSpan" id="kobo.414.2">This entry shows the dates and times the file was first placed on the system, along with any modifications </span><span class="No-Break"><span class="koboSpan" id="kobo.415.1">and changes:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer222">
<span class="koboSpan" id="kobo.416.1"><img alt="Figure 11.29 – Master File Table entry " src="image/B18571_11_029.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.417.1">Figure 11.29 – Master File Table entry</span></p>
<p><span class="koboSpan" id="kobo.418.1">Further review shows a Windows PowerShell event log entry, which shows that the application was executed by the user account Patrick based on the file path: </span></p>
<div>
<div class="IMG---Figure" id="_idContainer223">
<span class="koboSpan" id="kobo.419.1"><img alt="Figure 11.30 – Keyword search results " src="image/B18571_11_030.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.420.1">Figure 11.30 – Keyword search results</span></p>
<p><span class="koboSpan" id="kobo.421.1">Digging further </span><a id="_idIndexMarker984"/><span class="koboSpan" id="kobo.422.1">into the hits, there is an entry within the Windows PowerShell Operational event logs indicating that the executable was associated with a network connection established via a </span><span class="No-Break"><span class="koboSpan" id="kobo.423.1">PowerShell script:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer224">
<span class="koboSpan" id="kobo.424.1"><img alt="Figure 11.31 – Keyword PowerShell script " src="image/B18571_11_031.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.425.1">Figure 11.31 – Keyword PowerShell script</span></p>
<p><span class="koboSpan" id="kobo.426.1">Further down within the entry is a Base64-encoded PowerShell </span><span class="No-Break"><span class="koboSpan" id="kobo.427.1">script entry:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer225">
<span class="koboSpan" id="kobo.428.1"><img alt="Figure 11.32 – Base64 PowerShell script " src="image/B18571_11_032.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.429.1">Figure 11.32 – Base64 PowerShell script</span></p>
<p><span class="koboSpan" id="kobo.430.1">Taken together, this may point to some suspicious activity. </span><span class="koboSpan" id="kobo.430.2">For example, ZeroTier One is a commercial VPN solution, so it is not out of the ordinary for it to be establishing a connection. </span><span class="koboSpan" id="kobo.430.3">What is suspicious is the Base64-encoded PowerShell script, which is often used by adversaries to download additional malware or perform malicious actions. </span><span class="koboSpan" id="kobo.430.4">We will look at </span><a id="_idIndexMarker985"/><span class="koboSpan" id="kobo.431.1">some of these scripts later in </span><a href="B18571_16.xhtml#_idTextAnchor284"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.432.1">Chapter 16</span></em></span></a><span class="No-Break"><span class="koboSpan" id="kobo.433.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.434.1">Next, we will look at how Autopsy can build a timeline of the </span><span class="No-Break"><span class="koboSpan" id="kobo.435.1">system’s activity.</span></span></p>
<h3><span class="koboSpan" id="kobo.436.1">Timeline analysis</span></h3>
<p><span class="koboSpan" id="kobo.437.1">When investigating</span><a id="_idIndexMarker986"/><span class="koboSpan" id="kobo.438.1"> an incident, it is critical to have an idea of when applications or files were executed. </span><span class="koboSpan" id="kobo.438.2">Timestamps can sometimes be found in other aspects of the investigation, such as when examining memory images. </span><span class="koboSpan" id="kobo.438.3">Also, identifying specific DLL files or executable files in the memory image can be compared to the date and time they were accessed to correlate other activity that’s been observed on </span><span class="No-Break"><span class="koboSpan" id="kobo.439.1">the system.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.440.1">Time normalization</span></p>
<p class="callout"><span class="koboSpan" id="kobo.441.1">One aspect of digital forensics that bears repeating is to ensure that all the systems are using the same time zone. </span><span class="koboSpan" id="kobo.441.2">With network systems, this is usually accomplished with the </span><strong class="bold"><span class="koboSpan" id="kobo.442.1">Network Time Protocol</span></strong><span class="koboSpan" id="kobo.443.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.444.1">NTP</span></strong><span class="koboSpan" id="kobo.445.1">). </span><span class="koboSpan" id="kobo.445.2">There</span><a id="_idIndexMarker987"/><span class="koboSpan" id="kobo.446.1"> are times when systems do not have normalized time through NTP. </span><span class="koboSpan" id="kobo.446.2">Responders should take great care in understanding what time zone and synchronization should be used. </span><span class="koboSpan" id="kobo.446.3">The best practice regarding time is to set all the systems to UTC. </span><span class="koboSpan" id="kobo.446.4">This is critical if an organization is </span><span class="No-Break"><span class="koboSpan" id="kobo.447.1">geographically diverse.</span></span></p>
<p><span class="koboSpan" id="kobo.448.1">Autopsy has functionality specifically for timeline analysis. </span><span class="koboSpan" id="kobo.448.2">Simply clicking on the </span><strong class="bold"><span class="koboSpan" id="kobo.449.1">Timeline</span></strong><span class="koboSpan" id="kobo.450.1"> button at the top of the window will make Autopsy begin the process of parsing out timeline data. </span><span class="koboSpan" id="kobo.450.2">Depending on the size of the image file being analyzed, it may take a few minutes. </span><span class="koboSpan" id="kobo.450.3">Once completed, the following window </span><span class="No-Break"><span class="koboSpan" id="kobo.451.1">will open:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer226">
<span class="koboSpan" id="kobo.452.1"><img alt="Figure 11.33 – Timeline viewer " src="image/B18571_11_033.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.453.1">Figure 11.33 – Timeline viewer</span></p>
<p><span class="koboSpan" id="kobo.454.1">From here, the</span><a id="_idIndexMarker988"/><span class="koboSpan" id="kobo.455.1"> analyst can utilize several features. </span><span class="koboSpan" id="kobo.455.2">First is the text filter on the left-hand side of the screen. </span><span class="koboSpan" id="kobo.455.3">Using this, the analyst can search for specific text in files. </span><span class="koboSpan" id="kobo.455.4">For example, the analyst has already identified that the executable named </span><strong class="bold"><span class="koboSpan" id="kobo.456.1">ZeroTier One</span></strong><span class="koboSpan" id="kobo.457.1"> had been executed on the system under investigation. </span><span class="koboSpan" id="kobo.457.2">If the analyst would like to know whether that file was accessed at any other times, they could enter pricing into the </span><strong class="bold"><span class="koboSpan" id="kobo.458.1">Text Filter</span></strong><span class="koboSpan" id="kobo.459.1"> box and click </span><strong class="bold"><span class="koboSpan" id="kobo.460.1">Apply</span></strong><span class="koboSpan" id="kobo.461.1">, which would produce the </span><span class="No-Break"><span class="koboSpan" id="kobo.462.1">following results:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer227">
<span class="koboSpan" id="kobo.463.1"><img alt="Figure 11.34 – Keyword timeline " src="image/B18571_11_034.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.464.1">Figure 11.34 – Keyword timeline</span></p>
<p><span class="koboSpan" id="kobo.465.1">From this graph, the analyst can further drill down into the specific times the file was accessed by clicking on the colored bars. </span><span class="koboSpan" id="kobo.465.2">The responders can now see that the executable </span><a id="_idIndexMarker989"/><span class="koboSpan" id="kobo.466.1">was o</span><a id="_idTextAnchor197"/><span class="koboSpan" id="kobo.467.1">nly accessed at one particular date and time from </span><span class="No-Break"><span class="koboSpan" id="kobo.468.1">this system.</span></span></p>
<p><span class="koboSpan" id="kobo.469.1">Next, we will look at extracting specific evidence items from a disk image and processing them with </span><span class="No-Break"><span class="koboSpan" id="kobo.470.1">additional tools.</span></span></p>
<h1 id="_idParaDest-193"><a id="_idTextAnchor198"/><span class="koboSpan" id="kobo.471.1">Master File Table analysis</span></h1>
<p><span class="koboSpan" id="kobo.472.1">Another</span><a id="_idIndexMarker990"/><span class="koboSpan" id="kobo.473.1"> technique that can be leveraged for timeline analysis is utilizing external tools to analyze the MFT. </span><span class="koboSpan" id="kobo.473.2">Autopsy allows the analyst to export the MFT for analysis using third-party tools. </span><span class="koboSpan" id="kobo.473.3">In this case, we will use MFT Explorer, one of several tools developed by </span><span class="No-Break"><span class="koboSpan" id="kobo.474.1">Eric Zimmerman.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.475.1">Eric Zimmerman's tools</span></p>
<p class="callout"><span class="koboSpan" id="kobo.476.1">Eric Zimmerman is a former FBI agent, SANS course developer, and digital forensics expert. </span><span class="koboSpan" id="kobo.476.2">He has created a suite of tools for carving and analyzing data available at </span><a href="https://ericzimmerman.github.io/#!index.md"><span class="koboSpan" id="kobo.477.1">https://ericzimmerman.github.io/#!index.md</span></a><span class="koboSpan" id="kobo.478.1">. </span><span class="koboSpan" id="kobo.478.2">Additionally, the SANS Institute has created a cheat sheet for the tools available </span><span class="No-Break"><span class="koboSpan" id="kobo.479.1">at </span></span><a href="https://www.sans.org/posters/eric-zimmerman-tools-cheat-sheet/"><span class="No-Break"><span class="koboSpan" id="kobo.480.1">https://www.sans.org/posters/eric-zimmerman-tools-cheat-sheet/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.481.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.482.1">In this instance, we will look at processing the MFT from the image that was examined with Autopsy. </span><span class="koboSpan" id="kobo.482.2">The MFT can be found within the root directory of the filesystem. </span><span class="koboSpan" id="kobo.482.3">Find the </span><strong class="source-inline"><span class="koboSpan" id="kobo.483.1">$MFT</span></strong><span class="koboSpan" id="kobo.484.1"> file, right-click it, select </span><strong class="bold"><span class="koboSpan" id="kobo.485.1">Extract Files</span></strong><span class="koboSpan" id="kobo.486.1">, and then save the file to an evidence drive. </span><span class="koboSpan" id="kobo.486.2">As good practice, change the name to something that reflects </span><span class="No-Break"><span class="koboSpan" id="kobo.487.1">the case.</span></span></p>
<p><span class="koboSpan" id="kobo.488.1">Next, find the </span><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">MFTECmd.exe</span></strong><span class="koboSpan" id="kobo.490.1"> executable. </span><span class="koboSpan" id="kobo.490.2">The following command processes the MFT and outputs the</span><a id="_idIndexMarker991"/><span class="koboSpan" id="kobo.491.1"> results to a </span><strong class="bold"><span class="koboSpan" id="kobo.492.1">Comma-Separated Value</span></strong><span class="koboSpan" id="kobo.493.1"> (</span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.494.1">CSV</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.495.1">) file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.496.1">
C:\Users\forensics\Documents\ZimmmermanTools&gt;MFTECmd.exe -f "D:\Suspect_$MFT" --csv "D:" --csvf SuspectMFT.csv</span></pre>
<p><span class="koboSpan" id="kobo.497.1">The CSV file can now be opened and examined. </span><span class="koboSpan" id="kobo.497.2">In this case, the CSV has been opened via Microsoft </span><a id="_idIndexMarker992"/><span class="koboSpan" id="kobo.498.1">Excel. </span><span class="koboSpan" id="kobo.498.2">This allows for keyword searching and examination of times and dates to identify when a file or files were placed on the system. </span><span class="koboSpan" id="kobo.498.3">Going back to the previous keyword search, we can use the filter option within Excel. </span><span class="koboSpan" id="kobo.498.4">Under the </span><strong class="bold"><span class="koboSpan" id="kobo.499.1">ParentPath</span></strong><span class="koboSpan" id="kobo.500.1"> column, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.501.1">ZeroTier</span></strong><span class="koboSpan" id="kobo.502.1"> keyword has </span><span class="No-Break"><span class="koboSpan" id="kobo.503.1">been entered:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer228">
<span class="koboSpan" id="kobo.504.1"><img alt="Figure 11.35 – ZeroTier filter MFT results " src="image/B18571_11_035.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.505.1">Figure 11.35 – ZeroTier filter MFT results</span></p>
<p><span class="koboSpan" id="kobo.506.1">The MFT can be difficult to work with in terms of the amount of data. </span><span class="koboSpan" id="kobo.506.2">In this case, the MFT has over 410,000 separate entries that may need to be sorted through. </span><span class="koboSpan" id="kobo.506.3">It is a good idea to have a starting point such as a date and time or a filename to search for. </span><span class="koboSpan" id="kobo.506.4">This allows analysts to work with only those results that are pertinent. </span><span class="koboSpan" id="kobo.506.5">Other tools, such as Eric Zimmerman’s Timeline Explorer, can be used to process and extract those data points that </span><a id="_idIndexMarker993"/><span class="koboSpan" id="kobo.507.1">are important to </span><span class="No-Break"><span class="koboSpan" id="kobo.508.1">the investigation.</span></span></p>
<p><span class="koboSpan" id="kobo.509.1">Now that we have looked for the presence of the file on the system, we can look at evidence </span><span class="No-Break"><span class="koboSpan" id="kobo.510.1">of execution.</span></span></p>
<h1 id="_idParaDest-194"><a id="_idTextAnchor199"/><span class="koboSpan" id="kobo.511.1">Prefetch analysis</span></h1>
<p><span class="koboSpan" id="kobo.512.1">One question </span><a id="_idIndexMarker994"/><span class="koboSpan" id="kobo.513.1">that analysts will often have to answer is determining if an executable has run. </span><span class="koboSpan" id="kobo.513.2">One of the best sources of data to answer this question is Prefetch files. </span><span class="koboSpan" id="kobo.513.3">When an application or other executable is run, a file is created and stored within the </span><strong class="source-inline"><span class="koboSpan" id="kobo.514.1">C:\Windows\Prefetch</span></strong><span class="koboSpan" id="kobo.515.1"> directory. </span><span class="koboSpan" id="kobo.515.2">If the program is run in multiple locations, an entry is created for each of these. </span><span class="koboSpan" id="kobo.515.3">Another key aspect of Prefetch files is that they are not deleted when the application or program has been deleted. </span><span class="koboSpan" id="kobo.515.4">So, if an adversary is attempting to clean up the system of malicious executables or DLL files, proof of their execution may still be located in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">Prefetch</span></strong><span class="koboSpan" id="kobo.517.1"> directory. </span></p>
<p><span class="koboSpan" id="kobo.518.1">The Prefetch files do have some quirks that should be understood. </span><span class="koboSpan" id="kobo.518.2">First, even unsuccessful program execution can still produce a Prefetch file. </span><span class="koboSpan" id="kobo.518.3">It should be noted that the operative word is </span><strong class="bold"><span class="koboSpan" id="kobo.519.1">can</span></strong><span class="koboSpan" id="kobo.520.1">, meaning that not every unsuccessful execution creates a file. </span><span class="koboSpan" id="kobo.520.2">Second, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.521.1">Prefetch</span></strong><span class="koboSpan" id="kobo.522.1"> directory is specifically limited to 1,024 separate files. </span><span class="koboSpan" id="kobo.522.2">Older files are overwritten in favor of new files. </span><span class="koboSpan" id="kobo.522.3">On most end user systems, this generally does not present an issue if analysts can capture the evidence promptly. </span><span class="koboSpan" id="kobo.522.4">Third, a program that has been previously executed can still create a new Prefetch file. </span><span class="koboSpan" id="kobo.522.5">Finally, there is a time lag with Prefetch files. </span><span class="koboSpan" id="kobo.522.6">In general, the creation of the file itself might be 10 seconds off other time stamps an analyst may find. </span></p>
<p><span class="koboSpan" id="kobo.523.1">Acquiring the </span><strong class="source-inline"><span class="koboSpan" id="kobo.524.1">Prefetch</span></strong><span class="koboSpan" id="kobo.525.1"> directory is straightforward. </span><span class="koboSpan" id="kobo.525.2">Triage tools, like those that were discussed in </span><a href="B18571_06.xhtml#_idTextAnchor105"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.526.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.527.1">, can collect the directory. </span><span class="koboSpan" id="kobo.527.2">The directory can also be extracted directly through Autopsy. </span><span class="koboSpan" id="kobo.527.3">Simply navigate to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.528.1">Prefetch</span></strong><span class="koboSpan" id="kobo.529.1"> directory and right-click and select </span><strong class="bold"><span class="koboSpan" id="kobo.530.1">Extract Files</span></strong><span class="koboSpan" id="kobo.531.1">. </span><span class="koboSpan" id="kobo.531.2">Select the directory to output the files to. </span><span class="koboSpan" id="kobo.531.3">It is good practice to place the output in an evidence drive or use Autopsy’s default export directory. </span><span class="koboSpan" id="kobo.531.4">Once extracted, the </span><a id="_idIndexMarker995"/><span class="koboSpan" id="kobo.532.1">Prefetch entries will look </span><span class="No-Break"><span class="koboSpan" id="kobo.533.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer229">
<span class="koboSpan" id="kobo.534.1"><img alt="Figure 11.36 – Prefetch file entries " src="image/B18571_11_036.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.535.1">Figure 11.36 – Prefetch file entries</span></p>
<p><span class="koboSpan" id="kobo.536.1">This output directory can then be processed with the Prefetch parser with the </span><span class="No-Break"><span class="koboSpan" id="kobo.537.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.538.1">
C:\Users\forensics\Documents\ZimmmermanTools&gt;PECmd.exe -d D:\Suspect_Prefetch -q --csv D:\ --csvf suspect_prefetch.csv</span></pre>
<p><span class="koboSpan" id="kobo.539.1">The previous command outputs two files. </span><span class="koboSpan" id="kobo.539.2">The first is a CSV that contains the Prefetch entries. </span><span class="koboSpan" id="kobo.539.3">The second contains a timeline breakdown. </span><span class="koboSpan" id="kobo.539.4">Let’s look at the timeline version. </span><span class="koboSpan" id="kobo.539.5">The CSV file’s output allows for the same type of searching and filtering that was used in the previous section, </span><em class="italic"><span class="koboSpan" id="kobo.540.1">Master File Table analysis</span></em><span class="koboSpan" id="kobo.541.1">. </span><span class="koboSpan" id="kobo.541.2">In this case, again, we will use </span><strong class="source-inline"><span class="koboSpan" id="kobo.542.1">ZeroTier</span></strong><span class="koboSpan" id="kobo.543.1"> for filtering. </span><span class="koboSpan" id="kobo.543.2">In</span><a id="_idIndexMarker996"/><span class="koboSpan" id="kobo.544.1"> this case, the search reveals several entries showing the execution of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.545.1">ZEROTIER_DESKTOP_UI.EXE</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.546.1"> executable:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer230">
<span class="koboSpan" id="kobo.547.1"><img alt="Figure 11.37 – ZeroTier Prefetch entries " src="image/B18571_11_037.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.548.1">Figure 11.37 – ZeroTier Prefetch entries</span></p>
<h1 id="_idParaDest-195"><a id="_idTextAnchor200"/><span class="koboSpan" id="kobo.549.1">Registry analysis</span></h1>
<p><span class="koboSpan" id="kobo.550.1">There is a great </span><a id="_idIndexMarker997"/><span class="koboSpan" id="kobo.551.1">deal of activity that occurs under the hood of the Windows operating system. </span><span class="koboSpan" id="kobo.551.2">One place where this activity occurs and is documented is in the Windows Registry. </span><span class="koboSpan" id="kobo.551.3">The Windows Registry is a database that stores the low-level system settings for the Windows operating system. </span><span class="koboSpan" id="kobo.551.4">This includes settings for devices, security, services, and the storage </span><a id="_idIndexMarker998"/><span class="koboSpan" id="kobo.552.1">of user account security settings in the </span><strong class="bold"><span class="koboSpan" id="kobo.553.1">Security Accounts </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.554.1">Manager</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.555.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.556.1">SAM</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.557.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.558.1">The registry is made up of two elements. </span><span class="koboSpan" id="kobo.558.2">The first is the key. </span><span class="koboSpan" id="kobo.558.3">The key is a container that holds the second element – the values. </span><span class="koboSpan" id="kobo.558.4">These values hold specific settings information. </span><span class="koboSpan" id="kobo.558.5">The highest-level key is called the root key and the Windows operating system has five root keys, all of which are stored on the disk in the registry hives. </span><span class="koboSpan" id="kobo.558.6">These registry hives are located in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.559.1">%SystemRoot%\system32\config</span></strong><span class="koboSpan" id="kobo.560.1"> folder on the Windows </span><span class="No-Break"><span class="koboSpan" id="kobo.561.1">file structure:</span></span></p>
<ul>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.562.1">HKEY_CURRENT_USER</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.563.1">HKEY_USERS</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.564.1">HKEY_CLASSES_ROOT</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.565.1">HKEY_LOCAL_MACHINE</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.566.1">HKEY_CURRENT_CONFIG</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.567.1">Of the five root keys, the most valuable during an incident investigation is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.568.1">HKEY_LOCAL_MACHINE</span></strong><span class="koboSpan" id="kobo.569.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.570.1">HKLM</span></strong><span class="koboSpan" id="kobo.571.1"> key. </span><span class="koboSpan" id="kobo.571.2">This key contains the following subkeys (these are the ones that are the most interesting during </span><span class="No-Break"><span class="koboSpan" id="kobo.572.1">an investigation):</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.573.1">SAM</span></strong><span class="koboSpan" id="kobo.574.1">: This is the location where the Windows OS stores the user’s passwords in the LM or NTLM hash form. </span><span class="koboSpan" id="kobo.574.2">The main purpose of the SAM subkey is to maintain the Windows </span><span class="No-Break"><span class="koboSpan" id="kobo.575.1">account passwords.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.576.1">Security</span></strong><span class="koboSpan" id="kobo.577.1">: This subkey contains the security information of the domain that the system is </span><span class="No-Break"><span class="koboSpan" id="kobo.578.1">connected to.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.579.1">Software</span></strong><span class="koboSpan" id="kobo.580.1">: The software subkey is the repository for software and Windows settings. </span><span class="koboSpan" id="kobo.580.2">This subkey is often modified by software or system installers. </span><span class="koboSpan" id="kobo.580.3">This is a good location to check for additions or modifications that have been made to the software </span><span class="No-Break"><span class="koboSpan" id="kobo.581.1">by malware.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.582.1">System</span></strong><span class="koboSpan" id="kobo.583.1">: This subkey stores information about the Windows system configuration. </span><span class="koboSpan" id="kobo.583.2">One key piece of evidence that is also included within the system subkey is the currently mounted devices within </span><span class="No-Break"><span class="koboSpan" id="kobo.584.1">a filesystem.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.585.1">Another</span><a id="_idIndexMarker999"/><span class="koboSpan" id="kobo.586.1"> source of data that can be critical to an incident investigation is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.587.1">HKEY_CURRENT_USER</span></strong><span class="koboSpan" id="kobo.588.1"> key. </span><span class="koboSpan" id="kobo.588.2">Attackers may make changes to a user account or profile as part of a privilege escalation attack. </span><span class="koboSpan" id="kobo.588.3">Changes that have been made to the user’s data are recorded in that user’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.589.1">NTUSER.dat</span></strong><span class="koboSpan" id="kobo.590.1"> file. </span><span class="koboSpan" id="kobo.590.2">An </span><strong class="source-inline"><span class="koboSpan" id="kobo.591.1">NTUSER.dat</span></strong><span class="koboSpan" id="kobo.592.1"> file is created for every user account on the system and is located at </span><strong class="source-inline"><span class="koboSpan" id="kobo.593.1">C:\Users\*UserName*</span></strong><span class="koboSpan" id="kobo.594.1">. </span><span class="koboSpan" id="kobo.594.2">This file contains the user’s profile settings and may provide additional data on the systems that are connected, network connections, or other settings. </span><span class="koboSpan" id="kobo.594.3">Data contained within the </span><strong class="source-inline"><span class="koboSpan" id="kobo.595.1">HKEY_CURRENT_USER</span></strong><span class="koboSpan" id="kobo.596.1"> key may be of benefit in some incidents where user activity or user account modification of the system </span><span class="No-Break"><span class="koboSpan" id="kobo.597.1">is suspected.</span></span></p>
<p><span class="koboSpan" id="kobo.598.1">Responders can access the various registry hives using Autopsy. </span><span class="koboSpan" id="kobo.598.2">Simply navigate to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.599.1">Windows/System32/config</span></strong><span class="koboSpan" id="kobo.600.1"> folder from the file structure in the </span><span class="No-Break"><span class="koboSpan" id="kobo.601.1">left-hand pane:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer231">
<span class="koboSpan" id="kobo.602.1"><img alt="Figure 11.38 – Registry location " src="image/B18571_11_038.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.603.1">Figure 11.38 – Registry location</span></p>
<p><span class="koboSpan" id="kobo.604.1">The SAM </span><a id="_idIndexMarker1000"/><span class="koboSpan" id="kobo.605.1">registry file is located in the </span><span class="No-Break"><span class="koboSpan" id="kobo.606.1">center pane:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer232">
<span class="koboSpan" id="kobo.607.1"><img alt="Figure 11.39 – SAM location " src="image/B18571_11_039.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.608.1">Figure 11.39 – SAM location</span></p>
<p><span class="koboSpan" id="kobo.609.1">The actual examination and evidentiary value of registry key settings are, like many aspects of digital forensics, very detailed. </span><span class="koboSpan" id="kobo.609.2">While it is impossible to cover all of the aspects of registry forensics in this chapter, or even in this book, it is important for responders to be able to acquire the registry keys for evaluation, and also to have some familiarity with tools that can allow responders to gain some hands-on experience with evaluating </span><span class="No-Break"><span class="koboSpan" id="kobo.610.1">registry settings.</span></span></p>
<p><span class="koboSpan" id="kobo.611.1">In this case, the system, SAM, security, and software registry keys will be acquired for analysis. </span><span class="koboSpan" id="kobo.611.2">For this, the analyst can use Autopsy to acquire the proper keys and then examine them with a third-party tool. </span><span class="koboSpan" id="kobo.611.3">Let’s take a look at how to </span><span class="No-Break"><span class="koboSpan" id="kobo.612.1">do this:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.613.1">First, navigate to the proper folder, </span><strong class="source-inline"><span class="koboSpan" id="kobo.614.1">/System32/config</span></strong><span class="koboSpan" id="kobo.615.1">, on the applicable volume of the </span><span class="No-Break"><span class="koboSpan" id="kobo.616.1">system image.</span></span></li>
<li><span class="koboSpan" id="kobo.617.1">Next, select the four registry keys using the right mouse button and the </span><em class="italic"><span class="koboSpan" id="kobo.618.1">Ctrl</span></em><span class="koboSpan" id="kobo.619.1"> key. </span><span class="koboSpan" id="kobo.619.2">Right-click on one of the files and select </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.620.1">Export File(s)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.621.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.622.1">Select a folder to output the registry keys to. </span><span class="koboSpan" id="kobo.622.2">In this case, a separate file folder was created to contain the keys. </span><span class="No-Break"><span class="koboSpan" id="kobo.623.1">Select </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.624.1">Save</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.625.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.626.1">Verify </span><a id="_idIndexMarker1001"/><span class="koboSpan" id="kobo.627.1">that the registry keys have </span><span class="No-Break"><span class="koboSpan" id="kobo.628.1">been saved:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer233">
<span class="koboSpan" id="kobo.629.1"><img alt="Figure 11.40 – Suspect registry " src="image/B18571_11_040.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.630.1">Figure 11.40 – Suspect registry</span></p>
<p><span class="koboSpan" id="kobo.631.1">The Windows operating system records and maintains artifacts of when USB devices such as mass storage, iOS devices, digital cameras, and other USB devices are connected. </span><span class="koboSpan" id="kobo.631.2">This is due </span><a id="_idIndexMarker1002"/><span class="koboSpan" id="kobo.632.1">to the </span><strong class="bold"><span class="koboSpan" id="kobo.633.1">Plug and Play</span></strong><span class="koboSpan" id="kobo.634.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.635.1">PnP</span></strong><span class="koboSpan" id="kobo.636.1">) manager, which is part of the Windows operating system. </span><span class="koboSpan" id="kobo.636.2">The PnP receives a notification that a USB has been connected and queries the device for information so that it can load the proper device driver. </span><span class="koboSpan" id="kobo.636.3">Upon completion, the Windows operating system will make an entry for the device within the </span><span class="No-Break"><span class="koboSpan" id="kobo.637.1">registry settings.</span></span></p>
<p><span class="koboSpan" id="kobo.638.1">To determine what USB devices were connected, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.639.1">these steps:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.640.1">Open </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.641.1">Registry Explorer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.642.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.643.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.644.1">File</span></strong><span class="koboSpan" id="kobo.645.1"> and then </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.646.1">Load Hive</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.647.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.648.1">Navigate to the system registry hive. </span><span class="koboSpan" id="kobo.648.2">(Depending on the files, there may be errors related to Dirty Hives. </span><span class="koboSpan" id="kobo.648.3">It is normal to see this; they can be processed with </span><span class="No-Break"><span class="koboSpan" id="kobo.649.1">Registry Explorer.)</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.650.1">Once </span><a id="_idIndexMarker1003"/><span class="koboSpan" id="kobo.651.1">loaded, the following window </span><span class="No-Break"><span class="koboSpan" id="kobo.652.1">will appear:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer234">
<span class="koboSpan" id="kobo.653.1"><img alt="" src="image/B18571_11_041.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.654.1">Figure 11.41 – Registry Explorer view</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.655.1">From here, navigate to the proper USB registry location </span><span class="No-Break"><span class="koboSpan" id="kobo.656.1">at </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.657.1">ROOT\ControlSet001\Enum\USB\</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.658.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer235">
<span class="koboSpan" id="kobo.659.1"><img alt="" src="image/B18571_11_042.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.660.1">Figure 11.42 – USB registry key location</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.661.1">Click on the first </span><a id="_idIndexMarker1004"/><span class="koboSpan" id="kobo.662.1">registry value, </span><strong class="source-inline"><span class="koboSpan" id="kobo.663.1">VID_05C8&amp;PID_0815&amp;MI_00</span></strong><span class="koboSpan" id="kobo.664.1">, and then </span><strong class="source-inline"><span class="koboSpan" id="kobo.665.1">6&amp;a631fef&amp;0&amp;000</span></strong><span class="koboSpan" id="kobo.666.1">. </span><span class="koboSpan" id="kobo.666.2">The following information will appear in the </span><span class="No-Break"><span class="koboSpan" id="kobo.667.1">top-right pane:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer236">
<span class="koboSpan" id="kobo.668.1"><img alt="" src="image/B18571_11_043.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.669.1">Figure 11.43 – Registry values</span></p>
<p><span class="koboSpan" id="kobo.670.1">From here, the analyst has a lot of information they need to review. </span><span class="koboSpan" id="kobo.670.2">Of particular importance is the hardware ID. </span><span class="koboSpan" id="kobo.670.3">Clicking on that section of the output produces the following in the </span><span class="No-Break"><span class="koboSpan" id="kobo.671.1">lower-right window:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer237">
<span class="koboSpan" id="kobo.672.1"><img alt="" src="image/B18571_11_044.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.673.1">Figure 11.44 – HardwareID data</span></p>
<p><span class="koboSpan" id="kobo.674.1">As we mentioned previously, registry analysis is a deep subset of digital forensics in and of itself. </span><span class="koboSpan" id="kobo.674.2">Whole volumes have been written on the evidentiary value present in the settings and entries in registry hives. </span><span class="koboSpan" id="kobo.674.3">At a minimum, responders should be prepared to acquire this evidence for others for further examination. </span><span class="koboSpan" id="kobo.674.4">That being said, as responders gain more and </span><a id="_idIndexMarker1005"/><span class="koboSpan" id="kobo.675.1">more experience and skill, the registry should be an area that can be leveraged for evidence when examining a </span><span class="No-Break"><span class="koboSpan" id="kobo.676.1">disk image.</span></span></p>
<h1 id="_idParaDest-196"><a id="_idTextAnchor201"/><span class="koboSpan" id="kobo.677.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.678.1">In many ways, this chapter just scratches the surface of what information can be found by leveraging disk forensic tools. </span><span class="koboSpan" id="kobo.678.2">Exploring a disk image using Autopsy demonstrated some of the features that are available to responders. </span><span class="koboSpan" id="kobo.678.3">From here, extracting other data stores such as the Windows Registry and MFT were explored to provide responders with an idea of what data is available during an incident analysis. </span></p>
<p><span class="koboSpan" id="kobo.679.1">Specific tools and techniques are largely dependent on the tool that’s utilized. </span><span class="koboSpan" id="kobo.679.2">What’s important to understand is that modern operating systems leave traces of their activity all over the disk, from file change evidence in the MFT to registry key settings when new user accounts are added. </span><span class="koboSpan" id="kobo.679.3">Incident responders should have expertise in understanding how modern operating systems store data and how to leverage commercial or freeware tools to find this data. </span><span class="koboSpan" id="kobo.679.4">Taken in concert with other pieces of evidence that are obtained from network sources and in memory, disk evidence may provide more clarity on an incident and aid in determining its root cause. </span><span class="koboSpan" id="kobo.679.5">One area of focus when it comes to system storage analysis is extracting and examining log files. </span><span class="koboSpan" id="kobo.679.6">Log files are critical data points that provide responders with a great deal of information. </span></p>
<p><span class="koboSpan" id="kobo.680.1">The next chapter will carry on from the work that was done here and address how log files can be utilized in an </span><span class="No-Break"><span class="koboSpan" id="kobo.681.1">incident investigation.</span></span></p>
<h1 id="_idParaDest-197"><a id="_idTextAnchor202"/><span class="koboSpan" id="kobo.682.1">Questions</span></h1>
<p><span class="koboSpan" id="kobo.683.1">Answer the following questions to test your knowledge of </span><span class="No-Break"><span class="koboSpan" id="kobo.684.1">this chapter:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.685.1">What are some of the features that are available with commercial and open source forensic platforms? </span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.686.1">Hex viewer</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.687.1">Email carving</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.688.1">Metadata viewer</span></span></li><li><span class="koboSpan" id="kobo.689.1">All of </span><span class="No-Break"><span class="koboSpan" id="kobo.690.1">the above</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.691.1">In what registry hive could an incident responder find USBs that have been connected to the system? </span><ol><li><span class="koboSpan" id="kobo.692.1">SAM </span></li><li><span class="koboSpan" id="kobo.693.1">Security </span></li><li><span class="koboSpan" id="kobo.694.1">System </span></li><li><span class="koboSpan" id="kobo.695.1">User profile </span></li></ol></li>
<li><span class="koboSpan" id="kobo.696.1">Web history may provide data on a phishing URL that’s been accessed by the system. </span><ol><li><span class="koboSpan" id="kobo.697.1">True </span></li><li><span class="koboSpan" id="kobo.698.1">False </span></li></ol></li>
<li><span class="koboSpan" id="kobo.699.1">Which of the following is not a Windows registry hive? </span><ol><li><span class="koboSpan" id="kobo.700.1">System </span></li><li><span class="koboSpan" id="kobo.701.1">SAM </span></li><li><span class="koboSpan" id="kobo.702.1">Storage </span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.703.1">Software</span></span></li></ol></li>
</ol>
<h1 id="_idParaDest-198"><a id="_idTextAnchor203"/><span class="koboSpan" id="kobo.704.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.705.1">For more information about the topics covered in this chapter, refer to the </span><span class="No-Break"><span class="koboSpan" id="kobo.706.1">following resources:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.707.1">Autopsy GitHub: </span><a href="https://github.com/sleuthkit/autopsy"><span class="koboSpan" id="kobo.708.1">https://github.com/sleuthkit/autopsy</span></a> </li>
<li><span class="koboSpan" id="kobo.709.1">Eric Zimmerman Tools: </span><a href="https://ericzimmerman.github.io/#!index.md"><span class="koboSpan" id="kobo.710.1">https://ericzimmerman.github.io/#!index.md</span></a> </li>
<li><span class="koboSpan" id="kobo.711.1">Eric Zimmerman Tools Cheat </span><span class="No-Break"><span class="koboSpan" id="kobo.712.1">Sheet: </span></span><a href="https://www.sans.org/posters/eric-zimmerman-tools-cheat-sheet/"><span class="No-Break"><span class="koboSpan" id="kobo.713.1">https://www.sans.org/posters/eric-zimmerman-tools-cheat-sheet/</span></span></a></li>
<li><span class="koboSpan" id="kobo.714.1">Registry Analysis with FTK Registry </span><span class="No-Break"><span class="koboSpan" id="kobo.715.1">Viewer: </span></span><a href="https://subscription.packtpub.com/book/networking_and_servers/9781784390495/6/ch06lvl1sec37/registry-analysis-with-ftkregistry-viewer"><span class="No-Break"><span class="koboSpan" id="kobo.716.1">https://subscription.packtpub.com/book/networking_and_servers/9781784390495/6/ch06lvl1sec37/registry-analysis-with-ftkregistry-viewer</span></span></a></li>
<li><span class="koboSpan" id="kobo.717.1">Windows Registry Analysis </span><span class="No-Break"><span class="koboSpan" id="kobo.718.1">101: </span></span><a href="https://www.forensicfocus.com/articles/windows-registry-analysis-101/"><span class="No-Break"><span class="koboSpan" id="kobo.719.1">https://www.forensicfocus.com/articles/windows-registry-analysis-101/</span></span></a></li>
</ul>
</div>
</body></html>