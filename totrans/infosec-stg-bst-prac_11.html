<html><head></head><body>
		<div><h1 id="_idParaDest-135"><a id="_idTextAnchor150"/>Chapter 8: Improving the Security of Software</h1>
			<p>Software has enabled organizations around the world to increase their productivity to unforeseen levels of efficiency, helping to automate previously manual and menial tasks. By looking at your organization's software assets (and updating your risk register as you do it), you have become more and more aware that nearly every business process is aided by at least one software solution, and that the more resilient, secure, and available the software is, the more benefit is seen by the organization. </p>
			<p>Some of your software has probably been developed in-house, and other software has been purchased or licensed from third parties. These systems often present huge attack surfaces, with many moving parts that are ready to be exploited, and since they process confidential and sensitive information and store business-critical data, unauthorized access to (or destruction of) these systems can lead to either permanent loss of critical data or the loss of confidentiality or integrity of intellectual property, company secrets, and customer data. Furthermore, these breaches can lead to colossal fines from regulators, adding insult to injury. </p>
			<p>The terrifying thing is, even with all of the reasons to care that I've just listed, the procurement, development, and use of various software systems are usually undertaken with absolutely zero security-focused oversight. This is exactly why understanding and enforcing improved software security is crucial in order to ensure your organization mitigates the risk presented by the software it uses. </p>
			<p>In this chapter, I'm going to delve into some of the topics that can help you ensure a higher standard for software security in your organization. This includes topics such as the following: </p>
			<ul>
				<li>Exploring software security paradigms</li>
				<li>Understanding the secure development life cycle</li>
				<li>Utilizing the OWASP Top 10 Proactive Controls</li>
				<li>Assessing software security</li>
			</ul>
			<p>Overall, what we want to learn from this chapter is how to establish requirements for software, regardless of whether it has been developed by a third party or an in-house development team. I'll cover the methods we can use to understand the risk profile for software systems developed by a vendor, how to reduce the likelihood of vulnerabilities and errors in your organization's in-house development activities, and methods to mitigate against security risks, focusing on the CIA triad. </p>
			<p>Without further ado, let's proceed on with this chapter. </p>
			<h1 id="_idParaDest-136"><a id="_idTextAnchor151"/>Exploring software security paradigms</h1>
			<p>I'd like to take you on a trip <a id="_idIndexMarker928"/>down memory lane for a moment, and remember April 2014, an important moment in the general history of InfoSec; the world was blindsided by the disclosure of the <em class="italic">CVE-2014-0160</em> vulnerability, given the moniker of <strong class="bold">Heartbleed</strong>. Now, when I use the term <em class="italic">the world</em>, I mean it. <em class="italic">Heartbleed</em> was the <em class="italic">Jaws</em> of software security blockbusters, getting a website of its own (heartbleed.com), and <a id="_idIndexMarker929"/>even its own logo:</p>
			<div><div><img src="img/B16611_08_001.jpg" alt="Figure 8.1 – The Heartbleed vulnerability's logo&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.1 – The Heartbleed vulnerability's logo</p>
			<p>In the disclosure was information about how the <strong class="bold">OpenSSL cryptography library</strong> contained a vulnerability related to a <strong class="bold">buffer over-read</strong>, allowing a malicious actor to access cryptographic keys and login credentials, along with various other pieces of confidential information. It sounds bad, but it gets worse: the OpenSSL cryptography library is used in the <strong class="bold">OpenSSL version of the TLS protocol</strong>, widely used globally for securing data in transit, pretty much everywhere. To put it plainly: over half of the top 1 million most-popular <strong class="bold">TLS-/HTTPS-protected sites</strong> were affected and able to be exploited. </p>
			<p>Even though a fix was released for Heartbleed on the same day as the disclosure, it didn't prevent devices such as firewalls, Android phones, and other trusted hardware, as well as software and websites, from being left vulnerable until the patches were implemented and updates were rolled out to align with the most recent version. </p>
			<p>Furthermore, let's be clear: the vulnerability had existed in the code since 2011; we know this because it was viewable to anybody who cared to look through and read the source code. This was as a result of the fact that OpenSSL was software created in an <strong class="bold">open source</strong> development context. Open source means that the source code of the software is freely available to be read, modified, and redistributed. A perceived advantage of the <em class="italic">open source software movement</em> is the idea that transparent software prevents security-through-obscurity among other vulnerabilities in the source code, as it would be <a id="_idIndexMarker930"/>discovered by anybody who cares to look. Unfortunately, in the case of OpenSSL's cryptography library, it seems as though either nobody noticed or nobody was willing to shout about the vulnerability until 3 years later. </p>
			<p>That might seem strange, right? Wrong. Up until recently, it's been the default. Security has been an afterthought to any organization looking to create new features and roll out new products, but as time has gone on, with blockbuster-style disclosures such as Heartbleed entering into the lexicon of the average business owner and IT professional, we've seen a paradigm shift toward giving security a bit more consideration. </p>
			<p>So, how can we ensure we avoid implementing vulnerable software into our organization, regardless of whether it's a vendor-created productivity suite, an open source cryptography library, or a tool developed by an in-house team for your employees? You're not going to catch every issue, so it's important to manage your expectations on the matter. Just like with anything in information security, it's about risk management and setting up the appropriate policies and procedures to ensure the necessary steps have been taken, in line with the value of the assets in question. </p>
			<p>To begin with, let's look at an idea that can be applied to more than just InfoSec, to any time we buy anything. </p>
			<h2 id="_idParaDest-137"><a id="_idTextAnchor152"/>Buyer beware</h2>
			<p>Have you ever heard the term <em class="italic">let the buyer beware</em>? I'm betting you've heard the Latin version, <em class="italic">caveat emptor</em>, right? How about we use this opportunity to do what every person reading this chapter focusing on software security was hoping for and take a quick dip into Latin terms found in contract law: </p>
			<p class="author-quote">Caveat emptor, quia ignorare non debuit quod jus alienum emit</p>
			<p>Loosely translated to English, this means the following: </p>
			<p class="author-quote">Let a purchaser beware, for he ought not to be ignorant of the nature of the property which he is buying from another party.</p>
			<p>I'm surprised it's caught on <a id="_idIndexMarker931"/>so well, to be honest. Usually, if you need to take a breath in the middle of reciting an adage, it doesn't really last. Despite being quite long-winded, this idea has stood the test of time and must be considered when procuring new software. </p>
			<p>It's up to the buyer to perform due diligence on software systems that are going to be utilized in their estate. It's your responsibility to ensure your organization has undertaken that due diligence appropriately and stores that information for future use in the event of needing to prove to regulators or auditors that the appropriate precautions were taken and that due care was applied in the process.</p>
			<p>"But how?", you ask. "How can I make sure?".</p>
			<h2 id="_idParaDest-138"><a id="_idTextAnchor153"/>Legal documentation</h2>
			<p>"Oh great," you say after reading the heading of this section, "he's going to talk about paperwork next." Well yes, I am, unfortunately. </p>
			<p>The fact of the matter is, you can't be 100% certain that the software you've purchased has been developed securely. You can, however, try to implement terms into the contractual agreement you have with the vendor to ensure they understand your requirements and are responsible for ensuring their developed solutions are created with security in mind. </p>
			<p>Contracts that define <em class="italic">liabilities</em> associated with the vendor are a form of risk mitigation. What I mean is that in the event of a breach that leads to the disclosure of either your organization's confidential information or sensitive information related to individuals, are you able to be reimbursed by the vendor based on the level of loss your organization faces from fines and reputational damage? </p>
			<p>Whether or not the vendor accepts those terms depends on various factors, including the nature of the terms, the size of the vendor, the size of your organization, how big of a customer you are for them, and so on. </p>
			<p>Sometimes, you'll just need to <a id="_idIndexMarker932"/>implement other types of mitigation and accept that the vendor isn't accepting liability in the event of a breach, regardless of whether a backdoor or malware was introduced from their side. It's your responsibility to keep the agreements documented and reference them when you're performing risk assessments, both before and after the software has been implemented. </p>
			<p>Furthermore, the ideologies relating to InfoSec for your assets that we've covered in this book still stand. We must allow least-privilege access to the software, we should monitor the software's activity and how it interacts with our other assets, and we will continually review and assess the software's suitability and risks over its entire life cycle in our organization. </p>
			<p>Speaking of life cycles, I figure we should discuss the idea surrounding the <strong class="bold">Secure Development Life Cycle</strong> (<strong class="bold">SDLC</strong>), as knowledge surrounding this topic relates to both software developed by third parties and your organization's own undertakings in developing software. </p>
			<h1 id="_idParaDest-139"><a id="_idTextAnchor154"/>Understanding the secure development life cycle </h1>
			<p>The SDLC is all about <a id="_idIndexMarker933"/>baking security into the development of software through a set of processes. When you ask your vendors about their SDC, you're going to want to understand the methods that they are employing to ensure the software they're selling you is secure enough for your organization. </p>
			<p>The same company that offers the <em class="italic">CISSP</em>, known as <em class="italic">(ISC)²</em>, also offers the <strong class="bold">CSSLP</strong>, or <strong class="bold">Certified Secure Software Lifecycle Professional</strong>, which <a id="_idIndexMarker934"/>covers eight domains that you need to understand in order to pass the exam: </p>
			<ul>
				<li>Secure Software Concepts</li>
				<li>Secure Software Requirements</li>
				<li>Secure Software Architecture and Design</li>
				<li>Secure Software Implementation</li>
				<li>Secure Software Testing</li>
				<li>Secure Software Lifecycle Management</li>
				<li>Secure Software Deployment, Operations, Maintenance</li>
				<li>Secure Software Supply Chain</li>
			</ul>
			<p>Obviously, going into each of these topics in any sort of depth is going to occupy more than the 30-page limit I have on this chapter, and if I did so, it would repeat much of the concepts I've previously touched on in this book, including labeling the types of data or implementing the principles of least-privilege and separation of duties, or defense-in-depth, but it's still worthwhile to highlight some of the key takeaways unique to the SDLC and pique your interest for further investigation. </p>
			<p>We can essentially split the <a id="_idIndexMarker935"/>SDLC into five stages, each with its own sub-groups: </p>
			<ul>
				<li>Defining business and security requirements</li>
				<li>Designing secure software</li>
				<li>Test plans for secure software</li>
				<li>Secure software development</li>
				<li>Testing the software</li>
			</ul>
			<p>Shall we delve briefly into each of these bullets to discuss the process at a slightly more detailed level? Let's do it, but first I would like to address the elephant in the room: the idea that <em class="italic">nobody develops code this way anymore</em>. Let's talk about the various <em class="italic">software development methodologies</em> and how they might work with the SLDC.  </p>
			<h2 id="_idParaDest-140"><a id="_idTextAnchor155"/>Compatibility with various software development methodologies</h2>
			<p>Over time, the most widely chosen methods of developing software have transitioned from a stage-by-stage, project-managed, "release major updates twice a year" <strong class="bold">Waterfall</strong> type of <a id="_idIndexMarker936"/>approach to <a id="_idIndexMarker937"/>software development toward a more rapidly iterative approach, often referred to as <strong class="bold">Agile</strong>, where the <a id="_idIndexMarker938"/>solution is broken up into small cycles, attempting to deliver a <a id="_idIndexMarker939"/>working product early and improving incrementally and often. </p>
			<p>Furthermore, there might be a split <a id="_idIndexMarker940"/>between the developer team at an organization, and the IT operations team, or there might be a more integrated approach to developing and deploying software, such as <a id="_idIndexMarker941"/>the <strong class="bold">DevOps</strong> approach, for example:</p>
			<div><div><img src="img/Image86712.jpg" alt="Figure 8.2 – The DevOps life cycle diagram&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.2 – The DevOps life cycle diagram</p>
			<p>Regardless of which method(s) your organization develops software with (and there are many different styles inside those methodologies), the SDLC process can still be utilized and employed as a baked-in approach. Notice in the preceding diagram of the DevOps life cycle that it aligns with the five steps of the SDLC I mentioned previously, as long as you find a place to ensure you define the business and security requirements for the software in the planning phase! </p>
			<p>Okay, let's take a closer look at each of the five steps of the SDLC, starting with defining your business and security requirements. </p>
			<h2 id="_idParaDest-141"><a id="_idTextAnchor156"/>Defining business and security requirements</h2>
			<p>You see, in order for <a id="_idIndexMarker942"/>good software to be created, requirements must be defined at the beginning of any iteration. It rarely is, but then again, software is rarely what we would consider good. Inside those requirement definitions, along <a id="_idIndexMarker943"/>with usage scenarios and solutions, we need to ensure we define the security and privacy requirements for the software, and in the process of development, the software must be tested against those security and privacy requirements. </p>
			<p>Beyond that, we need to consider the <strong class="bold">abuse cases</strong> or <em class="italic">ways a malicious actor may misuse the software</em>, essentially <a id="_idIndexMarker944"/>performing <strong class="bold">threat modeling</strong> with consideration into the <strong class="bold">attack surface</strong>. As a result of the findings from the abuse cases, we need to ensure that the appropriate mitigations have been put into place (with expenditure in line with the level of risk) to prevent or decrease the <em class="italic">likelihood</em> of those attacks from being successful and find a way to reduce the <em class="italic">impact</em> if the attack is successful. </p>
			<p>I will discuss how we can do this in a more detailed fashion in the <em class="italic">Utilizing the OWASP Top Ten Proactive Controls</em> section.</p>
			<h2 id="_idParaDest-142"><a id="_idTextAnchor157"/>Designing secure software</h2>
			<p>With the abuse cases and requirements in <a id="_idIndexMarker945"/>place, we want to design the software architecture to have the appropriate controls (preventative, detective, and responsive) in place, and ensure the overall structure of the application and the way it interacts with other systems and individuals are <em class="italic">secure by design</em>. </p>
			<h2 id="_idParaDest-143"><a id="_idTextAnchor158"/>Testing plans for secure software</h2>
			<p>Along with <em class="italic">unit testing</em>, <em class="italic">integration testing</em>, <em class="italic">system testing</em>, and <em class="italic">acceptance testing</em>, <em class="italic">security testing</em> must be <a id="_idIndexMarker946"/>implemented into the SDLC in order to catch security vulnerabilities through various methodologies, including both automated and manual processes. </p>
			<p>Prior to the development of the software, we want to plan and define the tests that must be done in order to ensure the software development process takes these tests into consideration. </p>
			<p>The <strong class="bold">ISO/IEC/IEEE 29119 standards</strong> for <em class="italic">Software and Systems Engineering – Software Testing</em> are a set of <a id="_idIndexMarker947"/>standards comprising five different parts: </p>
			<ul>
				<li><em class="italic">Part 1: Concepts and definitions</em></li>
				<li><em class="italic">Part 2: Test concepts</em></li>
				<li><em class="italic">Part 3: Test documentation</em></li>
				<li><em class="italic">Part 4: Test techniques</em></li>
				<li><em class="italic">Part 5: Keyword-driven testing</em></li>
			</ul>
			<p>There was a bunch of pushback over the <em class="italic">29119</em> standard, where several groups claimed it's unnecessary to standardize <a id="_idIndexMarker948"/>testing. I don't think this should matter to you in this chapter; it's up to you to determine whether any of these ideologies is applicable in your organization. The bottom line is, the standard's <em class="italic">Part 3</em> offers template documentation examples for your test plans, and if we're following the SDLC, then it might make sense to lean on those rather than spending time reinventing the wheel. </p>
			<p>The templates from ISO/IEC/IEEE 29119:-3:2013 (yes, I know, what a name) cover the organizational-level, project-level, and dynamic test <a id="_idIndexMarker949"/>documentation you might like to use, including the following: </p>
			<ul>
				<li><strong class="bold">Organizational test process documentation templates</strong>:<p>- <em class="italic">Test policy</em></p><p>- <em class="italic">Organizational test strategy</em></p></li>
				<li><strong class="bold">Test management process documentation templates</strong>:<p>- <em class="italic">Test plan (including a test strategy)</em></p><p>- <em class="italic">Test status</em></p><p>- <em class="italic">Test completion</em></p></li>
				<li><strong class="bold">Dynamic test process documentation templates</strong>:<p>- <em class="italic">Test design specification</em></p><p>- <em class="italic">Test case specification</em></p><p>- <em class="italic">Test procedure specification</em></p><p>- <em class="italic">Test data requirements</em></p><p>- <em class="italic">Test data readiness report</em></p><p>- <em class="italic">Test environment requirements</em></p><p>- <em class="italic">Test environment readiness report</em></p><p>- <em class="italic">Actual results</em></p><p>- <em class="italic">Test result</em></p><p>- <em class="italic">Test execution log</em></p><p>- <em class="italic">Test incident report</em></p></li>
			</ul>
			<p>This means you'll have the <a id="_idIndexMarker950"/>appropriate suite of templates to help your product team(s) and engineering team(s) quickly and systematically document and meet the requirements set out for your software. If it seems like all of this process and documentation will get in the way of getting <em class="italic">actual</em> engineering work done, you're probably a software engineer. </p>
			<p>With that said, I'm well <a id="_idIndexMarker951"/>aware of the complaints and concerns that are raised by developers in this circumstance, especially the faster we develop things and the more rapidly we integrate changes into our production environment. If your organization is utilizing these principles, then I'm not going to advise you to bog down your team with a bunch of paperwork. </p>
			<p>Our job as information security professionals is to understand the risk and reduce it to an acceptable level. Part of this process is ensuring that the software that is being created by the development <a id="_idIndexMarker952"/>team is fit for purpose and meets the requirements defined, and showing that without these processes in place is a difficult task. </p>
			<p>With the <a id="_idIndexMarker953"/>documentation I mentioned from ISO/IEC/IEEE 29119, we aim to do the following: </p>
			<ul>
				<li><strong class="bold">Analyze the software</strong>, where we specify the users, use cases, use scenarios, and resources utilized by the solution. </li>
				<li><strong class="bold">Design the test strategy</strong>, where we define the objectives for the tests and estimate the resources required and costs associated with the testing phase. We also define what is in scope and what is out of scope.</li>
				<li><strong class="bold">Define the test criteria</strong>, where we create a flow that defines when we stop testing in the event of a failure and what constitutes a successful test completion. </li>
				<li><strong class="bold">Define the test environment</strong>, where we specify the user and business environments that we will test in. </li>
				<li><strong class="bold">Define the schedule</strong>, including deadlines, estimations for each resource, and any blockers or dependencies that might hamper the ability to complete the tests. </li>
				<li><strong class="bold">Determine test deliverables</strong>, including test results and reports, test procedure documentation, and release notes in the event of the software meeting the test requirements. </li>
			</ul>
			<p>So, it's not like I'm asking you to write <em class="italic">War and Peace</em> here, and if we're following the <em class="italic">Agile</em> process, each small improvement can have a truly short definition for each of the six previously listed concepts, potentially right after the <strong class="bold">user story</strong>. The user story is a way to define software requirements to developer<a id="_idTextAnchor159"/>s in a structured way: </p>
			<pre>As a &lt;insert role&gt;, I want &lt;insert requirement&gt;, so I can &lt;insert use-case&gt;.</pre>
			<p>That covers most of the first step, analyze the software, and after that, we can include our test objectives, resources required for the tests, acceptance criteria, test environment, and test schedule. </p>
			<p>If errors are found, they can <a id="_idIndexMarker954"/>be solved quickly and easily in the same iteration or sprint. </p>
			<p>So, how might you want to test the software in order to ensure security vulnerabilities are taken into consideration and avoided? </p>
			<p>I'm going to go into that, but first I'd like to talk about the process of <em class="italic">securing software development</em>, the next phase of the SDLC. </p>
			<h2 id="_idParaDest-144"><a id="_idTextAnchor160"/>Securing software development</h2>
			<p>In the process of <a id="_idIndexMarker955"/>developing the code, we want to ensure our developers are following certain ideologies related to secure code. We can create training and awareness programs and provide documentation on how to ensure they are following <a id="_idIndexMarker956"/>secure software development ideologies, including but not limited to the following:</p>
			<ul>
				<li><strong class="bold">Input and output sanitation</strong>, to prevent <em class="italic">injection</em> vulnerabilities and <em class="italic">denial of services</em> from malicious or negligent user input</li>
				<li>Appropriate <strong class="bold">error handling</strong>, and ensuring the user isn't given too much information in the event of an error occurring</li>
				<li><strong class="bold">Resource management</strong> and <strong class="bold">concurrency</strong>, ensuring processes are scalable</li>
				<li><strong class="bold">Isolation</strong>, ensuring processes are segregated through <em class="italic">sandboxing</em>,<em class="italic"> virtualization</em>, <em class="italic">containerization</em>, and related technological concepts</li>
				<li><strong class="bold">Cryptographic control</strong> selection and implementation, ensuring the appropriate protocols are implemented correctly, with cost-benefit analysis taken into consideration</li>
				<li><strong class="bold">Access control structures</strong>, including ensuring <em class="italic">trust zones</em>, <em class="italic">least-privilege</em>, and <strong class="bold">Role-Based Access Controls</strong> (<strong class="bold">RBACs</strong>) are <a id="_idIndexMarker957"/>considered and appropriately applied</li>
			</ul>
			<p>In order to avoid repeating <a id="_idIndexMarker958"/>ourselves, I think it might be more useful to cover these ideologies in further depth by having a look at the types of tests we may implement to check for well-known security flaws in software and explaining how those flaws can be avoided or mitigated against.  </p>
			<h2 id="_idParaDest-145"><a id="_idTextAnchor161"/>Testing the software</h2>
			<p>Considering we have <a id="_idIndexMarker959"/>already defined the appropriate test processes, relevant stakeholders, environments, and acceptance criteria, now is the time to execute those plans, with both automated and manual processes being undertaken to ensure any changes that have been made to the source code, environment, or usages of the software are appropriately effective, efficient, and secure. </p>
			<p>This is not to say we perform all these tests after the software has been developed. If we're using more rapid development methodologies, we must leverage more automated systems and create rapid notifications for any manual testing processes required in order to ensure there isn't a bottleneck at the testing phase of the SDLC. This <em class="italic">near-real-time</em> approach to testing new software results discovers issues quickly and ensures the developers are adaptive and <em class="italic">fail fast</em>, discovering their errors quickly and remediating before too much time has been put into a flawed approach. By doing so, we're helping the developers create more secure software, quickly. </p>
			<p>Looking back at how we might have defined our test plans and designed our test processes, a few examples of what we would like to implement along the process in order to increase security and speed up testing processes could include the following: </p>
			<ul>
				<li><strong class="bold">Architecture analysis</strong>, including <a id="_idIndexMarker960"/>end-to-end process and design examination. </li>
				<li><strong class="bold">Dependency checks</strong>, which automate the <a id="_idIndexMarker961"/>process of checking for vulnerabilities in imported third-party software dependencies. </li>
				<li>Automated <strong class="bold">SAST</strong>, or <strong class="bold">static application security testing</strong>, which <a id="_idIndexMarker962"/>we've mentioned in previous chapters. </li>
				<li>Automated <strong class="bold">DAST</strong>, or <strong class="bold">dynamic application security testing</strong>, which we've also mentioned in <a id="_idIndexMarker963"/>previous chapters. </li>
				<li><strong class="bold">Code review</strong>, where one <a id="_idIndexMarker964"/>developer reads and critiques the code of another developer. This helps with knowledge-sharing, as well as implementing the <em class="italic">two-man principle</em>, which means the two parties would need to collude in order to implement a <em class="italic">backdoor or malware</em>. It's not fail-safe, but it's part of a <em class="italic">defense-in-depth</em> approach. </li>
				<li><strong class="bold">Penetration testing</strong>, which we've <a id="_idIndexMarker965"/>spoken about multiple times, could occur upon significant change, as well as on a regular point-in-time basis. </li>
			</ul>
			<p>Inside these processes, we will as a bare minimum want to check to ensure that the OWASP Top 10 Proactive Controls (<a href="https://owasp.org/www-project-proactive-controls/v3/en/0x04-introduction.html">https://owasp.org/www-project-proactive-controls/v3/en/0x04-introduction.html</a>) have been implemented. This means putting documented procedures into <a id="_idIndexMarker966"/>place for both automated scans as well as manual code reviews, and training developers on all of these steps and controls. It's crucial for the success of your SDLC, so don't neglect training, awareness, policies, and procedures!  </p>
			<p>I'd like to go into the Top 10 Proactive Controls from OWASP in the following sections.</p>
			<h1 id="_idParaDest-146"><a id="_idTextAnchor162"/>Utilizing the OWASP Top 10 Proactive Controls </h1>
			<p>Let me briefly cover each of <a id="_idIndexMarker967"/>the OWASP Top 10 Proactive controls for improving the security of software. Each control has its own section. </p>
			<h2 id="_idParaDest-147"><a id="_idTextAnchor163"/>Define security requirements</h2>
			<p>As we've previously discussed, the ability to <a id="_idIndexMarker968"/>articulate and document the requirements expected to be fulfilled by a software solution is highly beneficial to the organization for various reasons, including <em class="italic">cost-savings</em> and <em class="italic">useability improvements</em>, but another business requirement that must be fulfilled by either software development work or purchased/open source software are those requirements surrounding information security.</p>
			<p>Creating standard security requirements based on best practices and industry knowledge helps developers and procurement staff reuse the knowledge they gain from previous iterations, so it's highly recommended to define the requirements in a way that will be uniform and stand the test of time.</p>
			<p>Inside the <em class="italic">OWASP Top 10 Proactive Controls</em> section on defining security requirements, they reference the <strong class="bold">OWASP ASVS</strong>, or <strong class="bold">Application Security Verification Standard</strong>, which is a collection of security requirements, and the various criteria required for verifying that those requirements have been met. As a sample, it includes categories of best practices for various information security functions, such as access control, error handling, authentication, and so on. It's an excellent resource that should not be ignored. </p>
			<p>As we previously spoke about, utilizing <em class="italic">user stories</em>, as we would see in Agile software development processes, as well as <em class="italic">misuse user stories</em>, can help teams operating in these functions to verify that the security requirements have been met. </p>
			<p>As an example, we can reference the <em class="italic">ASVS</em> requirements that you could leverage for authentication, such as verifying that there are no default passwords in use, as referenced here: </p>
			<p class="author-quote">Verify there are no default passwords in use for the application framework or any components used by the application (such as "admin/password").</p>
			<p class="author-quote">– ASVS 3.0.1, requirement 2.19</p>
			<p>To convert that into a <strong class="bold">user story</strong>, use the formula I mentioned previously:</p>
			<pre>As a &lt;insert role&gt;, I can &lt;insert requirement&gt;, so I can &lt;insert use-case&gt;.</pre>
			<p>Let's do it for ASVS 3.0.1, requirement 2.19: </p>
			<p class="author-quote">"As a user, I can enter my username and password, so I can gain access to the application."</p>
			<p>Or:</p>
			<p class="author-quote">"As a user, I can enter a long password that has a maximum of 1023 characters, so I can use a strong and unique password."</p>
			<p>A <strong class="bold">misuse user story</strong> is told from the perspective of the malicious actor: </p>
			<p class="author-quote">"As a malicious actor, I want to be able to enter the published default username and password, so I can gain access without permission."</p>
			<p>It's up to you whether you <a id="_idIndexMarker969"/>want to utilize one or both of these in your user stories, but just be careful that your developers understand what they are, and don't misread the misuse user story as a requirement! </p>
			<h2 id="_idParaDest-148"><a id="_idTextAnchor164"/>Leverage security frameworks and libraries</h2>
			<p>Software development has a <a id="_idIndexMarker970"/>wealth of resources available online, from free online courses to learn various languages to documentation for web app frameworks, and the list goes on. That culture has extended into the <a id="_idIndexMarker971"/>world of security in software development, with standards, frameworks, libraries, and other highly documented resources available to anybody interested enough in learning. Sometimes, it's as simple as importing a few packages into a development project. </p>
			<p>With that, it's still important to remember a few key ideologies to ensure the risk of utilizing third-party resources is safe and secure: </p>
			<ul>
				<li>Using trusted sources that have a track record for maintenance activity. If a framework or resource isn't actively updated and maintained, it will present challenges and has a high likelihood of vulnerabilities. </li>
				<li>Ensure we document all third-party libraries and software inside our risk management asset catalog. This may be difficult, but there are <a id="_idIndexMarker972"/>services such as Snyk (<a href="https://snyk.io/">https://snyk.io/</a>) that automate the process of gathering the list and applying a risk score to that list. </li>
				<li>Ensuring that updates are <a id="_idIndexMarker973"/>applied before the software is facing breaking changes due to lack of maintenance. Aside from the previously mentioned Snyk, OWASP themselves offer a <a id="_idIndexMarker974"/>tool called <strong class="bold">OWASP Dependency-Check</strong> to look for publicly disclosed vulnerabilities in your third-party library list. NPM has a similar service available, and more options appear regularly. </li>
				<li>Ensure developers <a id="_idIndexMarker975"/>maintain the <em class="italic">principle of least-privilege</em> any time they can. Allowing increased access increases the attack surface, and therefore will likely increase risk. </li>
			</ul>
			<p>You know, the basics that we've been harping on about for this entire book now! </p>
			<h2 id="_idParaDest-149"><a id="_idTextAnchor165"/>Secure database access</h2>
			<p>When software interacts with <a id="_idIndexMarker976"/>data stores, such as SQL databases, a number of key ideologies can be upheld in order to increase the security of the software and reduce risk to an acceptable level. As an example, we don't want users to be able to input anything into a query that is then interpreted as a command without being parsed, checked, and sanitized first:</p>
			<div><div><img src="img/B16611_08_003.jpg" alt="Figure 8.3 – XKCD #327 – sanitizing inputs&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.3 – XKCD #327 – sanitizing inputs</p>
			<p>Ideally, we won't even give the users the ability to enter queries themselves, but that depends on the use cases. By using protections <a id="_idIndexMarker977"/>such as <strong class="bold">query parameterization</strong>, you can create <em class="italic">secure queries</em> that reduce the likelihood of an injection attack, such as SQL injection. </p>
			<p>Read more about <em class="italic">query parameterization</em> from the <em class="italic">OWASP Query Parameterization Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html</a>).</p>
			<p>Furthermore, you'll want to ensure your database and any computing platform used to run the database are properly <a id="_idIndexMarker978"/>set up with a <strong class="bold">secure configuration</strong>, preferably leveraging the baseline configurations we referenced in previous chapters. </p>
			<p><strong class="bold">Secure authentication</strong> means that <a id="_idIndexMarker979"/>authentication is protected through various means. For example, it's important to <a id="_idIndexMarker980"/>ensure that authentication is performed through a <strong class="bold">secure channel</strong>, protecting any <a id="_idIndexMarker981"/>credentials from being exposed. When credentials are stored at rest, they must be protected with <em class="italic">defense-in-depth</em> for the various threats, including <em class="italic">access control and encryption-at-rest</em> for protection against attacks on confidentiality, and <em class="italic">redundancy</em> for attacks on availability. </p>
			<p>Finally, while the software and database communicate back and forth, it's important to ensure that the communication takes place over a <em class="italic">secure channel</em>, utilizing <em class="italic">encryption-in-transit</em>, as well as preventing the user from gaining too much information from error messages and logs. </p>
			<p>You can read further into database security from the <em class="italic">OWASP Database Security Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Database_Security_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Database_Security_Cheat_Sheet.html</a>).</p>
			<h2 id="_idParaDest-150"><a id="_idTextAnchor166"/>Encode and escape data</h2>
			<p>Another way to prevent <em class="italic">injection attacks</em> is to <code>\"</code>, to prevent the interpreter from closing a string) in order to reduce the risk of the interpreter or browser outputting dangerous content as a result of bad input. </p>
			<p>Encoding output data <a id="_idIndexMarker982"/>helps protect against <strong class="bold">Cross-Site Scripting</strong> (<strong class="bold">XSS</strong>) attacks, among <a id="_idIndexMarker983"/>other flaws such as operating system command injection or the time somebody's emoji use ended up crashing an entire banking system (<a href="https://www.vice.com/en/article/gv5jgy/iphone-emoji-break-apps">https://www.vice.com/en/article/gv5jgy/iphone-emoji-break-apps</a>). </p>
			<p><em class="italic">Encoding and escaping</em> can occur at <a id="_idIndexMarker984"/>various stages in the process of accepting and outputting data and should be considered any time <em class="italic">user input</em> or other <em class="italic">untrusted data</em> is interpreted or dynamically output back onto the interface. </p>
			<p>You can read more about how to <a id="_idIndexMarker985"/>prevent XSS attacks from the <em class="italic">OWASP Cross-Site Scripting Prevention Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html</a>), and how to prevent <a id="_idIndexMarker986"/>injection attacks from the <em class="italic">OWASP Injection Prevention Cheat Sheet </em>(https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html).</p>
			<h2 id="_idParaDest-151"><a id="_idTextAnchor167"/>Validate all inputs</h2>
			<p>Closely related to the last point is the idea of <em class="italic">validate all inputs</em>. We want to ensure all inputs are appropriately validated and properly formatted before they're stored or interact with any part of the software or system. </p>
			<p>That includes the <a id="_idIndexMarker987"/>classic syntax checks, such as if a user is entering a credit card number, we want to make sure that it follows the format of a credit card number. </p>
			<p>This includes preventing any blacklisted characters or terms from being accepted, as well as having a whitelist if the input can only be a certain number of things. For example, if the input is asking for a two-letter abbreviation for a US state, we can have a whitelist of the 50 "approved" inputs and prevent any other input from being approved.  </p>
			<p>These checks should follow the <em class="italic">defense-in-depth</em> idea and shouldn't rely on a <strong class="bold">happy path</strong> for the user to follow, as malicious actors like to find ways around the frontend controls. </p>
			<p>Leveraging validation functionality in various security libraries and frameworks can simplify this process for your development team, but they should always be tested to ensure they're fit for purpose on your project. </p>
			<p>Treating all inputs as though they are malicious is the way forward, so let's just agree to add that to all of our SDLC policies moving forward, alright? Further reading on input validation can be <a id="_idIndexMarker988"/>done with the <em class="italic">OWASP Input Validation Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html</a>).</p>
			<h2 id="_idParaDest-152"><a id="_idTextAnchor168"/>Implement digital identity</h2>
			<p>We need to ensure that our <a id="_idIndexMarker989"/>individual users are given an ID while interacting with our software, in order to both offer a streamlined experience during their session, as well as providing ourselves the ability to understand errors and track misuse. </p>
			<p>NIST released a special publication, <em class="italic">800-63B, Digital Identity Guidelines – Authentication and Lifecycle Management</em> (<a href="https://pages.nist.gov/800-63-3/sp800-63b.html">https://pages.nist.gov/800-63-3/sp800-63b.html</a>), and it's worth referencing in the process of implementing and leveraging digital identity. </p>
			<p>Inside the <em class="italic">NIST Special Publication 800-63B</em>, various controls and their proper implementations are detailed. This includes requirements for various "levels" of applications, depending on the information contained and processing performed. </p>
			<p>For example, a <em class="italic">Level 1</em> application is one that is considered low-risk and doesn't contain any private data or PII. As a result, only password authentication is required, with checks against commonly used passwords and <em class="italic">password length requirements</em> of 10 characters or more being suggested for users not utilizing <strong class="bold">multi-factor authentication</strong> (<strong class="bold">MFA</strong>). I highly <a id="_idIndexMarker990"/>recommend reading the publication for further guidance. </p>
			<p>The process for <a id="_idIndexMarker991"/>users of your software to reset their <em class="italic">forgotten passwords</em> should include MFA methods to prove their identity. A typical way to achieve this is to utilize a side-channel such as email and send a password reset email containing a unique link to the email address associated with the account. More information on the <a id="_idIndexMarker992"/>suggested process can be found in the <em class="italic">OWASP Forgot Password Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html</a>).  </p>
			<p>When we talk about session management and cookies, a few steps can be taken toward better security for our users. For example, expiry for the cookie should be set. Setting an <code>HttpOnly</code> attribute on a cookie prevents the cookie from being referenced and utilized in JavaScript code. Any transfer should be protected with TLS encryption to prevent man-in-the-middle attacks from grabbing a session ID, by setting the <code>Secure</code> attribute. </p>
			<p>Further reading on session management, web authentication, and <a id="_idIndexMarker993"/>access control can be found in the <em class="italic">OWASP Session Management Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html</a>). </p>
			<h2 id="_idParaDest-153"><a id="_idTextAnchor169"/>Enforce access controls</h2>
			<p>Similar to the previous <a id="_idIndexMarker994"/>point on digital identity, access control and authorization are about granting and revoking various permissions or privileges from users. By leveraging known paradigms, such as RBAC, for example, which we've gone into previously in this book, and by building out strong access controls up front that prevent vulnerabilities and flaws such as <em class="italic">access creep</em>, you're ensuring that your users have access to what they need, nothing more and nothing less. </p>
			<p>In order to enforce the access controls implemented, all requests must be passed through an access control check, with the default setting being deny. As a result, rules shouldn't be hardcoded, and instead should be dynamic based on the access level granted to the present user interacting with the software. Again, it's a matter of defense in depth. </p>
			<p>Finally, ensure you keep track of all events related to access with logging and pass those logs into security monitoring resources. We will discuss that later. </p>
			<p>Further reading can be <a id="_idIndexMarker995"/>found in the <em class="italic">OWASP Access Control Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html</a>).</p>
			<h2 id="_idParaDest-154"><a id="_idTextAnchor170"/>Protect data everywhere</h2>
			<p>The basis of the information <a id="_idIndexMarker996"/>security profession is to ensure the security of information. When we transfer or store data in our applications, we want to make sure that it's adequately protected from threats and take a risk-based approach to applying controls, with the ideas of least-privilege, defense in depth, and other approaches we've discussed in this book taken into consideration. </p>
			<p>In terms of data security, it includes data classification, where we apply a sensitivity level label to each piece of data, and map those labels to the adequate control requirements defined by you and your organization, based on regulations, reputational risk appetite, and confidentiality, integrity, and availability risk appetite. </p>
			<p>An easy win in terms of protecting data is to implement encryption for data in transit, generally TLS. This protects against <strong class="bold">man-in-the-middle</strong> and <strong class="bold">side-channel</strong> attacks occurring on either the communication between the user and the frontend application server or between the frontend application server and the backend. </p>
			<p>Encrypting the data at rest reduces the risk related to loss of confidentiality, but the complexity and technical skills required might slightly increase the potential for misconfiguration leading to a loss of availability. Encrypting data at rest is an important step, but must be carefully planned and implemented in order to be effective. </p>
			<p>Leveraging cryptographic libraries can be a good starting point, regardless of whether my horror story at the beginning of this chapter was entirely based on organizations experiencing an information security incident due to using a third-party cryptographic library. </p>
			<p>Secrets such as <a id="_idIndexMarker997"/>credentials, certificates, SQL passwords, and so on should be managed and protected as though they are the crown jewels of your application. Don't store them in plaintext in the databases, don't hardcode them, and rotate/de-provision the keys associated with users when they leave the organization. <em class="italic">Secret vaults</em> such as <strong class="bold">HashiCorp Vault</strong> offer the <a id="_idIndexMarker998"/>streamlined automation of this process but require a technical skillset. </p>
			<p>Further reading can be <a id="_idIndexMarker999"/>found at the <a id="_idIndexMarker1000"/>following <a id="_idIndexMarker1001"/>links: </p>
			<ul>
				<li><em class="italic">OWASP Transport Layer Protection Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html</a>)</li>
				<li><em class="italic">OWASP Cryptographic Storage Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html</a>)</li>
				<li><em class="italic">OWASP Password Storage Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html</a>)</li>
			</ul>
			<h2 id="_idParaDest-155"><a id="_idTextAnchor171"/>Implement security logging and monitoring</h2>
			<p>As we've previously spoken <a id="_idIndexMarker1002"/>about security monitoring in previous chapters, I don't believe I need to delve deeply into how that might <a id="_idIndexMarker1003"/>help your organization. The bottom line is: more information can help you and your colleagues detect security incidents with better accuracy and improved response times. </p>
			<p>You can increase the level of information that your organization's developed applications feed into your monitoring solution, but remember that sensitive information such as PII or confidential information is sometimes included in diagnostic and debugging information, and might need to be removed before reaching the monitoring solution. Additionally, make sure that your timestamps align across your nodes or your data will be inaccurate and difficult to use. </p>
			<p>In order to prevent any log forging or injection attacks, you should consider the encoding principles and validation exercises we mentioned in <em class="italic">#4</em> and <em class="italic">#5</em> of this list. Another protection against tampering is to set up access control and authorization principles for your logging solution. In order to avoid loss of availability, your solution should have some form of redundancy in the dataset, such as storage in multiple locations and backups. </p>
			<p>Further reading into how you might use security <a id="_idIndexMarker1004"/>logging and monitoring can be found in the <em class="italic">OWASP Logging Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html</a>). </p>
			<h2 id="_idParaDest-156"><a id="_idTextAnchor172"/>Handle all errors and exceptions</h2>
			<p>Ensuring your application is <a id="_idIndexMarker1005"/>resilient and able to handle errors and exceptions is an important property of ensuring all forms of the CIA triad. Bad error handling can lead to the disclosure of confidential or sensitive information, disruptions to the application's stability, or even modification to important data that you rely on for various monitoring purposes. </p>
			<p>Bad error messages can give a malicious actor more information than acceptable as well. Have a look at this signup page that I need to believe is a joke, or else I've lost all hope: </p>
			<div><div><img src="img/B16611_08_004.jpg" alt="Figure 8.4 – The dumbest signup page error message ever&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.4 – The dumbest signup page error message ever</p>
			<p>I can only guess the user decided to go with <code>hunter2</code> as the password after that error message. </p>
			<p>When we are creating errors, make <a id="_idIndexMarker1006"/>sure the user isn't able to get more information than they need, but give them enough to find the answers themselves or to reach out to a member of support for help. Internally, we want to log enough to help with support, testers, forensic investigations, and incident response teams. Remember that if team members from the software developing team actively collaborate with the security, testing, and business team members, it will lead to better software overall. </p>
			<p>Finally, good tests must be created in order to catch these exceptions before users do. Great testers, combined with some automated tooling for finding errors both statically and dynamically, will help reduce the overhead required for support, as well as reducing the risk of the application suffering a loss of one or more of the CIA triad principles. </p>
			<p>Further reading can be <a id="_idIndexMarker1007"/>found in the <em class="italic">OWASP Error Handling Cheat Sheet</em> (<a href="https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Error_Handling_Cheat_Sheet.html</a>). </p>
			<p>If you enjoy this topic as <a id="_idIndexMarker1008"/>much as I do, I think some further reading might be of interest to you, and so I've compiled a few different links to frameworks and <a id="_idIndexMarker1009"/>processes for you to investigate. These are useful in implementing security in the SDLC: </p>
			<ul>
				<li><strong class="bold">MS-SDL</strong>, the <strong class="bold">Microsoft Security Development Lifecycle</strong>: <a href="https://www.microsoft.com/en-us/securityengineering/sdl">https://www.microsoft.com/en-us/securityengineering/sdl</a></li>
				<li><em class="italic">NIST 800-160</em>, <em class="italic">Considerations for a Multidisciplinary Approach in the Engineering of Trustworthy Secure Systems</em>: <a href="https://csrc.nist.gov/publications/detail/sp/800-160/vol-1/final">https://csrc.nist.gov/publications/detail/sp/800-160/vol-1/final</a></li>
				<li>The Cybersecurity and Infrastructure <a id="_idIndexMarker1010"/>Security Agency's <strong class="bold">CLASP</strong>, or the <strong class="bold">Comprehensive Lightweight Application Security Process</strong>: <a href="https://us-cert.cisa.gov/bsi/articles/best-practices/requirements-engineering/introduction-to-the-clasp-process">https://us-cert.cisa.gov/bsi/articles/best-practices/requirements-engineering/introduction-to-the-clasp-process</a></li>
			</ul>
			<p>Okay, fine, we've gone through the SDLC, so now we can go into detail about how it might help us with assessing software next. </p>
			<h1 id="_idParaDest-157"><a id="_idTextAnchor173"/>Assessing software security </h1>
			<p>Moving forward, I would like to <a id="_idIndexMarker1011"/>discuss the methods we might utilize in order to assess the security of software. In previous chapters, we've looked into the importance of regular testing of software and systems, including <em class="italic">penetration testing</em> and <em class="italic">vulnerability scanning</em>, and the remediation of any of the findings. I've encouraged the implementation of <em class="italic">configuration management systems</em> that can help keep your organization's assets up to date, and <em class="italic">monitoring solutions</em> to uncover performance issues, misuse, errors, or malicious activity. I've also talked about <em class="italic">resilience and redundancy</em>, and how expensive it might be for each hour that your organization loses access to one of their systems. </p>
			<p>Now, with that all said, if we're going to go deeper, I think it's relevant to split this topic into two sections because the methodologies and approaches are different depending on who has ownership of the software, taking into consideration the <em class="italic">cloud operating model</em> and the shared responsibilities <a id="_idIndexMarker1012"/>related to utilizing <strong class="bold">Software-as-a-Service</strong> (<strong class="bold">SaaS</strong>) products. </p>
			<p>On one hand, we have third-party vendors who develop and sell software to companies. Their focus is creating a tool that is valuable to your organization, such as <strong class="bold">Customer Relationship Management</strong> (<strong class="bold">CRM</strong>) systems, HR <a id="_idIndexMarker1013"/>software, productivity tools, web analytics software, cloud storage solutions, and so on. </p>
			<p>On the other hand, we can also <a id="_idIndexMarker1014"/>leverage an in-house development team to create software for our organization to either solve problems that aren't currently offered by a vendor or to save money based on the cost presented by the current offering from third parties. Additionally, we can leverage outsourced development teams to create our in-house software or leverage the power and convenience of open source software. </p>
			<p>Let's delve into how to improve the security of third-party vendor software. </p>
			<h2 id="_idParaDest-158"><a id="_idTextAnchor174"/>Reducing the risk from software developed by a third-party vendor</h2>
			<p>As we have now covered the <a id="_idIndexMarker1015"/>various controls and processes that can be put into place to reduce the likelihood of software being created with vulnerabilities in the code itself, it must be noted that many of your organization's software solutions are going to be either purchased from a third party or pulled from an open source software repository resource such as the public repositories on GitHub. </p>
			<p>Policies and procedures need to be put into place to ensure that you have visibility on the procurement process, regardless of which scenario is occurring, and have oversight on the software assets being utilized in your estate. </p>
			<p>Here's the issue: what can you do about it? When we're looking at the major software that I see used by nearly every organization, such as those developed and sold by Microsoft, Salesforce, Atlassian, and so on, how can you ensure they're employing the appropriate controls for their solution, as well as following an SDLC approach? </p>
			<h3>Cloud-based software</h3>
			<p>The massive paradigm shift we've seen over the past decade toward the SaaS model has increased the pace of implementin<a id="_idIndexMarker1016"/>g new software into an organization, where a user is likely accessing the solution through their web browser. This model for using software has led to the responsibility of handling servers and databases shifting away from the customer and onto the vendor. </p>
			<p>That isn't to say we absolve ourselves of any responsibility when it comes to the privacy and security of the data processed and stored in these SaaS applications, however; in fact, it is absolutely our responsibility as customers to ensure that the solution we choose is <em class="italic">secure enough</em> for our organization. </p>
			<p>As I mentioned previously, it might be difficult to arrange for your own testing to be performed on the infrastructure and software currently being offered by your SaaS vendors. The reasoning behind that is simple: that type of testing activity could present a level of risk that is deemed unacceptable by the vendor, as you could accidentally disrupt their service for millions of other users. You can't perform any tests on infrastructure without permission either, or you'll be putting yourself and your organization at risk for legal liability. </p>
			<p>So, how can we go about asking our vendors about their software's security? </p>
			<h3>Understanding third-party software risk</h3>
			<p>We've previously mentioned in this <a id="_idIndexMarker1017"/>book that we might – from the perspective of being an information security professional working at a software vendor – create an <em class="italic">information security whitepaper</em> to detail security paradigms and controls utilized by your organization. With that said, now that you're the potential customer, how do you ask the appropriate questions to ensure the software your organization is in the process of procuring is appropriately secure and controls are in line with the level of risk? </p>
			<p>Well, we perform <em class="italic">due diligence</em> and produce <em class="italic">legal documentation</em> defining liability and the agreements between your organization and the vendor. I already covered this in the preceding thrilling section where we talked about Latin terms found in contract law… and how could you not remember that? </p>
			<p>In these agreements, you might be able to arrange for documentation from the latest penetration test performed on the software to be shared for your review, or for your own security team to be able to perform their own testing as a form of due diligence. It all depends on what both parties are willing to agree to and what will give you the assurance required to help meet your level of risk tolerance. As we've said, we have to be aware that it's not always <a id="_idIndexMarker1018"/>possible to penetration test or even to vulnerability scan a software solution, but even if you were to find a vulnerability in a software solution that has been developed by a third party, how are you going to notify the vendor, and do you expect them to fix the vulnerability in a timely manner? </p>
			<p>In your legal documentation, you might also want to try and define the <em class="italic">SLA</em>s and procedures for the remediation of vulnerabilities, but we still haven't covered how to get a better look into our vendors' security posturing. How do we know that they're handling security in a way that we deem is acceptable? </p>
			<p>In this circumstance, we often send a set of documents known oftentimes as the <strong class="bold">Vendor Security Assessment Questionnaire</strong> (<strong class="bold">VSAQ</strong>) to <a id="_idIndexMarker1019"/>software vendors for them to complete before an agreement is made. Most organizations send out some Excel spreadsheets with rows and rows of hundreds of questions, along with drop-down or free-text cells to input answers, and/or evidence and justifications for answering the way they did. If you've ever worked as a security professional at an organization that develops software to be offered to customers, you've had to fill these assessment spreadsheets out, and they're never the same, unfortunately. Google tried their best to standardize these questions into an open source, interactive, and dynamic solution on their GitHub page (<a href="https://github.com/google/vsaq">https://github.com/google/vsaq</a>), but from what I've seen, it still hasn't caught on. If we can make this happen, it would really save us all a load of time and effort, while delivering a high-quality result. Can we please make this happen? </p>
			<p>Upon receiving the completed VSAQ back, we shall document the residual risk that is unmitigated by the vendor, and measure that residual risk to see whether it's below the threshold level of risk acceptance or not. In the event that the risk is above the acceptable level, we need to make the decision to either mitigate it, accept it, or avoid it. I should hope, considering we're nearly at the end of the book now, that it's all awfully familiar at this point.  </p>
			<p>Once you've completed your due diligence and communicated your findings to the business decision-makers, and the <a id="_idIndexMarker1020"/>agreement is secured and finalized, the implementation of the software will begin. It might be on-prem installed software, or it might be cloud-based SaaS. </p>
			<h3>SDLC due diligence for software vendors</h3>
			<p>Since we covered the various steps and requirements for an SDC, you now know the basics, and you have much of the <a id="_idIndexMarker1021"/>information you need to ensure you can perform the appropriate due diligence surrounding their development life cycle.</p>
			<p>First of all, it's important to not only ask whether the vendor follows processes surrounding the SDLC, but also to have them detail how exactly they do so. You could also ask for evidence as a validation method. If they answer "no," then you need to highlight the risks associated with utilizing this software that has been developed without regard to the SDLC to the appropriate decision-makers in your organization. </p>
			<h3>Penetration testing and bug bounties</h3>
			<p>We might be able to arrange to <a id="_idIndexMarker1022"/>penetration test the software, but if it's a SaaS, as we've said previously, don't get your hopes up, as most vendors will not allow it. Besides, performing that sort of in-depth, technical activity on all potential vendors will become costly for your organization very quickly. A novel solution for both vendors and customers that has recently become popular is the implementation of a <a id="_idIndexMarker1023"/>bug bounty program, where a software vendor opens their product up to be penetration tested by bug bounty hunters, who are trying to exploit security vulnerabilities for a reward offered by the vendor. Companies such as <a id="_idIndexMarker1024"/>Bugcrowd (https://www.bugcrowd.com/) and HackerOne (https://www.hackerone.com/) are offering organizations <a id="_idIndexMarker1025"/>such as yours (and your vendors) the opportunity to have their software "hacked" by security professionals globally. If your vendor has a bug bounty program, it may bode well for where they stand in their security posture, especially if you are able to review the bugs that have been found and the current open bounties. </p>
			<p>If the vendor claims to be secure but doesn't want to provide penetration test reports and doesn't take part in a bug bounty program, you might want to ask them how they process and prioritize <a id="_idIndexMarker1026"/>vulnerabilities that are coming from their penetration tests, or which tools they use for DAST, SAST, or dependency scans. Use your <a id="_idIndexMarker1027"/>knowledge of the landscape to see whether they know what they're talking about, and try your best to get evidence where you can. It is the security of your organization on the line, after all. </p>
			<h3>On-prem third-party software</h3>
			<p>When we're looking at software <a id="_idIndexMarker1028"/>that is installed onto your company's servers or endpoints, we have a few simple mitigations that we can employ to ensure your environment's security isn't compromised due to a vulnerability in this software. We want to reduce our attack surface by following the foundational concept of least-privilege we've covered. </p>
			<p>"<em class="italic">Sorry, our software needs to run as admin</em>," the vendor tells you. </p>
			<p>Your first question back to them should be "why?". You know too much to be told that and not question it further. Find out what the software does and why it needs admin access, and find out whether there's a way to mitigate against that risk. </p>
			<p>Furthermore, we've discussed vulnerability scanning at your organization in previous chapters, and your new on-prem software should be included in the scope. If you find a vulnerability through these means, it is worth starting a dialogue with the vendor to understand the vulnerability and to see about patching it. They might react poorly as a result, but in the near future, I am absolutely positive that it won't just be you that pushes back about bad security in their software. Together we can move mountains and force vendors to create software that follows best practices. </p>
			<p>What about on-prem software that is open source? </p>
			<h4>Open source software</h4>
			<p>When we <a id="_idIndexMarker1029"/>talk about <a id="_idIndexMarker1030"/>open source software, what we're generally referring to is <strong class="bold">Free and Open Source Software</strong> (<strong class="bold">FOSS</strong>). With FOSS, you're able to download software that has been created and hosted on various platforms such as GitHub or SourceForge in a way that allows the potential user to actually see the underlying code. </p>
			<p>The idea behind open source is that we get software that is transparent, peer-reviewed, and free created by people looking to solve technical (or societal) issues without further incentive to do so apart from altruism and potentially demonstrating mastery. </p>
			<p>With that said, the events <a id="_idIndexMarker1031"/>surrounding Heartbleed, which we investigated earlier in this chapter, were a situation stemming from the use of insecure open source software being widely utilized. How can we ensure the appropriate mitigations have been implemented during the development process of the open source tools and pieces of code – also <a id="_idIndexMarker1032"/>known as <strong class="bold">snippets</strong> – that are either currently being used at your organization or are under consideration? </p>
			<p>Additionally, we need to <a id="_idIndexMarker1033"/>remember that many of our vendors are leveraging open source software in the process of developing their proprietary software. Let's keep that in mind when we're developing our VSAQs for the due diligence process.</p>
			<p>On the plus side, we have the ability to review the code. There should be requirements in our information security policies to ensure that the same security steps that we have put into place for our own software development are also applied to the open source software we use. This means performing dependency checks, SAST, DAST, vulnerability scans, and so on. Oftentimes, we'll create a security pipeline that automates the defined processes and security scanning steps required on any code or software that is deemed in scope. </p>
			<h2 id="_idParaDest-159"><a id="_idTextAnchor175"/>Improving the security of in-house software</h2>
			<p>Let's say in-house software can include software that <a id="_idIndexMarker1034"/>has been developed by either your organization's in-house development team or an outsourced development team, as well as the open source software that your organization is leveraging. Although that open source software was (likely) developed by a third party, you have the ability to treat it as in-house-developed code and put it through the same assurance processes. </p>
			<p>I would like to discuss how we might implement security controls into development environments and deployment pipelines to ensure any risks have been identified and actioned before the code reaches the <em class="italic">production stage</em>. </p>
			<p>Both in-house and outsourced development teams should be able to follow your direction when it comes to the <a id="_idIndexMarker1035"/>policies you define to increase the security of your organization's developed software. Sometimes, outsourced teams have their own processes and solutions in place to provide the same level of assurance that you require, and other times you might need to reach an agreement to mitigate against any gaps. </p>
			<p>With that, let's look at ways we can improve the security of our in-house software. </p>
			<h3>Software development life cycle</h3>
			<p>First, we want to implement the <a id="_idIndexMarker1036"/>controls previously discussed in this chapter for the secure SDLC. These policies, procedures, and tools are able to ensure the efficient and secure development of high-quality software by your teams. You can design the SDLC to reflect your organization's <em class="italic">risk tolerance</em> and the idiosyncrasies of your existing processes, but staying in line with the general ideologies will help you in your quest. </p>
			<p>With that, I don't believe it's necessary to cover all of the steps we've already covered earlier in this chapter, so instead, I would like to go into how we might implement practical controls to achieve the high-level goals we've previously covered. </p>
			<h3>Code repositories</h3>
			<p>Your organization likely <a id="_idIndexMarker1037"/>uses a code repository solution to store and version-control any developed software. Examples of <em class="italic">code repositories</em> could include GitHub, Bitbucket, or GitLab, among others. </p>
			<p>Inside these tools, we have various available features and controls that ensure our requirements for the SDLC are met. For example, <strong class="bold">issue trackers</strong> allow a <a id="_idIndexMarker1038"/>transparent discussion between developers, product team members, and other stakeholders on software bugs, feature requests, vulnerability discoveries, and so on. These issue trackers allow teams to estimate requirements, assign priorities, and give complexity scores to each issue, to help organize how they might be handled. </p>
			<p>There are what are known as <strong class="bold">branches</strong>, which <a id="_idIndexMarker1039"/>allow developers to actively develop and make changes to software in a development context, without affecting the main branch, which is used for production, or even potentially a development branch for the current sprint. You want to protect this branch from change without various forms of sign-off, which you can arrange to include code reviews, testing, and ensuring the merge is following the separation-of-duties and two-man principles. </p>
			<p>Each change to the code is <a id="_idIndexMarker1040"/>documented and attributed to the associated software engineer, allowing transparent audit processes and clear documentation of all approvals. All commits can be signed using public-key cryptography, providing non-repudiation and integrity for each engineer's incremental contribution to the codebase. </p>
			<p>Additionally, if we take into consideration the ideology of infrastructure as code that we previously covered, it's possible to store the configuration files for your organization's servers and tools in repositories and apply the same level of scrutiny as you would over the software that is being developed. </p>
			<h3>DevSecOps pipelines</h3>
			<p><strong class="bold">Continuous Integration and Continuous Delivery</strong> (<strong class="bold">CI/CD</strong>) pipelines <a id="_idIndexMarker1041"/>provide the automation flow aspect to ensuring only software that meets the specified requirements is able to be <a id="_idIndexMarker1042"/>deployed to the next stage of the process, and by relying on the pipeline you are able to reduce developer and systems <a id="_idIndexMarker1043"/>administrator access down to least-privilege, meaning they are not able to access or change production systems without following the pipeline and getting appropriate approval. </p>
			<p>Quite often, these pipelines are related to the term <strong class="bold">DevSecOps</strong>, in which we bake security into the DevOps life cycle through automation and pipelines. </p>
			<p>Let's imagine this pipeline flow for your organization's software development process: </p>
			<ol>
				<li>A software developer uses their SSH key to access a project's Git repository, creates a "feature branch" off from the development code, and clones the code to their workstation for local development. </li>
				<li>Their <strong class="bold">Interactive Development Environment</strong> (<strong class="bold">IDE</strong>) references secure coding paradigms, as <a id="_idIndexMarker1044"/>well as performing regex checks for plaintext secrets and passwords, immediately <a id="_idIndexMarker1045"/>informing the developer if any flaws are found in real time, allowing them to remediate before committing their code back to the repository and triggering a pipeline process. </li>
				<li>The developer makes a <a id="_idIndexMarker1046"/>change and attempts to commit that code back to the Git branch they created. Their access is checked to ensure they're allowed to do so, their change is logged, and differences are highlighted in the Git solution. </li>
				<li>The CI pipeline runs and performs the following checks: <p>- A <em class="italic">dependency scanner</em> assesses the risk profile of any imported software. </p><p>- <em class="italic">Static code analysis</em> is performed by a <em class="italic">SAST</em> to check for the code's quality and any security risks. </p><p>- A <em class="italic">secrets checker</em> looks for secrets and passwords stored in the code. </p><p>- A <em class="italic">container auditor</em> checks for any vulnerabilities in the defined <em class="italic">infrastructure as code</em>. </p><p>- An ephemeral version of the <a id="_idIndexMarker1047"/>updated software is deployed into a test environment, and a <em class="italic">DAST</em> performs the appropriate checks on the software, looking for errors, security vulnerabilities, and performance issues. </p><p>- If all automated systems pass, then another developer is notified via email or chat, and they perform a <em class="italic">code review</em>. </p><p>- If the code review is <a id="_idIndexMarker1048"/>approved, a tester is <a id="_idIndexMarker1049"/>notified, and the feature is tested by a human. </p><p>- If all steps are <a id="_idIndexMarker1050"/>approved, the <em class="italic">code is merged</em> and the <em class="italic">CD pipeline</em> runs to implement the change into the next environment. </p></li>
			</ol>
			<p>This process requires careful implementation and defined processes and expectations for the various team members involved but could lead to a streamlined, secure development process with automation at its core. </p>
			<h1 id="_idParaDest-160"><a id="_idTextAnchor176"/>Summary</h1>
			<p>In this chapter, we covered the highly interesting topic of improving the security of software and highlighted various methodologies we could use to ensure the software used inside our organization's estate is "secure enough" from a risk perspective. </p>
			<p>To begin the chapter, we went into a few universal paradigms for software security, including the SDLC, and the steps required for that process to be an effective undertaking. </p>
			<p>After that, we highlighted that we put a lot of faith into software systems developed by third parties, especially when the processes under which they are developed are opaque, such as when we procure software from a vendor that doesn't disclose their approach when it comes to security. We delved into how we might better understand the risk presented by third-party software, either as proprietary solutions or in the context of the open source model. </p>
			<p>From that, we went into how we can utilize our knowledge of the SDLC to produce better software in-house, with testing and automation at the heart of the solution to ensure scalability and efficiency in finding vulnerabilities, which could lead to a loss of confidentiality, integrity, or availability. </p>
			<p>Overall, what we learned from this chapter was what to look for when you are establishing your requirements, policies, and procedures surrounding software development and use in your organization. With this knowledge, you're able to accurately measure the risk presented and respond to any residual risk that is deemed to be above the acceptable risk tolerance. </p>
			<p>With that, you have now completed this book. Thank you so much for taking the time to read it! I hope you had fun and learned a few things along the way. If I was able to help you with your organization's security posture, I am delighted. </p>
			<p>I would like to take this opportunity to thank my wife, Helen, for her support and care along the way. Furthermore, I would like to thank all of the members of the Packt team who have supported me in the creation of this book, from beginning to end. </p>
		</div>
	</body></html>