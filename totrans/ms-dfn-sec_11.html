<html><head></head><body>
		<div><h1 id="_idParaDest-206"><a id="_idTextAnchor213"/><em class="italic">Chapter 9</em>: Deep Diving into Physical Security</h1>
			<p><em class="italic">"With the right tools and a few seconds of physical access, all bets are off… "</em></p>
			<p><em class="italic">– Darren Kitchen – founder of Hak5</em></p>
			<p>Physical security is often overlooked, and as cybersecurity professionals, we normally avoid this responsibility. However, the truth is that a breach in physical security can expose our systems, and that poses a <em class="italic">huge</em> risk to our infrastructure and data. </p>
			<p>Therefore, in this chapter you are going to learn <em class="italic">the most dangerous vulnerabilities in terms of physical security</em>, but also a set of controls and methods to reduce those risks.</p>
			<p>Here are the details of the topics that we will be covering in this chapter: </p>
			<ul>
				<li>A deep dive into the most dangerous tools and attacks in physical security, including the following: the powerful LAN Turtle, the stealthy Plunder Bug LAN Tap, the dangerous Packet Squirrel, the portable Shark Jack, the amazing Screen Crab, the advanced Key Croc, and other USB threats</li>
				<li>An exploration of the risks and costs associated with equipment theft (and why you must prevent them)</li>
				<li>A definition of the types of physical control available </li>
				<li>A list of best practices related to access controls</li>
				<li>An overview of a very cool technology for visitors control – auto-expiring badges</li>
				<li>An introduction to your best ally in physical security: the clean desk policy</li>
				<li>A review of the best practices when conducting physical security audits</li>
			</ul>
			<h1 id="_idParaDest-207"><a id="_idTextAnchor214"/>Technical requirements </h1>
			<p>You don't need any extra software or hardware to enjoy this chapter, however, it would be great if you can test the devices that we review here so you can get familiar with them (the better you know the enemy's tools, the better you can defend against them).</p>
			<p>So, here is the link to the web page where you can find most of the devices listed in this chapter: <a href="https://hak5.org/">https://hak5.org/</a>.</p>
			<h1 id="_idParaDest-208"><a id="_idTextAnchor215"/>Understanding physical security and associated threats</h1>
			<p>We often invest a huge amount of time to secure our virtual environment, however, an attacker with physical access to our systems can easily bypass many security mechanisms and <a id="_idIndexMarker965"/>systems to get easy access to our systems and data.</p>
			<p>Therefore, it would be great for you to be familiar with the most common vulnerabilities or threats related to physical security that may impact your organization.</p>
			<h2 id="_idParaDest-209"><a id="_idTextAnchor216"/>The powerful LAN Turtle</h2>
			<p>This seemingly innocent object enables an attacker to get remote access toolkits and man-in-the-middle <a id="_idIndexMarker966"/>attacks on a single device. The device looks like a generic USB to Ethernet adapter, so once it is connected, it would be <a id="_idIndexMarker967"/>difficult to spot it.</p>
			<p>The attack is very simple but ingenious. As shown in the following figure, the device stays in the middle of the target computer and the network, enabling access to the attacker to perform a plurality of remote attacks against the network and the computer:</p>
			<div><div><img src="img/Figure_9.1_B16290.jpg" alt="Figure 9.1 – LAN Turtle attack&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.1 – LAN Turtle attack</p>
			<p>To perform the <a id="_idIndexMarker968"/>attacks, the attacker can connect to <a id="_idIndexMarker969"/>the LAN Turtle through <strong class="bold">SSH</strong> to select and execute a plurality of preconfigured attacks.</p>
			<div><div><img src="img/Figure_9.2_B16290.jpg" alt="Figure 9.2 – LAN Turtle modules&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.2 – LAN Turtle modules</p>
			<p>As shown in the preceding figure, the LAN Turtle comes with a set of powerful modules preloaded that enables an attacker to set up a reverse shell for persistent remote access, perform DNS spoofing attacks, execute Metasploit payloads, and more!</p>
			<h2 id="_idParaDest-210"><a id="_idTextAnchor217"/>The stealthy Plunder Bug LAN Tap</h2>
			<p>The LAN Tap is a <a id="_idIndexMarker970"/>very small (but powerful) device that enables <a id="_idIndexMarker971"/>an attacker to capture all packets going through your network.</p>
			<p>It comes with a USB Type-C connection to download in real time all <code>*.pcap</code> files to a smartphone for later analysis.</p>
			<p class="callout-heading"><code>pcap</code> files</p>
			<p class="callout">This is a file format <a id="_idIndexMarker972"/>used to capture network traffic and is widely used by sniffing tools such as <code>pcap</code> file, which <a id="_idIndexMarker974"/>makes this type of attack even more dangerous.</p>
			<p>As shown in the following figure, an attacker can discretely connect this device between two endpoints to record all activity passing through the cable, which highlights the importance of strong physical security in avoiding this kind of threat in your network:</p>
			<div><div><img src="img/Figure_9.3_B16290.jpg" alt="Figure 9.3 – The Plunder Bug LAN Tap&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.3 – The Plunder Bug LAN Tap</p>
			<p>Additionally, the attacker can also analyze these packets in real time using a packet analyzer such as Wireshark.</p>
			<h2 id="_idParaDest-211"><a id="_idTextAnchor218"/>The dangerous Packet Squirrel</h2>
			<p>This small, great <a id="_idIndexMarker975"/>gadget has similar features to the famous LAN Turtle – remote access, man-in-the-middle attacks, packet sniffing, secure <a id="_idIndexMarker976"/>tunneling, and network recon. The main differences are in the hardware (interfaces and appearance), as shown in the following figure, and software (modules versus payloads), explained in detail next:</p>
			<div><div><img src="img/Figure_9.4_B16290.jpg" alt="Figure 9.4 – LAN Turtle and Packet Squirrel hardware comparison&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.4 – LAN Turtle and Packet Squirrel hardware comparison</p>
			<p>Let's see those differences in detail:</p>
			<p><strong class="bold">Modules</strong> are downloaded <a id="_idIndexMarker977"/>to the device <em class="italic">over the air</em> and come with their own interface for configuration. </p>
			<p><strong class="bold">Payloads</strong> are downloaded to the device <em class="italic">manually</em>, or via an updater app, as one or more text files. Configuring a payload consists of editing the text file and changing values. Multiple payloads may be <a id="_idIndexMarker978"/>carried and assigned to a switch button, however, only one payload may run at once.</p>
			<h2 id="_idParaDest-212"><a id="_idTextAnchor219"/>The portable Shark Jack</h2>
			<p>This is a super-portable, network-attacking tool that enables an attacker to connect to a network port and <a id="_idIndexMarker979"/>instantly run advanced recon, exfiltration, attack, and <a id="_idIndexMarker980"/>automation payloads.</p>
			<p>Out of the box, it's armed with an ultra-fast <strong class="bold">nmap</strong> payload that provides quick and easy network reconnaissance <a id="_idIndexMarker981"/>capabilities. It uses a very simple scripting language plus an attack/arming switch, which makes this tool a serious threat to the security of your network. </p>
			<p>The following figure shows the <strong class="bold">Shark Jack</strong> hardware features, but also gives you an idea about how portable it is and how easy it is for an attacker to carry and connect it:</p>
			<div><div><img src="img/Figure_9.5_B16290.jpg" alt="Figure 9.5 – Shark Jack hardware&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.5 – Shark Jack hardware</p>
			<p>But there is even more – the Shark Jack has a cloud-based, remote access tool that an attacker can leverage to retrieve the data in <em class="italic">real time!</em></p>
			<h2 id="_idParaDest-213"><a id="_idTextAnchor220"/>The amazing Screen Crab</h2>
			<p><em class="italic">This is probably one of the </em><em class="italic"><a id="_idIndexMarker982"/></em><em class="italic">coolest hacking devices ever created.</em> This is <em class="italic">basically an HDMI man-in-the-middle </em><em class="italic"><a id="_idIndexMarker983"/></em><em class="italic">device</em> that will send a live stream of <a id="_idIndexMarker984"/>a video of the victim's machine.</p>
			<p>This means that (as shown in <em class="italic">Figure 9.6</em>) an attacker with physical access to your meeting room can connect this device to the HDMI projector and <em class="italic">grab all confidential information displayed on the screen. This allows them to capture information such as client data, contracts, bids, corporate secrets, intellectual capital, and more</em>:</p>
			<div><div><img src="img/Figure_9.6_B16290.jpg" alt="Figure 9.6 – Screen Crab attack&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.6 – Screen Crab attack</p>
			<p>In case the room is <a id="_idIndexMarker985"/>isolated with no internet connection, the device comes with a <a id="_idIndexMarker986"/>micro-SD slot to save the recordings or screenshots there, as shown in the following figure:</p>
			<div><div><img src="img/Figure_9.7_B16290.jpg" alt="Figure 9.7 – Screen Crab hardware&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.7 – Screen Crab hardware</p>
			<p>One important thing to consider (from a defensive security point of view) is that this device needs power to work (which can be provided by USB), therefore, blocking USB ports on fixed devices in meeting rooms (such as monitors and TVs) may be a good practice to reduce risks in such environments.</p>
			<h2 id="_idParaDest-214"><a id="_idTextAnchor221"/>The advanced Key Croc</h2>
			<p>A hardware-based keylogger is probably the most common example of a physical cyber-attack. A hardware <a id="_idIndexMarker987"/>keylogger is very compact and can be easily connected and disguised, which <a id="_idIndexMarker988"/>makes it an extremely dangerous threat.</p>
			<p>But there is an even more dangerous device called the <strong class="bold">Key Croc</strong> – more dangerous because this <a id="_idIndexMarker989"/>powerful keylogger comes packed with features such as the following:</p>
			<ul>
				<li><strong class="bold">Human Interface Device</strong> (<strong class="bold">HID</strong>) emulation</li>
				<li>Predetermined HID <a id="_idIndexMarker990"/>keystroke injection</li>
				<li>Remote <a id="_idIndexMarker991"/>submissions of HID keystroke injection</li>
				<li>A <em class="italic">listener</em> to trigger the keystroke when a predetermined action is performed</li>
				<li>Ability to send data directly to the cloud in near real time</li>
				<li>Execution of payloads (from a huge library of payloads already available)</li>
				<li>Remote access capabilities through SSH</li>
				<li>Loaded with Metasploit to execute remote attacks and exploitations</li>
				<li>Transforms into a USB storage device with a single button</li>
			</ul>
			<div><div><img src="img/Figure_9.8_B16290.jpg" alt="Figure 9.8 – The Key Croc&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.8 – The Key Croc</p>
			<p>As shown in the preceding figure, this device has very powerful hardware (a quad-core processor, 512 MB of RAM, and 8 GB of internal memory), which represents a big security threat if connected to any corporate system or computer.</p>
			<h2 id="_idParaDest-215"><a id="_idTextAnchor222"/>USB threats</h2>
			<p>As seen in <a href="B16290_02_Final_JC_ePub.xhtml#_idTextAnchor035"><em class="italic">Chapter 2</em></a>, <em class="italic">Managing Threats, Vulnerabilities, and Risks</em>, there are many malicious USB HID devices that when connected can be used to execute a plurality of attacks. </p>
			<p>As mentioned <a id="_idIndexMarker992"/>in that chapter, most computer systems are vulnerable to these attacks because they leverage the <em class="italic">inherent trust of HID drivers</em> and therefore <a id="_idIndexMarker993"/>are not detected by most antivirus systems or even USB OS restrictions (as those apply to mass storage devices and not HIDs).</p>
			<p>Some examples <a id="_idIndexMarker994"/>of those USB devices are the following:</p>
			<ul>
				<li><strong class="bold">USB Rubber Ducky</strong></li>
				<li><strong class="bold">Bash Bunny </strong></li>
				<li><strong class="bold">O.MG Keylogger Cable</strong></li>
			</ul>
			<div><div><img src="img/Figure_9.9_B16290.jpg" alt="Figure 9.9 – The Bash Bunny&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.9 – The Bash Bunny</p>
			<p>In <a href="B16290_02_Final_JC_ePub.xhtml#_idTextAnchor035"><em class="italic">Chapter 2</em></a>, <em class="italic">Managing Threats, Vulnerabilities, and Risks</em>, we learned how to protect our environment against those <em class="italic">USB threats</em>. However, let's do a quick recap:</p>
			<ul>
				<li>Use <strong class="bold">Windows Defender</strong> to detect <a id="_idIndexMarker995"/>USB HID threats.</li>
				<li>Implement <a id="_idIndexMarker996"/>a script to detect scripted attacks (such as <strong class="bold">DuckHunt</strong>).</li>
				<li>Install a <strong class="bold">USB physical blocker</strong> to prevent the connection of USB devices.</li>
				<li>Create <em class="italic">proprietary software</em> to block suspicious USB devices based on USB descriptors or metadata such as manufacturer, model, type, and so on.</li>
				<li>Avoid leaving USB ports exposed in customer service machines (easily accessible by external people).</li>
			</ul>
			<p>But above all these mechanisms, the very best protection against these attacks is to prevent the access of external people to controlled corporate spaces (such as meeting rooms, cubicles, offices, and so on). We will cover these physical protection mechanisms in the next section – <em class="italic">Physical security mechanisms.</em></p>
			<h2 id="_idParaDest-216"><a id="_idTextAnchor223"/>Equipment theft</h2>
			<p>Sometimes when performing a high-level risk analysis, non-technical teams may think only in terms of <a id="_idIndexMarker997"/>the cost of replacing a compromised device, and therefore during a simple analysis, they may decide not to invest in physical <a id="_idIndexMarker998"/>security because it is higher than the cost of replacement. However, in these situations you need to show them it is not only about the value of the device (hardware), but also other, more expensive associated risks. These could be some of the following:</p>
			<ul>
				<li>The cost of <em class="italic">losing the data on that device</em> (due to the lack of an up-to-date backup)</li>
				<li>The cost of <em class="italic">exposing confidential data</em></li>
				<li>The cost of <em class="italic">exposing client data</em></li>
				<li>The impact on the <em class="italic">availability of services</em> (for example, if the device was hosting a system, or a system administrator may momentarily lose the ability to support a <a id="_idIndexMarker999"/>production system)</li>
				<li>The impact on <em class="italic">delivery dates</em> (some project deliverables or code was lost with the device)</li>
				<li>The cost of <em class="italic">setting up a device</em> (setting up devices with some specific tool may bring additional costs in terms of hours required by IT and the loss of productivity of the device owner)</li>
				<li>Vulnerability to <em class="italic">offline cracking attacks</em> (an attacker can perform offline attacks that <a id="_idIndexMarker1000"/>are faster and easier over stolen devices)</li>
			</ul>
			<div><div><img src="img/Figure_9.10_B16290.jpg" alt="Figure 9.10 – Online versus offline password cracking time&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.10 – Online versus offline password cracking time</p>
			<p>As shown in the preceding figure, the difference between the online and offline password cracking time is significant, changing an attack scenario from unfeasible to realistic.</p>
			<h2 id="_idParaDest-217"><a id="_idTextAnchor224"/>Environmental risks</h2>
			<p>Just a reminder that you need to ensure your systems, servers, and backups are protected against any <a id="_idIndexMarker1001"/>possible threat posed by environmental <a id="_idIndexMarker1002"/>risks such as hurricanes, floods, earthquakes, and more.</p>
			<p>Now, let's jump into some mechanisms and tools that you can leverage to improve the physical security of your company.</p>
			<h1 id="_idParaDest-218"><a id="_idTextAnchor225"/>Physical security mechanisms</h1>
			<p>There are several mechanisms <a id="_idIndexMarker1003"/>and controls that you can leverage to reduce the risks related to physical security, and they are normally divided into the following categories:</p>
			<ul>
				<li><strong class="bold">Detective</strong>: These <a id="_idIndexMarker1004"/>are the types of controls used to <em class="italic">detect intrusions</em> – for example, a security camera, an alarm, movement sensors, and so on.</li>
				<li><strong class="bold">Preventive</strong>: These are designed to <em class="italic">prevent someone from entering</em> a secure or restricted area – for example, fences, badge-controlled doors, pin-controlled doors, face <a id="_idIndexMarker1005"/>recognition systems, and so on.</li>
				<li><strong class="bold">Deterrent</strong>: These are controls that will <em class="italic">discourage an attacker</em> from accessing a restricted <a id="_idIndexMarker1006"/>area – for example, a security guard, an alarm, or, as shown in the following figure, a combination of controls:</li>
			</ul>
			<div><div><img src="img/Figure_9.11_B16290.jpg" alt="Figure 9.11 – Deterrent control sample&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.11 – Deterrent control sample</p>
			<p>Let's now review <a id="_idIndexMarker1007"/>some technologies to enhance our physical security:</p>
			<ul>
				<li><strong class="bold">Access control</strong>: Here are some <a id="_idIndexMarker1008"/>of the best practices related to access control:</li>
			</ul>
			<div><div><img src="img/Figure_9.12_B16290.jpg" alt="Figure 9.12 – Best practices related to access control&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.12 – Best practices related to access control</p>
			<ul>
				<li><strong class="bold">Visitor's access control – auto-expiring badges</strong>: This is a very interesting technology <a id="_idIndexMarker1009"/>for the <em class="italic">secure management of visitors</em>.</li>
			</ul>
			<div><div><img src="img/Figure_9.13_B16290.jpg" alt="Figure 9.13 – Auto-expiring badge sample&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.13 – Auto-expiring badge sample</p>
			<p>The technology is <a id="_idIndexMarker1010"/>based on a special paper that after 24 hours will show the word <em class="italic">VOID</em> to invalidate a badge, as shown in <em class="italic">Figure 9.13</em>.</p>
			<p>This will prevent someone from using an expired badge to get physical access, as it will clearly show that it is no longer valid.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Avoid using a universal badge to access all areas of a building. Instead, sensitive rooms such as IT rooms should have a different access mechanism – for example, a different badge, a keypad, biometrics, or a combination of these.</p>
			<p>Now it's time to see some extra tips and good practices to help you become a master in <em class="italic">physical security</em>.</p>
			<h1 id="_idParaDest-219"><a id="_idTextAnchor226"/>Mastering physical security</h1>
			<p>As seen before, the main security mechanisms in physical security are based on <em class="italic">preventing non-authorized users from gaining physical access to your systems</em>. </p>
			<p>However, there are some additional mechanisms that you can leverage <em class="italic">to enhance your physical defensive security</em>. These additional mechanisms and strategies are discussed in the following sections.</p>
			<h2 id="_idParaDest-220"><a id="_idTextAnchor227"/>Clean desk policy</h2>
			<p>This policy is not about having the desk clean of dust and food, but about restricting what employees <a id="_idIndexMarker1011"/>can leave unattended on their workstations. The following are some examples to take into consideration:</p>
			<ul>
				<li>Cabinets must be locked at all times when the user is not at the desk.</li>
				<li>NO papers, notes, or other sources of data should be left unattended on the desk.</li>
				<li>NO removable devices (such as USB drives) should be left unattended (either connected or disconnected from the computer).</li>
				<li>NO <strong class="bold">sensitive </strong><strong class="bold"><a id="_idIndexMarker1012"/></strong><strong class="bold">personal information</strong> (<strong class="bold">SPI)</strong> or <strong class="bold">personal identifiable information</strong> (<strong class="bold">PII)</strong> should <a id="_idIndexMarker1013"/>be left unattended on the desk.</li>
			</ul>
			<div><div><img src="img/Figure_9.14_B16290.jpg" alt="Figure 9.14 – Clean desk policy example&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.14 – Clean desk policy example</p>
			<p>This policy is of great value for you and for the company as it serves as an additional layer of security against <a id="_idIndexMarker1014"/>external attackers. In fact, companies that successfully implement this policy also reduce other company risks such as intrusions, theft, and more.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">These policies must be accompanied by heavy sanctions from HR to ensure everyone is complying. Additionally, if you assign auditors to perform daily checks, this policy will eventually become part of the organizational culture.</p>
			<p>In terms of ownership and implementation, the best practice is that this is implemented and owned by HR, because they may have more resources to ensure the proper implementation of the policy across the entire company. However, keep in mind that you may have to be the main evangelist to ensure the policy is created in the first place.</p>
			<h2 id="_idParaDest-221"><a id="_idTextAnchor228"/>Physical security audits</h2>
			<p>This mechanism is <a id="_idIndexMarker1015"/>normally overlooked, however, this should be an essential part of your defensive strategy.</p>
			<p>Now, let's review <a id="_idIndexMarker1016"/>the best practices for physical security audits:</p>
			<div><div><img src="img/Figure_9.15_B16290.jpg" alt="Figure 9.15 – Best practices for physical security audits&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.15 – Best practices for physical security audits</p>
			<p>Some companies may perform these audits as part of their yearly audits. However, not all companies have the budget to do this, so in those cases, the recommendation is to select a group of <a id="_idIndexMarker1017"/>volunteers to perform the role of physical security auditor. You just need to ensure that they are trained in how to carry out security audits, and have a deep understanding of the related policies. Also, since these are not official audits, you can perform them more frequently, for example, on all Fridays, or the last Monday of the month, and so on.</p>
			<p>Additionally, as mentioned in <a href="B16290_03_Final_JC_ePub.xhtml#_idTextAnchor068"><em class="italic">Chapter 3</em></a>, <em class="italic">Comprehending Policies, Procedures, Compliance, and Audits</em>, you need to make sure you have approval from upper management, HR, and the legal department before rolling out any type of audit.</p>
			<h1 id="_idParaDest-222"><a id="_idTextAnchor229"/>Summary</h1>
			<p>In this chapter, you learned a lot about the latest and greatest devices that an attacker can use if they have physical access to your infrastructure and systems.</p>
			<p>This knowledge will help you to better understand the current threat landscape, and you will also now be able to easily spot any of those devices and remove them before any major impact occurs to your infrastructure and data.</p>
			<p>In fact, I know that every time you enter a conference room, the first thing you will do is look at the projector to make sure there is not a <strong class="bold">screen crab</strong> around.</p>
			<p>Also, all this knowledge will help you to create better technical and administrative controls to improve your physical security and enhance your overall defensive security strategy.</p>
			<p>Additionally, you learned the value of physical audits, so now you can either enforce them or start implementing them if you haven't already</p>
			<p>Now, get ready for the next chapter, in which we are going to take a look at the exciting world of securing <strong class="bold">Internet of Things</strong> (<strong class="bold">IoT</strong>) devices, but also learn how to convert some of these devices into <em class="italic">next-generation</em> defensive security tools.</p>
			<h1 id="_idParaDest-223"><a id="_idTextAnchor230"/>Further reading</h1>
			<p>If you want to know more about the amazing tools that we just reviewed (the LAN Turtle, Plunder Bug, Packet Squirrel, Shark Jack, Screen Crab, and Key Croc), then just visit the following link: <a href="https://docs.hak5.org/hc/en-us">https://docs.hak5.org/hc/en-us</a>.</p>
		</div>
	</body></html>