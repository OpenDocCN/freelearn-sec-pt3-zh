<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Data Acquisition from iOS Backups</h1>
                </header>
            
            <article>
                
<p>In the previous chapter, we covered techniques to acquire data from an iOS device, which included logical and filesystem acquisition. This chapter covers techniques to acquire a backup of files from the device onto a computer or iCloud, using Apple's synchronization protocol. </p>
<p>The physical acquisition of an iOS device provides the most data in an investigation, but you can also find a wealth of information in iOS backups. iOS device users have several options to back up the data present on their devices. Users can choose to back up the data to their computer, using the Apple iTunes software, or to the Apple cloud storage service known as iCloud. Every time an iPhone is synced with a computer or to iCloud, it creates a backup by copying the selected files from the device. The user can determine what is contained in the backup, so some backups may be more inclusive than others. Also, the user can back up to both a computer and iCloud and the data derived from each location may differ. This often occurs due to the limitations of iCloud's free storage. The user may simply back up photos and contacts to iCloud but may take a complete backup of all the data on their computer. As previously mentioned, physical acquisition provides the best access to all data on the iOS device; however, backups may be the only available source of digital evidence, especially if we are dealing with the most recent iOS devices.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>Working with iTunes backups</li>
<li>Creating and analyzing backups with iTunes</li>
<li>Extracting unencrypted backups</li>
<li>Handling encrypted backup files</li>
<li>Working with iCloud backups</li>
</ul>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Working with iTunes backups</h1>
                </header>
            
            <article>
                
<p>A wealth of information is stored on any computer that has been previously synced with an iOS device. These computers, commonly referred to as host computers, can have historical data and passcode bypass certificates. In a criminal investigation, a search warrant can be obtained to seize a computer that belongs to a suspect, in order to access the backup and lockdown certificates. For all other cases, consent or permissible access is required. iOS backup file forensics mainly involves analyzing an offline backup produced by an iPhone or an iPad. Apple Watch data will be contained within the iPhone backup to which it is synced.</p>
<p>The iTunes backup method is also useful in cases where other acquisition types are not feasible. In this situation, you essentially create an iTunes backup of the device and analyze it using forensic software. Thus, it is important for you to completely understand the backup process and the tools involved, to ensure <span><span>tools</span></span> are capable of creating a forensic backup without contaminating the devices with other existing data in iTunes.</p>
<p>iPhone backup files can be created using the iTunes software, which is available for the macOS and Windows platforms. iTunes is a free utility provided by Apple for data synchronization and management between iOS devices and the computer. iTunes uses Apple's proprietary synchronization protocol to copy data from the iOS device to a computer. For example, an iPhone can be synced with a computer using a cable or Wi-Fi. iTunes provides an option for an encrypted backup, but, by default, it creates an unencrypted backup whenever an iPhone is synced. Encrypted backups, when cracked, provide additional access to data stored on the iOS device. This will be discussed later in this chapter.</p>
<p>Users often create backup files to protect their data in the event that their device is damaged or lost. Either a forensic backup is created to act as the best evidence or data is simply extracted from existing iOS backup files to search for legacy information. For example, if you are under investigation and you delete files or wipe your iPhone, your backup files on your iCloud and your Mac still exist. Depending on whether iTunes or iCloud was used, multiple backups for the same device may exist. You will have to analyze each backup <span>forensically </span>to uncover artifacts relating to the investigation.</p>
<p>iTunes is configured to automatically initiate the synchronization process once the iOS device is connected to the computer. To avoid unintended data exchange between the iOS device and the computer, disable the automatic synchronization process before connecting your evidence to the forensic workstation. The screenshot in <em>Step 2</em> of the following process illustrates the option that disables automatic syncing in iTunes version 12.9.4.102.</p>
<p>To disable auto-syncing in iTunes, perform the following steps:</p>
<ol>
<li>Navigate to <span class="packt_screen"><span>Edit</span> | <span class="packt_screen">Preferences</span> | <span class="packt_screen">Devices</span></span>.</li>
<li>Check <span class="packt_screen">Prevent iPods, iPhones, and iPads from syncing automatically</span> and click on the <span class="packt_screen">OK</span> button, as illustrated in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/cd4a3226-ceaa-48e8-8d6b-493c80029190.png" style="width:38.67em;height:37.17em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Disabling automatic syncing in iTunes</div>
<ol start="3">
<li>As seen in the preceding screenshot, iOS backup files exist on the system. If this were a forensic workstation, these backup files wouldn't exist or would be permanently removed to prevent cross-contamination.</li>
</ol>
<ol start="4">
<li>Once you verify the synchronization settings, connect the iOS device to the computer using a <strong>Universal Serial Bus</strong> (<strong>USB</strong>) cable. If the connected device is not protected with a passcode or it was already connected to the computer recently, iTunes immediately recognizes the device; otherwise, you'll have to enter the passcode. This can be verified by the iPhone icon displayed on the left-hand side of the iTunes interface, as illustrated in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/745e839b-d893-42fd-93d4-a040087edd43.png" style="width:58.08em;height:38.25em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">An iPhone recognized by iTunes</div>
<ol start="5">
<li>Before iTunes can access the iPhone, you must enable <span class="packt_screen">Trust</span> between the computer and the phone. You will be prompted to press <span class="packt_screen">Continue</span> on the computer (as highlighted in the following screenshot) and select <span class="packt_screen">Trust</span> on the iPhone. With iOS 11, you must also enter the device's passcode:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/442913d1-f1ac-4726-a652-08f50317b151.png" style="width:35.00em;height:12.75em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">iTunes prompts for access permissions</div>
<ol start="6">
<li>Once iTunes recognizes the device, a single click on the iPhone icon displays the iPhone summary, including the iPhone's name, capacity, firmware version, serial number, free space, and phone number. The iPhone <span class="packt_screen">Summary</span> page also displays the options to create backups. The process of creating a backup will be discussed in the following section.</li>
</ol>
<p>Now, we are ready to start backing up the device. The next section will walk you through this process.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating and analyzing backups with iTunes</h1>
                </header>
            
            <article>
                
<p>In this section, we are going to walk you through backing up an iOS device with Apple iTunes. We are using iTunes v<span>ersion 12.10.2.3 and an iPhone running iOS version 13.2. Perform the following steps:</span></p>
<ol>
<li>Connect the device and click on <span>the iPhone icon displayed on the left-hand side of the iTunes interface.</span></li>
</ol>
<p> </p>
<ol start="2">
<li>Go to the <span class="packt_screen">Backups</span> section, where you can choose the backup destination (local computer or <span class="packt_screen">iCloud</span>), and whether it's encrypted, as illustrated in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b8421d5d-0ef2-4c07-a5a5-5b5146fb406e.png" style="width:54.50em;height:21.00em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">iTunes Backups section</div>
<div class="packt_infobox">Encrypted iTunes backups contain data that unencrypted ones don't, including passwords, Wi-Fi settings, and web browsing history, so make sure you are creating encrypted backups for forensic purposes.</div>
<ol start="3">
<li>Click on the <span class="packt_screen">Back Up Now</span> button and wait for the process to complete. Once it's complete, the latest backup date and time will be changed.</li>
</ol>
<p>If you want to use iTunes and save the backup to an external drive, observe the following instructions (we are using <span>iTunes v</span><span>ersion 12.10.2.3 and Windows 10</span>):</p>
<ol start="1">
<li>Rename the original backup folder.</li>
<li>Connect the external drive and create a backup folder on it.</li>
<li>Open Command Prompt and type the following command:</li>
</ol>
<pre style="padding-left: 60px"><strong>mklink /J "C:\Users\&lt;username&gt;\AppData\Roaming\Apple Computer\MobileSync\Backup" "f:\Backup"</strong></pre>
<ol start="4">
<li>Now, you can create a regular local backup, and it will be saved to your external drive.</li>
</ol>
<p>Now, we have the backup ready for further analysis. Let's look inside in order to understand its structure.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Understanding the backup structure</h1>
                </header>
            
            <article>
                
<p>When the iPhone is backed up to a computer, the backup files are stored in a backup directory, which exists as a 40-character hexadecimal string and corresponds to the <strong>Unique Device Identifier</strong> (<strong>UDID</strong>) of the device. The newest devices have changed the UDID format—now it's a 24-character string, so their backups are named accordingly. The backup process may take a considerable amount of time, depending on the size of the data stored on the iPhone during the first backup. The location of the backup directory in which your backup data is stored depends on the computer's operating system. The following table displays a list of the common operating systems and the default locations of the iTunes backup directory:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p><strong>Operating system</strong></p>
</td>
<td>
<p><strong>Backup directory location</strong></p>
</td>
</tr>
<tr>
<td>
<p>Windows XP</p>
</td>
<td>
<p><kbd>C:\Documents and Settings\&lt;username&gt;\Application Data\Apple Computer\MobileSync\Backup\</kbd></p>
</td>
</tr>
<tr>
<td>
<p>Windows Vista/7/8/10</p>
</td>
<td>
<p><kbd>C:\Users\&lt;username&gt;\AppData\Roaming\Apple Computer\MobileSync\Backup\</kbd></p>
</td>
</tr>
<tr>
<td>
<p>macOS</p>
</td>
<td>
<p><kbd>~/Library/Application Support/MobileSync/Backup/</kbd></p>
<p>(<kbd>~</kbd> represents the home folder)</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>During the first sync, iTunes creates a backup directory and takes a complete backup of the device. Currently, on subsequent syncs, iTunes only backs up the files that are modified on the device and updates the existing backup directory. This has not always been true since, in the past, a new backup was created every time the iOS device was backed up. Also, when a device is updated or restored, iTunes automatically initiates a backup and takes a <em>differential backup</em>. A differential backup has the same name as the backup directory but is appended with a dash (<kbd>-</kbd>), the <strong>International Organization for Standardization</strong> (<strong>ISO</strong>) date of the backup, a dash (<kbd>-</kbd>), and the time in a 24-hour format with seconds (<kbd>[UDID]+ '-' + [Date]+'-'+[Time stamp]</kbd>).</p>
<p>The iTunes backup may make a copy of everything on the device, including contacts, <strong>Short Message Service</strong> (<strong>SMS</strong>) messages, photos, calendars, music, call logs, configuration files, documents, the keychain, network settings, offline web application cache, bookmarks, cookies, application data (if selected), and more. For example, emails and passwords will not be extracted if the backup is not encrypted. The backup also contains device details, such as the serial number, UDID, <strong>Subscriber Identification Module</strong> (<strong>SIM</strong>) details, and phone number. This information can also be used to prove a relationship between the backup and the mobile device.</p>
<p class="mce-root"/>
<p>The backup directory contains four standard files, along with the individual files (up to iOS 9) or folders (iOS 10 and newer). Up to iOS 9, these four files were <span><kbd>info.plist</kbd>, <kbd>manifest.plist</kbd>, <kbd>status.plist</kbd>, and <kbd>manifest.mbdb</kbd>, but starting from iOS 10, we have the following standard files:</span></p>
<ul>
<li><kbd>info.plist</kbd></li>
<li><kbd>manifest.plist</kbd></li>
<li><kbd>status.plist</kbd></li>
<li><kbd>manifest.db</kbd></li>
</ul>
<p>These files store details about the backup and the device from which it was derived.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">info.plist</h1>
                </header>
            
            <article>
                
<p>The <kbd>info.plist</kbd> file stores details about the backed-up device, and typically contains the following information:</p>
<ul>
<li><kbd>Applications</kbd><span>: This is the list of applications installed on the device.</span></li>
<li><kbd>Build version</kbd>: This is the iOS build version number.</li>
<li><kbd>Device name and display name</kbd>: This is the name of the device, which typically includes the owner's name.</li>
<li><kbd>GUID</kbd>: This is the <strong>Globally Unique Identifier</strong> (<strong>GUID</strong>) of the device.</li>
<li><kbd>ICCID</kbd>: This is the <strong>Integrated Circuit Card Identifier</strong> (<strong>ICCID</strong>), which is the serial number of the SIM.</li>
<li><kbd>IMEI</kbd><span>: This is the</span> <strong>International Mobile Equipment Identity</strong> (<strong>IMEI</strong>)<span>, which is used to uniquely identify the mobile phone.</span></li>
<li><kbd>Installed Applications</kbd>: This is the list of installed applications.</li>
<li><kbd>Last backup date</kbd>: This is the timestamp of the last successful backup.</li>
<li><kbd>MEID</kbd>: This is the <strong>M</strong><span><strong>obile Equipment Identifier</strong> (<strong>MEID</strong>) of the device.</span></li>
<li><kbd>Phone Number</kbd>: This is the phone number of the device at the time of backup.</li>
<li><kbd>Product Name</kbd>: This is the name of the device (for example, iPhone X).</li>
<li><kbd>Product type and product version</kbd>: This is the device's model and firmware version.</li>
<li><kbd>Serial Number</kbd>: This is the serial number of the device.</li>
<li><kbd>Target Identifier and Unique Identifier</kbd><span>: This is the UDID of the device.</span></li>
<li><kbd>iTunes Files</kbd>: This contains information about photos, folders, voice memos, and iTunes preferences.</li>
<li><kbd>iTunes Settings</kbd>: This contains information about deleted applications and applications library.</li>
<li><kbd>iTunes version</kbd>: This is the version of iTunes used to create the backup.</li>
</ul>
<p>Let's now take a look at the <kbd>manifest.plist</kbd> file.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">manifest.plist</h1>
                </header>
            
            <article>
                
<p>The <kbd>manifest.plist</kbd> file describes the contents of the backup, and typically contains the following information:</p>
<ul>
<li><kbd>Backup keybag</kbd><span>: <kbd>Backup keybag</kbd> contains a set of data protection class keys that are different from the keys in <kbd>System keybag</kbd>, and backed-up data is re-encrypted with the new class keys. Keys in <kbd>Backup keybag</kbd> facilitate the storage of backups in a secure manner.</span></li>
<li><kbd>Version</kbd>: This is the backup version.</li>
<li><kbd>Date</kbd>: This is the timestamp of when a backup was created or last updated.</li>
<li><kbd>ManifestKey</kbd>: This is the key used to encrypt <kbd>manifest.db</kbd> (wrapped with protection class <span>4</span>).</li>
<li><kbd>WasPasscodeSet</kbd><span>: This identifies whether a passcode was set on the device when it was last synced.</span></li>
<li><kbd>Lockdown</kbd>: This contains device details, the last backup computer's name, and other remote syncing profiles.</li>
<li><kbd>Applications</kbd><span>: This is a list of third-party applications installed on the backed-up device, their version numbers, and bundle identifiers.</span></li>
<li><kbd>IsEncrypted</kbd><span>: This identifies whether the backup is encrypted. For encrypted backups, the value is <kbd>True</kbd>; otherwise, it is <kbd>False</kbd>.</span></li>
</ul>
<p>Next, we will look at the <kbd>status.plist</kbd> file.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">status.plist</h1>
                </header>
            
            <article>
                
<p>The <kbd>status.plist</kbd> file stores details about the backup status, and typically contains the following information:</p>
<ul>
<li><kbd>IsFullBackup</kbd><span>: This identifies whether the backup was a full backup of the device.</span></li>
<li><kbd>UUID</kbd>: This is the <span>UUID of the device.</span></li>
<li><kbd>Date</kbd>: This is the timestamp of the last time the backup was modified.</li>
<li><kbd>BackupState</kbd>: This identifies whether the backup is a new backup or one that has been updated.</li>
<li><kbd>SnapshotState</kbd>: This identifies whether the backup process has finished successfully.</li>
</ul>
<p>Now, we will look at the <kbd>manifest.db</kbd> file.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">manifest.db</h1>
                </header>
            
            <article>
                
<p><span><kbd>manifest.db</kbd> is an SQLite database that contains a list of all the files and folders extracted from the iPhone via the backup mechanism. The <kbd>Files</kbd> table of the database includes the following columns:</span></p>
<ul>
<li><kbd>fileID</kbd>: This is a <strong>Secure Hash Algorithm 1</strong> (<strong>SHA1</strong>) hash of the domain, plus the <kbd>-</kbd> <span>symbol </span>and file or folder relative path. For example, <kbd><span>ae94e0607ca39a88c18aca095cb5b4f8471291a0</span></kbd> is the SHA1 hash for <kbd>CameraRollDomain-Media/PhotoData/Thumbnails/V2/DCIM/102APPLE</kbd>.</li>
<li><kbd>domain</kbd>: This is the domain to which the file or folder belongs (all files in iOS are divided into multiple domains—for example, <kbd>CameraRollDomain</kbd> and <kbd>HomeDomain</kbd>).</li>
<li><kbd>relativePath</kbd>: This is the relative path to the file (including the filename) or folder.</li>
<li><kbd>flags</kbd>: These are the file flags.</li>
<li><kbd>file</kbd>: This is an <span>embedded <kbd>.plist</kbd> file. </span><span>These <kbd>.plist</kbd> files include the following important pieces of information, among others:</span>
<ul>
<li><kbd>LastModified</kbd>: This is the file's last modification timestamp in Unix format.</li>
<li><kbd>Birth</kbd>: <span>This is the file creation timestamp in Unix format.</span> <span>The fields are shown in the following screenshot:</span></li>
</ul>
</li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2a09529d-3480-464c-8afb-0e7d014da7e5.png" style="width:49.67em;height:31.17em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">The manifest.db contents</div>
<p>You can easily export this<span> <kbd>.plist</kbd> embedded binary using, for example, <strong>DB Browser for SQLite</strong> (<strong>DB4S</strong>). To do this, observe the following steps:</span></p>
<ol>
<li><span>Open <kbd>manifest.db</kbd> using the <span class="packt_screen">Open Database</span> button.</span></li>
<li>Go to the <span class="packt_screen">Browse Data</span> tab.</li>
<li>Click on a cell from in the <span class="packt_screen">file</span> column.</li>
<li>On the <span class="packt_screen">Edit Database Cell</span> pane, use the <span class="packt_screen">Export</span> button to save the data as a <kbd>.plist</kbd> file, as illustrated in the following screenshot:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="assets/f332d4d6-18d8-4cb4-9e3d-a2179fa99a87.png" style="width:30.83em;height:27.08em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Exporting an embedded .plist file with <span>DB4S</span></div>
<p>Since iOS 10, files are no longer named with 40-character hexadecimal strings. Instead, you will see a list of folders named with 2-character hexadecimal strings, which contain the files you used to see in previous versions, as illustrated in the following screenshot:</p>
<p class="mce-root"/>
<div class="CDPAlignCenter CDPAlign"><img src="assets/abd922f2-d27c-4c4b-9a20-55caa7dae694.png" style="width:51.50em;height:29.17em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">iPhone backup files</div>
<p><span><span>Now that you understand the backup structure, let's learn how to extract valuable data from it.</span></span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Extracting unencrypted backups</h1>
                </header>
            
            <article>
                
<p>There are many free and commercial tools available to analyze data from unencrypted backups. These tools analyze the <kbd>manifest.db</kbd> database, restore the filenames, and create the file structure that users see on the iOS device. Some popular tools include iBackup Viewer, iExplorer, and commercial forensic tools such as Belkasoft Evidence Center, Magnet AXIOM, and UFED Physical Analyzer.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">iBackup Viewer</h1>
                </header>
            
            <article>
                
<p>iBackup Viewer is a free tool for both Windows and macOS that can be downloaded from <a href="http://www.imactools.com/iphonebackupviewer/">http://www.imactools.com/iphonebackupviewer/</a>.</p>
<p>The tool expects the backup to be located in the default location, but you can change it to the location of your choice—for example, an external drive.</p>
<p>To extract the backup, observe the following steps:</p>
<ol>
<li>If the backup you want to analyze is not saved in the default location, click on the <span class="packt_screen">Preferences</span> hyperlink on the main screen and choose the correct location, as illustrated in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/7d721288-26e8-4efc-8ba7-e9980bb11f08.png" style="width:27.33em;height:20.17em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Choosing the backup location</div>
<ol start="2">
<li>You will see the backups available in the location you chose. Click on the one you want to examine.</li>
</ol>
<p style="padding-left: 60px"><span>You will see potential evidence sources that are available, including contacts, call history, messages, the calendar, notes, voicemails, and browsing history, as shown in the following screenshot:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/4557fd56-0717-4fc1-a19b-719d96b052e9.png" style="width:42.83em;height:4.50em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Potential evidence sources</div>
<ol start="3">
<li>It's important to note that you can browse the backup as a filesystem, using the Raw Data mode (the last icon in the previous screenshot), as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/205a6416-096a-4760-8cc8-31c961d20547.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref"><span>The Raw Data mode</span></div>
<p>With the help of this tool, you can easily view and export files of interest. Of course, it's not the only tool capable of solving such tasks. Let's look at another one—iExplorer.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">iExplorer</h1>
                </header>
            
            <article>
                
<p>A free version of iExplorer is available at <a href="https://macroplant.com/iexplorer">https://macroplant.com/iexplorer</a>. This tool supports both Windows and macOS and is capable of browsing iTunes backups, too. Here is how to use it:</p>
<ol>
<li>Launch iExplorer and click on <span class="packt_screen">Browse iTunes Backups</span>.</li>
<li>To add a backup from a custom location, click on <span class="packt_screen">Add/Modify Backup Location</span>.</li>
<li>Now, click on the <span class="packt_screen">Add Backup Location</span> button and choose the path, as illustrated in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b71ea292-3321-478a-908f-53190c144262.png" style="width:28.75em;height:19.33em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Adding a custom path</div>
<ol start="4">
<li> The backups from your custom location should now be available. </li>
</ol>
<p>Also, there is an interesting option—iExplorer can gather SQLite databases for you. To do this, click on the <span class="packt_screen">Raw Databases</span> button to take you to the following screen (you will learn more about SQLite forensics in the following chapter):</p>
<p class="mce-root"/>
<div class="CDPAlignCenter CDPAlign"><img src="assets/76857736-da9b-4ba6-88a7-117ddc97edb9.png" style="width:41.17em;height:35.50em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">iExplorer Raw Databases option</div>
<p>You can also browse the backup as a list of files and folders with the help of iExplorer; use the left pane for this. Also, you can use the <span class="packt_screen">Backup Explorer</span> button and then the main pane to browse the backup.</p>
<p>As you can see, there are enough tools capable of extracting valuable pieces of data from an iTunes backup, even if it's encrypted. Of course, it's usually possible if you know the password. But what if you don't? You will learn how to bypass it in the next section.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Handling encrypted backup files</h1>
                </header>
            
            <article>
                
<p>For encrypted backups, the backup files are encrypted using the <strong>Advanced Encryption Standard-256</strong> (<strong>AES-256</strong>) algorithm in the <strong>Cipher Block Chaining</strong> (<strong><span>CBC</span></strong>) mode, with a unique key and a null <strong>initialization vector</strong> (<strong>IV</strong>). The unique file keys are protected with a set of class keys from <kbd>Backup keybag</kbd>. The class keys in <kbd>Backup keybag</kbd> are protected with a key derived from the password set in iTunes through 10,000 iterations of the <strong>Password-Based Key Derivation Function 2</strong> (<strong>PBKDF2</strong>). In iOS 10.2 this mechanism was upgraded, so now, there are 10,000,000 iterations.</p>
<p>Many free and commercial tools provide support for encrypted backup file parsing if the password is known. Unfortunately, it's not always true, so sometimes forensic examiners have to crack such passwords. The next section will walk you through this process, with Elcomsoft Phone Breaker.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Elcomsoft Phone Breaker</h1>
                </header>
            
            <article>
                
<p><strong>Elcomsoft Phone Breaker</strong> is a <strong>graphics processing unit</strong> (<strong>GPU</strong>)-accelerated commercial tool from Elcomsoft, developed for the Windows platform. The tool can decrypt an encrypted backup file when the backup password is not available. The tool provides an option to launch a password brute-force attack on the encrypted backup if the backup password is not available. Elcomsoft Phone Breaker tries to recover the plain-text password that protects the encrypted backup, using a dictionary and brute-force attacks. Passwords that are relatively short and simple can be recovered in a reasonable amount of time. However, if the backup is protected with a strong and complex password, breaking it can take forever.</p>
<p><span>The tool is available here (including free trial version): </span><span><a href="https://www.elcomsoft.com/eppb.html">https://www.elcomsoft.com/eppb.html</a>.</span></p>
<p>To brute-force the backup password, perform the following steps:</p>
<ol>
<li>Launch the Elcomsoft Phone Breaker tool and the tool's main screen will appear, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/cd84841d-8b0d-4615-8c57-977ebfcde583.png" style="width:31.42em;height:19.92em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref"><span>Elcomsoft Phone Breaker's main screen</span></div>
<ol start="2">
<li>Navigate to <span class="packt_screen">Password Recovery Wizard</span> | <span class="packt_screen">Choose source</span> | <span class="packt_screen">iOS device backup</span>. Navigate to the backup file you want to crack, and select the <kbd>Manifest.plist</kbd> file.</li>
<li>Configure the brute-force pattern in the <span class="packt_screen">Attacks</span> section and click on the <span class="packt_screen">Start</span> button to start the brute-force attack, as illustrated in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/05e7ff98-bf10-4a8c-9504-19f447e30d9a.png" style="width:31.83em;height:20.08em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Password recovery process</div>
<p class="mce-root"><span>If the brute-force attack is successful, the tool displays the password on the main screen.</span></p>
<p class="mce-root">If you have an iPhone running iOS 11 or later, and its passcode, you can reset the actual password and make a backup with a new known password. Here is how to do it:</p>
<ol>
<li>On the iPhone, go to <span class="packt_screen">Settings</span> | <span class="packt_screen">General</span> | <span class="packt_screen">Reset</span>.</li>
<li>Choose <span class="packt_screen">Reset All Settings</span> and enter the device's passcode. It's important to note that no data will be deleted.</li>
<li>Once the settings are reset, you can create a new backup with a password of your choice.</li>
</ol>
<div class="packt_infobox">If the <span class="packt_screen">Screen Time</span> password is set, you will need it as well to reset the backup password.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Working with iCloud backups</h1>
                </header>
            
            <article>
                
<p>iCloud is a cloud storage and cloud computing service by Apple, launched in October 2011. The service allows users to keep data such as calendars, contacts, reminders, photos, documents, bookmarks, applications, notes, and more in sync across multiple compatible devices (iOS devices running with iOS 5 or later; computers with macOS X 10.7.2 or later; and Microsoft Windows), using a centralized iCloud account. The service also allows users to wirelessly and automatically back up their iOS devices to iCloud. iCloud also provides other services, such as <em>Find My iPhone</em> (to track a lost phone and wipe it remotely) and <em>Find My Friends</em><strong> </strong>(to share locations with friends and notify the user when a device arrives at a certain location).</p>
<p>Signing up with iCloud is free, and is simple to perform with an Apple ID. When you sign up for iCloud, Apple grants you access to 5 GB of free remote storage. If you need more storage, you can purchase the upgrade plan. To keep your data secure, Apple forces users to choose a strong password when creating an Apple ID to use with iCloud. The password must have a minimum of eight characters, including a number, an uppercase letter, and a lowercase letter.</p>
<p>iOS devices running on iOS 5 and later allow users to back up the device settings and data to iCloud. Data backed up includes photos, videos, documents, application data, device settings, messages, contacts, calendars, emails, and keychain, as shown in the following screenshot. You can turn on iCloud backup on your device by navigating to <span class="packt_screen">Settings</span> | <span class="packt_screen">Passwords &amp; Accounts</span> | <span class="packt_screen">iCloud | iCloud</span>:</p>
<p class="mce-root"/>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1231 image-border" src="assets/8642cddc-4b29-4b88-a86c-aa6eff0ce81c.png" style="width:23.67em;height:39.00em;"/></p>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">iCloud backup options on the iPhone</div>
<p class="mce-root">iCloud can automatically back up your data when your phone is plugged in, locked, and connected to Wi-Fi. That is to say, iCloud backups represent a fresh and near-real-time copy of information stored on the device, as long as space is available to create a current backup.</p>
<p>You can also initiate an iCloud backup from a computer by connecting the device to iTunes and choosing the <span class="packt_screen">iCloud</span> option. iCloud backups are incremental; that is, once the initial iCloud backup is completed, all the subsequent backups only copy the files that are changed on the device. iCloud secures your data by encrypting it when it is transmitted over the internet, storing it in an encrypted format on the server, and using secure tokens for authentication.</p>
<p>Apple's built-in apps (for example, <span class="packt_screen">Mail</span> and <span class="packt_screen">Contacts</span>) use a secure token to access iCloud services. Using secure tokens for authentication eliminates the need to store the iCloud password on devices and computers.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Extracting iCloud backups</h1>
                </header>
            
            <article>
                
<p>Online backups stored on the iCloud are commonly retrieved when the original iOS device is damaged, upgraded, or lost. To extract a backup from iCloud, you must know the user's Apple ID and password. With the known Apple ID and password, you can log on to <a href="https://www.icloud.com/">https://www.icloud.com/</a> and get access to contacts, notes, emails, calendars, photos, reminders, and more. You can also use forensic tools to extract data from iCloud. For example, you can use <strong>Belkasoft Acquisition Tool</strong>, a free tool from Belkasoft that can be downloaded from: <a href="https://belkasoft.com/get">https://belkasof</a><a href="https://belkasoft.com/get">t.com/get</a>. </p>
<p>To extract the iCloud data, perform the following steps:</p>
<ol>
<li>Launch Belkasoft Acquisition Tool.</li>
<li>Choose the <span class="packt_screen">Cloud</span> option.</li>
<li>Choose <span class="packt_screen">iCloud</span>.</li>
<li>Type the Apple ID login and password, and click <span class="packt_screen">Next</span>.</li>
<li>Choose the artifacts you want to download and the target folder in which you want to place them, as illustrated in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/39f11047-23d1-406a-be2f-7f7502db302d.png" style="width:48.75em;height:47.08em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Data types available for downloading</div>
<ol start="6">
<li>Enter the verification code.</li>
<li>Wait for the process to complete. You'll find the files in the folder you've chosen.</li>
</ol>
<p>If you prefer full backups, the best choice is Elcomsoft Phone Breaker.</p>
<p class="mce-root"/>
<p>To download the iCloud backup, follow these steps:</p>
<ol>
<li>Launch Elcomsoft Phone Breaker.</li>
<li>Choose the <span class="packt_screen">Backups</span> option.</li>
<li>Enter the Apple ID and password, or use a previously extracted token.</li>
<li>If Apple ID is protected with <strong>two-factor authentication</strong> (<strong>2FA</strong>), enter the code in the corresponding field.</li>
<li>Choose the backup you want to download, as illustrated in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/166f5a2c-ef6d-41c2-a2bc-4322af253536.png" style="width:39.42em;height:24.92em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Choosing the backup for downloading</div>
<p>Once downloading is completed, you can analyze the backup with your tool of choice—for example, one of the tools discussed throughout this chapter.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>iOS device backups contain essential information that may be your only source of evidence. Information stored in iOS backups includes photos, videos, contacts, emails, call logs, user accounts and passwords, applications, and device settings. This chapter explained how to create backup files and retrieve data from iTunes and iCloud backups, including encrypted backup files, wherever possible.</p>
<p><span>The following chapter, </span><a href="4f92f4a2-f8f9-4274-96eb-da9174fc6772.xhtml">Chapter 5</a>, <em>iOS Data Analysis and Recovery</em>, goes further into the forensic investigation by showing you how to analyze the data recovered from the backup files. </p>


            </article>

            
        </section>
    </body></html>