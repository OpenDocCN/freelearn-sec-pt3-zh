<html><head></head><body>
  <div><h1 class="chapterNumber">7</h1>
    <h1 id="_idParaDest-149" class="chapterTitle">RAM Memory Forensic Analysis</h1>
    <p class="normal">RAM is a vital source of digital evidence that has been neglected and ignored historically. As our knowledge of digital evidence grew, examiners realized the source of potential digital evidence that existed in RAM. Ultimately, you have an additional multi-gigabyte source of information that needs to be examined and may contain digital artifacts that do not exist in the traditional locations of the system.</p>
    <p class="normal">In this chapter, we will cover the fundamentals of memory. We will then look at the different sources of memory and learn to capture RAM using RAM capture tools. By the end of this chapter, you will understand the various methods and tools that can process volatile memory.</p>
    <p class="normal">We’ll be covering the following topics in this chapter:</p>
    <ul>
      <li class="bulletList">Fundamentals of memory</li>
      <li class="bulletList">Random access memory</li>
      <li class="bulletList">Identifying sources of memory</li>
      <li class="bulletList">Capturing RAM</li>
      <li class="bulletList">Exploring RAM analyzing tools</li>
    </ul>
    <h1 id="_idParaDest-150" class="heading-1">Fundamentals of memory</h1>
    <p class="normal">What<a id="_idIndexMarker675"/> information does <strong class="keyWord">random access memory</strong> (<strong class="keyWord">RAM</strong>) contain? It will give you information about the current running state of the system before you shut it down. It will contain information about any running programs; these could be legitimate processes, and it could contain running malware processes as well. If attackers have compromised the host, the malware may be a resident in the RAM.</p>
    <p class="normal">You will also find information related to the host’s network connections with other peers. This could be a legitimate use of peer-to-peer file sharing, or it could show a link to the attacker’s host. These connections are breadcrumbs for you to follow. The user could also be sharing illicit images. Again, the connection to other computers will allow you to follow and investigate additional users for the same crime.</p>
    <p class="normal">If the user is using cloud services, we may never find the data they are creating on the physical disk in the system. Instead, we may only see the evidence of the data being hosted in the cloud in the form of RAM.</p>
    <p class="normal">RAM is the kitchen table of the computer system. Any action the user/system takes will access the RAM. For example, every mouse click and every keyboard button that’s pushed will be processed through the RAM, and you can recover entire files, passwords, and the text that was placed into the clipboard. All of these are potential sources of digital evidence. Sometimes, you can recover the encryption keys for closed encrypted containers that the user has created.</p>
    <p class="normal">In 2004, Rajib K. Mitra was convicted of jamming police radios. The investigation resulted in the <a id="_idIndexMarker676"/>seizure of multiple pieces of digital evidence. The lead detective, Cindy Murphy, learned in 2009 that it was possible to recover encryption keys that may have existed only in RAM. Detective Murphy was able to go back and reexamine the evidence and was able to identify the encryption keys Mitra had used to secure his encrypted container. When Detective Murphy opened the encrypted container, she found many illicit images, which led to Mitra being convicted of possessing the images.</p>
    <p class="normal">How is analyzing RAM different from analyzing a hard drive? RAM is a snapshot of a live running system, whereas a hard drive examination is static. When examining a hard drive, we have shut the system down and we are examining data on the physical device. RAM is much more transient, and if you were to take a forensic image of RAM at two different points of time, you would get different results. Capturing the data in RAM will lead to the loss of potential evidence. You are changing evidence when you collect RAM.</p>
    <p class="normal">So, let’s talk about what RAM is.</p>
    <h1 id="_idParaDest-151" class="heading-1">Random access memory?</h1>
    <p class="normal">RAM temporarily<a id="_idIndexMarker677"/> stores working data/code on an active computer system. Unlike on traditional storage devices such as hard drives, data can be read/written on RAM at extremely fast speeds. Current technology allows the RAM chips to be created around an integrated circuit chip with metal oxide semiconductor cells. The data stored within the RAM chips is volatile. </p>
    <p class="normal">We lose volatile data when the computer system is no longer powered on. This is a significant reason the <em class="italic">pull the plug</em> tactic is no longer recommended when responding to a scene involving activated computer systems.</p>
    <p class="normal">You may run into<a id="_idIndexMarker678"/> two different <a id="_idIndexMarker679"/>types of RAM: <strong class="keyWord">static RAM</strong> (<strong class="keyWord">SRAM</strong>) and <strong class="keyWord">dynamic RAM</strong> (<strong class="keyWord">DRAM</strong>). SRAM is considered faster and more efficient in terms of energy use, whereas DRAM is cheaper to produce than SRAM. Therefore, you will typically find SRAM used as cache memory for the CPU and DRAM chips used as memory chips for the computer system.</p>
    <p class="normal">The following is a representation of a DRAM chip you may come across in your investigations:</p>
    <figure class="mediaobject"><img src="img/B18329_07_01.png" alt="A picture containing text, electronics, circuit  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 7.1: DRAM image</p>
    <p class="normal">Do not confuse <a id="_idIndexMarker680"/>RAM with <strong class="keyWord">read-only memory</strong> (<strong class="keyWord">ROM</strong>). ROM permanently stores data within the memory chips and is not volatile.</p>
    <p class="normal">Consider the following: a 32-bit Microsoft Windows-based computer system has a limitation of 4 GB of RAM, while a 64-bit Microsoft Windows-based computer system has a limit of 128 GB of RAM. That is a considerable amount of potential evidence that, historically, has not been analyzed.</p>
    <p class="normal">For the CPU to access the data/execute code being stored in the memory chips, there must be a unique identifier for the location of that data. When we start examining raw memory dumps, we will be dealing with the physical address, which is an offset of the memory dump.</p>
    <p class="normal">Data stored in RAM is stored in pages that are 4 kilobytes in size (but can vary in size), and as the system processes add/read data to the pages in RAM, they are utilizing virtual <a id="_idIndexMarker681"/>addressing.</p>
    <p class="normal">All the operating systems access RAM in the same general manner. So let’s talk about some concepts that are common to an operating system:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Privilege separation</strong>: Privilege<a id="_idIndexMarker682"/> determines<a id="_idIndexMarker683"/> what a user, user account, and the process are allowed to access. It is a form of access control, and when used by the operating system, it helps provide system stability by isolating users and the CPU kernel’s actions. The operating system operates in trusted mode, that is, kernel mode, while the user applications operate in untrusted mode, that is, user mode, when executing commands in the system.</li>
      <li class="bulletList"><strong class="keyWord">System calls</strong>: To <a id="_idIndexMarker684"/>access resources controlled by the operating system’s kernel, the user application must request access. This is done through a system call to the kernel. It is a bridge between the application and the operating system to allow the untrusted mode to become trusted for a specific instance.</li>
      <li class="bulletList"><strong class="keyWord">Process management</strong>: Program <a id="_idIndexMarker685"/>code is executed in memory. The operating system is responsible for managing the processes. Current operating systems operate as multi-programming systems, allowing multiple processes to be executed simultaneously. As we analyze the memory dumps, we are looking at which processes were being executed at the time of capture and analyzing the data stored within RAM.</li>
      <li class="bulletList"><strong class="keyWord">Threads</strong>: A process can<a id="_idIndexMarker686"/> have multiple threads. It is the basic unit of using the system’s resources, such as the CPU. When we analyze the memory dumps, we are looking for the processes timestamps and starting addresses, which will help identify the code in the process.</li>
    </ul>
    <p class="normal">The contents of RAM may include artifacts of what is or has occurred on the system. This can include the following:</p>
    <ul>
      <li class="bulletList">Configuration information</li>
      <li class="bulletList">Typed commands</li>
      <li class="bulletList">Passwords</li>
      <li class="bulletList">Encryption keys</li>
      <li class="bulletList">Unencrypted data</li>
      <li class="bulletList">IP addresses</li>
      <li class="bulletList">Internet history</li>
      <li class="bulletList">Chat conversations</li>
      <li class="bulletList">Emails</li>
      <li class="bulletList">Malware</li>
    </ul>
    <p class="normal">As you can tell, with the collection of RAM, there is great potential to acquire significant evidence. Where<a id="_idIndexMarker687"/> do we find data that is stored in RAM? There are several different sources, all of which we will discuss next.</p>
    <h1 id="_idParaDest-152" class="heading-1">Identifying sources of memory</h1>
    <p class="normal">What happens if <a id="_idIndexMarker688"/>you are not the investigator on the scene when the digital evidence is collected in the RAM, and they do not collect volatile data? Is it possible to still access the RAM, despite having the system shut down? While you cannot analyze the RAM, it is possible to examine other sources containing the same data stored in the RAM. This option may not always be viable, depending on the specific set of circumstances surrounding the seizure of the digital evidence.</p>
    <p class="normal">You need to know that there are potential additional sources containing the same or similar data in RAM. They are as follows:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Hibernation file (hiberfill.sys)</strong>: Hibernation is the process of powering down the <a id="_idIndexMarker689"/>computer while still maintaining the current state of the system. In Windows, the RAM is compressed and stored in a <code class="inlineCode">hiberfill.sys</code> file. This will allow the system to power down completely, but when the system is reactivated, the contents of the <code class="inlineCode">hiberfill.sys</code> file will be placed back into RAM.
    <div><p class="normal"><strong class="keyWord">Note</strong></p>
      <p class="normal">If you are examining a laptop, hibernation is usually initiated by closing the laptop. In a desktop, this will be user-initiated. The file header for the <code class="inlineCode">hiberfill.sys</code> file can be <code class="inlineCode">hibr</code>, <code class="inlineCode">HIBR</code>, <code class="inlineCode">wake</code>, or <code class="inlineCode">WAKE</code>. When the system is repowered, the header of the file is zeroed out. The <code class="inlineCode">hiberfill.sys</code> file is a compressed file and will have to be decompressed before you can analyze it.</p>
    </div>
    <p class="normal">When analyzing the <code class="inlineCode">hiberfill.sys</code> file, the last modification date/timestamp will show when the contents of RAM was added to the file.</p>
    <div><p class="normal"><strong class="keyWord">Note</strong></p>
      <p class="normal">Another option if you are on scene and cannot do a live capture of the RAM is to place the system into hibernation, which will then create the <code class="inlineCode">hiberfill.sys</code> file where the current state of the system is saved.</p>
    </div>
</li>
    </ul>
    <ul>
      <li class="bulletList"><strong class="keyWord">Pagefile (pagefile.sys)</strong>: Paging<a id="_idIndexMarker690"/> is a method of storing/retrieving data used in the RAM chips with a virtual memory file stored on a traditional storage device. While not as fast as using RAM alone, it allows programs to exceed the physical memory capacity. When using paging, the system will transfer data in <a id="_idIndexMarker691"/>pages. The data stored in the page file is typically the least requested data used in memory. When the requests for that data are processed, it places the data back into the physical memory.
    <div><p class="normal"><strong class="keyWord">Note</strong></p>
      <p class="normal">In the Windows operating system, the paging file, <code class="inlineCode">pagefile.sys</code>, is stored at the root of the operating system volume. Be aware that the user can change this location. Typically, the page file can be one to three times larger than the amount of physical memory on the system.</p>
    </div>
</li>
    </ul>
    <ul>
      <li class="bulletList"><strong class="keyWord">Swapfile (Swapfile.sys)</strong>: With <a id="_idIndexMarker692"/>Microsoft Windows 8, Microsoft introduced the <code class="inlineCode">Swapfile.sys</code> file. It is similar to the page file we just discussed but with some differences. The Swapfile was created so that the operating system can use it for paging operations with suspended modern Windows applications. When the application is suspended, the system will write the application data in its entirety into the swapfile. This frees up space in the physical memory, and when the application <a id="_idIndexMarker693"/>is resumed, it moves the data back into physical memory.</li>
      <li class="bulletList"><strong class="keyWord">Crash dump (memory.dmp)</strong>: If you <a id="_idIndexMarker694"/>have used any version of Microsoft Windows, you might have experienced a system crash <a id="_idIndexMarker695"/>or a <strong class="keyWord">blue screen of death</strong> (<strong class="keyWord">BSoD</strong>). When that occurs, it may create a dump of memory to store information about the system’s state at the time of the crash.</li>
    </ul>
    <p class="normal">Depending on the settings, you may get one of the following:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Complete memory dump</strong>: The data contained within the physical memory. (Not very common because of issues with the capacity of the physical memory chips.)</li>
      <li class="bulletList"><strong class="keyWord">Kernel memory dump</strong>: Will only contain pages of data that were in kernel mode.</li>
      <li class="bulletList"><strong class="keyWord">Small dump files</strong>: Contains information about running processes/loaded drivers at the time of the crash.</li>
    </ul>
    <p class="normal">The <code class="inlineCode">SYSTEM</code> hive will contain the key to determine which memory dumps exist on the system you are examining. The key you’ll want to explore is as follows:</p>
    <pre class="programlisting con"><code class="hljs-con">SYSTEM\CurrentControlSet\Control\CrashControl\CrashDumpEnable
</code></pre>
    <p class="normal">The dump files will be in a proprietary format and will need a third-party tool to convert them (available at <a href="https://www.comae.com">https://www.comae.com</a>). So far, we have discussed the locations that will <a id="_idIndexMarker696"/>provide sources of RAM. Ultimately, you will want to capture the data within the RAM chips, which is our next topic.</p>
    <h1 id="_idParaDest-153" class="heading-1">Capturing RAM</h1>
    <p class="normal">When the<a id="_idIndexMarker697"/> decision is made to capture the RAM from the system, several factors need to be considered before moving forward. The most significant issue is that you will be changing the system’s state when you collect the volatile data.</p>
    <p class="normal">The <strong class="keyWord">Scientific Workgroup on Digital Evidence</strong> (<strong class="keyWord">SWGDE</strong>) has explored the collection of volatile <a id="_idIndexMarker698"/>data and offers the following considerations:</p>
    <ul>
      <li class="bulletList">The application used to collect the data in memory will overwrite some memory contents.</li>
      <li class="bulletList">The larger the tool and associated files are, the more data it overwrites.</li>
      <li class="bulletList">The system may load the USB device driver into memory.</li>
      <li class="bulletList">The system may load the USB device driver into the registry.</li>
      <li class="bulletList">The application used to collect the data in memory will show up in some <strong class="keyWord">Most Recently Used</strong> (<strong class="keyWord">MRUs</strong>).</li>
    </ul>
    <p class="normal">There is the potential that the collection of RAM may cause a system lockup or instability in the system. Therefore, the digital forensic investigator must know how the tool may affect different operating systems.</p>
    <p class="normal">After calculating the risk versus the reward, you have decided to go forward and collect the contents of the RAM. What do you need to accomplish this task? It would be best to decide which<a id="_idIndexMarker699"/> tool works best in the environment in which you will create the memory dump. One consideration regarding your tool selection is how big a footprint the tool will leave on the system.</p>
    <h2 id="_idParaDest-154" class="heading-2">Preparing the capturing device</h2>
    <p class="normal">To successfully<a id="_idIndexMarker700"/> image the RAM, you will need three things:</p>
    <ul>
      <li class="bulletList">A capturing device (such as a USB device)</li>
      <li class="bulletList">Access to the system</li>
      <li class="bulletList">Administrator privileges</li>
    </ul>
    <div><p class="normal"><strong class="keyWord">Note</strong></p>
      <p class="normal">Remember that the amount of RAM installed on the system will dictate the size of your external storage device. If the system has 16 GB of RAM, your external storage device will need to be greater than 16 GB. The memory dump will be the same size as the amount of installed RAM.</p>
    </div>
    <p class="normal">You will want to prepare your external storage device before responding to the scene. Your device should be formatted as an NTFS partition. This will alleviate any file size issues you might encounter if you formatted the device in FAT 32.</p>
    <p class="normal">We will now discuss some tools to create a raw forensic image of the RAM.</p>
    <h3 id="_idParaDest-155" class="heading-3">Exploring RAM capture tools</h3>
    <p class="normal">I will briefly<a id="_idIndexMarker701"/> discuss some tools that you can use to capture RAM. There are additional commercial and open-source tools available. We could write an entire book (and there are some) about some tools used for memory forensics. The goal here is to give you an overview and the skills necessary to accomplish a successful memory dump, but be aware that you can go into much greater detail than I will go into in this chapter.</p>
    <p class="normal">The following tools are all open source and freely available.</p>
    <h3 id="_idParaDest-156" class="heading-3">Using DumpIt</h3>
    <p class="normal">DumpIt (available at <a href="https://github.com/thimbleweed/All-In-USB/tree/master/utilities/DumpIt">https://github.com/thimbleweed/All-In-USB/tree/master/utilities/DumpIt</a>) was <a id="_idIndexMarker702"/>originally<a id="_idIndexMarker703"/> developed by MoonSols. Then Comae was maintaining the project. As of 2021, DumpIt appears to have been rolled into the Comae Platform V2.0 Closed Beta. It is a combination of <code class="inlineCode">Win32dd</code> and <code class="inlineCode">Win64dd</code> in one executable. The end user isn’t given any options to configure. This tool is fast, small, and portable. It leaves the least significant form of footprint on the RAM.</p>
    <p class="normal">DumpIt is the simplest of all the tools to use. Once you have created your external device and have responded to the scene, you need to follow these steps:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Insert your thumb drive into the target host.</li>
      <li class="numberedList">Type <code class="inlineCode">cmd</code> (as shown in the following screenshot):</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_02.png" alt="Figure 7.2 – Search bar"/></figure>
    <p class="packt_figref">Figure 7.2: Search bar</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">Right-click on <strong class="screenText">Command Prompt</strong> so that you can run it as an administrator (as shown in the following screenshot):</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_03.png" alt="Image administrator"/></figure>
    <p class="packt_figref">Figure 7.3: Run as administrator</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="4">Once Command Prompt comes up, navigate to the folder on your USB device that contains the executable. You will then type in the <code class="inlineCode">cmd</code> command and execute it.</li>
      <li class="numberedList">The system will then present you with a screen showing the amount of physical memory and the amount of space on the device. It will then ask you if you want to continue. Select <code class="inlineCode">y</code>, as shown in the following screenshot:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_04.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.4: DumpIt screen</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="6">The amount of RAM installed will dictate the amount of time it will take to create the dump of the RAM. Once the process has been completed, the program will notify you that it was successful:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_05.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.5: DumpIt successful</p>
    <p class="normal">DumpIt is <a id="_idIndexMarker704"/>not the only tool <a id="_idIndexMarker705"/>available. There are additional open-source alternatives, such as FTK Imager, which we will discuss next.</p>
    <h3 id="_idParaDest-157" class="heading-3">Using FTK Imager</h3>
    <p class="normal">FTK Imager <a id="_idIndexMarker706"/>Lite (available at <a href="http://accessdata.com">http://accessdata.com</a>) is a GUI-based <a id="_idIndexMarker707"/>utility that allows a user to dump the memory of a computer system running either a Windows 32-bit or 64-bit operating system. This tool is easy to use and deployable on a thumb drive. This tool also allows us to mount binary dump files for viewing. Since it is GUI-based, it leaves a significant footprint on the RAM.</p>
    <p class="normal">FTK Imager is also relatively easy to use. Remember that it is GUI-based, so as you launch the executable from your external storage device, it will overwrite more data in memory than a CLI-based tool.</p>
    <p class="normal">Once you have responded to the scene, you will need to do the following:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Insert your thumb drive into the target host.</li>
      <li class="numberedList">If <strong class="screenText">File Explorer</strong> does not automatically launch, use the <em class="keystroke">Windows</em> + <em class="keystroke">E</em> keyboard shortcut to open it.</li>
      <li class="numberedList">Launch FTK Imager, left-click on <strong class="screenText">File</strong>, and select <strong class="screenText">Capture Memory...</strong>, as shown in the following screenshot:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_06.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.6: FTK Imager menu</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="4">The <strong class="screenText">Memory Capture</strong> window will appear as shown in the following screenshot. Here, you can fill in the destination path:
    <figure class="mediaobject"><img src="img/B18329_07_07.png" alt="FTK Imager memory capture "/></figure>
    <p class="packt_figref">Figure 7.7: FTK Imager memory capture</p>
    <p class="normal">However, ensure that you select your external storage device.</p>
</li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="5">You also have the option to choose the <code class="inlineCode">pagefile</code>. There is no reason not to. Check that box and then left-click on <strong class="screenText">Capture Memory</strong>.</li>
      <li class="numberedList">Once the tool has finished, you will receive a success notification, as shown in the <a id="_idIndexMarker708"/>following <a id="_idIndexMarker709"/>screenshot. This will store the memory file on your external storage device:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_08.png" alt="FTK Image successful "/></figure>
    <p class="packt_figref">Figure 7.8: FTK Image successful</p>
    <p class="normal">No matter which tool you used to collect the memory, once you have collected it, you need to get a hash value of the file you just created. You do not want to use the suspect’s system because any commands you issue will change the state of the evidence. You will want to use your forensic laptop or your forensic workstation at your laboratory to generate the hash value.</p>
    <p class="normal">Now that you<a id="_idIndexMarker710"/> have created a <a id="_idIndexMarker711"/>memory dump of the RAM, what tools will you use to analyze it? Let’s talk about some tools that can be used to analyze RAM.</p>
    <h1 id="_idParaDest-158" class="heading-1">Exploring RAM analyzing tools</h1>
    <p class="normal">Just like when we <a id="_idIndexMarker712"/>analyze forensic images created from traditional storage devices, you have the choice of open source or commercial software. It comes down to the examiner’s preferences (and sometimes budget) on what tool they wish to use to analyze the dataset. We will go over some available tools, but this is not an all-inclusive list. Most commercial tools will analyze a memory file; we will discuss some open-source options that are available here:</p>
    <ul>
      <li class="bulletList">Bulk Extractor: Bulk Extractor (available at <a href="http://digitalcorpora.org/downloads/bulk_extractor">http://digitalcorpora.org/downloads/bulk_extractor</a>) scans the target media (disk<a id="_idIndexMarker713"/> image, file, directory) and extracts what it believes to be useful information. It ignores the filesystem structure, which allows it to process different parts of the source dataset in parallel. This makes it very fast compared to traditional forensic tools. As Bulk Extractor finds data it believes to be relevant, it creates a histogram of the artifacts.</li>
      <li class="bulletList">Volatility: Volatility (available at <a href="https://www.volatilityfoundation.org">https://www.volatilityfoundation.org</a>) is an <a id="_idIndexMarker714"/>open-source framework for incident response and malware analysis. Volatility supports a wide variety of memory dumps from multiple operating systems. Volatility is very powerful and has numerous plugins.</li>
      <li class="bulletList">VOLIX II v2: VOLIX II (available at <a href="https://www.fh-aachen.de/en/people/schuba/forschung/it-forensik/projekte/volix-en">https://www.fh-aachen.de/en/people/schuba/forschung/it-forensik/projekte/volix-en</a>) is a GUI <a id="_idIndexMarker715"/>frontend for Volatility. It allows you to combine commands to enhance usability and speed. It saves you the effort of working with a CLI and enables you to point and click to achieve the same result.</li>
    </ul>
    <p class="normal">We will discuss the use of some of these open-source options.</p>
    <h2 id="_idParaDest-159" class="heading-2">Using Bulk Extractor</h2>
    <p class="normal">Let’s look<a id="_idIndexMarker716"/> at how<a id="_idIndexMarker717"/> Bulk Extractor works:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Bulk Extractor’s documentation lists the following information about its output:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_09.png" alt="Table  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 7.9: Bulk Extractor output options</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">You will <a id="_idIndexMarker718"/>need to left-click on <strong class="screenText">Tools</strong> and select <strong class="screenText">Run bulk_extractor…</strong> to start analyzing your memory dump, as shown in the following screenshot. When you run Bulk Extractor, the viewer will present itself:
    <figure class="mediaobject"><img src="img/B18329_07_10.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.10: Bulk Extractor menu – the run bulk extractor option</p>
    <p class="normal">It will then <a id="_idIndexMarker719"/>present you with <a id="_idIndexMarker720"/>the <strong class="screenText">Run bulk_extractor</strong> menu.</p>
</li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="3">Direct the tool to the location of your image file and the output directory you wish to use. As shown in the following screenshot, you can see the numerous scanners that the Bulk Extractor tool uses to look for artifacts within the memory file:
    <figure class="mediaobject"><img src="img/B18329_07_11.png" alt="A picture containing graphical user interface  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 7.11: Bulk Extractor menu options to run</p>
    <p class="normal">You can<a id="_idIndexMarker721"/> check or uncheck a given<a id="_idIndexMarker722"/> specific artifact search as your needs dictate.</p>
</li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="4">Once you are satisfied with the setup, left-click on the <strong class="screenText">Submit Run</strong> button to start the extraction process. Once the extraction has started, it will present you with the extraction window, as shown in the following screenshot:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_12.png" alt="Bulk Extraction successful extraction window "/></figure>
    <p class="packt_figref">Figure 7.12: Bulk Extraction window</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="5">Left-click on <a id="_idIndexMarker723"/>the <strong class="screenText">Close</strong> button to go <a id="_idIndexMarker724"/>back to the viewer. The following screenshot shows the <strong class="screenText">Bulk Extractor Viewer</strong>:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_13.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.13: Bulk Extractor Viewer – extracted content</p>
    <p class="normal">On the left-hand side, we can see the specific artifacts recovered by the tool. In the preceding screenshot, I selected the <code class="inlineCode">email_histogram.txt</code> file, which gives us a list of times it found a particular email address. By looking at the histogram window, I can see that it found the <code class="inlineCode">jcloudy1</code> email address over 8,000 times. As you go through the email list, you may find emails of evidentiary interest to follow up while using traditional media.</p>
    <p class="normal">Bulk Extractor<a id="_idIndexMarker725"/> is a quick and efficient tool used to extract<a id="_idIndexMarker726"/> data strings that you can follow up in your investigation. The following tool we will discuss is Volix II.</p>
    <h2 id="_idParaDest-160" class="heading-2">Using VOLIX II</h2>
    <p class="normal">Volix is a GUI<a id="_idIndexMarker727"/> frontend for the Volatility framework. It <a id="_idIndexMarker728"/>makes it a bit easier for those who are not comfortable <a id="_idIndexMarker729"/>using a <strong class="keyWord">command-line interface</strong> (<strong class="keyWord">CLI</strong>). Once the program has been downloaded and you start it for the first time, it will present you with the following screen:</p>
    <p class="packt_figref"><img src="img/B18329_07_14.png" alt="Volix settings "/></p>
    <p class="packt_figref">Figure 7.14: Volix settings</p>
    <p class="normal">Then, you will be pointed to the location of the Volatility framework. You can use either the standalone executable or the binary files to run the Python scripts. Here, I have already downloaded the standalone executable and have pointed Volix to it.</p>
    <p class="normal">The other options you can select include the language you wish to use Volix in. If you have a VirusTotal API key, you can insert it on that page. This will compare the data captured from RAM and see if it matches any malware being tracked by VirusTotal.</p>
    <p class="normal">You also have the option of pointing Volix to the John the Ripper executable. If you want to decode/decrypt potential passwords that may be stored in the RAM, follow these steps:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Once you’ve selected <strong class="screenText">Case</strong>, choose <strong class="screenText">New</strong>. It will ask you the location of the memory file<a id="_idIndexMarker730"/> you wish to analyze, as shown in the<a id="_idIndexMarker731"/> following screenshot:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_15.png" alt="Volix RAM location "/></figure>
    <p class="packt_figref">Figure 7.15: Volix RAM location</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="2">If you click on <strong class="screenText">Reporting</strong>, you can specify the path for the report file that Volix will generate.</li>
      <li class="numberedList">Once you select <strong class="screenText">OK</strong>, the Volix wizard screen will appear. You now have the option of going through a questionnaire to determine what options you wish to run on the memory file. You can also select one of the pre-created scripts to search for that specific artifact, such as <strong class="screenText">Virus detection</strong> or <strong class="screenText">Decrypt SAM Hashes</strong>, as shown in the following screenshot:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_16.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.16: VOLIX wizard</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="4">I selected <a id="_idIndexMarker732"/><strong class="screenText">Complete Scan</strong>. You can see the<a id="_idIndexMarker733"/> results in the following screenshot:</li>
    </ol>
    <figure class="mediaobject"><img src="img/B18329_07_17.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.17: Volix scan results</p>
    <p class="normal">From the preceding screenshot, you can see I have selected <code class="inlineCode">getsids</code>. Below this on the screen, it has pulled out the SIDs that were in memory at the time of collection.</p>
    <p class="normal">How many artifacts you ask it to search for at once will dictate the length of time for the application to <a id="_idIndexMarker734"/>complete. Overall, it is a relatively quick <a id="_idIndexMarker735"/>search compared to other tools.</p>
    <h1 id="_idParaDest-161" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, you learned about the cornucopia of artifacts you can recover from RAM. You learned about the different tools you can use for the collection process and the tools you can use for analysis. Remember that the tools are constantly changing with the technology, and as new operating systems are released, your primary tool may not be able to collect RAM data. Always have a backup plan in case something like that occurs.</p>
    <p class="normal">You now have the skills to identify and capture RAM in a manner that conforms to best practices. As you analyze the RAM you have captured, you may find artifacts showing the user’s activity on the system, such as social media artifacts and passwords or encryption keys that can be recovered.</p>
    <p class="normal">You may even find information relating to the user’s use of email, which will lead us to our next chapter, which is all about email forensics.</p>
    <h1 id="_idParaDest-162" class="heading-1">Questions</h1>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Which of the following are sources of RAM data?<ol class="alphabeticList" style="list-style-type: lower-alpha;">
          <li class="alphabeticList" value="1">Physical memory</li>
          <li class="alphabeticList"><code class="inlineCode">Pagefile.mem</code></li>
          <li class="alphabeticList"><code class="inlineCode">Swapfile.page</code></li>
          <li class="alphabeticList">ROM</li>
        </ol>
      </li>
      <li class="numberedList">Which file is created when the computer goes to sleep?<ol class="alphabeticList" style="list-style-type: lower-alpha;">
          <li class="alphabeticList" value="1"><code class="inlineCode">Pagefile.sys</code></li>
          <li class="alphabeticList"><code class="inlineCode">Swapfile.sys</code></li>
          <li class="alphabeticList"><code class="inlineCode">Hiberfill.sys</code></li>
          <li class="alphabeticList"><code class="inlineCode">Hibernation.sys</code></li>
        </ol>
      </li>
      <li class="numberedList">When should you capture RAM?<ol class="alphabeticList" style="list-style-type: lower-alpha;">
          <li class="alphabeticList" value="1">Every hour</li>
          <li class="alphabeticList">Every week</li>
          <li class="alphabeticList">In every digital forensic investigation</li>
          <li class="alphabeticList">When you deem it important</li>
        </ol>
      </li>
      <li class="numberedList">In general, how many items do you need in order to collect RAM?<ol class="alphabeticList" style="list-style-type: lower-alpha;">
          <li class="alphabeticList" value="1">1</li>
          <li class="alphabeticList">2</li>
          <li class="alphabeticList">3</li>
          <li class="alphabeticList">4</li>
        </ol>
      </li>
      <li class="numberedList">DumpIt is a GUI tool.<ol class="alphabeticList" style="list-style-type: lower-alpha;">
          <li class="alphabeticList" value="1">True</li>
          <li class="alphabeticList">False</li>
        </ol>
      </li>
      <li class="numberedList">It is acceptable to install DumpIt on the suspect’s computer.<ol class="alphabeticList" style="list-style-type: lower-alpha;">
          <li class="alphabeticList" value="1">True</li>
          <li class="alphabeticList">False</li>
        </ol>
      </li>
      <li class="numberedList">Which of the following are analysis tools?<ol class="alphabeticList" style="list-style-type: lower-alpha;">
          <li class="alphabeticList" value="1">DumpIt</li>
          <li class="alphabeticList">FTK Imager</li>
          <li class="alphabeticList">Volatility</li>
          <li class="alphabeticList">MD5 hash</li>
        </ol>
      </li>
    </ol>
    <h1 id="_idParaDest-163" class="heading-1">Further reading</h1>
    <p class="normal">Ligh, M. H., Case, A., Levy, J., &amp; Walters, A. (2014). <em class="italic">The Art of Memory Forensics: Detecting Malware and Threats in Windows</em>, Linu. John Wiley &amp; Sons. (Available at <a href="https://www.amazon.com/Art-Memory-Forensics-Detecting-Malware/dp/1118825098">https://www.amazon.com/Art-Memory-Forensics-Detecting-Malware/dp/1118825098</a>.)</p>
  </div>
  <div><h1 id="_idParaDest-164" class="heading-1">Join our community on Discord</h1>
    <p class="normal">Join our community’s Discord space for discussions with the author and other readers:</p>
    <p class="normal"><a href="https://packt.link/CyberSec">https://packt.link/CyberSec</a></p>
    <p class="normal"><img src="img/QR_Code3852467292877112093.png" alt=""/></p>
  </div>
</body></html>