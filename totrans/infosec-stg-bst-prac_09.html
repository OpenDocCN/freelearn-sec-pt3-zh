<html><head></head><body>
		<div><h1 id="_idParaDest-104"><a id="_idTextAnchor112"/>Chapter 6: Designing and Managing Security Testing Processes</h1>
			<p>Now that you have a good understanding of the controls that can be put into place so that you have a functioning security strategy in your organization, my guess is that you've implemented several of them, and now, you're free to just chill out, browse LinkedIn, and watch Netflix on your work computer for the next few years until your retirement. Congratulations! You've earned the gold watch. </p>
			<p>Oh, you just got <em class="italic">pwned</em>. Whoops. How did that happen? Well, there was a huge gap that you didn't consider in your design, and you didn't have anybody else <em class="italic">sanity check</em> the architecture, nor did you have any internal or external team perform a <em class="italic">penetration test</em> on your environment. You want a second pair of eyes, and often, you'll want that second pair of eyes to be a technical wizard – one with no ties to your organization, who isn't concerned about offending their colleagues or bosses with negative observations. </p>
			<p>You want answers. YOU WANT THE TRUTH! Do your security controls work? Are there ways around the controls? Does your staff find the implementation of the controls annoying or difficult to work with? </p>
			<p>When I'm talking about InfoSec, it will often come back to adopting a mindset of continuous improvement, and that will, of course, include testing your existing implementations and improving on any findings for smoother-running, optimized information security programs. Oh, and of course, it goes without saying that you prioritize actions based on… Do you know what I'm going to say? I hope so: risk. </p>
			<p>In this chapter, we're going to cover the following topics: </p>
			<ul>
				<li>Preparing for security assessments</li>
				<li>Understanding the different types of security assessments</li>
				<li>Best practices in performing security assessments</li>
				<li>Interpreting results from security assessments</li>
			</ul>
			<p>By the end of this chapter, you will be able to understand security control testing, including scheduling for external and internal security audits, how to analyze reports and review the test results, and also how to manage the actions that arise from each assessment. </p>
			<p>Let's get started! First of all, let's look at what we need to test, and how we are going to test them. </p>
			<h1 id="_idParaDest-105"><a id="_idTextAnchor113"/>Preparing for security assessments</h1>
			<p>How do we know our systems are secure from attackers? How do we know that our systems are resilient? How do we know that our systems are appropriately redundant? </p>
			<p>Unfortunately, the answer <a id="_idIndexMarker698"/>simply cannot be "<em class="italic">because I designed them myself</em>" (sunglasses on, standing on a Segway in the elevator). A second pair of eyes is important, at the very least. Why do I say, "at the very least"? Sometimes, your second pair of eyes is a colleague who either doesn't have the appropriate knowledge, or the appropriate segregation from the organization, in order to make the observations they might make if they didn't have a boss that was going to be offended by their input. </p>
			<p>First of all, you need <em class="italic">buy-in from Top Management</em>. This is another classic theme in this book, and a classic theme in Information Security that you'll see in various standards. For example, in <em class="italic">ISO 27001</em>'s requirements (<a href="https://www.iso.org/standard/54534.html">https://www.iso.org/standard/54534.html</a>), <em class="italic">Clause 5</em> talks about <em class="italic">Leadership</em>, while <em class="italic">Clause 9.3</em> is about <em class="italic">Management Review</em>. <em class="italic">Clause 5</em> states that Top Management is required to be involved in creating the Information Security Policy. <em class="italic">Clause 9.3</em> is set on having Top Management be continually involved in evaluating your Information Security Management System to ensure that it is effective. </p>
			<p>Like we've said previously, how is some crusty old person from Management going to do that, when they still haven't picked up on how to use formulas in Excel? It's pretty simple: they greenlight the spending and formally react to the findings, either greenlighting the expenses required to remediate or accepting the risks. Of course, as the Information Security Professional in your organization, you are going to have to translate the findings for Top Management to understand, and it's important to do so in a way that is easy to understand and highlights any risks. </p>
			<p>Let's look at how we can choose the right assessment solutions, based on organizational requirements. </p>
			<h2 id="_idParaDest-106"><a id="_idTextAnchor114"/>Defining your requirements</h2>
			<p>You have a plethora of information, systems, buildings, and other sensitive or confidential <a id="_idIndexMarker699"/>assets that you have implemented controls to protect. In order to say they're secure (and that the <em class="italic">CIA Triad</em> is intact), you need to ensure those controls are effective in preventing unauthorized access, unauthorized modification, and ensuring availability. Right? Right. </p>
			<p>It's a simple thing to write, and less simple to execute, especially if your organization does a million different things. If you reach out to an Information Security consultancy, you might be lucky and get in touch with a salesperson who truly cares about your organization, and then refuses to sell assessments that aren't appropriate or required. That would be a great situation for you, but at the same time, it's important to ensure you know what you need before buying something, and also, how do you know that's the type of salesperson you're in touch with? </p>
			<p>Additionally, do you want to pay a consultancy to assess your systems before you've had a chance to properly assess them internally? Not only does it sound like a waste of money, but it also seems slightly irresponsible to immediately hand it over to somebody else without any knowledge. I mean, what are we? Top Management?! </p>
			<p>First, we want to refer to any of the standards or regulations that we need to abide by and document if there are any requirements for security assessments as a result of those. There are two reasons why I suggest this: </p>
			<ul>
				<li>First, we can accept that the standards and regulations exist for a reason and that they contain best practices for all organizations, including ours. </li>
				<li>Second, you stand to be fined, or lose your certification against the standard in a future audit if you haven't complied with the requirements. Sometimes, your organization has business operations and relationships that are tied to the maintenance of various standards, such as <strong class="bold">Payment Card Industry Data Security Standard</strong> (<strong class="bold">PCD-DSS</strong>), and being able to process card payments. </li>
			</ul>
			<p>Sometimes, such as with PCI-DSS for example, standards have different assessment requirements <a id="_idIndexMarker700"/>based on the <a id="_idIndexMarker701"/>activities of your organization. For low-volume <a id="_idIndexMarker702"/>processing, you might only need to fill in a <strong class="bold">Self-Assessment Questionnaire</strong> (<strong class="bold">SAQ</strong>), rather than have a <strong class="bold">Qualified Security Assessor</strong> (<strong class="bold">QSA</strong>) evaluate your systems. </p>
			<p>Let's look <a id="_idIndexMarker703"/>a bit closer at PCI-DSS's 12 high-level <a id="_idIndexMarker704"/>requirements as an example: </p>
			<ol>
				<li>Implementing and maintaining effective firewalls </li>
				<li>Changing all default passwords </li>
				<li>Encrypting cardholder data at rest </li>
				<li>Encrypting cardholder data in transit </li>
				<li>Implementing and maintaining malware protection </li>
				<li>Updating and patching systems against vulnerabilities </li>
				<li>Access control for cardholder data </li>
				<li>Access control for system components </li>
				<li>Access control for physical access to cardholder data </li>
				<li>Monitoring all access to cardholder data and network resources </li>
				<li>Testing systems regularly </li>
				<li>Maintaining an Information Security Policy for all employees </li>
			</ol>
			<p>Now, let's imagine your organization requires a QSA due to the amount of <em class="italic">payment processing</em> they do. These QSAs are going to assess if your organization meets the requirements of these 12 high-level requirements (and the 220+ sub-requirements in total). If you aren't able to demonstrate these, your organization faces the risk of fines, or not being able to take certain types of payments. </p>
			<p>When we're looking at the testing that we will need to do to prepare for the <em class="italic">PCI-DSS assessment</em>, and to ensure your organization complies with the standard before the QSA turns up at your door, it's important to schedule testing that documents the findings of each of these points. We do this to make sure our organization is able to take payments and doesn't get fined. We have a list of requirements, including <em class="italic">Requirement 11</em>, which is to <em class="italic">test all systems, processes, and software</em> to gain visibility on any vulnerabilities that can be exploited by malicious actors, and then applying the appropriate controls. </p>
			<p>There are other reasons an organization might want to perform a security assessment on various <a id="_idIndexMarker705"/>systems in their organization, even if they don't have specific regulatory requirements to do so. This could include being unsure if your organization's intellectual property is appropriately protected, or to check that your implemented controls are effective in protecting against threats. Perhaps you think that the security of your organization is poor, but nobody is listening to you. In that circumstance, you likely don't have buy-in from Top Management, but might be able to get more attention and/or budget by having professionals demonstrate how a threat might exploit any vulnerabilities. The decision to do this isn't something I can advocate, but it could prove effective. It could also get you into hot water, so try your best to get that buy-in from whomever you report to. </p>
			<p>When we're looking at which assessment we might choose to undertake, it depends on what your requirements are, and on your strategy. Some examples of things you might be able to define before making your decision could include the following: </p>
			<ul>
				<li>Why is the assessment being performed? <p>— <strong class="bold">Compliance</strong>: Sometimes, organizations just need to tick a box. The reality for <a id="_idIndexMarker706"/>some consultants is that they perform compliance assessments for the vast majority of their work lives. If this is the main driver for your organization, then it might not be worthwhile to pay for a higher-value assessment. </p><p>— <strong class="bold">Striving for Improvement</strong>: In this circumstance, the organization might be compliant <a id="_idIndexMarker707"/>with requirements, but wants to be better protected than they currently are. In this circumstance, you might be looking for a higher-value assessment, and therefore something a bit more expensive, or from a more well-known firm. </p><p>Additionally, security assessments are useful in reducing costs through finding errors quickly, in a private setting that allows for the team to revise any findings, as well as protect them from any reputational damage that would occur from a breach.</p></li>
				<li>What is being tested? What is the scope? <p>— <strong class="bold">Software</strong>: Do you want to see if the software your organization has created is secure <a id="_idIndexMarker708"/>from infiltration or misuse? Do you want to check if your fileshare software or operating system implementation is appropriately configured? There are various assessments for software, such as web app penetration tests, security scans, internal penetration tests, external penetration tests, and so on. </p><p>— <strong class="bold">Hardware</strong>: Has your organization created or purchased a physical device, such as <a id="_idIndexMarker709"/>an ATM, lock system, or cryptocurrency wallet? You will want a hardware security tester to assess if it's secure enough to protect whatever it needs to protect. </p><p>— <strong class="bold">Networks</strong>: Mentioned previously to some degree, you might want to see what a <a id="_idIndexMarker710"/>low-privilege user inside your organization would be able to achieve with their own credentials. You might want to see if somebody can enter your network and escalate their privileges from the outside world. Do you want to include social engineering in this? Do you want to test your physical security along with this? </p><p>— <strong class="bold">Employee Awareness and Physical Security</strong>: Social <a id="_idIndexMarker711"/>engineering assessments such <a id="_idIndexMarker712"/>as phishing campaigns, which email users with fake tracking links, testing their ability <a id="_idIndexMarker713"/>to spot social engineering attacks. </p><p>— <strong class="bold">Physical Security</strong>: Are you interested in a "Black Team," where security assessors physically (and digitally) infiltrate your premises? Do employees let strangers <a id="_idIndexMarker714"/>into restricted areas? How much information does somebody have access to in that circumstance? </p></li>
				<li>How much time will you allow the assessor? <p>— Sometimes, a well-planned campaign could take months to properly plan and execute. What type of threat are you trying to simulate? </p></li>
				<li>When do you need the assessment completed by? <p>— Information Security is booming, but there is a talent shortage currently, which could lead to delays in having an assessment be completed. Make sure to plan ahead of time, and speak to various businesses to see what their lead time is like. </p></li>
				<li>What is your budget for this particular assessment? <p>— If you want a "Red Team" assessment, where a team of assessors plan for a long period of time and simulate a real threat over a long time period, but you only have $5,000 and no monitoring or "Blue Team," you might need to reconsider what you're looking for. </p></li>
			</ul>
			<p>When you <a id="_idIndexMarker715"/>speak with various third parties that offer security assessments, it's worthwhile to ask them what their methodologies are, and if they have any references for the specific type of task you're looking to undertake. Additionally, it might be worthwhile to speak with the assessor(s) prior to the engagement and/or see their CVs. </p>
			<p>Another important requirement is your terms. For one, you don't want the assessment to take down your <em class="italic">production systems</em> and cost your organization money in lost revenue. That's not good for anybody, and you want to work with a third party that is experienced <a id="_idIndexMarker716"/>in preventing that from happening. Furthermore, you don't want your weaknesses shared, especially not before you <a id="_idIndexMarker717"/>have the chance to remediate them. One way to prevent unauthorized sharing is to set up various terms, including <strong class="bold">Non-Disclosure Agreements</strong>, or <strong class="bold">NDAs</strong>.<strong class="bold"> </strong></p>
			<p>Now that we have covered the high-level ideas surrounding the questions you might like to ask yourself and the members of your organization before getting involved with a security assessment, I think it's a good idea to move on to the types of security assess<a id="_idTextAnchor115"/>ments we might see.</p>
			<h1 id="_idParaDest-107"><a id="_idTextAnchor116"/>Understanding the different types of security assessments</h1>
			<p>There <a id="_idIndexMarker718"/>are various security assessments available that can help you understand any of the following: </p>
			<ul>
				<li>Your entire organization's security posture </li>
				<li>Your hardware product's security control effectiveness </li>
				<li>Your software product's security control effectiveness </li>
				<li>Your building's security </li>
				<li>Your staff's security awareness </li>
				<li>Your security staff's ability to respond to an active threat </li>
			</ul>
			<p>Beyond that list, there are various methods in performing these types of assessments, including having your own staff members perform an <strong class="bold">internal review</strong>, or having another organization perform a <strong class="bold">third-party review</strong>. Furthermore, automated testing can be performed. </p>
			<p>Internal reviews are effective in reducing costs, and in some circumstances, they can save time, providing the internal team is well-acquainted with the processes they are reviewing. However, internal reviews lack objectivity and may suffer from a lack of "fresh eyes" on the target. </p>
			<p>Third-party reviews are performed by industry experts who break into software, hardware, buildings, and organization's information systems every day for a living. Their findings are generally provided in a fairly standardized report, which may also provide remediation actions and strategic advice for your organization on the next steps that can be taken. Additionally, third parties benefit from being honest and open with their customers about their flaws, providing it's not simply a compliance box-ticking assessment. </p>
			<p>On the <a id="_idIndexMarker719"/>other hand, <em class="italic">third-party reviews</em> can be expensive, time-consuming, and can lack relevance if they aren't well-planned and well-defined in collaboration between the assessors and your organization.</p>
			<p>Overall, security assessments have both upside and downside potential. They run the risk of costing the organization time, money, and reducing available capacity to create new value, but they provide the opportunity to shed light on security issues that could cost the organization more money in the long run through reputational, regulatory, or theft-related damages. </p>
			<p>Let me define what each of the assessments might entail. </p>
			<h2 id="_idParaDest-108"><a id="_idTextAnchor117"/>Automated assessments and scanning</h2>
			<p>In <a id="_idIndexMarker720"/>automated assessments <a id="_idIndexMarker721"/>and security scans, you are relying on software to detect <em class="italic">known security vulnerabilities</em> based on various pieces of information that's been gathered and compared against a vulnerability dataset. Let me briefly explain a few times where automated scans can be performed. </p>
			<h3>Web Application Vulnerability Scanners</h3>
			<p>Generally, <strong class="bold">web application vulnerability scanners</strong> can be pointed toward an IP or URL <a id="_idIndexMarker722"/>for your organization's web application and told to "scan" for vulnerabilities by interpreting <em class="italic">HTTP responses</em> to gain information about your software. Then, it can compare <a id="_idIndexMarker723"/>that information against a dataset of known vulnerabilities. </p>
			<p>Beyond that, they may check for exposed files that could be used to access confidential information or escalate privileges, such as finding <code>/readme.html</code> in a WordPress site, which then reveals the WordPress version to the software. </p>
			<p>Many of these <a id="_idIndexMarker724"/>scanners will include <strong class="bold">fuzzers</strong>, which check for <strong class="bold">SQL injection</strong> and <strong class="bold">Cross-Site Scripting</strong> (<strong class="bold">XSS</strong>) in order to detect previously unknown vulnerabilities. Fuzzers <a id="_idIndexMarker725"/>automate the initial process that a penetration <a id="_idIndexMarker726"/>tester (or malicious actor) would undertake to determine if a user input is vulnerable, and once that vulnerability is found, the tester would take time to modify and utilize the vulnerability to gain information or access. </p>
			<p>Furthermore, if your web app allows login capabilities, most <strong class="bold">web application vulnerability scanners</strong> will allow you to provide credentials for authentication, which will simulate an attack from a malicious actor that is already "inside" the login barrier. </p>
			<p>Many of the paid-for proprietary web app vulnerability scanners will have built-in "profiles" that are catered for different types of applications, in order to reduce scan time, or to simulate different degrees of attack. </p>
			<p>Once the scanner has been configured properly, you can run the scan against your organization's web app, and upon completion, the software will generally package the findings in a report or web dashboard with explanations of each finding, vulnerability scores based on risk, and potential next steps for remediation. </p>
			<p>If you have a web application facing the outside world, it's likely that malicious actors have already run automated scans against your server and application in order to check for vulnerabilities, often by one of the <strong class="bold">open source tools</strong> listed further down. It's difficult to <strong class="bold">IP Blacklist</strong> these attacks, as they're often undertaken from IP addresses of compromised machines, or simply don't follow a specific pattern. Activities such as these are occurring every moment, across the internet. These scans are from groups that are likely looking for "low-hanging fruit," so it's important to run these scans against <a id="_idIndexMarker727"/>your own apps and interpret if the results would lead to an opportunity. <strong class="bold">Web application firewalls</strong> are able to detect these activities and prevent too much information from being divulged, but your best defense in this regard is to ensure that security updates for your server's OS and web app's software packages are implemented promptly. </p>
			<p>Here <a id="_idIndexMarker728"/>are some examples <a id="_idIndexMarker729"/>of web application vulnerability scanners, split into proprietary and open source options: </p>
			<ul>
				<li><strong class="bold">Proprietary</strong>: <p>a) Tenable.io/Nessus </p><p>b) Rapid7 InsightAppSec </p><p>c) Acunetix </p><p>d) Detectify </p><p>e) WP Scan </p></li>
				<li><strong class="bold">Open source</strong>: <p>a) Nikto </p><p>b) OWASP <strong class="bold">Zed Attack Proxy</strong> (<strong class="bold">ZAP</strong>) </p><p>c) w3af </p><p>d) OpenVAS </p></li>
			</ul>
			<p>If you are <a id="_idIndexMarker730"/>planning on setting up your own web application vulnerability scanner, either open source or from a vendor, you should consider a couple of common questions surrounding the implementation of vulnerability scanning activities. </p>
			<p><em class="italic">Do you have the resources to maintain an internal system? </em></p>
			<p>If you don't have dedicated staff who have maintaining internal vulnerability scanners in their job description, it might be useful to outsource that requirement to a third party who offers a managed service, maintaining and updating the scanner to ensure you have up-to-date and relevant results. </p>
			<p>Another question worth asking is as follows: </p>
			<p><em class="italic">Are you planning to scan against your production web application? </em></p>
			<p>If your organization relies on your web app to make money and has SLAs with customers to ensure uptime, does it make sense to run a scan against it that has the potential to either slow it down or take it down? </p>
			<p>An <a id="_idIndexMarker731"/>alternative solution <a id="_idIndexMarker732"/>is to set up a <em class="italic">pentest</em> or <em class="italic">scanning environment</em>, which is a <em class="italic">1:1 clone</em> of your production environment in terms of software but has a dummy dataset, usually running on completely separate (much less expensive) hardware. There are many advantages to this solution: </p>
			<ul>
				<li>You can <strong class="bold">IP Whitelist</strong> to the scanner's <em class="italic">IP range</em>, which is generally provided by the vendors in their documentation. If you have set up a web app vulnerability scanner yourself, you'll know the IPs. This gives you the ability to limit the amount of work the server will need to do, ensuring that the requirements for that environment are less expensive than the production environment, and therefore will cost significantly less money than a true replication would. </li>
				<li>You avoid the risk of taking your production systems down from a scan, because the test environment doesn't share any resources with the system that is making you money. </li>
				<li>You might <a id="_idIndexMarker733"/>have a <strong class="bold">web application firewall</strong> (<strong class="bold">WAF</strong>) on your production environment, but in your pentest environment, you are able to test your application specifically, rather than testing the WAF itself. In this circumstance, you can whitelist the scanner IP through the WAF, in order to pass any requests through without inspection. </li>
			</ul>
			<p>It's a good idea to use different credentials and accounts on your testing environment, and to use a dummy dataset rather than your production dataset for privacy and confidentiality purposes. Additionally, it will save money to have a "pentest" dataset that occupies less storage than your production dataset does. </p>
			<h3>Network Vulnerability Scanners</h3>
			<p><strong class="bold">Network vulnerability scanners</strong> are <a id="_idIndexMarker734"/>very similar <a id="_idIndexMarker735"/>in their functionality and operation to <strong class="bold">web application vulnerability scanners</strong>, but instead focus on your organization's network environment, including the devices and services used by your employees. </p>
			<p>Many of <a id="_idIndexMarker736"/>the vulnerability scanner vendors are incorporating both web app and network scans into their solutions, offering an all-in-one or "single pane of glass" unified approach to automated vulnerability assessments. </p>
			<p>Generally, what you will want from a network vulnerability scanner is for it to perform the following tasks: </p>
			<ul>
				<li>Discover both devices and software assets inside the network.</li>
				<li>Determine versions of software and operating system versions of devices.</li>
				<li>Check for known vulnerabilities from the information gathered.</li>
				<li>Report on and prioritize remediation steps based on risk/vulnerability scores.</li>
			</ul>
			<p>Many solutions offer extra functionality, including the following: </p>
			<ul>
				<li>Dark web monitoring, to check if credentials for your organization have been detected on marketplaces</li>
				<li>Logging <a id="_idIndexMarker737"/>network events such as user activities <a id="_idIndexMarker738"/>and correlation with alarms</li>
				<li>An <strong class="bold">Intrusion Detection Systems</strong> (<strong class="bold">IDS</strong>) for <strong class="bold">Network</strong> (<strong class="bold">NIDS</strong>), <strong class="bold">Hosts</strong> (<strong class="bold">HIDS</strong>), and <a id="_idIndexMarker739"/>the cloud</li>
				<li>Endpoint detection, likely from network event heuristics</li>
			</ul>
			<p>Essentially, what this means is that the <strong class="bold">network vulnerability scanner</strong> software is able to collect information about your internal network environment, and then determine if vulnerabilities exist that a malicious actor could exploit in order to enter your estate and subsequently "pivot" to escalate their privileges while inside the network, resulting in compromise. </p>
			<p>If you're running outdated operating systems in your organization, such as <em class="italic">Windows 2008 or 2012 Server</em> or <em class="italic">Windows 7 Desktop</em>, your network vulnerability scanner is going to light up like a Christmas tree, and you're going to end up with a massive amount <a id="_idIndexMarker740"/>of work to complete in order to remediate these issues. That being said, it's much, much cheaper <a id="_idIndexMarker741"/> to run this scan than it is to pay thousands of dollars to a security firm, and then have a <em class="italic">penetration tester</em> own your network in a couple of hours. By remediating the findings in the network vulnerability scanner, you're <em class="italic">removing the low-hanging fruit</em> and increasing the amount of skill required in order to compromise your organization's network. </p>
			<p>Some <a id="_idIndexMarker742"/>examples of network Vulnerability <a id="_idIndexMarker743"/>scanners, split into <em class="italic">proprietary</em> and <em class="italic">open source</em> options, could include the following: </p>
			<ul>
				<li><strong class="bold">Proprietary</strong>:<p>a) Microsoft Security Suite </p><p>b) Tenable.io/Nessus </p><p>c) Rapid7 InsightVM </p><p>d) AT&amp;T Cybersecurity USM Anywhere </p><p>e) Acunetix </p><p>f) Detectify </p><p>g) WP Scan </p></li>
				<li><strong class="bold">Open source</strong>: <p>a) Nikto </p><p>b) OWASP <strong class="bold">Zed Attack Proxy</strong> (<strong class="bold">ZAP</strong>) </p><p>c) w3af </p><p>d) OpenVAS </p></li>
			</ul>
			<p>Further to doing vulnerability scans in your environment, it's also important to consider vulnerabilities in any software that your organization develops, so let's look at this scenario in more detail. </p>
			<h3>Software Development Life Cycle (SDLC) or DevSecOps Scanning</h3>
			<p>If <a id="_idIndexMarker744"/>your organization develops software, either for internal use, customer use, or use by the <a id="_idIndexMarker745"/>general public (including a website), then it is imperative to implement secure practices in the <strong class="bold">Software Development Life Cycle</strong> (<strong class="bold">SDLC</strong>). </p>
			<p>There <a id="_idIndexMarker746"/>are many opportunities and stages in <a id="_idIndexMarker747"/>which vulnerabilities can be implemented in the process, and in <a href="B16611_08_Final_JM_ePub.xhtml#_idTextAnchor150"><em class="italic">Chapter 8</em></a>, <em class="italic">Improving the Security of Software</em>, we will be going into how to improve the security of software and enforcing a secure software development life cycle. Until then, it's still worth looking at the scanners that can be implemented along the way to check for vulnerable code or software packages, including the following: </p>
			<ul>
				<li><strong class="bold">Static Application Security Testing</strong> (<strong class="bold">SAST</strong>) tools scan through the source code <a id="_idIndexMarker748"/>of your software. They're <a id="_idIndexMarker749"/>usually either implemented in your developers' <strong class="bold">Integrated Development Environment (IDE)</strong> or set up to automatically scan new entries or pushes to your code repository, such as GitHub, BitBucket, or GitLab. By scanning the source code, the software might be able to find common pitfalls and mistakes that lead to software vulnerabilities, such as <em class="italic">XSS</em> and <em class="italic">SQL Injection</em>, after the app <a id="_idIndexMarker750"/>goes live. Common examples of SAST tools include GitLab's integrated SAST tool and <em class="italic">SonarQube / SonarCloud</em>. </li>
				<li><strong class="bold">Dynamic Application Security Testing</strong> (<strong class="bold">DAST</strong>) tools are essentially the same <a id="_idIndexMarker751"/>as the previously discussed web application vulnerability scanners. They allow you to scan the software via information gathering and fuzzing after it is compiled and running. Usually, DAST is mentioned in relation to the software development life cycle, with the ideology that you can automatically trigger a scan of an ephemeral test environment for every new change that's made to the application source code by a developer, and then reject the change from being <em class="italic">merged</em> into a production codebase based on if it doesn't meet a baseline requirement for security, as determined by the results of the scan. Essentially, what I'm saying is that web application vulnerability scanners are generally able to be configured as DAST tools in the software's <em class="italic">CI/CD pipeline</em>, or on a regular basis. <p>Examples <a id="_idIndexMarker752"/>of DAST tools include <strong class="bold">Acunetix</strong>, <strong class="bold">Rapid7 InsightAppSec/AppSpider</strong>, <strong class="bold">Tenable.io/Nessus</strong>, and OWASP's <strong class="bold">Zed Attack Proxy</strong> (<strong class="bold">ZAP</strong>). </p></li>
				<li><strong class="bold">Dependency scanning</strong> tools allow you to scan dependencies brought in by software <a id="_idIndexMarker753"/>imports. Often, developers leverage software that has already been created by another party, which avoids the time-consuming development process and reduces the complexity of implementation, but also increases the likelihood of introducing <em class="italic">known vulnerabilities</em> into the software. Dependency scanners will check the imported modules and versions of those modules against a database of known vulnerabilities to ensure that your software isn't utilizing a vulnerable version of third-party code. <p>Examples <a id="_idIndexMarker754"/>of <em class="italic">dependency scanners</em> include the following: </p><p>a) <strong class="bold">Snyk.io</strong> assesses the imports for several languages, including JavaScript, Java, .NET, Python, GoLang, PHP, and others. </p><p>b) <strong class="bold">Node Package Manager</strong> (<strong class="bold">NPM</strong>) has some built-in dependency scanners for JavaScript. </p><p>c) <strong class="bold">OWASP Dependency-Check project</strong>.</p></li>
			</ul>
			<p>Now that <a id="_idIndexMarker755"/>we've covered various methods of performing <a id="_idIndexMarker756"/>automated scans on your organization's digital estate, I think it makes sense to look into other <em class="italic">internal assessments</em> that can be performed by employees inside your organization. </p>
			<h2 id="_idParaDest-109"><a id="_idTextAnchor118"/>Internal assessments</h2>
			<p>Internal assessments <a id="_idIndexMarker757"/>are those that can <a id="_idIndexMarker758"/>be performed without help from external (third-party) experts. Let's look at a few different types of internal assessments that you can undertake.</p>
			<h3>Employee security awareness assessments</h3>
			<p>We've <a id="_idIndexMarker759"/>spoken about giving our employees at our organization <strong class="bold">security awareness tests</strong> after training, to ensure that they have taken in the information provided, and as evidence of <em class="italic">due care</em> and <em class="italic">continual improvement</em> for your <em class="italic">compliance audits</em>. One method is to have a standardized test that the employees need to answer, in order to display knowledge in a question-and-answer format.</p>
			<p>Another way is to leverage tools that can perform <strong class="bold">phishing training</strong> on your employees, for example, by sending emails that they have been trained to spot and recording metrics around their responses. This can also be done by third parties as a <em class="italic">managed service</em>, if the overheads of maintaining internal software and creating new templates for emails isn't manageable internally. </p>
			<h3>Compliance audits </h3>
			<p>If your organization is subject to regulations such as the <strong class="bold">General Data Protection Regulation</strong> (<strong class="bold">GDPR</strong>) or the <strong class="bold">California Consumer Privacy Act</strong> (<strong class="bold">CCPA</strong>), or standards <a id="_idIndexMarker760"/> such as <em class="italic">ISO27001</em> or PCI-DSS in <a id="_idIndexMarker761"/>order to perform its core business objectives and <a id="_idIndexMarker762"/>serve its customers, it's crucial to understand the effectiveness of your controls and find any gaps between the compliance requirements and reality. </p>
			<p>To do so, <strong class="bold">internal compliance audits</strong> can be undertaken, as preparation for any future audits, by the regulating body or a third-party that performs the checks on their behalf. Simulating a third party, and investigating whether evidence exists on the effectiveness of a control implementation against requirements, is a great way to reduce the amount of time and effort required when you're actually paying expensive auditors to come and perform the assessment on your organization. </p>
			<p>You must make sure you keep notes and ensure that all the requirements are understood by the appropriate members of staff, so that the appropriate controls are implemented and compliance is maintained. Software solutions such as <em class="italic">Microsoft Compliance Manager</em> exist to track, assign, schedule, and record observations around compliance to over 300 global regulations, with explanations and guidelines on implementation methods that could be effective in your organization. </p>
			<h3>Red and Blue Teams</h3>
			<p>If you <a id="_idIndexMarker763"/>have a well-qualified internal security team, you <a id="_idIndexMarker764"/>may be able to split the team into a <strong class="bold">Red Team (offensive team)</strong> and a <strong class="bold">Blue Team (defensive team)</strong>, to simulate a malicious <a id="_idIndexMarker765"/>actor's methods into attacking your organization, test the defensive team's ability to respond to those attacks, and mitigate the harm that may result from this. </p>
			<p>Smaller organizations will have much more difficulty in this undertaking than mega-corporations with very large security teams and large budgets, but even large organizations may find that their team is better suited to undertaking defensive measures than offensive measures that have been mastered by penetration testers, all of which can be utilized through third-party engagement. </p>
			<p>With that, let's look at the third-party assessments that can be undertaken by your organization. </p>
			<h2 id="_idParaDest-110"><a id="_idTextAnchor119"/>Third-party assessments</h2>
			<p>When you want to assess if your control implementations are as effective as you estimated <a id="_idIndexMarker766"/>during your risk assessments <a id="_idIndexMarker767"/>or internal assessments, you will want to bring in a <strong class="bold">third-party assessor</strong>. When you want to test your <em class="italic">Blue Team's</em> effectiveness, you will want to bring in a third-party assessor. If you want to be able to show both prospective and current customers your security effectiveness, you will want to bring in a third-party assessor. When you want to comply with standards and regulations, you will need to bring in a third-party assessor. </p>
			<p>There are many reasons why you may want to, or need to, bring in a third party. It boils down to two specific ideologies: <em class="italic">objectivity</em> and <em class="italic">skill</em>. </p>
			<p>The penetration testers working at security firms get paid on a daily basis to "own" customer systems, both those that are highly advanced and "normal" to all extents. They use the tools the malicious actors will use, and they are efficient and skilled at offensive security. Furthermore, they don't need to appease anybody at your organization due to office politics or vested interests; they're objective, and their reports will be clear, generally standardized, and actionable. </p>
			<p>There are a wide variety of assessments that can be undertaken by third parties, and new "flavors" are being created all the time. I'll offer a few examples. </p>
			<p>Consider that we could (potentially) run any of the following security assessments as an internal review instead of having a third-party organization perform the test. </p>
			<h3>Technical assessments and penetration tests</h3>
			<p><strong class="bold">Technical assessments</strong> and <strong class="bold">penetration tests</strong> can come <a id="_idIndexMarker768"/>in different forms, but generally, the <a id="_idIndexMarker769"/>focus of the assessment is to see if vulnerabilities can be exploited in order to gain access, and then escalate privileges until access to confidential or sensitive data is attained:</p>
			<ul>
				<li><strong class="bold">Web application penetration tests</strong> are tests that are performed against a <em class="italic">web application</em> by a <em class="italic">penetration tester</em>, or multiple <em class="italic">pentesters</em>. It simulates a <a id="_idIndexMarker770"/>malicious actor that is trying to gain access and escalate privileges through functionalities and/or bugs in your organization's web application. </li>
				<li><strong class="bold">Network penetration tests</strong> are tests that are performed against an organization's network estate by a <em class="italic">penetration tester</em>, or multiple <em class="italic">pentesters</em>. It simulates <a id="_idIndexMarker771"/>either a malicious actor that is trying to gain access and escalate privileges remotely without any initial access through security vulnerabilities, or an internal threat that has limited access, and then tries to escalate privileges and access confidential or sensitive information through security vulnerabilities. </li>
				<li><strong class="bold">Red Teams and Black Teams</strong> are <strong class="bold">threat simulations</strong> that replicate a malicious <a id="_idIndexMarker772"/>actor attempting <a id="_idIndexMarker773"/>to infiltrate your organization by any means necessary. <strong class="bold">Red Teams</strong> are generally focused on Information Security, while <strong class="bold">Black Teams</strong> are generally focused on Physical Security. <p>Both Red Teams and Black Teams take much more planning and <em class="italic">reconnaissance</em> work than a traditional penetration test, but they represent a much higher-quality test overall. These are valuable for organizations who have good Information Security practices and procedures in place, with proven control effectiveness and a high level of security awareness across their employees. Generally, a <strong class="bold">Blue Team</strong> will be aware of the engagement and stand ready to defend the estate, which takes planning and preparation from your organization's perspective. </p></li>
			</ul>
			<p>Moving on from <em class="italic">penetration tests</em>, next, we will look at Risk Management and Governance Assessments. </p>
			<h3>Risk Management and Governance assessments</h3>
			<p>Moving <a id="_idIndexMarker774"/>away from the technical assessments, we have to the "boring" box-ticking world of compliance audits and Certifications Review. Here, business processes and policies are reviewed and tested for their effectiveness, with evidence requirements to satisfy the auditor. I've mentioned these audits before; they can include <em class="italic">PCI-DSS Compliance assessments</em> or <em class="italic">ISO27001 Certification assessments</em>, for example. </p>
			<p>These assessments have the potential to carry great value, provided that (the standard clause) the auditor is skilled, and you are being open and honest with the assessor. These assessors can spot gaps in your processes, procedures, and identify risks that you might not have thought of, in a way that can be easily translated by business stakeholders in your organization. </p>
			<p>Unfortunately, assessors can miss vulnerabilities and gaps if they aren't engaged for enough time, or don't have enough access to fully assess the company from start-to-finish on a regular basis. This is why it's important to be honest and open with the assessors, and ensure that your organization is getting their money's worth from the assessment. </p>
			<p>Considering that third-party security assessments can be split into those two "styles", we can understand the following: </p>
			<ul>
				<li>An assessment that covers your entire organization's security posture is generally going to be a mix of technical and Risk Management assessments. </li>
				<li>An assessment of your hardware product's security control effectiveness is generally going to fall under a technical Assessment. </li>
				<li>The same goes for assessing your software product's security control effectiveness. </li>
				<li>Assessing your building's security can be done through either technical or Risk Management assessments, but generally, we'd be thinking "Black Team." </li>
				<li>A third-party assessment of your staff's security awareness could include phishing exercises or Red/Black team engagements. </li>
				<li>Your <a id="_idIndexMarker775"/>security staff's ability to respond to an active threat is handled through <a id="_idIndexMarker776"/>a Red Team assessment, where your staff acts as the Blue Team, defending your organization's estate. </li>
			</ul>
			<p>Let's move on to the topic of best practices while performing security assessments. </p>
			<h1 id="_idParaDest-111"><a id="_idTextAnchor120"/>Best practices in performing security assessments </h1>
			<p>Regardless of whether your organization is undertaking an internal assessment or has engaged <a id="_idIndexMarker777"/>a third party to assess its Information Security posture, there are a few best practices that are effective in ensuring that the value of the assessment being undertaken is maximized. </p>
			<p>The key takeaways are as follows:</p>
			<ul>
				<li>Ensure the engagement has enough time to be completed thoroughly. There is no point in rushing, but additionally, it's important to ensure the test doesn't drag along and that you keep your valuable IT and security staff occupied on the assessment rather than their day-to-day requirements. </li>
				<li>Ensure the test scope is defined to avoid irrelevant assessments. </li>
				<li>Ensure the tester and internal staff assisting the tester are well-trained, prepared, and knowledgeable to increase the value of the assessment. </li>
			</ul>
			<p>There are also some processes that can be utilized in order to effectively choose the appropriate assessment outside the tests and audits that are required purely from a compliance perspective. </p>
			<p>These processes can include the following: </p>
			<ul>
				<li>Defining business requirements. </li>
				<li>Defining Information Security goals and strategies. </li>
				<li>Reviewing perceived strengths and weaknesses from an internal point of view. </li>
				<li>Performing risk assessments for assets, including known threats and vulnerabilities. </li>
				<li>Performing and documenting results from network and web application vulnerability scans. </li>
				<li>Reviewing and documenting the security control effectiveness of systems, including firewalls, VPNs, clients, access control mechanisms, and other information systems. </li>
				<li>Reviewing and documenting findings from access control lists and access logs. </li>
				<li>Reviewing and documenting the security awareness of staff members. </li>
			</ul>
			<p>Once you've gathered as much information as you can about your organization (a lot of which has been performed during the risk management phases, which we've covered several times), you will be able to make risk-based decisions on the assets that you would like to be assessed, which helps stretch your budget further than if you were to simply test anything and everything fully. </p>
			<p>Another quick <a id="_idIndexMarker778"/>note when it comes to best practices is something I mentioned earlier: I believe it's worthwhile to set up a dummy environment for automated scans and (some) pentests. It reduces the risk of taking down production systems, and also doesn't expose real-world customer data or confidential business information by utilizing dummy data instead. It's a cost-effective solution to mitigate against the risk of downtime as a result of security assessments. The trade-off is that some certification bodies, regulatory authorities, and customers will not see a test against a clone the same way as they would see a test against production, but those circumstances can be dealt with when they arise. </p>
			<p>At the end of a third-party test, the assessor will take time to write a report and provide you with results. These results are what bring value to your organization, rather than it paying to tick a box and carry on working with an unnecessary level of risk. This is why honesty leads to better, actionable improvements. You're paying professionals to tell you where you're weak, so be honest and get real results instead of paying money to a third party <a id="_idIndexMarker779"/>and then misleading them from the reality of your processes and practices, which allows your organization to continue making the same mistakes repeatedly. </p>
			<p>Let's have a look at the way these results are laid out. </p>
			<h1 id="_idParaDest-112"><a id="_idTextAnchor121"/>Interpreting results from security assessments </h1>
			<p>When we're looking at the results from security assessments, there are two types, similar <a id="_idIndexMarker780"/>to how we split the third-party assessments in the previous section. These two types are technical assessments and Risk Management and Governance assessments. </p>
			<p>Both types of reports will generally try to quantify the level of risk posed by each of the vulnerabilities found by assigning a score (either 1-5, 1-10, or some other scale) to them. It's important that you consider the value of your assets from your risk assessment proceedings, as sometimes a vulnerability could be seen as highly exploitable, but perhaps isn't worth mitigating, because it wouldn't stand to protect anything of value. In other words, the level of risk that's presented is below the risk acceptance level. </p>
			<p>Often, the technical reports will include a narrative of how the penetration test was undertaken on a step-by-step basis, with screenshots, commands, and other information to help the customer replicate the findings and test their remediations. These are an invaluable contribution to the results as an Information Security Professional, as not only do they serve as tutorials for the IT staff in your organization, but they also help you conceptualize the threats to non-technical people and senior management. It gives a great first-person view into a malicious actor's mind and helps make the threat real. </p>
			<p>When it comes to third-party reviews, regardless of whether the reports are technical or non-technical, they will generally include charts, graphs, and presentation material that will be delivered by the third party in a "findings presentation." It is important to include the company stakeholders in this meeting, as many people won't read the PDF report. Let's be honest: most people have thousands of unread emails in their inbox, so why would your boring PDF about how their business got absolutely <em class="italic">pwnd</em> catch their attention? </p>
			<p>Beyond these findings, there will be suggestions for remediation steps. The value on these pages is incredible. You essentially have "the bad guy" telling you how you could stop them (or other people with their skillset) from getting in next time! So, as a result, my suggestion is to follow their guidance. You are going to have to plan how you can update and restructure systems, change passwords, and hire staff, so the first step is to ensure you have the resources and signoff required. Remember: the findings presentation is going to wake senior management up and serves as a great opportunity to ask for approval for that resource while the issue is burning in the back of their mind. </p>
			<p>The same goes for <em class="italic">internal reviews</em>, including the results from <em class="italic">automated assessments and scanning</em>. You have metrics, as well as actions that can be taken to control the risk, and it's been quantified and presented in an attention-grabbing way in order to help you deliver your own findings meeting internally to senior management. Don't miss the opportunity to present the value of your <em class="italic">Information Security program</em> to your bosses – it's what they pay you for. </p>
			<p>During the <a id="_idIndexMarker781"/>remediation phase, it's important to validate internally. It can serve as a beneficial opportunity to train IT and developer staff as to the dangers of security vulnerabilities, and it also improves the overall security awareness of your organization. Furthermore, internally validating remediations prevents embarrassment, because the last thing you want is to schedule a follow-up test with the third party, only to have them do the exact same thing again, thus wasting time, money, and resources. </p>
			<p>This brings me to my final point: continual improvement. You want to schedule a follow-up to check that your remediations were effective, and then you'll want to schedule another test for a future date to see if the assessors can find other weaknesses. </p>
			<h1 id="_idParaDest-113"><a id="_idTextAnchor122"/>Summary</h1>
			<p>Now that we've reached the end of this chapter, I know for a fact that you're able to understand security control testing, including scheduling for external and internal security audits, how to analyze the reports and review the test results, and also how to manage the actions that arise from each assessment. </p>
			<p>You now know that there are various different security assessments you can undertake to understand how you can protect and improve your entire organization's security posture and your network and digital estate, from the hardware and software your organization has created to physical security and staff awareness. </p>
			<p>Furthermore, you're now aware of the different ways you can perform these types of assessments, such as having your own staff members perform an <em class="italic">internal review</em>, or even getting another organization to perform a <em class="italic">third-party review.</em> Furthermore, automated assessments can be performed, and you know about several different methods of automated security testing.  </p>
			<p>Now that we've gone over how security assessments can help your organization improve its security and streamline its operation, I think it makes sense to move on to <a href="B16611_07_Final_JM_ePub.xhtml#_idTextAnchor123"><em class="italic">Chapter 7</em></a>, <em class="italic">Owning Security Operations</em>. </p>
		</div>
	</body></html>