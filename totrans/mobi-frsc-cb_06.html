<html><head></head><body>
        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">SQLite Forensics</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">In this chapter, we'll cover the following recipes:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.3.1">Parsing SQLite databases with Belkasoft Evidence Center</span></li>
<li><span class="koboSpan" id="kobo.4.1">Parsing SQLite databases with DB Browser for SQLite</span></li>
<li><span class="koboSpan" id="kobo.5.1">Parsing SQLite databases with Oxygen Forensic SQLite Viewer</span></li>
<li><span class="koboSpan" id="kobo.6.1">Parsing SQLite databases with SQLite Wizard</span></li>
</ul>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Introduction</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">SQLite databases are widely used for different applications' data storage on both mobile devices and PCs. </span><span class="koboSpan" id="kobo.2.2">That is why analysis of such databases is highly important. </span><span class="koboSpan" id="kobo.2.3">According to our experience, in-depth analysis of SQLite databases allows us to extract up to 50% of additional data. </span><span class="koboSpan" id="kobo.2.4">This is explained in the following points:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.3.1">There are millions of applications that store their data in SQLite databases. </span><span class="koboSpan" id="kobo.3.2">None of the mobile forensic software developers are able to provide the support for the analysis of such a large number of applications.</span></li>
<li><span class="koboSpan" id="kobo.4.1">In the case of the name of the database or the path, where it is stored changes during the process of application version changing. </span><span class="koboSpan" id="kobo.4.2">Mobile forensic tools will not be able to recognize and analyze the database correctly.</span></li>
<li><span class="koboSpan" id="kobo.5.1">Not all forensic tools have an option for the automatic analysis of SQLite databases. </span><span class="koboSpan" id="kobo.5.2">For example, some tools extract data from Skype Freelists and some do not. </span><span class="koboSpan" id="kobo.5.3">The manual in-depth analysis of databases allows the extraction of their data more fully.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.6.1">There are thousands of SQLite Viewers. </span><span class="koboSpan" id="kobo.6.2">Which tool should be chosen for analysis? </span><span class="koboSpan" id="kobo.6.3">According to our experience, the most efficient tools for mobile application SQLite database analysis are the tools produced by mobile forensic software developers.</span></p>
<p><span class="koboSpan" id="kobo.7.1">Many beginning experts are afraid that they will have to deal with SQL command writing during manual SQLite database analysis. </span><span class="koboSpan" id="kobo.7.2">However, all advanced SQLite Viewers for database analysis use templates and visualizations of SQL commands that make databases analysis easier.</span></p>
<p><span class="koboSpan" id="kobo.8.1">SQLite databases are generally stored in the userdata partition of the Android device. </span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Parsing SQLite databases with Belkasoft Evidence Center</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">The Belkasoft Evidence Center program has already been described previously in </span><a href="../Text/ee171c49-3153-44ed-8537-18576c07fd9e.xhtml"><span class="koboSpan" id="kobo.3.1">Chapter 2</span></a><span class="koboSpan" id="kobo.4.1">, </span><em><span class="koboSpan" id="kobo.5.1">Android Devices Acquisition</span></em><span class="koboSpan" id="kobo.6.1">. </span><span class="koboSpan" id="kobo.6.2">This program has the functionality for SQLite database analysis on both mobile devices and PCs. </span><span class="koboSpan" id="kobo.6.3">In this chapter, we will describe how to analyze a SQLite database with Belkasoft Evidence Center.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">How to do it…</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">In this recipe, we will describe an interesting case. </span><span class="koboSpan" id="kobo.2.2">The problem was the following: on the screen of an examined iPhone 5 there was correspondence with two people on Skype, but it was not seen in the results of the analysis, the extracted data, which was displayed in the forensic tools. </span><span class="koboSpan" id="kobo.2.3">Before I was asked for assistance, my colleagues vainly tried all mobile forensics tools they had. </span><span class="koboSpan" id="kobo.2.4">The tools could not provide access to the correspondence.</span></p>
<p><span class="koboSpan" id="kobo.3.1">The iTunes backup of this device was analyzed via Belkasoft Evidence Center (the process of it will be described in </span><span><a href="../Text/8b2d1496-c4bb-48db-9aeb-cd1cdf299e8f.xhtml"><span class="koboSpan" id="kobo.4.1">Chapter 9</span></a><span class="koboSpan" id="kobo.5.1">, </span><em><span class="koboSpan" id="kobo.6.1">iOS Forensics</span></em><span class="koboSpan" id="kobo.7.1">, in the </span><em><span class="koboSpan" id="kobo.8.1">iOS backups parsing with Belkasoft Evidence Center</span></em><span class="koboSpan" id="kobo.9.1"> section</span></span><span class="koboSpan" id="kobo.10.1">) and we got the following results:</span></p>
<div class="mce-root CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.11.1"><img src="../Images/dd77e711-5d66-4b59-abe7-594c3aaf29b0.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.12.1">Summary of the results of the iTunes backup analysis</span></div>
<p><span class="koboSpan" id="kobo.13.1">As can be seen from the results, there are two Skype SQLite databases in the examined iTunes backup, but no messages were found.</span></p>
<p><span class="koboSpan" id="kobo.14.1">These databases were located in the following paths:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.15.1">Profile path: </span><kbd><span class="koboSpan" id="kobo.16.1">image:\1\vol_0\HomeDomain\Library\com.apple.internal.ck\main.db</span></kbd></li>
<li><span class="koboSpan" id="kobo.17.1">Profile path:  </span><kbd><span class="koboSpan" id="kobo.18.1">image:\1\vol_0\AppDomain-com.skype.skype\Library\Application Support\Skype4LifeSlimCore\serhioshep\main.db</span></kbd></li>
</ul>
<p><span class="koboSpan" id="kobo.19.1">As an example of SQLite database analysis, we will deal with the </span><kbd><span class="koboSpan" id="kobo.20.1">main.db</span></kbd><span class="koboSpan" id="kobo.21.1"> file, which is located in the </span><kbd><span class="koboSpan" id="kobo.22.1">serhioshep</span></kbd><span class="koboSpan" id="kobo.23.1"> folder:</span></p>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.24.1"><img src="../Images/87e38eca-4128-49f6-a246-2aff4b1ee914.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.25.1">main.db file</span></div>
<p><span><span class="koboSpan" id="kobo.26.1">Double-click the</span></span> <span class="packt_screen"><span class="koboSpan" id="kobo.27.1">File System</span></span><span><span class="koboSpan" id="kobo.28.1"> tab and go to the file:</span></span></p>
<div class="mce-root CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.29.1"><img height="161" width="628" src="../Images/5b7d8971-8153-4f8a-8bc8-cb5e8a68ae8e.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span><span class="koboSpan" id="kobo.30.1">main.db file</span></span></div>
<p><span class="koboSpan" id="kobo.31.1">As can be seen in the following figure, the size of the </span><kbd><span class="koboSpan" id="kobo.32.1">main.db</span></kbd><span class="koboSpan" id="kobo.33.1"> file is 266 KB, meaning that it may contain the correspondence we are looking for.</span></p>
<p class="mce-root"><span class="koboSpan" id="kobo.34.1">Double-click the </span><kbd><span class="koboSpan" id="kobo.35.1">main.db</span></kbd><span class="koboSpan" id="kobo.36.1"> file and select the </span><span class="packt_screen"><span class="koboSpan" id="kobo.37.1">Sqlite</span></span><span class="koboSpan" id="kobo.38.1"> tab in the lower window. </span><span class="koboSpan" id="kobo.38.2">In this window, the categories of the data contained in the examined database will be displayed. </span><span class="koboSpan" id="kobo.38.3">For example, in the </span><span class="packt_screen"><span class="koboSpan" id="kobo.39.1">Accounts</span></span><span class="koboSpan" id="kobo.40.1"> category, we can see the </span><kbd><span class="koboSpan" id="kobo.41.1">serhioshep</span></kbd><span class="koboSpan" id="kobo.42.1"> record. </span><span class="koboSpan" id="kobo.42.2">It is a Skype name of an account:</span></p>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.43.1"><img src="../Images/80e41df6-cd01-41e0-8282-902b77c97f1a.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.44.1">Categories of the main.db file.</span></div>
<p><span class="koboSpan" id="kobo.45.1">However, there is no information in the </span><span class="packt_screen"><span class="koboSpan" id="kobo.46.1">Messages</span></span><span class="koboSpan" id="kobo.47.1"> category. </span><span class="koboSpan" id="kobo.47.2">If you click on the </span><span class="packt_screen"><span class="koboSpan" id="kobo.48.1">Hex</span></span><span class="koboSpan" id="kobo.49.1"> tab of this window, you can see that there is no data in this part of the examined database:</span></p>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.50.1"><img height="350" width="592" src="../Images/045004a5-e6a2-4073-9c42-ea35915986fe.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.51.1">Data contained in the main.db file in Hex mode</span></div>
<p><span class="koboSpan" id="kobo.52.1">Similar result were received when we examined the second </span><kbd><span class="koboSpan" id="kobo.53.1">main.db</span></kbd><span class="koboSpan" id="kobo.54.1"> file.</span></p>
<p><span class="koboSpan" id="kobo.55.1">What happened? </span><span class="koboSpan" id="kobo.55.2">There are two explanations:</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.56.1">Explanation one</span></strong><span class="koboSpan" id="kobo.57.1">: Despite the fact that these files are SQLite databases, they do not contain information about messages. </span><span class="koboSpan" id="kobo.57.2">Perhaps this happened because the device's security settings did not allow this information to be transferred to the iTunes backup.</span></li>
<li><strong><span class="koboSpan" id="kobo.58.1">Explanation two</span></strong><span class="koboSpan" id="kobo.59.1">: These files really do not contain correspondence and the device shows the correspondence saved in the WAL-file, which was not transferred to the iTunes backup.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.60.1">The solution is that we need to jailbreak the device. </span><span class="koboSpan" id="kobo.60.2">Jailbreaking can give us full access to the file system of the device so we can extract more data from the device. </span><span class="koboSpan" id="kobo.60.3">The </span><kbd><span class="koboSpan" id="kobo.61.1">main.db</span></kbd><span class="koboSpan" id="kobo.62.1"> files will be available for analysis in unchanged form, and also the WAL-files will be available if they are present in the device's memory. </span><span class="koboSpan" id="kobo.62.2">This method will help us to extract the Skype correspondence.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Parsing SQLite databases with DB Browser for SQLite</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">DB Browser for SQLite is a free tool that can be used for SQLite database analysis. </span><span class="koboSpan" id="kobo.2.2">It has great functionalities for such data analysis.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Getting ready</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">Open the DB Browser for the SQLite program website in your browser. </span><span class="koboSpan" id="kobo.2.2">Select the version of the program that is suitable for your operating system and download it. </span><span class="koboSpan" id="kobo.2.3">Double-click the icon of the downloaded file and follow the instructions to install it.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">How to do it…</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">Double-click the icon of the DB Browser for the SQLite program; it will start the program. </span><span class="koboSpan" id="kobo.2.2">You can create your SQLite database or analyze the one that already exists. </span><span class="koboSpan" id="kobo.2.3">In this chapter, we will describe how to analyze the contents of the </span><kbd><span class="koboSpan" id="kobo.3.1">mmssms.db</span></kbd><span class="koboSpan" id="kobo.4.1"> file.</span></p>
<p><span class="koboSpan" id="kobo.5.1">Click </span><span class="packt_screen"><span class="koboSpan" id="kobo.6.1">Open Database</span></span><span class="koboSpan" id="kobo.7.1">. </span><span class="koboSpan" id="kobo.7.2">Select the file, which you will examine. </span><span class="koboSpan" id="kobo.7.3">Click </span><span class="packt_screen"><span class="koboSpan" id="kobo.8.1">OK</span></span><span class="koboSpan" id="kobo.9.1">:</span></p>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.10.1"><img src="../Images/f911e4e2-3c01-44db-8ce4-406e6c5f27a2.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.11.1">Toolbar of the DB Browser for SQLite</span></div>
<p><span class="koboSpan" id="kobo.12.1">The examined file will be uploaded in the program. </span><span class="koboSpan" id="kobo.12.2">The main window of the program has four tabs:</span></p>
<ol>
<li><span class="packt_screen"><span class="koboSpan" id="kobo.13.1">Database Structure</span></span><span class="koboSpan" id="kobo.14.1">: Displays the structure of the database.</span></li>
<li><span class="packt_screen"><span class="koboSpan" id="kobo.15.1">Browse Data</span></span><span class="koboSpan" id="kobo.16.1">: Displays the data contained in the database.</span></li>
<li><span class="packt_screen"><span class="koboSpan" id="kobo.17.1">EditPramas</span></span><span class="koboSpan" id="kobo.18.1">: Parameters of the database analysis.</span></li>
<li><span class="packt_screen"><span class="koboSpan" id="kobo.19.1">Execute SQL</span></span><span class="koboSpan" id="kobo.20.1">: GUI interface in which you can provide SQL commands.</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.21.1"><img src="../Images/7780ab28-e160-46ca-9622-ea71e2c7f1ad.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.22.1">Tabs of the main window of the program</span></div>
<p><span class="koboSpan" id="kobo.23.1">In the </span><span class="packt_screen"><span class="koboSpan" id="kobo.24.1">Database Structure</span></span><span class="koboSpan" id="kobo.25.1"> tab, the database structure that was uploaded is displayed. </span><span class="koboSpan" id="kobo.25.2">In this case, the examined database contains two tables, </span><kbd><span class="koboSpan" id="kobo.26.1">android_metadata</span></kbd><span class="koboSpan" id="kobo.27.1"> and </span><kbd><span class="koboSpan" id="kobo.28.1">sms</span></kbd><span class="koboSpan" id="kobo.29.1">:</span></p>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.30.1"><img src="../Images/eb9c68b3-d3f8-4baf-babf-3338d5183aaf.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.31.1">Structure of the examined database</span></div>
<p><span class="koboSpan" id="kobo.32.1">Go to the </span><span class="packt_screen"><span class="koboSpan" id="kobo.33.1">Browse Data</span></span><span class="koboSpan" id="kobo.34.1"> tab and select the </span><kbd><span class="koboSpan" id="kobo.35.1">sms</span></kbd><span class="koboSpan" id="kobo.36.1"> table from the drop-down menu. </span><span class="koboSpan" id="kobo.36.2">In the main window of the program, a table will be displayed showing the sequence number of a record, the SMS text, the phone number, type (incoming SMS or outgoing), date, sending date, status (if the SMS message is read or not), and so on:</span></p>
<div class="CDPAlignCenter CDPAlign"><span class="packt_screen"><span class="packt_screen"><span class="koboSpan" id="kobo.37.1"><img height="376" width="865" src="../Images/5801eb16-132d-4b64-affc-c1df149a7183.png"/></span></span></span></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.38.1">Data contained in the sms table</span></div>
<p><span class="koboSpan" id="kobo.39.1">As can be seen in the figure, it is not clear what format the values in the </span><kbd><span class="koboSpan" id="kobo.40.1">date</span></kbd><span class="koboSpan" id="kobo.41.1"> and </span><kbd><span class="koboSpan" id="kobo.42.1">date_sent</span></kbd><span class="koboSpan" id="kobo.43.1"> columns are specified in. </span><span class="koboSpan" id="kobo.43.2">Interpretation of these values can cause difficulties for an inexperienced expert. </span><span class="koboSpan" id="kobo.43.3">Also, remember the number of records in this table (2,798), as it will be important for us when we describe Oxygen Forensic SQLite Viewer.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">There’s more…</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">Besides the SQLite databases, data may be contained in the WAL-files. WAL files are Write Ahead Logs. </span><span class="koboSpan" id="kobo.2.2">They contain some pages from a SQLite database. </span><span class="koboSpan" id="kobo.2.3">You should also analyze available WAL-files if you want to extract maximum data from a mobile device.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">See also</span></h1>
                </header>
            <article>
<ul>
<li><span class="koboSpan" id="kobo.2.1">DB Browser for the SQLite website: </span><a href="http://sqlitebrowser.org/"><span class="koboSpan" id="kobo.3.1">http://sqlitebrowser.org/</span></a></li>
<li><span class="koboSpan" id="kobo.4.1">The website of another free tool for SQLite databases analysis, Sqliteman: </span><a href="https://sourceforge.net/projects/sqliteman/"><span class="koboSpan" id="kobo.5.1">https://sourceforge.net/projects/sqliteman/</span></a></li>
<li><span class="koboSpan" id="kobo.6.1">The program for WAL-files analysis, Walitean:  </span><a href="https://github.com/n0fate/walitean"><span class="koboSpan" id="kobo.7.1">https://github.com/n0fate/walitean</span></a></li>
</ul>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Parsing SQLite databases with Oxygen Forensic SQLite Viewer</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">The Oxygen Forensic program has been already described previously in </span><a href="../Text/5aee1bd3-1728-4cef-ba49-96c69133fbba.xhtml"><span class="koboSpan" id="kobo.3.1">Chapter 1</span></a><span class="koboSpan" id="kobo.4.1">, </span><em><span class="koboSpan" id="kobo.5.1">SIM Cards Acquisition and Analysis</span></em><span class="koboSpan" id="kobo.6.1">. </span><span class="koboSpan" id="kobo.6.2">This program has an Oxygen Forensic SQLite Viewer module, which can be used for SQLite database viewing and analysis.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Getting ready</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">Oxygen Forensic SQLite Viewer can be started by completing three steps:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.3.1">Double-click the </span><kbd><span class="koboSpan" id="kobo.4.1">OxySQLiteViewer64.exe</span></kbd><span class="koboSpan" id="kobo.5.1"> file, which is located at the following path: </span><kbd><span class="koboSpan" id="kobo.6.1">‘C:\Program Files (x86)\Oxygen Software\Oxygen Forensic Detective’</span></kbd><span class="koboSpan" id="kobo.7.1">.               </span><span><span class="koboSpan" id="kobo.8.1"> </span></span></li>
</ol>
<ol start="2">
<li><span class="koboSpan" id="kobo.9.1">Double-click the Oxygen Forensic program icon. </span><span class="koboSpan" id="kobo.9.2">In the toolbar of the program, select </span><span class="packt_screen"><span class="koboSpan" id="kobo.10.1">Tools</span></span><span class="koboSpan" id="kobo.11.1"> and then </span><span class="packt_screen"><span class="koboSpan" id="kobo.12.1">SQLite Database Viewer</span></span><span class="koboSpan" id="kobo.13.1">:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.14.1"><img src="../Images/77b3ecf1-1cef-4889-b675-7b8c0bda7afb.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.15.1">Tools menu</span></div>
<ol start="3">
<li><span><span class="koboSpan" id="kobo.16.1">In the main </span><span class="packt_screen"><span class="koboSpan" id="kobo.17.1">Case</span></span><span class="koboSpan" id="kobo.18.1"> window, click the</span></span> <span class="packt_screen"><span class="koboSpan" id="kobo.19.1">File Browser</span></span><span><span class="koboSpan" id="kobo.20.1"> section. </span><span class="koboSpan" id="kobo.20.2">In the opened window of the section, select the </span><span class="packt_screen"><span class="koboSpan" id="kobo.21.1">Database files</span></span><span class="koboSpan" id="kobo.22.1"> tab. </span><span class="koboSpan" id="kobo.22.2">In this window, all the databases including deleted ones will be displayed. </span><span class="koboSpan" id="kobo.22.3">Select the database you want to examine. </span><span class="koboSpan" id="kobo.22.4">Left click on it. </span><span class="koboSpan" id="kobo.22.5">In the drop-down window select </span><span class="packt_screen"><span class="koboSpan" id="kobo.23.1">Open in SQLite Viewer</span></span><span class="koboSpan" id="kobo.24.1">.</span></span></li>
</ol>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">How to do it…</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">Double-click the file of the </span><kbd><span class="koboSpan" id="kobo.3.1">OxySQLiteViewer64.exe</span></kbd><span class="koboSpan" id="kobo.4.1"> program, which is located in the </span><kbd><span class="koboSpan" id="kobo.5.1">C:\Program Files (x86)\Oxygen Software\Oxygen Forensic Detective</span></kbd><span class="koboSpan" id="kobo.6.1"> path. </span><span class="koboSpan" id="kobo.6.2">In the toolbar of the program, select </span><span class="packt_screen"><span class="koboSpan" id="kobo.7.1">File</span></span><span class="koboSpan" id="kobo.8.1"> and then </span><span class="packt_screen"><span class="koboSpan" id="kobo.9.1">Open</span></span><span class="koboSpan" id="kobo.10.1">. </span><span class="koboSpan" id="kobo.10.2">Select the file you want to examine and click </span><span class="packt_screen"><span class="koboSpan" id="kobo.11.1">OK</span></span><span class="koboSpan" id="kobo.12.1">. </span><span class="koboSpan" id="kobo.12.2">In order to compare the functionality of the programs, we will describe the analysis of the same </span><kbd><span class="koboSpan" id="kobo.13.1">mmssms.db</span></kbd><span class="koboSpan" id="kobo.14.1"> file.</span></p>
<p><span class="koboSpan" id="kobo.15.1">The window of the program is divided into three areas:</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.16.1">Area 1</span></strong><span class="koboSpan" id="kobo.17.1">: </span><span class="packt_screen"><span class="koboSpan" id="kobo.18.1">Tables</span></span><span class="koboSpan" id="kobo.19.1"> bar-In this bar, the structure of SQLite database files, which are uploaded to the program, is displayed.</span></li>
</ul>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.20.1"><img src="../Images/0145facb-7b81-4cb8-9a9c-3ad9f9d2b7b2.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.21.1">Structure of the mmssms.db file</span></div>
<p style="padding-left: 90px"><span class="koboSpan" id="kobo.22.1">As can be seen in the screenshot, besides 2,798 records that the database contains, the program managed to restore 13 more records.</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.23.1">Area 2</span></strong><span class="koboSpan" id="kobo.24.1">: The main working area of the program where the data is displayed:</span></li>
</ul>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.25.1"><img src="../Images/b0514309-ac45-493d-a2d4-975fc905f42e.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.26.1">View of the main working window of the Oxygen Forensic SQLite Viewer program</span></div>
<p style="padding-left: 90px"><span class="koboSpan" id="kobo.27.1">As can be seen in the screenshot, new additional records appeared in the table, and if you click the </span><span class="packt_screen"><span class="koboSpan" id="kobo.28.1">Blocks containing deleted data</span></span><span class="koboSpan" id="kobo.29.1"> tab, you will see that these blocks contain text, which was probably transferred there from SMS messages that the program did not manage to restore:</span></p>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.30.1"><img src="../Images/a83ab1d7-eb9a-43dc-b2e3-f7a0011e903e.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.31.1">A fragment of the SMS message contained in the Blocks containing deleted data tab</span></div>
<p style="padding-left: 90px"><span class="koboSpan" id="kobo.32.1">The main window of the program also contains the following tabs:</span></p>
<p style="padding-left: 90px"><span class="packt_screen"><span class="koboSpan" id="kobo.33.1">Table structure</span></span><span class="koboSpan" id="kobo.34.1">: Shows the structure of the analyzed SQLite database</span></p>
<p style="padding-left: 90px"><span class="packt_screen"><span class="koboSpan" id="kobo.35.1">SQL Editor</span></span><span class="koboSpan" id="kobo.36.1"> and </span><span class="packt_screen"><span class="koboSpan" id="kobo.37.1">Visual Query Builder</span></span><span class="koboSpan" id="kobo.38.1">: Allow you to specify SQL commands to analyze similar databases</span></p>
<ul>
<li><strong><span class="koboSpan" id="kobo.39.1">Area 3</span></strong><span class="koboSpan" id="kobo.40.1">: The bar, which is located on the right, automatically converts the value of a cell using several algorithms. </span><span class="koboSpan" id="kobo.40.2">It is very convenient to use for converting the examined database's cells values:</span></li>
</ul>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.41.1"><img height="478" width="256" src="../Images/e21a7b6e-e84f-411a-be61-1a97e616dfed.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.42.1">The appearance of the left panel</span></div>
<p><span class="koboSpan" id="kobo.43.1">As can be seen in the figure, the value of the </span><kbd><span class="koboSpan" id="kobo.44.1">date</span></kbd><span class="koboSpan" id="kobo.45.1"> cells in the examined database are stores in the Unix Epoch Time (ms) format. </span><span class="koboSpan" id="kobo.45.2">The value, contained in the examined cell, is </span><kbd><span class="koboSpan" id="kobo.46.1">01.10.2016 2:25:23</span></kbd><span class="koboSpan" id="kobo.47.1">.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">There’s more…</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">Summing up what was said earlier, we can say that with the use of specialized SQLite databases editors, experts extract not only more data by restoring deleted records, but they also restore fragments from other areas of databases that may be interesting to them. </span><span class="koboSpan" id="kobo.2.2">Using SQL Editor and Visual Query Builder, you can write scripts that will automatize in-depth analysis of such databases.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Parsing SQLite databases with SQLite Wizard</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">The UFED program has already been described previously in </span><a href="../Text/51f79a41-d9dd-4c2d-96c4-412c7c5130bd.xhtml"><span class="koboSpan" id="kobo.3.1">Chapter 4</span></a><span class="koboSpan" id="kobo.4.1">, </span><em><span class="koboSpan" id="kobo.5.1">Windows Phones and BlackBerry Acquisition</span></em><span class="koboSpan" id="kobo.6.1">. </span><span class="koboSpan" id="kobo.6.2">This program has the SQLite Wizard module, which can be used for data extraction from SQLite databases.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">Getting ready</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">Unfortunately, the SQLite Wizard module cannot be started individually, and before using it, an expert has to analyze extracted data from a mobile device via UFED Physical Analyzer. </span><span class="koboSpan" id="kobo.2.2">When the analysis is done, click the category:</span></p>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.3.1"><img height="245" width="251" src="../Images/c75fbe9d-0ed7-45dc-8401-eb044608f86f.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.4.1">Databases category</span></div>
<p><span class="koboSpan" id="kobo.5.1">In the main window of the program, the tab will be displayed that contains information about SQLite databases extracted from the examined mobile device. </span><span class="koboSpan" id="kobo.5.2">The window will also display information on whether the database was analyzed via UFED Physical Analyzer or not:</span></p>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.6.1"><img src="../Images/eb8ecda8-2d8a-49b3-820b-7b9e9d3d3322.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.7.1">Information about databases displayed in the main window of UFED Physical Analyzer</span></div>
<p><span class="koboSpan" id="kobo.8.1">Viewing this window, an expert will face an unpleasant discovery. </span><span class="koboSpan" id="kobo.8.2">It turns out that most of the extracted SQLite databases cannot be analyzed, meaning that some of the data, sometimes very important data, can be lost.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">How to do it…</span></h1>
                </header>
            <article>
<p><span class="koboSpan" id="kobo.2.1">As an example, we will describe the analysis of the </span><kbd><span class="koboSpan" id="kobo.3.1">contacts2.db_backup</span></kbd><span class="koboSpan" id="kobo.4.1"> database. </span><span class="koboSpan" id="kobo.4.2">In the main window of the UFED Physical Analyzer program, click the right mouse button on the file. </span><span class="koboSpan" id="kobo.4.3">In the drop-down menu, select </span><span class="packt_screen"><span class="koboSpan" id="kobo.5.1">SQLite Wizard</span></span><span class="koboSpan" id="kobo.6.1">. </span><span class="koboSpan" id="kobo.6.2">The opened window will prompt you to fill in the </span><span class="packt_screen"><span class="koboSpan" id="kobo.7.1">Application</span></span><span class="koboSpan" id="kobo.8.1"> and </span><span class="packt_screen"><span class="koboSpan" id="kobo.9.1">Name</span></span><span class="koboSpan" id="kobo.10.1"> fields. </span><span class="koboSpan" id="kobo.10.2">Fill them in and click </span><span class="packt_screen"><span class="koboSpan" id="kobo.11.1">Next</span></span><span class="koboSpan" id="kobo.12.1">.</span></p>
<p><span class="koboSpan" id="kobo.13.1">In the next window, the </span><span class="packt_screen"><span class="koboSpan" id="kobo.14.1">Query builder</span></span><span class="koboSpan" id="kobo.15.1"> tab will be opened, in which the structures of the tables that are included in the examined file will be displayed. </span><span class="koboSpan" id="kobo.15.2">Add them to the desktop of the program by double-clicking on them. </span><span class="koboSpan" id="kobo.15.3">On the desktop, you can specify how the tables should be related. </span><span class="koboSpan" id="kobo.15.4">As the structure of the examined database is known, there is no need to make additional manipulations. </span><span class="koboSpan" id="kobo.15.5">Click the </span><span class="packt_screen"><span class="koboSpan" id="kobo.16.1">Next</span></span><span class="koboSpan" id="kobo.17.1"> button.</span></p>
<p><span class="koboSpan" id="kobo.18.1">SQLite Wizard contains a great number of templates that make an expert’s work much easier. </span><span class="koboSpan" id="kobo.18.2">Click on the drop-down menu and select the </span><span class="packt_screen"><span class="koboSpan" id="kobo.19.1">Contacts</span></span><span class="koboSpan" id="kobo.20.1"> template:</span></p>
<div class="CDPAlignCenter CDPAlign"><span class="koboSpan" id="kobo.21.1"><img height="460" width="595" src="../Images/d8df6042-48bf-4657-8745-8888d77daa3c.png"/></span></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span class="koboSpan" id="kobo.22.1">SQLite WizardR17 templates</span></div>
<p><span class="koboSpan" id="kobo.23.1">In the upper part of the window, there will be rectangles, which will display the categories of the </span><span class="packt_screen"><span class="koboSpan" id="kobo.24.1">Contacts</span></span><span class="koboSpan" id="kobo.25.1"> database; the table containing the values will be presented below. </span><span class="koboSpan" id="kobo.25.2">Drag the rectangles with the categories to the columns that correspond to them. </span><span class="koboSpan" id="kobo.25.3">It is fine if some rectangles with categories remain unused. </span><span class="koboSpan" id="kobo.25.4">Click the </span><span class="packt_screen"><span class="koboSpan" id="kobo.26.1">Next</span></span><span class="koboSpan" id="kobo.27.1"> button.</span></p>
<p><span class="koboSpan" id="kobo.28.1">In the new window, you can specify the settings: whether to use the newly generated SQLite database analysis scheme for this analysis, or whether to use this analysis scheme for all subsequent examinations of mobile devices.</span></p>
<p><span class="koboSpan" id="kobo.29.1">You can close the SQLite Wizard by clicking the </span><span class="packt_screen"><span class="koboSpan" id="kobo.30.1">Close</span></span><span class="koboSpan" id="kobo.31.1"> button, or run the analysis using the new </span><kbd><span class="koboSpan" id="kobo.32.1">contacts2.db_backup</span></kbd><span class="koboSpan" id="kobo.33.1"> database analysis algorithm by clicking the </span><span class="packt_screen"><span class="koboSpan" id="kobo.34.1">Run</span></span><span class="koboSpan" id="kobo.35.1"> button. </span><span class="koboSpan" id="kobo.35.2">At the end of the analysis, the extracted data will be added to what was received earlier.</span></p>
            </article>
        </section>


        <section>
                            <header>
                    <h1 class="header-title"><span class="koboSpan" id="kobo.1.1">See also</span></h1>
                </header>
            <article>
<ul>
<li><em><span class="koboSpan" id="kobo.2.1">Mobile forensics: UFED vs Magnet Acquire</span></em><span class="koboSpan" id="kobo.3.1">, </span><a href="https://www.digitalforensics.com/blog/mobile-forensics-ufed-vs-magnet-acquire/"><span class="koboSpan" id="kobo.4.1">https://www.digitalforensics.com/blog/mobile-forensics-ufed-vs-magnet-acquire/</span></a></li>
</ul>
            </article>
        </section>
</body></html>