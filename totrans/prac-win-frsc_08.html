<html><head></head><body><div class="chapter" title="Chapter&#xA0;8.&#xA0;Event Log Analysis"><div class="titlepage"><div><div><h1 class="title"><a id="ch08"/>Chapter 8. Event Log Analysis</h1></div></div></div><p>In this chapter, we will learn about Event Logs in the Microsoft operating system. We will discuss why it is important to cover issues related to event logs for successful investigation. We will consider differences between event logs depending on the MS Windows version.</p><div class="section" title="Event Logs - an introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec49"/>Event Logs - an introduction</h1></div></div></div><p>When an operating system works, a lot of events take place in the system. The range of these events is very large and a majority of them can be registered in the system. To register events on the system, there is a powerful mechanism called <span class="strong"><strong>Event Logging</strong></span>. It presents a standard centralized way, which the operating system and applications use to record important information coming from software and hardware. An event can be something that occurred in the system or in some application, and it is necessary to notify the user. Information about every event should be recorded.</p><p>Events are collected and stored by the Event Logging Service. This keeps events from different sources in event logs. Event logs provide chronological information, which allows us to determie problems in the system environment and security and tracks users' activities and the usage of system resources. However, the kind of data that will be actually recorded in an event log is dependent on system configuration and application settings. For example, security event logs is turned off on old Windows operating systems by default.</p><p>Event logs provide a lot of data for investigators, and they can help with answers for the following issues:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>What happened</strong></span>: Some items of the event log record, such as Event ID and Event Category, help get information about a certain event.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>When</strong></span>: Timestamps are a key part of the event log and they provide the temporal context for an event. In a system where are a lot of events are generated, the timestamps could be very useful to narrow the timeframe of the search.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Who</strong></span>: Which users are involved. All actions that are executed on the Windows operating system are committed in some account contexts. Some actions are committed not by the normal user but by the operating system, and this will be done in the system's account context, for example, System or Network Service. We can identify who is the user behind a certain event.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>What systems are involved</strong></span>: In the network environment, event logs usually have a lot of references to accounts from remote systems. Originally only the NetBIOS of workstations were recorded in event logs. However, it complicated the tracking of involved systems. In systems after Windows 2000, IP addresses are also kept in event logs.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>What resources are accessed</strong></span>: The Event Logging Service can be configured to store very granulated information about various objects on the system. Almost any resource of the system can be considered as an object and, thereby, we can detect any requests for unauthorized access to resources.</li></ul></div></div></div>
<div class="section" title="Event Logs system"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec50"/>Event Logs system</h1></div></div></div><p>Now that we've figured out that Windows event logs contain a lot of useful information and that they can be very valuable resources to detect security incidents, let's see where event logs can be found on different versions of MS Windows.</p><p>In the evolution of the MS Windows process, even the Event Logs system was changed. It originally appeared in MS Windows 3.1. Some minor changes occurred in every Windows version, but the names of event logs files and paths remained the same until Windows 2003. Initial versions used the .evt binary format. This format is not suitable to search for strings or to browse for information without special software. Also, these logs have size limitations in results; therefore, new upcoming events could rewrite old stored data.</p><p>Before Vista, the event logs were as follows:</p><pre class="programlisting">
<span class="strong"><strong>%System root%\System32\config</strong></span>
</pre><p>However, starting from Vista and Server 2008, significant changes were implemented in the event logs structure, types, and locations on the filesystem. The original version of the Event Logs system was a heavy load for system performance. A new version was developed to fix some issues related to performance too. The new .evtx format of event logs was introduced. However, the most significant changes touched the structure of the event logs.</p><p>In Vista, many new types of event logs were added, their total number became more than 70. These event logs can be found at the following location:</p><pre class="programlisting">
<span class="strong"><strong>      %System root%\System32\winevt\logs</strong></span>
</pre><p>Moreover, the new Event Logs system allows sending events to a remote collector, so it's necessary to keep in mind that additional event logs can be found on another server. Note that the presented path for the storage of event logs is the default value and it may be changed through the registry key:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Application</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\System</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Security</code></li></ul></div><p>Initially in MS Windows, three types of event logs existed:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">System</li><li class="listitem" style="list-style-type: disc">Security</li><li class="listitem" style="list-style-type: disc">Application</li></ul></div><p>All other extra event logs can be united in the Custom group. Vista, Win7, Server 2008, Win 8, and Server 2008 now have many additional event logs, including specialized event logs for some processes, such as PowerShell, Task Scheduler, and Windows Firewall.</p><p>Let's take a look at what kind of information is recorded in various types of event logs:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Security Log</strong></span>: This records events based on local and group policies.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>System Log</strong></span>: This records events from the operation system and its components, such as failure of a service on the boot system.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Application Log</strong></span>: This records events from applications, such as failure of access to a file or an antivirus notification.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Directory Service</strong></span>: This records events from Active Directory and some services based on it. It is a standard event logon Domain Controller.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>File Replication Server</strong></span>: This records events about updates between Domain Controllers. It is a standard event logon Domain Controller.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>DNS Server</strong></span>: This is a standard event logon server where DNS server software is running. It records events about the management of zones, and the start and stop of a DNS server.</li></ul></div><p>The main reason to dedicate a separate directory for new event logs is their large number. As we already mentioned, it exceeds 70.</p><p>A new event log can be divided into the following categories:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Setup</strong></span>: This is a new event log, in which information about Windows security updates, patches, hotfixes are stored</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Forwarded Events</strong></span>: This is also a new event log to record events coming from remote computers</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Applications and Services</strong></span>: This group includes all other new event logs, which were introduced in Windows 2008</li></ul></div><div class="section" title="Security Event Logs"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec76"/>Security Event Logs</h2></div></div></div><p>The old Event Log system had some issues related to performance. In that version, the event log needed to be completely loaded into memory. Sometimes, just for one log, 300 MB of RAM had to be allocated. This behavior affected system performance very much, and it forced administrators to turn off event logging. In the new Event Log system, every event log file has a small header, which is followed by 64Kb chunks. Now, only the currently used chunk will be loaded into memory. This certainly improves performance and reduces resource usage. Also, an increased likelihood of logging will be enabled. Almost all event logs could prove to be useful during an investigation, nonetheless, most answers for the questions that we have in forensics can be found in Security Event Log. System and Application Event Logs are more useful for system administrators for troubleshooting. </p><p>Security Event Logs record audit events whenever they occur in the system or the user activity which is covered by local or group audit policies. They could present details about various user activities, including user authentication (logons, run as commands, and remote access) and user activities after logons. Using privileges and object auditing could be a trigger event that shows access to protected files, which user accessed it, and the date and time of when it happened. An audit allows applying security settings to itself so that all modifications of audit policy can be traced.</p><p>Keep in mind that security policies may register events with success and failure results. It allows adjusting policies and records only data of interest. From an investigator's point of view, we want to log as much data as possible. This could create additional load to system performance, and it requires significant disk space to store information. This is not possible in many environments. For some nonforensic professionals, it is not obvious why successful and failed attempts to log on should be recorded and how it can help detect a brute force attack. Also, it is possible to set additional audit policies for a specific user with a built-in <code class="literal">gpedit.msc</code> snap-in. So, we can set a more detailed audit for critically valuable users.</p><p>Due its nature, Security Log has more protections than System and Application event logs. Starting from Windows XP SP2, the API for applications that send events to the Security event log was deprecated, excluding the Windows Security Service. Now this possibility is available only for Local Security Authority System Service (LSASS) because it is responsible for applying security policies in the system. Moreover, only users with administrator permissions can review, export, or clear the Security event log.</p><p>Let's take a look at what kind of information is stored in the Security event log:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Account Logon</strong></span>: These are events that are stored on the system and which authorize the user. So, it could be workstation or Domain Controller.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Account Mgmt</strong></span>: This is account maintenance and modification.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Logon Events</strong></span>: This is every logon or logoff event on the local system.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Directory Service</strong></span>: These are attempts to access the objects of the Active Directory.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Object Access</strong></span>: This is access to objects which have their own access control list.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Policy Change</strong></span>: These are modifications of users' rights and audit policies.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Privilege Use</strong></span>: This has each case of an account exercising a user right.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Process Tracking</strong></span>: This stores the start, stop process, and objects access.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>System Events</strong></span>: This is the start and shutdown of the system.</li></ul></div><p>The Security Event Categories give us understanding about what kind of events can be interesting for us. For every category, we can set an audit policy in the values No Auditing, Success, Failure, or Success and Failure both. Every time an event is recorded in the event log file, it is marked by the category to which it belongs. When the audit is turned off, we will not see any information about such types of events in the event log file.</p><p>One of the most disappointing things during an investigation is hitting a dead end. This often happens because we lack event logs. Some investigations, such as intrusion and event log analysis, are very important to track the activities of the intruder. In others, such as employee misuse, they present extra artifacts, which prove the case with significant information, such as time of log on, installation programs, and access to specific files. Unfortunately, audit policies don't have rules and event logs don't contain useful information. So, it is important to configure an audit policy, such that Windows records only what we need.</p><p>Also, the settings on systems executing various roles could be different. Audit policies and the number of event logs turned on by default on Workstations, Servers, and Domain Controllers will differ. The Event Logs system on Windows 7 or Windows 8 has minimal logs and it is turned off at all times on Windows XP and Vista by default. Due to the fact that Windows 7 and Windows 8 are becoming more and more common, we can expect more systems with Security, System, and Application event logs. It should be noted that in the corporate network, there are domain policies. Local policies will be rewritten by group policies and, thus, increase logging information.</p><p>Many investigators mistakenly believe that server versions of Windows have good settings for event logging out of the box. However, similar workstations standard configuration of server have a minimal set of logged data.</p><p>From Windows 2008 onward, every event category is divided into a subcategory called 
<span class="strong"><strong>extended audit policies</strong></span>
. These detailed options were introduced to allow better control over events that need to be monitored by administrators. This became available in Windows 7 and later.</p><p>Event types give us reasons as to why an event was recorded into an event log file. Also, they can provide important information about the severity of the event, allowing the administrator to focus on more critical events.</p><p>We have the following types of events:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Error</strong></span>: These are significant problems, such as loss of data or functionality; for example, the server fails to load</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Warning</strong></span>: These are not significant problems but they can be a problem in the future; for example, low disk space</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Information</strong></span>: These are successful operations of applications or services; for example, a service was started</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Success Audit</strong></span>: These are notifications that audited events completed successfully, for example, successful user logon</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Failure Audit</strong></span>: These are notifications that the audited event did not complete successfully, for example, failed access to device</li></ul></div></div></div>
<div class="section" title="Extracting Event Logs"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec51"/>Extracting Event Logs</h1></div></div></div><p>When event logs are analyzed, the most common approach is to export logs and then review them on the forensics workstation. There are a few reasons for such an approach. Often, we need to analyze a few event logs (for example, System, Security, and Application) from several workstations and Domain Controller. So, it is very convenient to have all event log files in one place. Also, many forensics tools not enough good work with event logs.</p><p>There are two main approaches to export event logs:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Live systems</li><li class="listitem" style="list-style-type: disc">Offline systems</li></ul></div><p>Both of them have their own set of features; let's see what they are.</p><div class="section" title="Live systems"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec77"/>Live systems</h2></div></div></div><p>While working with live systems, remember that event log files are always used, which creates some additional challenges. One way of exporting data from a live system is using Event Viewer. If you right-click on the event log file, the 
<span class="strong"><strong>Save All Events As... </strong></span>
option will appear. Logs can be saved in various formats, including 
<code class="literal">.evtx</code>, <code class="literal">.csv</code>, <code class="literal">.xml</code>, or <code class="literal">.txt</code>
. If you are concerned about possible log corruption, this is the safest way.</p><p>Another alternative for live systems is using FTK Imager so that you can mount the drive as a Physical Disk and export event log files. In practice, there may occur a situation when the event file is corrupted. However, it is still possible to analyze it. The MS Event Viewer may refuse to open such files. The situation with new <code class="literal">.evtx</code> format is a little bit better, as new file log corruption happens much more rarely, and MS Event Viewer is more tolerant of this format.</p><p>The MS Resource Kit includes the elogdump utility, which allows keeping containment of the event log from a local or remote computer. The PsLogList utility is the analog of elogdump with one difference: PsLogList allows logging in on a remote system and receives the message from the remote system in case the attempt failed. It is the best alternative to the live system, and it is a free tool from SysInternals. This command line tool has a lot of features. It can dump live event logs to <code class="literal">.csv</code> file, read, and output exported data in the native 
<code class="literal">.evt</code>/<code class="literal">.evtx</code>
 format, filter output and dump event logs from a remote system. By default, it outputs the system event log file.</p></div><div class="section" title="Offline system"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec78"/>Offline system</h2></div></div></div><p>Event logs are binary databases, so to review 
<code class="literal">.evt/.evtx</code>
files, we need tools that can parse these formats. There are a few good free tools which allow converting binary format of event logs to human readable text formats.</p><p>TZWorks released 
<code class="literal">evtwalk </code>
and 
<code class="literal">evtx_viewer</code>
. Harlan Carvey wrote a few Perl scripts to parse event log files, and Andreas Schuster released 
<code class="literal">evtx_parser</code>
.</p><p>Extraction of event logs from an offline system is often the last hope for investigators who encounter corrupted event logs, but this approach has some benefits. For example, there is data stored in event logs, access to which is difficult using standard log viewers. The most important one of these is the 
<span class="emphasis"><em>number of records </em></span>
in an event log file. The number of records is assigned sequentially to an event within the log file. So, a missed number will be a marker for manipulation with events in the event log. The best way to get access to this data is to extract the specific events and sort it with a database or spreadsheet.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note11"/>Note</h3><p>The TZWorks evtwalk tool can be used for both live and offline systems. For a live system, we can use the <code class="literal">-livesys</code> option; it will examine all the event logs on the host. The evtwalk tool will determine the version of operating system and scan the appropriate event log directory for that version of Windows.</p></div></div><p>For offline analysis, when event logs are gathered as part of an investigation, the evtwalk tool can be invoked with <code class="literal">-pipe</code>. The <code class="literal">-pipe</code> option allows <code class="literal">evtwalk</code> to receive a separate path or filename per line as input and process each of them separately.</p><p>For Windows, one can use the built-in <code class="literal">dir</code> command along with some of its companion switches to get the desired result. The following is an example of using this option:</p><pre class="programlisting">
<span class="strong"><strong>    dir c:\forensicscases\*.evtx /b /s | evtwalk -pipe&#13;
        &gt; events.txt</strong></span>
</pre><p>The <code class="literal">evtwalk</code> command can work with one or multiple event files specified with the -log option and is separated by the | character.</p><p>Another unique feature of the evtwalk tool is its ability to output data to the timeline format with the 
<code class="literal">cvsl2t</code>
(log2timeline) and 
<code class="literal">bodyfile</code>
(mactime) options. Due to this fact, we have the ability to combine event log activity with filesystem and registry activity that allows determining what happened on the computer.</p><p>Instead of displaying all the records that are presented in an event log, it is possible to filter a certain class of event data.</p><p>For evtwalk, the following report categories are available:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Password changes</li><li class="listitem" style="list-style-type: disc">Clock changes or updates</li><li class="listitem" style="list-style-type: disc">User logon and logoff events</li><li class="listitem" style="list-style-type: disc">System start and stop times</li><li class="listitem" style="list-style-type: disc">User credential or permission changes</li><li class="listitem" style="list-style-type: disc">USB events</li></ul></div><p>An analyst may want their own report template. In this case, they can determine the report template and specify it using the cmdfile option. It should be noted that if you want to run evtwalk on a live system, you should run it with administrator permissions.</p><p>Evtx_view is the GUI version of the evtwalk tool. This is a good tool to exactly understand how events are recorded and what data is available. Both tools have unique features, allowing them to filter specific types of events according to the action which they represent. Investigators can make a request to report only particular events, for example logons, password changes, times of modifications, USB usage, and so on. TZWorks tools are nice, but they are not free.</p></div><div class="section" title="Event Viewer"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec79"/>Event Viewer</h2></div></div></div><p>One tool that you can use for free is Event Viewer. One of the most interesting features of Event Viewer is that you can review events from remote PCs in a corporate network. This could be a good alternative to usage of Remote Desktop. This may be very useful in a live response when it is necessary to check something specific very fast. For example, if we need to know whether the compromised user account was used or whether some malware-specific service was started. The ability to have a quick answer for critically important questions has big value for effective incident response:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">To review event logs from other computers, right-click on Event Viewer (Local) and choose Connect to Another Computer.</li><li class="listitem">Select Another Computer, input IP Address or Hostname, and click on OK.</li></ol></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note12"/>Note</h3><p>Starting from Windows 7, Event Viewer allows specifying different accounts for remote authentication (similar to "run as").</p></div></div><p>Keep in mind that when your review event logs on a live system, all events with your activities will be recorded to event logs, including remote logons executed for review of logs. You may also see new 4624, 4776, 4769, and 4674 events in event logs, depending on network settings and audit policies.</p><p>The built-in Windows Event Viewer has significant disadvantages. It is very tedious to review a lot of events in the Event Viewer interface. There is no ability to load a few logs from different systems and to filter them and search in parallel. Besides this, Event Viewer has strict requirements for the format of event log files. In practice, you may have corrupted files, and some unexperienced analysts may give up an analysis of event logs when they cannot open them with Event Viewer.</p></div><div class="section" title="Event Log Explorer"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec80"/>Event Log Explorer</h2></div></div></div><p>One more utility for Event Log analysis is Event Log Explorer. This is event log management software, which works over built-in Microsoft tools. It provides all the features that are needed by analysts to quickly analyze event logs. It supports all the current versions of MS Windows and the <code class="literal">.evt</code> and <code class="literal">.evtx</code> formats. However, what is more important is that it works with corrupted files. It has two options:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">To open event logs with API</li><li class="listitem" style="list-style-type: disc">To open event files in direct parsing mode</li></ul></div><p>Event Log Explorer allows opening a few event log files simultaneously and using an event to combine them. Moreover, it has rich filtering features, including access to the Event Description text field where significant forensics artifacts are. Also very useful is the feature of marking various Event IDs by different color. Event Log Explorer is free for personal use and costs around $100 for commercial use.</p></div><div class="section" title="Useful resources"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec81"/>Useful resources</h2></div></div></div><p>It is not possible to describe all events in one chapter, so you can find out more information about events that you are interested in some internet resources.</p><p>Here are useful resources with information related to the event logs topic:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">A good resource of information about a lot of forensics topics is the SANS Reading Room (<a class="ulink" href="https://www.sans.org/reading-room/">
https://www.sans.org/reading-room/
</a>). Here, are you can find many useful white papers and written analysts, students and forensics investigators. One of these is a white paper written by Russ Antony (<a class="ulink" href="http://www.sans.org/reading-room/whitepapers/logging/detecting-security-incidents-windows-workstation-event-logs-34262">http://www.sans.org/reading-room/whitepapers/logging/detecting-security-incidents-windows-workstation-event-logs-34262</a>). It describes how useful Event Logs can be to detect anomalies in system and for investigations of security incidents.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note13"/>Note</h3><p>It is impossible and also not necessary to remember all Event ID and error codes that are related to them. Fortunately, we have a few online resources with such information.</p></div></div></li><li class="listitem" style="list-style-type: disc">A good place to search for information about events is MS TechNet (<a class="ulink" href="https://www.microsoft.com/technet/support/ee/ee_advanced.aspx">https://www.microsoft.com/technet/support/ee/ee_advanced.aspx</a>). This resource contains a lot of information on various Event IDs for numbers and different MS operation systems and applications.<p>Event ID.net (<a class="ulink" href="http://www.eventid.net/">
http://www.eventid.net/
</a>) is another very good resource related to this topic. It contains useful information about different Event Logging issues.</p></li><li class="listitem" style="list-style-type: disc">Ultimate Windows Security (<a class="ulink" href="http://www.ultimatewindowssecurity.com/">www.ultimatewindowssecurity.com</a>) contains databases which are supported and updated by the community.</li></ul></div></div><div class="section" title="Analyzing the event log – an example"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec82"/>Analyzing the event log – an example</h2></div></div></div><p>Let's take a look at a small example, how we can use the Event Log Explorer to analyze an event log. Assume that we have event log files from the analyzed system:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">First, load the Security log. This displays all events relating to login, the creation of new accounts, and more. Let's try to display all the users who log in to the system. A login event has the 4,624 identifier. We can apply an Event ID = 4,624 filter. Note that we should adjust the time. Choose <span class="strong"><strong>Time Correction...</strong></span> from View according to the offset from GMT on the forensics station. For instance, if you work on a system with GMT + 3, you need to input -3 to get time of events in the GMT time zone:<div class="mediaobject"><img src="graphics/image_08_001.jpg" alt="Analyzing the event log – an example"/></div></li><li class="listitem">Now, we can sort out user accounts. We see that we have an unusual user, <code class="literal">SYSTEMSERVICE</code>. Let's filter all events with this account. We can filter by <code class="literal">SYSTEMSERVICE</code> in the <span class="strong"><strong>Description</strong></span> field:</li></ol></div><div class="mediaobject"><img src="graphics/image_08_002.jpg" alt="Analyzing the event log – an example"/></div><p>After applying this filter, we will have the following result:</p><p>We can see the following events with this account with a chronological timeline:</p><div class="informaltable"><table border="1"><colgroup><col/><col/></colgroup><tbody><tr><td>
<p><span class="strong"><strong>Event ID</strong></span></p>
</td><td>
<p><span class="strong"><strong>Description</strong></span></p>
</td></tr><tr><td>
<p>4624</p>
</td><td>
<p>This is a successful log in to the system</p>
</td></tr><tr><td>
<p>4634</p>
</td><td>
<p>This is a log off from the system</p>
</td></tr><tr><td>
<p>4647</p>
</td><td>
<p>This is a log off from the system</p>
</td></tr><tr><td>
<p>4648</p>
</td><td>
<p>This is an unsuccessful log in attempt</p>
</td></tr><tr><td>
<p>4672</p>
</td><td>
<p>This is an assignment of new privileges</p>
</td></tr><tr><td>
<p>4720</p>
</td><td>
<p>This is an account creation</p>
</td></tr><tr><td>
<p>4722</p>
</td><td>
<p>This is an account activation</p>
</td></tr><tr><td>
<p>4724</p>
</td><td>
<p>This is an attempt to change password</p>
</td></tr><tr><td>
<p>4726</p>
</td><td>
<p>This is an account deletion</p>
</td></tr><tr><td>
<p>4738</p>
</td><td>
<p>This is an account modification</p>
</td></tr></tbody></table></div><p>We can see that the account was created on April 8, 2014 at 12:40:52 UTC.</p><p>Let's view the types of login (login using RDP has type 10); to do this, just filter Logon Type equal 10:</p><div class="mediaobject"><img src="graphics/image_08_003.jpg" alt="Analyzing the event log – an example"/></div><p>After applying the filter, we will have the following result:</p><p>This user remotely accessed the system on April 8, 2014 at 12:10:18 UTC.</p><p>So now, we can figure out this is a malicious account, when it was created, and when and how it logged in to the system.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec52"/>Summary</h1></div></div></div><p>In this chapter, we have seen that event logs can be a useful source of evidence for forensic investigations. We examined the structure of event logs and looked at the features of event log systems for various Windows operating systems. We looked at some tools, which you can use to analyze event logs.</p><p>In the next chapter, we will look at some files with which the Windows OS works. These files are artifacts of Windows live, and they reflect what occurred in the system. We will learn to analyze prefetch, links, and jobs files.</p></div></body></html>