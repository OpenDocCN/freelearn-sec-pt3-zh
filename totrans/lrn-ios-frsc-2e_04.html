<html><head></head><body><div class="chapter" title="Chapter&#xA0;4.&#xA0;Evidence Acquisition and Analysis from iTunes Backup"><div class="titlepage"><div><div><h1 class="title"><a id="ch04"/>Chapter 4. Evidence Acquisition and Analysis from iTunes Backup</h1></div></div></div><p>The goal of this chapter is to introduce you to the different types of local backups (encrypted or unencrypted), the structure of a backup, the techniques and software available to extract meaningful data from it, and to show you how to crack an encrypted backup while extracting the password saved in it. These concepts are really useful because sometimes the analyst may not have the iOS device or cannot access it, but may have access to a computer containing an iTunes backup.</p><div class="section" title="iTunes backup"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec35"/>iTunes backup</h1></div></div></div><p>The Apple iTunes software allows users to create two different types of local (meaning stored on a local computer) backup of their iOS devices-encrypted and unencrypted. An unencrypted backup is completely accessible, while an encrypted one is protected with a password chosen by the owner of the device. The first time that the user sets a password for the backup, it is saved inside the iDevice, and every subsequent backup is encrypted with the same password (until the user decides to change or remove it). For this reason, if a password has already been set when performing a forensic acquisition, we would get an encrypted backup (refer to <a class="link" href="ch03.html" title="Chapter 3. Evidence Acquisition from iDevices">Chapter 3</a>,<span class="emphasis"><em> Evidence Acquisition from iDevices</em></span>, for the different techniques used to acquire a device with a backup password set).</p><div class="section" title="iTunes backup folders"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec29"/>iTunes backup folders</h2></div></div></div><p>The folder where the backup data is stored depends on your computer's operating system. iTunes saves the backup files in these folders:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mac</strong></span>: <code class="literal">~/Library/Application Support/MobileSync/Backup/</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Windows XP</strong></span>: <code class="literal">\Documents and Settings\(username)\Application Data\Apple Computer\MobileSync\Backup\</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Windows Vista, Windows 7, Windows 8, and Windows 10</strong></span>: <code class="literal">\Users\(username)\AppData\Roaming\Apple Computer\MobileSync\Backup\</code></li></ul></div><p>Inside these folders, there is a subfolder for each iDevice that has been backed up with the same computer. The name of the subfolder is equivalent to the UDID of the device, which is a 40-character-long hexadecimal string. This means that iTunes holds only one backup for each device and copies only the files that have been modified since the last backup. When a device is updated to a new OS version and then restored, the last backup created before the update is not overwritten the first time you create a new backup. In particular, the old backup folder is renamed by appending the timestamp of the backup at the end of the folder name.</p></div><div class="section" title="iTunes backup content"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec30"/>iTunes backup content</h2></div></div></div><p>According to Apple specifications (refer to the article available at <a class="ulink" href="http://support.apple.com/kb/ht4946">http://support.apple.com/kb/ht4946</a>, as mentioned in <a class="link" href="apa.html" title="Appendix A. References">Appendix A</a>, <span class="emphasis"><em>References</em></span>), an iTunes backup includes nearly all of your device's data and settings, but doesn't contain the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Content from the iTunes and App Stores, or PDFs downloaded directly to iBooks</li><li class="listitem" style="list-style-type: disc">Content synced from iTunes, such as imported MP3s, videos, books, and photos</li><li class="listitem" style="list-style-type: disc">Photos already stored in the cloud, such as My Photo Stream, and iCloud Photo Library</li><li class="listitem" style="list-style-type: disc">Touch ID settings</li><li class="listitem" style="list-style-type: disc">Apple Pay information and settings</li><li class="listitem" style="list-style-type: disc">Activity, Health, Website, and Keychain data (although these elements are available in an encrypted backup)</li></ul></div><p>One of the main differences between an unencrypted backup and an encrypted one are related to the <code class="literal">Keychain</code> file. Inside an unencrypted backup, this file is saved encrypted with a key that depends on the device's UID, and therefore cannot be cracked offline or reactivated on a different device from the one used to generate the backup. Instead, in an encrypted backup, the <code class="literal">Keychain</code> file is encrypted with the backup password. This can be technically explained as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If the device does not have a backup password set by the user, when performing the acquisition, it is possible to create an encrypted backup choosing a known password, and later be able to access the passwords saved in the Keychain without the need to crack anything</li><li class="listitem" style="list-style-type: disc">If the device has a backup password set by the user, when performing the acquisition, it is possible to create an encrypted backup, and then trying to crack the password in order to extract those saved in the keychain</li></ul></div><p>In particular, the <code class="literal">Keychain</code> file contains the following types of passwords:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Passwords and settings of the Wi-Fi networks the device has been connected to</li><li class="listitem" style="list-style-type: disc">Passwords of the e-mail accounts configured in Apple Mail</li><li class="listitem" style="list-style-type: disc">VPN credentials</li><li class="listitem" style="list-style-type: disc">Credentials (passwords or tokens) of all third-party apps that use keychain as the password container</li></ul></div></div></div></div>
<div class="section" title="iTunes backup structure"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec36"/>iTunes backup structure</h1></div></div></div><p>In a backup folder, there are some standard files with fixed names and contents and hundreds of files with long hashed filenames consisting of 40 hexadecimal characters. The file name acts like a unique identifier for every file copied from the iDevice. In fact, each file is named as the result of an SHA-1 hash calculated on the original full name of the file in the following form:</p><p><code class="literal">Domain-[subdomain-]fullpath/filename.ext</code></p><p>Consider the following example:</p><p><code class="literal">AppDomain-com.skype.skype-Library/Preferences/com.skype.skype.plist</code></p><p>Here, <code class="literal">AppDomain</code> is the name of domain, <code class="literal">Com.skype.skype</code> is the subdomain, and <code class="literal">Library/Preferences/com.skype.skype.plist</code> is the path and the name of file.</p><p>Calculating the SHA-1 hash for <code class="literal">AppDomain-com.skype.skype-Library/Preferences/com.skype.skype.plist</code> gives us <code class="literal">bc0e135b1c68521fa4710e3edadd6e74364fc50a</code>.</p><p>This is actually the 40-character-long string we're talking about in this context.</p><p>The meaning of the elements named in the domain and subdomain is explained later in this chapter.</p><div class="section" title="Standard backup files"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec31"/>Standard backup files</h2></div></div></div><p>These files are created by the backup service and store information about the backup itself. The most useful files are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">Info.plist</code>: This is a <code class="literal">plist</code> file in plain text and stores data about the backed up device (such as date of backup creation, phone number, device name, GUID, ICCID, IMEI, product type, iOS version, serial numbers, sync settings, UDID, and so on) and the iTunes software used to create the backup (iTunes version number and iTunes settings):<div class="mediaobject"><img src="graphics/B05100_04_01.jpg" alt="Standard backup files"/></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">Manifest.plist</code>: This is a <code class="literal">plist</code> file and it describes the content of the backup. Inside this file, we can find the list of applications installed on the backed up device. For every application, there is the name and the particular version. Inside the file, there is also the date the backup was made, the backup type (encrypted versus unencrypted), and some information about the iDevice (for example, if the passcode was set on the device at the time of backup) and the iTunes software used:<div class="mediaobject"><img src="graphics/B05100_04_02.jpg" alt="Standard backup files"/></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">Status.plist</code>: This is a <code class="literal">plist</code> file in the binary format, and it stores information about the status of completion of the backup, whether the backup was made successfully or not:<div class="mediaobject"><img src="graphics/B05100_04_03.jpg" alt="Standard backup files"/></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">Manifest.mbdb</code>: This is a binary file that stores the descriptions of all the other files in the backup folder. It contains a record for each element in the backup (including symbolic link and folders, which of course don't have a corresponding element among the backup files). Each record contains the following parameters:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Domain</strong></span>: This shows the domain the element belongs to. Domains are a way to functionally categorize elements in the device backup.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Path</strong></span>: This shows the full path of the element.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Link Target</strong></span>: This shows the target of the element if the element itself is a symbolic link.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>DataHash</strong></span>: This contains the SHA-1 hash of file content.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>User ID and Group ID</strong></span>: These contain the owner and the group IDs.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>m. time</strong></span>: This shows the time (in the Unix time format) when the actual content of the file was last modified.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>a. time</strong></span>: This shows the time when the file was last accessed.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>c. time</strong></span>: This shows the time when changes were last made to the file or to the folder's node.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Length</strong></span>: This shows the size of the file in bytes (size is 0 for link or folder).</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mode and inode</strong></span>: These contain the Unix file permissions and the inode number. A really interesting thing to note from a forensics point of view is that these four files are stored unencrypted , even if the backup is encrypted with password. It means that the information contained there is accessible without cracking the password.</li></ul></div></li></ul></div><p>For a detailed explanation of the analysis of an encrypted backup, we suggest you read the research performed by Hal Pomeranz (refer to <a class="link" href="apa.html" title="Appendix A. References">Appendix A</a>, <span class="emphasis"><em>References</em></span>). The preceding parameters are explained in the following diagram:</p><div class="mediaobject"><img src="graphics/B05100_04_04.jpg" alt="Standard backup files"/></div><p>The first level of the hierarchy of the backup files is their domain. The domain for each file is written in its corresponding record in the <code class="literal">Manifest.mbdb</code> file. Each file has a domain name chosen from the following list:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>App domain</strong></span>: This contains data related to the installed apps.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>App Group domain</strong></span>: This is found starting from iOS 9 and contains specific data for third-party apps.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>App Plugin domain</strong></span>: This is found starting from iOS 9 and contains plugins of third-party apps.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Camera Roll domain</strong></span>: This contains multimedia elements related to the Camera application, such as images, videos, video previews, and image thumbnails.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Health domain</strong></span>: This is found starting from iOS 9 and contains personal health data. This domain is available only in encrypted backup.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Home domain</strong></span>: This contains data related to the standard application that comes preinstalled with iOS.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Keychain domain</strong></span>: This contains encrypted data related to the keychain.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Managed Preferences domain</strong></span>: This does not typically contain data.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Media domain</strong></span>: This contains multimedia elements not related to the Camera application, such as multimedia elements from MMSes and audio recordings.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mobile Device domain</strong></span>: This contains the provisioning profiles.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Root domain</strong></span>: This contains cache data related to the geolocation capabilities of the device.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>System Preferences domain</strong></span>: This contains configuration files for core components of iOS.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Wireless domain</strong></span>: This contains data about the mobile phone component of the device.</li></ul></div><p>Elements in the App domain are further divided into subdomains related to the applications they belong to, while elements in the other domains don't use this feature. When the subdomain is used, the domain string is written as <code class="literal">&lt;domain&gt;-&lt;subdomain&gt;</code>. Details about the backup structure are available at <a class="ulink" href="https://theiphonewiki.com/wiki/ITunes_Backup">https://theiphonewiki.com/wiki/ITunes_Backup</a>.</p></div><div class="section" title="Case study - parsing Manifest.mbdb with Mbdbls Python script"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec32"/>Case study - parsing Manifest.mbdb with Mbdbls Python script</h2></div></div></div><p>Mbdbls is an open source Python script written by Hal Pomeranz and available on his GitHub account (refer to <a class="link" href="apb.html" title="Appendix B. Tools for iOS Forensics">Appendix B</a>, <span class="emphasis"><em>Tools For iOS Forensics</em></span>). It parses a <code class="literal">Maninfest.mbdb</code> file and for each file, it extracts domain, path and filename, creation date, last accessed date, last modified date, and size. The following screenshot shows the execution of Mbdbls on a SANS SIFT workstation VM against a <code class="literal">Manifest.mbdb</code>:</p><div class="mediaobject"><img src="graphics/B05100_04_05.jpg" alt="Case study - parsing Manifest.mbdb with Mbdbls Python script"/></div><p>The tool provides various options for the output: for example, it can order by creation, last modified or last accessed dates or by file size. Be careful to take into consideration the appropriate time zone setting.</p></div></div>
<div class="section" title="iTunes backup relevant files"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec37"/>iTunes backup relevant files</h1></div></div></div><p>This section provides a complete overview of the most relevant files and folders available in a backup. For every file or folder, the full path (<code class="literal">domain-subdomain</code>) and a description are provided. Only the system and pre-installed apps are listed. A more detailed analysis of these files is provided in <a class="link" href="ch06.html" title="Chapter 6. Analyzing iOS Devices">Chapter 6</a>, <span class="emphasis"><em>Analyzing iOS Devices:</em></span></p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">SystemPreferencesDomain/SystemConfiguration/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.accounts.exists.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Information about accounts configured in the device and grouped by type (for example, Apple, Google, Facebook, E-mail, and so on).</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_06.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/Accounts/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">Account3.sqlite</code></li><li class="listitem" style="list-style-type: disc">Description: Details of the accounts configured in the device (for example, username and type of stored credentials such as password, OAuth, and so on).</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_07.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">DatabaseDomain/lsd/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.lsdidentifiers.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Launch Services Daemon Identifiers information and correlation between the application name and GUID.</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_08.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HealthDomain/Health</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">healthdb.sqlite</code></li><li class="listitem" style="list-style-type: disc">Description: List of devices and applications that accessed/updates user's health information from <code class="literal">healthdb_secure.sqlite</code>, and related timestamp of the event.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">RootDomain/Library/Preferences</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.preferences.network.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Airplane mode enabled or disabled at the time of backup.</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_09.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">RootDomain/Library/Preferences</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.MobileBackup.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Information about the last device reset. In particular, it contains the backup version of iOS, the iOS version installed on the device at the time of recovery, the recovery date, and whether the backup was restored from iCloud.</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_10.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">RootDomain/Library/Preferences</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">GlobalPreferences</code></li><li class="listitem" style="list-style-type: disc">Description: Language set.</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_11.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">SystemPreferencesDomain/SystemConfiguration/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.wifi.plist - preferences.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Information about the Wi-Fi networks configured in the device.</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_12.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">SystemPreferencesDomain/SystemConfiguration/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.network.identification.plist</code></li><li class="listitem" style="list-style-type: disc">Description: TCP/IP settings for latest connections (both Wi-Fi and cellular networks).</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_13.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">SystemPreferencesDomain/SystemConfiguration/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.radios.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Airplane mode enabled or disabled at the time of backup.</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_14.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">SystemPreferencesDomain/SystemConfiguration/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.mobilegestalt.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Device name.</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_15.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">WirelessDomain/Library/Preferences/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.commcenter.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Telco provider in use and information about the SIM card.</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_16.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">WirelessDomain/Library/Preferences/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.commcenter.counts.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Statistics on the use of data and cellular network (for example, bytes received/sent, SMS received/sent, and so on).</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_17.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">WirelessDomain/Library/Preferences/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.commcenter.callservices.plist</code></li><li class="listitem" style="list-style-type: disc">Description: iCloud account e-mail address.</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_18.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">WirelessDomain/Library/Preferences/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">csidata</code></li><li class="listitem" style="list-style-type: disc">Description: Device settings for cellular network (for example, cellular data enabled/disabled).</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/MobileBluetooth/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.MobileBluetooth.ledevices.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Information about the Bluetooth devices seen by the iOS device.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/TCC</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">TCC.db</code></li><li class="listitem" style="list-style-type: disc">Description: Access privileges assigned to the applications (for example, Address Book, Photos, Facebook, Microphone, Camera, and so on).</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/SpringBoard</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">IconState.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Arrangement of the icons within the SpringBoard, divided by window.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/AddressBook/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">AddressBook.sqlitedb</code></li><li class="listitem" style="list-style-type: disc">Description: User personal contacts, such as names, phone numbers, e-mail addresses, and so on.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/AddressBook/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">AddressBookImage.sqlitedb</code></li><li class="listitem" style="list-style-type: disc">Description: Images associated with the contacts in the Address Book.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/Calendar/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">Calendar.sqlitedb</code></li><li class="listitem" style="list-style-type: disc">Description: All the user's calendars and associated events.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/CallHistoryDB/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">CallHistory.storedata</code></li><li class="listitem" style="list-style-type: disc">Description: The list of outgoing, incoming, and missed calls made through the cellular network, as well as FaceTime.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">WirelessDomain/Library/CallHistory/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">Call_history.db</code></li><li class="listitem" style="list-style-type: disc">Description: File used as Call History database until iOS 7. If the phone has been upgraded or restored, you can find information on old calls.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/Voicemail/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">Voicemail.db</code></li><li class="listitem" style="list-style-type: disc">Description: Voicemail database.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/SMS/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">sms.db</code></li><li class="listitem" style="list-style-type: disc">Description: SMS and iMessages sent and received, including the date it has been received, read, and delivered (for iMessage), the text, and the type (sent/received).</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/SMS/</code></li><li class="listitem" style="list-style-type: disc">Folder name: <code class="literal">Drafts</code></li><li class="listitem" style="list-style-type: disc">Description: Drafts of both SMS and iMessage.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">MediaDomain/Library/SMS/</code></li><li class="listitem" style="list-style-type: disc">Folder name: <code class="literal">Attachments</code></li><li class="listitem" style="list-style-type: disc">Description: Attachments received via MMS.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/</code></li><li class="listitem" style="list-style-type: disc">Folder name: <code class="literal">DataAccess</code></li><li class="listitem" style="list-style-type: disc">Description: It contains a subfolder for each mailbox configured within the Mail application. Inside each subfolder, there is a file named <code class="literal">mboxCache.plist</code> containing the structure of the mailbox folder.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/Mail</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">Recents</code></li><li class="listitem" style="list-style-type: disc">Description: Information about the receivers and sent date of e-mails recently sent.</li></ul></div><div class="mediaobject"><img src="graphics/B05100_04_19.jpg" alt="iTunes backup relevant files"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">AppDomain/com.apple.mobilemail/Preferences/</code></li><li class="listitem" style="list-style-type: disc">Filename:  <code class="literal">com.apple.mobilemail.plist</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">com.apple.MailAccount-ExtProperties.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Apple Mail application configuration and settings of the configured accounts.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/Notes</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">Notes.sqlite</code></li><li class="listitem" style="list-style-type: disc">Description: Saved notes, grouped by account. Starting from iOS 9.3, users can optionally encrypt every single note with a password.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">HomeDomain/Library/Safari/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">bookmarks.db</code></li><li class="listitem" style="list-style-type: disc">Description: Safari bookmarks.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">AppDomain/com.apple.mobilesafari/Library/Preferences/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.mobilesafari.it</code></li><li class="listitem" style="list-style-type: disc">Description: Safari configuration file.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">AppDomain/com.apple.mobilesafari/Library/Safari/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">History.db</code></li><li class="listitem" style="list-style-type: disc">Description: Safari navigation history.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">AppDomain/com.apple.mobilesafari/Library/Safari/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">SuspendedState.plist</code></li><li class="listitem" style="list-style-type: disc">Description: It contains the status of all currently active tabs in Safari.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">AppDomain/com.apple.mobilesafari/Library/Safari/</code></li><li class="listitem" style="list-style-type: disc">Folder name: <code class="literal">Thumbnails</code></li><li class="listitem" style="list-style-type: disc">Description: It contains the thumbnails in the PNG format of the currently active Safari pages.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">AppDomain/com.apple.mobilesafari/Library/WebKit/WebSiteData</code></li><li class="listitem" style="list-style-type: disc">Folder name: <code class="literal">LocalStorage</code></li><li class="listitem" style="list-style-type: disc">Description: The <code class="literal">LocalStorage</code> database stored by websites. May contain specific information stored by the site and are useful to determine the URL accessed even though it's no longer present in the history.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">AppDomain/com.apple.Maps/Library/Preferences</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">com.apple.Maps.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Apple Maps application configuration. It contains a list of recently searched addresses.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">AppDomain/com.apple.Maps/Library/</code></li><li class="listitem" style="list-style-type: disc">Folder name: <code class="literal">Maps</code></li><li class="listitem" style="list-style-type: disc">Description: It contains several files related to the usage of Apple Maps application. Files are binary type and with the <code class="literal">.mapsdata</code> extension (for example, <code class="literal">History.mapsdata</code>), but you can pull strings with the addresses of places.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">CameraRollDomain/Media/</code></li><li class="listitem" style="list-style-type: disc">Folder name: <code class="literal">DCIM</code></li><li class="listitem" style="list-style-type: disc">Description: It contains videos and pictures taken from the device camera or saved from other third-party applications (for example, WhatsApp, Facebook, and so on). The pictures taken with the device camera are stored in the JPG format while the videos are in the MOV format. Moreover, it contains several subfolders where the files are actually stored, these names contain an increasing number (that is 100APPLE, 101APPLE, 102APPLE, and so on), and each of these folders may contain up to 1000 files.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">CameraRollDomain/Media/DCIM</code></li><li class="listitem" style="list-style-type: disc">Folder name: <code class="literal">.THMB</code></li><li class="listitem" style="list-style-type: disc">Description: Contains picture thumbnails in the JPG format.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">CameraRollDomain/Media/PhotoData/MISC/</code></li><li class="listitem" style="list-style-type: disc">Filename: <code class="literal">DCIM_APPLE.plist</code></li><li class="listitem" style="list-style-type: disc">Description: Information about the active folder and the number of files.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">CameraRollDomain/Media/PhotoData/</code></li><li class="listitem" style="list-style-type: disc">Folder name: <code class="literal">Thumbnails</code></li><li class="listitem" style="list-style-type: disc">Description: Four files in the proprietary ITHMB format, one for each possible thumbnail size.</li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Domain: <code class="literal">CameraRollDomain/Media/PhotoData/Thumbnails/V2/</code></li><li class="listitem" style="list-style-type: disc">Folder name: <code class="literal">DCIM</code></li><li class="listitem" style="list-style-type: disc">Description: Contains a subfolder for each picture with thumbnail in the JPG format.</li></ul></div></div>
<div class="section" title="iTunes backup data extraction"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec38"/>iTunes backup data extraction</h1></div></div></div><p>There are several tools available to extract data from an iTunes backup-some open source software, as well as some commercial products. These tools allow you to have complete access to the data in case of an unencrypted backup and partial access in case of an encrypted one (in particular the content of the files will not be visible unless you know the backup password or you have been able to crack it). Among the most interesting and powerful tools for accessing and extracting data from a backup, there is forensic software (UFED Physical Analyzer, Oxygen Forensic® Suite, AccessData MPE+, EnCase, Elcomsoft Phone Viewer, and so on), commercial software for data extraction (iBackup Bot, iPhone Backup Extractor, DiskAid, Wondershare Dr. Fone, and so on), and freeware/open source software for data extraction (iPhone Backup Analyzer and iPhone Analyzer). A detailed list is provided in <a class="link" href="apb.html" title="Appendix B. Tools for iOS Forensics">Appendix B</a>, <span class="emphasis"><em>Tools for iOS Forensics</em></span>. Another option is to recover the backup content on your own simply with a hex editor. In this case, we suggest you to read the article available at <a class="ulink" href="http://resources.infosecinstitute.com/ios-5-backups-part-1/">http://resources.infosecinstitute.com/ios-5-backups-part-1/</a>.</p><div class="section" title="Case study - iTunes backup parsing with iBackupBot"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec33"/>Case study - iTunes backup parsing with iBackupBot</h2></div></div></div><p>iBackupBot is a commercial tool for Windows that allows access to iTunes backup stored on a local computer. The trial version allows in any case loading and extracting information from a backup.</p><p>Once the software is executed, it automatically loads all the backups stored in the predefined iTunes Backup folder, but another backup can be opened through the <span class="strong"><strong>File</strong></span> menu. In the left-hand pane, all the loaded backups are listed and all the domains can be browsed, while in the central pane general information about the device is shown (device name, iOS version, phone number, serial number, UDID, IMEI, and so on).</p><div class="mediaobject"><img src="graphics/B05100_04_20.jpg" alt="Case study - iTunes backup parsing with iBackupBot"/></div><p>Browsing a backup reveals files that are grouped with respect to their specific domain. <span class="strong"><strong>System Files</strong></span> contains all domains referring to iOS settings and data. Third-party app data is in <span class="strong"><strong>User App Files</strong></span>, <span class="strong"><strong>App Group Files</strong></span>, and <span class="strong"><strong>App Plugin Files</strong></span>. The user can open a file by simply double -clicking on it because the software contains integrated <code class="literal">plist</code> and SQLite viewers:</p><div class="mediaobject"><img src="graphics/B05100_04_21.jpg" alt="Case study - iTunes backup parsing with iBackupBot"/></div><p>The<span class="strong"><strong> User Information Manager</strong></span> option parses some of the most common data stored in a backup, specifically the following: <span class="strong"><strong>Contacts</strong></span>, SMS/MMS <span class="strong"><strong>Messages</strong></span>, <span class="strong"><strong>Call History</strong></span>, <span class="strong"><strong>Calendar</strong></span>, <span class="strong"><strong>Notes</strong></span>, <span class="strong"><strong>Recent Email</strong></span> (only To: e-mail address, date, and time), <span class="strong"><strong>Safari Bookmarks</strong></span>, and <span class="strong"><strong>Safari History</strong></span>:</p><div class="mediaobject"><img src="graphics/B05100_04_22.jpg" alt="Case study - iTunes backup parsing with iBackupBot"/></div><p><span class="strong"><strong>Multimedia File Manager</strong></span> provides a view of media files stored in the backup and specifically the <span class="strong"><strong>Camera Roll</strong></span> domain files, <span class="strong"><strong>Voice Mail</strong></span>, <span class="strong"><strong>Voice Memo</strong></span>, and <span class="strong"><strong>Other Multimedia files</strong></span> (for example, SMS/MMS attachments, WhatsApp media files, and so on).</p><div class="mediaobject"><img src="graphics/B05100_04_23.jpg" alt="Case study - iTunes backup parsing with iBackupBot"/></div></div><div class="section" title="Case study - iTunes backup analysis with iPBA"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec34"/>Case study - iTunes backup analysis with iPBA</h2></div></div></div><p>iPhone Backup Analyzer is a tool developed by the Italian researcher Mario Piccinelli, and it provides a simple way to browse through the backup folder and perform a forensic analysis of an iDevice backup. It was released as open source software under the MIT license, and since it is written in Python, it should be cross-platform (Mac, Linux, and Windows).</p><p>The main goal behind the development is to provide a way to analyze the contents of the iPhone backup. It is meant to be used by anyone who wants to easily study what the backup contains, be they a forensics expert, an iOS developer, or just an interested iPhone user. The software is also packed with utilities to easily browse through the content formatted in a ready-to-use way, such as messages, contacts, Safari bookmarks, and so on. Its complete feature set can be summarized in the following diagram:</p><div class="mediaobject"><img src="graphics/B05100_04_24.jpg" alt="Case study - iTunes backup analysis with iPBA"/></div><p>In a Windows environment, after downloading the tool, you need to unzip it to a folder and launch the executable <code class="literal">iPBA2.exe</code> file. By navigating to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Open Archive</strong></span>, you can choose the folder containing the backup. The software parses and analyzes the backup and provides a graphical way to browse through it:</p><div class="mediaobject"><img src="graphics/B05100_04_25.jpg" alt="Case study - iTunes backup analysis with iPBA"/></div><p>By right-clicking on a <code class="literal">plist</code> or SQLite file, the analyst can view the file content. For example, in the following screenshot, you can see the content of the <code class="literal">Manifest.plist</code> file:</p><div class="mediaobject"><img src="graphics/B05100_04_26.jpg" alt="Case study - iTunes backup analysis with iPBA"/></div><p>In the following screenshot, you can see the contents of a Call History SQLite database:</p><div class="mediaobject"><img src="graphics/B05100_04_27.jpg" alt="Case study - iTunes backup analysis with iPBA"/></div><p>By choosing an item from the <span class="strong"><strong>Plugins</strong></span> menu, you can also analyze useful information from the backup. Currently, the software offers 14 plugins: <span class="strong"><strong>Address Book Browser</strong></span>, <span class="strong"><strong>Call History</strong></span>, <span class="strong"><strong>Phone Info Browser</strong></span>, <span class="strong"><strong>Known Networks</strong></span>, <span class="strong"><strong>Network Identification</strong></span>, <span class="strong"><strong>Note Browser</strong></span>, <span class="strong"><strong>Safari History Browser</strong></span>, <span class="strong"><strong>Safari State Explorer</strong></span>, <span class="strong"><strong>Safari Bookmarks</strong></span>, <span class="strong"><strong>Skype Browser</strong></span>, <span class="strong"><strong>Messages Browser</strong></span>, <span class="strong"><strong>Thumbnails Browser</strong></span>, <span class="strong"><strong>Viber Browser</strong></span>, and <span class="strong"><strong>WhatsApp Browser</strong></span>. In the following screenshot, you can see, for example, the known Wi-Fi networks plugin:</p><div class="mediaobject"><img src="graphics/B05100_04_28.jpg" alt="Case study - iTunes backup analysis with iPBA"/></div></div><div class="section" title="Case study - iTunes backup analysis with Oxygen Forensic Analyst"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec35"/>Case study - iTunes backup analysis with Oxygen Forensic Analyst</h2></div></div></div><p>Oxygen Forensic Analyst is a commercial tool that has already been introduced in <a class="link" href="ch03.html" title="Chapter 3. Evidence Acquisition from iDevices">Chapter 3</a>, <span class="emphasis"><em>Evidence Acquisition from iDevices</em></span>. This tool enables you to acquire data from an iDevice and also to import a previously created iTunes backup.</p><p>In order to import a backup, it is enough to click on <span class="strong"><strong>Import File</strong></span> from the main window and navigate to <span class="strong"><strong>Import Apple backup/image</strong></span> | <span class="strong"><strong>Import iTunes backup...</strong></span>:</p><div class="mediaobject"><img src="graphics/B05100_04_29.jpg" alt="Case study - iTunes backup analysis with Oxygen Forensic Analyst"/></div><p>When selecting a folder containing a backup, the tool shows the <code class="literal">Manifest.plist</code> file, which has to be chosen:</p><div class="mediaobject"><img src="graphics/B05100_04_30.jpg" alt="Case study - iTunes backup analysis with Oxygen Forensic Analyst"/></div><p>The software recognizes the backup structure and proposes an options screen where the investigator can decide whether they want to only do the backup conversion, or if they also want the application to do the parsing of applications' databases. Similarly, it is also possible to ask the software to recover deleted records within the database:</p><div class="mediaobject"><img src="graphics/B05100_04_31.jpg" alt="Case study - iTunes backup analysis with Oxygen Forensic Analyst"/></div><p>The software then starts the analysis process and allows users to analyze the backup content. In <a class="link" href="ch06.html" title="Chapter 6. Analyzing iOS Devices">Chapter 6</a>, 
<span class="emphasis"><em>Analyzing iOS Devices</em></span>, we will see a further example of the analysis performed with Oxygen Forensic Analyst:</p><div class="mediaobject"><img src="graphics/B05100_04_32.jpg" alt="Case study - iTunes backup analysis with Oxygen Forensic Analyst"/></div></div></div>
<div class="section" title="Encrypted iTunes backup cracking"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec39"/>Encrypted iTunes backup cracking</h1></div></div></div><p>As we explained in <a class="link" href="ch03.html" title="Chapter 3. Evidence Acquisition from iDevices">Chapter 3</a>, <span class="emphasis"><em>Evidence Acquisition from iDevices</em></span>, and in the first part of this chapter, an iTunes backup can be encrypted with a password chosen by the iDevice user. When you seize an iDevice with a backup password already set, or if you have a computer with a previously created encrypted backup, you can try to crack the backup using a dedicated tool. Currently, we were able to find only three software packages that can be used to crack an encrypted backup: EPB, Passware Forensic, and iPhone Backup Unlocker.</p><div class="section" title="Case study - iTunes encrypted backup cracking with EPB"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec36"/>Case study - iTunes encrypted backup cracking with EPB</h2></div></div></div><p>As mentioned on the product's website, Elcomsoft Phone Breaker enables forensic access to password-protected backups for smartphones and portable devices based on the Apple iOS platforms. The password recovery tool supports Apple devices running iOS, including iPhone, iPad, and iPod touch devices of all generations released to date.</p><p>After launching the tool, the first step is to load the encrypted backup by clicking on the <span class="strong"><strong>Decrypt backup</strong></span> option from the main window (<span class="strong"><strong>Tools</strong></span>) and selecting <span class="strong"><strong>Decrypt backup</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/B05100_04_33.jpg" alt="Case study - iTunes encrypted backup cracking with EPB"/></div><p>The software automatically provides a list of encrypted backups,  saved in the default backup folder of the user who is executing the tool:</p><div class="mediaobject"><img src="graphics/B05100_04_34.jpg" alt="Case study - iTunes encrypted backup cracking with EPB"/></div><p>The analyst can choose one of the proposed encrypted backups or choose another folder containing other encrypted backups. After selecting the backup, the tool asks the analyst where they want to save the decrypted backup and, if known, to provide the backup password:</p><div class="mediaobject"><img src="graphics/B05100_04_35.jpg" alt="Case study - iTunes encrypted backup cracking with EPB"/></div><p>By clicking on <span class="strong"><strong>Attempt Password Recovery</strong></span>, the user can select the type of cracking they want to perform. You can choose between two options: <span class="strong"><strong>Dictionary Attack</strong></span> or <span class="strong"><strong>Brute-Force Attack</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/B05100_04_36.jpg" alt="Case study - iTunes encrypted backup cracking with EPB"/></div><p>In the first case, the analyst can provide a custom dictionary file, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/B05100_04_37.jpg" alt="Case study - iTunes encrypted backup cracking with EPB"/></div><p>In the second case, the analyst can decide the parameters for the brute-force attack, as follows:</p><div class="mediaobject"><img src="graphics/B05100_04_38.jpg" alt="Case study - iTunes encrypted backup cracking with EPB"/></div><p>If the cracking procedure is successful, the tool provides the password to the analyst and gives the options to decrypt the backup (so that it can be analyzed with one of the tools previously mentioned):</p><div class="mediaobject"><img src="graphics/B05100_04_40.jpg" alt="Case study - iTunes encrypted backup cracking with EPB"/></div><p>Otherwise, it is possible to show the keychain content with the username and password for the Wi-Fi network connection, e-mail accounts configured in the Mail app, stored Internet passwords, and stored passwords from other apps:</p><div class="mediaobject"><img src="graphics/B05100_04_39.jpg" alt="Case study - iTunes encrypted backup cracking with EPB"/></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec40"/>Summary</h1></div></div></div><p>In this chapter, we explained the most useful information about an iTunes backup related to the forensic analysis of an iOS device. In particular, we illustrated how the backup is structured and how to parse it with commercial and open source tools. We also explained the differences between an unencrypted and encrypted backup and suggested some ways to try to crack the backup password. A really interesting point about the iTunes backup is that if the device does not have a backup password already set by its owner, when preforming the acquisition, you can create an encrypted backup, choosing a known password in order to be able to access the password saved in the <code class="literal">Keychain</code> file without the need for cracking. Instead, if you happen to have an encrypted backup for which you are not able to crack the password, it is anyway possible to analyze the <code class="literal">plist</code> files and the content of the <code class="literal">Manifest.mbdb</code> file, recovering in this way the list of all files present inside that backup. In the next chapter, how to recover data from the user iCloud account with either its credentials or authentication token will be explained.</p></div>
<div class="section" title="Self-test questions"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec41"/>Self-test questions</h1></div></div></div><p>Q1. In which folder are the iOS devices backup stored in Windows 7?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem"><code class="literal">C:\Users\[username]\AppData\Roaming\Apple Computer\MobileSync\Backup</code></li><li class="listitem"><code class="literal">C:\Users\[username]\AppData\Local\Apple Computer\MobileSync\Backup</code></li><li class="listitem"><code class="literal">C:\Users\[username]\AppData\Apple Computer\MobileSync\Backup</code></li><li class="listitem"><code class="literal">C:\Program Data\Apple Computer\MobileSync\Backup</code></li></ol></div><p>Q2. Which file contains information about the backup (such as backup date, device name, and so on)?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem"><code class="literal">Manifest.plist</code></li><li class="listitem"><code class="literal">Info.plist</code></li><li class="listitem"><code class="literal">Status.plist</code></li><li class="listitem"><code class="literal">Manifest.mbdb</code></li></ol></div><p>Q3. Which file contains the description of all the files in the backup folder?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem"><code class="literal">Manifest.plist</code></li><li class="listitem"><code class="literal">Info.plist</code></li><li class="listitem"><code class="literal">Status.plist</code></li><li class="listitem"><code class="literal">Manifest.mbdb</code></li></ol></div><p>Q4. Which backup domain contains multimedia elements related to the camera?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">App domain</li><li class="listitem">Camera Roll domain</li><li class="listitem">Media domain</li><li class="listitem">Keychain domain</li></ol></div></div></body></html>