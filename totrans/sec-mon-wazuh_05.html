<html><head></head><body>
<div><h1 class="chapter-number" id="_idParaDest-137"><a id="_idTextAnchor136"/>5</h1>
<h1 id="_idParaDest-138"><a id="_idTextAnchor137"/>Incident Response with Wazuh</h1>
<p>It is of utmost importance to have a rapid and efficient response plan in place to handle any security events that may arise in the ever-changing world of cybersecurity. For example, a sales employee opened up a malicious file with a name attached to an email pretending to be from an authorized business partner. This can result in a ransomware attack and bring down many mission-critical services. When such an incident happens, responding promptly can help to minimize the overall damage to the network. An efficient <strong class="bold">incident response</strong> (<strong class="bold">IR</strong>) can<a id="_idIndexMarker530"/> help businesses to promptly resume normal operations, thereby reducing the amount of downtime that occurs and the expenses connected with it.</p>
<p>In this chapter, we will learn how to leverage the Wazuh platform and other Wazuh-supported third-party tools to build an effective IR system. We will cover the following topics in this chapter:</p>
<ul>
<li>Introduction to incident response</li>
<li>What is Wazuh active response?</li>
<li>Blocking unauthorized SSH access</li>
<li>Isolating an infected Windows machine</li>
<li>Blocking RDP brute-force attack attempts</li>
</ul>
<h1 id="_idParaDest-139"><a id="_idTextAnchor138"/>Introduction to incident response</h1>
<p>IR is<a id="_idIndexMarker531"/> the process by which an organization handles situations<a id="_idIndexMarker532"/> such as data breaches, <strong class="bold">distributed denial of service</strong> (<strong class="bold">DDoS</strong>), and ransomware attacks. It is an effort to immediately identify an attack, mitigate the impacts of the attack, contain any damage caused by the attack, and fix the cause in order to reduce the risk of future attacks. In practice, IR refers to a collection of information security rules, processes, and tools that can be used to detect, contain, and remove intrusions. Let’s discuss the two <a id="_idIndexMarker533"/>most popular IR frameworks, the <strong class="bold">National Institute of Standards and Technology</strong> (<strong class="bold">NIST</strong>) and SANS, as shown in the following diagram.</p>
<div><div><img alt="Figure 5.1 – NIST and SANS IR" src="img/B19549_5_01.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.1 – NIST and SANS IR</p>
<h2 id="_idParaDest-140"><a id="_idTextAnchor139"/>Different methods of incident response process</h2>
<p>There are various <a id="_idIndexMarker534"/>methods for developing a structured IR process. There are two IR frameworks and processes that are most popular: NIST and SANS. Let us see each of them in detail.</p>
<h3>SANS six-step procedure</h3>
<p>The SANS Institute recommends<a id="_idIndexMarker535"/> six processes for IR: <em class="italic">preparation</em>, <em class="italic">identification</em>, <em class="italic">containment</em>, <em class="italic">eradication</em>, <em class="italic">recovery</em>, and <em class="italic">lessons learned</em>.</p>
<p>Let’s elaborate on the SANS six-step procedure. SANS defines IR as having six stages. When an incident occurs, these six processes are repeated in a cycle. The steps are as follows:</p>
<ol>
<li>Preparation of systems and procedures</li>
<li>Identification of incidents</li>
<li>Containment of attack</li>
<li>Eradication of intrusion</li>
<li>Recovery from accidents, including system restoration</li>
<li>Lessons gained and feedback applied to the next stage of planning</li>
</ol>
<p>Let us understand each of the processes step by step:</p>
<ol>
<li><strong class="bold">Preparation</strong>: During the first step<a id="_idIndexMarker536"/> of preparation, you evaluate the efficiency of existing security measures and regulations. This entails doing a risk assessment to identify current vulnerabilities and the priority of your assets. Some of the important action items are listed here:<ul><li>Create a policy and plan for IR</li><li>Create an IR team</li><li>Determine and categorize important assets</li><li>Acquire the tools and technology required for incident detection and response</li></ul></li>
<li><strong class="bold">Identification of incidents</strong>: The<a id="_idIndexMarker537"/> emphasis is on the constant monitoring and identification of potential security issues using techniques <a id="_idIndexMarker538"/>such <a id="_idIndexMarker539"/>as <strong class="bold">intrusion detection systems</strong> (<strong class="bold">IDSs</strong>), <strong class="bold">security incident and event management</strong> (<strong class="bold">SIEM</strong>), <strong class="bold">endpoint detection and response</strong> (<strong class="bold">EDR</strong>), and<a id="_idIndexMarker540"/> log analysis. Some of the important steps are listed here:<ul><li>Continuous surveillance for indications of security incidents</li><li>Use host-based and network-based IDSs</li><li>Gather and examine logs from various sources</li><li>Make use of threat <a id="_idIndexMarker541"/>intelligence streams</li></ul></li>
<li><strong class="bold">Containment of attack</strong>: When an <a id="_idIndexMarker542"/>incident occurs, this phase focuses on immediately isolating compromised systems, implementing temporary solutions or workarounds, and updating access restrictions and firewall rules to avoid additional compromise. This is where digital forensics plays a critical role.</li>
<li><strong class="bold">Eradication of intrusion</strong>: The incident’s root cause is recognized and treated here. Vulnerabilities that allowed the <a id="_idIndexMarker543"/>incident to occur are remedied, and policies and configurations are modified to prevent the same occurrence from occurring again.</li>
<li><strong class="bold">Recovery from accidents, including system restoration</strong>: This phase focuses on resuming the normal operation<a id="_idIndexMarker544"/> of affected systems, certifying their integrity, and ensuring that the incident has been thoroughly resolved. It also entails analyzing and upgrading IR processes depending on the incident’s lessons gained.</li>
<li><strong class="bold">Lessons learned phase</strong>: During <a id="_idIndexMarker545"/>this phase, organizations undertake a post-event review, documenting the incident, the reaction, and the lessons learned. The purpose is to develop IR plans <a id="_idIndexMarker546"/>and policies, as well as to offer IR team members additional training.</li>
</ol>
<h3>NIST four-step procedure</h3>
<p>NIST defines IR as having <a id="_idIndexMarker547"/>four steps: <em class="italic">preparation</em>, <em class="italic">detection and analysis</em>, <em class="italic">containment, eradication, and recovery</em>, and <em class="italic">post-incident activity</em>. Let us understand each of these processes in detail:</p>
<ol>
<li><strong class="bold">Preparation</strong>: The NIST<a id="_idIndexMarker548"/> framework for IR emphasizes preparation as a critical component, much like the SANS framework does. During this phase, systems, procedures, and plans must be put in place in order to get ready for incidents. Organizations should have the following in place to be ready for incidents:<ul><li>A precise IR strategy</li><li>Clearly defined roles and duties</li><li>A successful communication strategy</li><li>Reporting plan</li><li>Determining the vital systems and resources</li><li>Testing and updating the IR plan on a regular basis</li></ul></li>
<li><strong class="bold">Detection and analysis</strong>: During<a id="_idIndexMarker549"/> this phase, companies identify and examine occurrences to comprehend their extent and consequences. Making decisions regarding how to respond to an incident at this time is crucial. The following should be in place inside businesses in order to recognize and analyze occurrences effectively:<ul><li>Keeping an eye on escalation processes and mechanisms</li><li>Prompt incident detection and analysis</li></ul></li>
<li><strong class="bold">Containment, eradication, and recovery</strong>: The <a id="_idIndexMarker550"/>containment, eradication, and recovery stages in the NIST framework are similar to those in the SANS framework. The following should be in place inside organizations in order to contain, eliminate, and recover from incidents:<ul><li>Isolating the impacted systems</li><li>Eliminating the incident’s cause</li><li>Returning to <a id="_idIndexMarker551"/>regular operations</li></ul></li>
<li><strong class="bold">Post-incident activity</strong>: In the <a id="_idIndexMarker552"/>NIST system, post-incident activity is the last phase. Organizations evaluate their IR procedure and evaluate the effects of incidents at this point. The following should be in place for organizations to examine and enhance the IR process:<ul><li>A procedure to evaluate the IR methodology</li><li>A process for recording the lessons discovered</li><li>A plan for bringing enhancements to the IR procedure into practice</li></ul></li>
</ol>
<h3>Objectives of the NIST and SANS procedures</h3>
<p>The objectives of the <a id="_idIndexMarker553"/>NIST and SANS IR frameworks are similar and<a id="_idIndexMarker554"/> offer an organized method for handling incidents. Nonetheless, the two frameworks differ in a few significant ways:</p>
<ul>
<li>Both frameworks emphasize the significance of having a precise IR plan, defined roles and duties, and efficient communication when it comes to the preparation stage. On the other hand, having a reporting plan in place and identifying key systems and assets are given more weight in the NIST framework.</li>
<li>Both frameworks concentrate on the prompt detection and examination of occurrences in terms of detection and analysis. But whereas the NIST framework is more concerned with monitoring systems and escalation protocols, the <a id="_idIndexMarker555"/>SANS approach prioritizes triage and <a id="_idIndexMarker556"/>prioritizing.</li>
</ul>
<p>In the next section, we will discuss the importance of automating IR activities.</p>
<h1 id="_idParaDest-141"><a id="_idTextAnchor140"/>Incident response automation</h1>
<p>Effective IR is time-sensitive <a id="_idIndexMarker557"/>and requires teams to identify threats and initiate an <strong class="bold">incident response plan</strong> (<strong class="bold">IRP</strong>) as soon<a id="_idIndexMarker558"/> as possible. A security team receives thousands of security alerts from security tools every day and hence it is difficult to manually analyze events or assess every alarm that security tools generate. These constraints are addressed via automated IR. In <a href="B19549_04.xhtml#_idTextAnchor116"><em class="italic">Chapter 4</em></a>, <em class="italic"> Security Automation and Orchestration Using Shuffle</em>, we learned how shuffle SOAR makes this possible by creating workflows, helping the security team with automated incident enrichment, automated observable analysis with TheHive tool integration, automating Wazuh activities, and many more. In this chapter, our focus will be on using Wazuh’s in-built capability called active response to perform IR. In general, IR automation can help the security team with the following:</p>
<ul>
<li><strong class="bold">Immediate containment</strong>: Once compromised systems are identified, automated IR systems should isolate them to stop threats from spreading</li>
<li><strong class="bold">Dynamic firewall rules</strong>: In response to certain risks, the IR automation system can dynamically develop and deploy firewall rules that block malicious traffic or isolate vulnerable systems</li>
<li><strong class="bold">Automated account disabling</strong>: Automated reaction steps can quickly disable compromised user accounts in the case of a security incident, blocking future unauthorized access</li>
<li><strong class="bold">User access restrictions</strong>: To improve the security posture, the IR automation system can impose access controls, such as removing users who indicate suspicious behavior or restricting access privileges</li>
<li><strong class="bold">GeoIP blocking</strong>: To strengthen defense against targeted attacks, automated IR can use GeoIP blocking rules to limit access from particular geographic regions known for <a id="_idIndexMarker559"/>malicious activity</li>
</ul>
<p>We can create tons of different use cases for automating IR. In the next section, we will practically deploy and test some of the automated IR using Wazuh’s active response capability.</p>
<h1 id="_idParaDest-142"><a id="_idTextAnchor141"/>Wazuh active response</h1>
<p>One of the main <a id="_idIndexMarker560"/>components of the Wazuh platform that enables automatic responses to security events and incidents is called active response. Security analysts can respond quickly to specific security threats or triggers identified by the Wazuh system by utilizing active response. By utilizing active response features, Wazuh enables organizations to respond to security incidents quickly and aggressively. With Wazuh active response, you may develop and execute automated responses against most security alerts. These responses may include executing custom scripts, banning IP addresses, or deactivating user accounts. Automating response actions makes sure that incidents with a high significance are dealt with and mitigated in a timely and consistent way. This is especially helpful when security teams don’t have a lot of resources and have to decide how to respond first.</p>
<p>In this section, we will cover the following topics:</p>
<ul>
<li>Active response scripts</li>
<li>Configuring active response</li>
<li>The working of Wazuh active response</li>
</ul>
<h2 id="_idParaDest-143"><a id="_idTextAnchor142"/>Active response scripts</h2>
<p>Wazuh provides pre-built Active <a id="_idIndexMarker561"/>response scripts for Linux, Windows, and macOS systems. Additionally, it also helps security professionals to write custom active response scripts based on specific requirements. The default active response scripts are stored in the following folders/directories:</p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-2">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold">Endpoint</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">Location (Directory/Folder)</strong></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Windows</p>
</td>
<td class="No-Table-Style">
<p><code>C:\Program </code><code>Files (x86)\ossec-agent\active-response\bin</code></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Linux</p>
</td>
<td class="No-Table-Style">
<p><code>/</code><code>var/ossec/active-response/bin</code></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>macOS</p>
</td>
<td class="No-Table-Style">
<p><code>/</code><code>Library/ossec/active-response/bin</code></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 5.1 – Location of active response scripts</p>
<p>The<a id="_idIndexMarker562"/> Wazuh team and the entire community have done a brilliant job in building powerful active response scripts. Some of the popular scripts are mentioned in the following table:</p>
<table class="No-Table-Style _idGenTablePara-1" id="table002">
<colgroup>
<col/>
<col/>
</colgroup>
<thead>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold">Operating System</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">Scripts</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Windows</p>
</td>
<td class="No-Table-Style">
<ul>
<li><code>Netsh.exe</code>: Blocks an IP address using <code>netsh</code></li>
<li><code>Restart-wazuh.exe</code>: Restarts the Wazuh agent</li>
<li><code>Route-null.exe</code>: Adds an IP address to the null route</li>
</ul>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Ubuntu</p>
</td>
<td class="No-Table-Style">
<ul>
<li><code>firewall-drop</code>: Adds an IP address to the IP tables deny list</li>
<li><code>start.sh</code>: Restarts the Wazuh agent or manager</li>
<li><code>Route-null</code>: Adds an IP address to a null route</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 5.2 – List of default active response scripts</p>
<p>Now, let’s learn how to set up active response on the monitored endpoints.</p>
<h2 id="_idParaDest-144"><a id="_idTextAnchor143"/>Configuring active response</h2>
<p>Active response<a id="_idIndexMarker563"/> configuration needs to be done only on the Wazuh server. However, both the server and agent must have an active response script. Wazuh requires three things to execute an active response, and these are as follows:</p>
<ul>
<li>Active response script</li>
<li>The <code>&lt;</code><code>command&gt;</code> tag</li>
<li>The <code>&lt;</code><code>active-response&gt;</code> tag</li>
</ul>
<h3>Active response script</h3>
<p>The Wazuh <a id="_idIndexMarker564"/>manager and agents have out-of-the-box active response scripts, supporting Linux, macOS, and Windows endpoints. We can also create custom active response scripts that run when an alert of a specific rule ID, rule group, or alert level triggers. All the default active response scripts are stored in the /var/ossec/active-response/bin directory. If you create a custom script, make sure you save them in the same directory.</p>
<h3>The &lt;command&gt; tag</h3>
<p>The <code>&lt;command&gt;</code> tag specifies which script should be executed when a certain rule is triggered. The <code>&lt;command&gt;</code> elements for out-of-the-box active response scripts are<a id="_idIndexMarker565"/> automatically included in the Wazuh server <code>/var/ossec/etc/ossec.conf </code>instance type; therefore, it is not required to add them. Let me share an example of the <code>&lt;</code><code>command&gt;</code> block:</p>
<pre class="source-code">
&lt;command&gt;
  &lt;name&gt;firewall-drop&lt;/name&gt;
  &lt;executable&gt;firewall-drop&lt;/executable&gt;
  &lt;timeout_allowed&gt;yes&lt;/timeout_allowed&gt;
&lt;/command&gt;</pre> <p>Here, we have the following:</p>
<ul>
<li><code>&lt;name&gt;</code>: Name of the command</li>
<li><code>&lt;executable&gt;</code>: Defines the script or executable that must be executed in response to a trigger</li>
<li><code>&lt;timeout_allowed&gt;</code>: Enables a timeout following a specified duration</li>
</ul>
<h3>The &lt;active-response&gt; tag</h3>
<p>Insert an <code>&lt;active-response&gt;</code> tag within the <code>&lt;ossec_config&gt;</code> element <a id="_idIndexMarker566"/>in the <code>/var/ossec/etc/ossec.conf</code> file of the same Wazuh server. The <code>&lt;active-response&gt;</code> block specifies the location and condition of command execution, as shown:</p>
<pre class="source-code">
&lt;active-response&gt;
    &lt;command&gt;firewall-drop&lt;/command&gt;
    &lt;location&gt;local&lt;/location&gt;
    &lt;rules_id&gt;5712&lt;/rules_id&gt;
    &lt;timeout&gt;60&lt;/timeout&gt;
  &lt;/active-response&gt;</pre> <p>Here, we have the following:</p>
<ul>
<li><code>&lt;command&gt;</code>: It provides the configuration command. In our case, we have used <code>firewall-drop</code>.</li>
<li><code>&lt;location&gt;</code>: It indicates the location where the command must be executed. We have three types of locations: <code>Local</code>, <code>Server</code>, or <code>Defined-agent</code>. The purpose of these options is as follows:<ul><li><code>Server</code>: It executes the script on the Wazuh server.</li><li><code>Defined-agent</code>: It runs the script on a predefined agent. We require the <code>&lt;agent-id&gt;</code> tag to<a id="_idIndexMarker567"/> specify the ID of the Wazuh agent.</li></ul></li>
</ul>
<h2 id="_idParaDest-145"><a id="_idTextAnchor144"/>How Wazuh active response works</h2>
<p>These active response<a id="_idIndexMarker568"/> scripts (hosted at <code>/var/ossec/active-response/bin</code>) are run on monitored endpoints by Wazuh in response to alerts triggered by a particular rule ID, level, or rule group. You can write a variety of scripts to start in response to a trigger, but you need to carefully plan these actions. Inadequate execution of rules and replies may make an endpoint more vulnerable.</p>
<p>Let’s talk about how Wazuh active response works:</p>
<ol>
<li><strong class="bold">Event generated</strong>: The Wazuh agent pushes the events to the manager. The Wazuh manager analyzes and triggers alerts based on the matched rule.</li>
</ol>
<div><div><img alt="Figure 5.2 – Event generated" src="img/B19549_5_02.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.2 – Event generated</p>
<ol>
<li value="2"><code>&lt;active-response&gt;</code> block within the <code>&lt;ossec_config&gt;</code> tag in the Wazuh server with the <code>&lt;rule_id&gt;</code> tag and there is a matching security alert, it will trigger our newly created <code>&lt;active-response&gt;</code>.</li>
<li><code>&lt;command&gt;</code> block. Wazuh agents will have the default active response scripts; however, if you want to implement any custom active response, you need to write and save the code in the Wazuh agent.</li>
<li><code>/var/ossec/active-response/bin</code> location. You can troubleshoot or verify the Wazuh active response by checking the logs present at <code>/var/ossec/active-response/active-response.log</code>.</li>
</ol>
<div><div><img alt="Figure 5.3 – Executing active response on Wazuh agent" src="img/B19549_5_03.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.3 – Executing active response on Wazuh agent</p>
<ol>
<li value="5"><strong class="bold">Active response alert</strong>: Once <a id="_idIndexMarker570"/>the active response script is executed, our Wazuh manager will take that alert from the Wazuh agent and show it to us on the security alert dashboard.</li>
</ol>
<div><div><img alt="Figure 5.4 – Active response log" src="img/B19549_5_04.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.4 – Active response log</p>
<p>Now that we understand how Wazuh active response works and how to configure it, let’s cover some practical use cases.</p>
<h1 id="_idParaDest-146"><a id="_idTextAnchor145"/>Blocking unauthorized SSH access</h1>
<p><strong class="bold">SSH attacks</strong> are among <a id="_idIndexMarker571"/>the most prevalent types of attacks against servers accessible via the internet. Automated bots that regularly monitor the internet for SSH servers with inadequate security setups carry out the major share of SSH attacks. Because attack sources are frequently scattered globally, with no single country dominating, it is a global cybersecurity threat. Organizational losses, data breaches, and compromised servers are all possible outcomes of successful SSH attacks. In this section, we will learn how to automatically block unauthorized SSH access to a victim’s machine.</p>
<p>We will learn about the following:</p>
<ul>
<li> Lab setup</li>
<li>Setting up active response</li>
<li>Testing</li>
</ul>
<h2 id="_idParaDest-147"><a id="_idTextAnchor146"/>Lab setup</h2>
<p>In this lab setup, we <a id="_idIndexMarker572"/>require three things: an Ubuntu Server with a Wazuh agent installed, an attacker machine (Kali Linux), and, finally, our Wazuh server (we have used a Virtual Machine OVA file for Lab purposes only). The lab is designed as follows.</p>
<div><div><img alt="Figure 5.5 – Lab setup: Blocking unauthorized SSH access using Wazuh active response" src="img/B19549_5_05.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.5 – Lab setup: Blocking unauthorized SSH access using Wazuh active response</p>
<p>In this lab, we are going to use the <code>firewall-drop</code> scripts as the default active response script for the monitored Ubuntu agent. Next, we need to modify the active response script to be triggered when an unauthorized SSH connection is detected.</p>
<h2 id="_idParaDest-148"><a id="_idTextAnchor147"/>Setting up Wazuh active response</h2>
<p>In order to set up the Wazuh <a id="_idIndexMarker573"/>platform to block unauthorized SSH access attempts, we need to execute the firewall-drop active response script once Wazuh rule <code>5710</code> is triggered. We need to take the steps that follow to accomplish this task.</p>
<h3>Modifying the active response on the Wazuh manager</h3>
<p>As we <a id="_idIndexMarker574"/>have learned, <code>&lt;active-response&gt;</code> executes a specific <code>&lt;command&gt;</code> block. In our case, we are utilizing the firewall-drop active response, which executes the <code>firewall-drop</code> command. We can find both the <code>&lt;command&gt;</code> and <code>&lt;active-response&gt;</code> blocks in the <code>ossec.conf</code> file located at <code>/var/ossec/etc</code>. We want to make sure the <code>&lt;active-response&gt;</code> block for firewall-drop is executed once rule <code>5710</code> is triggered. Wazuh rule <code>5710</code> represents <code>sshd: Attempt to login using a non-existent user</code>. The final modified <code>&lt;command&gt;</code> and <code>&lt;active-response&gt;</code> blocks are shown here:</p>
<pre class="source-code">
    &lt;name&gt;firewall-drop&lt;/name&gt;
    &lt;executable&gt;firewall-drop&lt;/executable&gt;
    &lt;timeout_allowed&gt;yes&lt;/timeout_allowed&gt;
  &lt;/command&gt;
  &lt;active-response&gt;
    &lt;command&gt;firewall-drop&lt;/command&gt;
    &lt;location&gt;local&lt;/location&gt;
    &lt;rules_id&gt;5710&lt;/rules_id&gt;
    &lt;timeout&gt;60&lt;/timeout&gt;
  &lt;/active-response&gt;</pre> <p>Here, we have the following:</p>
<ul>
<li><code>&lt;executable&gt;</code>: It is set to <code>firewall-drop</code>, which indicates the name of the script located at <code>/var/ossec/active-response/bin</code> of the Wazuh agent</li>
<li><code>&lt;location&gt;</code>: It is set to <code>local</code>, which indicates it only runs the script on the monitored endpoint that generated the alert</li>
<li><code>&lt;timeout&gt;</code>: It is set to 60 seconds and specifies that for 60 seconds the active response <a id="_idIndexMarker575"/>action will be effective</li>
</ul>
<h3>Restarting the Wazuh manager</h3>
<p>In order for the<a id="_idIndexMarker576"/> Wazuh manager to implement the configuration change, we need to restart the manager, as shown:</p>
<pre class="console">
systemctl restart wazuh-manager</pre> <h2 id="_idParaDest-149"><a id="_idTextAnchor148"/>Testing</h2>
<p>To test the<a id="_idIndexMarker577"/> unauthorized SSH brute-force attack, you can log in to a Kali Linux machine and run the following-mentioned <code>hydra</code> tool command:</p>
<pre class="console">
hydra -l  voldemort -P &lt;PASSWORD_TEXT_FILE&gt;  &lt;WAZUH_AGENT_IP&gt; ssh</pre> <p>Here, we have the following:</p>
<ul>
<li><code>hydra</code>: This is the name of the tool used to perform the SSH brute-force attack.</li>
<li><code>-l voldemort</code>: The <code>-l</code> flag is used to indicate the username for the SSH login attempt. In this case, the username is <code>voldemort</code>.</li>
<li><code>-P &lt;PASSWORD_TEXT_FILE&gt;</code>: The <code>–P</code> flag is used to specify the path to the text file containing the list of passwords.</li>
<li><code>&lt;WAZUH_AGENT_IP&gt;</code>: This represents the IP address of the Wazuh agent.</li>
<li><code>SSH</code>: This specifies the service that <code>hydra</code> will attempt to attack.</li>
</ul>
<p>Once you hit <strong class="bold">Enter</strong>, the SSH brute-force attack will be executed as shown in the following diagram:</p>
<div><div><img alt="Figure 5.6 –  Launching an SSH brute-force attack" src="img/B19549_5_06.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.6 –  Launching an SSH brute-force attack</p>
<h2 id="_idParaDest-150"><a id="_idTextAnchor149"/>Visualizing alerts</h2>
<p>Now, once the <a id="_idIndexMarker578"/>SSH brute-force attack is executed, we will see two alerts: first, an SSH unauthorized access attempt, and second, an active response blocking user access. To visualize the alerts, go to the Wazuh manager and navigate to <strong class="bold">Security alerts</strong>. You will see the following:</p>
<div><div><img alt="Figure 5.7 – Wazuh alerts after the SSH brute-force attack" src="img/B19549_5_07.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.7 – Wazuh alerts after the SSH brute-force attack</p>
<p>Let’s look into the first alert, <strong class="bold">ssh: Attempt to login using a non-existing user</strong>, as shown in the following figure.</p>
<div><div><img alt="Figure 5.8 – Wazuh alert – ssh: Attempt to login using a non-existing user" src="img/B19549_5_08.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.8 – Wazuh alert – ssh: Attempt to login using a non-existing user</p>
<p>Here, we have the <a id="_idIndexMarker579"/>following:</p>
<ul>
<li><code>5710</code>: This represents the Wazuh rule ID <code>5710</code>, <strong class="bold">sshd: Attempt to login using a </strong><strong class="bold">non-existing user</strong>.</li>
<li><code>data.srcuser: voldemort</code>: This represents the username of the unauthorized account. In this case, it is <code>voldemort</code>.</li>
</ul>
<p>Next, we will look into an active response alert triggered by Wazuh rule ID <code>5710</code>, as shown in the following figure.</p>
<div><div><img alt="Figure 5.9 – Security alert – Host Blocked by firewall-drop Active Response" src="img/B19549_5_09.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.9 – Security alert – Host Blocked by firewall-drop Active Response</p>
<p>Here, we have<a id="_idIndexMarker580"/> the following:</p>
<ul>
<li><code>data.parameters.alert.data.srcuser: voldemort</code>: This represents the username blocked by the firewall-drop active response script.</li>
</ul>
<p>In this use case, we have automatically blocked any unauthorized SSH attempt to our Ubuntu server running the Wazuh agent. In the next section, we will learn how to automatically isolate a Windows machine after getting infected by malware.</p>
<h1 id="_idParaDest-151"><a id="_idTextAnchor150"/>Isolating a Windows machine post-infection</h1>
<p>The process of <a id="_idIndexMarker581"/>isolating a compromised endpoint is an essential part of IR in a SOC. In order to stop the threat from spreading and inflicting further damage, you must isolate the infected device or system from the network immediately. Also remember that it is important to examine the severity of the compromise, the value of the asset, and the potential impact on the business before deciding on an isolation strategy; isolation is not a silver bullet. A ransomware attack is an essential attack scenario in which isolation is a crucial step. Ransomware is a type of malware that encrypts the data of a victim and demands payment for the decryption key. It frequently spreads quickly throughout a network, potentially affecting many endpoints. In this section, we will isolate a Windows machine post-infection by malware. We will utilize the Wazuh active response capability to create an automatic outbound rule to<a id="_idIndexMarker582"/> block all outgoing traffic. In this section, we will cover the following:</p>
<ul>
<li>Requirement</li>
<li>Approach</li>
<li>Setting up a Windows machine with a batch and PowerShell file</li>
<li>Setting up Wazuh manager with VirusTotal and active response</li>
<li>Testing</li>
</ul>
<h2 id="_idParaDest-152"><a id="_idTextAnchor151"/>Requirement</h2>
<p>In this use case, we are going to <a id="_idIndexMarker583"/>write a custom active response script to isolate a Windows machine. In order to demonstrate this detection, we need the following:</p>
<ul>
<li>A Windows 10 or 11 machine with the Wazuh agent installed</li>
<li>PowerShell version 7</li>
<li>VirusTotal integration</li>
<li>A PowerShell script to block all outgoing traffic</li>
<li>A Windows batch file (active response script) to trigger a PowerShell script</li>
</ul>
<h2 id="_idParaDest-153"><a id="_idTextAnchor152"/>VirusTotal integration</h2>
<p>In this step, we will integrate the<a id="_idIndexMarker584"/> VirusTotal platform with the Wazuh manager. VirusTotal is an online platform that aggregates several antivirus software and detects malicious content and false positives. We will cover three steps:</p>
<ol>
<li>Set up a VirusTotal account.</li>
<li>Integrate VirusTotal with Wazuh.</li>
<li>Create a<a id="_idIndexMarker585"/> file integrity rule.</li>
</ol>
<p>To complete all three steps, you can follow the steps described in the <em class="italic">VirusTotal integration</em> section of <a href="B19549_02.xhtml#_idTextAnchor042"><em class="italic">Chapter 2</em></a>, <em class="italic">Malware Detection </em><em class="italic">Using Wazuh</em>.</p>
<h2 id="_idParaDest-154"><a id="_idTextAnchor153"/>Setting up a Windows machine with a batch and PowerShell file</h2>
<p>In this step, we <a id="_idIndexMarker586"/>will set up our Windows machine with an active response script. We will use a batch file to create an active response script. Next, to create a Windows Firewall rule to block all outgoing traffic, we need a PowerShell script. This PowerShell script will only be triggered when the batch file is executed. To complete the entire process, follow these steps.</p>
<h3>Installing PowerShell version 7</h3>
<p>Log in to your <a id="_idIndexMarker587"/>Windows 10 or 11 machine and install PowerShell version 7 from the official website:</p>
<p><a href="https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.3">https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.3</a></p>
<p>Once downloaded and installed, you can find the executable at <code>C:\\Program Files\\PowerShell\\7\\"pwsh.ex</code>.</p>
<h3>Writing a batch file as an active response script</h3>
<p>Next, let’s create<a id="_idIndexMarker588"/> our active response script first. This will be done by using a Windows batch script, which will then trigger a PowerShell script to block all outgoing traffic from a Windows machine.</p>
<p>Write an active response script in Notepad and save it with the name <code>fw.cmd</code> at the following location:</p>
<pre class="console">
C:\\Program Files (x86)\\ossec-agent\\active-response\\bin
@ECHO OFF
ECHO.
"C:\\Program Files\\PowerShell\\7\\"pwsh.exe -executionpolicy ByPass -File "C:\\Program Files (x86)\\ossec-agent\\active-response\\bin\\wfblock.ps1"
:Exit</pre> <h3>Writing a PowerShell script</h3>
<p>Next, write <a id="_idIndexMarker589"/>a PowerShell script in Notepad and save it with name <code>wfblock.ps1</code> at the same location:</p>
<pre class="source-code">
C:\\Program Files (x86)\\ossec-agent\\active-response\\bin\\wfblock.ps1
#Author Rajneesh Gupta
# Set ConfirmPreference to None to automatically answer "No" to confirmation prompts
$ConfirmPreference = "None"
# Define the rule name
$ruleName = "BlockOutgoingTraffic"
# Check if the rule already exists
$existingRule = Get-NetFirewallRule | Where-Object {$_.Name -eq $ruleName}
if ($existingRule -eq $null) {
    # Create a new outbound block rule
    New-NetFirewallRule -DisplayName $ruleName -Direction Outbound -Action Block -Enabled True
    Write-Host "Outgoing traffic is now blocked."
} else {
    Write-Host "Outgoing traffic is already blocked."
}</pre> <p>Here, we have the following:</p>
<ul>
<li><code>$ruleName = "BlockOutgoingTraffic"</code>: It creates a <code>$ruleName</code> variable with the value <code>BlockOutgoingTraffic</code>. This will create a name for the Windows Firewall rule.</li>
<li><code>$existingRule</code>: This will check whether the rule already exists. If it doesn’t exist, then<a id="_idIndexMarker590"/> create a new rule to block all outgoing traffic.</li>
</ul>
<p>Once you set up the Windows machine configuration, you need to set up the Wazuh manager with an active response block and Wazuh rules.</p>
<h2 id="_idParaDest-155"><a id="_idTextAnchor154"/>Active response block in the Wazuh manager</h2>
<p>In order to make sure, we <a id="_idIndexMarker591"/>need to modify or add the <code>&lt;command&gt;</code> and <code>&lt;active-response&gt;</code> blocks under the <code>/</code><code>var/ossec/etc/conf</code> file:</p>
<pre class="source-code">
&lt;command&gt;
    &lt;name&gt;windowsfirewall&lt;/name&gt;
    &lt;executable&gt;fw.cmd&lt;/executable&gt;
    &lt;timeout_allowed&gt;yes&lt;/timeout_allowed&gt;
  &lt;/command&gt;</pre> <p>Here, make sure the <code>&lt;executable&gt;</code> tag has <code>fw.cmd</code>, which is the same as the Windows batch file we created earlier.</p>
<p>Second, we need to add an <code>&lt;active-response&gt;</code> block, as shown:</p>
<pre class="source-code">
  &lt;active-response&gt;
   &lt;disabled&gt;no&lt;/disabled&gt;
   &lt;command&gt;windowsfirewall&lt;/command&gt;
   &lt;location&gt;local&lt;/location&gt;
   &lt;rules_id&gt;87105&lt;/rules_id&gt;
   &lt;timeout&gt;60&lt;/timeout&gt;
  &lt;/active-response&gt;</pre> <p>Here, we have the following:</p>
<ul>
<li><code>&lt;command&gt;</code> is using the Windows firewall command.</li>
<li><code>&lt;rules_id&gt;</code> is selected as <code>87105</code> so that it will trigger when VirusTotal detects any malware sample. Wazuh rule <code>87105</code> defines the VirusTotal alert related to the sample file against the defined number of antivirus engines. To learn more, you can check the <code>0490-virustotal_rules.xml</code> Wazuh rule file under<a id="_idIndexMarker592"/> the <strong class="bold">Management</strong> tab of the Wazuh manager.</li>
</ul>
<h2 id="_idParaDest-156"><a id="_idTextAnchor155"/>Testing</h2>
<p>In order to test this <a id="_idIndexMarker593"/>use case, we will use a malware sample from <a href="http://eicar.org">eicar.org</a>. You can download it using this URL: <a href="https://www.eicar.org/download-anti-malware-testfile/">https://www.eicar.org/download-anti-malware-testfile/</a>.</p>
<p>To make sure VirusTotal detects our testing malware sample, you need to save it in the document folder of a Windows 10/11 machine. Once you save the file, a file integrity check will be executed, and it will trigger VirusTotal to scan the sample. You can also find the corresponding alerts on the Wazuh dashboard.</p>
<div><div><img alt="Figure 5.10 – Visualizing VirusTotal alerts on the Wazuh manager" src="img/B19549_5_10.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.10 – Visualizing VirusTotal alerts on the Wazuh manager</p>
<p>Let’s take a closer look at the <code>full.log</code> and rule description as follows.</p>
<div><div><img alt="Figure 5.11 – Visualizing a Wazuh alert about the eicar.com(1) file" src="img/B19549_5_11.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.11 – Visualizing a Wazuh alert about the eicar.com(1) file</p>
<p>We can also <a id="_idIndexMarker594"/>check the second alert, <code>data.virustotal.source.file</code> data field and rule ID <code>87105</code>.</p>
<div><div><img alt="Figure 5.12 – Expanding a VirusTotal security alert on the Wazuh manager" src="img/B19549_5_12.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.12 – Expanding a VirusTotal security alert on the Wazuh manager</p>
<p>Now, our <code>&lt;active-response&gt;</code> block will be executed as it is tied with rule ID <code>87105</code>, which belongs to the VirusTotal alert, and our command, <code>fw.cmd</code>, will be executed on a Windows 10 machine. This <code>fw.cmd</code> active response script will trigger a PowerShell script and <a id="_idIndexMarker595"/>block all the outgoing traffic, as you can see in the following figure.</p>
<div><div><img alt="Figure 5.13 – Status of newly created BlockOutgoingTraffic rule on a Windows machine" src="img/B19549_5_13.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.13 – Status of newly created BlockOutgoingTraffic rule on a Windows machine</p>
<p>So, we have successfully tested how Wazuh active response automatically blocks all outgoing traffic when our Windows machine is compromised by malware. This was possible by using our custom PowerShell script to create a security rule in the Windows Firewall service. In the next section, we will use active response to block RDP brute-force attack attempts.</p>
<h1 id="_idParaDest-157"><a id="_idTextAnchor156"/>Blocking RDP brute-force attacks</h1>
<p>According to Sophos, in the first half of 2023, adversaries <a id="_idIndexMarker596"/>leveraged <strong class="bold">Remote Desktop Protocol</strong> (<strong class="bold">RDP</strong>) in 95% of attacks, increased by 88% from 2023. RDP is a Microsoft-developed proprietary protocol that allows users to connect to and remotely operate another computer or device via a network connection. Attackers<a id="_idIndexMarker597"/> employ automated software to try many login and password combinations in order to obtain unauthorized access to systems via RDP. Mitigating such risks involves proactive measures as well as quick action to block malicious IP addresses that try these assaults. In this section, we will utilize Wazuh active response to block the attacker’s IP address against an RDP brute-force attack. We will cover the following points:</p>
<ul>
<li>Requirement</li>
<li>Setting up a Windows agent with an active response script</li>
<li>Setting up the Wazuh server with a rule and active response script</li>
<li>Testing</li>
<li>Visualization</li>
</ul>
<h2 id="_idParaDest-158"><a id="_idTextAnchor157"/>Requirement</h2>
<p>In this use case, we will use the<a id="_idIndexMarker598"/> default Wazuh active response script of a Windows machine called <code>netsh.exe</code>, located at <code>C:\Program Files (x86)\ossec-agent\active-response\bin</code>. We don’t need to create any custom script for this. In order to make this entire use case work, we will use the following:</p>
<ul>
<li>Windows 10 or Windows Server</li>
<li>Kali Linux for testing</li>
</ul>
<h2 id="_idParaDest-159"><a id="_idTextAnchor158"/>Setting up a Windows agent with an active response script</h2>
<p>In this step, we need <a id="_idIndexMarker599"/>to add the <code>netsh</code> command and the <code>netsh</code> active response block to the Wazuh agent’s <code>C:\\Program Files (</code><code>x86)\\ossec-agent\\ossec.conf</code> file:</p>
<pre class="source-code">
&lt;command&gt;
    &lt;name&gt;netsh&lt;/name&gt;
    &lt;executable&gt;netsh.exe&lt;/executable&gt;
    &lt;timeout_allowed&gt;yes&lt;/timeout_allowed&gt;
  &lt;/command&gt;
&lt;active-response&gt;
    &lt;disabled&gt;no&lt;/disabled&gt;
    &lt;command&gt;netsh&lt;/command&gt;
    &lt;location&gt;local&lt;/location&gt;
    &lt;rules_id&gt;100100&lt;/rules_id&gt;
  &lt;/active-response&gt;</pre> <p>Here, we have the following:</p>
<ul>
<li><code>netsh.exe</code>: This is the network shell script located at <code>C:\Program </code><code>Files (x86)\ossec-agent\active-response\bin</code>.</li>
<li><code>&lt;rules_id&gt;</code>: This indicates that the active response <code>netsh</code> script will be executed when rule <code>100100</code> is triggered. We will be creating rule <code>100100</code> to detect RDP brute-force attacks on the Wazuh server in the next step.</li>
</ul>
<p>Save the <code>ossec.conf</code> file and<a id="_idIndexMarker600"/> restart the Wazuh agent.</p>
<div><div><img alt="Figure 5.14 – Restart the Wazuh agent on the Windows Server" src="img/B19549_5_14.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.14 – Restart the Wazuh agent on the Windows Server</p>
<h2 id="_idParaDest-160"><a id="_idTextAnchor159"/>Setting up Wazuh Server with a brute-force attack rule and active response script</h2>
<p>We want our <a id="_idIndexMarker601"/>Wazuh to execute the active response <code>netsh</code> script against a brute-force attack and hence, we will write a Wazuh rule to detect RDP login attempts with <code>level="10"</code>, <code>frequency="3"</code>, and <code>timeframe="120"</code>. This rule will be triggered when three failed login attempts are detected within 120 seconds of the timeframe. The following-mentioned rule block needs to be added to the <code>local_rules.xml</code> file located in the <code>/</code><code>var/ossec/etc</code> directory:</p>
<pre class="source-code">
&lt;group name="rdp"&gt;
  &lt;rule id="100100" level="10" frequency="3" timeframe="120"&gt;
    &lt;if_matched_sid&gt;60122&lt;/if_matched_sid&gt;
    &lt;description&gt;Possible RDP attack: 3 failed logins in a short period of time&lt;/description&gt;
  &lt;/rule&gt;
&lt;/group&gt;</pre> <p>Here, we have the following:</p>
<ul>
<li><code>&lt;if_matched_sid&gt;</code>: This option is similar to <code>&lt;if_sid&gt;</code> but it will only match if the rule ID has been triggered in a certain period of time. As we want Wazuh to detect the same alert three times within 120 seconds of the timeframe, this is specific to our needs.</li>
<li>Rule ID <code>60122</code> under <code>&lt;if_matched_sid&gt;</code>: This rule is used to track multiple Windows event IDs related to login failure. To learn more about this rule and its parent ruleset, visit this page: <a href="https://github.com/wazuh/wazuh-ruleset/blob/master/rules/0580-win-security_rules.xml">https://github.com/wazuh/wazuh-ruleset/blob/master/rules/0580-win-security_rules.xml</a>.</li>
</ul>
<p>Next, add the same <code>netsh</code> command and active response block to the Wazuh server:</p>
<pre class="console">
C:\\Program Files (x86)\\ossec-agent\\ossec.conf file
&lt;command&gt;
    &lt;name&gt;netsh&lt;/name&gt;
    &lt;executable&gt;netsh.exe&lt;/executable&gt;
    &lt;timeout_allowed&gt;yes&lt;/timeout_allowed&gt;
  &lt;/command&gt;
&lt;active-response&gt;
    &lt;disabled&gt;no&lt;/disabled&gt;
    &lt;command&gt;netsh&lt;/command&gt;
    &lt;location&gt;local&lt;/location&gt;
    &lt;rules_id&gt;100100&lt;/rules_id&gt;
  &lt;/active-response&gt;</pre> <p>Save the <code>ossec.conf</code> file and restart the Wazuh manager:</p>
<pre class="console">
systemctl restart wazuh-manager</pre> <h2 id="_idParaDest-161"><a id="_idTextAnchor160"/>Testing</h2>
<p>To emulate this <a id="_idIndexMarker602"/>attack, we will launch an RDP brute-force attack using the hydra tool. The Hydra tool comes pre-built with Kali Linux; however, if you want to install it manually on some other platform, you can download it using this link: <a href="https://github.com/vanhauser-thc/thc-hydra">https://github.com/vanhauser-thc/thc-hydra</a>. You can run the following command to execute an RDP brute-force attack on your Windows Server:</p>
<pre class="console">
hydra -l roger -P pass.txt 192.168.29.77 rdp</pre> <p>Here, we have the following:</p>
<ul>
<li><code>-l roger</code>: This parameter specifies the username <code>roger</code> that Hydra will use for the brute-force attack. Change <code>roger</code> to the username you want to target.</li>
<li><code>-P pass.txt</code>: Indicates the <code>pass.txt</code> password file, which contains a list of passwords. Hydra will repeatedly try each password for the chosen username by looping over this file. Put your password list’s actual filename and directory in place of <code>pass.txt</code>.</li>
<li><code>192.168.29.77</code>: Represents the IP address of the target system where the RDP service is running. Replace this with the actual IP address you want to target.</li>
<li><code>rdp</code>: Indicates which service protocol to target, which is RDP in this instance. Hydra will make an effort to access the RDP service by logging in using the password list<a id="_idIndexMarker603"/> and the supplied username.</li>
</ul>
<h2 id="_idParaDest-162"><a id="_idTextAnchor161"/>Visualizing the alerts</h2>
<p>You can view the alerts on the Wazuh<a id="_idIndexMarker604"/> dashboard. Go to the <code>100100</code>. As you can see in the following screenshot, rule <code>100100</code> has been triggered from our Windows Server with IP address <code>192.168.29.77</code>.</p>
<div><div><img alt="Figure 5.15 – Wazuh alert showing an RDP brute-force attack" src="img/B19549_5_15.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.15 – Wazuh alert showing an RDP brute-force attack</p>
<p>Immediately, the <a id="_idIndexMarker605"/>Wazuh active response <code>Netsh</code> script is activated on the Windows Server.</p>
<div><div><img alt="Figure 5.16 – Wazuh alert showing netsh active response" src="img/B19549_5_16.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.16 – Wazuh alert showing netsh active response</p>
<p>To test whether the <a id="_idIndexMarker606"/>attacker machine is blocked or not, you can try launching an RDP session using a Remote Desktop client; it should not work and should give an error, as shown.</p>
<div><div><img alt="Figure 5.17 – Remote Desktop connection failed" src="img/B19549_5_17.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.17 – Remote Desktop connection failed</p>
<p>With this, we have learned how to block RDP attack attempts using Wazuh’s active response feature.</p>
<h1 id="_idParaDest-163"><a id="_idTextAnchor162"/>Summary</h1>
<p>In this chapter, we learned about IR phases, Wazuh’s active response capability, and some important use cases. We learned how Wazuh’s active response module actively blocks unauthorized SSH and RDP access attempts. Additionally, we also learned about Wazuh’s capability to isolate infected Windows machines promptly upon detection of malware.</p>
<p>In the next chapter, we will learn how to conduct threat hunting using Wazuh modules. We will learn the importance of log data analysis in Wazuh for better threat investigation and hunting. We will also utilize the MITRE ATT&amp;CK framework to streamline our threat-hunting process.</p>
</div>
</body></html>