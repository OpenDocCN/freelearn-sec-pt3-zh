["```\nAz ad sp create-for-rbac --name MasteringAzSecSP\n```", "```\n    # Login to your Azure subscription\n    Login-AzAccount\n    ```", "```\n    # Define variable values\n    $rgName = \"myResourceGroup\"\n    $azRegion= \"WestEurope\"\n    $kvName = \"myAzKeyVault\"\n    $secretName = \"localAdmin\"\n    $localAdminUsername = \"myLocalAdmin\"\n    # Create a new resource group in your Azure suscription\n    $resourceGroup = New-AzResourceGroup `\n    -Name $rgName `\n    -Location $azRegion\n    ```", "```\n    VaultName defines the name of the Azure key vault. We are using the $kvName variable, which is defined at the beginning of the script.\n    ```", "```\n    # Grant your user account access rights to Azure Key Vault secrets\n    Set-AzKeyVaultAccessPolicy `\n    \t-VaultName $kvName `\n    \t-ResourceGroupName $rgName `\n    \t-UserPrincipalName (Get-AzContext).account.id `\n    \t-PermissionsToSecrets get, set\n    ```", "```\n    # Create a new Azure Key Vault secret\n    $password = read-host -assecurestring\n    Set-AzKeyVaultSecret ` \n    \t-VaultName $kvName `\n    \t-Name $secretName `\n    \t-SecretValue $password\n    ```", "```\n    # retrieve an Azure Key Vault secret\n    $secret = Get-AzKeyVaultSecret `\t-VaultName $kvName `\n    \t-Name $secretName\n    # Create a new PSCredential object\n    $cred = [PSCredential]::new($localAdminUsername,$secret.SecretValue)\n    ```", "```\n    $myVM = Set-AzVMOperatingSystem ` \n    \t-VM $myVM `\n    \t-Windows `\n    \t-ComputerName $vmName `\n    \t-Credential $cred `\n    \t[â€¦]\n    ```", "```\n# Azure Key Vault data source to access local admin password\ndata \"azurerm_key_vault_secret\" \"mySecret\" {\n\tname = \"secretName\"\n\tkey_vault_id = \"/subscriptions/GUID/resourceGroups/RGName/providers/Microsoft.KeyVault/vaults/VaultName\"\n}\n```", "```\nos_profile {\n\tcomputer_name = \"myVM\"\n\tadmin_username = \"myLocalAdminUserName\"\n\tadmin_password = \"$(data.azurerm_key_vault_secret.mySecret.value)\"\n}\n```", "```\n\"parameters\": {\n\t\"vaultName\": {\n\t\t\"type\": \"string\"\n\t},\n\t\"vaultResourceGroup\": {\n\t\t\"type\": \"string\"\n\t},\n\t\"secretName\": {\n\t\t\"type\": \"string\"\n\t}\n}\n```", "```\n\"parameters\": {\n\t\"vaultName\": {\n\t\t\"type\": \"string\",\n\t\t\"defaultValue\": \"<default-value-of-parameter>\"\n\t},\n\t\"vaultResourceGroup\": {\n\t\t\"type\": \"string\",\n\t\t\"defaultValue\": \"<default-value-of-parameter>\"\n\t},\n\t\"secretName\": {\n\t\t\"type\": \"string\",\n\t\t\"defaultValue\": \"<default-value-of-parameter>\"\n\t}\n}\n```", "```\n\"parameters\": {\n\t\"adminPassword\": {\n\t\t\"reference\": {\n\t\t\t\"keyVault\": {\n\t\t\t\t\"id\": \"[resourceId(subscription().subscriptionId,  parameters('VaultResourceGroup'), 'Microsoft.KeyVault/vaults', parameters('vaultName'))]\"\n\t\t\t},\n\t\t\t\"secretName\": \"[parameters('secretName')]\"\n\t\t}\n\t}\n}\n```", "```\n\"resources\": {\n\"parameters\": {\n\t\t\"adminUsername\": {\n\t\t\t\"type\": \"string\",\n\t\t\t\"defaultValue\": \"localAdminUsername\",\n\t\t\t\"metadata\": {\n\t\t\t\t\"description\": \"\"\n\t\t\t}\n\t\t},\n\t\t\"adminPassword\": {\n\t\t\t\"type\": \"securestring\"\n\t\t}\n}\n}\n```"]