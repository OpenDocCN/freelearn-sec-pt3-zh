<html><head></head><body>
		<div><h1 id="_idParaDest-105"><em class="italic"><a id="_idTextAnchor109"/>Chapter 5</em>: Cybersecurity Technologies and Tools</h1>
			<p><em class="italic">"Digital transformation offers an enormous opportunity to reduce costs and increase productivity, but if done without stepping up on defensive security, it could end up being a disaster." </em></p>
			<p><em class="italic">– Roberto Sasso – Founder and President, Club de Investigación Tecnológica</em></p>
			<p>There are thousands of tools available for cybersecurity and it will take you hundreds of years just to understand the basics of each of them, so to save your precious time, we will provide you with some insight into the <em class="italic">best</em> cybersecurity systems, methods, technologies, and tools for you to take advantage of.</p>
			<p>Also, we are going to review a <em class="italic">must-have</em> hardware device that will help you bring your awareness campaigns to the next level.</p>
			<p>Additionally, you will get a better understanding of what an <strong class="bold">Advanced Persistent Threat</strong> (<strong class="bold">APT</strong>) is and how to prevent them, but also how you can leverage threat intelligence to stay ahead of the criminals.</p>
			<p>Finally, you will understand the importance of critical thinking in cybersecurity and look at a real-life example of how a cybersecurity threat can become an IT solution.</p>
			<p>In this chapter, we are going to cover the following topics:</p>
			<ul>
				<li>Networking tools and technologies for cybersecurity</li>
				<li>Pentesting tools and methods</li>
				<li>Applying forensic tools and methods</li>
				<li>Dealing with APT</li>
				<li>Leveraging security threat intelligence</li>
				<li>Converting a threat into a solution</li>
			</ul>
			<h1 id="_idParaDest-106"><a id="_idTextAnchor110"/>Technical requirements </h1>
			<p>To get the most out of this chapter, you will need to install Kali Linux. This way, you can play around with the tools that we will overview. Kali Linux is very light, so you can install it on pretty much any old computer with internet access.</p>
			<p>Another option is to use a virtual machine, but in that case, you may need to tweak some settings (especially your network settings) to ensure that all the tools will behave as expected.</p>
			<p>All the images, including pre-built virtual images, for virtual machines can be found here: <a href="https://www.kali.org/downloads/">https://www.kali.org/downloads/</a>.</p>
			<p>We will also be reviewing the outstanding <strong class="bold">WiFi Pineapple</strong>, so having one of them will help you take the experience and knowledge of this chapter to the next level.</p>
			<p>For more information about this must-have pentesting tool, go to <a href="https://shop.hak5.org/products/wifi-pineapple">https://shop.hak5.org/products/wifi-pineapple</a>.</p>
			<h1 id="_idParaDest-107"><a id="_idTextAnchor111"/>Advanced wireless tools for cybersecurity</h1>
			<p>As masters in <a id="_idIndexMarker560"/>defensive security, we need to know about and understand how the latest tools work. It does not matter if they were<a id="_idIndexMarker561"/> developed as offensive tools; you need to learn how to take advantage of them. Let's start by taking a look at some of the latest and coolest wireless tools.</p>
			<h2 id="_idParaDest-108"><a id="_idTextAnchor112"/>Defending from wireless attacks</h2>
			<p>Wireless networks<a id="_idIndexMarker562"/> are by far the most used connection types, making them a big target for cybercriminals. Therefore, you need to be ahead of them and make sure that wireless security is a fundamental part of your cybersecurity strategy.</p>
			<p>There is an entire section in <a href="B16290_08_Final_JC_ePub.xhtml#_idTextAnchor193"><em class="italic">Chapter 8</em></a>, <em class="italic">Enhancing Your Network Defensive Skills</em>, dedicated to network tools. However, here, we will take a look at some of the most important tools that are used in wireless attacks so that you can be ahead of the attackers and plan your defensive strategy accordingly.</p>
			<h3>The almighty WiFi Pineapple</h3>
			<p>This is a must-have tool for auditing Wi-Fi networks. Created by <em class="italic">Hak5</em> back in 2008, this is probably the most<a id="_idIndexMarker563"/> recognized hardware pentesting tool in the world – maybe because of the power of this small box, its ease of use, or the huge variety of tools that it contains on a single device.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">The geniuses at Hak5 put tremendous effort into keeping this tool up to date with the latest Wi-Fi auditing tools (for example, the MarkV received 22 firmware updates). However, there is a point where the hardware needs to be upgraded to include new tools (and improve the existing ones in terms of speed, range, and so on). Therefore, and considering the wide range of WiFi Pineapple versions, we decided to make this section as generic as possible to try to generally cover the tools available in most of the WiFi Pineapple versions.</p>
			<p>Now, let's explore some of the features of this fantastic tool.</p>
			<h4>Rogue access point</h4>
			<p>Have you ever noticed that your smartphone automatically connects to the wireless of your preferred café after you connect to it for the first time?</p>
			<p>Well, that feature<a id="_idIndexMarker564"/> was created to improve the user experience, but it also represents a serious security vulnerability.</p>
			<p>To exploit this vulnerability, the attacker needs to <em class="italic">mimic</em> one of those <em class="italic">trusted</em> Wi-Fi <strong class="bold">access points </strong>(<strong class="bold">AP</strong>) so that the victim device will automatically connect to it. But the question is, how does the attacker know the name of the trusted networks on the victim's device? Well, here is where the clever attack starts.</p>
			<p>First, let's take a look at the theory and concepts behind this attack.</p>
			<p>When your device (laptop, smartphone, and so on) has Wi-Fi turned <em class="italic">on</em> and it is not connected to any network, it will broadcast <strong class="bold">Probe Request Frames</strong> (<strong class="bold">PRFs</strong>), which contain the list of SSIDs that<a id="_idIndexMarker565"/> your device trusts. Those frames are captured by AP that review them and see whether their SSID is on the list; if so, it will start the connection process:</p>
			<div><div><img src="img/Figure_5_1_B16290.jpg" alt="Figure 5.1 – Probe request/response structure&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.1 – Probe request/response structure</p>
			<p>The magic (or evil) of this device is that it takes advantage of the fact that <em class="italic">probe requests are not encrypted</em>, captures them, and reads the list of trusted and open SSIDs.</p>
			<p>Then the device<a id="_idIndexMarker566"/> automatically creates an open AP (with no password) and uses the name of one of the trusted and open SSIDs. At this point, the victim's device will connect immediately to it.</p>
			<p>Now that the victim's device is connected to the <strong class="bold">rogue access point</strong>, the attacker can execute<a id="_idIndexMarker567"/> a plurality of attacks, including the famous <strong class="bold">man-in-the-middle attack</strong>, which will be discussed in<a id="_idIndexMarker568"/> detail in <a href="B16290_08_Final_JC_ePub.xhtml#_idTextAnchor193"><em class="italic">Chapter 8</em></a>, <em class="italic">Enhancing Your Network Defensive Skills</em>.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Remember that the better you know the tools that will be used against you, the better you can prepare to reduce the <strong class="bold">probability</strong> and <strong class="bold">impact</strong> of those attacks.</p>
			<p>Let's stop for a second to think about the danger of this attack and analyze how you can leverage this for your <em class="italic">defensive security strategy</em>.</p>
			<p>You can reduce the probability of this risk by updating two policies: the BYOD policy and the network policy. In this case, just make sure to include the following:</p>
			<p><em class="italic">Wi-Fi must be off while traveling and just enable it on secure locations (office, home, secure hotel connections, and so on)</em>.</p>
			<p>As we saw in <a href="B16290_04_Final_JC_ePub.xhtml#_idTextAnchor092"><em class="italic">Chapter 4</em></a>, <em class="italic">Patching Layer 8</em>, training is one of the most basic and effective tools in defensive security, and you can leverage great tools such as the <strong class="bold">WiFi Pineapple</strong> to make your training more engaging, but also to raise awareness about the potential impact of this attack.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">You can raise awareness by performing yearly security campaigns, such as a <strong class="bold">cybersecurity week</strong>. Here, you can leverage this cool gadget to demonstrate that those attack vectors are real, easy to perform, and have devastating effects on your personal and professional data, systems, and devices.</p>
			<p>Additionally, keep<a id="_idIndexMarker569"/> in mind that most users think that this type of attack will not happen to them (because they look too sophisticated), but when they see how easy it is to carry out the attack, they will be more receptive to adapting any policy or strategy that you put in place to prevent this type of attack, transforming your users from encountering a cybersecurity threat into defensive security agents.</p>
			<h4>Recognizing an unauthorized AP in your infrastructure</h4>
			<p>The WiFi Pineapple<a id="_idIndexMarker570"/> has a very cool module called <strong class="bold">Recon</strong>. This is a very clean interface that <em class="italic">allows you to see the invisible</em>. This is because<a id="_idIndexMarker571"/> it will show you information about<a id="_idIndexMarker572"/> what is happing with the Wi-Fi (AP and devices) in your infrastructure.</p>
			<p>Let's explore the valuable information that you can gather here:</p>
			<ul>
				<li>Information about the SSID (broadcasted or hidden).</li>
				<li>MAC address of the AP.</li>
				<li>Security type (WPA, WPE, mixed, and so on).</li>
				<li>Information about whether WPS is enabled.</li>
				<li>Wi-Fi channel used by the AP.</li>
				<li>Signal strength.</li>
				<li>Clients connected to each AP.</li>
				<li>Client information, including the MAC address and name of the manufacturer (<em class="italic">gathered by analyzing the first three octets of the MAC address dynamically</em>).</li>
				<li>You can also discover clients that are not associated with any AP (including IoT devices, speakers, cameras, and so on).</li>
			</ul>
			<p>Now, you can leverage<a id="_idIndexMarker573"/> all this data to perform the following<a id="_idIndexMarker574"/> defensive actions:</p>
			<ul>
				<li>Detect unauthorized APs.</li>
				<li>Detect rogue APs (obfuscated by a hidden SSID).</li>
				<li>Detect violations to network policies related to the security required for APs.</li>
				<li>Detect vulnerable APs (a weak security type or WPS enabled).</li>
				<li>Detect performance issues or interference from other systems due to saturation or utilization of a given Wi-Fi channel.</li>
				<li>Determine vulnerabilities due to devices connected to an AP they should not connect to or an AP with unauthorized devices connected.</li>
				<li>Detect potential attacks performed by another WiFi Pineapple.</li>
				<li>Detect unauthorized devices in your infrastructure.<p class="callout-heading">Tip</p><p class="callout">As seen in this section, you can leverage this device to create your very own low-cost Wi-Fi monitoring tool, customize it based on your needs, and deploy it in no time.</p></li>
			</ul>
			<p>Additionally, there are some actions you can perform over those APs points, including the following:</p>
			<ul>
				<li><strong class="bold">Add SSID to PineAP Pool</strong>: This will make the WiFi Pineapple start mimicking the selected SSID. As we mentioned previously, this is a great tool that you can leverage during an event to <em class="italic">raise awareness</em> about how easy an attacker can perform this attack, and therefore the need to follow the policies, methods, systems, and tools to prevent it.</li>
				<li><strong class="bold">Add SSID or clients to filter</strong>: This is very useful when performing a <em class="italic">pentest</em> or <em class="italic">audit</em> to ensure that just a group of selected devices or APs can connect to your WiFi Pineapple.</li>
				<li><code>802.11</code> protocol. It will do so by pretending to be the AP and sending a command to the connected devices to immediately disconnect from the AP.<p>This could be useful in a situation where you need all the devices to immediately disconnect from a given AP. In this case, instead of looking for each device owner and requesting them to disconnect, you can do this very easily with a single click of your mouse, reducing the time of being exposed to a possible threat.</p></li>
				<li><strong class="bold">Capture a WPA handshake</strong>: This is another great tool that can help raise awareness during a cybersecurity workshop to show how attacks are performed by attackers.<p class="callout-heading">Tip</p><p class="callout">People don't trust what they don't see, and this applies perfectly to security. A lot of people don't care much about attacks that they never see because they look distant, irrelevant, or impossible. Therefore, presenting them with how attacks are carried and how easy it is to perform them is the best way to raise awareness, as well as improving the level of cybersecurity, within the entire organization.</p><p>Another cool<a id="_idIndexMarker575"/> thing about the WiFi Pineapple modules is that their GUI is configurable<a id="_idIndexMarker576"/> and responsive, so you can use the GUI and manage your Wi-Fi monitoring tool on the go using your smartphone!</p></li>
				<li><strong class="bold">Bonus</strong>: The WiFi Pineapple Mark VII has a very cool feature that allows us to visualize the data using a 3D map where you can visually see the AP and the connected devices in a very cool way:</li>
			</ul>
			<div><div><img src="img/Figure_5_2_B16290.jpg" alt="Figure 5.2 – 3D map visualization of the WiFi Pineapple Mark VII&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.2 – 3D map visualization of the WiFi Pineapple Mark VII</p>
			<p>This is a feature<a id="_idIndexMarker577"/> of version <code>1.0.0</code> and is considered experimental, but some extra options and features<a id="_idIndexMarker578"/> are expected in its upcoming releases, so stay tuned!</p>
			<h4>Other Pineapple auditing and testing tools</h4>
			<p>Do you want to test how<a id="_idIndexMarker579"/> vulnerable your users are to a Wi-Fi attack? Or maybe<a id="_idIndexMarker580"/> you want to test whether your users understood your beautiful cybersecurity training?</p>
			<p>In any case, you can leverage <strong class="bold">PineAP</strong> to create a fake SSID with a catchy name such as <em class="italic">Free Wi-Fi, Free Game,</em> and so on<a id="_idIndexMarker581"/> and see which devices fall into the trap and connect to them.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Besides being a great tool for companies and corporations, this can also be leveraged by consultants to demonstrate a user's vulnerabilities and open the door to a plurality of cybersecurity services (training, developing a defensive security strategy, and so on).</p>
			<p>Are you also a developer? If so, we<a id="_idIndexMarker582"/> should look at how<a id="_idIndexMarker583"/> to improve WiFi Pineapple with new features.</p>
			<h4>Expanding the device's capabilities</h4>
			<p>There is a lot that you can do with<a id="_idIndexMarker584"/> this hardware, so the creators of the WiFi Pineapple decided to open their device for community collaboration so that you, as a user, can leverage those modules and add them to your device with a couple of clicks:</p>
			<div><div><img src="img/Figure_5_3_B16290.jpg" alt="Figure 5.3 – Adding community modules to the WiFi Pineapple Mark VII&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.3 – Adding community modules to the WiFi Pineapple Mark VII</p>
			<p>If you are a developer, I recommend<a id="_idIndexMarker585"/> that you visit this link as you can get a lot of perks by developing modules for the WiFi Pineapple: <a href="https://shop.hak5.org/pages/developer-program">https://shop.hak5.org/pages/developer-program</a>.</p>
			<p>Now that you know about these great Wi-Fi tools (hardware and software), it is time to move on and look at another exciting topic: <strong class="bold">pentesting</strong>.</p>
			<h1 id="_idParaDest-109"><a id="_idTextAnchor113"/>Pentesting tools and methods</h1>
			<p>There is a common misconception that <em class="italic">pentesting = networking testing</em>, and that is a huge mistake.</p>
			<p>As a master in defensive<a id="_idIndexMarker586"/> security, you need to drive your defensive strategy in an integral way by including all the actors, factors, and actions that may impact your infrastructure.</p>
			<p>Therefore, in this section, we will be exploring all the different tools and methods that you need to leverage to <em class="italic">create the most comprehensive and powerful cybersecurity strategy possible</em>.</p>
			<h2 id="_idParaDest-110"><a id="_idTextAnchor114"/>Metasploit framework</h2>
			<p>Metasploit is<a id="_idIndexMarker587"/> considered an <strong class="bold">exploitation framework</strong>, which means that it's a powerful pack of tools<a id="_idIndexMarker588"/> and utilities that you can leverage to test<a id="_idIndexMarker589"/> your infrastructure.</p>
			<p>It includes a variety of tools that can be used for the following purposes:</p>
			<ul>
				<li>Information gathering (passive and active)</li>
				<li>Vulnerability scanning</li>
				<li>Exploitation</li>
				<li>Post-exploitation</li>
				<li>And many other additional modules including some to help the attacker to cover its tracks</li>
			</ul>
			<p>The intent of this book is not to focus on the offensive part, but it will be valuable for you to know <a id="_idIndexMarker590"/>the basics about this tool. Due to this, we will be covering this in depth in <a href="B16290_15_Final_JC_ePub.xhtml#_idTextAnchor350"><em class="italic">Chapter 15</em></a>, <em class="italic">Leveraging Pentesting for Defensive Security</em>.</p>
			<h2 id="_idParaDest-111"><a id="_idTextAnchor115"/>Social engineering toolkit</h2>
			<p>This is a<a id="_idIndexMarker591"/> very powerful toolkit that's used mostly by attackers; however, you can also take advantage of this tool to develop the following:</p>
			<ul>
				<li>Awareness campaigns.</li>
				<li>Improved training.</li>
				<li>Realistic labs.</li>
				<li>Assess the susceptibility of the users to a given attack.<p class="callout-heading">Tip</p><p class="callout">As we mentioned previously, showing the susceptibility of the employees of a given attack (for example, demonstrating that 60% of the employees put their credentials on a fake page) is a great way to get support and a budget from upper management.</p></li>
			</ul>
			<p>As shown in the following screenshot, the <strong class="bold">Social Engineering Toolkit</strong> (<strong class="bold">SET</strong>) is an all-in-one toolkit<a id="_idIndexMarker592"/> that contains all the utilities that you need to create realistic and engaging awareness campaigns:</p>
			<div><div><img src="img/Figure_5_4_B16290.jpg" alt="Figure 5.4 – The main menu of the Social Engineering Toolkit (SET) &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.4 – The main menu of the Social Engineering Toolkit (SET) </p>
			<p>Now, let's take a <a id="_idIndexMarker593"/>look at the most important aspects of those tools:</p>
			<ul>
				<li><strong class="bold">Spearphishing attack vectors</strong>: This is a great tool that you can leverage to test<a id="_idIndexMarker594"/> whether your employees are susceptible to <strong class="bold">phishing attacks</strong>. Here, you can craft the message<a id="_idIndexMarker595"/> so that it's as realistic as possible. Additionally, the tool<a id="_idIndexMarker596"/> lets you include a payload if needed.<p>If you want to take this test to the next level, you can even spoof email addresses to challenge more technical teams.</p><p>As shown in the following<a id="_idIndexMarker597"/> screenshot, the tool gives you the option to create an automated attack. You can even customize<a id="_idIndexMarker598"/> it based on a variety of options:</p></li>
			</ul>
			<div><div><img src="img/Figure_5_5_B16290.jpg" alt="Figure 5.5 – SET Spearphishing module&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.5 – SET Spearphishing module</p>
			<ul>
				<li><strong class="bold">Web attacks</strong>: Here, you have a variety of options to play with. The most common is <strong class="bold">website cloning</strong>, in which the system clones a frequently<a id="_idIndexMarker599"/> visited website (such as a social media site). Then, when the user accesses the site, it will be sent<a id="_idIndexMarker600"/> to a fake site where you have full control to inject malicious code and harvest user credentials.<p>Harvesting <a id="_idIndexMarker601"/>credentials<a id="_idIndexMarker602"/> is a very dangerous task – in fact, the recommendation is not to save the user credentials. Instead, once the user inputs the credentials, the button will just display a message, stating that this was a cybersecurity test and that their credentials could be compromised by others using this method by not capturing those credentials.</p><p class="callout-heading">Tip</p><p class="callout"><em class="italic">Never</em> harvest credentials without proper written authorization from the legal department. This is because you need proof that the company are aware of the activity that you are performing (especially if you are a third party hired to perform this test), but also because legal teams need to be involved to ensure alignment with regulations or laws.</p><p>Additionally, instead<a id="_idIndexMarker603"/> of injecting malicious code, you can just create some harmless HTML that tells the user that this<a id="_idIndexMarker604"/> was a security test, but that next time, it could be a real attack. This technique will help you increase awareness between users.</p><p>As shown in the following<a id="_idIndexMarker605"/> screenshot, you can also leverage<a id="_idIndexMarker606"/> additional attack mechanisms, such as <strong class="bold">HTML Attacks</strong> (<strong class="bold">HTAs</strong>), web jacking attacks, and more:</p></li>
			</ul>
			<div><div><img src="img/Figure_5_6_B16290.jpg" alt="Figure 5.6 – SET web attack module&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.6 – SET web attack module</p>
			<ul>
				<li><code>autorun.inf</code> file that will be automatically<a id="_idIndexMarker608"/> executed when the device (USB, DVD, CD) is inserted.<p>Here, you can get a cheap USB and load it with this utility to determine how vulnerable employees are to falling into this trap.</p><p>Since this<a id="_idIndexMarker609"/> attack requires<a id="_idIndexMarker610"/> investing in the necessary hardware, it is recommended to do this on a targeted population, such<a id="_idIndexMarker611"/> as company executives, to determine their likelihood to insert an unknown USB device:</p></li>
			</ul>
			<div><div><img src="img/Figure_5_7_B16290.jpg" alt="Figure 5.7 – Payloads available on the infectious media generator (SET)&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.7 – Payloads available on the infectious media generator (SET)</p>
			<ul>
				<li><strong class="bold">QR code attacks</strong>: This is a very interesting attack vector. With this tool, an attacker can<a id="_idIndexMarker612"/> use QR codes<a id="_idIndexMarker613"/> to redirect users to infected sites. Therefore, attackers can post adverts with a QR code<a id="_idIndexMarker614"/> near the targeted office to infect some devices.<p>For example, you could place some fake adverts that provide your QR code. This code redirects the user to your HTML. That HTML will then inform the user that this is an attack technique but that this time, it was safe. At this point, you could provide a link that contains additional training material about this topic.</p></li>
			</ul>
			<p>Now let's<a id="_idIndexMarker615"/> take a look at exe2hex.</p>
			<h2 id="_idParaDest-112"><a id="_idTextAnchor116"/>exe2hex</h2>
			<p>This is a very<a id="_idIndexMarker616"/> interesting<a id="_idIndexMarker617"/> tool that helps encode binary files into ASCII text format to make the transfer process to the target machine easier. It helps the attacker bypass many of your security controls.</p>
			<p>Then, the attacker will<a id="_idIndexMarker618"/> leverage two built-in tools in Windows (<strong class="bold">debug.exe</strong> and <strong class="bold">PowerShell</strong>) to transform the text into an executable<a id="_idIndexMarker619"/> file and perform the attack.</p>
			<p>The ability to bypass most of your security controls and place a malicious file in the target computer is very scary. However, the good news is that there is an easy way to prevent this attack vector.</p>
			<p>As we mentioned previously, this attack leverages two built-in tools to complete its execution. debug.exe is not included on current Windows systems, so unless you have an unsupported version of Windows, then you don't have to worry about this (and if you do have an unsupported version of Windows on your computer, then this will be another reason to migrate that machine as soon as possible).</p>
			<p>The other one is PowerShell, which, as you may know, can be exploited by a variety of attacks. So, here, the recommendation is to disable PowerShell on your Windows systems.</p>
			<p>If you have a big<a id="_idIndexMarker620"/> infrastructure, you can even do this as a <strong class="bold">Group Policy Object</strong> (<strong class="bold">GPO</strong>) on <strong class="bold">Active Directory</strong>. Additionally, you can even create a GPO to enable access to PowerShell<a id="_idIndexMarker621"/> to a group of super admins (if needed).</p>
			<p>There are many more pentesting tools available on the market, but since pentesting is handled by offensive security specialists, our goal was just to provide a quick review so that you are familiar with them. Now, it's time to talk about our next exciting topic, which is forensics.</p>
			<h1 id="_idParaDest-113"><a id="_idTextAnchor117"/>Applying forensics tools and methods</h1>
			<p>There will be cases where you will be required by management or the HR department to gather some data<a id="_idIndexMarker622"/> from a given computer as evidence because a procedure, policy, law, or regulation<a id="_idIndexMarker623"/> has been violated.</p>
			<p>Therefore, you need to have a variety of tools at hand that allow you to do this task in the most integral way, first to preserve your neutrality, but also because you may be dealing with evidence that may end up in court. So, let's start by understanding the best practices about how to manage evidence.</p>
			<h2 id="_idParaDest-114"><a id="_idTextAnchor118"/>Dealing with evidence</h2>
			<p>When dealing<a id="_idIndexMarker624"/> with digital evidence, data integrity is key to demonstrating that the evidence has not been altered in any way.</p>
			<p>The best way to achieve this is by using hashes because even the most minimal change will make the hash change. However, if the hash remains the same, then you will be 100% certain that the file hasn't been altered.</p>
			<p>As shown in the following screenshot, just making the first letter a capital letter completely changes the hash:</p>
			<div><div><img src="img/Figure_5_8_B16290.jpg" alt="Figure 5.8 – Hashes of a .txt file&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.8 – Hashes of a .txt file</p>
			<p>If you need to hash several files or folders, you can ZIP them or add them <a id="_idIndexMarker625"/>to an ISO image and then apply the hash to that image file.</p>
			<p>If you want to play around<a id="_idIndexMarker626"/> with hashes, you can download <strong class="bold">HashCalc</strong>, a great, lightweight tool that allows you to create hashes using several hashing algorithms.</p>
			<h2 id="_idParaDest-115"><a id="_idTextAnchor119"/>Forensic tools</h2>
			<p>Let's take a look at the most common tools that you can use to perform forensic-related tasks.</p>
			<h3>Kali Linux Forensics Mode</h3>
			<p>If you need<a id="_idIndexMarker627"/> to gather data from a computer, using <strong class="bold">Kali Linux Forensics Mode</strong> is a great way to do so.</p>
			<p>This is a live, bootable version<a id="_idIndexMarker628"/> of Kali preloaded with all the necessary forensics tools, enabling you to gather information without the need to install anything on the hard drive, keeping the hard drive untouched while you perform your forensics tasks.</p>
			<p>As shown in the following<a id="_idIndexMarker629"/> screenshot, this live version is available<a id="_idIndexMarker630"/> in all Kali Linux distributions:</p>
			<div><div><img src="img/Figure_5_9_B16290.jpg" alt="Figure 5.9 – Booting Kali Linux Forensics Mode&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.9 – Booting Kali Linux Forensics Mode</p>
			<p>Now, let's take a look at Autopsy.</p>
			<h3>Autopsy</h3>
			<p>This is a must-have forensics platform.</p>
			<p>Included in Kali Linux, but also available<a id="_idIndexMarker631"/> on Windows, this platform is packed with<a id="_idIndexMarker632"/> all the tools that you may need during an investigation.</p>
			<p>There is a lot of useful information that you can gather with this tool; here are some examples:</p>
			<ul>
				<li>Operating system of the source machine</li>
				<li>Operating system installation data</li>
				<li>Registered owner of the operating system</li>
				<li>Computer name</li>
				<li>Uptime</li>
				<li>Number of user accounts</li>
				<li>Last login data</li>
				<li>List of network cards</li>
				<li>IP and MAC addresses of the machine</li>
				<li>Traces of hacking software being installed</li>
				<li>Email client</li>
				<li>Email address (web)</li>
				<li>SMTP accounts</li>
				<li>Deleted files</li>
				<li>Traces of known viruses</li>
				<li>Website history, bookmarks, and cookies</li>
				<li>EXIF data from images</li>
				<li>Geolocation/geotagging of files</li>
			</ul>
			<p>As shown in <em class="italic">Figure 5.9</em>, the GUI for Autopsy<a id="_idIndexMarker633"/> on Windows<a id="_idIndexMarker634"/> is very clean and intuitive:</p>
			<div><div><img src="img/Figure_5_10_B16290.jpg" alt="Figure 5.10 – Autopsy Windows interface&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.10 – Autopsy Windows interface</p>
			<p>Now, let's ta<a id="_idIndexMarker635"/>ke <a id="_idIndexMarker636"/>a look at Binwalk.</p>
			<h3>Binwalk</h3>
			<p>This tool is great<a id="_idIndexMarker637"/> for looking for embedded files or code inside a firmware image.</p>
			<p>This is especially<a id="_idIndexMarker638"/> useful if you need to look for the signature of tiles, compressed files, firmware headers, Linux kernels, bootloaders, and so on.</p>
			<p>As shown in the following screenshot, there are lots of options that are available for customizing the scan, making this a very versatile tool:</p>
			<div><div><img src="img/Figure_5_11_B16290.jpg" alt="Figure 5.11 – Binwalk options&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.11 – Binwalk options</p>
			<p>Now, let's<a id="_idIndexMarker639"/> take a look at<a id="_idIndexMarker640"/> bulk-extractor.</p>
			<h3>bulk-extractor</h3>
			<p>This is an interesting<a id="_idIndexMarker641"/> tool that's included in the Kali Linux suite that extracts<a id="_idIndexMarker642"/> a variety of information from files, including the following:</p>
			<ul>
				<li>Credit card information</li>
				<li>URLs</li>
				<li>Email addresses</li>
			</ul>
			<p>This is very useful if you need to scan files (or even an entire computer) to look for sensitive information and detect or prevent possible data leakages.</p>
			<p>Another cool feature is that this<a id="_idIndexMarker643"/> tool allows you to create a list of common words based<a id="_idIndexMarker644"/> on the data that's been scanned, which can then be converted into the input for a dictionary attack.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">If you have a password checking engine, then you can use this wordlist as a custom dictionary input to prevent users from selecting related passwords and thus eliminating this vulnerability.</p>
			<p>The tool can also present information as histograms so that you can easily identify common email addresses, domains, and much more.</p>
			<h2 id="_idParaDest-116"><a id="_idTextAnchor120"/>Recovering deleted files</h2>
			<p>We all know what it feels<a id="_idIndexMarker645"/> like when an important file is deleted by mistake. And there is no doubt that a lot of times, people will come to you for help, so if you want to be someone's hero, then you better have this tool handy.</p>
			<p>On Kali Linux, you can use <strong class="bold">Foremost</strong> to review deleted files based on their headers, footers, and internal<a id="_idIndexMarker646"/> data structures.</p>
			<p>As shown in the following screenshot, the tool has a lot of parameters that you can use to improve the recovery process:</p>
			<div><div><img src="img/Figure_5_12_B16290.jpg" alt="Figure 5.12 – Foremost commands&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.12 – Foremost commands</p>
			<p>This tool was supposed to be installed by default on Kali Linux. However, if you cannot find it, just use the following command to install it:</p>
			<pre>sudo apt-get install foremost</pre>
			<p>If you have Windows, you can use the famous <strong class="bold">Recuva</strong>. This tool (which has a basic free version) works great<a id="_idIndexMarker647"/> when it comes to recovering recently deleted files.</p>
			<p>The reason<a id="_idIndexMarker648"/> for this is when you delete a document in Windows, you are just deleting its pointer, but the data is still on the hard drive. So, what this type of software does is search for files on the hard drive and then recreate the Windows index table to make the file reappear on the operating system. However, to make computers faster, the data is written in the first available spot of the hard drive. So, the more you use the computer, the higher the risk that the data you want to recover gets overwritten by another file.</p>
			<p>Now, let's learn about probably the most complex attack vector: <strong class="bold">APTs</strong>.</p>
			<h1 id="_idParaDest-117"><a id="_idTextAnchor121"/>Dealing with APTs</h1>
			<p>The tactics covered in this book aim to defend your infrastructure against the most common<a id="_idIndexMarker649"/> types of attacks and threat vectors. However, there is one type of threat that we have not covered yet – a type of attack that, due to the complexity involved, is believed to be backed by the government and various<a id="_idIndexMarker650"/> organizations. This attack is called APTs.</p>
			<p>In this type of attack, the attackers use a variety of tactics, techniques, and resources to gain sustained access over an extended period of time to disrupt or spy on a given set of systems to achieve a given goal, such as the following examples:</p>
			<ul>
				<li>Steal intellectual property or trade secrets.</li>
				<li>Obtain a continuous flow of sensitive information.</li>
				<li>Sabotage a given infrastructure, system, or process.</li>
				<li>Reroute funds.</li>
			</ul>
			<p>As we mentioned<a id="_idIndexMarker651"/> previously, these are very organized attacks, normally performed by a coordinated group in which the main goal is not to gain access, but to remain undetected, which means that some actions will be slowly performed over time to avoid some triggers that will review their presence.</p>
			<p>To achieve this, the attackers normally follow five phases:</p>
			<ul>
				<li><strong class="bold">Discovery</strong>: Here, the attackers<a id="_idIndexMarker652"/> will gather as much information as possible from the victim and employees, providers, partners, and so on.<p>This phase normally includes a combination of technical research activities (performed with recognition tools) and physical research activities such as dumpster diving, physical location recognition, social engineering, and so on.</p></li>
				<li><strong class="bold">Infiltration</strong>: This stage is about gaining access to the systems and infrastructure. As we mentioned<a id="_idIndexMarker653"/> previously, in this type of attacks, the attacker will use customized attacks to prevent detection (script kiddies are not allowed here). The use of zero-day exploits is very common here.</li>
				<li><strong class="bold">Expansion</strong>: Here, the attacker is trying<a id="_idIndexMarker654"/> to gain access to additional systems (lateral movement) or escalate privileges over the current systems.<p>At this point, the attacker will leave some backdoors to ensure future access in case they get caught.</p></li>
				<li><strong class="bold">Extraction</strong>: Once the attacker has navigated through the infrastructure and the target information<a id="_idIndexMarker655"/> has been identified, the next step is to start extracting data.<p>Here, the attacker will use advanced methods (such as DNS tunneling) to exfiltrate the desired information.</p></li>
				<li><strong class="bold">Diversion</strong>: We have seen cases in which very complex and coordinated attacks will use another attack<a id="_idIndexMarker656"/> vector (such as a DDOS) to mask the real attacks and deviate resources to deal with that attack while leaving the real attack undetected.<p class="callout-heading">Script Kiddies</p><p class="callout">This is the name given<a id="_idIndexMarker657"/> to attackers with limited knowledge about cybersecurity and whose only skill is to run scripts (even without understanding what the script is <a id="_idIndexMarker658"/>doing, and sometimes even leaving their devices infected).</p></li>
			</ul>
			<p>Now, let's learn how to defend our infrastructure against these types of threats.</p>
			<h2 id="_idParaDest-118"><a id="_idTextAnchor122"/>Defensive techniques</h2>
			<p>Being able<a id="_idIndexMarker659"/> to apply <em class="italic">all the defensive techniques that we have been learning about</em> will reduce the possibility<a id="_idIndexMarker660"/> of an ATP occurring. However, let's take a look at some specific techniques that you can apply to prevent ATPs:</p>
			<ul>
				<li>Monitor traffic (in and out) to detect leads of infiltration or exfiltration.</li>
				<li>Increase the application of multi-factor authentication.</li>
				<li>Analyze logs to detect patterns of compromise.</li>
				<li>Keep a good identity and access management strategy and ensure that unused or disabled users are deleted.</li>
				<li>Set monitors on logs to detect tampering attempts (in this type of attack, logs can be deleted to prevent tracking).</li>
				<li>Use Honeypots to detect and confuse attackers (we will show you how to create your own Honeypot on <a href="B16290_10_Final_JC_ePub.xhtml#_idTextAnchor231"><em class="italic">Chapter 10</em></a><em class="italic">, Applying IoT Security</em>).</li>
			</ul>
			<p>The good news is that we also have advanced systems and tools that can be used against criminals, and one of them is <strong class="bold">threat intelligence</strong>. We will look at this next.</p>
			<h1 id="_idParaDest-119"><a id="_idTextAnchor123"/>Leveraging security threat intelligence </h1>
			<p>A simple Google search<a id="_idIndexMarker661"/> will tell you that there are too many different definitions of threat intelligence, so to make things easier, let's define it as <em class="italic">gathering, analyzing, and understanding threats, threat actors, and the associated behaviors of the attacks</em>.</p>
			<p>Simply put, threat intelligence is about creating knowledge (intelligence) based on correlated data.</p>
			<p>Several solutions are available, most of which are offered <em class="italic">as a service</em>, in which a third-party vendor provides you with access to that knowledge for a monthly fee.</p>
			<p>Now, let's move on to the next section to understand what <strong class="bold">threat intelligence</strong> is.</p>
			<h2 id="_idParaDest-120"><a id="_idTextAnchor124"/>Threat intelligence 101</h2>
			<p>Attackers are known for sharing<a id="_idIndexMarker662"/> data about their attacks with others, spreading the danger of you becoming a victim.</p>
			<p>But with threat intelligence, we can achieve even better results because it is about sharing data related to attacks and performing a smart analysis of that data. This helps create knowledge that can be used by others to defend against those kinds of attacks.</p>
			<p>Companies are now leveraging cognitive technologies to analyze data and create insights. However, those cognitive systems are only as good as the training they have received, so when looking for a threat intelligence solution, the research capabilities and the expertise of the company in the field should be two of the most important factors you consider.</p>
			<p>Regarding data feeds, which also vary between vendors, some use private datasets, while others promote sharing data with open communities to create a bigger pool of data to improve how their systems are ingested.</p>
			<p>The following diagram shows an example<a id="_idIndexMarker663"/> of some of the data inputs that are used by threat intelligence systems:</p>
			<div><div><img src="img/Figure_5_13_B16290.jpg" alt="Figure 5.13 – Threat intelligence inputs&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 5.13 – Threat intelligence inputs</p>
			<h2 id="_idParaDest-121"><a id="_idTextAnchor125"/>Implementing threat intelligence</h2>
			<p>Threat intelligence outputs<a id="_idIndexMarker664"/> are normally used as input to improve several cybersecurity systems and processes. Some examples are as follows:</p>
			<ul>
				<li><strong class="bold">Improving cybersecurity systems</strong>: Some tools, such as IPS, IDS, and firewalls, have the option to ingest<a id="_idIndexMarker665"/> threat intelligence data to improve how threats are detected.</li>
				<li><strong class="bold">Incident response</strong>: Threat intelligence is a great tool for incident response teams as it allows them to reduce false<a id="_idIndexMarker666"/> positives, enhance their skills, improve their analysis process, and reduce response times.</li>
				<li><strong class="bold">Security Operations Centers</strong> (<strong class="bold">SOCs</strong>): By bringing this new knowledge to the team, a SOC can greatly improve all the necessary metrics by leveraging and applying all the knowledge<a id="_idIndexMarker667"/> gathered from the threat intelligence.<p>One of the biggest advantages of this approach is that it helps the SOC stay relevant and up to date with the latest threats and available remediations.</p></li>
				<li><strong class="bold">Risk analysis</strong>: Your team can leverage threat intelligence data to perform a better risk analysis, not just to help them<a id="_idIndexMarker668"/> identify new risks, but also to adjust and update the probability and impact of already identified risks.<p>Also, you can leverage this information to create new risk responses and mitigation strategies.</p></li>
			</ul>
			<p>Now, before we close this chapter, let's look at an example of how to leverage your expertise and knowledge to analyze some security vulnerabilities and transform them into solutions. At the end of the day, mastering is not just about repeating what is in a book but using that knowledge to create new stuff.</p>
			<h1 id="_idParaDest-122"><a id="_idTextAnchor126"/>Converting a threat into a solution</h1>
			<p>As you have seen throughout this book, there are a lot of hacking tools that an attacker can use against<a id="_idIndexMarker669"/> your infrastructure. However, as a master in defensive security, you need to leverage those threats and use them for your own benefit – <em class="italic">use your opponent's weapon against them</em>.</p>
			<p>Let's look at an example. Remember the USB HID vulnerabilities that we reviewed in <a href="B16290_02_Final_JC_ePub.xhtml#_idTextAnchor035"><em class="italic">Chapter 2</em></a>, <em class="italic">Managing Threats, Vulnerabilities, and Risks</em>? Well, let me show you how those vulnerabilities were leveraged to create a solution that solves another cybersecurity issue: <strong class="bold">passwords</strong>!</p>
			<p>To start, let's begin by looking at the well-known problem of passwords.</p>
			<h2 id="_idParaDest-123"><a id="_idTextAnchor127"/>The problem</h2>
			<p>Currently, you can use password<a id="_idIndexMarker670"/> managers to inject your passwords into applications inside your operating system, but you cannot use it to inject passwords <em class="italic">to log into a computer</em>. So, to log into the operating system, you will have to open the password manager application, read the password, and manually type it in, which is a terrible user experience but also carries the risk of shouldering. There is one solution that allows you to inject a password, but that solution needs you to install an application on your operating system, so this is not a true plug-and-play solution. Also, sysadmins need to log into a variety of servers, so they need a solution that is true plug and play but also works with all operating systems so that the solution can be used across the infrastructure.</p>
			<h2 id="_idParaDest-124"><a id="_idTextAnchor128"/>The solution</h2>
			<p>Here, we can<a id="_idIndexMarker671"/> leverage the capabilities<a id="_idIndexMarker672"/> of the USB HID drivers (the same ones the criminals used for USB attacks) to create a unique plug-and-play solution that enables sysadmins to log onto any server, regardless of the operating system, without the need of any prior installation, making it a high-value and easy-to-implement solution.</p>
			<p>Now, sysadmins can securely use crazy-secure passwords (up to 250 characters) with no effort because they will be securely transmitted to the server with the press of a button.</p>
			<p>If you want to read<a id="_idIndexMarker673"/> more about this patent, please visit the following link:</p>
			<p><a href="https://patents.google.com/patent/US10762188B2">https://patents.google.com/patent/US10762188B2</a></p>
			<p>I hope this example motivates you to look at vulnerabilities once more but with a different<a id="_idIndexMarker674"/> mindset. Start thinking about not just how to prevent them, but also how you can leverage them as an innovative defensive solution.</p>
			<h1 id="_idParaDest-125"><a id="_idTextAnchor129"/>Summary</h1>
			<p>In this chapter, you learned how to leverage one of the best hacking devices (<strong class="bold">the WIFI Pineapple</strong>) in your defensive security strategy, as well as how to protect against the latest attacks performed with that device.</p>
			<p>Additionally, you learned about pentesting and forensics and some of the best tools used in those fields so that you can leverage them.</p>
			<p>Then, you learned about probably the most dangerous threat in cybersecurity, the infamous APT, and more importantly, how to protect your infrastructure against them.</p>
			<p>Now, it is time to move on to the next chapter, where you will become a <em class="italic">master</em> of securing Windows infrastructures (Windows servers, patching, Active Directory, endpoint security, and more).</p>
			<p>There, you will be exposed to the best hardening strategies for Windows servers, including <em class="italic">creating your own hardening checklist!</em></p>
			<h1 id="_idParaDest-126"><a id="_idTextAnchor130"/>Further reading</h1>
			<p>Want to know more about Kali Linux tools? Then this is the place to go. Here, you will find all the tools pre-loaded on Kali Linux, sorted by type: <a href="https://tools.kali.org/tools-listing">https://tools.kali.org/tools-listing</a>.</p>
			<p>Here, you can check the latest version of the WiFi Pineapple that's available, as well as documentation, community, and support: <a href="https://shop.hak5.org/products/wifi-pineapple">https://shop.hak5.org/products/wifi-pineapple</a>.</p>
			<p>If you want to know more about Metasploit, including the newest available version, the different types of versions available, documentation, community, and even contribute to the development of the project, please visit <a href="https://www.metasploit.com/">https://www.metasploit.com/</a>.</p>
		</div>
	</body></html>