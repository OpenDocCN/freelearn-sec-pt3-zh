<html><head></head><body>
		<div><h1 id="_idParaDest-381"><em class="italic"><a id="_idTextAnchor395"/>Chapter 17</em>: Achieving Automation of Security Tools</h1>
			<p><em class="italic">"Most of the time people don't realize the benefits of Automation for being afraid of the myth, "Automation will replace the human," but what really Automation represents is the highest level of maturity and excellence." </em></p>
			<p><em class="italic">– Desilda Toska, Dottore Magistrale and Automation leader </em></p>
			<p>Most attackers leverage automation tools and techniques to enhance the reach of their attacks. Therefore, you must understand the importance of automation so that you can also take advantage of it to better secure your infrastructure.</p>
			<p>Additionally, you must understand the different types of automated attacks that compose the threat landscape so that you can plan your defenses against them.</p>
			<p>In fact, I am sure that you are familiar with several automated attacks such as <em class="italic">spam</em> and <strong class="bold">distributed denial-of-service</strong> (<strong class="bold">DDoS</strong>) attacks, but here, we will review the top 21 automated attacks to better understand this threat, which includes very interesting attacks such as credential stuffing, scalping, sniping, and more.</p>
			<p>Here is a list of the main topics to be covered in this chapter:</p>
			<ul>
				<li>Why bother with automation?</li>
				<li>Types of automated attacks</li>
				<li>Automation of cybersecurity tools using Python</li>
				<li>Cybersecurity automation with Raspberry Pi</li>
			</ul>
			<h1 id="_idParaDest-382"><a id="_idTextAnchor396"/>Why bother with automation? </h1>
			<p><em class="italic">"In computing, the most efficient job is the one that doesn't need to be performed."</em></p>
			<p><em class="italic">– Ignacio Trejos-Zelaya</em></p>
			<p>As mentioned before, cybercriminals leverage automation as their main tool to increase the reach of their attacks, so if you want to play on the same terms, then you should be using also leveraging automation as a key factor in your defensive security strategy.</p>
			<h2 id="_idParaDest-383"><a id="_idTextAnchor397"/>Benefits of automation</h2>
			<p>Let's <a id="_idIndexMarker1622"/>review some of the benefits that you can leverage by implementing automation as part of your defensive security strategy. They are listed here:</p>
			<ul>
				<li>Optimization of resources (you can do more with less)</li>
				<li>Relocation of resources to more advanced tasks (by automating time-consuming non-value-added tasks)</li>
				<li>Cost reduction</li>
				<li>Faster detection of threats</li>
				<li>Faster application of countermeasures</li>
				<li>Reduction of impact in the case of attacks</li>
				<li>Support of compliance and compliance-related tasks </li>
			</ul>
			<p>Now, on the other hand, let's review the risks of not applying automation.</p>
			<h2 id="_idParaDest-384"><a id="_idTextAnchor398"/>The risks of ignoring automation</h2>
			<p>Some <a id="_idIndexMarker1623"/>companies may not be willing to invest in automation; however, here are some of the risks associated with that:</p>
			<ul>
				<li>Waste of resources (by working on tasks that can be automated)</li>
				<li>Increased probability of human error</li>
				<li>Slower time to react (human speed versus computer speed)</li>
				<li>Increased possibility of becoming vulnerable to automated attacks</li>
				<li>Fewer resources available for innovation</li>
				<li>Fewer resources available for research</li>
				<li>Lower capability to discover threats</li>
			</ul>
			<p>Now, let's review the different types of automated attacks that we may face.</p>
			<h1 id="_idParaDest-385"><a id="_idTextAnchor399"/>Types of automated attacks</h1>
			<p>Most attacks are <a id="_idIndexMarker1624"/>automated, aimed to target a broader audience to increase the chances of success; therefore, it is important that you understand the types of automated attacks that you may face, and to do that, we will do a review of the classification<a id="_idIndexMarker1625"/> of automated attacks based on the <strong class="bold">Open Web Application Security Project</strong> (<strong class="bold">OWASP</strong>).</p>
			<h2 id="_idParaDest-386"><a id="_idTextAnchor400"/>Account aggregation</h2>
			<p>This<a id="_idIndexMarker1626"/> attack is aimed at identifying and <a id="_idIndexMarker1627"/>aggregating accounts based on a common factor—for example, gathering all credentials from a given system, gathering credentials from a single user (from a plurality of systems), and so on.</p>
			<h2 id="_idParaDest-387"><a id="_idTextAnchor401"/>Account creation</h2>
			<p>This<a id="_idIndexMarker1628"/> attack is aimed at <a id="_idIndexMarker1629"/>creating bulk accounts.</p>
			<p>The objectives of attackers are varied, including using new accounts for spam, account misuse, <strong class="bold">Denial of Service (DoS)</strong>, and so on.</p>
			<h2 id="_idParaDest-388"><a id="_idTextAnchor402"/>Ad fraud</h2>
			<p>This <a id="_idIndexMarker1630"/>automated attack<a id="_idIndexMarker1631"/> is aimed at providing false clicks to commit fraud with advertisements, as illustrated in the following screenshot: </p>
			<div><div><img src="img/Figure_17.1_B16290.jpg" alt="Figure 17.1 – Ad fraud example&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.1 – Ad fraud example</p>
			<p>As <a id="_idIndexMarker1632"/>illustrated in the preceding screenshot, cybercriminals may<a id="_idIndexMarker1633"/> increase their earnings exponentially by using this type of automated attack to commit fraud.</p>
			<h2 id="_idParaDest-389"><a id="_idTextAnchor403"/>CAPTCHA defeat</h2>
			<p><strong class="bold">Completely Automated Public Turing Test to tell Computers and Humans Apart</strong> (<strong class="bold">CAPTCHA) </strong><a id="_idIndexMarker1634"/>is a very basic way to prevent <a id="_idIndexMarker1635"/>some types of automated attacks by creating a test that can be solved by humans and not by<a id="_idIndexMarker1636"/> robots (scripts). However, with the current advances in <a id="_idIndexMarker1637"/>image recognition technologies and <strong class="bold">optical character recognition</strong> (<strong class="bold">OCR</strong>), CAPTCHAs became harder for users and easier for computers. You can see a couple of examples of impossible CAPTCHAs in the following screenshot:</p>
			<div><div><img src="img/Figure_17.2_B16290.jpg" alt="Figure 17.2 – Examples of impossible CAPTCHAs&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.2 – Examples of impossible CAPTCHAs</p>
			<p>In fact, as illustrated in the preceding screenshot, some CAPTCHAs are impossible to decipher by humans.</p>
			<h2 id="_idParaDest-390"><a id="_idTextAnchor404"/>Card cracking</h2>
			<p>This kind of attack is<a id="_idIndexMarker1638"/> aimed at identifying<a id="_idIndexMarker1639"/> missing credit card data (such as security codes and expiration dates) by brute-forcing them on credit card processing sites.</p>
			<h2 id="_idParaDest-391"><a id="_idTextAnchor405"/>Carding</h2>
			<p>This attack <a id="_idIndexMarker1640"/>is used to<a id="_idIndexMarker1641"/> validate a bulk of stolen or fraudulent credit card numbers. This is normally achieved by testing a bulk of cards on a credit card processing site. </p>
			<h2 id="_idParaDest-392"><a id="_idTextAnchor406"/>Cashing out</h2>
			<p>Purchasing <a id="_idIndexMarker1642"/>goods or services <a id="_idIndexMarker1643"/>using stolen or fraudulent payment information. This attack is automated in order to enable purchases on several sites or in a short period of time (before the card is blocked). </p>
			<h2 id="_idParaDest-393"><a id="_idTextAnchor407"/>Credential cracking</h2>
			<p>Here, the<a id="_idIndexMarker1644"/> attacker tries<a id="_idIndexMarker1645"/> to validate username and password combinations by using brute-force or dictionary-based attacks for both values.</p>
			<h2 id="_idParaDest-394"><a id="_idTextAnchor408"/>Credential stuffing</h2>
			<p>This attack <a id="_idIndexMarker1646"/>is aimed at<a id="_idIndexMarker1647"/> validating a plurality of username and password combinations (normally obtained on the black market or from a previous data breach) against a given site.</p>
			<h2 id="_idParaDest-395"><a id="_idTextAnchor409"/>Denial of inventory</h2>
			<p>A very <a id="_idIndexMarker1648"/>interesting attack aimed at <a id="_idIndexMarker1649"/>reducing the inventory of a product for a period of time by putting it on the cart, but without paying for it. This attack may have a very negative impact on the sales of an e-commerce page, but it can also be triggered to negatively impact the release of a given product or to promote a product. You can see an example of such an attack in the following screenshot:</p>
			<div><div><img src="img/Figure_17.3_B16290.jpg" alt="Figure 17.3 – Denial of inventory attack&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.3 – Denial of inventory attack</p>
			<p>It is <a id="_idIndexMarker1650"/>important to highlight that this attack can also be carried out<a id="_idIndexMarker1651"/> against services such as hotel room reservations, car rentals, and other services and products offered through e-commerce sites.</p>
			<h2 id="_idParaDest-396"><a id="_idTextAnchor410"/>DoS</h2>
			<p>This is probably <a id="_idIndexMarker1652"/>the most common<a id="_idIndexMarker1653"/> type of automated attack, which consists of exceeding the capacity of a web server to stay online by flooding the site with an overwhelming amount of requests, directly affecting the availability of the site and the services provided.</p>
			<h2 id="_idParaDest-397"><a id="_idTextAnchor411"/>Expediting</h2>
			<p>This attack is <a id="_idIndexMarker1654"/>aimed at <a id="_idIndexMarker1655"/>bypassing a series of steps of a process to reach the final steps of the process faster, as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_17.4_B16290.jpg" alt="Figure 17.4 – Example of expediting an account&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.4 – Example of expediting an account</p>
			<p>As seen in the<a id="_idIndexMarker1656"/> preceding screenshot, expediting could save an attacker time by <a id="_idIndexMarker1657"/>reaching the last part of a given web process faster—for example, clicking <strong class="bold">Next</strong> on a web training form until the attacker reaches the final question.</p>
			<h2 id="_idParaDest-398"><a id="_idTextAnchor412"/>Fingerprinting</h2>
			<p>This automated attack <a id="_idIndexMarker1658"/>is about gathering publicly available information<a id="_idIndexMarker1659"/> about a given website to have a better understanding<a id="_idIndexMarker1660"/> of the site. Most of the time, it gathers data such as <strong class="bold">HyperText Transfer Protocol</strong> (<strong class="bold">HTTP</strong>) headers, error messages, <strong class="bold">Uniform Resource Locator</strong> (<strong class="bold">URL</strong>) paths, and so on. This attack can be performed <a id="_idIndexMarker1661"/>without accessing the site by leveraging information indexed on search engines and other techniques, such as leveraging Google dorks.</p>
			<h2 id="_idParaDest-399"><a id="_idTextAnchor413"/>Footprinting</h2>
			<p>This attack <a id="_idIndexMarker1662"/>can be<a id="_idIndexMarker1663"/> considered a more intrusive type of fingerprinting. In this scenario, the attack is aimed at the application, and it tries to collect a plurality of data such as application parameters, values, process sequences, folder structure, and more. This can also be considered as a type <a id="_idIndexMarker1664"/>of <strong class="bold">application programming interface</strong> (<strong class="bold">API</strong>) scanning, but it is important to highlight that this is only about discovery and not about exploiting the information discovered.</p>
			<h2 id="_idParaDest-400"><a id="_idTextAnchor414"/>Scalping</h2>
			<p>This automated attack <a id="_idIndexMarker1665"/>is about monitoring the availability of a given product or <a id="_idIndexMarker1666"/>service offered online and then automatically performing a purchase when a given condition is met (for example, buy all tickets to Lida's concert when availability = 10). </p>
			<h2 id="_idParaDest-401"><a id="_idTextAnchor415"/>Sniping</h2>
			<p>This attack is<a id="_idIndexMarker1667"/> similar to <a id="_idIndexMarker1668"/>scalping, with the difference being that this type of attack is triggered by time (last minute)—for example, place the last bet when time = (deadline -1).</p>
			<h2 id="_idParaDest-402"><a id="_idTextAnchor416"/>Scraping</h2>
			<p>This automated<a id="_idIndexMarker1669"/> attack is about gathering information from web pages and APIs <a id="_idIndexMarker1670"/>either by accessing these as an authenticated user (using a compromised credential) or even doing this without posing as an authenticated user.</p>
			<h2 id="_idParaDest-403"><a id="_idTextAnchor417"/>Skewing</h2>
			<p>The <a id="_idIndexMarker1671"/>objective of this <a id="_idIndexMarker1672"/>attack is to manipulate site metrics (such as click count, visitors, and so on), polls, reviews, and likes in order to manipulate the real results and gain benefit from this (reputation, fame, followers, and more). You can see an example of skewing in the following screenshot:</p>
			<div><div><img src="img/Figure_17.5_B16290.jpg" alt="Figure 17.5 – Example of skewing&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.5 – Example of skewing</p>
			<p>As illustrated in the preceding screenshot, with this attack, the reputation of a given article could be manipulated.</p>
			<h2 id="_idParaDest-404"><a id="_idTextAnchor418"/>Spamming</h2>
			<p>This is a <a id="_idIndexMarker1673"/>well-known<a id="_idIndexMarker1674"/> attack consisting of the massive submission of emails, either for marketing or to distribute malware.</p>
			<h2 id="_idParaDest-405"><a id="_idTextAnchor419"/>Token cracking</h2>
			<p>This attack is<a id="_idIndexMarker1675"/> aimed at discovering tokens such as coupon codes, discounts, and offers <a id="_idIndexMarker1676"/>that are active on a given site and that can be used by the attacker. </p>
			<h2 id="_idParaDest-406"><a id="_idTextAnchor420"/>Vulnerability scanning</h2>
			<p>We already talked in <a id="_idIndexMarker1677"/>depth about this automated attack, which consists of the<a id="_idIndexMarker1678"/> identification of known vulnerabilities on a given website, API, or any other web resource.</p>
			<p>Now, let's discover how to apply automation in cybersecurity using Python.</p>
			<h1 id="_idParaDest-407"><a id="_idTextAnchor421"/>Automation of cybersecurity tools using Python</h1>
			<p>We <a id="_idIndexMarker1679"/>started this chapter by showing all the benefits of automation. Now, it's time to see how we can leverage Python to achieve automation.</p>
			<p>Python is a<a id="_idIndexMarker1680"/> super-intuitive language that is widely used for scripting and automation, and we can also leverage it to automate some cybersecurity-related tasks.</p>
			<p>In fact, you can<a id="_idIndexMarker1681"/> automate almost<a id="_idIndexMarker1682"/> everything <a id="_idIndexMarker1683"/>you want with<a id="_idIndexMarker1684"/> Python, including <a id="_idIndexMarker1685"/>automating well-known cybersecurity tools such as <strong class="bold">Nessus</strong>, <strong class="bold">Nexpose</strong>, <strong class="bold">Shodan</strong>, <strong class="bold">Nmap</strong>, <strong class="bold">Metasploit</strong>, <strong class="bold">Sqlmap</strong>, and <a id="_idIndexMarker1686"/>more.</p>
			<p>However, in this section, we are going to discover other ways to automate cybersecurity tasks with Python.</p>
			<h2 id="_idParaDest-408"><a id="_idTextAnchor422"/>Local file search</h2>
			<p>There are cases where <a id="_idIndexMarker1687"/>you need to search for a given file or folder on a given workstation—for example, to achieve compliance, as part of an audit, or as part of a forensics investigation.</p>
			<p>So, if you are an auditor, it would be great to have a script to look for those files and folders, and that can be easily achieved with Python. Let's discover how.</p>
			<p>Python is loaded by default in Kali Linux, so to run it, you only need to execute the following command:</p>
			<pre>python3</pre>
			<p>Now, as you can see in the following screenshot, <code>&gt;&gt;&gt;</code> indicates that the Python interpreter is ready for your code:</p>
			<div><div><img src="img/Figure_17.6_B16290.jpg" alt="Figure 17.6 – Python interpreter on Kali Linux&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.6 – Python interpreter on Kali Linux</p>
			<p>Now, let's use a function called <code>os.walk</code> that basically collects the filenames and directories by doing a top-down (or even bottom-up) walk of the directory tree.</p>
			<p>For our example, let's imagine we have a file structure like the one in the following screenshot:</p>
			<div><div><img src="img/Figure_17.7_B16290.jpg" alt="Figure 17.7 – File structure of the proposed example&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.7 – File structure of the proposed example</p>
			<p>Now, let's see how easily we can automate the search of files and directories using <code>os.walk</code>.</p>
			<p>Let's start by going back to the Python session that we left open and put the following code there:</p>
			<pre>&gt;&gt;&gt; import os
&gt;&gt;&gt; for root, dirs, files in os.walk('.'):
...     for file in files:
...         print(file)
...         print(----------)</pre>
			<p class="callout-heading">Tip</p>
			<p class="callout">The Python interpreter uses indentation, so make sure your code includes the same indentation as shown in the preceding code snippet.</p>
			<p>As illustrated in the<a id="_idIndexMarker1688"/> following screenshot, the code outputs all the files (top-down) located under our current directory tree:</p>
			<div><div><img src="img/Figure_17.8_B16290.jpg" alt="Figure 17.8 – Output of code with the os.walk function&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.8 – Output of code with the os.walk function</p>
			<p>In this example, we only printed the filename, but you can also print other parameters such as <code>root</code> (directories) and <code>dirs</code> (subdirectories).</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">If you have experience with Python, then you may find this example extremely basic, and indeed that was the idea: to illustrate the concept with a very basic example for readers who are not experienced with Python.</p>
			<p>Additionally, you <a id="_idIndexMarker1689"/>can expand on that example by using other functions such as <code>os.path</code> to show the path of a file, or you could even add a couple of programing lines to only show you a given file type. Here, your imagination is the only limit!</p>
			<h2 id="_idParaDest-409"><a id="_idTextAnchor423"/>Basic forensics</h2>
			<p>You can also automate the <a id="_idIndexMarker1690"/>gathering of metadata from files with simple Python code.</p>
			<p>To achieve that task, we will use the <code>os</code> library. In this example, we will use <code>os.stat</code> because it provides a lot of useful metadata available to the OS, including the following:</p>
			<ul>
				<li>The last time the file was modified (<code>st_mtime</code>)</li>
				<li>The last time the file was accessed (<code>st_atime</code>)</li>
				<li>The creation time or the last time metadata was changed (<code>st_ctime</code>)</li>
				<li>The user <code>st_uid</code>)</li>
				<li>The group ID of the owner (<code>st_gid</code>)</li>
				<li>The file size (<code>st_size</code>)</li>
			</ul>
			<p>Let's see an example.</p>
			<p>Go back to Python and write the following lines of code:</p>
			<pre>&gt;&gt;&gt; import os
&gt;&gt;&gt; stats = os.stat(('secret01'))
&gt;&gt;&gt; stats</pre>
			<p>The output should give<a id="_idIndexMarker1691"/> you all the information just described (creation date, file owner, and so on), as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_17.9_B16290.jpg" alt="Figure 17.9 – Metadata obtained from file with os.stat&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.9 – Metadata obtained from file with os.stat</p>
			<p>If you want to discover more about this library, visit the following web pages:</p>
			<ul>
				<li><a href="https://docs.python.org/3/library/os.html">https://docs.python.org/3/library/os.html</a></li>
				<li><a href="https://docs.python.org/3/library/stat.html ">https://docs.python.org/3/library/stat.html</a><p class="callout-heading">Tip</p><p class="callout">Is the format of the dates not familiar to you? Don't worry—you can use some libraries such as <code>time</code> or <code>datetime</code> to convert the string from Unix time to a human-readable time. </p></li>
			</ul>
			<p>Many other cool libraries can be used to harvest information from files, as discussed next.</p>
			<h3>Pillow</h3>
			<p><code>Pillow</code> is<a id="_idIndexMarker1692"/> an additional Python library that allows image manipulation. In our case, we can use it to gather metadata from <a id="_idIndexMarker1693"/>the image, such as the <strong class="bold">Global Positioning System</strong> (<strong class="bold">GPS</strong>) coordinates of the location where the picture was taken.</p>
			<h3>Gathering metadata from PDF and Word files with Python</h3>
			<p>In the case<a id="_idIndexMarker1694"/> of <code>PDFDocument</code>, <code>PDFParser</code>, <code>PyPDF2</code>, and <code>PdfFileReader</code>.</p>
			<p>For Word documents, the<a id="_idIndexMarker1696"/> most famous library is <code>Python-Docx</code>, which allows you to harvest more than 14 attributes from a Word document.</p>
			<h2 id="_idParaDest-410"><a id="_idTextAnchor424"/>Web scraping</h2>
			<p>Another common way to use Python for automation<a id="_idIndexMarker1697"/> is through web scraping. So, let's do an overview of the most common libraries, packages, and modules used to automate web scraping with Python.</p>
			<h3>Using pip</h3>
			<p>If you are going to play around with Python, then is highly recommended that you install <code>pip</code>. <code>pip</code> is the <a id="_idIndexMarker1698"/>package manager for Python, and it can be installed to be used on the command line to download and install Python packages and their requisite dependencies.</p>
			<p>Installation on Kali Linux is very simple, and it can be achieved with the following commands:</p>
			<pre>sudo apt update
sudo apt install python3-pip</pre>
			<p>Now, to verify the version installed, you can use the following command:</p>
			<pre>pip3 -V</pre>
			<p>As seen in the following screenshot, we successfully installed <code>pip3</code> on Kali Linux:</p>
			<div><div><img src="img/Figure_17.10_B16290.jpg" alt="Figure 17.10 – Displaying pip3 version on Kali Linux&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.10 – Displaying pip3 version on Kali Linux</p>
			<p>Now that we have the environment set up, let's continue with our overview of some of the most used and famous libraries and modules that you can use for Python automation.</p>
			<h3>Beautiful Soup</h3>
			<p>When it comes to cybersecurity, <code>BeautifulSoup</code> is a <a id="_idIndexMarker1699"/>must-have Python library<a id="_idIndexMarker1700"/> to parse <strong class="bold">HyperText Markup Language</strong> (<strong class="bold">HTML</strong>) and <strong class="bold">Extensible Markup Language</strong> (<strong class="bold">XML</strong>) files. In fact, you<a id="_idIndexMarker1701"/> will see that this library is used in almost all Python code in terms of web scraping.</p>
			<p>The beauty of <code>BeautifulSoup</code> lies in all the options it gives you to extract only the data you need in an easy and clean way. Let me explain to you how this works.</p>
			<p><em class="italic">First, let's be clear on one thing</em>—<em class="italic">an HTML file is not only a file but a juicy source of information and with Beautiful Soup, you can extract all that juice.</em></p>
			<p>The following screenshot depicts information that can be parsed using Beautiful Soup:</p>
			<div><div><img src="img/Figure_17.11_B16290.jpg" alt="Figure 17.11 – Information that can be parsed with Beautiful Soup&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.11 – Information that can be parsed with Beautiful Soup</p>
			<p>As shown in the preceding screenshot, there is a lot of information that can be parsed out of an HTML file, and <code>BeautifulSoup</code> makes this easier for us.</p>
			<p>Now, let's see how you can also leverage Python to automate some network security tasks. </p>
			<h2 id="_idParaDest-411"><a id="_idTextAnchor425"/>Network security automation</h2>
			<p>You can find countless <a id="_idIndexMarker1702"/>Python scripts to automate some network security tasks, and they vary depending on the tools and systems that you have in place.</p>
			<p>However, you can also create your own, so let's have an overview of a very famous tool that you can leverage to automate some tasks regarding the capture and analysis of network traffic—the famous <strong class="bold">Scapy</strong>.</p>
			<h3>Scapy</h3>
			<p>This is a great tool <a id="_idIndexMarker1703"/>that you can leverage on your Python code (interactively or as a library) to manage packets gathered from network-sniffing software such as Wireshark.</p>
			<p>To install it, you can leverage the following command:</p>
			<pre>pip3 install scapy</pre>
			<p>Then, you can confirm <code>scapy</code> is installed with the following command:</p>
			<pre>scapy</pre>
			<p>If the installation was successful, you should see something like this:</p>
			<div><div><img src="img/Figure_17.12_B16290.jpg" alt="Figure 17.12 – Scapy &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.12 – Scapy </p>
			<p>There is a <a id="_idIndexMarker1704"/>lot of cool things you can do with<a id="_idIndexMarker1705"/> Scapy, such as sending modified <strong class="bold">Internet Control Message Protocol</strong> (<strong class="bold">ICMP</strong>) packets, port scanning, reading <strong class="bold">packet capture (PCAP)</strong> files, or even capturing packets (just like you do with Wireshark).</p>
			<p class="callout-heading">Note</p>
			<p class="callout">A lot of people get confused between <code>scapy</code> and <code>scrapy</code>, as both are used for security on Python. However, while <code>scapy</code> is mostly used for packet manipulation, <code>scrapy</code> is used for web scraping for Python. Similar, but not the same!</p>
			<p>Now, let's discover how we can leverage the powerful <strong class="bold">Raspberry Pi</strong> to automate cybersecurity tasks.</p>
			<h1 id="_idParaDest-412"><a id="_idTextAnchor426"/>Cybersecurity automation with the Raspberry Pi</h1>
			<p>In <a href="B16290_10_Final_JC_ePub.xhtml#_idTextAnchor231"><em class="italic">Chapter 10</em></a>, <em class="italic">Applying IoT Security</em>, we covered a lot of cool cybersecurity projects that you can do <a id="_idIndexMarker1706"/>with the Raspberry Pi, including the<a id="_idIndexMarker1707"/> following:</p>
			<ul>
				<li>Detection of a rogue access point</li>
				<li>Creating an <strong class="bold">Intrusion Detection System</strong> (<strong class="bold">ISD</strong>) and a firewall with the Raspberry Pi</li>
				<li>Creating a machine to safely copy information from a <strong class="bold">Universal Serial Bus</strong> (<strong class="bold">USB</strong>) device</li>
				<li>Creating a honeypot</li>
				<li>Creating a network monitoring device</li>
				<li>Creating an ad blocker</li>
				<li>And even creating a system to detect a rogue Raspberry Pi in your network and how to disable it</li>
			</ul>
			<p>Now, in this section, we will do an overview of Raspberry Pi projects that will help you to automate some cybersecurity tasks. </p>
			<h2 id="_idParaDest-413"><a id="_idTextAnchor427"/>Automating threat intelligence gathering with a Fail2ban honeypot on a Raspberry Pi</h2>
			<p>There <a id="_idIndexMarker1708"/>are a lot of<a id="_idIndexMarker1709"/> tools and <a id="_idIndexMarker1710"/>techniques to blacklist <strong class="bold">Internet Protocol</strong> (<strong class="bold">IP</strong>) addresses. In fact, you can even build your own using a Raspberry Pi by installing Pi-hole (as mentioned in <a href="B16290_10_Final_JC_ePub.xhtml#_idTextAnchor231"><em class="italic">Chapter 10</em></a>,<em class="italic"> Applying IoT Security</em>), but we are not going to talk about those systems here but rather about how you can leverage an unexpensive Raspberry Pi to gather data about attackers and use that data to better protect your infrastructure.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">These solutions based on low-cost hardware are not designed to replace robust enterprise-grade devices. Instead, they are designed as a great tool to create prototypes and <strong class="bold">proof of concepts</strong> (<strong class="bold">PoCs</strong>), which <a id="_idIndexMarker1711"/>are an essential step in doing research, which in the end is a must-have skill for a master in cybersecurity.</p>
			<p>For this task, we will leverage a free open source software called <strong class="bold">Fail2ban</strong>.</p>
			<p>Fail2ban<a id="_idIndexMarker1712"/> works by analyzing the system log files (such as <code>/var/log/apache/error_log</code>) to look for malicious login attempts, brute-force attacks, and other exploits against our system.</p>
			<p>However, Fail2ban <a id="_idIndexMarker1713"/>was designed to run on a single system, so what we will do is to leverage the power and low cost <a id="_idIndexMarker1714"/>of the Raspberry Pi, set it up as an exposed honeypot system to gather threat intelligence about attackers, and then use that information to enhance the blacklists used on our defensive security systems.</p>
			<p>The following screenshot illustrates the proposed architecture to leverage Fail2ban on the Raspberry Pi to automate intelligence gathering: </p>
			<div><div><img src="img/Figure_17.13_B16290.jpg" alt="Figure 17.13 – Proposed solution architecture with Fail2ban on the Raspberry Pi&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.13 – Proposed solution architecture with Fail2ban on the Raspberry Pi</p>
			<p>You can <a id="_idIndexMarker1715"/>follow a tutorial created by <a href="http://pimylifeup.com">pimylifeup.com</a> about how to install Fail2ban on the Raspberry Pi at <a href="https://pimylifeup.com/raspberry-pi-fail2ban/">https://pimylifeup.com/raspberry-pi-fail2ban/</a>.</p>
			<p>You can also set up <a id="_idIndexMarker1716"/>Fail2ban directly on a Unix server by following this guide: <a href="https://www.redhat.com/sysadmin/protect-systems-fail2ban">https://www.redhat.com/sysadmin/protect-systems-fail2ban</a>.</p>
			<p>Alternatively, you can visit their official site at <a href="https://www.fail2ban.org">https://www.fail2ban.org</a>.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Another cool feature of Fail2ban is that you can configure it to notify you as soon as an attack is detected so that you can grab the attacker's data and input it into your systems in no time.</p>
			<p>Now, let's look at another cool project to automate internet monitoring with our little friend, the Raspberry Pi.</p>
			<h2 id="_idParaDest-414"><a id="_idTextAnchor428"/>Automated internet monitoring system with the Raspberry Pi</h2>
			<p>Imagine you<a id="_idIndexMarker1717"/> have a remote location with <a id="_idIndexMarker1718"/>Wi-Fi for your clients, and there are a lot of things that may impact that internet connection, from being slow to offering no internet connection at all.</p>
			<p>So, let's review a couple of projects in which you can use the Raspberry Pi to automate the detection of those issues and inform you so that you can take action before your clients get impacted.</p>
			<h3>Automated internet monitor with a Raspberry Pi</h3>
			<p>There is a<a id="_idIndexMarker1719"/> simple solution in which you use a <a id="_idIndexMarker1720"/>Raspberry Pi with simple code to ping one of the devices on an external location to determine if they have an active internet <a id="_idIndexMarker1721"/>connection. Then, you can leverage the Raspberry Pi's capabilities to alert you using a <strong class="bold">light-emitting diode</strong> (<strong class="bold">LED</strong>), a sound, or a more subtle alternative such as alerting you through a dashboard, email, or even a message to your social media account, as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_17.14_B16290.jpg" alt="Figure 17.14 – Architecture of an automated internet monitoring system&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 17.14 – Architecture of an automated internet monitoring system</p>
			<p>If you want to<a id="_idIndexMarker1722"/> implement this internet monitoring <a id="_idIndexMarker1723"/>solution, then you can follow a <a id="_idIndexMarker1724"/>very detailed step-by-step installation published by the maker called <em class="italic">talk2bruce</em> at <a href="https://www.instructables.com/Raspberry-Pi-Internet-Monitor/">https://www.instructables.com/Raspberry-Pi-Internet-Monitor/</a>.</p>
			<p> Now, let's review another automation aimed to control not just the connection but the speed of the internet.</p>
			<h3>Automated internet speed monitor</h3>
			<p>As mentioned, there <a id="_idIndexMarker1725"/>may be cases in which the internet may be working but is slow<a id="_idIndexMarker1726"/> due to <strong class="bold">internet service provider</strong> (<strong class="bold">ISP</strong>) problems, issues with the router, issues with cables, and more. Regardless of the source of the problem, you need to be informed about those issues so that you can take action to resolve them (remember—availability issues are also your responsibility).</p>
			<p>Additionally, the Raspberry Pi also allows you to record a history of your internet connectivity in your database so that you can use all that data for further analysis (for example, find patterns to discover the root cause of an issue).</p>
			<p>There is a tutorial about how you can leverage a third-party API from Ookla (<a href="https://www.speedtest.net/apps/cli">https://www.speedtest.net/apps/cli</a>) to monitor the internet speed on the Raspberry Pi: <a href="https://pimylifeup.com/raspberry-pi-internet-speed-monitor/">https://pimylifeup.com/raspberry-pi-internet-speed-monitor/</a>.</p>
			<p>Those are some examples of automation with the Raspberry Pi, but here, the sky is the limit. </p>
			<p>And remember—if you are an expert on the Raspberry Pi, send me a link to your projects for review and we can even include them in upcoming versions of the book.</p>
			<h1 id="_idParaDest-415"><a id="_idTextAnchor429"/>Summary</h1>
			<p>We did a comprehensive overview of the top 21 types of automated attacks that are currently being used by attackers so that you can do an assessment of your organization to determine which of those attacks are a possible threat to your infrastructure and organization.</p>
			<p>But we also learned that we can take advantage of automation, so we reviewed some Python libraries that you can leverage to perform automation in tasks related to forensics, web scraping, and network security.</p>
			<p>And before closing the chapter, we learned how to take advantage of the famous Raspberry Pi to create some very cool cybersecurity gadgets that enable us to automate some tasks such as gathering malicious addresses to include in our blacklist and two different methods to test the speed and stability of an internet connection.</p>
			<p>I hope this last part inspires you to do some extra testing and research to develop your own cybersecurity gadgets and prototypes like a master!</p>
			<h1 id="_idParaDest-416"><a id="_idTextAnchor430"/>Further reading</h1>
			<p>If you want to know more about the Raspberry Pi, then you can visit the manufacturer's website, which is a great source of resources including tutorials, projects, and more.</p>
			<p>Also, you can find information there about all the different versions of the Raspberry Pi available, to determine which one is more suitable for your project. </p>
			<p>Here's the link to the site:</p>
			<p><a href="https://www.raspberrypi.org/">https://www.raspberrypi.org/</a></p>
		</div>
	</body></html>