["```\n            tls-server \n            proto udp \n            port 1194 \n            dev tap \n\n            server 192.168.99.0 255.255.255.0 \n\n            tls-auth /etc/openvpn/cookbook/ta.key 0 \n            ca       /etc/openvpn/cookbook/ca.crt \n            cert     /etc/openvpn/cookbook/server.crt \n            key      /etc/openvpn/cookbook/server.key \n            dh       /etc/openvpn/cookbook/dh2048.pem \n\n            persist-key \n            persist-tun \n            keepalive 10 60 \n\n            push \"route 10.198.0.0 255.255.0.0\" \n\n            user  nobody \n            group nobody   # use \"group nogroup\" on some distros \n\n            daemon \n            log-append /var/log/openvpn.log \n\n    ```", "```\n     [root@server]# openvpn --config example3-1-server.conf\n\n    ```", "```\n     [root@server]# sysctl -w net.ipv4.ip_forward=1\n     [root@server]# iptables -t nat -I POSTROUTING -i tap+ -o eth0 \\\n     -s 192.168.99.0/24 -j MASQUERADE\n\n    ```", "```\n            client \n            proto udp \n            remote openvpnserver.example.com \n            port 1194 \n            dev tap \n            nobind \n\n            remote-cert-tls server \n            tls-auth /etc/openvpn/cookbook/ta.key 1 \n            ca   /etc/openvpn/cookbook/ca.crt \n            cert /etc/openvpn/cookbook/client1.crt \n            key  /etc/openvpn/cookbook/client1.key \n\n    ```", "```\n     [root@client]# openvpn --config example3-1-client.conf\n\n    ```", "```\n     [client]$ ping -c 2 192.168.99.1\n    PING 192.168.99.1 (192.168.99.1) 56(84) bytes of data.\n    64 bytes from 192.168.99.1: icmp_seq=1 ttl=64 time=25.3 ms\n    64 bytes from 192.168.99.1: icmp_seq=2 ttl=64 time=25.2 ms\n\n    ```", "```\n     [client]$ ping -c 2 10.198.0.1\n    PING 10.198.0.1 (10.198.0.1) 56(84) bytes of data.\n    64 bytes from 10.198.0.1: icmp_seq=1 ttl=63 time=29.2 ms\n    64 bytes from 10.198.0.1: icmp_seq=2 ttl=63 time=25.3 ms\n\n    ```", "```\n[root@server]# iptables -t nat -I POSTROUTING -i tap+ -o eth0 \\\n-s 192.168.99.0/24 -j MASQUERADE\n\n```", "```\nproto udp \n\n```", "```\nproto tcp \n\n```", "```\n            net.ipv4.ip_forward=1 \n\n    ```", "```\n     [root@server]# sysctl -p\n\n    ```", "```\n     client-to-client\n\n    ```", "```\n     [root@server]# openvpn --config example3-2-server.conf\n\n    ```", "```\n     [root@server]# sysctl -w net.ipv4.ip_forward=1\n     [root@server]# iptables -t nat -I POSTROUTING -i tap+ -o eth0 \\\n     -s 192.168.99.0/24 -j MASQUERADE\n\n    ```", "```\n            client \n            proto udp \n            remote openvpnserver.example.com \n            port 1194 \n\n            dev tap \n            nobind \n\n            remote-cert-tls server \n            tls-auth \"c:/program files/openvpn/config/ta.key\" 1 \n            ca       \"c:/program files/openvpn/config/ca.crt\" \n            cert     \"c:/program files/openvpn/config/client1.crt\" \n            key      \"c:/program files/openvpn/config/client1.key\" \n\n            verb 5 \n\n    ```", "```\n            client \n            proto udp \n            remote openvpnserver.example.com \n            port 1194 \n\n            dev tap \n            nobind \n\n            remote-cert-tls server \n            tls-auth \"c:/program files/openvpn/config/ta.key\" 1 \n            ca       \"c:/program files/openvpn/config/ca.crt\" \n            cert     \"c:/program files/openvpn/config/client2.crt\" \n            key      \"c:/program files/openvpn/config/client2.key\" \n\n            verb 5 \n\n    ```", "```\n     [WinClient1]C:> cd \\program files\\openvpn\\config\n     [WinClient1]C:> ..\\bin\\openvpn --config example3-2-\n              client1.ovpn\n\n    ```", "```\n     [WinClient1]C:> ping 192.168.99.1\n     Pinging 192.168.99.1 with 32 bytes of data:\n     Reply from 192.168.99.1: bytes=32 time=24ms TTL=64\n     Reply from 192.168.99.1: bytes=32 time=25ms TTL=64\n\n    ```", "```\n     [WinClient1]C:> ping 192.168.99.3\n     Pinging 192.168.99.3 with 32 bytes of data:\n     Reply from 192.168.99.3: bytes=32 time=49ms TTL=128\n     Reply from 192.168.99.3: bytes=32 time=50ms TTL=128\n\n    ```", "```\n     [WinClient1]C:\\> ping -c 2 10.198.0.9\n     Pinging 10.198.0.9 with 32 bytes of data:\n     Reply from 10.198.0.9: bytes=32 time=25ms TTL=63\n     Reply from 10.198.0.9: bytes=32 time=25ms TTL=63\n\n    ```", "```\nclient-to-client \n\n```", "```\n# echo 1 > /proc/sys/net/ipv4/conf/tap0/proxy_arp_pvlan \n\n```", "```\n    proto udp\n    port 1194\n    dev tap0 ## the '0' is extremely important\n    server-bridge 192.168.4.65 255.255.255.0 192.168.4.128  \n            192.168.4.200\n    push \"route 192.168.4.0 255.255.255.0\"\n    tls-auth /etc/openvpn/cookbook/ta.key 0\n    ca       /etc/openvpn/cookbook/ca.crt\n    cert     /etc/openvpn/cookbook/server.crt\n    key      /etc/openvpn/cookbook/server.key\n    dh       /etc/openvpn/cookbook/dh2048.pem\n    persist-key\n    persist-tun\n    keepalive 10 60\n    user  nobody\n    group nobody  # use \"group nogroup\" on some distros\n    daemon\n    log-append /var/log/openvpn.log\n\n    ```", "```\n            #!/bin/bash \n\n            br=\"br0\" \n            tap=\"tap0\" \n\n            eth=\"eth0\" \n            eth_ip=\"192.168.4.65\" \n            eth_netmask=\"255.255.255.0\" \n            eth_broadcast=\"192.168.4.255\" \n\n            openvpn --mktun --dev $tap \n\n            brctl addbr $br \n            brctl addif $br $eth \n            brctl addif $br $tap \n            ifconfig $tap 0.0.0.0 promisc up \n            ifconfig $eth 0.0.0.0 promisc up \n            ifconfig $br $eth_ip netmask $eth_netmask \\ \n            broadcast $eth_broadcast \n\n    ```", "```\n            #!/bin/bash \n\n            br=\"br0\" \n            tap=\"tap0\" \n\n            ifconfig $br down \n            brctl delbr $br \n            openvpn --rmtun --dev $tap \n\n    ```", "```\n     [root@server]# bash example3-3-bridge-start\n     TUN/TAP device tap0 opened\n     Persist state set to: ON\n     [root@server]# brctl show\n     bridge name bridge id         STP enabled interfaces\n     br0         8000.00219bd2d422 no          eth0\n     tap0\n\n    ```", "```\n     [root@server]# openvpn --config example3-3-server.conf\n\n    ```", "```\n     [WinClient]C:> ipconfig /all\n     [...]\n     Ethernet adapter tun0:\n     Connection-specific DNS Suffix  . :\n     Description . . . . . . . . . . . : TAP-Win32 Adapter V9\n     Physical Address. . . . . . . . . : 00-FF-17-82-55-DB\n     Dhcp Enabled. . . . . . . . . . . : Yes\n     Autoconfiguration Enabled . . . . : Yes\n     IP Address. . . . . . . . . . . . : 192.168.4.128\n     Subnet Mask . . . . . . . . . . . : 255.255.255.0\n     Default Gateway . . . . . . . . . :\n     DHCP Server . . . . . . . . . . . : 192.168.4.0\n\n    ```", "```\n     [WinClient]C:> ping 192.168.4.164\n     Pinging 192.168.4.164 with 32 bytes of data:\n     Reply from 192.168.4.164: bytes=32 time=3ms TTL=64\n     Reply from 192.168.4.164: bytes=32 time=1ms TTL=64\n     Reply from 192.168.4.164: bytes=32 time=1ms TTL=64\n     Reply from 192.168.4.164: bytes=32 time<1ms TTL=64\n\n    ```", "```\n     [root@server]# bash example3-3-bridge-stop\n     TUN/TAP device tap0 opened\n     Persist state set to: OFF\n\n    ```", "```\n            proto udp \n            port 1194 \n            dev tap \n            dev-node tapbridge \n\n            server-bridge 192.168.3.15 255.255.255.0 192.168.3.128 \n            192.168.3.250 \n\n            dh       \"c:/program files/openvpn/config/dh2048.pem\" \n            tls-auth \"c:/program files/openvpn/config/ta.key\" 0 \n            ca       \"c:/program files/openvpn/config/ca.crt\" \n            cert     \"c:/program files/openvpn/config/server.crt\" \n            key      \"c:/program files/openvpn/config/server.key\" \n\n            push \"route 192.168.3.0 255.255.255.0\" \n\n            persist-key \n            persist-tun \n            keepalive 10 60 \n\n    ```", "```\n     [winserver]C:> netsh interface ip show address \"Network \n              Bridge\"\n     Configuration for interface \"Network Bridge\"\n     DHCP enabled:                     No\n     IP Address:                       192.168.3.15\n     SubnetMask:                       255.255.255.0\n     Default Gateway:                  192.168.3.1\n     GatewayMetric:                    5\n     InterfaceMetric:                  0\n\n    ```", "```\n     [winserver]C:> cd \\program files\\openvpn\\config\n     [winserver]C:> ..\\bin\\openvpn --config example3-4-server.ovpn\n\n    ```", "```\n     [root@client]# openvpn --config example3-1-client.conf\n\n    ```", "```\n     [client]$ /sbin/ifconfig tap1\n     tap1  Link encap:Ethernet  HWaddr A2:F4:E2:41:05:BF\n     inet addr:192.168.3.128  Bcast:192.168.3.255 \n     Mask:255.255.255.0\n    [...]\n     [client]$ ping -c 2 192.168.3.1\n     PING 192.168.3.1 (192.168.3.1) 56(84) bytes of data.\n     64 bytes from 192.168.3.1: icmp_seq=1 ttl=128 time=24.0 ms\n     64 bytes from 192.168.3.1: icmp_seq=2 ttl=128 time=26.0 ms\n\n    ```", "```\ndev tap \ndev-node tapbridge \n\n```", "```\ndev tap0 \n\n```", "```\n     [root@server]# bash example3-3-bridge-start\n     TUN/TAP device tap0 opened\n     Persist state set to: ON\n     [root@server]# brctl show\n     bridge name bridge id         STP enabled interfaces\n     br0         8000.00219bd2d422 no          eth0\n     tap0\n\n    ```", "```\n     [root@server]# openvpn --config example3-3-server.conf\n\n    ```", "```\n     [WinClient1]C:> cd \\program files\\openvpn\\config\n     [WinClient1]C:> ..\\bin\\openvpn --config example3-2-\n              client2.ovpn\n\n    ```", "```\n            proto udp \n            port 1194 \n            dev tap0 \n\n            server-bridge \n            push \"route 0.0.0.0 255.255.255.255 net_gateway\" \n\n            tls-auth /etc/openvpn/cookbook/ta.key 0 \n            ca       /etc/openvpn/cookbook/ca.crt \n            cert     /etc/openvpn/cookbook/server.crt \n            key      /etc/openvpn/cookbook/server.key \n            dh       /etc/openvpn/cookbook/dh2048.pem \n\n            persist-key \n            persist-tun \n            keepalive 10 60 \n\n            user  nobody \n            group nobody  # use \"group nogroup\" on some distros \n\n            daemon \n            log-append /var/log/openvpn.log \n\n    ```", "```\n     [root@server]# openvpn --config example3-6-server.conf\n\n    ```", "```\n     [WinClient]C:> ipconfig /all\n     [...]\n     Ethernet adapter tapwin32-0\n     Connection-specific DNS Suffix  . : lan\n     Description . . . . . . . . . . . : TAP-Win32 Adapter V9\n     Physical Address. . . . . . . . . : 00-FF-17-82-55-DB\n     Dhcp Enabled. . . . . . . . . . . : Yes\n     Autoconfiguration Enabled . . . . : Yes\n     IP Address. . . . . . . . . . . . : 192.168.4.66\n     Subnet Mask . . . . . . . . . . . : 255.255.255.0\n     Default Gateway . . . . . . . . . : 192.168.4.254\n     DHCP Server . . . . . . . . . . . : 192.168.4.254\n     DNS Servers . . . . . . . . . . . : 192.168.4.254\n     [...]\n     [WinClient]C:> netstat -rn\n     [...]\n     0.0.0.0  0.0.0.0         192.168.3.1    192.168.3.22  10\n     0.0.0.0  255.255.255.255 192.168.3.1    192.168.3.22   1\n     0.0.0.0  0.0.0.0         192.168.4.254 192.168.4.66   1\n     Default Gateway:        192.168.3.1\n     [...]\n\n    ```", "```\n     [WinClient]C:> ping 192.168.4.64\n     Pinging 192.168.4.64 with 32 bytes of data:\n     Reply from 192.168.4.64: bytes=32 time=3ms TTL=64\n     Reply from 192.168.4.64: bytes=32 time=1ms TTL=64\n     Reply from 192.168.4.64: bytes=32 time=1ms TTL=64\n     Reply from 192.168.4.64: bytes=32 time<1ms TTL=64\n\n    ```", "```\nserver-bridge \n\n```", "```\npush \"route 0.0.0.0 255.255.255.255 net_gateway\" \n\n```", "```\nlladdr CA:C6:F8:FB:EB:3B \n\n```", "```\n[root@server]# dhrelay -i tap0 -i eth0\n\n```", "```\n[root@client]# /sbin/ifup tap0\n\n```", "```\nGATEWAYDEV=eth0 \n\n```", "```\n            status /var/log/openvpn.status \n\n    ```", "```\n     [root@server]# openvpn --config example3-7-server.conf\n\n    ```", "```\n     [root@client1]# openvpn --config example3-1-client.conf\n     [root@client1]# ping 10.198.0.1\n\n    ```", "```\n     [root@server]# cat /var/log/openvpn.status\n     OpenVPN CLIENT LIST\n     Updated,Wed Mar  2 17:34:39 2016\n     Common Name,Real Address,Bytes Received,Bytes Sent,Connected \n     Since\n     client1,192.168.4.65:50183,10024,10159,Wed Mar 2 17:26:48 \n              2016\n     ROUTING TABLE\n     Virtual Address,Common Name,Real Address,Last Ref\n     5e:52:73:5c:6a:ce,client1,192.168.4.65:50183,Wed Mar 2 \n              17:27:06 2016\n     GLOBAL STATS\n     Max bcast/mcast queue length,1\n     END\n\n    ```", "```\n     [WinClient2]C:> ping 10.198.0.1\n\n    ```", "```\n     [root@server]# cat /var/log/openvpn.status\n     OpenVPN CLIENT LIST\n     Updated,Wed Mar  2 17:40:22 2016\n     Common Name,Real Address,Bytes Received,Bytes Sent,Connected\n     Since\n     client1,192.168.4.65:50183,10024,10159,Wed Mar  2 17:27:08  \n              2016\n     client2,192.168.4.64:50186,18055,9726,Wed Mar  2 17:26:48 \n              2016\n     ROUTING TABLE\n     Virtual Address,Common Name,Real Address,Last Ref\n     5e:52:73:5c:6a:ce,client1,192.168.4.65:50183,Wed Mar  2 \n              17:27:06 2016\n     00:ff:17:82:55:db,client2,192.168.4.64:50186,Wed Mar  2 \n              17:27:16 2016\n     GLOBAL STATS\n     Max bcast/mcast queue length,1\n     END\n\n    ```", "```\n10.200.0.2,client1,192.168.4.65:56764,<Date> \n\n```", "```\n5e:52:73:5c:6a:ce,client1,192.168.4.65:50183,<Date> \n\n```", "```\nkeepalive 10 60 \n\n```", "```\n            management tunnel 23000 stdin \n\n    ```", "```\n    [root@server]# openvpn --config example3-8-server.conf\n\n    ```", "```\n    [root@client1]# openvpn --config example3-1-client.conf\n\n    ```", "```\n    [server]$ telnet 127.0.0.1 23000\n    Trying 127.0.0.1...\n    Connected to localhost.localdomain (127.0.0.1).\n    Escape character is '^]'.\n    ENTER PASSWORD:cookbook\n    SUCCESS: password is correct\n    >INFO:OpenVPN Management Interface Version 1 -- type 'help' for \n            more info\n    status\n    OpenVPN CLIENT LIST\n    Updated,Wed Mar  2 17:57:07 2016\n    Common Name,Real Address,Bytes Received,Bytes Sent,Connected \n            Since\n    client1,192.168.4.64:50209,7851,8095,Wed Mar  2 17:56:08 2016\n    client2,192.168.4.5:50212,11696,7447,Wed Mar  2 17:56:45 2016\n    ROUTING TABLE\n    Virtual Address,Common Name,Real Address,Last Ref\n    00:ff:17:82:55:db,client2,192.168.4.5:50212,Wed Mar  2 17:56:49 \n            2016\n    1e:b8:95:e5:60:21,client1,192.168.4.64:50209,Wed Mar  2 \n            17:56:53 2016\n    GLOBAL STATS\n    Max bcast/mcast queue length,1\n    END\n\n    ```", "```\n            kill client2 \n            SUCCESS: common name 'client2' found, 1 client(s) killed \n\n            status \n            OpenVPN CLIENT LIST \n            Updated,Wed Mar  2 17:58:51 2016 \n            Common Name,Real Address,Bytes Received,Bytes Sent,Connected \n            Since \n            client1,192.168.4.64:50209,8381,8625,Wed Mar  2 17:56:08 2016 \n            ROUTING TABLE \n            Virtual Address,Common Name,Real Address,Last Ref \n            1e:b8:95:e5:60:21,client1,192.168.4.64:50209,Wed Mar  2 \n            17:56:53 2016 \n            GLOBAL STATS \n            Max bcast/mcast queue length,1 \n            END \n\n    ```", "```\nmanagement 127.0.0.1 23000 stdin \n\n```", "```\nkill <clientcommonname> \n\n```", "```\n            server-ipv6 2001:db8:99::0/112 \n\n    ```", "```\n    [root@server]# openvpn --config example3-9-server.conf\n\n    ```", "```\n    [root@client1]# openvpn --config example3-1-client.conf \\\n     --suppress-timestamps\n    OpenVPN 2.3.10 x86_64-redhat-linux-gnu [SSL (OpenSSL)] [LZO]    \n            [EPOLL] [PKCS11] [MH] [IPv6] built on Jan  4 2016\n    library versions: OpenSSL 1.0.1e-fips 11 Feb 2013, LZO 2.03\n    Control Channel Authentication: using    \n            '/etc/openvpn/cookbook/ta.key' as a OpenVPN static key file\n    UDPv4 link local: [undef]\n    UDPv4 link remote: [AF_INET]openvpnserver:1194\n    [openvpnserver] Peer Connection Initiated with     \n            [AF_INET]openvpnserver:1194\n    TUN/TAP device tap0 opened\n    do_ifconfig, tt->ipv6=1, tt->did_ifconfig_ipv6_setup=1\n    /sbin/ip link set dev tap0 up mtu 1500\n    /sbin/ip addr add dev tap0 192.168.99.2/24 broadcast \n            192.168.99.255\n    /sbin/ip -6 addr add 2001:db8:99::1000/112 dev tap0\n    Initialization Sequence Completed\n\n    ```", "```\n     [client]$   ping6 -c 4  2001:db8:99::1\n    ping6 -c 4 2001:db8:99::1\n    PING 2001:db8:99::1(2001:db8:99::1) 56 data bytes\n    64 bytes from 2001:db8:99::1: icmp_seq=1 ttl=64 time=0.620 ms\n    64 bytes from 2001:db8:99::1: icmp_seq=2 ttl=64 time=0.630 ms\n    64 bytes from 2001:db8:99::1: icmp_seq=3 ttl=64 time=0.631 ms\n    64 bytes from 2001:db8:99::1: icmp_seq=4 ttl=64 time=0.627 ms\n    --- 2001:db8:99::1 ping statistics ---\n    4 packets transmitted, 4 received, 0% packet loss, time \n              3000ms\n    rtt min/avg/max/mdev = 0.620/0.627/0.631/0.004 ms\n\n    ```", "```\nserver-ipv6 2001:db8:99::0/112 \n\n```", "```\n# iptables -I INPUT -i tap+ -j ACCEPT\n# iptables -I OUTPUT -o tap+ -j ACCEPT\n# ip6tables -I INPUT -i tap+ -j ACCEPT\n# ip6tables -I OUTPUT -o tap+ -j ACCEPT\n# iptables -I FORWARD -i tap+ -j ACCEPT\n# iptables -I FORWARD -o tap+ -j ACCEPT\n# ip6tables -I FORWARD -i tap+ -j ACCEPT\n# ip6tables -I FORWARD -o tap+ -j ACCEPT\n\n```"]