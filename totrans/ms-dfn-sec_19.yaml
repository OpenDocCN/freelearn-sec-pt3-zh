- en: '*Chapter 16*: Practicing Forensics'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*"Dealing with Digital Evidence is a big challenge for the justice system,
    especially when we realize the new challenges and risks that it brings, like the
    remote manipulation of the collected evidence."*'
  prefs: []
  type: TYPE_NORMAL
- en: '*– Judge RosibelJara*'
  prefs: []
  type: TYPE_NORMAL
- en: Digital forensics is a very complex topic because, as you will see in this chapter,
    evidence can be gathered even if you don't have access to the device. Consequently,
    to be admitted on trial, digital evidence must comply with a plurality of conditions
    and regulations to ensure that the digital evidence was handled properly and that
    it was taken into custody appropriately. Therefore, the role of the digital forensics
    specialist is key to ensuring the success of the digital forensics process. This
    chapter aims to give you a very good introduction to the topic and serve as a
    starting point in case you need to face this process.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following topics will be covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Introduction to digital forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Digital forensics on defensive security
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Forensics platforms
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finding evidence
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mobile forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Managing the evidence
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction to digital forensics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Digital forensics** (also known as **cyber forensics** or just forensics)
    is the process used to collect, identify, gather, secure, and store data from
    digital systems that can be used as evidence.'
  prefs: []
  type: TYPE_NORMAL
- en: In our case, we will focus on forensics to detect the use, abuse, intrusion,
    damage, or modification of computer systems, servers, networks, infrastructures,
    or data. However, forensics is also used to recover deleted or modified data,
    so let's take a few minutes to review how forensics can be used for that.
  prefs: []
  type: TYPE_NORMAL
- en: Forensics to recover deleted or missing data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: There is one part of forensics that is used to collect, identify, and recover
    deleted data from digital media.
  prefs: []
  type: TYPE_NORMAL
- en: Usually, data is recovered from non-volatile media storage such as hard drives
    and USB drives, but it is also possible to gather data from volatile memory such
    as **Random Access Memory (RAM)**.
  prefs: []
  type: TYPE_NORMAL
- en: Volatile versus non-volatile memory
  prefs: []
  type: TYPE_NORMAL
- en: Volatile memory such as RAM is a type of memory that only saves the information
    while it is ON, while non-volatile memory such as hard drives can retain information
    over a very long time, even when they have no power. Therefore, gathering information
    from volatile memory is considered a more complex and specialized task.
  prefs: []
  type: TYPE_NORMAL
- en: Now, let's start by reviewing how to capture data from volatile memory.
  prefs: []
  type: TYPE_NORMAL
- en: Recovering data from RAM
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Due to the hardware nature of RAM, recovering data from RAM is considered a
    very complex task. However, there is one tool and one method we can use to achieve
    this goal. Let's take a look.
  prefs: []
  type: TYPE_NORMAL
- en: Microsoft COFEE
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The **Microsoft Computer Online Forensics Evidence Extractor** (**COFEE**) toolkit
    was developed and distributed by Microsoft to police agencies to help them collect
    digital evidence from Microsoft systems.
  prefs: []
  type: TYPE_NORMAL
- en: The tool is loaded as a live USB and is composed of a **Graphical User Interface
    (GUI)** with more than 150 forensics tools, including data stored on volatile
    memory (RAM).
  prefs: []
  type: TYPE_NORMAL
- en: A copy of this tool was supposedly leaked on the internet in 2009 and if you
    are interested in reviewing it, a simple Google search will give you the link
    to the WikiLeaks page to download it.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs: []
  type: TYPE_NORMAL
- en: Remember that leaked versions of software may contain malicious content, so
    avoid running it on your main computer. Instead, try using a virtual sandbox environment
    and take all the necessary precautions if you decide to download and run this
    type of software.
  prefs: []
  type: TYPE_NORMAL
- en: Cold boot attack
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'This is a super interesting way to gather data right from the RAM. Let me explain
    how it works:'
  prefs: []
  type: TYPE_NORMAL
- en: First, you need physical access to the computer.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open the computer.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Cool down the RAM module (this can be done using a freeze spray).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Cut off the power of the machine.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Boot up the computer using a lightweight USB bootable **Operating System (OS)**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Perform a memory dump using any available memory dump software or script.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: As illustrated in the following diagram, a limitation of this attack is that
    the amount of data that's recovered is proportional to the time required. This
    means that the faster you perform the dump, the more data you can recover.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 16.1 – Correlation between time and data on a cold boot attack'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_16.1_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 16.1 – Correlation between time and data on a cold boot attack
  prefs: []
  type: TYPE_NORMAL
- en: As you can imagine, there is a risk of physically destroying the memory, so
    it is highly recommended that you only use this method in a very controlled space
    (a lab environment). Also, it only works if the computer you wish to examine is
    already on.
  prefs: []
  type: TYPE_NORMAL
- en: What data can be recovered from RAM?
  prefs: []
  type: TYPE_NORMAL
- en: Data that can be recovered from RAM includes unsaved documents, drafted emails,
    passwords, chats, usernames, printed documents (print jobs), settings, network
    or connection settings such as IP and **Service Set Identifier (SSID)**, and more.
  prefs: []
  type: TYPE_NORMAL
- en: Now, let's look at the tools and methods we can use to recover data from non-volatile
    memory.
  prefs: []
  type: TYPE_NORMAL
- en: Recovering information from non-volatile memory
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: There are many tools we can use to recover deleted data from non-volatile memory,
    such as hard drives. Most of them are very easy to use and available with a very
    user-friendly interface on Windows machines, such as **Recuva**.
  prefs: []
  type: TYPE_NORMAL
- en: Additionally, there are more advanced tools such as **Foremost**, which is a
    tool that's loaded on Kali Linux. We covered the configuration and execution of
    Foremost in [*Chapter 5*](B16290_05_Final_JC_ePub.xhtml#_idTextAnchor109), *Cybersecurity
    Technologies and Tools.*
  prefs: []
  type: TYPE_NORMAL
- en: Digital recovery versus physical recovery
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To explain how data recovery works, let me start by explaining how Windows manages
    the files.
  prefs: []
  type: TYPE_NORMAL
- en: Windows uses something called **Master File Table** (**MFT**). This table is
    like the index of a book that tells the **operating system** (**OS**) the location
    of each file by pointing it to the hard drive sector where the file is located.
    This means that when you want to open a file, the OS checks the MFT for where
    the file is located and then retrieves the data from the disk.
  prefs: []
  type: TYPE_NORMAL
- en: 'As illustrated in the following diagram, to make the computer faster, when
    you delete a file, the OS deletes the entry on the MFT so that the sector becomes
    *available* to be used by another file. However, the information remains on the
    hard drive until the OS overwrites that sector with another file:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 16.2 – Windows MFT table structure'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_16.2_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 16.2 – Windows MFT table structure
  prefs: []
  type: TYPE_NORMAL
- en: Therefore, what most digital recovery software does is perform a deep scan of
    the hard drive sectors to recreate the MFT based on the content found on the drive.
    As an analogy, this is like reading a book to recreate its index (table of contents).
  prefs: []
  type: TYPE_NORMAL
- en: There are also cases in which the partition or system becomes corrupted. In
    those cases, the files can easily be retrieved by connecting the hard drive as
    an external drive to another computer and running the recovery software from there.
  prefs: []
  type: TYPE_NORMAL
- en: However, there are cases in which the hard drive becomes physically damaged
    due to all the moving parts that are in constant usage due to rotation and friction,
    as illustrated in the following diagram. Examples of damage can be a bad head,
    a head crash, a scratch, or even damage to the rotor.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs: []
  type: TYPE_NORMAL
- en: In most cases, hard drive damage is progressive, so if you start noticing noises
    coming from the computer that sound like clicking or whirring, then it's time
    to replace the hard drive and save your data before it is too late.
  prefs: []
  type: TYPE_NORMAL
- en: In all those cases, recovery is possible, but only by experts using special
    equipment and a properly setup lab. Also, note that physical recovery is normally
    expensive.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 16.3 – Moving parts of a hard drive'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_16.3_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 16.3 – Moving parts of a hard drive
  prefs: []
  type: TYPE_NORMAL
- en: In regards to **solid-state drives** (**SSDs**), those risks of damage are lower
    because of the absence of moving parts. However, if physical damage does occur,
    the recovery process is more complicated.
  prefs: []
  type: TYPE_NORMAL
- en: Now, let's focus on computer forensics from the point of view of defensive security
    to detect the use, abuse, intrusion, damage, or modification of computer systems,
    servers, networks, infrastructures, or data.
  prefs: []
  type: TYPE_NORMAL
- en: Digital forensics on defensive security
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'When talking about forensics in terms of defensive security, we must perform
    forensics in several fields, including the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Data analysis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Log analysis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Email forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Database forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Malware forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Memory forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mobile forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Network forensics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Now, let's dig deeper into how digital forensics is managed, including the process
    that's involved.
  prefs: []
  type: TYPE_NORMAL
- en: Who should be in charge of digital forensics?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: There are two main ways to manage all this forensics work. While some companies
    have a forensics specialist to deal with all forensics-related tasks, other companies
    train an expert in each field to act as a forensic expert. There is also a forensic
    coordinator who acts as the leader of all forensics activities.
  prefs: []
  type: TYPE_NORMAL
- en: The digital forensics process
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Most companies customize their digital forensics process based on their needs
    and their level of maturity. However, let me present you with the steps that must
    be followed when performing digital forensics:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Data handling and custody**: Managing data during a forensics process is
    *key* to ensuring the success of the results. You need to keep in mind that the
    data that''s collected during this process may be used for prosecution or to take
    any other legal actions, so you *must* ensure that the data is collected based
    on a standard that''s been approved by your justice system.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Additionally, you need to apply the required tools and techniques to ensure
    the data's integrity from when it's collected until it's presented (for example,
    presenting the data as evidence in a court of justice). One of the most common
    methods that's used to demonstrate the integrity of the data is by hashing the
    data that's collected, as mentioned in [*Chapter 5*](B16290_05_Final_JC_ePub.xhtml#_idTextAnchor109),
    *Cybersecurity Technologies and Tools*.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Data collection**: The first step in any forensics process is to collect
    *all* the data from all available sources. This step is incredibly important,
    so much so that we will review this in depth in the upcoming section.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Data analysis**: Here, the analyst starts by filtering the bulk of the information
    so that the analysis will be performed based on relevant information, thus reducing
    unnecessary efforts. Then, they must use a plurality of tools and methods to analyze
    the data that''s been collected. As we mentioned previously, this analysis can
    be done on any type of media storage (volatile or non-volatile) and using techniques
    for digital and physical recovery. The results of the entire forensics process
    rely on the data and devices being analyzed, so this task must be performed by
    a certified professional.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'If you are interested in getting a certification in forensics, I highly recommend
    that you visit this site: [https://i2c2x.com/](https://i2c2x.com/).'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Saving or archiving evidence**: A common error is to delete the evidence
    after the trial. However, that data may still be of value during an appeals process,
    to identify repeat offenders (this could be key to determining whether someone
    is an inadvertent user or a malicious insider), or even in threat intelligence
    to correlate the data against new events to identify further attacks.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Therefore, the best practice is to create a section in your data retention policy
    that determines the required time to archive digital evidence. Notice that in
    some cases, this policy may be influenced by some regulations or laws.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Figure 16.4 – Digital forensics process'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_16.4_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 16.4 – Digital forensics process
  prefs: []
  type: TYPE_NORMAL
- en: Now, it is time to look at some of the platforms that are used to perform digital
    forensics and gather digital evidence.
  prefs: []
  type: TYPE_NORMAL
- en: Forensics platforms
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As we mentioned previously, the forensics process is a very sensitive task that
    must be performed with extreme care to ensure the data that's gathered is preserved
    and that its integrity is guaranteed.
  prefs: []
  type: TYPE_NORMAL
- en: However, this can't be achieved with a single tool. Instead, a forensics specialist
    must select the best tool for each scenario based on a plurality of factors, such
    as the source of the data, the storage type, and the operating system.
  prefs: []
  type: TYPE_NORMAL
- en: The good news is that to make our lives easier, some operating systems have
    been designed exclusively to perform forensics activities that are packed with
    a series of forensics tools.
  prefs: []
  type: TYPE_NORMAL
- en: Additionally, some of those OSes are available as bootable live CDs or live
    USBs, which enables us to perform more advanced forensics.
  prefs: []
  type: TYPE_NORMAL
- en: Now, let's review a collection of some of those forensics OSes.
  prefs: []
  type: TYPE_NORMAL
- en: CAINE
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The **Computer-Aided Investigative Environment** (**CAINE**) is a live GNU/Linux
    distribution that proves a complete forensic environment that incudes existing
    software tools as software modules, plus a friendly GUI that supports forensic
    experts during a digital investigation.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 16.5 – CAINE GUI'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_16.5_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 16.5 – CAINE GUI
  prefs: []
  type: TYPE_NORMAL
- en: As shown in the preceding screenshot, CAINE is preloaded with a considerable
    number of forensic tools ready to use, including **The Sleuth Kit**, **Autopsy**,
    **RegRipper**, **Wireshark**, **PhotoREC**, and more.
  prefs: []
  type: TYPE_NORMAL
- en: Their official page for downloads is [https://www.caine-live.net/](https://www.caine-live.net/).
  prefs: []
  type: TYPE_NORMAL
- en: SIFT Workstation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'SIFT Workstation is a collection of free and open source forensic tools for
    performing detailed digital forensics. There are two ways to install it: one is
    by downloading a virtual machine that is ready to use, while the other is by installing
    it directly on an Ubuntu machine:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 16.6 – SIFT Workstation'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_16.6_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 16.6 – SIFT Workstation
  prefs: []
  type: TYPE_NORMAL
- en: The preceding screenshot shows a VM installation of SIFT, which can be download
    from the SANS web page at [https://www.sans.org/tools/sift-workstation/](https://www.sans.org/tools/sift-workstation/).
  prefs: []
  type: TYPE_NORMAL
- en: PALADIN
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**PALADIN** is a modified *live* Linux distribution based on Ubuntu that simplifies
    various forensics tasks. It comes with a lot of forensics tools divided into 33
    categories, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 16.7 – PALADIN categories of tools'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_16.7_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 16.7 – PALADIN categories of tools
  prefs: []
  type: TYPE_NORMAL
- en: For more information about the available versions of Paladin, you can visit
    their site at [https://sumuri.com/software/paladin/](https://sumuri.com/software/paladin/).
  prefs: []
  type: TYPE_NORMAL
- en: Now that we know about the different tools and platforms for digital forensics,
    let's learn how evidence is obtained and the main sources of data to ensure you
    don't miss a thing during a forensics examination.
  prefs: []
  type: TYPE_NORMAL
- en: Finding evidence
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'As soon as you discover an attack, there are a lot of things that need to be
    done with the utmost priority, including restoring the systems and services that
    have been impacted. However, another critical task is to find and secure all the
    evidence related to the attack. This task is critical as it allows you to do the
    following:'
  prefs: []
  type: TYPE_NORMAL
- en: Determine whether the attack was executed by an insider or outsider.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Determine whether the insider was a malicious insider or an inadvertent user.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Determine the vulnerability exploited by the attacker.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Determine the impact on business data in terms of the **confidentiality**, **integrity**,
    and **availability** (**CIA**) triad.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Determine the systems or services impacted by the attack.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Collect evidence to execute legal or corrective actions (from HR).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Now that you know about the importance of collecting evidence, let's look at
    some best practices regarding the collection process itself.
  prefs: []
  type: TYPE_NORMAL
- en: Sources of data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As you may know, there are a lot of places that you can harvest to gather digital
    information during a forensics process. The most common type of files that you
    need to find are log files as they normally record all the events on the device
    (we covered this topic in [*Chapter 15*](B16290_15_Final_JC_ePub.xhtml#_idTextAnchor350),
    *Leveraging Pentesting for Defensive Security*).
  prefs: []
  type: TYPE_NORMAL
- en: A common mistake is to only check for logs on the servers. However, there are
    a lot of other places that can be a great source of information. We'll look at
    a few in this section, starting with non-volatile memory.
  prefs: []
  type: TYPE_NORMAL
- en: Non-volatile memory
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: As we mentioned earlier, it is possible to obtain data from RAM, so in the case
    of a digital investigation, you may want to do a dump of the RAM to get some extra
    information before executing other actions or shutting down the server.
  prefs: []
  type: TYPE_NORMAL
- en: Deleted data
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: You should also search for traces of deleted data on the hard drive. This is
    especially important for detecting malicious insiders that may try to cover their
    tracks by deleting logs or similar records. In these cases, you may not be able
    to retrieve the deleted information, but you may be able to prove that some logs
    were deleted or altered, and that could become evidence itself.
  prefs: []
  type: TYPE_NORMAL
- en: Routers and other network devices
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: This is probably the second most common place to look for traces after an attack.
  prefs: []
  type: TYPE_NORMAL
- en: Besides looking for unusual activity, you also need to look for signs of log
    alterations, such as deleted entries, as they may be indicators of attacks.
  prefs: []
  type: TYPE_NORMAL
- en: IoT devices
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Normally, IoT log files are overlooked, but they can be a great source of information,
    especially if they were used as the point of entry to your infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: Network printers
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Network printers are normally overlooked, but at the end of the day, they are
    network devices, which means they can potentially be launchpads for attacks. Additionally,
    the security of those devices is weak, and that is exactly why attackers are targeting
    more of those devices.
  prefs: []
  type: TYPE_NORMAL
- en: You will be amazed at all the information that you can collect by checking those
    logs, including previous attempts to break into your network.
  prefs: []
  type: TYPE_NORMAL
- en: Mobile devices
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Mobile devices such as smartphones act as minicomputers and, as such, they can
    also be used as a point of entry into your corporate network.
  prefs: []
  type: TYPE_NORMAL
- en: Therefore, it is important to use monitoring software that collects logs about
    the usage and interactions with mobile devices. If your company has a **Bring
    Your Own Device** (**BYOD**) policy, this becomes of extreme importance as the
    devices are more vulnerable to attacks, so having control over those devices is
    a must.
  prefs: []
  type: TYPE_NORMAL
- en: Forensics on mobile devices is a big topic, so let's review this topic in detail.
  prefs: []
  type: TYPE_NORMAL
- en: Mobile forensics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Mobile Forensics has become one the biggest areas of specialization in forensics
    – not just because almost everyone has a smartphone, but because smartphones can
    collect a huge amount of data.
  prefs: []
  type: TYPE_NORMAL
- en: The cool thing about mobile forensics is that in some cases, *you don't even
    need the phone to gather some of the data that's been collected by your smartphone*.
    Let me show you how.
  prefs: []
  type: TYPE_NORMAL
- en: Deviceless forensics
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Smartphones gather a lot of information, such as location, messages, searches,
    frequently visited places, app usage, browsing history, and more, but the most
    interesting part is that Google (yes, Google) records all that data on their cloud.
    Let''s learn how to access it:'
  prefs: []
  type: TYPE_NORMAL
- en: Go to [https://takeout.google.com](https://takeout.google.com).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Log in with your user credentials.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the data you want to retrieve.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose how you want the files to be delivered (to a drive, cloud storage, or
    via a link for a direct download).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select whether you want to export the files only this time or if you want to
    schedule future exports.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Determine the file type and maximum size per file.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Export**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The export depends on the amount of data that Google has collected about you,
    so take into consideration that in some cases, it could take several hours or
    even a day to export all your data.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 16.8 – Google Takeout page'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_16.8_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 16.8 – Google Takeout page
  prefs: []
  type: TYPE_NORMAL
- en: The type of information depends on the Google services that you use. However,
    while for iPhone users this could be optional, some of the information that's
    collected here applies to all Android users. You may be surprised by the amount
    of data being collected about you. For example, in the exported file, you can
    see not only details about the app's use but when it was used (along with a timestamp).
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are some examples of the data that can be exported:'
  prefs: []
  type: TYPE_NORMAL
- en: Information about IoT devices through Google Home
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Calendar entries (including when they were created and deleted)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Everything about your Google Chrome access (history, settings, and so on)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Information about the files you print (Google Print)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Information about purchases and reservations made using Google Search or Maps
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Images and text published on Google communities
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Contact pictures
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Data about registration and activity on your Google account
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All your biometric data that's been compiled by Google Fit, including sleep
    data, training data, distance walked, and more
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Metadata about your Google searches
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: History of purchases made with Google Pay
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Information about the books you've read or purchased on Google Books (including
    notes and highlights)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Preferences about movies based on Google Play movies (including playlists and
    even the ratings you've provided for each movie)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: History of shopping (including delivery addresses) based on Google Shop
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: History of your chats in Google Hangouts (including attached pictures)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: History of navigation (including preferences and reviews of visited sites) based
    on Google Maps
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Device configuration, performance data, software version, and more (for Android
    devices)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Information about the games you've played (including scores) on Google Play
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installed apps, ratings, and purchases (Google Play)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Your location history (based on the data that's been collected by your GPS)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: History of videos searched and watched on YouTube
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: And more
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Additionally, as shown in the following screenshot, you have extra parameters
    to choose from, such as the format of the data to be exported and the items to
    be included on the export:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 16.9 – Export settings of Google Takeout'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_16.9_B16290.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 16.9 – Export settings of Google Takeout
  prefs: []
  type: TYPE_NORMAL
- en: For iPhone users, things are a bit different because the privacy policy is more
    restrictive than that of Android. This means that gathering information that's
    been saved about the user is more complex. Apple does not have a page like this
    one where the user can request their data, so gathering this type of information
    from an iPhone may involve sending a legal request directly to Apple to get a
    warrant to share that user information.
  prefs: []
  type: TYPE_NORMAL
- en: Important data sources on mobile devices
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As we mentioned previously, a mobile device collects a lot of data that can
    be harvested without even having access to the phone. However, if you have access
    to the phone, you may be able to gather even more information.
  prefs: []
  type: TYPE_NORMAL
- en: 'While most books will tell you to gather files such as pictures, calls, messages,
    and other easily identifiable data, there is a lot more data that can be harvested
    from a mobile device. So, let''s look at my checklist of data to be harvested
    from mobile devices:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Wi-Fi connection data (including a list of known SSIDs)**: This could be
    very useful in confirming whether the user was at a given place or trying to connect
    to an unauthorized network.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Bluetooth connection data**: This can help determine whether an unapproved
    device was connected.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**OS installation details**: This data is very useful for determining whether
    the device was recently restored to its factory defaults, which can be used as
    proof that the device data was wiped out.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**App list**: This can be used to determine whether unauthorized software was
    installed on the device. For example, this could become especially useful for
    determining whether third-party software that was installed by an inadvertent
    user was vulnerable or used to leak any data from the device.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**OS updates information**: This is very useful for determining whether the
    device was breached or attacked due to a lack of some security being updated in
    the OS, or even to demonstrate that the device is still vulnerable, even after
    being fully patched (which may reveal the presence of a zero-day attack).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Rooting, jailbreaking, and other OS modifications**: It is very important
    to look for traces of jailbreaking or any other unauthorized OS modifications
    as this could represent a breach of corporate policy. This could also be the reason
    why the device was breached (and an explanation about why the device was unable
    to prevent the attack).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**USB connection metadata**: This can help you determine whether the device
    was connected to an authorized device and whether data exfiltration was performed
    or attempted.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Cloud storage apps and users**: This information can be used during an investigation
    to determine whether data was exfiltrated to personal cloud storage services (Dropbox,
    box, OneDrive, and so on).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This checklist is device-agnostic, but the tools and methods that are used to
    gather that data vary between devices, OSes, brands, models, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs: []
  type: TYPE_NORMAL
- en: Depending on the device's OS, this data can be stored by the user. So, it is
    important to ensure that this gathering activity is performed on all users of
    the device.
  prefs: []
  type: TYPE_NORMAL
- en: Transporting mobile devices
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Many solutions enable you to remotely delete files on a mobile device. Therefore,
    to avoid any external manipulation of the device, it is recommended to use a **faraday
    cage** to block any incoming signals and avoid the data on the device being modified.
  prefs: []
  type: TYPE_NORMAL
- en: Now it is time to look at some guidelines and international best practices regarding
    managing digital evidence to ensure it can be used in a legal process as valid
    evidence.
  prefs: []
  type: TYPE_NORMAL
- en: Managing the evidence (from a legal perspective)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*"We must adapt to the digital age and the chain of custody must be also maintained
    when dealing with digital evidence."*'
  prefs: []
  type: TYPE_NORMAL
- en: '*– Lawyer, Angelith Alfaro*'
  prefs: []
  type: TYPE_NORMAL
- en: As we mentioned previously, the very first step when performing forensics is
    to ensure that the data that's been collected is handled and stored properly.
    Otherwise, the data may not be admissible in a trial or other legal procedure.
  prefs: []
  type: TYPE_NORMAL
- en: Some countries may have different regulations or frameworks that must be followed
    to use digital evidence. However, let me share some of the most common guidelines
    and regulations in regards to digital evidence that are used around the world.
  prefs: []
  type: TYPE_NORMAL
- en: ISO 27037
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The ISO/IEC 27037:2012 provides guidelines about identifying, collecting, acquisitioning,
    and preserving digital evidence.
  prefs: []
  type: TYPE_NORMAL
- en: 'The last version was revised in 2018 and it allows you to identify, collect,
    acquire, and preserve data from a plurality of devices, including, but not limited
    to, the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Digital storage (non-volatile)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mobile devices
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: GPS navigation devices
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Digital cameras (including CCTV)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Network devices
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If you want to find out more about this standard, you can visit their official
    site at [https://www.iso.org/standard/44381.html](https://www.iso.org/standard/44381.html).
  prefs: []
  type: TYPE_NORMAL
- en: Digital Evidence Policies and Procedures Manual
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The US National Institute of Justice created this manual in 2020 to give law
    enforcement agencies a guide for developing policies and procedures for collecting,
    handling, and processing digital evidence:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://nij.ojp.gov/library/publications/digital-evidence-policies-and-procedures-manual](https://nij.ojp.gov/library/publications/digital-evidence-policies-and-procedures-manual).'
  prefs: []
  type: TYPE_NORMAL
- en: FBI's Digital Evidence Policy Guide
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'This is the policy that''s used by the **Federal Bureau of Investigation**
    (**FBI**) for handling, reviewing, and processing digital evidence that''s been
    collected during investigations: [https://vault.fbi.gov/digital-evidence-policy-guide](https://vault.fbi.gov/digital-evidence-policy-guide).'
  prefs: []
  type: TYPE_NORMAL
- en: Regional Computer Forensics Laboratory
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The **Regional Computer Forensics Laboratory** (**RCFL**) program is a partnership
    between the FBI and other US federal, state, and local law enforcement agencies
    that provides forensic services and expertise to support law enforcement agencies
    in collecting and examining digital evidence.
  prefs: []
  type: TYPE_NORMAL
- en: 'They published a *Digital Evidence Field Guide* aimed to serve as a guide about
    handling digital evidence properly. The guide can be found here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://www.rcfl.gov/file-repository/fieldguide_sc.pdf/view](https://www.rcfl.gov/file-repository/fieldguide_sc.pdf/view).'
  prefs: []
  type: TYPE_NORMAL
- en: US Cybersecurity & Infrastructure Security Agency
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The US **Cybersecurity & Infrastructure Security Agency** (**CISA**) published
    a guide to forensics that includes references to applicable laws in the US, as
    well as a collection of useful links regarding forensics:'
  prefs: []
  type: TYPE_NORMAL
- en: https://us-cert.cisa.gov/sites/default/files/publications/forensics.pdf.
  prefs: []
  type: TYPE_NORMAL
- en: RFC 3227 – Guidelines for Evidence Collection and Archiving
  prefs: []
  type: TYPE_NORMAL
- en: 'The **Internet Engineering Task Force** (**IETF**) published the RFC 3227 –
    *Guidelines for Evidence Collection and Archiving*, which can be found at the
    following link: [https://datatracker.ietf.org/doc/html/rfc3227](https://datatracker.ietf.org/doc/html/rfc3227).'
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Digital forensics is a big topic. There are even bachelor's degrees in digital
    forensics, which confirms how extensive and complex this topic is.
  prefs: []
  type: TYPE_NORMAL
- en: However, this chapter aimed to give you a deep overview of the topic, plus some
    considerations that you must follow in case you need to oversee a digital investigation
    (forensics) in your company.
  prefs: []
  type: TYPE_NORMAL
- en: So, in this chapter, you learned about the different types of forensics, as
    well as the different sources of data that you must review during an investigation.
  prefs: []
  type: TYPE_NORMAL
- en: Additionally, we reviewed the best practices surrounding gathering data and
    how to manage it properly from a legal point of view.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, we looked at the uniqueness of mobile forensics and some best practices
    associated with it.
  prefs: []
  type: TYPE_NORMAL
- en: Now, it is time to move on to another interesting chapter, in which we will
    learn how to apply automation to enhance our defensive security strategy.
  prefs: []
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If you want to get a specialized degree in forensics, there are bachelors as
    well as certifications in this field. For more information, visit the following
    sites:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://i2c2x.com/](https://i2c2x.com/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://www.ubalt.edu/cpa/undergraduate-majors-and-minors/majors/cyber-forensics/](https://www.ubalt.edu/cpa/undergraduate-majors-and-minors/majors/cyber-forensics/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
