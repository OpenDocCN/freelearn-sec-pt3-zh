<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Windows 10 Forensics</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will cover the following recipes:</p>
<ul>
<li>Parsing Windows 10 Notifications</li>
<li>Cortana forensics</li>
<li>OneDrive forensics</li>
<li>Dropbox forensics</li>
<li>Windows 10 mail app</li>
<li>Windows 10 Xbox app</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p>The advent of Windows 10 has caused controversy among users and forensic investigators alike. Many end users have concerns regarding privacy and security, since the privacy settings that are automatically set up on devices with Windows 10 are not at all strong. Others have expressed concerns about the way Windows machines are now forcing users to migrate to Windows 10, even if they are happy with their current versions.</p>
<p>From a forensic perspective, Windows 10 presents a number of new and unique challenges. Most of the programs have been modified to look and feel more like the applications you would see on a smartphone or tablet, and a lot of them behave quite differently from their predecessors. The advent of Cortana has given forensic investigators even more data to work with, and the amount of data has also increased in line with the interconnected nature of many of the applications.</p>
<p>In this chapter, we will look at a few of the common features of Windows 10, and how forensic analysts can work with it.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Parsing Windows 10 Notifications</h1>
                </header>
            
            <article>
                
<p>Windows 10 features notifications, called <em>Toast</em> notifications, which pop up in the bottom right of the screen. These can be set up for a number of different requirements, but are on by default for news relating to application updates and security.</p>
<p>It is possible for users to set up notifications to remind themselves of tasks, as well as events and email alerts. In this chapter, we will look at the usefulness of Windows 10 notifications in forensic investigations, and how to parse them.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Details of notifications are stored in the following location:</p>
<p><kbd>\Users\Username\AppData\Local\Microsoft\Windows\Notifications</kbd></p>
<p>The name of the database will differ depending on the build version of Windows 10 installed on the machine. From Anniversary onwards, they are stored in <kbd>wpndatabase.db</kbd>; before that, they can be found in <kbd>appdb.dat</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>The steps to be followed for parsing Windows 10 notifications are as follows:</p>
<ol>
<li><span>Download a SQLite manager if you do not have one.</span></li>
<li>Open your SQLite manager and click <span class="packt_screen">Open Database</span>.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="194" width="138" class="image-border" src="assets/80602cca-3eb2-4bc4-a970-913aec310887.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 10.1. Adding a database</div>
<ol start="3">
<li>Browse to <kbd>C:\Users\Username\AppData\Local\Microsoft\Windows\Notifications</kbd> and find the <kbd>.db</kbd> file in the folder. Open it.</li>
</ol>
<div class="packt_figref CDPAlignCenter CDPAlign"><img class="image-border" src="assets/46988caf-91f6-4b1f-904a-f3e7aff7fb1c.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 10.2. The notifications database file</div>
<p style="padding-left: 60px" class="mce-root">This will show you which notifications have popped up, along with their RecordIDs, which can be used to identify other instances of these programs.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>A SQLite viewer will show you which programs have notifications popping up on a regular basis, and which have been disabled.</p>
<ul>
<li>In the example below, the user has seen 20 Toast notifications - the small rectangular boxes that pop up in the bottom right of the screen. However, there have only been five title notifications. This refers to an application's icon as seen on the Start menu. If the number of tile notifications is very low, this probably means that the user has unpinned a number of programs from the Start menu.</li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img height="295" width="471" class="image-border" src="assets/e1099d51-877c-4d48-9b92-b86227ec28d1.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 10.3. Notifications a user has seen</div>
<ul>
<li>The preceding image shows that the user has only seen one <em>Badge</em> notification. These are small numbers that pop up on the taskbar alongside a program - a bit like the little numerical values you see next to the notifications icons on Facebook or Twitter.</li>
</ul>
<div class="packt_figref CDPAlignCenter CDPAlign"><img height="470" width="480" class="image-border" src="assets/d51fc342-3c52-4d77-b20d-7ee211af2fc2.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 10.4. Tiles on the Start menu</div>
<ul>
<li>If you have turned off icons on the taskbar, you may see these notifications when you click on the up arrow next to the Wi-Fi and volume signs.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<ul>
<li>SQLite Expert download: <a href="http://www.sqliteexpert.com/download.html" target="_blank">http://www.sqliteexpert.com/download.html</a><a href="http://www.sqliteexpert.com/download.html" target="_blank"/></li>
<li>DB Browser for SQLite: <a href="http://sqlitebrowser.org/" target="_blank">http://sqlitebrowser.org/</a></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Cortana forensics</h1>
                </header>
            
            <article>
                
<p class="mce-root">Cortana is Microsoft's voice-activated assistant, but it does much more than just respond to commands. Cortana links in across different devices, giving reminders when required and <em>getting to know</em> the user. It can recognize an individuals voice and handwriting, among other things. For this reason, many Windows users have turned the Cortana function off due to privacy concerns - particularly because, by default on some machines, Cortana is always on, even when the machine is in sleep mode.</p>
<p class="mce-root">Cortana can also respond to specific occurrences - for example, a user can instruct Cortana to remind them to say something to a person next time they call. This is undoubtedly a useful tool for many, and also a mine of forensic information.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p class="mce-root">Forensically speaking, the most interesting tidbits of information when it comes to Cortana can be found in the following location: <kbd>C:\Users[User]\AppData\Local\Packages\Microsoft.Windows.Cortana_xxxx\LocalState\ESEDatabase_CortanaCoreInstance\CortanaCoreDb.dat</kbd></p>
<p class="mce-root">Here you will be able to uncover information such as the locations the user has been in, the reminders they have set, where and when those reminders were triggered, and where and when the reminders were marked as complete.</p>
<p class="mce-root">This can be of particular interest if your case hinges on putting someone in a certain place at a certain time. Likewise, a reminder that has not been marked as complete may demonstrate that the users plans changed at the last minute.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p class="mce-root">You will need a SQLite browser to access the database.</p>
<ol>
<li class="mce-root">Once you have started up your SQLite browser and accessed the database, you will be able to see a table of values which will include useful items such as Contact Permissions and Locations.</li>
<li class="mce-root">You can work with this database directly in your SQLite browser, or you can export it to a CSV document which can then be opened with Microsoft Excel, Google Sheets or another program of your choice.</li>
</ol>
<ol start="3">
<li class="mce-root">It is worth noting that some of the data in the <kbd>CortanaCoreDb.dat</kbd> file may be obscured. Depending on what you are looking for, once you have opened the file to ensure it contains some data, you may wish to run it through a more sophisticated forensic program to uncover the data.</li>
<li class="mce-root">The <kbd>Reminders</kbd> section of <kbd>CortanaCoreDb.dat</kbd> is concerned with calendar reminders, which can be a useful way to demonstrate a users intentions. For example, they may have set a reminder to tell them to go to a given location at a set time, which may place them near a crime scene. If this is then teamed up with actual location data from the <kbd>CortanaCoreDb.dat</kbd> <kbd>LocationTriggers</kbd> section, it can be either damning or absolving evidence.</li>
</ol>
<p class="mce-root">It is a good idea to go thoroughly through all the items in the <kbd>Cortana</kbd> folder at the path mentioned above. The most relevant data is likely to be contained in <kbd>CortanaCoreDb.dat</kbd>, however there are certain items - such as geolocation searches and some dictation records - that may be found in other parts of the folder. As always with forensic examination, it is worth digging through the evidence with a fine-toothed comb, at least insofar as time allows.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p class="mce-root">Cortana works by essentially <em>listening</em> to, and being aware of, everything that is going on around a computer at a given time. This is even the case when the computer is locked, which is particularly of interest in forensic investigations. Often a computer user - especially with a laptop - will leave their computer on but with the screen sleeping for long periods of time, essentially forgetting that it is still turned on.</p>
<p class="mce-root">While this has caused understandable consternation among privacy advocates and members of the general public, it can be hugely useful for investigative purposes. Snippets of conversations, data about the location of the user, voice searches, reminders, and which device a person is using can all be uncovered through the methods detailed previously and can provide priceless clues to a persons actions and motivations.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>Bhupendra Singh; <em>A Forensic insight into Windows 10 Cortana Search</em>; <em>Computers &amp; Security Vol. 66</em>, May 2017</p>
<p>Thomas Rose; <em>A Forensic Investigation of the Windows Search Feature, Cortana and the Notification Centre in Windows 8/8.1 and Windows 10</em>; BSc dissertation 2016</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">OneDrive forensics</h1>
                </header>
            
            <article>
                
<p class="mce-root">OneDrive is Microsoft's cloud service, which allows users to save their data on the cloud and access it from any machine, as long as they are logged in with their Microsoft account. Featuring Word, Excel, PowerPoint, Outlook, a calendar, contacts, and more, this is a straightforward way for users of Microsoft products to ensure that they never lose access to their documents. It is also a great source of information and data in forensic investigations.</p>
<p class="mce-root">One way in which OneDrive is especially useful to forensic investigators is in instances where a particular device cannot be accessed for one reason or another. For example, perhaps a phone has been seized, but it is locked and the passcode cannot be retrieved; or perhaps a computer has a password that has proven too difficult to bypass. In these instances, if the investigator can gain access to a different device owned by the same user, they can often find useful tidbits of information in the OneDrive backup files.</p>
<p class="mce-root">In the Windows 10 operating system, OneDrive is the default location to save new files, rather than these being saved in My Documents on the local computer, which was previously the default. This means that, unless the user has manually changed their settings, there should be a wealth of forensic information available via OneDrive.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p class="mce-root">First of all, it is important to work out how you are going to access your OneDrive files. Do you have access to the Windows 10 machine itself, or are you looking at an Android backup?</p>
<p class="mce-root">If you are accessing OneDrive using an Android phone, you will find what you need in <kbd>/mnt/sdcard/Android/data/</kbd> under the <kbd>com.microsoft.skydrive</kbd> folder. OneDrive's predecessor was called SkyDrive, hence the name.</p>
<p class="mce-root">If you are accessing OneDrive data using a PC or a laptop running Windows 10, you will find what you need in <kbd>C:\Users\&lt;USERNAME&gt;\AppData\Local\Microsoft\OneDrive\logs</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>The following steps need to be followed to perform forensics on OneDrive:</p>
<ol>
<li class="mce-root">Open your forensic software of choice and navigate to the relevant folder, depending on whether you are using a smartphone or a computer for forensic analysis (see the previous paragraphs for details).</li>
<li class="mce-root">The backend of the OneDrive folder is actually not of particular forensic interest. In the <kbd>logs</kbd> folder listed above you will find two subfolders: <kbd>Common</kbd> and <kbd>Personal</kbd>. The <kbd>Common</kbd> folder lists all elements the operating system automatically runs, namely <kbd>StandaloneUpdater</kbd> and <kbd>telemetryCache</kbd> files. These refer to automated updates to OneDrive.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="684" width="473" class="image-border" src="assets/3d6bf499-d95e-4886-9362-8da8817b73b7.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Fig 10.5 StandaloneUpdater and telemetryCache files in the Common folder</div>
<ol start="3">
<li>The <kbd>Personal</kbd> folder contains <kbd>SyncEngine</kbd>, <kbd>telemetryCache</kbd> and <kbd>TraceArchive</kbd> files. These files are updated automatically every few days. Generally, what can be found in them is not of great forensic interest; they are simply automated backups of the users computer, but the files themselves do not contain any information. The only potential forensic application would be to demonstrate lack of use: for example, a frequent computer user who had disappeared and not turned on any of their Windows machines would show an unusual lack of activity in the OneDrive log files. The files are as shown in the following screenshot:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="457" width="506" class="image-border" src="assets/fba04b95-f38b-47ac-9cec-ff945da12c3b.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Fig 10.6. Files found within the Personal folder</div>
<ol start="4">
<li>Of course, the frontend of OneDrive is quite another matter. This has a wealth of information available to forensic examiners if they are able to access it. OneDrive files themselves are generally not password-protected, so all you will need is the pass code for the device on which they are being accessed in order to proceed.</li>
<li class="mce-root">There is also a Windows OneDrive app on the iTunes app store, so if you know that the subject of your investigation uses a mixture of Windows and Apple machines, this is worth looking out for.</li>
</ol>
<p class="mce-root">There are no restrictions to the types of files that can be uploaded to OneDrive. However, the most common ones are those in the Microsoft Office suite: Word documents, Excel spreadsheets, PowerPoint presentations and so on. OneDrive files are not stored on the local machine, but can be accessed there using the OneDrive app. They can also be accessed using a web browser, as long as the computer is connected to the internet. As well as computers and smartphones, OneDrive files can also be accessed from Xbox consoles.</p>
<p class="mce-root">Any forensic software that can open traditional Microsoft Office files will be able to extract OneDrive files for viewing. Once the information within the files has been compared with metadata such as the last accessed date and time, it is possible to construct a more thorough outline of the case.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p class="mce-root">OneDrive works slightly differently depending on whether a user has a Personal or Business account, and it is important to understand these differences as they may have a bearing on your forensic investigation.</p>
<p class="mce-root">When OneDrive syncs a file from your computer to the cloud, there is a small modification that takes place in OneDrive for Business. This version of OneDrive automatically adds a few lines of code to the beginning of documents when they are uploaded. This has strong forensic implications as it means that the original MD5 hashes don't match, and can also mean that the files themselves grow slightly larger in size. This appears to happen whenever such a file is opened, even if no modifications are made - it is part of the automated syncing process. So, if you are analyzing a OneDrive for Business file, make sure you account for this as part of your process, or you may end up with some sticky questions should the case go to court!</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>Daryabar, Farid; Dehghantanha, Ali; Eterovic-Soric, Brett &amp; Choo, Kim-Kwang Raymond; <em>Forensic Investigation of OneDrive, Box, GoogleDrive and Dropbox Applications on Android and iOS Devices</em>; <em>Australian Journal of Forensic Sciences</em>, 48:6, 615-642, DOI: 10.1080/00450618.2015.1110620</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Dropbox forensics</h1>
                </header>
            
            <article>
                
<p>In an apparent attempt to make user transition between smartphones, tablets, and PCs more fluid, in version 8 and up, Microsoft have renamed their programs <em>applications</em> and have given the desktop a more smartphone-like feel.</p>
<div class="CDPAlignCenter CDPAlign"><img height="384" width="393" class="image-border" src="assets/fcd55d0e-5bfb-4ccf-b372-82768afe0a27.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Fig 10.7. The Start menu now includes Tiles, which gives the computer more of a smartphone feel</div>
<p class="mce-root">Rather than downloading programs from a web browser, users can now shop for apps - many of which are free - that make for a smoother user experience.</p>
<p class="mce-root">Dropbox is a file sharing application that allows users to upload files of almost any type and easily share them with others. All that is required is an email address to sign up. In 2016, Dropbox had 500 million users worldwide, and this number is climbing.</p>
<p class="mce-root">Forensically, file sharing between users can provide a wealth of helpful information. Lets have a look at how to glean data from the Dropbox app.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p class="mce-root">Most of the Dropbox information you will require can be viewed with a simple SQLite browser, like the one we used in the section on Cortana forensics above.</p>
<p class="mce-root">However, some of the more interesting information may be encrypted, and to access that we will need a Dropbox decryptor. Magnet Forensics provide a free one which can be downloaded from their website, a link to which can be found at the end of the recipe.</p>
<p class="mce-root">You will find all Dropbox-related information in <kbd>C:\Users\&lt;USERNAME&gt;\AppData\Local\Microsoft\Dropbox.</kbd></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>The steps to be followed for dropbox forensics are as follows:</p>
<ol>
<li class="mce-root">Open your SQLite browser and navigate to: <kbd>C:\Users\&lt;USERNAME&gt;\AppData\Local\Microsoft\Dropbox</kbd>. You will find several <kbd>.db</kbd> files contained within this folder.</li>
<li class="mce-root">The most interesting file in the folder is <kbd>filecache.db</kbd>. This lists all files and folders within the Dropbox account, as long as they have not been deleted. You can find details of how large each file is in <kbd>sigstore.db</kbd> in the same folder. The <span>filecache database is encrypted by default, but this is one of those that can be decrypted by Magnet's Dropbox Decryptor, which will allow you to see not only the file names but also any associated metadata.</span></li>
</ol>
<ol start="3">
<li>The Dropbox Decryptor will also uncover information from the <kbd>config.db</kbd> file, including the email address the account owner used to register, and a list of files that have recently been changed. This is particularly of interest in investigations where a person may be trying to cover their tracks. In some cases, Dropbox files will have been deleted. Deleted files are not kept on the local machine and so cannot be accessed strictly through Windows 10 forensic methods. However, if you know the username and password for the account, the web-based version of Dropbox does keep these files in the cloud. The amount of time for which they are kept depends on the type of account: for free accounts, deleted files are kept for 30 days; for premium (paid) accounts, they are kept forever.</li>
<li class="mce-root">Finding deleted files is easy on Dropbox. All you need to do is hover over the <span class="packt_screen">Show deleted files</span> option on the right-hand side of the page.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="230" width="914" class="image-border" src="assets/858f0e72-bb53-47e2-a71c-cfb189b8fa82.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Fig 10.8. An option allows users to see deleted files</div>
<p style="padding-left: 60px">Once you can see the file that has been deleted, you can then click on <span class="packt_screen">Restore</span> to view it. This will bring up a little box where it is worth clicking on the <span class="packt_screen">View other versions</span> link under the main text as shown in the following screenshot:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="159" width="388" class="image-border" src="assets/1584c26d-c7f9-4ae0-abdb-5abb251d2cfe.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Fig 10.9. The 'View other versions' option can be forensically helpful</div>
<p style="padding-left: 60px">The following screenshot shows you how many versions of a file there have been, when they were edited, and when the file was deleted:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="324" width="498" class="image-border" src="assets/54354aae-bb39-4328-94f4-10f68eb46a12.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Fig:10.10 . You will be able to see names and modification dates of file versions</div>
<p style="padding-left: 60px">Clicking on each of these in turn will show you a preview version of the file itself, which can then be compared against other versions:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="93" width="455" class="image-border" src="assets/a7258454-25d7-48b5-bccb-72ab29c146b7.png"/></div>
<p style="padding-left: 60px">The two versions may be quite different even if they have the same file names, as you can see by comparing the figures:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="126" width="573" class="image-border" src="assets/61852e69-2469-4c3c-aebb-9229560e1615.png"/></div>
<p style="padding-left: 60px" class="mce-root CDPAlignLeft CDPAlign">It is then possible to see the contents of each file version</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p class="mce-root">Dropbox essentially works by backing up files on the cloud, although unlike certain other cloud-based applications, it only does so when a user manually adds a file, rather than automatically updating the contents of a machine. This can be useful for demonstrating intent.</p>
<p class="mce-root">Dropbox forensic techniques work by accessing either the databases left by the Dropbox application on the Windows machine, or by the investigator gaining access to the online Dropbox account and sifting through the files contained within.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>Magnet Forensics Dropbox Decryptor: <a href="https://www.magnetforensics.com/free-tool-dropbox-decryptor/">https://www.magnetforensics.com/free-tool-dropbox-decryptor/</a> (accessed 05/07/17)</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Windows 10 mail app</h1>
                </header>
            
            <article>
                
<p class="mce-root">The Windows 10 Mail app is similar to previous apps in terms of user experience, however there is a number of forensic differences. The main one is the way in which emails are stored. They are no longer saved as <kbd>.eml</kbd> files; rather, they are now saved as HTML or <kbd>.txt</kbd> files.</p>
<p class="mce-root">Another neat feature in the new Mail app is the ability to connect to multiple accounts. Much like Gmail, Mail now comes with the ability to switch between different accounts - and users can now add other email providers such as Gmail and Yahoo to their Microsoft Mail apps.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p class="mce-root">Several forensic tools will be able to extract data from the Mail app. In this example, we are going to talk about FTK Imager, but the process of extracting data and especially elements such as file paths and folder locations, will be the same regardless of which tool you prefer to use.</p>
<p class="mce-root">First of all, open up FTK Imager and add a new evidence item. The data you are looking for will be in the <kbd>\Users\Username\AppData\Local\Comms</kbd> folder.</p>
<p class="mce-root">Opening this folder, you will see five subfolders: <kbd>Temp</kbd>, <kbd>Unistore</kbd>, <kbd>UnistoreDB</kbd>, <kbd>UserDataTempFiles</kbd>, and <kbd>Volatile</kbd>. These are the locations we will be looking at in this chapter.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>The <kbd>data</kbd> folder contains a wealth of useful information, but it is sequestered away in subfolders:</p>
<div class="CDPAlignCenter CDPAlign"><img height="253" width="90" class="image-border" src="assets/4e0103ce-c2d0-4e34-990c-5cb3d8a87387.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Fig 10.11 Some of the subfolders within the ‘data folder</div>
<ol>
<li class="mce-root">The subfolders we are particularly interested in for the purposes of this chapter are 3 and 7, which refer respectively to mail and attachments. Within these subfolders are more subfolders, each ones name corresponding to a letter of the alphabet. It is inside these folders that the data we are looking for can be found.</li>
<li class="mce-root">Since the emails are now stored in HTML or plain text, it is easy to view their contents. Simply click on the <kbd>.dat</kbd> files within the alphabetically-named subfolders and you will be able to see a preview of the message within FTK. To view any attachments, navigate to folder <kbd>7</kbd> and go through its alphabetical subfolders. These messages and attachments can then be exported into a report for your client.</li>
</ol>
<p style="padding-left: 60px" class="mce-root">Some emails are not sent, and bits of these may be found in the <kbd>UserDataTempFiles</kbd> folder in <kbd>\Users\Username\AppData\Local\Comms</kbd>. This data is volatile and frequently overwritten, so there may not be anything useful in there. However, on occasion you will find fragments of messages from which certain information may be extracted.</p>
<ol start="3">
<li class="mce-root">One final noteworthy element in the Mail app is the <kbd>People</kbd> folder. This contains all the contacts to whom a user has sent emails to in the past. You can access this data in <kbd>\Users\Username\AppData\Local\Comms\UniStoreDB\store.vol\Contact</kbd></li>
</ol>
<p style="padding-left: 60px" class="mce-root">The three most interesting elements here are the <kbd>Contacts.txt</kbd> and <kbd>Pcontacts.txt</kbd> files, which show the names and email addresses of the users contacts. If they have stored extra information, such as a contacts address or telephone number, this will also be available in plain text within these files.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p class="mce-root">The Mail app is native to the users machine, although an increasing number of people are moving to Microsoft's cloud-based service instead, which as discussed in the previous section presents certain forensic challenges.</p>
<p class="mce-root">Basic information, such as contacts with whom the user frequently interacts, is stored in the <kbd>\Users\Username\AppData\Local\Comms</kbd> folder so that it can be easily recalled when the user wants to send a new message. Luckily, this also makes it available for forensic investigation!</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Windows 10 Xbox App</h1>
                </header>
            
            <article>
                
<p>As the name suggests, Windows 10's Xbox application allows users to play Xbox games on their Windows 10 machines. At first glance, this may not sound like a particularly forensically interesting source of information. However, looking under the hood we can find a wealth of data that can be leveraged in investigations. This section will take you through how to do that.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p class="mce-root">The information we are looking for can all be found in the <kbd>Packages</kbd> directory at the following location:</p>
<p class="mce-root"><kbd>\Users\Username\AppData\Local\LocalState\ModelManager</kbd></p>
<p class="mce-root">You are looking for the <kbd>Xboxlivegamer.xml</kbd> file, which contains information that may be relevant to your case. Also, since Xbox is a gaming platform and many people use it only for leisure purposes, it is one location a user may have overlooked if they have taken anti-forensic measures.</p>
<p class="mce-root">Since the vast majority of the files we will be looking at are <kbd>.xml</kbd> files, you do not need any extra forensic software to access the data. However, most well-known softwares, such as FTK, EnCase and so on, will be able to examine the files and their metadata.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>The steps to be followed for Windows 10 Xbox app forensics are as follows:</p>
<ol>
<li class="mce-root">Navigate to the location listed above and browse through the file list.</li>
<li class="mce-root">Within <kbd>Xboxlivegamer.xml</kbd> you will find the users profile details, including their avatar and email address.</li>
<li class="mce-root">Going down one subfolder, into <kbd>\Users\Username\AppData\Local\LocalState\ModelManager\People</kbd>, will allow you to look at social connections.</li>
<li class="mce-root">To find details of contacts, including messaging, relationships, and information about their friends, you will need to look at the <kbd>.xml</kbd> file that is named after the users Xbox ID. You can find this ID in the <kbd>Xboxlivegamer.xml</kbd> file.</li>
</ol>
<ol start="5">
<li class="mce-root">Along with all the usual data on friends, you should also be able to see the listed locations of friends, which can be particularly interesting if you are trying to establish whether a person is linked in any way to a specific place.</li>
<li class="mce-root">A very useful place to look is in the <kbd>Messaging</kbd> subfolder, which contains details of all messages sent and received, including timestamps, the users who sent or received them, and the messages themselves in plain text:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="111" width="367" class="image-border" src="assets/2de00045-bb65-4f2b-ad08-bee7e1e75b66.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Fig:10.11.Message data from the Xbox app</div>
<ol start="7">
<li class="mce-root">Recording gameplay is something a lot of users do, either to post it on the internet later or to refine techniques, or simply to share it with friends. However, some people also use this handy built-in feature of the Xbox app to record their screens when running various other applications. You can find the recorded gameplay data in <kbd>\Users\Username\XboxApp\GameDVR\OnThisPC</kbd><span>. Within this folder you should see a subfolder called</span> <kbd>Videos</kbd><span>, which in turn contains a folder called</span> <kbd>Captures</kbd><span>. You will then be able to open and play these videos.</span></li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>The Xbox app essentially brings the experience of an Xbox gaming environment to a Windows 10 PC. It stores data in plain text and as original video files, making it a repository of useful information in forensic examinations.</p>


            </article>

            
        </section>
    </body></html>