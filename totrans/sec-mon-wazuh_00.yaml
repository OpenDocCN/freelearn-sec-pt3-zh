- en: Preface
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Hi there! Welcome to *Security Monitoring Using Wazuh*. In this book, we will
    explore the realm of security operations and management using Wazuh – an open
    source security platform that unifies **Security Incident and Event Management**
    (**SIEM**) and **Extended Detection and Response** (**XDR**) capabilities – to
    enhance threat detection, incident response, threat hunting, and compliance management
    within your organizations.
  prefs: []
  type: TYPE_NORMAL
- en: Wazuh combines powerful features such as intrusion detection, log analysis,
    file integrity monitoring, vulnerability detection, and security configuration
    assessment into a unified solution.
  prefs: []
  type: TYPE_NORMAL
- en: 'I will provide relevant information and guide you through the deployment of
    the Wazuh system, its integration with several third-party security tools, and
    practical use cases. My expertise in open source derives from two primary sources:'
  prefs: []
  type: TYPE_NORMAL
- en: A decade of experience in consulting and constructing open-source security solutions
    within enterprise networks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Insights gleaned from podcasts, interviews, and discussions with industry experts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The demand for open-source security tools such as Wazuh is fueled by their affordability,
    community support, and flexibility, helping organizations to enhance threat detection,
    incident response, security monitoring, threat intelligence, and compliance management.
    Learning and gaining hands-on experience with tools such as Wazuh can significantly
    help aspirant security analysts or professionals in enhancing their skills in
    intrusion detection, log analysis, incident response, vulnerability management,
    and custom scripts, directly from a single platform. Engaging with open source
    communities helps you develop network opportunities and continuous learning, positioning
    you to become a valuable individual in the cybersecurity industry.
  prefs: []
  type: TYPE_NORMAL
- en: Who this book is for
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Security analysts, SOC analysts, and security architects can gain practical
    insights into how to set up a Wazuh platform and leverage it to improve an organization’s
    security posture.
  prefs: []
  type: TYPE_NORMAL
- en: 'The three main target audiences for this book are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Security engineers**: For security engineers, this book offers comprehensive
    guidance on deploying and configuring Wazuh for intrusion detection, malware detection,
    security monitoring, and so on.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Security architects**: They will gain information on designing security infrastructure
    with Wazuh as a core component, enabling them to build a scalable and compliant
    security solution that effectively mitigates risk and delivers real-time alerts.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**SOC analyst**: They will benefit from practical insights and real-world use
    cases on the Wazuh platform. They will learn to analyze security alerts, create
    custom Wazuh rules and decoders, and respond promptly to threats.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What this book covers
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[*Chapter 1*](B19549_01.xhtml#_idTextAnchor014), *Intrusion Detection System
    (IDS) Using Wazuh*, provides fundamentals on IDSs and Suricata and its capabilities
    and features, installing Wazuh and setting up Suricata, utilizing Suricata in
    threat detection, handling network scanning probes, identifying Metasploit exploits,
    simulating web-based attacks with DVWA, and measuring NIDS effectiveness with
    tmNIDS.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 2*](B19549_02.xhtml#_idTextAnchor042), *Malware Detection Using Wazuh*,
    introduces you to malware, using FIM for detection, integrating VirusTotal for
    enhanced analysis, and integrating Windows Defender and Sysmon.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 3*](B19549_03.xhtml#_idTextAnchor077), *Threat Intelligence and Analysis*,
    discusses enhancing Wazuh capabilities by integrating threat intelligence and
    analysis tools such as MISP, TheHive, and Cortex. This chapter includes real-world
    examples of threat intelligence in a variety of contexts, as well as instructions
    on configuring and utilizing TheHive, Cortex, and MISP for cooperative threat
    analysis and response.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 4*](B19549_04.xhtml#_idTextAnchor116), *Security Automation and Orchestration
    Using Shuffle*, covers the integration of **Security orchestration, Automation,
    and Response** (**SOAR**) with the Wazuh platform that can be utilized to streamline
    and enhance incident response processes. The chapter focuses on the implementation
    of automated workflows, playbooks, and response actions using Wazuh and Shuffle.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 5*](B19549_05.xhtml#_idTextAnchor136), *Incident Response with Wazuh*,
    focuses on Wazuh’s Active response capability to remediate threats in real time,
    covering several practical use cases such as blocking brute-force attempts and
    automatically isolating Windows machines.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 6*](B19549_06.xhtml#_idTextAnchor163), *Threat Hunting with Wazuh*,
    delves into the methodology of proactive threat hunting using Wazuh, focusing
    on log analysis, attack mapping, Osquery utilization, and command monitoring.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 7*](B19549_07.xhtml#_idTextAnchor191), *Vulnerability and Configuration
    Assessment*, explores vulnerability and policy assessment using Wazuh. It will
    cover the important parts of finding vulnerabilities, monitoring configurations,
    and following standard compliance frameworks in a business. This chapter also
    covers the basics of vulnerability assessment and compliance standards such as
    PCI DSS, NIST 800-53, and HIPAA. It also provides ideas on how to use Wazuh’s
    features to make sure your organization follows all of its security rules and
    policies.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 8*](B19549_08.xhtml#_idTextAnchor214), *Appendix* delves into a list
    of custom Wazuh rules to enhance security monitoring. It explores the creation
    of custom PowerShell rules to detect suspicious activities within Windows environments.
    Additionally, the chapter discusses the implementation of custom Auditd rules
    for auditing Linux systems, bolstering defense against potential threats. Moreover,
    it provides insights into crafting custom Kaspersky endpoint security rules, enabling
    comprehensive threat detection and response. Finally, it covers custom Sysmon
    rules mapped to certain MITRE ATT&CK® techniques.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 9*](B19549_09.xhtml#_idTextAnchor244), *Glossary*, provides a comprehensive
    glossary covering key terms and concepts essential for understanding security
    monitoring and Wazuh functionality. From *active response*, which automates response
    actions, to *Amazon EC2 instances* and beyond, each entry offers concise explanations.
    Terms such as *compliance*, *IDS*, and *vulnerability detection module* are elucidated,
    aiding you in grasping crucial security concepts. Additionally, tools such as
    *PowerShell*, *Docker*, and *YARA* are defined, highlighting their significance
    in modern cybersecurity practices. This glossary serves as a valuable reference
    for both novice and experienced security professionals who are navigating the
    complex landscape of security monitoring and threat detection.'
  prefs: []
  type: TYPE_NORMAL
- en: To get the most out of this book
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*You need to have a basic understanding of cybersecurity concepts such as malware,
    network scanning, web application attacks, and* *security compliance.*'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Software/hardware covered in** **the book** | **Operating** **system requirements**
    |'
  prefs: []
  type: TYPE_TB
- en: '| Wazuh OVA | Windows and Ubuntu Linux |'
  prefs: []
  type: TYPE_TB
- en: '| Suricata IDS and Osquery |  |'
  prefs: []
  type: TYPE_TB
- en: '| VirusTotal |  |'
  prefs: []
  type: TYPE_TB
- en: Download the example code files
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You can download the code mentioned in the book from the GitHub repository
    here: [https://github.com/PacktPublishing/Security-Monitoring-using-Wazuh](https://github.com/PacktPublishing/Security-Monitoring-using-Wazuh)'
  prefs: []
  type: TYPE_NORMAL
- en: We also have other code bundles from our rich catalog of books and videos available
    at [https://github.com/PacktPublishing/](https://github.com/PacktPublishing/).
    Check them out!
  prefs: []
  type: TYPE_NORMAL
- en: Disclaimer on images
  prefs: []
  type: TYPE_NORMAL
- en: This book contains many horizontally long screenshots. These screenshots provide
    readers with an overview of Wazuh's execution plans for various operations. As
    a result, the text in these images may appear small at 100% zoom. Additionally,
    you will be able to examine these plans more thoroughly in the output of Wazuh
    as you work through the examples.
  prefs: []
  type: TYPE_NORMAL
- en: Conventions used
  prefs: []
  type: TYPE_NORMAL
- en: There are a number of text conventions used throughout this book.
  prefs: []
  type: TYPE_NORMAL
- en: '`Code in text`: Indicates code words in text, database table names, folder
    names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter
    handles. Here is an example: “Copy the `curl` command to download the Wazuh module
    and start the Wazuh agent service as mentioned in the following diagram.”'
  prefs: []
  type: TYPE_NORMAL
- en: 'A block of code is set as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'When we wish to draw your attention to a particular part of a code block, the
    relevant lines or items are set in bold:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Any command-line input or output is written as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '**Bold**: Indicates a new term, an important word, or words that you see on
    screen. For instance, words in menus or dialog boxes appear in **bold**. Here
    is an example: “**Suricata** is an open-source network **intrusion detection and
    prevention** **system (IDS/IPS)**.”'
  prefs: []
  type: TYPE_NORMAL
- en: Tips or important notes
  prefs: []
  type: TYPE_NORMAL
- en: Appear like this.
  prefs: []
  type: TYPE_NORMAL
- en: Get in touch
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Feedback from our readers is always welcome.
  prefs: []
  type: TYPE_NORMAL
- en: '**General feedback**: If you have questions about any aspect of this book,
    email us at [customercare@packtpub.com](mailto:customercare@packtpub.com) and
    mention the book title in the subject of your message.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Errata**: Although we have taken every care to ensure the accuracy of our
    content, mistakes do happen. If you have found a mistake in this book, we would
    be grateful if you would report this to us. Please visit [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)
    and fill in the form.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Piracy**: If you come across any illegal copies of our works in any form
    on the internet, we would be grateful if you would provide us with the location
    address or website name. Please contact us at [copyright@packt.com](mailto:copyright@packt.com)
    with a link to the material.'
  prefs: []
  type: TYPE_NORMAL
- en: '**If you are interested in becoming an author**: If there is a topic that you
    have expertise in and you are interested in either writing or contributing to
    a book, please visit [authors.packtpub.com](http://authors.packtpub.com).'
  prefs: []
  type: TYPE_NORMAL
- en: Share Your Thoughts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once you’ve read *Security Monitoring with Wazuh*, we’d love to hear your thoughts!
    Please [click here to go straight to the Amazon review page](https://packt.link/r/1-837-63215-4)
    for this book and share your feedback.
  prefs: []
  type: TYPE_NORMAL
- en: Your review is important to us and the tech community and will help us make
    sure we’re delivering excellent quality content.
  prefs: []
  type: TYPE_NORMAL
- en: Download a free PDF copy of this book
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Thanks for purchasing this book!
  prefs: []
  type: TYPE_NORMAL
- en: Do you like to read on the go but are unable to carry your print books everywhere?
  prefs: []
  type: TYPE_NORMAL
- en: Is your eBook purchase not compatible with the device of your choice?
  prefs: []
  type: TYPE_NORMAL
- en: Don’t worry, now with every Packt book you get a DRM-free PDF version of that
    book at no cost.
  prefs: []
  type: TYPE_NORMAL
- en: Read anywhere, any place, on any device. Search, copy, and paste code from your
    favorite technical books directly into your application.
  prefs: []
  type: TYPE_NORMAL
- en: The perks don’t stop there, you can get exclusive access to discounts, newsletters,
    and great free content in your inbox daily
  prefs: []
  type: TYPE_NORMAL
- en: 'Follow these simple steps to get the benefits:'
  prefs: []
  type: TYPE_NORMAL
- en: Scan the QR code or visit the link below
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[![Download a free PDF copy of this book QR Code](img/B19549_QR_Free_PDF.jpg)](https://packt.link/free-ebook/9781837632152
    )'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://packt.link/free-ebook/9781837632152](https://packt.link/free-ebook/9781837632152)'
  prefs: []
  type: TYPE_NORMAL
- en: Submit your proof of purchase
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: That’s it! We’ll send your free PDF and other benefits to your email directly
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Part 1:Threat Detection
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this part, we will focus on utilizing Wazuh for effective threat detection.
    You will learn to set up an **intrusion detection system** (**IDS**) to discover
    suspicious traffic. In addition to that, you will also learn the architecture,
    components, and core capabilities of the Wazuh platform. You will learn about
    several capabilities of Wazuh to detect malware with some practical use cases.
  prefs: []
  type: TYPE_NORMAL
- en: 'This part includes the following chapters:'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 1*](B19549_01.xhtml#_idTextAnchor014), *Intrusion Detection System
    (IDS) Using Wazuh*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Chapter 2*](B19549_02.xhtml#_idTextAnchor042), *Malware Detection Using Wazuh*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
