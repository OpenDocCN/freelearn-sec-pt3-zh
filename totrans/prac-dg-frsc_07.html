<html><head></head><body><div class="chapter" title="Chapter&#xA0;7.&#xA0;Windows and Other Operating Systems as Sources of Evidence"><div class="titlepage"><div><div><h1 class="title"><a id="ch07"/>Chapter 7. Windows and Other Operating Systems as Sources of Evidence</h1></div></div></div><p>The majority of laptop, desktop, and network-based computers use Windows operating systems, and this chapter will describe this in some detail and provide a brief description of other operating systems that are commonly examined. The chapter will provide you with an understanding of the complexity and nature of information processed on computers that assists forensic examinations and facilitates the recreation of key events relating to the presence of digital evidence stored in a range of operating systems.</p><p>The chapter will look at:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The Windows Registry and system files and logs as a resource of digital evidence</li><li class="listitem" style="list-style-type: disc">Apple and other operating system structures</li><li class="listitem" style="list-style-type: disc">Remote-access and malware attacks and the prevalence and challenge posed by anti-forensics to the recovery of digital evidence</li><li class="listitem" style="list-style-type: disc">A case study relating to Windows Registry analysis</li></ul></div><div class="section" title="The Windows Registry and system files and logs as resources of digital evidence"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec54"/>The Windows Registry and system files and logs as resources of digital evidence</h1></div></div></div><p>Windows-based systems have a central repository of settings called the <span class="strong"><strong>Windows Registry</strong></span>. The<a id="id526" class="indexterm"/> registry is often a valuable source of information that can be used to clarify and corroborate other information of relevance to an investigation recovered from the filesystem. The Windows Registry is a vital part of the Windows operating system and maintains the configuration of the system and supported application programs as well as the users accessing the system and attached devices and networks.</p><p>The registry <a id="id527" class="indexterm"/>consists of a directory structure containing folders or "hives" that contain files or keys that contain values and, sometimes, sub-keys. Each key contains specific values that are used by the operating system or an application that relies on the value, for instance, the time zone used by the computer, the status of remote access settings, or details of a storage device attached.</p><p>The <span class="strong"><strong>Registry Explorer</strong></span> <a id="id528" class="indexterm"/>allows the practitioner to explore the content of registry hives that must be processed before they can be viewed. Depending on the purpose of the examination taking place, the registry can hold valuable information. The Registry keys have an associated value called the <span class="strong"><strong>Last Write</strong></span> time, which records the last modification time of the key. The last modification time may disclose what was changed in the key. Some Registry keys contain several values, which also makes it difficult to determine which of the values was changed.</p><p>The following screenshot shows samples of <span class="strong"><strong>Registry Hives</strong></span> viewed using ILookIX Registry Explorer, which contains all of the processed registry hives, along with a viewer to review selected keys and values:</p><div class="mediaobject"><img src="graphics/B04931_07_01.jpg" alt="The Windows Registry and system files and logs as resources of digital evidence"/><div class="caption"><p>Looking at Registry Hives using ILookIX Registry Explorer</p></div></div><p>It is important that the practitioner have some knowledge of the workings and layout of the Registry and <a id="id529" class="indexterm"/>what corroboration it may provide. Knowing where to look and the sort of information required is covered in the following sub-sections.</p><div class="section" title="Seeking useful leads within the Registry"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec114"/>Seeking useful leads within the Registry</h2></div></div></div><p>Registry Explorer <a id="id530" class="indexterm"/>has two sections:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The upper section displays the hives, keys, and sub-keys</li><li class="listitem" style="list-style-type: disc">The lower section shows the names and properties of registry values</li></ul></div><p>The structure of the hives is displayed in the top panel, shown in the following screenshot. Clicking on any key in a hive displays the values for that key in the lower panel. Clicking on a value in the lower panel reveals the data for that value, which is displayed in the viewer panel.</p><div class="mediaobject"><img src="graphics/B04931_07_02.jpg" alt="Seeking useful leads within the Registry"/><div class="caption"><p>Registry Viewer showing Registry hives and keys</p></div></div><p>Registry Explorer <a id="id531" class="indexterm"/>has functions not present or poorly implemented in other forensic tools, such as these:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Search</strong></span>: It searches the loaded hives' value data</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>List</strong></span>: This is used to list all of the values under the key you have currently selected in the top panel</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Key structure report</strong></span>: This function creates a report of the structure as it is currently viewable in the upper panel</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Hive value report</strong></span>: This function creates a report of the values currently shown in the lower panel</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Value name find</strong></span>: This function allows you to search for value names</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Hidden value list</strong></span>: This is used to list all of the hidden values (if any) under the key you have currently selected in the top panel</li></ul></div><p>Registry Explorer flags some hives, keys, and values that may be hidden from normal view in the Registry. Hidden keys and values, often used to store virus and Trojan data, may have additional data. ILookIX will allow the practitioner to view this extra data if it is present. Programs in Windows, including viruses and Trojans, have the ability to read and write values to the Registry by writing directly to the Registry, which programs using the standard <a id="id532" class="indexterm"/>
<span class="strong"><strong>Win32 Application Programming Interface</strong></span> (<span class="strong"><strong>Win32 API</strong></span>) cannot detect. These values are referred to as hidden values.</p><p>There are also programs available that do not rely on the Win32 API and are capable of writing hidden values to the Registry. This could be used to conceal data. Hidden values should not automatically be interpreted as malicious, as Windows XP, for example, came with about 27 hidden values.</p><p>By selecting a key or sub-key or using either of the <span class="strong"><strong>Generate List</strong></span> buttons, a list of values will be transferred to the <span class="strong"><strong>Value List</strong></span> box in the lower portion of Registry Explorer. The list in the lower window will display relevant information about the value, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/B04931_07_03.jpg" alt="Seeking useful leads within the Registry"/><div class="caption"><p>Registry Viewer showing some values of keys</p></div></div><p>The following <a id="id533" class="indexterm"/>screenshot shows the hex editor view of the value:</p><div class="mediaobject"><img src="graphics/B04931_07_04.jpg" alt="Seeking useful leads within the Registry"/><div class="caption"><p>Hex view of key values</p></div></div><p>The search function shown in the following screenshot uses an index search to identify useful data such as a word search in the appropriate field:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Registry Key</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Registry Value</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Registry Data</strong></span></li></ul></div><div class="mediaobject"><img src="graphics/B04931_07_05.jpg" alt="Seeking useful leads within the Registry"/><div class="caption"><p>Searching for information in the Registry</p></div></div></div><div class="section" title="Mapping devices through the Registry"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec115"/>Mapping devices through the Registry</h2></div></div></div><p>By mapping<a id="id534" class="indexterm"/> a device to determine partitions and mounted and attached storage devices, the practitioner will gain a deeper insight into the usage of the device. For example, consider an instance where an internal hard drive detached from a computer was recovered and contained some probative evidence.</p><p>The following should be considered:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Can it be linked to the device?</li><li class="listitem" style="list-style-type: disc">If so, does it increase the likelihood that a relationship exists between users of the device and the drive?</li><li class="listitem" style="list-style-type: disc">If not, does this affect the strength of the link between the suspect and the evidence contained on the device?</li></ul></div><p>ILookIX will identify device partitions and extract data from them. However, the examination of other artifacts may provide more specific details about the antecedents of the device.</p><p>Windows makes a record of various internal and external drives attached to the device as well as details of other peripherals, such as printers, optical drives, and thumb drives. The previous connection of an external device that is no longer connected may be shown through this device logging. In Registry, the <code class="literal">SYSTEM\MountedDevices</code> key records previously mounted devices. It can provide the actual serial number of many attached USB devices—a most useful attribute for the practitioner to use in reconstructing key events. The following screenshot shows a collection of devices attached to a desktop computer:</p><div class="mediaobject"><img src="graphics/B04931_07_06.jpg" alt="Mapping devices through the Registry"/><div class="caption"><p>Viewing system-mounted devices in the Registry</p></div></div></div><div class="section" title="Detecting USB removable storage"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec116"/>Detecting USB removable storage</h2></div></div></div><p>To reiterate, details<a id="id535" class="indexterm"/> of external devices, most notably, USB devices, mobile phones, and digital cameras, that have been connected to the computer are stored in the Registry. The Registry records some basic information about attached peripheral devices, such as the internal hard drive, monitor, keyboard, and mouse, but it also keeps information about other devices that may have been temporarily attached to the computer, such as external drives, thumb drives, cell phones, and digital cameras.</p><p>The following screenshot shows a record of an attached USB thumb drive stored in the registry, showing the manufacturer's name. Often, the unique serial number of the device can be recovered.</p><div class="mediaobject"><img src="graphics/B04931_07_07.jpg" alt="Detecting USB removable storage"/><div class="caption"><p>The Registry showing a record of an attached USB device</p></div></div><p>Not all <a id="id536" class="indexterm"/>USB thumb drives have serial numbers. This may be determined by the second character of the device ID being <code class="literal">&amp;</code> and not a number. When examining each attached device, it can be seen that various values are displayed, including <code class="literal">ParentIdPrefix</code>, but there is very little else to assist the practitioner in determining the origin of the value or its use by the system. However, the Registry does hold other information that may assist, such as the <code class="literal">HKEY_LOCAL_MACHINE\System\MountedDevices</code> key, which is, in effect, a database of mounted volumes. The database records persistent volume names associated with unique identifiers for these volumes. By examining this additional data, it can often be shown that names assigned to the volumes, such as the drive letter <code class="literal">F</code>, will be associated with the <code class="literal">ParentIdPrefix</code> value for an attached thumb drive. If the thumb drive has been given a specific name by the user, this may also be recorded in the Registry.</p></div><div class="section" title="User activity"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec117"/>User activity</h2></div></div></div><p>The <a id="id537" class="indexterm"/>Registry holds various files, such as the <code class="literal">NTUSER.DAT</code> file, for each user granted permission to use the device, and stores the settings specific to that user. The contents of these files are mapped to the <code class="literal">HKEY_USERS\SID</code> hive so that it records users logging in. The process creates and updates the <code class="literal">HKEY_CURRENT_USER</code> hive, which can provide useful information regarding the actions taken by users after logging in to the device.</p></div><div class="section" title="Reviewing Most Recently Used and Jump List activity"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec118"/>Reviewing Most Recently Used and Jump List activity</h2></div></div></div><p>The<a id="id538" class="indexterm"/> registry maintains <span class="strong"><strong>Most Recently Used</strong></span> (<span class="strong"><strong>MRU</strong></span>) lists <a id="id539" class="indexterm"/>and <a id="id540" class="indexterm"/>
<span class="strong"><strong>Jump Lists</strong></span>, which <a id="id541" class="indexterm"/>were introduced in <a class="link" href="ch06.html" title="Chapter 6. Selecting and Analyzing Digital Evidence">Chapter 6</a>, <span class="emphasis"><em>Selecting and Analyzing Digital Evidence</em></span>. This facility is intended to assist users to keep track of recent activities, such as providing quick access to word processing documents or pictures and videos that were viewed. However, from a forensic perspective, they act as a burglar's "footprints in the flowerbed," which are useful for recreating some history of entries made due to specific actions taken by the user. They are stored to keep track of items the user may return to in the future.</p><p>The <a id="id542" class="indexterm"/>Registry maintains a list of commands that the user types into the <span class="strong"><strong>Start</strong></span> | <span class="strong"><strong>Run</strong></span> box in this key:</p><p>
<code class="literal">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU</code>
</p><p>When an <a id="id543" class="indexterm"/>entry is made in the <span class="strong"><strong>Run</strong></span> box, this action is recorded to this key and a list of the most recently used value is maintained, although this data may correlate with file and application metadata. It would be prudent to check this data as a matter of course to ensure there are no unexplained anomalies that might bring the fidelity of the evidence into doubt.</p></div><div class="section" title="Detecting wireless connectivity"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec119"/>Detecting wireless connectivity</h2></div></div></div><p>Network <a id="id544" class="indexterm"/>connections on Windows machines provide <a id="id545" class="indexterm"/>
<span class="strong"><strong>Service Set Identifiers</strong></span> (<span class="strong"><strong>SSID</strong></span>) data confirming the existing and previous wireless network or networks connected to the desktop or laptop computer. This often useful data is stored in the Registry in the <code class="literal">HKEY_LOCAL_MACHINE\ Software\Microsoft\WZCSVC\Parameters\Interfaces</code> hive. This repository can provide details of the network settings, including the IP address, from the <code class="literal">KEY_LOCAL_MACHINE\System\CurrentControlSet\Services\TCPIP\Interfaces\GUID</code> key. The value of linking an IP address to recovered evidence from the computer may be assisted by this data.</p></div><div class="section" title="Observing Windows Event Viewer logs"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec120"/>Observing Windows Event Viewer logs</h2></div></div></div><p>The<a id="id546" class="indexterm"/> Event Viewer logs maintained in Windows 7 onward record additional information to that contained in the Registry. It can, for example, corroborate the connection of a USB device, which may or may not be retained in Registry logs. It can record the frequency of usage of some programs, such as virtual networks, that may have been operating and can corroborate logging recorded by the application.</p><p>A portion of the text formatting, shown in the following screenshot, contains some of the same information about a USB device that can be found in the <code class="literal">System</code> hive. The registry should also show the date the device driver was installed, and this is typically recorded in Event Viewer logs.</p><div class="mediaobject"><img src="graphics/B04931_07_08.jpg" alt="Observing Windows Event Viewer logs"/><div class="caption"><p>Windows Event Viewer showing a record of an attached USB device</p></div></div><p>Disconnected <a id="id547" class="indexterm"/>USB devices generate logs that can justify a more detailed examination of the circumstances surrounding the disconnection of an external device and may provide a timestamp of the time of the disconnection. This information may be located in the <code class="literal">System</code> hive <code class="literal">CurrentControlSet\Enum\DeviceType\DeviceID\InstanceID\ \Properties\xxxx</code>.</p></div><div class="section" title="Recovery of hidden data from a VSS"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec121"/>Recovery of hidden data from a VSS</h2></div></div></div><p>Recall<a id="id548" class="indexterm"/> from <a class="link" href="ch05.html" title="Chapter 5. The Need for Enhanced Forensic Tools">Chapter 5</a>, <span class="emphasis"><em>The Need for Enhanced Forensic Tools</em></span>, that the recovery of additional data can be achieved from Windows systems that have the VSS feature enabled. In the case study in the previous chapter, files important to the victim organization were recovered from Dropbox accounts in one of the VSS folders. In the instance shown in the following screenshot, ILookIX's <span class="strong"><strong>Differential XFR-VSS records</strong></span> feature was used to recover only those VSS folders that contain differences in the file content:</p><div class="mediaobject"><img src="graphics/B04931_07_09.jpg" alt="Recovery of hidden data from a VSS"/><div class="caption"><p>Recovery options for VSS folders</p></div></div><p>In this <a id="id549" class="indexterm"/>laboratory simulation, seven VSS folders were recovered, as can be seen in the following screenshot:</p><div class="mediaobject"><img src="graphics/B04931_07_10.jpg" alt="Recovery of hidden data from a VSS"/><div class="caption"><p>Various instances of the VSS recovered from a simulation image</p></div></div><p>Not only <a id="id550" class="indexterm"/>may deleted files be recovered that otherwise may have remained obscured, but system information and logs that assist in the reconstruction of a transgression may also be recovered. The previous iterations of Registry keys and hives and Event Viewer logging records are shown in the following screenshot. These records may reveal various activities of potential relevance, including remote access, changes to clock and desktop settings, and malicious intrusion exploits of the Registry.</p><div class="mediaobject"><img src="graphics/B04931_07_11.jpg" alt="Recovery of hidden data from a VSS"/><div class="caption"><p>Various instances of Registry hives and keys recovered from VSS folders</p></div></div><p>The <a id="id551" class="indexterm"/>recovery of additional information such as archive stores, including zipped files, is also possible. The following screenshot highlights some additional ZIP files extant in various VSS folders, shown with different dates:</p><div class="mediaobject"><img src="graphics/B04931_07_12.jpg" alt="Recovery of hidden data from a VSS"/><div class="caption"><p>Archive stores recovered from VSS in the ILookIX Container Category</p></div></div><p>The additional recovery of e-mail stores from VSS folders, shown in the following screenshot, reflects e-mail messages during different periods. In the simulation, one of the <code class="literal">VSS</code> folders<a id="id552" class="indexterm"/> surrendered a deleted e-mail that was not located in the current view of the drive:</p><div class="mediaobject"><img src="graphics/B04931_07_13.jpg" alt="Recovery of hidden data from a VSS"/><div class="caption"><p>E-mail recovered from a VSS folder</p></div></div></div><div class="section" title="Examining prefetch files"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec122"/>Examining prefetch files</h2></div></div></div><p>The <a id="id553" class="indexterm"/>process of booting a Windows system results in a range of files being read to RAM, which can be a lengthy process, so Windows creates prefetch files whenever a program is first run. This information may provide the practitioner with information about the history of various programs of relevance to an investigation running on the system.</p><p>Application execution may indicate that an anti-forensic program, for example, was used to obfuscate a transgression. In the event that a program has been deleted, it may be possible to locate a prefetch file that confirms the use of the program prior to its deletion—much more helpful than a bland statement that the program was installed, but whether it had been executed was unknown.</p><p>Malware activity can sometimes be established by examining a prefetch file that can provide some history of its download and execution. The <code class="literal">prefetch</code> folder and <code class="literal">ReadyBoot</code> folder are shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/B04931_07_14.jpg" alt="Examining prefetch files"/><div class="caption"><p>View of the Prefetch folder and subfolder</p></div></div><p>Application<a id="id554" class="indexterm"/> prefetching uses a similar process, but it is localized to a single application's startup and typically stores its trace files in <code class="literal">C:\Windows\Prefetch</code>. Prefetch data is reflected in a file called <code class="literal">Layout.ini</code> that keeps a catalogue in sequential order. It holds the details of files and folders active in the boot process as part of system housekeeping:</p><div class="mediaobject"><img src="graphics/B04931_07_15.jpg" alt="Examining prefetch files"/><div class="caption"><p>View of the Layout.ini file</p></div></div><p>Prefetch file analysis is uncomplicated, and it is really not difficult to confirm that the files contain details about the frequency of application runs, volume details, and timestamps of applications' first and last runs. Windows 10 records up to eight timestamps for each occasion an application was run and stores them in the <code class="literal">ROOT/Windows/Prefetch</code> folder.</p></div><div class="section" title="Pagefiles"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec123"/>Pagefiles</h2></div></div></div><p>Windows <a id="id555" class="indexterm"/>uses <code class="literal">pagefile.sys</code> to store frames of memory that do not currently fit into physical memory. Windows supports 16 pagefiles, but typically, only one hidden file is used and is stored in <code class="literal">%SystemDrive%\pagefile.sys</code>. Acting in effect as virtual memory files, the hidden <code class="literal">pagefile.sys</code> file runs when RAM is pushed to its limit, and it becomes a virtual memory file. When the system is running out of RAM, it places memory dumps on the hard drive as a pagefile to supplement scarce memory. This can result in the system slowing down, which often occurs when too many applications are running.</p><p>This <a id="id556" class="indexterm"/>operation is not dissimilar to the functioning of <code class="literal">hiberfil.sys</code>, as it stores processes running at a specific time. However, it should be noted that <code class="literal">pagefile.sys</code> does not record all RAM activity.</p><p>The <code class="literal">pagefile.sys</code> file is essential for the sound performance of the system and undergoes constant changes as the device is being used. The following screenshot shows duplicate copies of a large-sized <code class="literal">pagefile.sys</code> file:</p><div class="mediaobject"><img src="graphics/B04931_07_16.jpg" alt="Pagefiles"/><div class="caption"><p>Locating pagefile.sys files</p></div></div></div><div class="section" title="Hibernation and sleep files"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec124"/>Hibernation and sleep files</h2></div></div></div><p>The <code class="literal">hiberfil.sys</code> file is the default file used by Windows to save the machine's state as part <a id="id557" class="indexterm"/>of the hibernation process. As the operating system keeps the file open, it is not possible to read the file while the system is running. Internet artifacts are commonly found in memory and typically remain in the form of the pagefile or hibernation file. Recovering the deleted hibernation data can assist in determining what was in memory prior to hibernation.</p><p>Sleep mode does not provide much useful information as RAM is still working in the background and dissipates once the device restarts. Hibernation mode may provide more useful data from laptop computers because during hibernation, a snapshot of all the data in RAM is captured, and this is written to the hard drive.</p><p>The following screenshot shows a search for hibernation files to search for information that may assist the practitioner:</p><div class="mediaobject"><img src="graphics/B04931_07_17.jpg" alt="Hibernation and sleep files"/><div class="caption"><p>Searching for hiberfile.sys instances</p></div></div></div><div class="section" title="Detecting steganography"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec125"/>Detecting steganography</h2></div></div></div><p>
<span class="strong"><strong>Steganography</strong></span> is<a id="id558" class="indexterm"/> the process of concealing<a id="id559" class="indexterm"/> data in a communication so that only the sender and receiver know of its existence and are able to access the concealed information. It is common to encrypt data hidden in digital files or images whenever possible. The detection of steganographically encoded files is referred to as <a id="id560" class="indexterm"/>
<span class="strong"><strong>steganalysis</strong></span>. Steganalysis is limited to the detection of an embedded message, which may identify the embedding process. When the application or method of concealment has been identified, it might be possible to extract the message.</p><p>Unusual patterns in the steganographic image are obvious and create suspicion but can be hard to detect initially. A number of disk analysis utilities, such as ILookIX, are available, which can report on and filter hidden information in unused clusters or partitions in storage devices. By identifying repetitive patterns, it may be possible to detect hidden information in what appear to be innocuous files. Such repetition might reveal the presence of a steganography tool as well as hidden information. Comparing an authentic original file with one suspected of containing hidden information is a viable process, but that is contingent on having two samples for comparison.</p><p>Watermarking is often used to legitimately identify and protect copyrighted material. Although watermarks are often concealed, they are sometimes identified by forgers and subject to illicit removal to thwart the investigator.</p><p>To assist in the detection of hidden information with various tools, practitioners must identify and match the hash value of each suspected file. Doing so involves the importing or building of a library of hash sets, notably steganography software, as part of a comparison library.</p></div></div></div>
<div class="section" title="Apple and other operating system structures"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec55"/>Apple and other operating system structures</h1></div></div></div><p>While<a id="id561" class="indexterm"/> Microsoft dominates the household market and many network systems, other popular operation systems such as Apple and Linux are also very much in use and likely to have to be examined by the forensic practitioner. The following subsections provide a brief introduction to these systems.</p><div class="section" title="Examining Apple operating systems"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec126"/>Examining Apple operating systems</h2></div></div></div><p>Apple Macintosh <a id="id562" class="indexterm"/>devices use a different operating system (currently called OS X), which, unlike Microsoft's systems, enables applications to run independently of users, who do not have direct access to the filesystem. Simplicity and convenience is the general convention, which is based on the Unix filesystem.</p><p>Applications <a id="id563" class="indexterm"/>installed on an Apple machine have limited interaction with the filesystem, being restricted from doing so from within directories inside the application's sandbox. The sandbox protects systems and users from malware attacks. In effect, it limits the access privileges of each application to tighten the security of the device.</p><p>When applications are installed, a number of containers are created with specific roles. Typically, the application's operating files are held in a bundle container and the data files are held in data containers and subdirectories. Users access files through the <span class="strong"><strong>Finder</strong></span> facility. The filesystem consists of four main domains, separating resources from files for ease of access and use and sound security protection. These consist of the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The user domain</strong></span>: This<a id="id564" class="indexterm"/> has user-specific resources restricting each user's access and control to only their own home directory.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The local domain</strong></span>: This<a id="id565" class="indexterm"/> is concerned with applications installed on the current computer and shared among all users, consisting of several directories on the local boot volume, which is managed by the system. Users with administrative privileges may add, remove, or modify this domain.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The network domain</strong></span>: This <a id="id566" class="indexterm"/>contains applications and documents shared among all users of a local area network.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The system domain</strong></span>: This <a id="id567" class="indexterm"/>contains Apple system software installed by Apple, which prevents users from adding, removing, or modifying items.</li></ul></div><p>As part of its attempt to simplify the use of applications, the Finder function and several other functions, such as the <span class="strong"><strong>Open</strong></span> and <span class="strong"><strong>Save</strong></span> panels, conceal files and directories that do not require user access or intervention. A typical directory structure viewed through a forensic tool is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/B04931_07_18.jpg" alt="Examining Apple operating systems"/><div class="caption"><p>Apple file hierarchy</p></div></div><p>The <a id="id568" class="indexterm"/>various categories of files held on Apple<a id="id569" class="indexterm"/> desktops and laptops are available to the practitioner and shown cataloged in the following screenshot of ILookIX <span class="strong"><strong>Category Explorer</strong></span>:</p><div class="mediaobject"><img src="graphics/B04931_07_19.jpg" alt="Examining Apple operating systems"/><div class="caption"><p>File categories and signatures cataloged from an Apple computer</p></div></div><p>File <a id="id570" class="indexterm"/>metadata, including timestamps, EXIF <a id="id571" class="indexterm"/>data for picture images, and file locations, may also be recovered from iOS, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/B04931_07_20.jpg" alt="Examining Apple operating systems"/><div class="caption"><p>File metadata collated from an Apple computer</p></div></div></div><div class="section" title="The Linux operating system"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec127"/>The Linux operating system</h2></div></div></div><p>The<a id="id572" class="indexterm"/> Linux operating system, a variant <a id="id573" class="indexterm"/>of Unix, relays instructions from an application to the computer's central processing unit and processor. The processor performs the instructed task and then sends the results back to the application via the operating system. Although Linux has many features common to Windows and OS X, it is an open source operating system, developed in collaboration with users, companies, and partners. This has resulted in economic research and development endeavors to produce an innovative and, many say, superior operating system. Linux has become an important desktop system as well as the foundational operating system for networks and many devices, such as mobile phones.</p><p>Because Linux is on the system BIOS of laptop and notebook computers and cellphones, it dramatically increases the speed of booting up these devices. Linux increasingly runs a significant number of web servers, including Amazon's cloud service. Twitter, LinkedIn, YouTube, and Google use Linux as their operating systems.</p><p>Operating systems' architectures have kernels that contain a set of coded instructions that make the computer hardware respond to the operating system and, by default, application-level programs. Unlike the Microsoft Windows kernel, which many regard as cumbersome and inaccessible to all but a few of its own programmers, the flexibility and modular structure of the Linux kernel offers a number of advantages to developers. In particular, the size of the kernel can be increased or decreased to meet the requirements of developers wishing to redesign the system for different operating environments and devices. This is especially helpful in system miniaturization for smaller-sized handheld devices.</p><p>A <a id="id574" class="indexterm"/>collective set of tools embedded in the<a id="id575" class="indexterm"/> Linux kernel is, in effect, its operating system, which also has the advantage of being modular in form. Linux provides users with a range of choices in the way they may wish to make use of its system, including the windows-and-desktop functionality that most users are familiar with in Windows and OS X.</p><p>A system of users, groups, and privileges is embedded in Linux to keep the security of the operating system as secure as possible. It does provide self-contained user accounts in much the same way as other operating systems. For example, personal files are held within the user's <code class="literal">home</code> directory and are readily available for use. However, a typical Linux filesystem can contain a confusing array of local and remote files and running processes and, unlike Windows, there is no <code class="literal">Program Files</code> directory. The following screenshot shows a menu view of a Linux system:</p><div class="mediaobject"><img src="graphics/B04931_07_21.jpg" alt="The Linux operating system"/><div class="caption"><p>Menu view in a Linux system</p></div></div><p>The archive view of a sample Linux operating system is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/B04931_07_22.jpg" alt="The Linux operating system"/><div class="caption"><p>Archive view of a Linux system</p></div></div></div></div>
<div class="section" title="Remote access and malware threats"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec56"/>Remote access and malware threats</h1></div></div></div><p>The<a id="id576" class="indexterm"/> prevalence of malware and other exploits through hacker attacks, often through remote-access exploits, remains a significant threat to computers and network systems that are vulnerable because of poor security management. These issues are discussed in the following subsections.</p><div class="section" title="Remote access"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec128"/>Remote access</h2></div></div></div><p>The "Trojan defense" has been used by guilty as well as innocent computer users to support claims of their innocence by blaming the presence of illegal activities on their computers on remote attackers. While this is plausible, there seems to be a reversal of the onus of proving innocence, with the defendant instead of the prosecutor taking on the role. The big bugbear in all digital forensic examinations is linking the suspect to incriminating events. It would be fairer, but obviously too time-consuming on occasion, for the practitioner to clarify the possibility or likelihood of a remote-access exploit.</p><p>Windows operating<a id="id577" class="indexterm"/> systems permit remote access for legitimate purposes, but it is quite common for Windows updates needed to resolve vulnerability in the feature in including its Remote Desktop Protocol service, which is inherently unsecure and vulnerable to exploitation.</p><p>Remote access <a id="id578" class="indexterm"/>can also be gained through a malware attack that assists hackers in gaining access to the target device or network. This is especially problematic if there is an absence or only a low level of security protection.</p><p>Wi-Fi connections, while convenient, often allow the snooping of sensitive network traffic to take place, potentially providing easy access to accounts held on computers and handheld devices. A lack of sound encryption of these communications will enable a cyberattack to be mounted against online banking and other accounts that involve financial transactions, for example.</p></div><div class="section" title="Detecting malware attacks and other exploits"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec129"/>Detecting malware attacks and other exploits</h2></div></div></div><p>The registry stores <a id="id579" class="indexterm"/>autostart keys at various locations, which launch applications without direct user intervention. One of the keys that hackers most commonly exploit is the run key that allows many of these exploits to remain on the system: <code class="literal">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code>. The startup key <a id="id580" class="indexterm"/>will launch programs when the system starts up, when a user logs in to the system, or the user undertakes some other specified action.</p><p>The <code class="literal">HKEY_LOCAL_MACHINE \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File</code> Registry entry is intended for the administrator to debug various executive options, but it is vulnerable to outside attackers who can use it to redirect an application to a hijacked copy of the application. The addition of an autostart key for Word can direct the process to a copy of Word containing malicious code that allows access to the computer whenever the program is launched. These autostart keys often leave some electronic fingerprint of such intrusions that may clarify whether the computer user or an intruder is responsible for events of interest.</p><p>In <a class="link" href="ch04.html" title="Chapter 4. Recovering and Preserving Digital Evidence">Chapter 4</a>, <span class="emphasis"><em>Recovering and Preserving Digital Evidence</em></span>, mention was made of reading and recovering the contents of RAM for analyzing malware that antivirus programs do not detect. IXImager can reboot fast enough to enable capture of the system's RAM so that running programs, passwords, and so on can be captures. This is achieved by inserting the USB, CD, or SD card into the computer port, rebooting the computer and commencing the imaging process, and recovering and storing the captured RAM data for analysis.</p><p>The ISeekDiscovery automaton provides a novel and highly effective means of searching for bogus files. If, for example, the practitioner wants to find all Word and Excel files on a machine that are misnamed or spelled wrong or have no extensions by type, all that is needed is to use the <span class="strong"><strong>auto capture</strong></span> feature by signature for Excel and Word, but to also use the <span class="strong"><strong>Search Exclusions</strong></span> tab, shown in the following screenshot, and add in the following file extensions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">*.xls</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">*.xlsx</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">*.doc</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">*.docx</code></li></ul></div><div class="mediaobject"><img src="graphics/B04931_07_23.jpg" alt="Detecting malware attacks and other exploits"/><div class="caption"><p>Excluding file extensions using ISeekDesigner</p></div></div><p>When this <a id="id581" class="indexterm"/>routine is run, it will remove the files<a id="id582" class="indexterm"/> with legitimate names, leaving only the ones that have bogus names. This should be helpful for intrusion detection because of the large number of security breaches caused by hidden hacker-executable code.</p></div><div class="section" title="The prevalence of anti-forensics processes and tools"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec130"/>The prevalence of anti-forensics processes and tools</h2></div></div></div><p>Obscuring and <a id="id583" class="indexterm"/>destroying evidence is not a new phenomenon and has emerged alongside digital forensics to challenge and frustrate evidence <a id="id584" class="indexterm"/>recovery. It consists of a broad range of software tools that obfuscate events linked to transgressions as well as deleting or modifying data. Anti-forensics may also be intended to delay the time it takes to complete an examination. Sometimes, it may cast doubt on the validity of the evidence later relied on in court. These tools often hide their existence and may persist on a device after it has been seized.</p><p>Specific uses of this illicit practice include:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Overwriting or altering data and metadata, including timestamps</li><li class="listitem" style="list-style-type: disc">Hiding and encrypting data and steganography (mentioned previously)</li><li class="listitem" style="list-style-type: disc">Encrypting folders, partitions, and network traffic</li><li class="listitem" style="list-style-type: disc">Using external devices that enable computers to be booted up but leave no trace of activities on the host machine</li></ul></div><p>Detecting <a id="id585" class="indexterm"/>anti-forensics activity is not necessarily an intuitive process, but the fact that it may have been done on a device being examined should always be considered. Tools that detect and even prevent anti-forensics activity seem in short supply, and there is certainly a case for further research into the problem.</p><p>This book will <a id="id586" class="indexterm"/>not promote or provide any information about these toolkits that are freely available on the Internet, but I acknowledge that they are already bringing into disrepute digital forensic tools that continue to be heavily relied upon. Of concern is the use of these tools to protect the guilty and possibly implicate the innocent. <a class="link" href="ch08.html" title="Chapter 8. Examining Browsers, E-mails, Messaging Systems, and Mobile Phones">Chapter 8</a>, <span class="emphasis"><em>Examining Browsers, E-mails, Messaging Systems, and Mobile Phones</em></span>, describes the Dark Web and the use of such anti-forensic tools to encrypt and hide information, such as Tor and 12P.</p></div></div>
<div class="section" title="Case study &#x2013; corroborating evidence using Windows Registry"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec57"/>Case study – corroborating evidence using Windows Registry</h1></div></div></div><p>This<a id="id587" class="indexterm"/> case study exemplifies how digital evidence should always be corroborated and verified whenever possible.</p><p>The case is related to downloading illegal child exploitation pictures and movie files. One of the potentially damaging files recovered was a pornographic picture of an underage child. The prosecution contended that this file had previously been displayed as the computer's desktop wallpaper, clearly visible on startup of the computer. It contended, not unreasonably, that it could hardly not have been noticed by the users of the computer, thus implicating the user's complicity in handling illegal, obscene material.</p><p>When seized, the computer desktop displayed an innocuous blank picture that raised no immediate interest. However, later examination of the computer located a <code class="literal">.jpg</code> file depicting an obscene image of an underage child. This disturbing image was located at <code class="literal">C:\Documents and Settings\xyz\Application Data\Opera\Opera\xxx.jpg</code>. The prosecution's practitioner demonstrated that on a confirmed date and time, <code class="literal">xxx.jpg</code> was converted to be used as the desktop wallpaper. A picture file of that name was located at <code class="literal">C:\Documents and Settings\xyz</code>, which was confirmed to be the default directory containing files and folders associated with the user account <code class="literal">xyz</code>.</p><p>Testing by the practitioner suggested that this entry is not created until a non-Windows-standard picture is applied as the desktop wallpaper. If the desktop is changed to another nonstandard picture, the Registry key is altered to reflect the new picture without maintaining a list of the old files. When a standard Windows picture is selected for the desktop, this key will remain to show the last used nonstandard picture.</p><p>Analysis <a id="id588" class="indexterm"/>of Registry entries relating to the <code class="literal">xyz</code> user account revealed that non-human intervention to create the desktop wallpaper and place the illegal image file in the user account was not evident but could not be entirely discounted, as traces of such events are not easily identifiable for further examination. In this instance, the system stored the usual background wallpaper bitmap in the wallpaper registry hotkey located at the <code class="literal">HKEY_CURRENT_USER\Control Panel\Desktop\Wallpaper</code> Registry key. Windows Registry does not record a history of the use of previous standard Windows files.</p><p>The metadata for <code class="literal">xxx.jpg</code> revealed creation, modified, and last-accessed dates, which correlated with Internet usage identified during the reconstruction of the offense timeline. Examination indicated that the file existed in another location on the computer, but no record of whether it was downloaded from the Internet or copied from an external device could be confirmed.</p><p>It is unlikely that the user would make the image the desktop wallpaper by manually installing it through a directory search through <code class="literal">C:\Documents and Settings\xyz \Application Data\Opera\Opera\</code>. What is more usual, and therefore more likely, is that the image was viewed through Opera and then set as the wallpaper by a user using the right mouse button. The file was also saved to the <code class="literal">xyz</code> folder, which suggests two manual processes that imply deliberate actions on the part of a user or users. These actions could be effected by the presence of malware such as a Trojan horse, but that seemed highly unlikely considering other testimony in the case.</p><p>Unfortunately, no data was available to show when the image was removed as wallpaper when some user reverted to a blank (black) screen choosing the default setting, <span class="strong"><strong>None</strong></span>, or no image in the desktop frame. This information would have provided a more precise time of the manipulation of at least one illegal file. VSS was not present on the Windows XP operating system, which, had it been, may have provided some clarification of such Registry changes.</p><p>While Registry can be helpful in many cases, in this instance, it left some uncertainty. This was most unhelpful when it was presumed that the users of the computer, tenants in the defendant's home as distinct from the actual owner who was charged with possession of child exploitation material, became aware of the law enforcement interest in the computer 14 hours before its seizure. It is suspected they removed the incriminating wallpaper in haste along with some other incriminating files, when it was later proven that the owner (defendant) had no access to the computer.</p><p>The owner had a cast-iron alibi showing he was in a different suburb at the time these deletions to the computer files were made. Had this been heeded at the time charges against the defendant were being prepared, it is unlikely that the case would have progressed to trial. On reflection, it seems that the investigating detectives and forensic practitioner did not see this glaring conflict in user access and did not attempt to determine the involvement of others with access to the computer. This is again a prime example of suspect-led investigation.</p><p>As the <a id="id589" class="indexterm"/>forensic examination of the device proceeded, it became clear that more than one local user had access to it. It was thought sound practice to determine whether a remote attack may have occurred and an outsider may have been responsible for the presence of the illegal files. The computer settings showed that the facility for an external user to access the computer was disabled at the time of seizure but not necessarily at the time of the relevant events.</p><p>The practitioner claimed that the computer was searched for malicious applications with no results. However, the defense practitioner located the <code class="literal">ZLOB.JN</code> Trojan horse downloader at <code class="literal">C:\Documents and Settings\xyz\My Documents\setup.exe</code>. The file was removed and quarantined by the defense practitioner pending further examination.</p><p>Unsubstantiated information about this malware ranges from describing it as a serious threat to a nuisance that slows down the computer and launches pop-up commands. Some observers claim that it can be used as a means of gaining access to a computer, allowing hackers to gain remote access. Some versions of Zlob automatically load on bootup and hide their presence by hijacking the Windows Explorer program. The Trojan has been claimed to have the ability to take complete control of the computer, but that claim was never substantiated.</p><p>Some commentary suggests that a Zlob infection will begin to take over the computer browser, causing constant popups, the redirection of a URL to other sites, the erasing of documents and images, and even invasion into personal information that can be erased or distributed to other websites. Manual Zlob removal requires some knowledge of the technical aspects of the target computer. It is difficult to remove because it is known for replicating itself under different names. Even if removed, it may have replicated and reinstalled itself on the computer.</p><p>Examination of the suspect Zlob file, <code class="literal">setup.exe</code>, showed it was created prior to the illegal activity recorded on the computer and it had not been identified or removed by the antivirus program. The Trojan horse reportedly creates a number of files in the system, including <code class="literal">stdole3.tlb</code>, and registry entries are created in an attempt to run <code class="literal">Troj/Zlob-JN</code> on startup, including<code class="literal"> HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\explorer\run wininet.dll</code> and<code class="literal"> HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\explorer\run regperf.exe</code>.</p><p>However, examination<a id="id590" class="indexterm"/> of the computer failed to locate these three files inside Windows Registry or on the computer. It seemed unlikely that an external attack had occurred, leaving the possibility that one or more of the local users were responsible for the illegal activity. Although this extra work by the defense practitioner to examine the possibility of an external attack proved fruitless, it had to be done, but why not by those laying the charges? The defendant was acquitted by the jury of the charge, but no further charges were laid against those others users implicated in using the computer.</p><p>To reiterate, ad nauseam, this case highlights the benefits of a counterargument forming an essential part of an examination, which then lends itself to search for exculpatory evidence, which, if it exists, may modify or refute an argument, for, to recall the simple yet powerful catchphrase of practitioner and academic <span class="emphasis"><em>Dardick</em></span> (2010): "here is nothing more deceptive than an obvious fact."</p></div>
<div class="section" title="References"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec58"/>References</h1></div></div></div><p>Dardick, G. S. 2010. "<span class="emphasis"><em>Cyber Forensics Assurance</em></span>." 8th Australian Digital Forensics Conference, Perth, Western Australia. SECAU: 57–64.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec59"/>Summary</h1></div></div></div><p>This chapter described the Windows operating system in some detail as well as other operating systems that are commonly examined, including Apple and Linux. Windows Registry, system files and logs, and some additional benefits of VSS recovery were introduced as a valuable resource for digital evidence recovery and analysis. The chapter also touched on remote access and malware attacks and the prevalence and challenges of anti-forensics that hamper the recovery and identification of evidence.</p><p>
<a class="link" href="ch08.html" title="Chapter 8. Examining Browsers, E-mails, Messaging Systems, and Mobile Phones">Chapter 8</a>, <span class="emphasis"><em>Examining Browsers, E-mails, Messaging Systems, and Mobile Phones</em></span>, will describe the processes of locating and recovering digital evidence relating to records of personal communications, including e-mails and browsing records stored in computer devices and telephonic communications retained on mobile phones. It will look specifically at the recovery of Internet browsing and search records and other messaging systems, including Skype and virtual private networks as well as e-mail analysis.</p><p>Mobile phone forensics will be introduced and its importance in forensic examinations will be discussed, along with the growing challenge of evidence acquisition from personal computing and GPS devices. The chapter will provide you with an appreciation of the value of locating, extracting, and examining records of communications between persons of interest stored on computers and mobile phones.</p></div></body></html>