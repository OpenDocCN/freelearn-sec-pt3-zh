<html><head></head><body>
		<div><h1 id="_idParaDest-36"><em class="italic"><a id="_idTextAnchor035"/>Chapter 2</em><strong class="bold">: Managing Threats, Vulnerabilities, and Risks </strong></h1>
			<p><em class="italic">"You can never eliminate all risks – focus on identifying highest risks and mitigate or remove". </em></p>
			<p><em class="italic">– Dianne Johansen - Security IT Director | IBM</em></p>
			<p>As a cybersecurity professional, you will have to deal with a plurality of vulnerabilities, threats, and risks. These three terms are normally used synonymously; however, they are very different, and it is very important that you understand how to approach and manage them.</p>
			<p>Now, you need to understand that<strong class="bold"> </strong><em class="italic">there are no risk-free systems</em> and your infrastructure and systems could (and will) fail at any time. Therefore, you must be prepared to ensure that your business continues (or resumes) operations if there is a disaster.</p>
			<p>In this second chapter, we will cover the following main topics:</p>
			<ul>
				<li><a id="_idTextAnchor036"/>What a vulnerability assessment is and how to create one</li>
				<li>The most common types of vulnerabilities</li>
				<li>An overview of USB HID vulnerabilities and devices</li>
				<li>The best mechanisms to keep your infrastructure protected against vulnerabilities </li>
				<li>Managing cybersecurity risks like a master</li>
				<li><a id="_idTextAnchor037"/>An overview of the NIST Cybersecurity Framework </li>
				<li>Creating an effective <strong class="bold">Business Continuity Plan</strong> (<strong class="bold">BCP</strong>)</li>
				<li>Implementing a best-in-class <strong class="bold">Disaster Recovery Plan</strong> (<strong class="bold">DRP</strong>)</li>
			</ul>
			<h1 id="_idParaDest-37"><a id="_idTextAnchor038"/>Technical requirements </h1>
			<p>You can enhance your reading by using a device with internet access to check some of the web resources provided. However, this chapter contains all that you need for a full learning experience.</p>
			<h1 id="_idParaDest-38"><a id="_idTextAnchor039"/>Understanding cybersecurity vulnerabilities and threats</h1>
			<p>All systems, processes, infrastructures, and environments have vulnerabilities. Those vulnerabilities <a id="_idIndexMarker122"/>are normally caused by design flaws, bugs, bad implementations, a lack of updates, and many other causes that attackers (or threat agents) will leverage in order to gain access to your systems and/or cause disruption.</p>
			<p><em class="italic">The question is not whether a system has vulnerabilities, but who will discover them first?</em></p>
			<h2 id="_idParaDest-39"><a id="_idTextAnchor040"/>Performing a vulnerability assessment </h2>
			<p>As a<a id="_idIndexMarker123"/> cybersecurity expert, you must be on the constant search for new vulnerabilities in order to keep your infrastructure secure.</p>
			<p>The process of performing this<a id="_idIndexMarker124"/> search is called <strong class="bold">v</strong><strong class="bold">ulnerability assessment</strong>.</p>
			<p>There are two main ways to do it. The first is to use offensive techniques (such as penetration testing), and the second one is more like a defensive technique based on the identification of known vulnerabilities on your infrastructure by searching for all the vulnerabilities associated with the systems and products that you have. </p>
			<p>One of the best<a id="_idIndexMarker125"/> places to visit to find those vulnerabilities is the <strong class="bold">Common Vulnerabilities and Exposures</strong> (<strong class="bold">CVE</strong>) website, which you can view at <a href="https://cve.mitre.org/">https://cve.mitre.org/</a>. </p>
			<p>This website has more than 130,000 vulnerabilities that are present on almost all major systems (including both software and hardware).</p>
			<p><em class="italic">Now, let me ask you, have you ever checked whether your printer is vulnerable?</em> Well, there<a id="_idIndexMarker126"/> are more than 200 vulnerabilities related to printers on this page; some <a id="_idIndexMarker127"/>of them <a id="_idIndexMarker128"/>are related to <strong class="bold">denial of service</strong>, <strong class="bold">remote code execution</strong>, <strong class="bold">buffer overflow</strong>, and more. So, if you haven't check whether the printers you manage are vulnerable, <em class="italic">do it now</em>!</p>
			<p><em class="italic">Do you or your company have a web page created in Joomla?</em> If yes, you will be surprised to know that there are more than 1,200 vulnerabilities listed there that are related to Joomla and that is just for Joomla because there are many more vulnerabilities<a id="_idIndexMarker129"/> for other CMS softwares:</p>
			<div><div><img src="img/Figure_2.1_B16290.jpg" alt="Figure 2.1 – Joomla vulnerabilities&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.1 – Joomla vulnerabilities</p>
			<p>As you can see, in <em class="italic">Figure 2.1</em>, the vulnerabilities are sorted by the date of discovery. However, in the description, those vulnerable can be related to older versions (such as version 3.9) or even newer versions (such as version 5.2.8).</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Many of these vulnerabilities are fixed through patches or updates (that is why it's so important to keep your systems up to date). However, there are many others that might not have a patch and will require you to perform some changes to the configuration in order to remove the vulnerability.</p>
			<p>Now, let's review the process that you need to follow to properly manage the vulnerabilities <a id="_idIndexMarker130"/>on your infrastructure like a pro!</p>
			<h2 id="_idParaDest-40"><a id="_idTextAnchor041"/>The vulnerability assessment process</h2>
			<p>Each company <a id="_idIndexMarker131"/>has its own unique way in which to perform a vulnerability assessment; however, most of them are based on the following stages.</p>
			<h3>Vulnerability identification</h3>
			<p>This step<a id="_idIndexMarker132"/> is about how you identify the vulnerabilities on your systems and networks. Here, you can use well-known tools such as vulnerability scanners or even a penetration test to perform an effective identification.</p>
			<h3>Vulnerability analysis</h3>
			<p>Once you identify <a id="_idIndexMarker133"/>a vulnerability, it is time to analyze it and gather as much information about it as possible. For example, you need to consider the following questions: <em class="italic">how much will it cost me if that vulnerability is exploited against my company?; how many people will be affected?; and what is the source of the vulnerability?</em>.</p>
			<p>It is very common to perform a <strong class="bold">Root Cause Analysis</strong> (<strong class="bold">RCA</strong>) to find the root cause of the vulnerability and the associated cost to fix it.</p>
			<h3>Risk assessment</h3>
			<p>This is <a id="_idIndexMarker134"/>about performing a risk assessment to evaluate the risk in terms of probability and impact (both qualitative and quantitative). But it is also used to determine other factors such as cost analysis, mitigation analysis, and more.</p>
			<h3>Vulnerability remediation</h3>
			<p>Once you have <a id="_idIndexMarker135"/>all of those analyses, you must proceed with the implementation of the <em class="italic">best remediation</em> (or, at the very least, the one selected by upper management) to reduce the risk associated with the vulnerability:</p>
			<div><div><img src="img/Figure_2.2_B16290.jpg" alt="Figure 2.2 – The vulnerability assessment process&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.2 – The vulnerability assessment process</p>
			<p>Notice that this process is <em class="italic">iterative</em> because any given remediation might introduce a new vulnerability into your infrastructure. </p>
			<h2 id="_idParaDest-41"><a id="_idTextAnchor042"/>When should you check for vulnerabilities? </h2>
			<p>You must<a id="_idIndexMarker136"/> constantly be on the lookout for new vulnerabilities; however, there are some events in which you must do an assessment to find new vulnerabilities. Here are some examples:</p>
			<ul>
				<li><strong class="bold">Before the purchase of any devices, systems, or software</strong>: Make sure that the manufacturer constantly releases patches for known vulnerabilities.</li>
				<li><strong class="bold">Every time a new system is acquired</strong>: There will be cases when a new system is acquired without your consent. So, in those cases, you will need to make sure that any vulnerability is fixed before implementation.</li>
				<li><strong class="bold">When a new business is acquired</strong>: This is to ensure their security policies match your security policies.</li>
				<li><strong class="bold">When a new office/branch location is opened</strong>: This is to check for vulnerabilities related to availability (or the redundancy of services) as well as physical security vulnerabilities.</li>
				<li><strong class="bold">When moving to another physical location</strong>: This is similar to the previous example. You need to make sure the new location does not add any new vulnerabilities regarding availability and physical security.</li>
				<li><strong class="bold">The contract of a new contractor</strong>: This is to make sure they don't bring equipment that could bring vulnerabilities to your environment; for example, a third party that is hired to perform a job in your company should not be using a non-supported operating system (such as Windows XP).</li>
			</ul>
			<p>Now, let's do an<a id="_idIndexMarker137"/> in-depth review of the most common types of vulnerabilities that you could face as a cybersecurity professional.</p>
			<h2 id="_idParaDest-42"><a id="_idTextAnchor043"/>Types of vulnerabilities</h2>
			<p>There are <a id="_idIndexMarker138"/>many types of vulnerabilities. However, here, I will try to summarize the most important ones.</p>
			<h3>Software vulnerabilities</h3>
			<p>Bugs, design<a id="_idIndexMarker139"/> flaws, backdoors, and zero-day <a id="_idIndexMarker140"/>are among the most common software vulnerabilities that you will face. The good thing is that there are several tools aimed at searching for those vulnerabilities, and we will review them in greater depth in <a href="B16290_13_Final_JC_ePub.xhtml#_idTextAnchor308"><em class="italic">Chapter 13</em></a>, <em class="italic">Vulnerability Assessment Tools</em>.</p>
			<h3>User vulnerabilities </h3>
			<p>Users are <a id="_idIndexMarker141"/>one of the most vulnerable factors in any <a id="_idIndexMarker142"/>organization and there are many reasons for this; for instance, you can have users who use a weak password, users who use the same passwords in all systems (both personal and professional), and users who leave unlocked systems unattended. The list goes on.</p>
			<p>However, this is very complex, so we will be addressing this vulnerability in more detail, including how you can protect against it, in <a href="B16290_04_Final_JC_ePub.xhtml#_idTextAnchor092"><em class="italic">Chapter 4</em></a>, <em class="italic">Patching Layer 8</em>. </p>
			<h3>Physical vulnerabilities </h3>
			<p>As if you don't<a id="_idIndexMarker143"/> have enough to take care of, you<a id="_idIndexMarker144"/> also need to check for vulnerabilities related to the building or campus where your systems are located. For example, you need to make sure that the building is not vulnerable to a given weather condition, which could disrupt your systems (such as flooding or water leaks). Additionally, you also need to evaluate the vulnerabilities related to your physical access systems; we will cover that in more detail in <a href="B16290_09_Final_JC_ePub.xhtml#_idTextAnchor213"><em class="italic">Chapter 9</em></a>, <em class="italic">Deep Diving into Physical Security</em>.</p>
			<h3>Web vulnerabilities </h3>
			<p>It is imperative <a id="_idIndexMarker145"/>that you check your web-facing<a id="_idIndexMarker146"/> devices and systems to see what others see and find any vulnerability so that you can patch it before someone else exploits it. There are several ways to find those web vulnerabilities, and we will explore many of them throughout this book. One very simple method that you can leverage to check whether your web resources are <a id="_idIndexMarker147"/>exposed is the <strong class="bold">Google Hacking Database</strong> (<strong class="bold">GHDB</strong>). This is a compilation of Google search keys (known as <strong class="bold">dorks</strong>) that <a id="_idIndexMarker148"/>enable you to leverage the Google search engine to discover exposed documents and information on websites and devices connected to the internet and indexed by Google.</p>
			<p>There are thousands of possible dorks that you can use to find vulnerabilities in your web resources, which could expose sensitive information such as usernames, passwords, directories, config files, tables, databases, documents, and more.</p>
			<p class="callout-heading">Do you want to learn more about the GHDB?</p>
			<p class="callout">On this page, you can find more than 5,000 dorks ready for you to use. I am sure that you will be shocked by what you find here: <a href="https://www.exploit-db.com/google-hacking-database">https://www.exploit-db.com/google-hacking-database</a>.</p>
			<p>There is a super cool application, called <strong class="bold">Damn Vulnerable Web Application</strong> (<strong class="bold">DWWA</strong>), that <a id="_idIndexMarker149"/>you can use to see and explore web vulnerabilities <em class="italic">in a controlled environment</em>. If you want to know more about this great application, jump to <a href="B16290_12_Final_JC_ePub.xhtml#_idTextAnchor287"><em class="italic">Chapter 12</em></a>,<em class="italic"> Mastering Web App Security</em>.</p>
			<h3>IoT vulnerabilities </h3>
			<p>IoT is a booming <a id="_idIndexMarker150"/>technology and almost all <a id="_idIndexMarker151"/>companies have some type of IoT implementation in their infrastructure. Therefore, it is very important that you analyze all IoT implementation to check for vulnerabilities.</p>
			<p>Sometimes, those devices are installed without the authorization of the security team, and the main risk is when they are left with default credentials. So, make sure all IoT implementation (even if it's just some gadgets) are properly configured.</p>
			<p>There are several websites that crawl the internet to look for vulnerable web pages. You can find a variety of sites that vary from pages that scan the internet for webcams with default passwords (such as <a href="https://www.insecam.org">www.insecam.org</a>) to more robust pages that scan several ports to find vulnerabilities on exposed systems.</p>
			<p>One of the best websites to do that is <a href="https://www.shodan.io">www.shodan.io</a>. This search engine allows you to find vulnerabilities<a id="_idIndexMarker152"/> on websites, IoT devices, webcams, databases, <strong class="bold">industrial control systems</strong> (<strong class="bold">ICSes</strong>), routers, network devices, and more. With a quick search, you will be impressed by the <em class="italic">huge</em> number of devices with default credentials on the web:</p>
			<div><div><img src="img/Figure_2.3_B16290.jpg" alt="Figure 2.3 – Shodan's search categories&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.3 – Shodan's search categories</p>
			<p>As you can see, in <em class="italic">Figure 2.2</em>, you can even search by categories on <a href="https://Shodan.io">Shodan.io</a> to find vulnerable <em class="italic">devices, cams, Databases, and even ICS systems</em> (we will review them in more detail in the following section).</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">You can use <a href="http://Shodan.io">Shodan.io</a> to look for vulnerabilities on your sites, systems, and devices exposed to the internet. The search engine allows you to look by URL, IP address, subnet, type of device, country, and more.</p>
			<p>I will expand <a id="_idIndexMarker153"/>this topic with many examples (including <a id="_idIndexMarker154"/>how to leverage IoT-enabled devices for security) in <a href="B16290_10_Final_JC_ePub.xhtml#_idTextAnchor231"><em class="italic">Chapter 10</em></a>, <em class="italic">Applying IoT Security</em>.</p>
			<h3>Vulnerabilities on SCADA/ICS </h3>
			<p>If your <a id="_idIndexMarker155"/>company does any type of<a id="_idIndexMarker156"/> manufacturing; has a smart building; uses smart systems to manage energy, waste, and water; or is in the business of smart cities, then it is very possible that they have some SCADA systems.</p>
			<p>Those systems are critical, and you need to ensure that they are protected as the impact of an attack on those systems is usually devastating for the company. One good example of the impact of this type <a id="_idIndexMarker157"/>of attack is <strong class="bold">Stuxnet</strong>. This state-backed attack was able to disrupt a nuclear power plant by targeting their SCADA systems.</p>
			<p>These systems are very complex, and, depending on the vendor, they can be very different from each other, making the task of securing them quite complex. However, there are some steps or best practices that you can apply to secure these systems:</p>
			<ul>
				<li>If possible, schedule maintenance services performed by the vendor, and make sure those services include a vulnerability assessment.</li>
				<li>Keep the devices up to date with the latest updates.</li>
				<li>Understand the protocols used by the system and look for associated vulnerabilities.</li>
				<li>Delete or disable unused users on the systems.</li>
				<li>Disable the features that are not in use by your organization to reduce the number of risks and possible vulnerabilities.</li>
				<li>Avoid the use of third-party plugins if not approved by the vendor.</li>
				<li>Disable remote access connections or mobile applications if not in use.</li>
				<li>Disable unused APIs.</li>
				<li>Apply network segmentation and isolate those devices from other web-facing systems.</li>
				<li>Restrict physical access to the management consoles of the devices.</li>
				<li>Make sure that all default users and passwords are changed for strong credentials.</li>
			</ul>
			<p>If your organization does not have any experience with these systems, the best practice is to hire a<a id="_idIndexMarker158"/> third-party company to either <a id="_idIndexMarker159"/>provide your team with training about how to secure those systems or have a contract with them in order to keep those systems secure.</p>
			<h3>Supplier vulnerabilities </h3>
			<p>Remember<a id="_idIndexMarker160"/> that <a id="_idIndexMarker161"/>the availability of your systems relies on your suppliers, so you need to analyze them to uncover any possible vulnerabilities associated with those suppliers (such as the internet provider, cloud provider, hardware provider, and more).</p>
			<h3>Client vulnerabilities </h3>
			<p>There could <a id="_idIndexMarker162"/>be cases in which you will have to <a id="_idIndexMarker163"/>connect your systems to the network or infrastructure of a partner or client; in those cases, you need to perform a detailed vulnerability assessment of those foreign systems to ensure they do not add additional vulnerabilities to your infrastructure.</p>
			<h3>Dependencies </h3>
			<p>One very<a id="_idIndexMarker164"/> important aspect to consider when doing a vulnerability<a id="_idIndexMarker165"/> assessment is identifying our system or infrastructure dependencies and then analyzing those dependencies to uncover any potential vulnerabilities. One clear example of this is a system that might consume artificial intelligence (such as a chatbot) through an API connection that, if down, will not work properly or <a id="_idIndexMarker166"/>can be spoofed.</p>
			<h3>Process vulnerabilities </h3>
			<p>Imagine that<a id="_idIndexMarker167"/> your company does <em class="italic">not</em> have a process <a id="_idIndexMarker168"/>regarding what to do when an employee leaves the company. In this scenario, one system administrator might just disable the user (which creates a residual risk), while another might delete the user (which could be a problem because you leave no traceability to that user). Therefore, both scenarios could cause a <a id="_idIndexMarker169"/>problem. This is why a missing, incomplete, or poorly designed <strong class="bold">Identity and Access Management</strong> process is, itself, a big vulnerability.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Starting a vulnerability assessment is probably the hardest part of the process because you might not know where to start. Here, my recommendation will be to first outline the <strong class="bold">vulnerability types</strong> as categories and then start looking for vulnerabilities in those areas. That will serve you as a starting point, but it will also help you to avoid leaving an entire category unassessed.</p>
			<p>Now, it is time to learn about one of the <em class="italic">biggest vulnerabilities</em> that is being exploited by attackers with physical access to a system: <strong class="bold">USB HID Vulnerabilities</strong>.</p>
			<h2 id="_idParaDest-43"><a id="_idTextAnchor044"/>USB HID vulnerabilities </h2>
			<p>This <a id="_idIndexMarker170"/>vulnerability should, ideally, have been a subtopic of the <em class="italic">Types of vulnerabilities</em> section. However, I decided to create an entire section dedicated to these vulnerabilities because they are a very common and <em class="italic">dangerous</em> vulnerability that is present in almost all companies and infrastructures. Therefore, it is key that you clearly understand them and be prepared to apply a plurality of methods, systems, strategies, and techniques to effectively protect your company against them.</p>
			<h3>A real and dangerous threat</h3>
			<p>What makes <a id="_idIndexMarker171"/>this vulnerability so relevant is that it is present in almost all systems regardless of the operating system. In fact, the chances are that all your systems (including computers, tablets, laptops, and even servers) have this vulnerability:</p>
			<p><em class="italic">"USB HID-based vulnerabilities are considered one of the worst IT threats ever discovered." </em></p>
			<p class="hidden"><em class="italic">– Rhonda Childress</em></p>
			<p>The reason is that it leverages two factors that are present in almost all systems: <strong class="bold">a USB connection and HID drivers</strong>.</p>
			<p>Another factor that makes this threat even more dangerous (and relevant) is the price of the hardware needed. In fact, to leverage this vulnerability, you just need a board with the ATMEGA 32U4 chipset, which (as shown in <em class="italic">Figure 2.4</em>) can be found on several cheap boards (below $5):</p>
			<div><div><img src="img/Figure_2.4_B16290.jpg" alt="Figure 2.4 – ATMEGA 32U4 boards&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.4 – ATMEGA 32U4 boards</p>
			<p>Now, let's take a deeper look at the technical side of this attack and some examples.</p>
			<h3>What are HID drivers?</h3>
			<p>Almost <a id="_idIndexMarker172"/>all <a id="_idIndexMarker173"/>systems will allow human inputs (that is, interactions with the system), and that is done through a device such as a mouse or a keyboard. Therefore, to make our life easier, a set of generic drivers were created and loaded in all operating systems to make almost all keyboards and mice truly <strong class="bold">Plug and Play</strong> devices. This was very convenient for users until they were exploited by attackers to perform keystroke attacks.</p>
			<h3>The beginning of USB HID attacks</h3>
			<p>When working as <a id="_idIndexMarker174"/>a system administrator, my friend and founder of Hak5 Darren Kitchen was tired of typing the same commands to fix devices. So, he programmed a development board to emulate the typing for him; thus, the <em class="italic">keystroke injection attack was born</em>.</p>
			<h3>How does the attack work?</h3>
			<p>This is very<a id="_idIndexMarker175"/> simple; when the malicious USB device is connected, the device presents itself as an HID device (either a keyboard or a mouse), and since HID devices are trusted by default, the malicious device will now have full access to inject any code or commands into the target system. However, since this is a low-level attack, the code needed to inject the keystrokes was a bit complex, that was, until the arrival of the <strong class="bold">USB Rubber Ducky</strong> and <strong class="bold">Rubber Ducky Scripts</strong>.</p>
			<h2 id="_idParaDest-44"><a id="_idTextAnchor045"/>Types of USB HID attacks</h2>
			<p>While <a id="_idIndexMarker176"/>the <strong class="bold">UBS Rubber Ducky</strong> was the first commercial device that leverages this vulnerability, nowadays, many other devices can be used to leverage this vulnerability. Here, we will explore the most famous ones. </p>
			<h3>USB Rubber Ducky</h3>
			<p><em class="italic">"Looks like a flash drive – types like a keyboard".</em></p>
			<p>A few <a id="_idIndexMarker177"/>years ago, Darren Kitchen from Hak5 introduced<a id="_idIndexMarker178"/> the <strong class="bold">USB Rubber Ducky</strong>, a USB device that is capable of exploiting this USB vulnerability and allows you to inject almost any payload onto the target machine: </p>
			<div><div><img src="img/Figure_2.5_B16290.jpg" alt="Figure 2.5 – The USB Rubber Ducky specification&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.5 – The USB Rubber Ducky specification</p>
			<p>While this tool was created for system administrators and penetration testers, the risk of this device<a id="_idIndexMarker179"/> being used by an attacker is very <a id="_idIndexMarker180"/>high:</p>
			<p><em class="italic">"As we know from experience, trust is difficult to build and easy to break. The USB Rubber Ducky – with its flash drive appearance – breaks trust by deceiving the human operator into thinking it's innocuous. Likewise – by mimicking a keyboard – it deceives the computer into thinking it's a human. A simple lie is so effective when computers, by design, are built to inherently trust humans – and to be perfectly honest, I don't want to live in a world where they don't." </em></p>
			<p class="hidden"><em class="italic">– Darren Kitchen</em></p>
			<h4>USB Rubber Ducky scripts</h4>
			<p>One of the best<a id="_idIndexMarker181"/> contributions to the penetration testing and system administrator community was the introduction of the <strong class="bold">Ducky Scripts</strong>, a super simple (and elegant) language that allows you to write payloads for a plurality of <em class="italic">malicious USB HID devices</em> using any text editor:</p>
			<div><div><img src="img/Figure_2.6_B16290.jpg" alt="Figure 2.6 – Ducky Script Sample&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.6 – Ducky Script Sample</p>
			<p>As you can see, in the preceding screenshot, creating Ducky Script is very easy and intuitive. In this example, you use <strong class="bold">REM</strong> to add a comment, then add a <strong class="bold">Delay</strong> of 3,000 milliseconds, which is a good practice on these kinds of scripts because it waits 3 seconds before executing the actions. This allows enough time for Windows to load all of the drivers and make sure that the device is ready when executing the attack. </p>
			<p>Then, it opens Command Prompt (<strong class="bold">Windows + R</strong>) and adds another small delay (to make sure the system has enough time to open the <em class="italic">run</em> window). Then, it injects some <em class="italic">keystrokes</em> to open a program with a given set of parameters. In this example, we open <strong class="bold">Internet Explorer</strong> in kiosk mode (full screen) and then open a page that emulates a system update, as shown<a id="_idIndexMarker182"/> in the following screenshot (an update from Steam): </p>
			<div><div><img src="img/Figure_2.7_B16290.jpg" alt="Figure 2.7 – A fake update screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.7 – A fake update screen</p>
			<p>This is a harmless example that could just cause some panic to the user, but without any real damage. However, an attacker can perform a lot of very dangerous attacks using this kind of device, such as exfiltrating your data to a remote server, executing a reverse shell, stealing user credentials, and more.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Do you want to know more about Ducky Script? Here is the link to the official Git Wiki where you can learn more about how to create your own script along with many examples, including DNS poisoning attacks, OSX attacks, and more: <a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki">https://github.com/hak5darren/USB-Rubber-Ducky/wiki</a>.</p>
			<p>While the USB <a id="_idIndexMarker183"/>Rubber Ducky was the pioneer device that leveraged this vulnerability, there are many other devices that also leverage USB HID vulnerabilities.</p>
			<h3>Bash Bunny</h3>
			<p>The Bash <a id="_idIndexMarker184"/>Bunny by Hak5 is one of the world's most advanced <a id="_idIndexMarker185"/>USB attack platforms. This small and powerful USB enables the attacker to perform a plurality of attacks with a single device. So, while the USB Rubber Ducky just has capabilities to inject keystrokes, the Bash Bunny has additional capabilities such as USB ethernet control, mass storage, and a serial console (essentially, the device is a small Unix box). To make this even more dangerous, the Bash Bunny allows the attacker to combine all of the preceding capabilities, making this device a serious<a id="_idIndexMarker186"/> threat to your infrastructure. If you want to know more, please refer to <a href="http://www.bashbunny.com">http://www.bashbunny.com</a>.</p>
			<h3>WHID Injector </h3>
			<p>Previous <a id="_idIndexMarker187"/>examples have a limitation because <a id="_idIndexMarker188"/>attacks need to be preloaded on the device, but what if you want to inject your payloads remotely? Well, this is exactly what you can do with <a id="_idIndexMarker189"/>the <strong class="bold">WHID</strong> (<a href="https://github.com/whid-injector/WHID">https://github.com/whid-injector/WHID</a>). </p>
			<p>The WHID is based on inexpensive (but powerful) hardware that works over the <em class="italic">ESPloitV2</em> software to perform the remote injection of commands. To make the attackers' lives easier, you can use an app to control the injections remotely. The app is available<a id="_idIndexMarker190"/> on <strong class="bold">nethunter</strong> at <a href="https://store.nethunter.com/en/packages/whid.usb.injector/">https://store.nethunter.com/en/packages/whid.usb.injector/</a>.</p>
			<h3>P4wnpi</h3>
			<p>This is a <a id="_idIndexMarker191"/>very cool <a id="_idIndexMarker192"/>project that <a id="_idIndexMarker193"/>uses a <strong class="bold">Raspberry Pi Zero</strong> (which is a wonderful IoT-enabled single-board computer) to perform a plurality of USB HID attacks:</p>
			<div><div><img src="img/Figure_2.8_B16290.jpg" alt="Figure 2.8 – The Raspberry Pi Zero with a USB A port&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.8 – The Raspberry Pi Zero with a USB A port</p>
			<p>One of the characteristics that make this attack very dangerous is that the <strong class="bold">Raspberry Pi Zero W</strong> has Wi-Fi capabilities built-in, enabling the attacker to execute actions <a id="_idIndexMarker194"/>remotely and even exfiltrate data to an external server in real time.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Would you like to create your own cybersecurity device using an IoT-enabled Raspberry Pi? If yes, then I will show you how to do it in <a href="B16290_10_Final_JC_ePub.xhtml#_idTextAnchor231"><em class="italic">Chapter 10</em></a>, <em class="italic">Applying IoT Security</em>.</p>
			<p>If you want to<a id="_idIndexMarker195"/> increase your cybersecurity skills and become <a id="_idIndexMarker196"/>a cybersecurity <a id="_idIndexMarker197"/>researcher, then I highly encourage you to use IoT devices such as a <strong class="bold">Raspberry Pi</strong> or an <strong class="bold">ESP8266</strong> to perform your own testing.</p>
			<h3>USB Harpoon</h3>
			<p>You might<a id="_idIndexMarker198"/> be thinking that connecting a USB drive<a id="_idIndexMarker199"/> could be very suspicious (which is true), but that can be solved with a few social engineering skills.</p>
			<p>However, to overcome that limitation, researchers embedded a <strong class="bold">BadUSB</strong> device into a charging cable to masquerade the attack and create this new threat called the <strong class="bold">USB Harpoon.</strong></p>
			<p><em class="italic">Now you can start being paranoid every time you see a USB cable in your company because even the cable used to power up a USB fan can be a </em><strong class="bold">USB Harpoon</strong>.</p>
			<h3>Vulnerable USB dongles</h3>
			<p>Researchers <a id="_idIndexMarker200"/>have found some vulnerabilities <a id="_idIndexMarker201"/>on a number of USB dongles, which will enable an attacker to inject keystrokes. This is a more dangerous scenario because the attacker will leverage a legitimate <a id="_idIndexMarker202"/>USB HID device to perform the attack. Please refer to CVE-2019-13052, CVE-2019-13053, CVE-2019-13054, and CVE-2019-13055.</p>
			<h3>USB Samurai</h3>
			<p>Simply, you<a id="_idIndexMarker203"/> can combine the power of the WHID, the <a id="_idIndexMarker204"/>stealth of the USB Harpoon, and the vulnerabilities on USB dongles, and you will have a USB Samurai! This is a dangerous device that looks like a standard USB cable but enables an attacker to inject remote keystrokes to the victim's computer (all under <em class="italic">$5</em>):</p>
			<div><div><img src="img/Figure_2.9_B16290.jpg" alt="Figure 2.9 – USB Samurai components&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.9 – USB Samurai components</p>
			<p><em class="italic">Figure 2.9</em> shows the basic components of the USB Samurai: a normal USB type A cable along with a vulnerable USB universal keyboard dongle.</p>
			<h3>Smartphone-based USB HID attacks</h3>
			<p>To make<a id="_idIndexMarker205"/> the USB HID vulnerability<a id="_idIndexMarker206"/> even more dangerous, attackers can now leverage <em class="italic">USB OTG capabilities</em> on smartphones to perform USB HID attacks.</p>
			<p>To achieve this, the attacker will <a id="_idIndexMarker207"/>use <strong class="bold">Nethunter</strong>, which is a Kali Linux distribution for Android devices (cellphones and tablets). To find out more about this attack, please visit the official repository at <a href="https://github.com/offensive-security/kali-nethunter/wiki/NetHunter-HID-Attacks">https://github.com/offensive-security/kali-nethunter/wiki/NetHunter-HID-Attacks</a>.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">If they are familiar with Rubber Ducky attacks, an attacker can use a tool on <strong class="bold">Nethunter</strong>, called <strong class="bold">DuckHunter HID</strong>, which<a id="_idIndexMarker208"/> will allow them to quickly and easily <em class="italic">convert USB Rubber Ducky Script into NetHunter HID Attacks format</em>: <a href="https://www.kali.org/docs/nethunter/nethunter-duckhunter/">https://www.kali.org/docs/nethunter/nethunter-duckhunter/</a>.</p>
			<p>There is even another tool that attackers can execute on the smartphone that leverages this HID <a id="_idIndexMarker209"/>vulnerability, called a <strong class="bold">BadUSB MITM attack</strong>. Here, the attacker can launch a man-in-the-middle attack by just connecting to the target machine using a USB OTG cable.</p>
			<p>To learn more, please refer to <a href="https://www.kali.org/docs/nethunter/nethunter-badusb/">https://www.kali.org/docs/nethunter/nethunter-badusb/</a>.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">There are many other attacks available on <strong class="bold">Nethunter</strong>. You can view their official site to learn more about them at <a href="https://www.kali.org/kali-linux-nethunter/">https://www.kali.org/kali-linux-nethunter/</a>.</p>
			<p>As you can <a id="_idIndexMarker210"/>see, in the examples we have presented, there are far too many possibilities and far too many options available for an attacker to leverage this vulnerability. Therefore, being aware of this vulnerability is the very first step for you to effectively protect against them.</p>
			<h2 id="_idParaDest-45"><a id="_idTextAnchor046"/>A false sense of security</h2>
			<p>I am shocked<a id="_idIndexMarker211"/> at how companies have not realized the danger of USB HID vulnerabilities. In fact, most companies have the USB ports of their employees who give face to face services to external customers completely exposed! Even more crazy is that I have witnessed many banks having the computers of customer service agents on a desktop, which completely exposes the USB port to the public:</p>
			<div><div><img src="img/Figure_2.10_B16290.jpg" alt="Figure 2.10 – Small form factor PC with one exposed USB port facing the customer&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.10 – Small form factor PC with one exposed USB port facing the customer</p>
			<p>Therefore, I decided<a id="_idIndexMarker212"/> to talk with the CTO of the bank to understand the reasoning (if any) for <em class="italic">exposing the USB</em> ports of the computers of client-facing employees by having them over the desktop. His response was astonishing: <em class="italic">"Having the computer over the desktop helps in terms of maintenance because the computers get less dust."</em> At first, I thought that his response was a joke, but after a few seconds of uncomfortable silence, I sadly realized that it was not.</p>
			<p>My next question was to ask whether he was aware of the risk that it represents, and his reply was this: <em class="italic">"Do not worry about the USB, they are disabled, so there is no risk if someone connects a USB drive."</em> Then, I realized that his vulnerability assessment was based on USB mass storage attacks but not against USB keystroke attacks.</p>
			<p>Knowing that there was a good chance that those computers were vulnerable to USB HID attacks, I asked for permission to connect my USB drive, and he agreed with a smile on his face (as though he knew that I was wasting my time). At that point, I always carry a USB Rubber Ducky with a simple script that does two simple tasks:</p>
			<ol>
				<li>Change the background to an image that looks like it was infected by a virus.</li>
				<li>Kill <code>explorer.exe</code> to make it look as though all of the desktop files have gone.</li>
			</ol>
			<p>This happened very quickly. At first, he seemed shocked, then he looked at me, and before I had the opportunity to explain to him what had happened, I was kicked out of the bank!</p>
			<p>The problem was that his lack of understanding of USB vulnerabilities gave him a false sense of security, which made him (and the bank) even more vulnerable to USB HID attacks.</p>
			<p>I later discovered that he was, in fact, just using a Windows policy (as shown in the following screenshot) to block mass storage USB drives. Of course, that will not protect him against any<a id="_idIndexMarker213"/> USB HID attacks: </p>
			<div><div><img src="img/Figure_2.11_B16290.jpg" alt="Figure 2.11 – Disabling mass storage device classes on Windows systems&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.11 – Disabling mass storage device classes on Windows systems</p>
			<p>To understand why this happened, we need to understand how the USB protocol works. </p>
			<h3>Understanding the USB protocol</h3>
			<p>Every time you<a id="_idIndexMarker214"/> connect a USB device, first, it will identify the speed of the device. Then, it will get the device descriptors, which, essentially, help with the identification of the device.</p>
			<p>One of the descriptors is the USB class, which tells the computer what kind of device you are connecting to; for example, consider the following:</p>
			<ul>
				<li>Class 01h  audio device (such as speakers)</li>
				<li>Class 03h  HID device (such as a mouse, a keyboard, or a Rubber Ducky device)</li>
				<li>Class 08h  mass storage (such as a USB drive or an external hard drive)</li>
			</ul>
			<p>This is where the magic happens because, based on the example of the bank, they were protecting against devices Class 08h, but all Class 03h devices were able to connect directly without even a warning message.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">If you want to know more about the USB protocol, I suggest you take a look at <a href="https://www.usb.org/sites/default/files/hid1_11.pdf">https://www.usb.org/sites/default/files/hid1_11.pdf</a>. This document explains, in detail, all you need to<a id="_idIndexMarker215"/> know about how this protocol works and how it interacts with the host machine.</p>
			<p>Therefore, we need to find a way to protect our systems against Class 03h (that is, USB HID devices).</p>
			<h2 id="_idParaDest-46"><a id="_idTextAnchor047"/>Protecting against USB HID attacks</h2>
			<p>By now, you<a id="_idIndexMarker216"/> should be aware (and more likely worried) of the danger of USB HID vulnerabilities. So, now, it's time for me to give you some tools, techniques, and methods that you can implement to effectively defend your infrastructure against them.</p>
			<h3>Leveraging Windows security logs</h3>
			<p>Every time <a id="_idIndexMarker217"/>an external <a id="_idIndexMarker218"/>device is connected, Windows will generate a <strong class="bold">Security Event</strong> log entry with <strong class="bold">Event ID 6416</strong> (<a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-6416">https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-6416</a>).</p>
			<p>Using this, you can look for traces of attacking devices (such as Rubber Ducky) to detect any attacks. </p>
			<p>To achieve that, we need to take into account that most of the devices used in those attacks are based on two microcontrollers: the famous <strong class="bold">atmega32u4</strong> (which is present on the Arduino Nano, Arduino Micro, and Teensy) and the small <strong class="bold">ATtiny8</strong> (which is present on the Digispark and the Beetle USB). </p>
			<p>The good thing is that both are created by the same company, <strong class="bold">ATMEL</strong>, and that information is key because it will allow us to detect whether the device that is connected is a <a id="_idIndexMarker219"/>real keyboard or a tiny evil device:</p>
			<pre>idVendor              0x03EB Atmel Corp.
idProduct             0x2FF4
iManufacturer         1 ATMEL AVR
iProduct              2 HID Keyboard</pre>
			<p>Another option is to perform a search by the <strong class="bold">device ID</strong>:</p>
			<pre>USB\ \VID_1B4F&amp;PID_9208</pre>
			<p>To automate this process, you can also leverage a log monitoring system to search for the values mentioned previously and trigger some alerts.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Be aware that all these values (the device ID, vendor ID, and more) can be spoofed. Therefore, while this is a good defense, it needs to be complemented with additional methods in order to protect you against even the most advanced attacks.</p>
			<p>As mentioned earlier, while most of the devices currently used for these attacks are <strong class="bold">ATMEL</strong>-based, you <a id="_idIndexMarker220"/>might also need to check for other devices used for these attacks <a id="_idIndexMarker221"/> such as the <strong class="bold">Raspberry Pi</strong>, which uses a CPU from Broadcom. </p>
			<h3>Windows Defender</h3>
			<p>You can also <a id="_idIndexMarker222"/>use Windows Defender to <a id="_idIndexMarker223"/>detect a number of USB HID attacks.</p>
			<p>Since these attacks are based on scripts, you can leverage their predictability to detect them based on a sequence of events.</p>
			<p>The code is very simple; first, it monitors for new USB HID device connections. If a connection is detected, then it will check whether a Command Prompt or PowerShell window is open in the next <em class="italic">x</em> seconds. If yes, chances are that someone has plugged in a bad USB (or that a system administrator was desperate to open Command Prompt to test his new <a id="_idIndexMarker224"/>keyboard):</p>
			<pre>//Identify USB HID Devices
let MalPnPDevices =
    MiscEvents
    | where ActionType == "PnpDeviceConnected"
    | extend parsed=parse_json(AdditionalFields)
    | sort by EventTime desc nulls last 
    | where parsed.DeviceDescription == "HID Keyboard Device"
    | project PluginTime=EventTime, ComputerName,parsed.ClassName, parsed.DeviceId,         parsed.DeviceDescription, AdditionalFields;
//check if a cmd or powershell is executed in the next 10 seconds
ProcessCreationEvents
| where ProcessCommandLine contains "powershell" or
        ProcessCommandLine startswith "cmd"         
| project ProcessCommandLine, ComputerName, EventTime, ReportId, MachineId
| join kind=inner MalPnPDevices on ComputerName
| where (EventTime-PluginTime) between (0min..10s)</pre>
			<p>Do you recall the WHID device? Well, you can add one line of code to specifically detect that device by using their device ID:</p>
			<pre>| where DeviceId == @"USB\VID_1B4F&amp;PID_9208\HIDFG"</pre>
			<p>Remember, this defense mechanism is based on the predictable nature of the attack; however, it has some flaws. For example, in the code provided, it will listen for a Command Prompt window to open in the next 10 seconds, but if the attacker has added a delay on the script of 11 seconds, then you are doomed.</p>
			<p>If you want<a id="_idIndexMarker225"/> to know more in regard to <a id="_idIndexMarker226"/>additional<a id="_idIndexMarker227"/> security settings using the Windows Defender <strong class="bold">Advanced Threat Protection</strong> (<strong class="bold">ATP</strong>), please refer to <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/device-control/control-usb-devices-using-intune">https://docs.microsoft.com/en-us/windows/security/threat-protection/device-control/control-usb-devices-using-intune</a>.</p>
			<h3>DuckHunt</h3>
			<p>This is a <a id="_idIndexMarker228"/>very cool script created by Pedro Sosa that fixed <a id="_idIndexMarker229"/>the preceding problem in a very clever way. Essentially, he modified a keystroke program, which he developed, to add a timestamp after each keystroke is detected. </p>
			<p>With that information, you can determine the typing speed and whether the typing speed is above normal (let's say, between 10 and 20 characters in one second). Then, the system will flag that as an injection attack and block any USB HID inputs.</p>
			<p>The following is what a Ducky Script attack looks like:</p>
			<pre>C:\Users\Robotin&gt;This is a scripted attack and now I can inject my payload at lightning speed…..HAHAHA</pre>
			<p>This is an example of how <strong class="bold">DuckHunt</strong> will stop the Ducky Script (USB HID injection) attack:</p>
			<pre>C:\Users\Robotin&gt;This is a scri_</pre>
			<p>DuckHunt has many <a id="_idIndexMarker230"/>extra features. If you want to explore them, you can visit the official site at <a href="https://github.com/pmsosa/duckhunt">https://github.com/pmsosa/duckhunt</a>.</p>
			<h3>USB lock</h3>
			<p>This is a very <a id="_idIndexMarker231"/>basic solution based on placing a lock<a id="_idIndexMarker232"/> mechanism to physically prevent the connection of new USB devices. However, this device has several downsides, including the following:</p>
			<ul>
				<li>It has a high cost.</li>
				<li>A lot of effort is required to implement it.</li>
				<li>A lot of effort is required to maintain it.</li>
				<li>It is not suitable for remote workers or BYOD.</li>
				<li>It is not suitable for sellers or users who are constantly on the move or traveling:</li>
			</ul>
			<div><div><img src="img/Figure_2.12_B16290.jpg" alt="Figure 2.12 – An example of a USB lock mechanism&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.12 – An example of a USB lock mechanism</p>
			<p>Additionally, as <a id="_idIndexMarker233"/>you can see, in <em class="italic">Figure 2.12</em>, the key that is used for these devices is pretty basic, making most of those solutions very vulnerable to lock picking.</p>
			<h3>USB blocker</h3>
			<p>When applying <a id="_idIndexMarker234"/>security measures to a systems, you need <a id="_idIndexMarker235"/>to make sure that the solution implemented does not affect the usability of the system and this may be the case.</p>
			<p>This utility, provided by GIGABYTE, blocks the port by device type. This means that if you select to block HID, you won't be able to use your USB mouse and keyboard, which could be a very bad idea.</p>
			<h3>Protecting against vulnerable USB dongles</h3>
			<p>This is a<a id="_idIndexMarker236"/> very serious<a id="_idIndexMarker237"/> threat. So, first, make sure that you don't have vulnerable USB dongles on your personal devices (or even on your family and friends' devices). </p>
			<p>On the other hand, on a corporate level, you can take the following steps: </p>
			<ol>
				<li value="1">Create a list of the vulnerable devices (that is, just search for a vulnerable USB dongle to get the latest list). </li>
				<li>Some vendors release a patch to fix the vulnerability. However, it will be very hard for you to ensure that all of the connected dongles are patched, so you should consider that when creating your policies.</li>
				<li>Make sure your company does not purchase vulnerable devices.</li>
				<li>Check whether there are vulnerable devices in your company assets and patch or replace them.</li>
				<li>Additionally, create (and distribute) a policy to restrict employees from using vulnerable<a id="_idIndexMarker238"/> devices on corporate assets (including the list of vulnerable devices and models).</li>
			</ol>
			<p>By now, you should clearly understand the concept of <strong class="bold">cybersecurity vulnerabilities</strong>. However, identifying the vulnerabilities is just the first step in the game. Now, it's time to go ahead and understand how to manage, evaluate, respond, and monitor those vulnerabilities to improve the security of our infrastructure.</p>
			<h1 id="_idParaDest-47"><a id="_idTextAnchor048"/>Managing cybersecurity risks</h1>
			<p><strong class="bold">Risk management</strong> is a <a id="_idIndexMarker239"/>very interesting topic, and there are hundreds of books and certifications about this topic. However, instead of giving you a lot of overwhelming information, I will try to summarize all the available knowledge regarding risk management, tropicalize it to the cybersecurity environment, and present you with just the right information you need in order to manage your risks like a pro!</p>
			<p>To make this simple, let's define a risk as an event that will have an impact on your systems or infrastructure if a given condition is met. Those events are normally triggered by a threat (or a threat agent) that leverages a given vulnerability.</p>
			<p>Now, the process of identifying and analyzing the impact and the probability of that event happening is called risk management.</p>
			<p>All systems and infrastructures have a plurality of associated risks, so it is crucial that you identify and mitigate them as early as possible.</p>
			<p>There are many methodologies and frameworks to manage risks, and while most of them are very similar, the name of the concepts differ slightly; however, I will focus on the most recognized approaches to make this easier for you. </p>
			<p>Now, let's view <a id="_idIndexMarker240"/>the details of each of the four steps (<strong class="bold">risk identification</strong>, <strong class="bold">risk assessment</strong>, <strong class="bold">r</strong><strong class="bold">isk response</strong>, and <strong class="bold">risk monitoring</strong>) to manage your cybersecurity risks like a <em class="italic">master</em>. </p>
			<h2 id="_idParaDest-48"><a id="_idTextAnchor049"/>Risk identification</h2>
			<p>First, you <a id="_idIndexMarker241"/>need to <em class="italic">identify</em> the risks associated with your infrastructure or systems. Now, let me share some tips that will help you here:</p>
			<ol>
				<li value="1"><strong class="bold">Make a detailed and extensive inventory of your assets</strong>: Most of the time, risks are not discovered because <em class="italic">ghosts</em> or legacy systems have not been identified, so it is key that you start by doing a thorough discovery of your assets to make sure that all your infrastructure and systems are covered.</li>
				<li><strong class="bold">The ongoing discovery of new assets</strong>: Remember that this is an ongoing task and that you need to regularly scan your environment and network to uncover any new devices that have been added to your infrastructure.</li>
				<li><strong class="bold">Asset evaluation</strong>: A good practice here is to evaluate your assets to determine which are critical for your organization (that is, your crown jewels) so that you can justify a higher investment to defend them. This will also help you in terms of prioritization and risk analysis.<p class="callout-heading">Tip</p><p class="callout">Don't do this alone; ask for help and support! It will be hard for you to come up with a complete list of risks from your desk, so instead, take advantage of the experience of the system administrators, IT personnel, and end users to help you discover potential risks.</p></li>
			</ol>
			<p>During this identification process, you will have to create a <strong class="bold">risk register</strong>, which is a database of all of the identified risks. There are hundreds of templates that you can use, and all of them vary in terms of their size and the number of columns used. However, you can create your<a id="_idIndexMarker242"/> own risk register using Excel. Just make sure you include the minimal factors, as follows:</p>
			<ul>
				<li><strong class="bold">Risk_ID</strong>: The unique identifier of the risk.</li>
				<li><strong class="bold">Description</strong>: A clear and concise description of the risk.</li>
				<li><strong class="bold">Risk_Owner</strong>: The person who is in charge of monitoring the risk.</li>
				<li><strong class="bold">Risk_Trigger</strong>: The event(s) that will convert the risk into an issue.</li>
				<li><strong class="bold">Risk_Category</strong>: To help you better manage all risks, it's recommended that you create groups of risks; for example, physical access, network, software, web apps, and more.</li>
				<li><strong class="bold">Probability</strong> (<strong class="bold">Qualitative</strong>): Here, you can use 3 or 5 ratings (such as insignificant, low, medium, high, and critical).</li>
				<li><strong class="bold">Impact</strong> (<strong class="bold">Qualitative</strong>): Rate the impact to the business if the risk is materialized.</li>
				<li><strong class="bold">Risk_Response</strong>: Describe the kind of response you implemented to reduce the probability and/or impact of the risk (such as mitigate, transfer, and so on):</li>
			</ul>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_2.13_B16290.jpg" alt="Figure 2.13 – An example of a risk register &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.13 – An example of a risk register </p>
			<p>There are many other fields that you can<a id="_idIndexMarker243"/> include, such as <strong class="bold">Risk_Source</strong>, in which you can specify whether the risk is coming from an internal or external threat (either man-made or <a id="_idIndexMarker244"/>environmental).</p>
			<p>Now that you have the risks identified, you need to assess them.</p>
			<h2 id="_idParaDest-49"><a id="_idTextAnchor050"/>Risk assessment</h2>
			<p>As the name<a id="_idIndexMarker245"/> suggests, this step is about assessing the risk in terms of <em class="italic">probability</em> of occurrence and business <em class="italic">impact</em>.</p>
			<p>There are two ways in which to do this type of assessment: qualitative and quantitative.</p>
			<h3>Quantitative analysis</h3>
			<p>Let's pause<a id="_idIndexMarker246"/> for a second to let me ask you a question:</p>
			<p><em class="italic">If you have an asset that costs $500,000, would you invest $75,000 to protect that asset?</em></p>
			<p>That is a tricky question because, regardless of whether you answer is yes or no, what really matters here is that you support your answer with <em class="italic">numbers</em> as this will tell you whether you will be getting that budget or not.</p>
			<p>The good news is that there are several tools and methodologies that you can use to give you those numbers. However, even better than this is knowing that you can use three simple formulas to gather those numbers.</p>
			<p>First, you need to determine the <em class="italic">value of the asset</em> that will be affected if the risk materializes. Second, you also need to determine <em class="italic">how much of the asset will be impacted</em>. For example, let's imagine that, in the case of an earthquake, 25% of your company's data center is affected, so if the value of the data center is $100,000, then the damage caused by an earthquake will be $25,000. This can be expressed with the following formula:</p>
			<p><em class="italic">Single Loss Expectancy (SLE) = Asset Value * Exposure Factor</em></p>
			<p>However, if you are trying to determine how much you should invest <em class="italic">by year</em> in response to that risk, then you will have to perform two more calculations:</p>
			<ol>
				<li value="1">Determine how likely it is for that risk to materialize every 12 months, where 1 means once per year, and once every 5 years is equal to = 1/5 (0.2). The resulting value is <a id="_idIndexMarker247"/>known as the <strong class="bold">annualized rate of occurrence</strong> (<strong class="bold">ARO</strong>).</li>
				<li>Now that you know the cost of the risk and the probability of the risk occurring every 12 months, you can multiply those two values to determine the average cost of the risk by year: <em class="italic">Annual Loss Expectancy (ALE) = SLE * ARO</em>.<p class="callout-heading">Important note</p><p class="callout">Remember my tricky question from earlier? Well, now you can use the preceding formulas to determine in which scenarios it will make sense to invest those $75,000 on the remediations or controls (for instance, you don't want to apply a risk response that is more expensive than the cost of the materialization of the risk).</p></li>
			</ol>
			<p>Now, let's <a id="_idIndexMarker248"/>examine how you can categorize the risk not with numbers but with words, which is an easier and faster analysis.</p>
			<h3>Qualitative analysis</h3>
			<p>This is a more<a id="_idIndexMarker249"/> subjective analysis, as it is based on the opinion of an expert (or group of experts) who provides a rating based on a scale. Normally, those scales are on 3 or 5 levels, but some companies use customized values.</p>
			<p>The most common way to do this analysis is by using a 5 x 5 matrix to correlate the <em class="italic">probability</em> and <em class="italic">impact</em> to get the average criticality of the risk. As you can see, in the following table, a risk with a low probability but a high impact will be considered a moderate risk, while a risk with a high probability and a moderate impact will be considered a major risk:</p>
			<div><div><img src="img/Figure_2.14_B16290.jpg" alt="Figure 2.14 – A 5 x 5 risk matrix &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.14 – A 5 x 5 risk matrix </p>
			<p>The value of the correlation (<strong class="bold">Minor</strong>, <strong class="bold">Moderate</strong>, <strong class="bold">Major</strong>, or <strong class="bold">Severe</strong>) is the one that will be used to rank the risk.</p>
			<p>As mentioned <a id="_idIndexMarker250"/>earlier, this is a subjective assessment. So, a good practice will be to analyze groups in order to gather their inputs, as that might help to reduce the bias of the result.</p>
			<h2 id="_idParaDest-50"><a id="_idTextAnchor051"/>Risk response</h2>
			<p>At this point, you<a id="_idIndexMarker251"/> know your risks and have them prioritized based on the probability of occurrence and business impact. Now, it is time to determine the best mechanism, strategy, or control for that risk and to make your life easier. The responses can be divided into four categories:</p>
			<ul>
				<li><strong class="bold">Mitigate</strong>: This is the most common response; in fact, the word "mitigation" is often used synonymously with risk response because it is the default action that is considered when responding to a risk. Mitigation is based on the application of a control, system, mechanism, or strategy that is aimed to reduce the probability or impact of the risk to an acceptable level. Some examples of mitigation are the <a id="_idIndexMarker252"/>installation of <strong class="bold">Biometric Access Control</strong>, the installation <a id="_idIndexMarker253"/>of an <strong class="bold">Intrusion Prevention System</strong>, and performing a security test before releasing a system.</li>
				<li><strong class="bold">Transfer</strong>: There will be cases where the mitigation is either too expensive or difficult to implement (due to a lack of knowledge or resources). In those cases, you might want to transfer the risk to a third party. One typical example is to apply insurance (to recover the cost of the device) or to subcontract a service with a third party (for example, sometimes, it is cheaper to host your servers on a secure data center, rather than applying that level of security to your own data center).</li>
				<li><strong class="bold">Avoid</strong>: Now, imagine that there is a new client-facing app with a beautiful GUI. However, you have done some research and have found that the system has several <em class="italic">unfixed vulnerabilities</em> identified that could expose client data. In this case, the best way to deal with this risk is to <em class="italic">avoid</em> purchasing the system. </li>
				<li><strong class="bold">Accept</strong>: This is the least recommended option, and it should only be used as a last resort when the other three options are not suitable. For example, if the risk of someone accessing a legacy server is very low and the impact is also very low because it <a id="_idIndexMarker254"/>is a testing server and the hosted data is not sensitive, and the cost of the mitigation is $100,000, then you might just decide to accept the risk and use your budget to support the response of more critical risks.<p class="callout-heading">Important note</p><p class="callout">We talked about using insurance for hardware; however, you can also apply insurance to other non-tangible assets, such as the loss of data, and even to cover some other risks, such as data breaches or the liabilities that have originated from it. </p></li>
			</ul>
			<p>Now, let's view the last step of this process, which is normally overlooked, but it is key to ensure that risks are current and managed on an ongoing basis.</p>
			<h2 id="_idParaDest-51"><a id="_idTextAnchor052"/>Risk monitoring</h2>
			<p>Risk management<a id="_idIndexMarker255"/> should be an iterative process, and this final step is aimed to ensure that risks are constantly <strong class="bold">identified</strong>, <strong class="bold">evaluated</strong>, and <strong class="bold">addressed</strong>. A risk evaluated as <em class="italic">minor</em> might change to <em class="italic">severe</em> over time, so the response should <a id="_idIndexMarker256"/>be also adjusted based on that change.</p>
			<h1 id="_idParaDest-52"><a id="_idTextAnchor053"/>The NIST Cybersecurity Framework</h1>
			<p>The NIST Cybersecurity <a id="_idIndexMarker257"/>Framework was designed to help cybersecurity professionals better assess and improve their capabilities to <strong class="bold">identify</strong>, <strong class="bold">protect</strong>, <strong class="bold">detect</strong>, <strong class="bold">respond</strong>, and <strong class="bold">recover</strong> from a cyber attack. This framework <a id="_idIndexMarker258"/>is based on the following five domains.</p>
			<h2 id="_idParaDest-53"><a id="_idTextAnchor054"/>Identify</h2>
			<p>The goal here<a id="_idIndexMarker259"/> is to understand our environment, including our assets, the business environment, governance, the risk management strategy, and more.</p>
			<p>As you might have noticed, asset identification is key in regard to cybersecurity. However, I would like to highlight that while this might sound obvious, many companies have suffered attacks due to a lack of understanding and awareness of their own infrastructure, systems, and devices.</p>
			<h2 id="_idParaDest-54"><a id="_idTextAnchor055"/>Protect</h2>
			<p>Now that you <a id="_idIndexMarker260"/>know your environment, it's time to protect it. The framework proposes the following mechanisms (these are self-explanatory, so there is no need to deep dive into them):</p>
			<ul>
				<li>Access control</li>
				<li>Awareness and training</li>
				<li>Data security</li>
				<li>Information protection processes and procedures</li>
				<li>Maintenance</li>
				<li>Protective technology</li>
			</ul>
			<h2 id="_idParaDest-55"><a id="_idTextAnchor056"/>Detect</h2>
			<p>There will be <a id="_idIndexMarker261"/>many cases in which an attacker will be able to bypass your protection systems and layers, so, in those cases, you should be able to detect those threats. To achieve this, the framework suggests the following:</p>
			<ul>
				<li><strong class="bold">Detecting anomalies and events</strong>: Detect all malicious activity in a timely manner, including the potential impact associated.</li>
				<li><strong class="bold">Security continuous monitoring</strong>: Maintain the monitoring of your IT systems and assets to identify any events and the effectiveness (or weaknesses) of the protective measures.</li>
				<li><strong class="bold">Detection processes</strong>: Make sure you develop, update, and share all the processes and procedures aimed to detect cybersecurity events.</li>
			</ul>
			<h2 id="_idParaDest-56"><a id="_idTextAnchor057"/>Respond</h2>
			<p>This domain is <a id="_idIndexMarker262"/>about the application of appropriate actions to take against a given cybersecurity event:</p>
			<ul>
				<li><strong class="bold">Response planning</strong>: Make sure that you have all the processes and procedures in place to ensure a timely and effective response to cybersecurity events.</li>
				<li><strong class="bold">Communications</strong>: This is a critical (and, normally, forgotten) task regarding how you communicate any cybersecurity event with internal and external stakeholders.</li>
				<li><strong class="bold">Analysis</strong>: This is an analysis of the responses to measure their effectiveness.</li>
				<li><strong class="bold">Mitigation</strong>: This refers to activities aimed to mitigate the impact of the cybersecurity event.</li>
				<li><strong class="bold">Improvements</strong>: This uses the lessons learned to support a continuous improvement model.</li>
			</ul>
			<h2 id="_idParaDest-57"><a id="_idTextAnchor058"/>Recover</h2>
			<p>This domain is about the <a id="_idIndexMarker263"/>activities required to restore the business capabilities and services that have been impacted by a cybersecurity event:</p>
			<ul>
				<li><strong class="bold">Recovery planning</strong>: All of the planning events are required to ensure the timely restoration of the systems and assets affected.</li>
				<li><strong class="bold">Improvements</strong>: This refers to the improvement of all the planning events based on the lessons learned.</li>
				<li><strong class="bold">Communications</strong>: This involves managing communications with internal and external stakeholders associated with the impacted systems (for instance, vendors, providers, victims, and more).</li>
			</ul>
			<p>The first four domains are very similar to what we reviewed during the risk management process, so there is no need to expand on them. However, the last domain is very interesting and important because all companies should be prepared to face a disaster and ensure the continuity of their business after that, and that is what we will review in the next section.</p>
			<h1 id="_idParaDest-58"><a id="_idTextAnchor059"/>Creating an effective Business Continuity Plan (BCP)</h1>
			<p><em class="italic">The question is not whether a disaster will happen, not even when it will happen, but if you will be prepared when it does happen</em>.</p>
			<p>By nature, human<a id="_idIndexMarker264"/> beings tend to think that negative situations will happen to everyone but themselves. The problem with that way of thinking is that even when they know about the histories of other companies that have lost everything after a cyber attack, only a few companies will invest in a plan to ensure the continuity of their business after a cyber incident.</p>
			<p>The three main drivers for companies to create a <em class="italic">BCP</em> are as follows:</p>
			<ul>
				<li>Those that are based on regulatory requirements from governments or international agencies</li>
				<li>A contractual requirement from the clients</li>
				<li>Self-awareness of the value of the BCP</li>
			</ul>
			<p>Now, I know how hard it is to get the funding and resource<a id="_idTextAnchor060"/>s required to create an effective BCP, so here are some key points gathered by market research experts (such as the Gartner group, the US National Archives and Records Administration in Washington, the US<strong class="bold"> Federal Emergency Management Agency</strong> (<strong class="bold">FEMA</strong>), Bloomberg, and the University of Texas), which highlight the results of companies becoming victims of security attacks and not having an effective continuity plan:</p>
			<ul>
				<li>93% of companies that lost their data center for more than 10 days filed for <em class="italic">bankruptcy</em> within one year after the disaster.</li>
				<li>94% of<a id="_idIndexMarker265"/> companies suffering from a catastrophic data loss do not survive – 43% never reopen and 51% close within two years.</li>
				<li>50% of all tape backups fail to restore.</li>
				<li>Companies that are not able to resume operations within 10 days of the disaster are not likely to survive.</li>
				<li>Between 40% and 60% of small businesses never reopen their doors after a disaster.</li>
			</ul>
			<p>Also, let me share some additional statistics regarding the BCP on big corporations:</p>
			<div><div><img src="img/Figure_2.15_B16290.jpg" alt="Figure 2.15 – BCP statistics&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.15 – BCP statistics</p>
			<p><em class="italic">The numbers don't lie: you can leverage these numbers to highlight the global cybersecurity landscape in order to get support and resources from executive stakeholders and sponsors to create/maintain your BCP/DRP.</em></p>
			<p>Now, the first step toward creating a BCP is to have a deep understanding of the company (that is, its processes, departments, hierarchy, functions, and roles) and how any potential disruption can impact the capability of the company to continue its core business; this<a id="_idIndexMarker266"/> is called <strong class="bold">Business Impact Analysis</strong> (<strong class="bold">BIA</strong>).</p>
			<h2 id="_idParaDest-59"><a id="_idTextAnchor061"/>Creating a Business Impact Analysis (BIA)</h2>
			<p>Again, there are <a id="_idIndexMarker267"/>many templates available on the internet that you can use to create a BIA. Some of them are very complex and might be overkill for medium-sized companies. On the other hand, there are very simplistic templates that might be a good fit for small to medium-sized companies, but they will not be granular or detailed enough for a big corporation. However, the important thing here is not the template, but how to fill it properly. Let's review all of the<a id="_idIndexMarker268"/> concepts that you need to understand to create a world-class BIA.</p>
			<h3>Mission essential functions</h3>
			<p>All <a id="_idIndexMarker269"/>processes <a id="_idIndexMarker270"/>are important; however, you need to identify which are supporting processes and which are the essential processes required to run the business. For example, if your company manufactures cars, then the manufacturing process is essential and must be up and running to avoid losing money. In contrast, there are other supporting functions such as accounting that, although very important, a disruption of that process might not have the same impact.</p>
			<h3>The identification of critical systems</h3>
			<p>You must <a id="_idIndexMarker271"/>identify the systems <a id="_idIndexMarker272"/>that are critical for your company. For example, an email server is very important for your company, but the company might still be able to run the core business even when the email server is down. However, on the other hand, if your company business is selling clothes online, then your company will lose money and clients every minute (or second) that the web page is down.</p>
			<h3>The recovery time objective (RTO)</h3>
			<p>The RTO <a id="_idIndexMarker273"/>represents the time <a id="_idIndexMarker274"/>that a company must spend to restore those processes, activities, or operations after suffering a disaster.</p>
			<p>Defining the RTO is not a simple task because executives will always want to have this close to zero, but ultimately, the lower the RTO, the higher the cost associated. So, be realistic when defining this number to avoid shooting yourself on the foot.</p>
			<p>Keep in mind that some executives will try to look for an overall RTO for the entire company. However, <em class="italic">you should define RTOs at a lower level</em> (by process, activity, department, or task) because that will help you to identify gaps or points in which more resources will be required to support it. For example, the RTO to restore the manufacturing line after a disaster must be lower than the RTO to restore email services. In the following table, you can see how to map a service to the criticality of the data managed and the associated RTO and RPO:</p>
			<div><div><img src="img/Figure_2.16_B16290.jpg" alt="Figure 2.16 – The RPO/RTO by the criticality of the data&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.16 – The RPO/RTO by the criticality of the data</p>
			<p>Now, let's take look at the other important metric, the <strong class="bold">recovery point objective</strong> (<strong class="bold">RPO</strong>).</p>
			<h3>The recovery point objective (RPO)</h3>
			<p>This<a id="_idIndexMarker275"/> refers to how much data<a id="_idIndexMarker276"/><a id="_idIndexMarker277"/> loss is acceptable after a disaster. In other words, how much data you need to recover after a disaster. However, here is the tricky part; even if we talk about data, that data is not measured in size but in time, so it is not about how many bits you recover, but to which point in time you must recover the data. For example, if you have an email server, then losing the emails received in the last hour may be acceptable, so an RPO of 1 hour is fine. In contrast, if you lose 1 hour of payment records, then that might not be acceptable. In that situation, the RPO will be between 1 and 10 seconds. In the following diagram, you can see the correlation between the RPO and the RTO:</p>
			<div><div><img src="img/Figure_2.17_B16290.jpg" alt="Figure 2.17 – An example of RPO and RTO&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.17 – An example of RPO and RTO</p>
			<p>These two metrics are based on downtime and data loss. However, there is another important <a id="_idIndexMarker278"/>metric to determine<a id="_idIndexMarker279"/> the reliability of your systems and that is by measuring how frequently a system is expected to be down: the <strong class="bold">mean time between failures</strong> (<strong class="bold">MTBF</strong>).</p>
			<h3>Mean time between failures (MTBF)</h3>
			<p>This metric<a id="_idIndexMarker280"/> is normally<a id="_idIndexMarker281"/> used by a manufacturer to determine the average product lifetime; however, this metric is very useful when you want to justify an investment to replace a <em class="italic">faulty</em> legacy system. For example, let's imagine you have 20 wireless access points that were installed on the same day. Then, you realize that one failed after 200 days, the second one after 400 days, and the third one after 600 days. That means that in 1,200 days, you got three failures, so, by dividing that, you will get an MTBF for the wireless access points of 400 days.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">If you are in charge of cybersecurity, then it is your responsibility to detect <em class="italic">faulty</em> systems and provide alternatives to replace them before they cause a major disaster. This is because if that system causes an outage, then all fingers will point to you. So, be proactive!</p>
			<p>Another useful metric is to determine the <em class="italic">average time it takes to perform a given maintenance activity</em>, such as rebooting a server or replacing hardware. This is important because you can use that time, in the future, to better forecast the time needed for <a id="_idIndexMarker282"/>said <a id="_idIndexMarker283"/><a id="_idIndexMarker284"/>activity. This metric is called the <strong class="bold">mean time to repair</strong> (<strong class="bold">MTTR</strong>).</p>
			<h3>Mean time to repair (MTTR)</h3>
			<p>As its name<a id="_idIndexMarker285"/> suggests, this refers to<a id="_idIndexMarker286"/> the estimated time that it will take to restore, replace, or repair a system or device after a failure. This could be the time it takes your team to repair it (in-house) or the time it will take for the vendor to repair or replace it (based on a given SLA). The MTTR is associated with the impact to the business caused by the absence of that device. For example, replacing the hard drive in a laptop of an end user could take 3 days (to gather information regarding the hard drive, purchase the hard drive, and install the hard drive), while replacing the hard drive of a server might have a higher priority and the MTTR could be 1 hour (that is, the alert is received, the part is identified, and the part is replaced from the local inventory).</p>
			<h3>Availability</h3>
			<p>Are you still<a id="_idIndexMarker287"/> wondering about the value of knowing the MTBF and the MTTR? Well besides the benefits mentioned earlier, you can also use them to calculate the availability of your service.</p>
			<p>This is a very interesting metric that you can use to report the status of your systems to the upper management and justify any previous and future investments. For example, let's imagine that your web server went down twice in the last 400 days (MTBF = 200 days) and that the MTTR was 3 hours (MTTR = 0.125 days). Therefore, if the device failed every 200 days and it takes 0.125 days to get it restored, then it means that availability is equal to <code>200 / (200 + 0.125)</code>, which means that, in this case, the availability of our web server is <em class="italic">99.9375%</em>.</p>
			<p><em class="italic">Availability = MTBF / (MTBF + MTTR)</em></p>
			<p>Now, is that 99.9375 good? Well, that depends on your business. However, data centers use a <strong class="bold">Tiers</strong> approach to determine their level of availability, so you can use those values as a point of reference:</p>
			<ul>
				<li><strong class="bold">Tier 1</strong>: 99.671% availability (this is equal to 28.8 hours of downtime annually).</li>
				<li><strong class="bold">Tier 2</strong>: 99.741% availability (this is equal to 22 hours of downtime annually).</li>
				<li><strong class="bold">Tier 3</strong>: 99.982% availability (this is equal to 1.6 hours of downtime annually).</li>
				<li><strong class="bold">Tier 4</strong>: 99.995% availability (this is equal to 26.3 minutes of downtime annually).<p class="callout-heading">Tip</p><p class="callout">Are you looking for a way to objectively support the decision about having a solution hosted in-house or with a third party? Well, you can analyze the current availability, and contrast that against the availability offered by the vendor to determine which solution is best for your business.</p></li>
			</ul>
			<p>A good way to<a id="_idIndexMarker288"/> enhance the availability of your infrastructure is by finding the devices that could jeopardize the uptime of your systems and infrastructure. Those devices are known as <strong class="bold">single points of failure</strong>.</p>
			<h3>A single point of failure</h3>
			<p>As mentioned<a id="_idIndexMarker289"/> earlier, a key aspect to <a id="_idIndexMarker290"/>enhance the availability of your systems and infrastructure is by identifying the critical devices that could impact the <em class="italic">uptime of your systems</em>. Once identified, you must ensure that those systems have the highest level of security to reduce the risk associated with them, and, as you probably guessed, these devices must have the lowest MTBF and MTTR.</p>
			<p>Additionally, you need to take the necessary steps to ensure that redundancy is in place for those single-point-of-failure devices to avoid unplanned downtimes:</p>
			<div><div><img src="img/Figure_2.18_B16290.jpg" alt="Figure 2.18 – An example of a single point of failure&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.18 – An example of a single point of failure</p>
			<p><em class="italic">Figure 2.18</em> is an<a id="_idIndexMarker291"/> example of how network <a id="_idIndexMarker292"/>devices are a common single point of failure.</p>
			<h3>Who creates the BIA?</h3>
			<p>The creation <a id="_idIndexMarker293"/>of the BIA is a joint effort in which each leader of the department or unit is in charge of assessing their organization and creates the BIA. However, there should be someone leading and coordinating the creation of them, as well as providing guidance and support in terms of how to create it. Depending on the company structure, normally, that task relies on the risk manager or the BCP manager. However, if this role is not present in your organization, I suggest you take over this role because, ultimately, you will be the one to benefit the most from its creation.</p>
			<h2 id="_idParaDest-60"><a id="_idTextAnchor062"/>Business Continuity Planning (BCP)</h2>
			<p><em class="italic">The guide to the beginning of the end!</em></p>
			<p>The goal of<a id="_idIndexMarker294"/> the BCP is to have a set of policies, processes, procedures, mechanisms, and tools that are ready to be used to reduce the impact of a disruptive event. Now, let's take a look at what you need to do to create a BCP.</p>
			<h3>Defining the scope and objectives</h3>
			<p>A good <a id="_idIndexMarker295"/>plan is a well-defined plan. So, here, we will start by laying the ground for a good BCP:</p>
			<ul>
				<li><strong class="bold">Scope</strong>: Determine the scope of the BCP (for instance, departmental, corporate, country base, and more).</li>
				<li><strong class="bold">Objectives</strong>: Highlight the objective of the BCP based on corporate guidelines.</li>
				<li><strong class="bold">Assumptions</strong>: Add any relevant assumptions that could be useful for readers.</li>
				<li><strong class="bold">Document owner</strong>: Outline who owns the document.</li>
				<li><strong class="bold">Document version</strong>: Outline the current version of the document.</li>
				<li><strong class="bold">Distribution list</strong>: Outline to whom should this document should be distributed.</li>
				<li><strong class="bold">Identify key stakeholders</strong>: Outline a list of stakeholders with their roles and responsibilities.</li>
			</ul>
			<h3>Risk assessment</h3>
			<p>You don't have<a id="_idIndexMarker296"/> to create another risk assessment. Instead, this is about leveraging your risk assessment as one of the inputs for the BCP; just make sure it includes the following items:</p>
			<ul>
				<li><strong class="bold">Risk description</strong>: Make sure the listed risks include clear descriptions that can be understood by others outside of the IT team.</li>
				<li><strong class="bold">Residual risks and secondary risks</strong>: List any residual or secondary risks.</li>
				<li><strong class="bold">Risks source</strong>: Make sure the risks are categorized by the source (for example, environmental, man-made, and more).</li>
			</ul>
			<h3>Business impact analysis</h3>
			<p>We already<a id="_idIndexMarker297"/> know how to create a BIA (so, there is no need to review it again). However, there is a lot of debate regarding what needs to be created first: the BCP or the BIA (this is similar to the chicken and the egg dilemma).</p>
			<p>The general consensus from experts is that it is better to have the BIA created, as that is an input for the BCP. Another way to do this is to make them in parallel; however, the effort required<a id="_idIndexMarker298"/> to make both at the same time could be overwhelming.</p>
			<h3>Business continuity strategies</h3>
			<p>This is probably<a id="_idIndexMarker299"/> the biggest aspect of the BCP, as this will contain all the strategies, processes, procedures, and other relevant information that supports the continuity of the business: </p>
			<ul>
				<li><strong class="bold">Definitions of the processes and procedures</strong>: Define all the processes and procedures in place to ensure the continuity of the business after a cyber incident or service disruption.</li>
				<li><strong class="bold">Team responsibilities</strong>: Determine the roles and responsibilities of the different teams related to business continuity.</li>
				<li><strong class="bold">Law and regulation requirements</strong>: List all of the laws and regulations applicable and the associated impact in the case of a cyber incident.</li>
				<li><strong class="bold">Preventive controls and mitigations</strong>: Mention what controls and mitigations are in place to ensure the continuity of the business.</li>
				<li><strong class="bold">Definition of the triggers</strong>: Outline when to trigger the controls and mitigations to avoid business disruption.</li>
				<li><strong class="bold">Alternate sites</strong> (<strong class="bold">data</strong>): List all the information related to alternative sites in the case of a disruption on the main systems.</li>
				<li><strong class="bold">Alternative locations</strong> (<strong class="bold">employees</strong>): Include all the information related to an alternative location in which to move operations in the case of a service disruption.</li>
				<li><strong class="bold">Alternative providers and procurement</strong>: Provide a list of available alternative <a id="_idIndexMarker300"/>providers of goods and services in the case of issues with current providers.</li>
			</ul>
			<h3>Employee safety</h3>
			<p>The priority <a id="_idIndexMarker301"/>of every company should <em class="italic">always</em> be the safety of their employees, so as a good practice, a BCP must include a section that contains, at the very least, the following items:</p>
			<ul>
				<li><strong class="bold">Evacuations</strong>: All information related to the evacuation plans on the company locations</li>
				<li><strong class="bold">Emergency kits</strong>: Information related to emergency kits (for instance, availability, location, contents, expiration dates, and more)</li>
				<li><strong class="bold">Roles and responsibilities</strong>: The roles and responsibilities of the emergency response teams</li>
				<li><strong class="bold">Emergency contacts</strong>: The contact information of the members of the emergency response teams</li>
			</ul>
			<h3>Communications</h3>
			<p>The management<a id="_idIndexMarker302"/> of communications in the case of a cybersecurity incident is one of the most important aspects of how a company deals with an event. The lack of good planning here could damage one of the most precious assets of all organizations: their reputation and brand. Therefore, make sure you, at the very least, include the following in your plan:</p>
			<ul>
				<li><strong class="bold">Internal communications</strong>: These are guidelines regarding how to manage communications if there is a cyber incident.</li>
				<li><strong class="bold">Stakeholder communications</strong>: These are guidelines regarding how to manage communications with corporate stakeholders if there is a cyber incident.</li>
				<li><strong class="bold">Media communications</strong>: These are guidelines regarding how to manage communications with external entities (such as the media, social media channels, and <a id="_idIndexMarker303"/>more) if there is a cyber incident.</li>
			</ul>
			<h3>Testing and reviews</h3>
			<p>A company <a id="_idIndexMarker304"/>might invest a lot of resources<a id="_idIndexMarker305"/> to create a BCP. The plan might look great, and the boss may love it, but how do you know whether it will work? Well, here you need to consider the following:</p>
			<ul>
				<li><strong class="bold">Testing guidelines</strong>: How the BCP will be tested and how the testing will be measured.</li>
				<li><strong class="bold">Testing schedule</strong>: Determine when the testing will be performed (for example, how often) or what events will trigger a test.</li>
				<li> <strong class="bold">Testing manager</strong>: Who will be responsible for the test?</li>
			</ul>
			<h3>Updates and maintenance</h3>
			<p>Risks <a id="_idIndexMarker306"/>changes and threats evolve, so the BCP <a id="_idIndexMarker307"/>should also evolve. Therefore, make sure you include this section to keep the plan relevant and up to date:</p>
			<ul>
				<li><strong class="bold">Update policy</strong>: Outline how, when, what, and who will be in charge of updating this BCP.</li>
				<li><strong class="bold">Revision history</strong>: Include a version history of the changes to each version of the BCP.</li>
			</ul>
			<p>If you include all the preceding steps, then you will have a very detailed and powerful BCP that will help you to ensure that your company will survive after a service disruption or cyber incident. The following diagram shows the main causes of IT service disruption or downtime:</p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_2.19_B16290.jpg" alt="Figure 2.19 – Common causes of downtime&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.19 – Common causes of downtime</p>
			<p>But what <a id="_idIndexMarker308"/>happens if the BCP fails? For example, what <a id="_idIndexMarker309"/>would happen if the power generator fails? What if the alternate site is not accessible? That would be a disaster, and you need to be prepared for that. You can do that by having a <strong class="bold">Disaster Recovery Plan</strong> (<strong class="bold">DRP</strong>).</p>
			<h1 id="_idParaDest-61"><a id="_idTextAnchor063"/>Implementing a best-in-class DRP</h1>
			<p>Are you confused <a id="_idIndexMarker310"/>about the scope of the DRP and the BCP? Well, don't worry because that is very common. In fact, a quick search on the topic will show you that even authors don't agree on the boundaries of those two terms; however, let me try to make it as simple as possible.</p>
			<p>The differences between the BCP and the DRP are as follows:</p>
			<ul>
				<li>The DRP can be considered as a subset of the overall BCP.</li>
				<li>The DRP is about restoring a critical server in the case of a disaster (reactive).</li>
				<li>The BCP is about preventing business downtime (proactive).</li>
				<li>The BCP is business-related (processes), while the DRP is more IT-related (systems and data).</li>
				<li>The BCP can be applied during normal operations to prevent disruptions, while DRP is just executed if there is a disaster.</li>
			</ul>
			<p>Now that we know the differences between the two, let's move ahead to understand how to create<a id="_idIndexMarker311"/> an efficient DRP.</p>
			<h2 id="_idParaDest-62"><a id="_idTextAnchor064"/>Creating a DRP</h2>
			<p>Here is an <a id="_idIndexMarker312"/>overview of the items that you must include when creating a DRP:</p>
			<ul>
				<li><strong class="bold">Scope</strong>: Here, you must define the scope of the DRP. While, normally, companies just create an overall DRP, there are cases in which you will find benefits in creating segmented DRPs; for example, one for systems, one for networks, and one for data. </li>
				<li><strong class="bold">Assumptions</strong>: Identify all the assumptions that are relevant to this DRP. One example of a common assumption is that certain items are covered in the BCP (such as backups, redundancies, and failovers).</li>
				<li><strong class="bold">Activation criteria</strong>: Identify the triggers to consider if an event is a disaster. For example, if there is a power outage and the mitigation strategy (such as secondary power generators) is not working.</li>
				<li><strong class="bold">Scenarios and response strategies</strong>: Here, you need to include a set of scenarios that can be considered as disasters and outline how to mitigate them to restore your business operations. For example, the local server is down and the secondary server on the cloud is not accessible.<p>Be creative! In fact, it's better to consider some unusual scenarios such as a pandemic or a war (even if they might never happen) than not considering them and becoming affected by them. In the following diagram, you can view some example sources of disasters:</p></li>
			</ul>
			<div><div><img src="img/Figure_2.20_B16290.jpg" alt="Figure 2.20 – Possible triggers of disasters&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.20 – Possible triggers of disasters</p>
			<ul>
				<li><strong class="bold">Disaster recovery requirements</strong>: What do you need if there is a disaster? For example, this could include technical requirements, operational requirements, communication requirements, backup requirements, redundancy requirements, documentation requirements, regulation requirements, and client requirements.</li>
				<li><strong class="bold">Disaster recovery procedures</strong>: What procedures need to be followed if there is a disaster? For example, they could include communication management, remote access procedures, access control (both physical and logical), and more.</li>
				<li><strong class="bold">Roles and responsibilities</strong>: Who is responsible or accountable for various tasks if <a id="_idIndexMarker313"/>there is a disaster (that is, who will be in charge of networks? Who will be in charge of servers? And who will be in charge of VoIP?).</li>
			</ul>
			<h2 id="_idParaDest-63"><a id="_idTextAnchor065"/>Implementing the DRP</h2>
			<p>A DRP is useless<a id="_idIndexMarker314"/> if you don't know how to implement it. So, let's take a look at some best practices when implementing a DRP:</p>
			<ul>
				<li>Make sure you have a plurality of providers (including some contracts or agreements) if you require a service in the case of a disaster. For example, make sure you have agreements (and the equipment) in place to obtain services from other ISPs if your secondary provider is also down. As my grandma says, <em class="italic">"Don't put all your eggs in the same basket."</em></li>
				<li>Periodically review the contracts and agreements with backup providers, as their services could change over time and you might not get what you need.</li>
				<li>Make sure you have an <strong class="bold">Order of Restoration</strong> to determine which systems will be restored first based on the business impact (RTO).</li>
				<li>Remember that the cost of a recovery site varies depending on the service type (for example, hot, warm, or cold), so make sure you distribute them accordingly to reduce costs (you don't want to host a test server on a hot site).</li>
				<li>Analyze the providers of your providers. I remember one situation in which the DRP stated that if the secondary ISP was down, then move to ISP X. What we discovered during a test was that ISP X was subcontracting the services from our secondary <a id="_idIndexMarker315"/>ISP. This meant that a problem on the infrastructure of the secondary ISP would also impact ISP X, rendering our DRP useless.</li>
				<li>Perform scheduled DRP tests to validate the effectiveness of it.</li>
				<li>Perform stress tests to validate whether the actions can support the number of people or services required. For example, during a test, you might check that you can connect to a secondary server, but does that server give you the required level of performance? Can it accept the number of connections that you need to restore the business?</li>
				<li>Perform security tests to ensure that the minimum acceptable security level can be obtained with the proposed DRP.</li>
				<li>If you have multiple locations, test access to the secondary servers/systems from all locations (you need to make sure that your employees working from a beach in Costa Rica can also access the secondary systems/servers).</li>
				<li>Test the <em class="italic">durability</em> of the secondary systems (proposed on the DRP) over an extended period of time and during different seasons. For example, you might test a satellite internet connection, and it could work fine if the sky is clear, but it might not provide you with the required level of service during cloudy weather or a storm.</li>
				<li>Get the required approvals (from the CEO, CTO, and CFO) before publishing the DRP. CTO approval is key to ensure that they agree with the technical decisions, CEO approval is key to ensure the DRP effectively covers the business, and CFO approval <a id="_idIndexMarker316"/>ensures that you have the budget required to implement and execute it.</li>
			</ul>
			<h1 id="_idParaDest-64"><a id="_idTextAnchor066"/>Summary</h1>
			<p>In this chapter, we covered a lot of very interesting and important topics that you can apply to your defense strategy. </p>
			<p>First, we learned how to create a vulnerability assessment, including an overview of the most common types of vulnerabilities to help you create the best assessment. Then, we expanded into one of the core aspects of cyber defense: risk management. Here, we learned how to manage cybersecurity risks, and also looked at one of the most famous frameworks in cybersecurity: the NIST Cybersecurity Framework.</p>
			<p>Additionally, as discussed in the previous chapter, <em class="italic">availability</em> is one of the core principles in cybersecurity. Therefore, to avoid downtime, we learned how to create a BCP, including a deep dive into its most important components: the BIA and the DRP.</p>
			<p>We also learned the details behind one of the most common and dangerous vulnerabilities, that is, the famous (or infamous) USB HID vulnerabilities. Here, we learned about the most common attack vectors that leverage this vulnerability, and also the tools and techniques we can use to prevent these types of attacks.</p>
			<p>In the next chapter, we will expand this further and show you all the vulnerabilities associated with the weakest chain in cybersecurity, the user, and all the mechanisms, tools, and techniques that you can leverage to <em class="italic">patch the user</em>. </p>
			<h1 id="_idParaDest-65"><a id="_idTextAnchor067"/>Further reading</h1>
			<ul>
				<li>Here is the official site of the <strong class="bold">National Institute of Standards and Technology</strong> (NIST), where you can check the latest version of the NIST Cybersecurity Framework: <a href="https://www.nist.gov/cyberframework">https://www.nist.gov/cyberframework</a>.</li>
				<li>Here, you can see the latest and greatest cybersecurity tools and gadgets that you can use when performing a vulnerability assessment: <a href="https://hak5.org/">https://hak5.org/</a>.</li>
				<li>Several sites show some vulnerable USB dongles, but most sites just show devices from the same brand. In this case, Wikipedia has the best compilation of vulnerable USB dongles, including several brands: <a href="https://en.wikipedia.org/wiki/Logitech_Unifying_receiver">https://en.wikipedia.org/wiki/Logitech_Unifying_receiver</a>.</li>
				<li>If you want to view another approach to risk management, then I suggest you take a look at the Orange Book from the UK government: <a href="https://www.gov.uk/government/publications/orange-book">https://www.gov.uk/government/publications/orange-book</a>.</li>
				<li>This is a very good BIA template from Manchester City Council: <a href="https://www.manchester.gov.uk/downloads/download/5700/mbcf_business_impact_analysis_template">https://www.manchester.gov.uk/downloads/download/5700/mbcf_business_impact_analysis_template</a>.</li>
				<li>Here is a thorough BCP template from Manchester City Council: <a href="https://www.manchester.gov.uk/downloads/download/5701/mbcf_business_continuity_plan_template">https://www.manchester.gov.uk/downloads/download/5701/mbcf_business_continuity_plan_template</a>.</li>
				<li>Here is a very interesting BCP template that has been specifically designed for small businesses: <a href="https://www.manchester.gov.uk/downloads/download/5792/business_continuity_guidance_to_support_small_businesses">https://www.manchester.gov.uk/downloads/download/5792/business_continuity_guidance_to_support_small_businesses</a>.</li>
				<li>Would you like to create your own solution against USB HID vulnerabilities? If so, then I suggest you review this document to gain a deeper understanding of the USB protocol (including descriptors, classes, and more): <a href="https://www.ftdichip.com/Support/Documents/TechnicalNotes/TN_113_Simplified%20Description%20of%20USB%20Device%20Enumeration.pdf">https://www.ftdichip.com/Support/Documents/TechnicalNotes/TN_113_Simplified%20Description%20of%20USB%20Device%20Enumeration.pdf</a>. </li>
			</ul>
		</div>
	</body></html>