<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Digital and Mobile Forensics"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Digital and Mobile Forensics</h1></div></div></div><p>Not long from now, we would be talking mainly, if not solely, about computer forensics and computer crimes, such as an attacker breaking into a computer network system and stealing data. This would involve two types of offense: unlawful/unauthorized access and data theft. As mobile phones became more popular, the new field of mobile forensics developed.</p><p>Nowadays, things have changed radically and are still changing at quite a fast pace as technology evolves. Digital forensics, which includes all disciplines dealing with electronic evidence, is also being applied to common crimes, to those that, at least by definition, are not strictly IT crimes. Today, more than ever, we live in a society that is fully digitalized and people are equipped with all kinds of devices, which have different types of capabilities, but all of them process, store, and transmit information (mainly over the Internet). This means that forensic investigators have to be able to deal with all these devices.</p><p>As defined at the first <span class="strong"><strong>Digital Forensics Research Workshop</strong></span> (<span class="strong"><strong>DFRWS</strong></span>) in 2001, digital forensics is:</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"The use of scientifically derived and proven methods toward the preservation, collection, validation, identification, analysis, interpretation, documentation, and presentation of digital evidence derived from digital sources for the purpose of facilitating or furthering the reconstruction of events found to be criminal, or helping to anticipate unauthorized actions shown to be disruptive to planned operations."</em></span></p></blockquote></div><p>As Casey asserted (<span class="strong"><strong>Casey, 2011</strong></span>):</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"In this modern age, it is hard to imagine a crime that does not have a digital dimension."</em></span></p></blockquote></div><p>Criminals of all kinds use technology to facilitate their offenses, communicate with their peers, recruit other criminals, launder money, commit credit card fraud, gather information on their victims, and so on. This obviously creates new challenges for all the different actors involved, such as attorneys, judges, law enforcement agents, forensic examiners.</p><p>Among the cases solved in recent years, there were kidnappings where the kidnapper was caught thanks to a request for ransom sent by e-mail from his mobile phone. There have been many cases of industrial espionage in which unfaithful employees were hiding projects in the memory cards of their smartphones, cases of drug dealing solved thanks to the evidence found in the backup of mobile phones that was on computer, and many other such cases. Even the largest robberies of our time are now being conducted via computer networks.</p><p>In this chapter, you will learn the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Definition and principles of mobile forensics</li><li class="listitem" style="list-style-type: disc">How to properly handle digital evidence</li><li class="listitem" style="list-style-type: disc">The methodology for the identification and preservation of mobile evidence</li></ul></div><div class="section" title="Mobile forensics"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Mobile forensics</h1></div></div></div><p>Mobile forensics is a field of study in digital forensics that focuses on mobile devices. Among the different digital forensics fields, mobile forensics is without doubt the fastest growing and evolving area of study, having an impact on many different situations from corporate to criminal investigations and intelligence gathering, which are on the rise. Moreover, the importance of mobile forensics is increasing exponentially due to the continuous fast growth of the mobile market. One of the most interesting peculiarities of mobile forensics is that mobile devices, particularly mobile phones, usually belong to a single individual, while this is not always the case with a computer that may be shared among employees of a company or members of a family. For this reason, the analysis of mobile phones gives access to plenty of personal information.</p><p>Another important and interesting aspect that comes with mobile forensics, which is both challenging and frustrating at the same time for the analyst, is the multitude of different device models and the customized flavors of their operating systems available on the market. This makes it very difficult to have a single solution (either a tool or process) to address them all.</p><p>Just think of all the applications people have installed on their smartphones: IM clients, web browsers, social network clients, password managers, navigation systems, and much more, other than the classic default ones, such as an address book, which can provide a lot more information other than just the phone number for each contact that has been saved. Moreover, syncing such devices with a computer has become a very easy and smooth process, and all user activities, schedules, to-do lists, and everything else is stored inside a smartphone. Aren't these enough to profile a person and reconstruct all their recent activities, other than building the network of contacts?</p><p>Finally, in addition to a variety of smartphones and operating systems, such as Apple iOS, Google Android, Microsoft Windows Phone, and Blackberry OS, there is a massive number of so-called feature phones that use older mobile OS systems.</p><p>Therefore, it's pretty clear that when talking about mobile/smartphone forensics, there is so much more than just printouts of phone calls. In fact, with a complete examination, we can retrieve SMSes/MMSes, pictures, videos, installed applications, e-mails, geolocation data, and so on-both present and deleted information.</p></div></div>
<div class="section" title="Digital evidence"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Digital evidence</h1></div></div></div><p>As mentioned earlier, on one hand the increasing involvement of mobile devices in digital forensics cases has brought a whole new series of challenges and complexities. However, on the other hand, this has also resulted in a much greater amount of evidence from criminals that it is now being used to reconstruct their activities with a more comprehensive level of detail. Moreover, while classical physical evidence may be destroyed, digital evidence, most of the time, leaves traces.</p><p>Over the years, there have been several definitions of what digital evidence actually is, some of them focusing particularly on the evidentiary aspects of proof to be used in court, such as the one proposed by the <span class="strong"><strong>Standard Working Group on Digital Evidence</strong></span> (<span class="strong"><strong>SWGDE</strong></span>), stating that:</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"Digital evidence is any information of probative value that is either stored or transmitted in a digital form."</em></span></p></blockquote></div><p>The definition proposed by the <span class="strong"><strong>International Organization of Computer Evidence</strong></span> (<span class="strong"><strong>IOCE</strong></span>) states:</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"Digital evidence is information stored or transmitted in binary form that may be relied on in court."</em></span></p></blockquote></div><p>The definition given by E. Casey (<span class="strong"><strong>Casey, 2000</strong></span>), refers to digital evidence as:</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"Physical objects that can establish that a crime has been committed, can provide a link between a crime and its victim, or can provide a link between a crime and its perpetrator."</em></span></p></blockquote></div><p>While all of these are correct, as previously said, all of these definitions focus mostly on proofs and tend to disregard data that is extremely useful for an investigation.</p><p>For this reason, and for the purpose of this book, we will refer to the definition given by Carrier (<span class="strong"><strong>Carrier, 2006</strong></span>), where digital evidence is defined as:</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"Digital data that supports or refutes a hypothesis about digital events or the state of digital data."</em></span></p></blockquote></div><p>This definition is a more general one, but better matches the current state of digital evidence and its value within the entire investigation process.</p><p>Also from a standardization point of view, there have been, and still are, many attempts to define guidelines and best practices for digital forensics on how to handle digital evidence. Other than the several guidelines and special publications from NIST, there is a standard from ISO/IEC that was released in 2012, the ISO 27037 guidelines for identification, collection and/or acquisition, and preservation of digital evidence, which is not specific to mobile forensics but is related to digital forensics in general, aiming to build a standard procedure for collecting and handling digital evidence, which will be legally recognized and accepted in court in different countries. This is a really important goal if you consider the lack of borders in the Internet era, particularly when it comes to digital crimes, where illicit actions can be perpetrated by attackers from anywhere in the world. Refer to <a class="link" href="apa.html" title="Appendix A. References">Appendix A</a>,<span class="emphasis"><em>References</em></span> for a more detailed list of standards and best practices.</p><div class="section" title="Handling of mobile evidence"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec3"/>Handling of mobile evidence</h2></div></div></div><p>In order to be useful not only in court but also during the entire investigation phase, digital evidence must be collected, preserved, and analyzed in a forensically sound manner. This means that each step, from the identification to the reporting, has to be carefully and strictly followed. Historically, we are used to referring to a methodology as forensically sound if, and only if, it would imply the original source of evidence remains unmodified and unaltered. This was mostly true when talking about classical computer forensics, in scenarios where the forensic practitioner found the computer switched off or had to deal with external hard drives, although not completely true even in these situations. However, since the rise of live forensics, this concept has become more and more untrue. In fact, methods and tools for acquiring memory from live systems inevitably alter, even if just a little bit, the target system they are run on. The advent of mobile forensics stresses this concept even more, because mobile devices, and smartphones in particular, are networked devices that continuously exchange data through several communication protocols, such as GSM/CDMA, Wi-Fi, Bluetooth, and so on. Moreover, in order to acquire a mobile device, forensic practitioners need to have some degree of interaction with the device. Based on the type, a smartphone can need more or less interaction, altering in this way the original state of the device.</p><p>All of this does not mean that preservation of the source evidence is useless, but that it is nearly impossible in the field of mobile devices. Therefore, it becomes a matter of extreme importance to thoroughly document every step taken during the collection, preservation, and acquisition phases. Using this approach, forensic practitioners will be able to demonstrate that they have been as unintrusive as possible. As Casey states (<span class="strong"><strong>Casey, 2011</strong></span>):</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"One of the keys to forensic soundness is documentation. A solid case is built on supporting documentation that reports on where the evidence originated and how it was handled. From a forensic standpoint, the acquisition process should change the original evidence as little as possible and any changes should be documented and assessed in the context of the final analytical results."</em></span></p></blockquote></div><p>When in the presence of mobile devices to be collected, it is good practice for the forensic practitioner to consider the following points:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Take note of the current location where the device has been found.</li><li class="listitem" style="list-style-type: disc">Report the device status (switched on or off, broken screen, and so on).</li><li class="listitem" style="list-style-type: disc">Report date, time, and other information visible on the screen if the device is switched on, for example by taking a picture of the screen.</li><li class="listitem" style="list-style-type: disc">Look very carefully for the presence of memory cards. Although it is not the case with iOS devices, generally many mobile phones have a slot for an external memory card, where pictures, chat databases, and many other types of user data are usually stored.</li><li class="listitem" style="list-style-type: disc">Look very carefully for the presence of cables related to the mobile phone that is being collected, especially if you don't have a full set of cables in your lab. Many mobile phones have their own cables to connect to the computer and to recharge the battery.</li><li class="listitem" style="list-style-type: disc">Search for the original <span class="strong"><strong>Subscriber Identity Module</strong></span> (<span class="strong"><strong>SIM</strong></span>) package, because that is where the PIN and <span class="strong"><strong>PIN unblocking key</strong></span> (<span class="strong"><strong>PUK</strong></span>) codes are written.</li><li class="listitem" style="list-style-type: disc">Take pictures of every item before collection.</li></ul></div><p>Modifications to mobile devices can happen not only because of interaction with the forensic practitioner, but also due to interaction with the network, voluntarily or not. In fact, digital evidence in mobile devices can be lost completely as they are susceptible to being overwritten by new data, for example with the smartphone receiving an SMS while it is being collected, thus overwriting possible evidence previously stored in the same area of memory as the newly arrived SMS, or upon receiving a remote wiping command over a wireless network. Most of today's smartphones and iOS devices can be configured to be completely wiped remotely.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note3"/>Note</h3><p><span class="strong"><strong>From a real case:</strong></span></p><p>While searching inside the house of a person under investigation, law enforcement agents found and seized, among other things, computers and a smartphone. After cataloguing and documenting everything, they put all the material into boxes to bring them back to the laboratory. Once back in their laboratory, when acquiring the smart phone in order to proceed with the forensics analysis, they noticed the smartphone was <span class="emphasis"><em>empty</em></span> and appeared to be <span class="emphasis"><em>brand new</em></span>. The owner had wiped it remotely.</p></div></div><p>Therefore, isolating the mobile device from all radio networks is a fundamental step in the process of preservation of evidence. There are several ways to achieve this, all with their own pros and cons, as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Airplane mode</strong></span>: Enabling Airplane mode on a device requires some sort of interaction, which may pose some risks of modification by the forensic practitioner. This is one of the best possible options since it implies that all wireless communication chips are switched off. In this case, it is always good to document the action taken with pictures and/or videos. Normally, this is possible only if the phone is not password-protected or the password is known. However, for devices with iOS 7 or higher, it is also possible to enable airplane mode by lifting the dock from the bottom, where there will be a button with the shape of a plane. This is possible only if the <span class="strong"><strong>Access on Lock Screen</strong></span> option is enabled from <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Control Center</strong></span>.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Faraday's bag</strong></span>: This item is a sort of envelope made of conducting material, which blocks out static electric fields and electromagnetic radiation completely isolating the device from communicating with external networks. It is based, as the name suggests, on Faraday's law. This is the most common solution, particularly useful when the device is being carried from the crime scene to the lab after seizure. However, the use of Faraday's bag will make the phone continuously search for a network, which will cause the battery to quickly drain. Unfortunately, it is also risky to plug the phone to a power cable outside that will go inside the bag, because this may act as antenna. Moreover, it is important to keep in mind that when you remove the phone from the bag (once arrived in the lab) it will again be exposed to the network. So, you would need either a shielded lab environment or a Faraday solution that would allow you to access the phone while it is still inside the shielded container, without the need for external power cables.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Jamming</strong></span>: A jammer is used to prevent a wireless device from communicating by sending out radio waves along the same frequencies as that device. In our case, it would jam the GSM/UMTS/LTE frequencies that mobile phones use to connect with cellular base stations to send/receive data. Be aware that this practice may be considered illegal in some countries, since it will also interfere with any other mobile device in the range of the jammer, disrupting their communications too.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Switching off the device</strong></span>: This is a very risky practice because it may activate authentication mechanisms, such as PIN codes or passcodes, that are not available to the forensic practitioner, or other encryption mechanisms that carry with the risk of delaying or even blocking the acquisition of the mobile device.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Removing the SIM card:</strong></span> In most mobile devices, this operation implies removing the battery and therefore all the risks and consequences we just mentioned regarding switching off the device; however, in iOS devices this task is quite straightforward and easy, and it does not imply removing the battery (in iOS devices this is not possible). Moreover, SIM cards can have PIN protection enabled; removing it from the phone may lock the SIM card, preventing its content from being displayed. However, bear in mind that removing the SIM card will isolate the device only from the cellular network, while other networks, such as Wi-Fi or Bluetooth, may still be active and therefore need to be addressed.</li><li class="listitem" style="list-style-type: disc">The following image shows a SIM card extracted from an iPhone with just a clip; image taken from <a class="ulink" href="http://www.maclife.com/">http://www.maclife.com/</a>:<div class="mediaobject"><img src="graphics/image_01_001.jpg" alt="Handling of mobile evidence"/></div></li></ul></div><div class="section" title="Preservation of evidence"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec0"/>Preservation of evidence</h3></div></div></div><p>Talking about the documentation and preservation of digital evidence, one of the most important steps is the correct and comprehensive compilation of the <span class="strong"><strong>chain of custody</strong></span>. The purpose of this document is twofold: on one hand, to keep the record of each person who handled the evidence, enabling the identification of access and movement of potential digital evidence at any given point in time; and on the other hand, to maintain documentation demonstrating that the digital evidence has not been altered since it was collected while passing through the hands of the several analysts listed in the document.</p><p>Therefore, some of the information that the chain of custody should contain is as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">A unique evidence identifier</li><li class="listitem" style="list-style-type: disc">Who accessed the evidence and the time and location it took place</li><li class="listitem" style="list-style-type: disc">Who checked the evidence in and out of the evidence preservation facility and when</li><li class="listitem" style="list-style-type: disc">Reasons why the evidence was checked out</li><li class="listitem" style="list-style-type: disc">The hash values of the evidence in order to prove that it has not been tampered with since it was last assigned to the previous person listed in the chain of custody</li><li class="listitem" style="list-style-type: disc">Although the forensics investigation must never be performed directly on the original device/file, the chain of custody should mention if any unavoidable changes to the potential digital evidence had to be performed and the justification for the introduction of such changes, as well as the name of the individual responsible</li><li class="listitem" style="list-style-type: disc">The following image shows a sample of chain of custody proposed by NIST:<div class="mediaobject"><img src="graphics/image_01_002.jpg" alt="Preservation of evidence"/></div></li></ul></div></div><div class="section" title="Acquisition of evidence"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec1"/>Acquisition of evidence</h3></div></div></div><p>Especially in mobile forensics, where visible information may be more volatile, and also in classical computer forensics, sometimes there may be an urgency to acquire the data available. Information may vanish before it is possible to isolate or properly handle the device. In such cases, effective on-scene triage processes and tools may preserve evidence that would otherwise be lost. Such processes may include taking immediate pictures or videos recording the screen of the device before proceeding with any other type of operation.</p><p>Having said that, once the mobile device has been handled correctly, forensic practitioners may proceed with the acquisition of the evidence from the device. In mobile forensics, and particularly for iOS devices, there are the following three different types of possible acquisition:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Physical</strong></span>: This is the optimal and most desired option. It involves a physical acquisition consisting of an exact <span class="emphasis"><em>bit-to-bit</em></span> copy of the device. This is the most comprehensive option since it also allows you to recover potentially deleted files.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>FileSystem</strong></span>: This is the second-best option when physical acquisition is not possible for whatever reason. This type of acquisition lets the forensic practitioner extract all the files visible at the filesystem level. In this way, it will be possible to analyze all active files that would be visible by browsing the filesystem, but it will not be possible to recover potentially deleted files.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Logical</strong></span>: With this type of acquisition, it is possible to extract part of the filesystem. It consists recovering the available data by performing the backup of the device, via iTunes in the case of iOS devices. Unfortunately, with iOS, a logical/backup acquisition does not extract important files such as e-mails, geolocation databases, the app cache folder, and so on. Although it is the least comprehensive of the three, sometimes this may be the only option available.</li></ul></div><p>The preceding three acquisition methods are the main methods for acquiring an iOS device; we will see more about this in detail later. In the following chapters, we will dive deep into each of the different methodologies, explaining how to behave in every possible situation and we will see most of the different tools available for performing the acquisition and further analysis of a physical filesystem and logical acquisition.</p><p>Mobile forensics, however, may also include the need to adopt some offensive security techniques. Depending on the device model and iOS version, in order to make a physical acquisition we may need to jailbreak the device, hopefully with a tethered technique so that modifications will not be persistent on the device and it will be restored once restarted. Even in cases when we can only perform an untethered jailbreak, such modifications will affect only the iOS device system partition, leaving the user partition unchanged and therefore the evidence preserved.</p><p>Another offensive technique we may need to use is password cracking. As we will see later, often we may find ourselves faced with a password-protected device. Dependent on the model and iOS version, it may be possible to perform brute force attacks on the passcode set by the user.</p><p>These more invasive techniques will need to be fully documented in the final report, detailing methodology, techniques, and tools used. It is very important, especially because of their invasiveness, to know well the tools and techniques used in order to be able to explain what and where the modifications have happened, and why they did not alter the evidence to the point of compromising it. Good reporting is key.</p></div><div class="section" title="Evidence integrity"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec2"/>Evidence integrity</h3></div></div></div><p>It has been mentioned already multiple times that when handling mobile devices, it is basically impossible not to interact with the device and therefore alter, to some extent, its current status. However, this does not mean that in mobile forensics there is no need or reason to put in place mechanisms of evidence integrity. In fact, once the acquisition has been completed, there must be some integrity verification mechanism in place for the data that has been extracted from the mobile device, be it an iTunes backup, a full physical acquisition, or simply a single file. In digital forensics, such a process of verifying the integrity of digital evidence is completed by comparing the digital fingerprint of the evidence taken at the time of acquisition with the digital fingerprint of the evidence in the current state. Such a fingerprint is also known as a <span class="strong"><strong>hash value</strong></span> or <span class="strong"><strong>message digest</strong></span>. Hashing functions are specific one-way mathematical functions that, given any input of arbitrary length, will produce as a result an output of a given fixed length. The same input will always produce the same output. This means that even if a single bit is changed, the new hash value will be completely different. The following table shows how simply by modifying only the case of two characters in the same sentence, the resulting hash value is completely different:</p><div class="mediaobject"><img src="graphics/B05100_01_Tablepageno10.jpg" alt="Evidence integrity"/></div><p>The two most common algorithms used to calculate hash values are MD5 and SHA-1. The MD5 algorithm produces an output of 128 bits, while the SHA-1 algorithm produces an output of 160 bits. The other important characteristic of these type of algorithms is that, theoretically, it should be computationally infeasible to be able to generate two different inputs that will produce the same hash value, as well as to generate a specific message that will match a given hash value. This problem is known as <span class="strong"><strong>collision</strong></span>. It has been demonstrated in several studies that it is possible to create two different files with the same hash values in both MD5 and SHA-1 cases. However, it has to be specified that this is true under specific controlled conditions that are unlikely to happen in reality. In any case, such collisions do not invalidate the use of these hash algorithms for integrity verification. Since it is basically impossible to produce two files that have the same MD5 and SHA-1 hash value (or in general two hash values generated by two different independent algorithms), it is a good practice to generate both MD5 and SHA-1 hash values for each piece of digital evidence produced or collected.</p></div></div><div class="section" title="SIM cards"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec4"/>SIM cards</h2></div></div></div><p>When conducting forensic examinations of mobile devices, it is also important to acquire and analyze the content of the associated SIM cards. The SIM card is a type of smart card that allows a mobile device to connect to a cellular network through the cryptographic keys embedded in the SIM card itself. The SIM card is mainly characterized by the following two different codes that can be retrieved:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Integrated Circuit Card Identification</strong></span> (<span class="strong"><strong>ICCID</strong></span>): This code is a 20-digit code that internationally and univocally identifies each SIM card</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>International Mobile Subscriber Identity</strong></span> (<span class="strong"><strong>IMSI</strong></span>): This is a unique 15-digit number (in some places, as in South Africa, it's 14), which univocally identifies a user inside the mobile network</li></ul></div><p>Although it is not the case with iOS devices, there might be multiple SIM cards that an individual uses with the same device for different purposes, since some mobile devices support functioning with dual SIM cards.</p><p>In addition, the storage capacity and utilization of SIM cards has increased a lot and may contain a large amount of relevant information. Just to give you an idea of the amount of data that it could be possible to store (or hide) inside a SIM card, consider that inside a 128 KB standard SIM card, it is possible to write up to 17 KB of data. The entire <span class="strong"><strong>United States Declaration of Independence</strong></span> takes just 11 KB.</p><p>Some of the useful information to recover from a SIM card may be the list of incoming/outgoing phone calls, contacts information, the SMS content, for which it is possible to recover even those that have been deleted, and the location of the last cell to which the device was connected.</p><p>Looking into the details of the SIM card (Gubian, 2007), it is possible to see the hierarchical n-ary structure of the filesystem that has three different kinds of files, with the content of each file defined in the following GSM technical specification (GSM 11.11):</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>3F = Master File (MF)</strong></span>: Its structure is composed of just a header and it is the root of the filesystem in the SIM card. Its address, which is the offset for every other file, is <code class="literal">3F00</code>.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>7F/5F = 7F is a Dedicated File (DF)</strong></span>: As for the MF, its structure is composed just of a header plus EFs. A DF can be compared to a normal folder in our PC.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>2F = Elementary file (EF) under the master file and 6F/4F = 4F is an Elementary file under a dedicated file 6F</strong></span>: The structure of the elementary file is composed of a header plus a body, which represents itself (for example, the SMS).</li></ul></div><p>The following diagram gives an example of this hierarchical structure (the filesystem structure of a SIM):</p><div class="mediaobject"><img src="graphics/image_01_003.jpg" alt="SIM cards"/></div><p>The GSM technical specification already provides some files with common names. Some of the most interesting folders among the standard ones may be <code class="literal">3F00:7F10</code> (<code class="literal">DF_TELECOM</code>), which contains service-related information and some user data such as SMS, and <code class="literal">3F00:7F20</code> (<code class="literal">DF_GSM</code>), where information related to the GSM network is stored. The ICCID and IMSI mentioned previously can be found at <code class="literal">3F00:2FE2</code>, named <code class="literal">EF_ICCID</code>, and <code class="literal">3F00:7F20:6F07</code>, named <code class="literal">EF_IMSI</code>. The following table presents some of the well-known sources of information that can be found inside a SIM card and their respective locations:</p><div class="mediaobject"><img src="graphics/B05100_01_Tablepageno13.jpg" alt="SIM cards"/></div><p>In a SIM card, the access to <span class="strong"><strong>each file</strong></span> (<span class="strong"><strong>EF</strong></span>) is ruled by a certain number of privilege levels, which allow or deny certain actions according to the role the user has (which is given by the privilege level). Some of the useful privileges are <code class="literal">ALWays</code>, <code class="literal">CHV1</code>, and <code class="literal">CHV2</code>. Those are the privileges that allow the owner of the SIM card (or anyway the user who knows the codes) to access and modify the content of such files. For instance, any file that has one of these privileges related to the <code class="literal">UPDATE</code> command, allows those that know such codes (<code class="literal">CHV1</code>/<code class="literal">CHV2</code>) to modify the information inside that file.</p><p>The following table summarizes the access conditions for SIM cards:</p><div class="mediaobject"><img src="graphics/B05100_01_Tablepageno-14.jpg" alt="SIM cards"/></div><div class="section" title="SIM security"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec3"/>SIM security</h3></div></div></div><p>Other than ICCID and IMSI, which are mainly related to the SIM card itself, the other two important codes useful to know (actually, almost indispensable) when conducting an analysis are the PIN code and the PUK code. The PIN code is used to authenticate the user to the system, while the PUK code is used to unlock the SIM card after three incorrect attempts to insert the PIN code. Therefore, brute forcing the PIN is generally ineffective, because three failed PIN attempts will result in the SIM being locked.</p><p>Fortunately, SIM cards have a PUK and many <span class="strong"><strong>network service providers</strong></span> (<span class="strong"><strong>NSP</strong></span>) can provide it to law enforcements with a proper legal authorization signed by a judge (warrant), to get around the PIN or to access a locked SIM card.</p><p>If an incorrect PUK code is inserted 10 times, the SIM will block itself permanently, making its content completely inaccessible. This is something to keep in mind before starting a brute force attacks against those two codes.</p></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Summary</h1></div></div></div><p>In this chapter, we gave a general introduction to digital forensics for those relatively new to this area of study and a good recap to those already in the field, keeping the mobile forensics field specifically in mind. We have seen what digital evidence is and how it should be handled, presenting several techniques to isolate the mobile device from the network. You should always remember the importance of documenting any action taken (chain of custody, final report, and so on) and to put in place mechanisms to verify the integrity of the evidence (hash values). We also talked about the different acquisition techniques for iOS devices, anticipating some terms and technologies that will be covered in full detail in the following chapters of this book, from A to Z. Last but not least, we talked about the SIM card, how it is structured, and what type of useful information we can expect to find inside it.</p><p>In the next chapter, we will start focusing purely on the mobile forensics of Apple devices. In particular, you will have an introduction to the iOS devices, OS, and the filesystem.</p></div>
<div class="section" title="Self-test questions"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Self-test questions</h1></div></div></div><p>Q1. What is the best option to isolate a mobile device before acquisition?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Jammer</li><li class="listitem">Faraday's bag</li><li class="listitem">Airplane mode</li><li class="listitem">Switch off the device</li></ol></div><p>Q2. What is the most comprehensive acquisition method?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Logical</li><li class="listitem">Advanced logical</li><li class="listitem">Filesystem</li><li class="listitem">Physical</li></ol></div><p>Q3. What is the code that internationally and univocally identifies each SIM card called?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">IMSI</li><li class="listitem">ICCID </li><li class="listitem">PUK</li><li class="listitem">GSM</li></ol></div><p>Q4. How many PUK attempts can we make before the SIM card becomes completely inaccessible?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">3</li><li class="listitem">5</li><li class="listitem">10</li><li class="listitem">15</li></ol></div></div></body></html>