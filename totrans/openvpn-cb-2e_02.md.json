["```\n     $ mkdir -m 700 -p /etc/openvpn/cookbook/keys\n     $ cd /etc/openvpn/cookbook\n     $ cp -drp /usr/share/easy-rsa/2.0/* .\n\n    ```", "```\n            export EASY_RSA=/etc/openvpn/cookbook \n            export OPENSSL=\"openssl\" \n            export PKCS11TOOL=\"pkcs11-tool\" \n            export GREP=\"grep\" \n            export KEY_CONFIG=`$EASY_RSA/whichopensslcnf $EASY_RSA` \n            export KEY_DIR=\"$EASY_RSA/keys\" \n            export PKCS11_MODULE_PATH=\"dummy\" \n            export PKCS11_PIN=\"dummy\" \n            export KEY_SIZE=2048 \n            export CA_EXPIRE=3650 \n            export KEY_EXPIRE=1000 \n            export KEY_COUNTRY=\"US\" \n            export KEY_PROVINCE= \n            export KEY_CITY= \n            export KEY_ORG=\"Cookbook 2.4\" \n            export KEY_OU= \n            export KEY_CN= \n            export KEY_EMAIL=\"openvpn@example.com\" \n\n    ```", "```\n     $ cd /etc/openvpn/cookbook\n     $ . ./vars\n     $ ./clean-all\n     $ KEY_SIZE=4096 ./build-ca --pass\n\n    ```", "```\n            $ export KEY_EMAIL=\n            $ ./build-key-server openvpnserver\n            Generating a 2048 bit RSA private key\n\n     ............................................................\n            ............................+++\n    ...........................................+++\n            writing new private key to 'openvpnserver.key'\n            -----\n            You are about to be asked to enter information that will be \n            incorporated\n            into your certificate request.\n            What you are about to enter is what is called a Distinguished \n            Name or a DN.\n            There are quite a few fields but you can leave some blank\n            For some fields there will be a default value,\n            If you enter '.', the field will be left blank.\n            -----\n            Country Name (2 letter code) [US]:\n            State or Province Name (full name) []:\n            Locality Name (eg, city) []:\n            Organization Name (eg, company) [Cookbook 2.4]:\n            Organizational Unit Name (eg, section) []:\n            Common Name (eg, your name or your server's hostname)         \n            [openvpnserver]:\n                Name []:\n                Email Address []:\n            Please enter the following 'extra' attributes\n            to be sent with your certificate request\n            A challenge password []:\n            An optional company name []:\n            Using configuration from /etc/openvpn/cookbook/openssl-\n            1.0.0.cnf\n            Enter pass phrase for /etc/openvpn/cookbook/keys/ca.key:\n            Check that the request matches the signature\n            Signature ok\n            The Subject's Distinguished Name is as follows\n            countryName           :PRINTABLE:'US'\n            organizationName      :PRINTABLE:'Cookbook 2.4'\n            commonName            :PRINTABLE:'openvpnserver'\n            Certificate is to be certified until Oct 13 17:49:24 2018 GMT \n            (1000 days)\n            Sign the certificate? [y/n]:y\n            1 out of 1 certificate requests certified, commit? [y/n]y\n            Write out database with 1 new entries\n            Data Base Updated\n\n    ```", "```\n     $ ./build-key --batch client1\n\n    ```", "```\n            $ ./build-key-pass --batch client2\n            Generating a 2048 bit RSA private key\n            ............+++\n            ...............+++\n            writing new private key to 'client2.key'\n            Enter PEM pass phrase:\n            Verifying - Enter PEM pass phrase:\n            -----\n            Using configuration from /etc/openvpn/cookbook/openssl-\n            1.0.0.cnf\n            Enter pass phrase for /etc/openvpn/cookbook/keys/ca.key:\n            Check that the request matches the signature\n            Signature ok\n            The Subject's Distinguished Name is as follows\n            countryName           :PRINTABLE:'US'\n            organizationName      :PRINTABLE:'Cookbook 2.4'\n            commonName            :PRINTABLE:'client2'\n            Certificate is to be certified until Oct 13 17:59:15 2018 GMT \n            (1000 days)\n            Write out database with 1 new entries\n            Data Base Updated\n\n    ```", "```\n     $ openvpn --genkey --secret ta.key\n\n    ```", "```\n[Win]C:> vars\n[Win]C:> clean-all\n[Win]C:> build-ca\n\n```", "```\n            proto udp \n            port 1194 \n            dev tun \n            server 10.200.0.0 255.255.255.0 \n\n            ca   /etc/openvpn/cookbook/ca.crt \n            cert /etc/openvpn/cookbook/server.crt \n            key  /etc/openvpn/cookbook/server.key \n            dh   /etc/openvpn/cookbook/dh2048.pem \n\n    ```", "```\n     [server]$ cd /etc/openvpn/cookbook\n     [server]$ cp keys/ca.crt ca.crt\n     [server]$ cp keys/openvpnserver.crt server.crt\n     [server]$ cp keys/openvpnserver.key server.key\n     [server]$ cp keys/dh2048.pem dh2048.pem\n\n    ```", "```\n     [root@server]# openvpn --config example2-2-server.conf\n\n    ```", "```\n            client \n            proto udp \n            remote openvpnserver.example.com \n            port 1194 \n            dev tun \n            nobind \n\n            ca /etc/openvpn/cookbook/ca.crt \n            cert /etc/openvpn/cookbook/client1.crt \n            key /etc/openvpn/cookbook/client1.key \n\n    ```", "```\n     [root@client]# openvpn --config example2-2-client.conf\n     [...]\n     [openvpnserver] Peer Connection Initiated with \n              openvpnserver:1194\n              TUN/TAP device tun0 opened\n              /sbin/ip link set dev tun0 up mtu 1500\n              /sbin/ip addr add dev tun0 local 10.200.0.6 peer 10.200.0.5\n              Initialization Sequence Completed\n\n    ```", "```\n[client]$ ping -c 2 10.200.0.1\nPING 10.200.0.1 (10.200.0.1) 56(84) bytes of data.\n64 bytes from 10.200.0.1: icmp_seq=1 ttl=64 time=30.6 ms\n64 bytes from 10.200.0.1: icmp_seq=2 ttl=64 time=30.7 ms\n\n```", "```\n[client]$ /sbin/ifconfig tun0 | grep inet\n\n```", "```\ninet addr:10.200.0.6  P-t-P:10.200.0.5 \n\n```", "```\n            proto udp \n            port 1194 \n            dev tun \n            server 10.200.0.0 255.255.255.0 \n\n            ca       /etc/openvpn/cookbook/ca.crt \n            cert     /etc/openvpn/cookbook/server.crt \n            key      /etc/openvpn/cookbook/server.key \n            dh       /etc/openvpn/cookbook/dh2048.pem \n            tls-auth /etc/openvpn/cookbook/ta.key 0 \n\n            persist-key \n            persist-tun \n            keepalive 10 60 \n\n            push \"route 10.198.0.0 255.255.0.0\" \n            topology subnet \n\n            user  nobody \n            group nobody   # use \"group nogroup\" on some distros \n\n            daemon \n            log-append /var/log/openvpn.log \n\n    ```", "```\n     [root@server]# cp keys/ta.key ta.key\n\n    ```", "```\n     root@server]# openvpn --config basic-udp-server.conf\n\n    ```", "```\n     [root@server]# sysctl -w net.ipv4.ip_forward=1\n\n    ```", "```\n            client \n            proto udp \n            remote openvpnserver.example.com \n            port 1194 \n            dev tun \n            nobind \n\n            ca       /etc/openvpn/cookbook/ca.crt \n            cert     /etc/openvpn/cookbook/client1.crt \n            key      /etc/openvpn/cookbook/client1.key \n            tls-auth /etc/openvpn/cookbook/ta.key 1 \n\n            remote-cert-tls server \n\n    ```", "```\n     [root@client]# scp \\ \n     openvpnserver:/etc/openvpn/cookbook/keys/ta.key . \n\n    ```", "```\n     [root@client]# openvpn --config basic-udp-client.conf\n            OpenVPN 2.3.9 x86_64-redhat-linux-gnu [SSL (OpenSSL)] [LZO] \n            [EPOLL]\n    [PKCS11] [MH] [IPv6] built on Dec 16 2015\n    library versions: OpenSSL 1.0.1e-fips 11 Feb 2013, LZO 2.08\n    Control Channel Authentication: using   \n            '/etc/openvpn/cookbook/ta.key' as a OpenVPN static key file\n    UDPv4 link local: [undef]\n    UDPv4 link remote: [AF_INET]openvpnserver:1194\n    [openvpnserver] Peer Connection Initiated with      \n            [AF_INET]openvpnserver:1194\n    TUN/TAP device tun0 opened\n    do_ifconfig, tt->ipv6=0, tt->did_ifconfig_ipv6_setup=0\n    /usr/sbin/ip link set dev tun0 up mtu 1500\n    /usr/sbin/ip addr add dev tun0 10.200.0.2/24 broadcast \n            10.200.0.255\n    Initialization Sequence Completed\n\n    ```", "```\n     [gateway1]> ip route add 10.200.0.0/24 via 10.198.1.1\n\n    ```", "```\n[client]$ ping -c 2 10.198.0.10\nPING 10.198.0.10 (10.198.0.10) 56(84) bytes of data.\n64 bytes from 10.198.0.10: icmp_seq=1 ttl=63 time=31.1 ms\n64 bytes from 10.198.0.10: icmp_seq=2 ttl=63 time=30.0 ms\n\n```", "```\npersist-key \npersist-tun \n\n```", "```\ntls-auth /etc/openvpn/cookbook/ta.key 0 \n\n```", "```\nkeepalive 10 60 \n\n```", "```\ndaemon \nlog-append /var/log/openvpn.log \n\n```", "```\n[client]$ /sbin/ifconfig tun0 | grep inet\n\n```", "```\ninet addr:10.200.0.2  P-t-P:10.200.0.2 \n\n```", "```\nproto udp \n\n```", "```\nproto tcp \n\n```", "```\n$ cd /etc/openvpn/cookbook\n$ sed 's/proto udp/proto tcp' basic-udp-server.conf \\\n > basic-tcp-server.conf\n$ sed 's/proto udp/proto tcp/' basic-udp-client.conf \\\n > basic-tcp-client.conf\n\n```", "```\n$ build-key-server\n\n```", "```\n[root@server]# iptables -t nat -I POSTROUTING -o eth0 \\\n -s 10.200.0.0/24 -j MASQUERADE\n\n```", "```\n     server-ipv6 2001:db8:100::0/112\n\n    ```", "```\n     [root@server]# openvpn --config example2-4-server.conf\n    [...]\n    do_ifconfig, tt->ipv6=1, tt->did_ifconfig_ipv6_setup=1\n    /sbin/ip link set dev tun0 up mtu 1500\n    /sbin/ip addr add dev tun0 10.200.0.1/24 broadcast  \n              10.200.0.255\n    /sbin/ip -6 addr add **2001:db8:100::1/112** dev tun0\n    [...]\n\n    ```", "```\n     [root@client]# openvpn --config basic-udp-client.conf\n    [...]\n    [openvpnserver] Peer Connection Initiated with         \n              [AF_INET]openvpnserver:1194\n    TUN/TAP device tun0 opened\n    do_ifconfig, **tt->ipv6=1, tt->did_ifconfig_ipv6_setup=1** \n    /usr/sbin/ip link set dev tun0 up mtu 1500\n    /usr/sbin/ip addr add dev tun0 10.200.0.2/24 broadcast \n              10.200.0.255\n    /usr/sbin/ip -6 addr add **2001:db8:100::1000/112** dev tun0\n    Initialization Sequence Completed\n\n    ```", "```\n     [client]$   ping6 -c 4  2001:db8:100::\n    PING 2001:db8:100::1(2001:db8:100::1) 56 data bytes\n    64 bytes from 2001:db8:100::1: icmp_seq=1 ttl=64 time=9.01 ms\n    64 bytes from 2001:db8:100::1: icmp_seq=2 ttl=64 time=10.8 ms\n    64 bytes from 2001:db8:100::1: icmp_seq=3 ttl=64 time=9.42 ms\n    64 bytes from 2001:db8:100::1: icmp_seq=4 ttl=64 time=8.36 ms\n    --- 2001:db8:100::1 ping statistics ---\n    4 packets transmitted, 4 received, 0% packet loss, time   \n              3004ms\n    rtt min/avg/max/mdev = 8.364/9.409/10.832/0.904 ms\n\n    ```", "```\nremote 2001:db8:120:e120:225:90ff:fec0:3ed1\n\n```", "```\nproto udp6 \nbind ipv6only \n\n```", "```\n     client-config-dir /etc/openvpn/cookbook/clients\n\n    ```", "```\n     [root@server]# mkdir -m 755 /etc/openvpn/cookbook/clients\n     [root@server]# cd /etc/openvpn/cookbook/clients\n     [root@server]# echo \"ifconfig-push 10.200.0.7 10.200.0.7\" \\\n     > client1\n\n    ```", "```\n     [server]$ openssl x509 -subject -noout -in client1.crt\n    subject= /C=US/O=Cookbook 2.4/CN=client1\n\n    ```", "```\n     [root@server]# openvpn --config example2-5-server.conf\n\n    ```", "```\n     [root@client]# openvpn --config basic-udp-client.conf\n    [...]\n    [openvpnserver] Peer Connection Initiated with \n              [AF_INET]openvpnserver:1194\n    TUN/TAP device tun0 opened\n    do_ifconfig, tt->ipv6=0, tt->did_ifconfig_ipv6_setup=0\n    /usr/sbin/ip link set dev tun0 up mtu 1500\n    /usr/sbin/ip addr add dev tun0 10.200.0.7/24 broadcast \n              10.200.0.255\n    Initialization Sequence Completed\n\n    ```", "```\n            client-config-dir /etc/openvpn/cookbook/clients \n            route 192.168.4.0 255.255.255.0 10.200.0.1 \n\n    ```", "```\n     [root@server]# mkdir -m 755 /etc/openvpn/cookbook/clients\n\n    ```", "```\n            iroute 192.168.4.0 255.255.255.0 \n\n    ```", "```\n     $ openssl x509 -subject -noout -in client1.crt\n    subject= /C=US/O=Cookbook 2.4/CN=client1\n\n    ```", "```\n     [root@server]# openvpn --config example2-6-server.conf\n\n    ```", "```\n     [root@client]# openvpn --config basic-udp-client.conf\n\n    ```", "```\n     [root@server]# sysctl -w net.ipv4.ip_forward=1\n\n    ```", "```\n     [siteB-gw]> ip route add 192.168.4.0/24 via 10.198.1.1\n     [siteB-gw]> ip route add 10.200.0.0/24 via 10.198.1.1\n\n    ```", "```\n     [client]$ sysctl -w net.ipv4.ip_forward=1\n\n    ```", "```\n     [siteA-gw]> ip route add 10.198.0.0/16 via 192.168.4.5\n     [siteA-gw]> ip route add 10.200.0.0/24 via 192.168.4.5\n\n    ```", "```\n     [client]$ ping -c 2 10.198.0.10\n     PING 10.198.0.10 (10.198.0.10) 56(84) bytes of data.\n     64 bytes from 10.198.0.10: icmp_seq=1 ttl=63 time=31.1 ms\n     64 bytes from 10.198.0.10: icmp_seq=2 ttl=63 time=30.0 ms\n\n    ```", "```\n     [server]$ ping -c 2 192.168.4.164\n     PING 192.168.4.164 (192.168.4.164) 56(84) bytes of data.\n     64 bytes from 192.168.4.164: icmp_seq=1 ttl=64 time=30.2 ms\n     64 bytes from 192.168.4.164: icmp_seq=2 ttl=64 time=29.7 ms\n\n    ```", "```\niroute 192.168.4.0 255.255.255.0 \n\n```", "```\nroute 192.168.4.0 255.255.255.0 10.200.0.1 \n\n```", "```\npush \"route 192.168.4.0 255.255.255.0\" \n\n```", "```\n            push \"redirect-gateway def1\" \n\n    ```", "```\n     [root@server]# openvpn --config example2-7-server.conf\n\n    ```", "```\n     [root@server]# sysctl -w net.ipv4.ip_forward=1\n\n    ```", "```\n     [root@client]# openvpn --config basic-udp-client.conf\n\n    ```", "```\npush \"redirect-gateway def1\" \n\n```", "```\n192.168.96.101 via 192.168.4.1 dev eth0 \n0.0.0.0/1 via 10.200.0.1 dev tun0 \n128.0.0.0/1 via 10.200.0.1 dev tun0 \n\n```", "```\npush \"redirect-gateway\" \n\n```", "```\n            route 192.168.4.0 255.255.255.0 net_gateway \n\n    ```", "```\n            route 10.198.0.0 255.255.0.0 vpn_gateway\n    ```", "```\n            push \"redirect-gateway ipv6 !ipv4\" \n\n    ```", "```\n     [root@server]# openvpn --config example2-8-server.conf\n\n    ```", "```\n     [root@server]# sysctl -w net.ipv6.conf.all.forwarding=1\n\n    ```", "```\n     [root@client]# openvpn --config basic-udp-client.conf\n    [...]\n    add_route_ipv6(::/3 -> 2001:db8:100::1 metric -1) dev tun1\n    add_route_ipv6(2000::/4 -> 2001:db8:100::1 metric -1) dev \n              tun1\n    add_route_ipv6(3000::/4 -> 2001:db8:100::1 metric -1) dev \n              tun1\n    add_route_ipv6(fc00::/7 -> 2001:db8:100::1 metric -1) dev \n              tun1\n    Initialization Sequence Completed\n\n    ```", "```\npush \"redirect-gateway ipv6 !ipv4\" \n\n```", "```\n2000::/4 \n3000::/4 \nfc00::/4 \n\n```", "```\npush \"route-ipv6 2000::/4\" \npush \"route-ipv6 3000::/4\" \npush \"route-ipv6 fc00::/4\" \n\n```", "```\n            proto udp \n            port 1194 \n            dev tun \n\n            mode server \n            ifconfig 192.168.200.1 255.255.255.0 \n            ifconfig-pool 192.168.200.100 192.168.200.120 \n            route 192.168.200.0 255.255.248.0 192.168.200.1 \n            push \"route 192.168.200.1\" \n            push \"route 192.168.200.0 255.255.248.0\" \n\n            ca       /etc/openvpn/cookbook/ca.crt \n            cert     /etc/openvpn/cookbook/server.crt \n            key      /etc/openvpn/cookbook/server.key \n            dh       /etc/openvpn/cookbook/dh2048.pem \n            tls-auth /etc/openvpn/cookbook/ta.key 0 \n\n            persist-key \n            persist-tun \n            keepalive 10 60 \n\n            topology subnet \n            push \"topology subnet\" \n\n            user  nobody \n            group nobody  # use \"group nogroup\" on some distros \n\n            daemon \n            log-append /var/log/openvpn.log \n\n            client-config-dir /etc/openvpn/cookbook/clients \n\n    ```", "```\n     [root@server]# openvpn --config example2-9-server.conf\n\n    ```", "```\n     [root@server]# mkdir -m 755 /etc/openvpn/cookbook/clients\n     [root@server]# cd /etc/openvpn/cookbook/clients\n     [root@server]# echo \"ifconfig-push 192.168.202.6 \n               192.168.202.6\" \\\n     > client1\n\n    ```", "```\n     [root@AdminClient]# openvpn --config basic-udp-client.conf\n    [...]\n    [openvpnserver] Peer Connection Initiated with \n               openvpnserver:1194\n    TUN/TAP device tun0 opened\n    do_ifconfig, tt->ipv6=0, tt->did_ifconfig_ipv6_setup=0\n    /usr/sbin/ip link set dev tun0 up mtu 1500\n    /usr/sbin/ip addr add dev tun0 **192.168.202.6/24** broadcast     \n               192.168.200.255\n    Initialization Sequence Completed \n\n    ```", "```\n            client \n            proto udp \n            remote openvpnserver.example.com \n            port 1194 \n            dev tun \n            nobind \n\n            ca       \"c:/program files/openvpn/config/ca.crt\" \n            cert     \"c:/program files/openvpn/config/client2.crt\" \n            key      \"c:/program files/openvpn/config/client2.key\" \n            tls-auth \"c:/program files/openvpn/config/ta.key\" 1 \n\n            remote-cert-tls server \n\n    ```", "```\n     [AdminClient]$ ping 192.168.200.1\n     [AdminClient]$ ping 192.168.200.102\n\n    ```", "```\n     [WinClient]C:> ping 192.168.200.1\n     [WinClient]C:> ping 192.168.202.6\n\n    ```", "```\nserver 192.168.200.0 255.255.255.0 \n\n```", "```\nmode server \ntls-server \n\nifconfig 192.168.200.1 192.168.200.2  \nifconfig-pool 192.168.200.4 192.168.200.251 \nroute 192.168.200.0 255.255.255.0 \npush \"route 192.168.200.1\" \nif (topology==subnet) push \"topology subnet\" \n\n```", "```\nC:\\Program Files\\OpenVPN\\config \n\n```", "```\nca       ca.crt \ncert     client2.crt \nkey      client2.key \ntls-auth ta.key 1 \n\n```", "```\nclient-to-client \n\n```", "```\nroute 192.168.200.0 255.255.255.0 \npush \"route 192.168.200.0 255.255.255.0\" \n\n```", "```\nproto udp \n\n```", "```\nproto tcp \n\n```", "```\n            status /var/log/openvpn.status \n\n    ```", "```\n     [root@server]# openvpn --config example2-10-server.conf\n\n    ```", "```\n     [root@client1]# openvpn --config basic-udp-client.conf\n\n    ```", "```\n     [root@server]# cat /var/log/openvpn.status\n\n    ```", "```\n     [WinClient2]C:> cd \\program files\\openvpn\\config\n     [WinClient2]C:> ..\\bin\\openvpn --config basic-udp-\n               client.ovpn\n\n    ```", "```\n     [root@server]# cat /var/log/openvpn.status\n\n    ```", "```\nkeepalive 10 60 \n\n```", "```\nexplicit-exit-notify [N] \n\n```", "```\n     [root@server]# openvpn --config basic-udp-server.conf\n\n    ```", "```\n            management tunnel 23000 stdin \n\n    ```", "```\n     [WinClient]C:> cd \\program files\\openvpn\\config\n     [WinClient]C:> ..\\bin\\openvpn --config example2-11.ovpn\n\n    ```", "```\n     [server]$ telnet 10.200.0.3 23000\n    Trying 10.200.0.3...\n    Connected to 10.200.0.3.\n    Escape character is '^]'.\n    ENTER PASSWORD:\n    SUCCESS: password is correct\n    >INFO:OpenVPN Management Interface Version 1 -- type 'help' \n              for more info\n    status\n    OpenVPN STATISTICS\n    Updated,Fri Feb 5 18:22:31 2016\n    TUN/TAP read bytes,21849\n    TUN/TAP write bytes,451\n    TCP/UDP read bytes,6571\n    TCP/UDP write bytes,30172\n    Auth read bytes,707\n    TAP-WIN32 driver status,\"(null)\"\n    END\n    signal SIGTERM\n\n    ```", "```\nmanagement tunnel 23000 stdin \n\n```", "```\nsignal SIGTERM \n\n```", "```\n            script-security 2 \n            client-connect    /etc/openvpn/cookbook/proxyarp-connect.sh \n            client-disconnect /etc/openvpn/cookbook/proxyarp-disconnect.sh \n\n    ```", "```\n            #!/bin/bash \n            /sbin/arp -i eth0  -Ds $ifconfig_pool_remote_ip eth0 pub \n\n    ```", "```\n            #!/bin/bash \n            /sbin/arp -i eth0  -d $ifconfig_pool_remote_ip \n\n    ```", "```\n     [root@server]# cd /etc/openvpn/cookbook\n     [root@server]# chmod 755 proxyarp-connect.sh \n     [root@server]# chmod 755 proxyarp-disconnect.sh\n\n    ```", "```\n     [root@server]# openvpn --config example2-12-server.conf\n\n    ```", "```\n10.198.1.130 * * MP eth0 \n\n```", "```\n[siteBclient]C:> ping 10.198.1.130\n\n```", "```\nuser nobody \ngroup nobody\n```"]