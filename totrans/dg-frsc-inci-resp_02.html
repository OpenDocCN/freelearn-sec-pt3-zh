<html><head></head><body>
<div id="_idContainer015">
<h1 class="chapter-number" id="_idParaDest-29"><a id="_idTextAnchor028"/><span class="koboSpan" id="kobo.1.1">2</span></h1>
<h1 id="_idParaDest-30"><a id="_idTextAnchor029"/><span class="koboSpan" id="kobo.2.1">Managing Cyber Incidents</span></h1>
<p><span class="koboSpan" id="kobo.3.1">The incident response framework detailed in the previous chapter provided the specific structure of a </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Computer Security Incident Response Team</span></strong><span class="koboSpan" id="kobo.5.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.6.1">CSIRT</span></strong><span class="koboSpan" id="kobo.7.1">) and explained how the CSIRT will engage with other business units. </span><span class="koboSpan" id="kobo.7.2">The chapter further expanded on the necessary planning and preparation an organization should undertake to address cyber incidents. </span><span class="koboSpan" id="kobo.7.3">Unfortunately, planning and preparation cannot address all the variables and uncertainties inherent to cyber incidents.</span></p>
<p><span class="koboSpan" id="kobo.8.1">This chapter will focus on executing the plans and frameworks detailed in </span><a href="B18571_01.xhtml#_idTextAnchor013"><em class="italic"><span class="koboSpan" id="kobo.9.1">Chapter 1</span></em></a><span class="koboSpan" id="kobo.10.1"> to properly manage a cyber incident. </span><span class="koboSpan" id="kobo.10.2">A solid foundation in, and an understanding of, cyber incident management allows organizations to put their plans into action more efficiently, communicate with key stakeholders in a timely manner, and, most importantly, lessen the potential damage or downtime of a cyber incident.</span></p>
<p><span class="koboSpan" id="kobo.11.1">This chapter will address how to manage a cyber incident, examining the following topics:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.12.1">Engaging the incident response team</span></li>
<li><span class="koboSpan" id="kobo.13.1">Security orchestration, automation, and response</span></li>
<li><span class="koboSpan" id="kobo.14.1">Incorporating crisis communications</span></li>
<li><span class="koboSpan" id="kobo.15.1">Incorporating containment strategies</span></li>
<li><span class="koboSpan" id="kobo.16.1">Getting back to normal – eradication, recovery, and post-incident activity</span></li>
</ul>
<p><span class="koboSpan" id="kobo.17.1">Engaging a CSIRT, much like a fire department, requires a set path of escalation. </span><span class="koboSpan" id="kobo.17.2">In the following sections, there are three CSIRT models that describe some options when looking at a proper escalation path.</span></p>
<h1 id="_idParaDest-31"><a id="_idTextAnchor030"/><span class="koboSpan" id="kobo.18.1">Engaging the incident response team</span></h1>
<p><span class="koboSpan" id="kobo.19.1">A CSIRT </span><a id="_idIndexMarker147"/><span class="koboSpan" id="kobo.20.1">functions </span><a id="_idIndexMarker148"/><span class="koboSpan" id="kobo.21.1">is much the same way as a fire department. </span><span class="koboSpan" id="kobo.21.2">A </span><a id="_idIndexMarker149"/><span class="koboSpan" id="kobo.22.1">fire department has specifically trained professionals who are tasked with responding to emergency situations with specialized equipment to contain and eradicate a fire. </span><span class="koboSpan" id="kobo.22.2">In order to engage a fire department, a citizen must contact emergency services and provide key information, such as the nature of the emergency, the location, and whether any lives are in danger. </span><span class="koboSpan" id="kobo.22.3">From here, this information is passed on to the fire department, which dispatches resources to the emergency.</span></p>
<p><span class="koboSpan" id="kobo.23.1">The process of </span><a id="_idIndexMarker150"/><span class="koboSpan" id="kobo.24.1">engaging a CSIRT is very similar to engaging a fire department. </span><span class="koboSpan" id="kobo.24.2">Internal or external personnel needs to escalate indications of a cybersecurity incident to the appropriate personnel. </span><span class="koboSpan" id="kobo.24.3">From here, resources are dispatched to the appropriate location(s), where those on the ground will take the lead in containing the incident and eradicating or limiting potential downtime or loss of data. </span><span class="koboSpan" id="kobo.24.4">To make this process as efficient as possible, the following components of the engagement process are critical:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.25.1">CSIRT models provide a framework that places the CSIRT and the associated escalation procedures within the organizational structure</span></li>
<li><span class="koboSpan" id="kobo.26.1">A </span><strong class="bold"><span class="koboSpan" id="kobo.27.1">war room</span></strong><span class="koboSpan" id="kobo.28.1"> describes the location from which the CSIRT manages the incident </span></li>
<li><span class="koboSpan" id="kobo.29.1">Communication address the ability of the CSIRT to communicate properly</span></li>
<li><span class="koboSpan" id="kobo.30.1">The rotation of staff manages the need to rest personnel during a prolonged incident</span></li>
</ul>
<h2 id="_idParaDest-32"><a id="_idTextAnchor031"/><span class="koboSpan" id="kobo.31.1">CSIRT engagement models</span></h2>
<p><span class="koboSpan" id="kobo.32.1">How an organization engages its CSIRT capability is largely dependent on how it is structured. </span><span class="koboSpan" id="kobo.32.2">Organizations </span><a id="_idIndexMarker151"/><span class="koboSpan" id="kobo.33.1">configure their CSIRT to best fit their structure and resources. </span><span class="koboSpan" id="kobo.33.2">The following three basic structures can serve as a guide for placing the CSIRT within the most suitable part of the organization to facilitate speedy escalation, as well as capturing as many details of the incident as possible, in order for a proper investigation to take place.</span></p>
<h3><span class="koboSpan" id="kobo.34.1">Security operations center escalation</span></h3>
<p><span class="koboSpan" id="kobo.35.1">In </span><a id="_idIndexMarker152"/><span class="koboSpan" id="kobo.36.1">this organizational </span><a id="_idIndexMarker153"/><span class="koboSpan" id="kobo.37.1">model, the </span><strong class="bold"><span class="koboSpan" id="kobo.38.1">Security Operations Center</span></strong><span class="koboSpan" id="kobo.39.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.40.1">SOC</span></strong><span class="koboSpan" id="kobo.41.1">) is </span><a id="_idIndexMarker154"/><span class="koboSpan" id="kobo.42.1">responsible for handling the initial incident detection or investigation. </span><span class="koboSpan" id="kobo.42.2">In general, the SOC is responsible for the management of the security tools that monitor the network infrastructure. </span><span class="koboSpan" id="kobo.42.3">It has direct access to event management, intrusion prevention and detection, and antivirus systems. </span><span class="koboSpan" id="kobo.42.4">From here, it can view events, receive and review alerts, and process other security-related data.</span></p>
<p><span class="koboSpan" id="kobo.43.1">SOC </span><a id="_idIndexMarker155"/><span class="koboSpan" id="kobo.44.1">escalation </span><a id="_idIndexMarker156"/><span class="koboSpan" id="kobo.45.1">is a common model among </span><a id="_idIndexMarker157"/><span class="koboSpan" id="kobo.46.1">organizations that have a dedicated </span><a id="_idIndexMarker158"/><span class="koboSpan" id="kobo.47.1">SOC, either through in-house personnel, a third-party </span><strong class="bold"><span class="koboSpan" id="kobo.48.1">Managed Security Service Provider</span></strong><span class="koboSpan" id="kobo.49.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.50.1">MSSP</span></strong><span class="koboSpan" id="kobo.51.1">), or a </span><strong class="bold"><span class="koboSpan" id="kobo.52.1">Managed Detection and Response</span></strong><span class="koboSpan" id="kobo.53.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.54.1">MDR</span></strong><span class="koboSpan" id="kobo.55.1">) provider. </span><span class="koboSpan" id="kobo.55.2">In this model, there are clearly defined steps, from the initial notification to the engagement of the CSIRT, as follows:</span></p>
<ol>
<li><span class="koboSpan" id="kobo.56.1">An alert or detection is received by the SOC or Tier 1 analyst.</span></li>
<li><span class="koboSpan" id="kobo.57.1">The SOC or Tier 1 analyst conducts the initial analysis and then determines whether the alert or detection meets the criteria for an incident.</span></li>
<li><span class="koboSpan" id="kobo.58.1">If warranted, the analyst will then escalate the incident to the SOC manager.</span></li>
<li><span class="koboSpan" id="kobo.59.1">After a review by the SOC manager, the incident is escalated to an on-call incident response analyst(s).</span></li>
<li><span class="koboSpan" id="kobo.60.1">The CSIRT analyst(s) will review the alert or detection and determine whether the incident warrants engaging the entire CSIRT capability based on its severity.</span></li>
<li><span class="koboSpan" id="kobo.61.1">Depending on the severity of the incident, the CSIRT analysts will either address it or escalate it to the CSIRT manager to engage the entire CSIRT capability.</span></li>
</ol>
<p><span class="koboSpan" id="kobo.62.1">The following diagram shows the flow of incident escalation from detection to escalation to the CSIRT manager:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer010">
<span class="koboSpan" id="kobo.63.1"><img alt="" src="image/B18571_02_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.64.1">Figure 2.1 – The SOC engagement model</span></p>
<p><span class="koboSpan" id="kobo.65.1">In </span><a id="_idIndexMarker159"/><span class="koboSpan" id="kobo.66.1">this model, there </span><a id="_idIndexMarker160"/><span class="koboSpan" id="kobo.67.1">are several issues of concern </span><a id="_idIndexMarker161"/><span class="koboSpan" id="kobo.68.1">that need to be addressed by the CSIRT and SOC personnel, as follows:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.69.1">First, engaging the CSIRT in this manner creates a situation where there are several individuals handling an incident before the CSIRT is fully engaged. </span><span class="koboSpan" id="kobo.69.2">This increases the time between the detection and the CSIRT response, which could increase the potential impact of an incident.</span></li>
<li><span class="koboSpan" id="kobo.70.1">Second, if the incident escalation is not properly documented, the CSIRT manager would have to engage the SOC manager for clarification or additional information, thereby increasing the time taken to properly address an incident.</span></li>
<li><span class="koboSpan" id="kobo.71.1">Third, the SOC personnel requires training to determine which observed events constitute an incident and which may be false positives. </span><span class="koboSpan" id="kobo.71.2">The CSIRT may suffer from burnout and become weary of the SOC chasing up false incidents.</span></li>
<li><span class="koboSpan" id="kobo.72.1">Finally, communication between the SOC and the CSIRT needs to be clear and concise. </span><span class="koboSpan" id="kobo.72.2">Any gap in their ability to share information in real time will cause additional confusion.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.73.1">Another variation of this model, common within organizations without a dedicated SOC, is where an initial security incident is received by either a helpdesk or a network operations center. </span><span class="koboSpan" id="kobo.73.2">This adds further complexity in terms of engaging the CSIRT in a timely </span><a id="_idIndexMarker162"/><span class="koboSpan" id="kobo.74.1">manner, as this kind of personnel </span><a id="_idIndexMarker163"/><span class="koboSpan" id="kobo.75.1">is often not trained to address incidents of this nature.</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.76.1">Tip</span></p>
<p class="callout"><span class="koboSpan" id="kobo.77.1">The best practice in a case such as this is to have several of the personnel on these teams trained in cybersecurity analysis, to address initial triage and a proper escalation.</span></p>
<h3><span class="koboSpan" id="kobo.78.1">A SOC integration model</span></h3>
<p><span class="koboSpan" id="kobo.79.1">To limit </span><a id="_idIndexMarker164"/><span class="koboSpan" id="kobo.80.1">some of the drawbacks of </span><a id="_idIndexMarker165"/><span class="koboSpan" id="kobo.81.1">the SOC escalation model, some organizations embed the SOC within the overall CSIRT. </span><span class="koboSpan" id="kobo.81.2">Placing the SOC in such a structure may prove to be a more efficient fit since the SOC has responsibility for the initial alerting and triaging function, which is directly related to the CSIRT.</span></p>
<p><span class="koboSpan" id="kobo.82.1">In this model, the SOC analyst serves as the first tier. </span><span class="koboSpan" id="kobo.82.2">As previously discussed, they have the first view of security events or security control alerts. </span><span class="koboSpan" id="kobo.82.3">After processing and triaging the alert, they have the ability to immediately escalate the incident to the Tier 2 analyst, without having to engage a manager who would then escalate it to the CSIRT manager. </span><span class="koboSpan" id="kobo.82.4">This process is highlighted in the following diagram:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer011">
<span class="koboSpan" id="kobo.83.1"><img alt="" src="image/B18571_02_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.84.1">Figure 2.2 – A SOC integrated model</span></p>
<p><span class="koboSpan" id="kobo.85.1">This model has some distinct advantages over the previous one. </span><span class="koboSpan" id="kobo.85.2">First, the CSIRT has a greater degree of visibility into what the SOC is seeing and doing. </span><span class="koboSpan" id="kobo.85.3">Furthermore, having the SOC </span><a id="_idIndexMarker166"/><span class="koboSpan" id="kobo.86.1">embedded within the CSIRT allows </span><a id="_idIndexMarker167"/><span class="koboSpan" id="kobo.87.1">the CSIRT manager and their team to craft more efficient policies and procedures related to incidents. </span><span class="koboSpan" id="kobo.87.2">A second distinct advantage of this approach is that the incident escalation is completed much faster and likely with greater precision. </span><span class="koboSpan" id="kobo.87.3">With the SOC analyst directly escalating to the next tier of CSIRT personnel, the entire process is much faster, and a more detailed analysis is performed as a result.</span></p>
<p><span class="koboSpan" id="kobo.88.1">This approach works well in organizations with a dedicated SOC that is in-house and not outsourced. </span><span class="koboSpan" id="kobo.88.2">For organizations making use of a network operations center or a helpdesk, and without a dedicated SOC, this approach is not realistic, as those functions are often managed outside of the CSIRT or even the network security teams. </span><span class="koboSpan" id="kobo.88.3">One other issue is that, depending on the size of the SOC and CSIRTs, additional CSIRT managers may be required in order to address the day-to-day workload of both the SOC and the CSIRT.</span></p>
<h3><span class="koboSpan" id="kobo.89.1">A fusion center</span></h3>
<p><span class="koboSpan" id="kobo.90.1">As threat intelligence becomes an increasing part of daily security operations, one organizational structure that addresses this trend is the CSIRT fusion center. </span><span class="koboSpan" id="kobo.90.2">In this case, the CSIRT analysts, SOC analysts, and threat intelligence analysts team up within a single team structure. </span><span class="koboSpan" id="kobo.90.3">This merges the elements of a SOC- and CSIRT-combined structure with dedicated </span><a id="_idIndexMarker168"/><span class="koboSpan" id="kobo.91.1">threat intelligence analysts. </span><span class="koboSpan" id="kobo.91.2">In such a scenario, the threat intelligence analysts would be responsible for augmenting incident investigations </span><a id="_idIndexMarker169"/><span class="koboSpan" id="kobo.92.1">with external and internal resources related to the incident. </span><span class="koboSpan" id="kobo.92.2">They could also be leveraged for detailed analysis in other areas related to the incident. </span><span class="koboSpan" id="kobo.92.3">The following diagram shows the workflow from the fusion center director to the various personnel responsible for incident management:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer012">
<span class="koboSpan" id="kobo.93.1"><img alt="" src="image/B18571_02_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.94.1">Figure 2.3 – A fusion center model</span></p>
<p><span class="koboSpan" id="kobo.95.1">As organizations continue to develop threat intelligence resources within their security operations, this model allows the CSIRT to make use of that capability without having to create new processes. </span><span class="koboSpan" id="kobo.95.2">In </span><a href="B18571_17.xhtml#_idTextAnchor304"><em class="italic"><span class="koboSpan" id="kobo.96.1">Chapter 17</span></em></a><span class="koboSpan" id="kobo.97.1"> we will discuss threat intelligence in greater depth and explain how this capability may enhance incident investigations.</span></p>
<p><span class="koboSpan" id="kobo.98.1">Alongside </span><a id="_idIndexMarker170"/><span class="koboSpan" id="kobo.99.1">additional personnel, the fusion center model makes use of additional technologies. </span><span class="koboSpan" id="kobo.99.2">The SOC models will often use a </span><strong class="bold"><span class="koboSpan" id="kobo.100.1">Security Information and Event Management</span></strong><span class="koboSpan" id="kobo.101.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.102.1">SIEM</span></strong><span class="koboSpan" id="kobo.103.1">) system to provide network visibility and detect intrusions via log and alerting sources. </span><span class="koboSpan" id="kobo.103.2">The </span><a id="_idIndexMarker171"/><span class="koboSpan" id="kobo.104.1">fusion center will often also make use of </span><strong class="bold"><span class="koboSpan" id="kobo.105.1">Security Orchestration, Automation, and Response</span></strong><span class="koboSpan" id="kobo.106.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.107.1">SOAR</span></strong><span class="koboSpan" id="kobo.108.1">), which is discussed later in this chapter. </span><span class="koboSpan" id="kobo.108.2">Both tools provide network visibility and the ability to quickly pivot to key systems during an incident.</span></p>
<p><span class="koboSpan" id="kobo.109.1">The CSIRT fusion </span><a id="_idIndexMarker172"/><span class="koboSpan" id="kobo.110.1">center is not widely deployed, largely because threat intelligence integration is a relatively new methodology, as well </span><a id="_idIndexMarker173"/><span class="koboSpan" id="kobo.111.1">as it being resource intensive. </span><span class="koboSpan" id="kobo.111.2">Very few organizations have the resources in either technology or personnel to make this type of structure effective. </span><span class="koboSpan" id="kobo.111.3">Pulling in full-time threat intelligence analysts, as well as various paid and open source feeds (and the technology to support them), is often cost-prohibitive. </span><span class="koboSpan" id="kobo.111.4">As a result of this, there are not many organizations that can leverage a full-time threat intelligence analyst as part of their CSIRT capability.</span></p>
<h2 id="_idParaDest-33"><a id="_idTextAnchor032"/><span class="koboSpan" id="kobo.112.1">Investigating incidents</span></h2>
<p><span class="koboSpan" id="kobo.113.1">Once the CSIRT is engaged, one of its primary tasks is to investigate the incident. </span><span class="koboSpan" id="kobo.113.2">The lion’s share </span><a id="_idIndexMarker174"/><span class="koboSpan" id="kobo.114.1">of this volume addresses the various methods that can be leveraged when investigating an incident. </span><span class="koboSpan" id="kobo.114.2">The primary </span><a id="_idIndexMarker175"/><span class="koboSpan" id="kobo.115.1">goal of the CSIRT is to utilize methods that follow a systems analysis to address the following key facets of an incident:</span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.116.1">Identifying the scope</span></strong><span class="koboSpan" id="kobo.117.1">: In some incidents, the actual scope may not be clearly defined at the initial detection stage. </span><span class="koboSpan" id="kobo.117.2">For example, a law enforcement agency may </span><a id="_idIndexMarker176"/><span class="koboSpan" id="kobo.118.1">contact an organization to indicate that a C2 server has been taken down. </span><span class="koboSpan" id="kobo.118.2">During an analysis of that system, the external IP address of the organization has been identified. </span><span class="koboSpan" id="kobo.118.3">From this data point, the scope is first defined as the entire network. </span><span class="koboSpan" id="kobo.118.4">From here, the CSIRT would analyze data from the firewall or web proxy to identify the internal systems that were found to be communicating with the C2 server. </span><span class="koboSpan" id="kobo.118.5">From this data, they would narrow down the initial scope of the incident to those systems that had been impacted.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.119.1">When attempting to identify the scope of the incident, there is a drive to find patient zero, or the first system that was compromised. </span><span class="koboSpan" id="kobo.119.2">In some incidents, this may be easy to discover. </span><span class="koboSpan" id="kobo.119.3">A phishing email containing a PDF document that, when opened, executes malware can be easily identified by the user or security control. </span><span class="koboSpan" id="kobo.119.4">Other attacks may not be so obvious. </span><span class="koboSpan" id="kobo.119.5">While finding patient zero does provide </span><a id="_idIndexMarker177"/><span class="koboSpan" id="kobo.120.1">a good deal of data for root-cause analysis, it is more important to identify the scope of the incident first, rather than looking for a single system.</span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.121.1">Identifying the impact</span></strong><span class="koboSpan" id="kobo.122.1">: Another key consideration is determining the impact of the </span><a id="_idIndexMarker178"/><span class="koboSpan" id="kobo.123.1">incident. </span><span class="koboSpan" id="kobo.123.2">Those that have been exposed to the fundamental concepts of information security will be well familiar </span><a id="_idIndexMarker179"/><span class="koboSpan" id="kobo.124.1">with the </span><strong class="bold"><span class="koboSpan" id="kobo.125.1">CIA triad</span></strong><span class="koboSpan" id="kobo.126.1">. </span><span class="koboSpan" id="kobo.126.2">The CIA triad represents the elements </span><a id="_idIndexMarker180"/><span class="koboSpan" id="kobo.127.1">of security within an information system: </span><strong class="bold"><span class="koboSpan" id="kobo.128.1">confidentiality</span></strong><span class="koboSpan" id="kobo.129.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.130.1">integrity</span></strong><span class="koboSpan" id="kobo.131.1">, and </span><strong class="bold"><span class="koboSpan" id="kobo.132.1">availability</span></strong><span class="koboSpan" id="kobo.133.1">. </span><span class="koboSpan" id="kobo.133.2">Any breach or violation of security </span><a id="_idIndexMarker181"/><span class="koboSpan" id="kobo.134.1">will have an impact on one or more of these </span><a id="_idIndexMarker182"/><span class="koboSpan" id="kobo.135.1">elements. </span><span class="koboSpan" id="kobo.135.2">For example, a ransomware incident that impacts 15 production servers impacts the availability of the data on those systems. </span><span class="koboSpan" id="kobo.135.3">Impacts on availability that are related to the incident, either occurring as a direct result, due to adversary actions, or the time it takes to respond and remediate, are important factors to determine the incident’s impact. </span><span class="koboSpan" id="kobo.135.4">Other incidents, such as the theft of intellectual property, impact the confidentiality of data. </span><span class="koboSpan" id="kobo.135.5">Finally, incidents involving unauthorized manipulation of source code or other data impact the integrity of that data. </span><span class="koboSpan" id="kobo.135.6">The following diagram highlights the CIA triad:</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer013">
<span class="koboSpan" id="kobo.136.1"><img alt="" src="image/B18571_02_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.137.1">Figure 2.4 – The CIA triad</span></p>
<p><span class="koboSpan" id="kobo.138.1">Understanding </span><a id="_idIndexMarker183"/><span class="koboSpan" id="kobo.139.1">the potential impact of an incident is important for making decisions concerning the resources </span><a id="_idIndexMarker184"/><span class="koboSpan" id="kobo.140.1">that are allocated for a response. </span><span class="koboSpan" id="kobo.140.2">A </span><strong class="bold"><span class="koboSpan" id="kobo.141.1">Distributed Denial-of-Service</span></strong><span class="koboSpan" id="kobo.142.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.143.1">DDoS</span></strong><span class="koboSpan" id="kobo.144.1">) attack against a non-critical service on the web will not necessitate the same type of response as when discovering credit card-harvesting malware within a retail payment infrastructure. </span><span class="koboSpan" id="kobo.144.2">The impact also has a direct bearing on compliance with laws and other regulations. </span><span class="koboSpan" id="kobo.144.3">Understanding the potential impact of an incident on compliance is critical in ensuring that a proper response is conducted.</span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.145.1">Identifying the root cause</span></strong><span class="koboSpan" id="kobo.146.1">: The central question that IT professionals and managers </span><a id="_idIndexMarker185"/><span class="koboSpan" id="kobo.147.1">will ask during, and especially after, an incident is: how did this happen? </span><span class="koboSpan" id="kobo.147.2">Organizations spend a great deal of money and resources on protecting their infrastructure. </span><span class="koboSpan" id="kobo.147.3">If an incident has occurred that causes an impact, there will be a need to understand how it happened. </span><span class="koboSpan" id="kobo.147.4">The goal of an incident investigation is to determine what sequence of events, vulnerabilities, or other conditions were present that led to the incident and its impact. </span><span class="koboSpan" id="kobo.147.5">Often, the root cause of an incident is not a simple vulnerability but a sequence of events and conditions that allowed an adversary to penetrate </span><a id="_idIndexMarker186"/><span class="koboSpan" id="kobo.148.1">security systems and conduct their attack. </span><span class="koboSpan" id="kobo.148.2">Through an investigation, these events and conditions can be identified so that they are corrected, or otherwise controlled.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.149.1">Incident attribution</span></strong><span class="koboSpan" id="kobo.150.1">: One area of debate within incident investigation is incident </span><a id="_idIndexMarker187"/><span class="koboSpan" id="kobo.151.1">attribution. </span><span class="koboSpan" id="kobo.151.2">With attribution, the CSIRT or investigative body attempts to determine which organization was behind the attack. </span><span class="koboSpan" id="kobo.151.3">Incidents may be attributed to nation-state actors, criminal groups, or other cyber adversaries.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.152.1">While there is some importance to attribution from a threat intelligence perspective (</span><a href="B18571_17.xhtml#_idTextAnchor304"><em class="italic"><span class="koboSpan" id="kobo.153.1">Chapter 17</span></em></a><span class="koboSpan" id="kobo.154.1"> will address attribution as far as it relates to incident response), resources are better off spent on investigating or containing an incident. </span><span class="koboSpan" id="kobo.154.2">Attempting to ascertain the group or groups responsible for an attack is time-consuming, with few positive returns. </span><span class="koboSpan" id="kobo.154.3">If the organization’s leadership is adamant about determining attribution, the best approach is to comprehensively document the incident and pass off the data to a third party that specifically addresses attribution. </span><span class="koboSpan" id="kobo.154.4">Such organizations often combine data from several incident investigations to build a dossier on certain groups. </span><span class="koboSpan" id="kobo.154.5">If the data supplied matches the activities of one of these groups, they may be able to provide some context in terms of attribution.</span></p>
<h2 id="_idParaDest-34"><a id="_idTextAnchor033"/><span class="koboSpan" id="kobo.155.1">The CSIRT war room</span></h2>
<p><span class="koboSpan" id="kobo.156.1">Another consideration when engaging a CSIRT is the need to have a single location from which the CSIRT </span><a id="_idIndexMarker188"/><span class="koboSpan" id="kobo.157.1">can operate. </span><span class="koboSpan" id="kobo.157.2">There are several terms in use for </span><a id="_idIndexMarker189"/><span class="koboSpan" id="kobo.158.1">the physical location that a CSIRT can operate from, such as a SOC or a crisis suite, but a simpler term is a war room. </span><span class="koboSpan" id="kobo.158.2">A war room can be set up as necessary; or, in some instances, a dedicated war room is set aside. </span><span class="koboSpan" id="kobo.158.3">In the former case, an existing meeting room is purposed as the war room for the duration of the entire incident. </span><span class="koboSpan" id="kobo.158.4">This is often the preferred option for those organizations that do not have a high enough number of incidents to necessitate a dedicated war room. </span><span class="koboSpan" id="kobo.158.5">For those organizations that experience a higher number of incidents or more complex incidents, there may be a need to create a dedicated war room.</span></p>
<p><span class="koboSpan" id="kobo.159.1">The war </span><a id="_idIndexMarker190"/><span class="koboSpan" id="kobo.160.1">room should have the following capabilities to facilitate a more orderly response to incidents:</span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.161.1">Workspaces</span></strong><span class="koboSpan" id="kobo.162.1">: Each member of the CSIRT core team should have a dedicated workspace </span><a id="_idIndexMarker191"/><span class="koboSpan" id="kobo.163.1">in which to perform analysis and other incident-related tasks. </span><span class="koboSpan" id="kobo.163.2">Workspaces should include network connectivity, power, and monitors, along with specialized digital forensics tools.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.164.1">Team displays</span></strong><span class="koboSpan" id="kobo.165.1">: One of the frustrations that CSIRT members may encounter during an </span><a id="_idIndexMarker192"/><span class="koboSpan" id="kobo.166.1">incident is the inability to share the output of the analysis. </span><span class="koboSpan" id="kobo.166.2">An overhead projector or a large screen can facilitate better sharing of data across the entire team.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.167.1">Note sharing</span></strong><span class="koboSpan" id="kobo.168.1">: Along the lines of sharing data through team displays, there may also </span><a id="_idIndexMarker193"/><span class="koboSpan" id="kobo.169.1">be a need to share information among teams that are geographically dispersed. </span><span class="koboSpan" id="kobo.169.2">This may also be facilitated by using collaboration tools such as OneNote, SharePoint, or a wiki created for the incident.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.170.1">Whiteboards</span></strong><span class="koboSpan" id="kobo.171.1">: There is a good deal of information flowing in and out of a war room. </span><span class="koboSpan" id="kobo.171.2">Data </span><a id="_idIndexMarker194"/><span class="koboSpan" id="kobo.172.1">related to assignments and running lists of compromised systems are best left on a whiteboard so that they are clear to everyone.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.173.1">Limited access</span></strong><span class="koboSpan" id="kobo.174.1">: The CSIRT should limit access to a war room to only those personnel </span><a id="_idIndexMarker195"/><span class="koboSpan" id="kobo.175.1">who have a legitimate need to enter. </span><span class="koboSpan" id="kobo.175.2">Limiting access to this area prevents sensitive information from falling into the wrong hands.</span></li>
</ul>
<h2 id="_idParaDest-35"><a id="_idTextAnchor034"/><span class="koboSpan" id="kobo.176.1">Communications</span></h2>
<p><span class="koboSpan" id="kobo.177.1">One area </span><a id="_idIndexMarker196"/><span class="koboSpan" id="kobo.178.1">of consideration that is often overlooked by organizations </span><a id="_idIndexMarker197"/><span class="koboSpan" id="kobo.179.1">is how to communicate within a larger organization during an incident. </span><span class="koboSpan" id="kobo.179.2">With email, instant messaging, and voice calls, it may seem as though organizations already have the necessary tools to appropriately communicate internally. </span><span class="koboSpan" id="kobo.179.3">These communication platforms may need to be set aside in the event of an incident impacting user credentials, email systems, or other cloud-based collaboration platforms. </span><span class="koboSpan" id="kobo.179.4">For example, a common attack observed is the Office 365 cloud-based email being compromised. </span><span class="koboSpan" id="kobo.179.5">If attackers have gained access to the email system, they may have also compromised associated instant messaging applications, such as Skype. </span><span class="koboSpan" id="kobo.179.6">Given this, relying on these applications during an incident may, in fact, be providing the attackers with an insight into the actions of the CSIRT.</span></p>
<p><span class="koboSpan" id="kobo.180.1">If it is </span><a id="_idIndexMarker198"/><span class="koboSpan" id="kobo.181.1">suspected that these applications have been </span><a id="_idIndexMarker199"/><span class="koboSpan" id="kobo.182.1">compromised, it is critical to have a secondary—and even tertiary—communications option. </span><span class="koboSpan" id="kobo.182.2">Commercially acquired cell phones are often a safe alternative. </span><span class="koboSpan" id="kobo.182.3">Furthermore, CSIRT members may leverage free or low-cost collaboration tools for a limited time. </span><span class="koboSpan" id="kobo.182.4">These can be leveraged until such time that the usual communication platforms are deemed safe for use.</span></p>
<h2 id="_idParaDest-36"><a id="_idTextAnchor035"/><span class="koboSpan" id="kobo.183.1">Rotating staff</span></h2>
<p><span class="koboSpan" id="kobo.184.1">Prolonged incident investigations can begin to take their toll on CSIRT personnel, both physically and mentally. </span><span class="koboSpan" id="kobo.184.2">While it may seem prudent at the time to engage a team until an incident </span><a id="_idIndexMarker200"/><span class="koboSpan" id="kobo.185.1">has been addressed, this can have a detrimental impact on the team’s ability </span><a id="_idIndexMarker201"/><span class="koboSpan" id="kobo.186.1">to function. </span><span class="koboSpan" id="kobo.186.2">Studies have shown the negative cognitive effects of prolonged work with little rest. </span><span class="koboSpan" id="kobo.186.3">As a result, it is </span><a id="_idIndexMarker202"/><span class="koboSpan" id="kobo.187.1">imperative that the </span><strong class="bold"><span class="koboSpan" id="kobo.188.1">Incident Commander</span></strong><span class="koboSpan" id="kobo.189.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.190.1">IC</span></strong><span class="koboSpan" id="kobo.191.1">) places responders on shifts after approximately 12-24 hours have passed.</span></p>
<p><span class="koboSpan" id="kobo.192.1">For example, approximately 24 hours after an incident investigation has been started, it will become necessary to start rotating personnel so that they have a rest period of 8 hours. </span><span class="koboSpan" id="kobo.192.2">This also includes the IC. </span><span class="koboSpan" id="kobo.192.3">During a prolonged incident, an alternative IC should be named, to ensure continuity and that each of the ICs gets the appropriate amount of rest.</span></p>
<p><span class="koboSpan" id="kobo.193.1">Another strategy is to engage support elements during a period of inactivity in an incident. </span><span class="koboSpan" id="kobo.193.2">These periods </span><a id="_idIndexMarker203"/><span class="koboSpan" id="kobo.194.1">of inactivity generally occur when an incident has been contained and potential </span><strong class="bold"><span class="koboSpan" id="kobo.195.1">Command-and-Control</span></strong><span class="koboSpan" id="kobo.196.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.197.1">C2</span></strong><span class="koboSpan" id="kobo.198.1">) traffic has been addressed. </span><span class="koboSpan" id="kobo.198.2">Support personnel can be leveraged to monitor the network for any changes, giving the CSIRT time to rest.</span></p>
<h1 id="_idParaDest-37"><a id="_idTextAnchor036"/><span class="koboSpan" id="kobo.199.1">SOAR</span></h1>
<p><span class="koboSpan" id="kobo.200.1">A CSIRT </span><a id="_idIndexMarker204"/><span class="koboSpan" id="kobo.201.1">requires that a large and diverse group of people are brought together to properly address an incident. </span><span class="koboSpan" id="kobo.201.2">Whatever model an organization chooses to incorporate the functions of the CSIRT, there is still a good deal of coordination and information that needs to be analyzed and reported.</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.202.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.203.1">SOAR technologies are most often found in organizations with a more mature security posture. </span><span class="koboSpan" id="kobo.203.2">This is usually in organizations that have a dedicated SOC or fusion center. </span><span class="koboSpan" id="kobo.203.3">Other key customers that utilize this technology are MSSP or MDR providers. </span><span class="koboSpan" id="kobo.203.4">This is due to the cost of not only purchasing a commercial SOAR product but also its continual maintenance. </span><span class="koboSpan" id="kobo.203.5">Most organizations will not have the need for such a platform if they are addressing a small number of incidents per year. </span><span class="koboSpan" id="kobo.203.6">This material is included for familiarizing purposes.</span></p>
<p><span class="koboSpan" id="kobo.204.1">The technology research firm Gartner defines a SOAR as:</span></p>
<p class="author-quote"><span class="koboSpan" id="kobo.205.1">Solutions that combine incident response, orchestration and automation, and threat intelligence (TI) management capabilities in a single platform. </span><span class="koboSpan" id="kobo.205.2">SOAR tools are also used to document and implement processes (aka playbooks, workflows and processes); support security incident management; and apply machine-based assistance to human security analysts and operators.</span></p>
<p><span class="koboSpan" id="kobo.206.1">SOAR </span><a id="_idIndexMarker205"/><span class="koboSpan" id="kobo.207.1">platforms are the amalgamation of three separate tools. </span><span class="koboSpan" id="kobo.207.2">The first of these is an </span><strong class="bold"><span class="koboSpan" id="kobo.208.1">Incident Response Platform</span></strong><span class="koboSpan" id="kobo.209.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.210.1">IRP</span></strong><span class="koboSpan" id="kobo.211.1">). </span><span class="koboSpan" id="kobo.211.2">This tool is used to manage incident response workflows, case management, and the CSIRT’s knowledge </span><a id="_idIndexMarker206"/><span class="koboSpan" id="kobo.212.1">base. </span><span class="koboSpan" id="kobo.212.2">The second tool is the </span><strong class="bold"><span class="koboSpan" id="kobo.213.1">Security Orchestration and Automation</span></strong><span class="koboSpan" id="kobo.214.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.215.1">SOA</span></strong><span class="koboSpan" id="kobo.216.1">). </span><span class="koboSpan" id="kobo.216.2">This tool is used to manage incident playbooks, workflows, and processes. </span><span class="koboSpan" id="kobo.216.3">The SOA also automates low-level tasks, such as isolating an endpoint in response to malware detection and then notifying a SOC or CSIRT </span><a id="_idIndexMarker207"/><span class="koboSpan" id="kobo.217.1">analyst. </span><span class="koboSpan" id="kobo.217.2">The final tool that makes up a SOAR is a </span><strong class="bold"><span class="koboSpan" id="kobo.218.1">Threat Intelligence Platform</span></strong><span class="koboSpan" id="kobo.219.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.220.1">TIP</span></strong><span class="koboSpan" id="kobo.221.1">). </span><span class="koboSpan" id="kobo.221.2">A TIP is used to aggregate </span><strong class="bold"><span class="koboSpan" id="kobo.222.1">Indicators of Compromise</span></strong><span class="koboSpan" id="kobo.223.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.224.1">IOC</span></strong><span class="koboSpan" id="kobo.225.1">) from </span><a id="_idIndexMarker208"/><span class="koboSpan" id="kobo.226.1">internal or external sources. </span><span class="koboSpan" id="kobo.226.2">The TIP can then be used to enrich an alert from an </span><strong class="bold"><span class="koboSpan" id="kobo.227.1">Intrusion Detection System</span></strong><span class="koboSpan" id="kobo.228.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.229.1">IDS</span></strong><span class="koboSpan" id="kobo.230.1">) to </span><a id="_idIndexMarker209"/><span class="koboSpan" id="kobo.231.1">provide further context to the detection.</span></p>
<p><span class="koboSpan" id="kobo.232.1">For example, a malware detection tool is tied into an organization’s event management system. </span><span class="koboSpan" id="kobo.232.2">Something is detected and the information associated with the detection is forwarded to the SIEM. </span><span class="koboSpan" id="kobo.232.3">From here, the SIEM feeds data into the SOAR. </span><span class="koboSpan" id="kobo.232.4">Based on the parameters, the SOAR’s playbooks immediately isolate the system from the network. </span><span class="koboSpan" id="kobo.232.5">The file hash </span><a id="_idIndexMarker210"/><span class="koboSpan" id="kobo.233.1">is compared against the threat intelligence feeds and indicates that the file belongs to the BazarLoader family. </span><span class="koboSpan" id="kobo.233.2">Finally, a notice is sent to the CSIRT’s Slack channel, and they are able to respond to the infection and clean the system before reconnecting it to the network.</span></p>
<p><span class="koboSpan" id="kobo.234.1">There is a wide range of commercial and open source SOAR solutions. </span><span class="koboSpan" id="kobo.234.2">Even with the wide range of options available to organizations, most of these SOAR solutions, open source included, have the following capabilities:</span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.235.1">Alert prioritization</span></strong><span class="koboSpan" id="kobo.236.1">: CSIRT and SOC teams often have to address alerts from a variety </span><a id="_idIndexMarker211"/><span class="koboSpan" id="kobo.237.1">of sources with a variety of severities. </span><span class="koboSpan" id="kobo.237.2">SOAR </span><a id="_idIndexMarker212"/><span class="koboSpan" id="kobo.238.1">platforms are capable of tying a variety of alert sources, such as </span><strong class="bold"><span class="koboSpan" id="kobo.239.1">Endpoint Detection and Response</span></strong><span class="koboSpan" id="kobo.240.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.241.1">EDR</span></strong><span class="koboSpan" id="kobo.242.1">) tools, IDSs </span><a id="_idIndexMarker213"/><span class="koboSpan" id="kobo.243.1">and </span><strong class="bold"><span class="koboSpan" id="kobo.244.1">Intrusion Prevention Systems</span></strong><span class="koboSpan" id="kobo.245.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.246.1">IPSs</span></strong><span class="koboSpan" id="kobo.247.1">), and </span><strong class="bold"><span class="koboSpan" id="kobo.248.1">Vulnerability Management Systems</span></strong><span class="koboSpan" id="kobo.249.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.250.1">VMSs</span></strong><span class="koboSpan" id="kobo.251.1">), into </span><a id="_idIndexMarker214"/><span class="koboSpan" id="kobo.252.1">a single source. </span><span class="koboSpan" id="kobo.252.2">From here, priorities for these alerts can be assigned to the SOC and CSIRT to ensure the most critical alerts are addressed first.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.253.1">Automation</span></strong><span class="koboSpan" id="kobo.254.1">: SOAR platforms have the capability to execute low-level tasks that are </span><a id="_idIndexMarker215"/><span class="koboSpan" id="kobo.255.1">often executed by CSIRT or SOC personnel. </span><span class="koboSpan" id="kobo.255.2">In the previous example, the SOAR platform was configured to isolate the endpoint upon detection of the malware and then notify the CSIRT. </span><span class="koboSpan" id="kobo.255.3">Other actions include blocking file hashes and cutting off network connections.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.256.1">Collaboration</span></strong><span class="koboSpan" id="kobo.257.1">: The ability of the SOAR to aggregate alerts along with other incident </span><a id="_idIndexMarker216"/><span class="koboSpan" id="kobo.258.1">data provides SOC and CSIRT personnel with the perfect platform to collaborate. </span><span class="koboSpan" id="kobo.258.2">Incidents can be investigated and documented in a central location, with actions being directed and communicated properly. </span><span class="koboSpan" id="kobo.258.3">Furthermore, everyone involved in an incident has visibility into other team members’ actions so that potential conflict can be avoided.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.259.1">Threat intelligence enrichment</span></strong><span class="koboSpan" id="kobo.260.1">: There is a range of external and internal threat </span><a id="_idIndexMarker217"/><span class="koboSpan" id="kobo.261.1">intelligence sources that provide additional context around IOCs. </span><span class="koboSpan" id="kobo.261.2">A SOAR can be used to enrich a detection and provide context to the indicators. </span><span class="koboSpan" id="kobo.261.3">For example, an IP address detected by an IPS can be pulled into the SOAR, which indicates that the IP address is associated with the post-exploitation tool Cobalt Strike, enriching threat intelligence, providing additional information to the CSIRT, and alerting them to a potentially severe intrusion.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.262.1">Reporting</span></strong><span class="koboSpan" id="kobo.263.1">: SOAR platforms are also an excellent way to manage all the data across </span><a id="_idIndexMarker218"/><span class="koboSpan" id="kobo.264.1">multiple incidents and provide extensive reporting on incidents and performance metrics. </span><span class="koboSpan" id="kobo.264.2">They will often have the ability to tailor the reporting to various audiences, including analysts, managers, and directors.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.265.1">It is important to remember that the SOAR is not a replacement for a professional security analyst. </span><span class="koboSpan" id="kobo.265.2">Rather, SOC and CSIRT personnel should view the toolset as an augmentation that allows them to conduct investigations and respond at scale. </span><span class="koboSpan" id="kobo.265.3">It is nearly impossible to have complete visibility into even a modest-sized enterprise network. </span><span class="koboSpan" id="kobo.265.4">SOAR platforms perform much of the low-level activity so that CSIRT and SOC personnel can focus on the more high-level incident investigation and response activities.</span></p>
<h1 id="_idParaDest-38"><a id="_idTextAnchor037"/><span class="koboSpan" id="kobo.266.1">Incorporating crisis communications</span></h1>
<p><span class="koboSpan" id="kobo.267.1">The notion that serious security incidents can be kept secret has long passed. </span><span class="koboSpan" id="kobo.267.2">High-profile </span><a id="_idIndexMarker219"/><span class="koboSpan" id="kobo.268.1">security incidents, such as those that impacted Target and TJX, have been made very public. </span><span class="koboSpan" id="kobo.268.2">Adding to this lack of secrecy are the new </span><a id="_idIndexMarker220"/><span class="koboSpan" id="kobo.269.1">breach notification laws that impact organizations across the globe. </span><span class="koboSpan" id="kobo.269.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.270.1">General Data Protection Regulation</span></strong><span class="koboSpan" id="kobo.271.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.272.1">GDPR</span></strong><span class="koboSpan" id="kobo.273.1">) Article 33 has a 72-hour breach notification requirement. </span></p>
<p><span class="koboSpan" id="kobo.274.1">Other regulatory or compliance </span><a id="_idIndexMarker221"/><span class="koboSpan" id="kobo.275.1">frameworks, such as the </span><strong class="bold"><span class="koboSpan" id="kobo.276.1">Health Insurance Portability and Accountability Act</span></strong><span class="koboSpan" id="kobo.277.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.278.1">HIPAA</span></strong><span class="koboSpan" id="kobo.279.1">) Rule 45 CFR, § § 164.400-414, stipulate that notifications are to be made in the event of a data breach. </span><span class="koboSpan" id="kobo.279.2">Compounding legal and regulatory communication pressures need to be communicated to internal business units and external stakeholders. </span><span class="koboSpan" id="kobo.279.3">While it may seem that crafting and deploying a communications plan during an incident is a waste of </span><a id="_idIndexMarker222"/><span class="koboSpan" id="kobo.280.1">resources, it has become a necessity in today’s legal and regulatory environment. </span><span class="koboSpan" id="kobo.280.2">When examining crisis communications, the three following focus areas need to be addressed:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.281.1">Internal communications </span></li>
<li><span class="koboSpan" id="kobo.282.1">External communications </span></li>
<li><span class="koboSpan" id="kobo.283.1">Public notification</span></li>
</ul>
<p><span class="koboSpan" id="kobo.284.1">Each of these represents a specific audience and each requires different content and tone of messaging.</span></p>
<h2 id="_idParaDest-39"><a id="_idTextAnchor038"/><span class="koboSpan" id="kobo.285.1">Internal communications</span></h2>
<p><span class="koboSpan" id="kobo.286.1">Internal communications are the kinds of communications that are limited to the business </span><a id="_idIndexMarker223"/><span class="koboSpan" id="kobo.287.1">or organization’s internal personnel and reporting structure. </span><span class="koboSpan" id="kobo.287.2">Several business units need to be part of communications. </span><span class="koboSpan" id="kobo.287.3">The legal department will need to be kept abreast of the incident, as they will often </span><a id="_idIndexMarker224"/><span class="koboSpan" id="kobo.288.1">have to determine reporting requirements and any additional regulatory requirements. </span><span class="koboSpan" id="kobo.288.2">Marketing and communications can be leveraged for crafting communications to external parties. </span><span class="koboSpan" id="kobo.288.3">This can best be facilitated by including them as early as possible in the process so that they have a full understanding of the incident and its impact. </span><span class="koboSpan" id="kobo.288.4">If the incident impacts any internal employees, Human Resources should also be included as part of internal communications.</span></p>
<p><span class="koboSpan" id="kobo.289.1">One of the critical groups that are going to want to be informed as the incident unfolds is the C-suite and, more specifically, the CEO. </span><span class="koboSpan" id="kobo.289.2">A CSIRT will often fly well below the line of sight of senior leadership until there is a critical incident. </span><span class="koboSpan" id="kobo.289.3">At that point, the CEO will become very interested in the workings of the CSIRT and how they are addressing the incident.</span></p>
<p><span class="koboSpan" id="kobo.290.1">With all of these parties needing to be kept in the loop, it is critical to ensure orderly communications and limit misinformation. </span><span class="koboSpan" id="kobo.290.2">To limit confusion, the IC or CSIRT lead should serve as a single point of contact. </span><span class="koboSpan" id="kobo.290.3">This way, for example, the legal department does not contact a CSIRT analyst to receive information about an investigation that is, at that time, speculative. </span><span class="koboSpan" id="kobo.290.4">Relying on this type of information can lead to serious legal consequences. </span><span class="koboSpan" id="kobo.290.5">To keep everyone informed, the CSIRT lead or IC should conduct periodic updates throughout each day of the incident. </span><span class="koboSpan" id="kobo.290.6">The cadence of these communications is dependent on the incident type and severity, but having a cadence of every 4 hours, with a conference call during the working hours of 6 a.m. </span><span class="koboSpan" id="kobo.290.7">to 10 p.m., will ensure that everyone is kept up to date.</span></p>
<p><span class="koboSpan" id="kobo.291.1">In addition </span><a id="_idIndexMarker225"/><span class="koboSpan" id="kobo.292.1">to a regular conference call, the CSIRT lead or the IC should prepare a daily status report to be sent to senior leadership. </span><span class="koboSpan" id="kobo.292.2">This daily status report </span><a id="_idIndexMarker226"/><span class="koboSpan" id="kobo.293.1">does not have to be as comprehensive and detailed as a digital forensics report but should capture significant actions taken, any incident-related data that has been obtained, and any potential factors that may limit the ability of the CSIRT to function. </span><span class="koboSpan" id="kobo.293.2">At a minimum, a daily status meeting, in conjunction with this report, should be conducted with senior leadership and any other personnel that is required to be in attendance over the course of the incident.</span></p>
<h2 id="_idParaDest-40"><a id="_idTextAnchor039"/><span class="koboSpan" id="kobo.294.1">External communications</span></h2>
<p><span class="koboSpan" id="kobo.295.1">Incidents may have a downstream impact on other external entities outside of the organization </span><a id="_idIndexMarker227"/><span class="koboSpan" id="kobo.296.1">that is suffering the incident. </span><span class="koboSpan" id="kobo.296.2">Some </span><a id="_idIndexMarker228"/><span class="koboSpan" id="kobo.297.1">of these external entities may include suppliers, customers, transaction processing facilities, or service providers. </span><span class="koboSpan" id="kobo.297.2">If any of these organizations </span><a id="_idIndexMarker229"/><span class="koboSpan" id="kobo.298.1">have a direct link—such as a </span><strong class="bold"><span class="koboSpan" id="kobo.299.1">Virtual Private Network</span></strong><span class="koboSpan" id="kobo.300.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.301.1">VPN</span></strong><span class="koboSpan" id="kobo.302.1">)—to the impacted organization, external partners need to be informed sooner rather than later. </span><span class="koboSpan" id="kobo.302.2">This is to limit any possibility that an attacker has leveraged this connection to compromise other organizations.</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.303.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.304.1">A significant </span><a id="_idIndexMarker230"/><span class="koboSpan" id="kobo.305.1">area of concern when addressing incident management and external communications for </span><strong class="bold"><span class="koboSpan" id="kobo.306.1">Managed Service Providers</span></strong><span class="koboSpan" id="kobo.307.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.308.1">MSPs</span></strong><span class="koboSpan" id="kobo.309.1">) is the trend of attackers targeting MSPs first, with the intent of using them as a jumping-off point into other organizations through established VPNs.</span></p>
<p class="callout"><span class="koboSpan" id="kobo.310.1">One perfect example of this is the Target breach, where attackers compromised a </span><strong class="bold"><span class="koboSpan" id="kobo.311.1">Heating, Ventilation, and Air Conditioning</span></strong><span class="koboSpan" id="kobo.312.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.313.1">HVAC</span></strong><span class="koboSpan" id="kobo.314.1">) vendor as the initial point of entry. </span><span class="koboSpan" id="kobo.314.2">Attackers </span><a id="_idIndexMarker231"/><span class="koboSpan" id="kobo.315.1">are using this tried-and-true method of attacking MSPs using ransomware, now with the intent of compromising more than one organization per attack.</span></p>
<p><span class="koboSpan" id="kobo.316.1">At a minimum, an organization should inform external parties that they are dealing with an incident </span><a id="_idIndexMarker232"/><span class="koboSpan" id="kobo.317.1">and, as a precaution, the connection </span><a id="_idIndexMarker233"/><span class="koboSpan" id="kobo.318.1">will be blocked until the incident has been addressed. </span><span class="koboSpan" id="kobo.318.2">This can then be followed up with additional information. </span><span class="koboSpan" id="kobo.318.3">Much like internal communications, setting a regular cadence may go a long way in smoothing out any damage to a working relationship as a result of an incident. </span><span class="koboSpan" id="kobo.318.4">In some cases, well-trusted external parties may be made part of regular daily status updates.</span></p>
<h2 id="_idParaDest-41"><a id="_idTextAnchor040"/><span class="koboSpan" id="kobo.319.1">Public notification</span></h2>
<p><span class="koboSpan" id="kobo.320.1">As discussed previously, there are several legal and compliance requirements that need to be taken </span><a id="_idIndexMarker234"/><span class="koboSpan" id="kobo.321.1">into consideration when discussing the notification of customers or the general public about an incident. </span><span class="koboSpan" id="kobo.321.2">Organizations </span><a id="_idIndexMarker235"/><span class="koboSpan" id="kobo.322.1">may have to walk a fine line in terms of complying with the requirements of regulations such as HIPAA, without disclosing operational details of an incident still under investigation. </span><span class="koboSpan" id="kobo.322.2">Compounding this pressure are the possible implications on stock value or the potential for lost business. </span><span class="koboSpan" id="kobo.322.3">With all these pressures, it is critical to craft a message that is within the legal or compliance requirements but that also limits the damage to the organization’s reputation, revenue, or stock value.</span></p>
<p><span class="koboSpan" id="kobo.323.1">Despite being directly related to the incident at hand, the CSIRT should not be responsible for crafting a public notification statement. </span><span class="koboSpan" id="kobo.323.2">Rather, the CSIRT should be available to provide insight into the incident investigation and answer any questions. </span><span class="koboSpan" id="kobo.323.3">The two best business units that should be involved in crafting a message are the legal and marketing departments. </span><span class="koboSpan" id="kobo.323.4">The marketing department would be tasked with crafting a message to limit the potential backlash from customers. </span><span class="koboSpan" id="kobo.323.5">The legal department would be tasked with crafting a message that meets legal or regulatory requirements. </span><span class="koboSpan" id="kobo.323.6">The CSIRT should advise as far as possible but these two business units should serve as the point of contact for any media or public questions.</span></p>
<h1 id="_idParaDest-42"><a id="_idTextAnchor041"/><span class="koboSpan" id="kobo.324.1">Incorporating containment strategies</span></h1>
<p><span class="koboSpan" id="kobo.325.1">Containment strategies are the actions taken during an incident to limit damage to specific systems or areas of the network. </span><span class="koboSpan" id="kobo.325.2">It is critical for organizations to have prepared these in the </span><a id="_idIndexMarker236"/><span class="koboSpan" id="kobo.326.1">event of an incident. </span><span class="koboSpan" id="kobo.326.2">The rise of ransomware that combines elements of viruses and worms that can quickly spread through an organization highlights the need to rapidly contain an outbreak before it impacts too many systems. </span><span class="koboSpan" id="kobo.326.3">What compounds the challenge of containment is that many enterprise IT systems utilize a </span><em class="italic"><span class="koboSpan" id="kobo.327.1">flat</span></em><span class="koboSpan" id="kobo.328.1"> topology, whereby the bulk of systems can communicate with each other. </span><span class="koboSpan" id="kobo.328.2">In this type of environment, ransomware and other worms can </span><a id="_idIndexMarker237"/><span class="koboSpan" id="kobo.329.1">quickly propagate via legitimate protocols, such as </span><strong class="bold"><span class="koboSpan" id="kobo.330.1">Remote Desktop Services</span></strong><span class="koboSpan" id="kobo.331.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.332.1">RDS</span></strong><span class="koboSpan" id="kobo.333.1">) or through the </span><strong class="bold"><span class="koboSpan" id="kobo.334.1">Server Message Block</span></strong><span class="koboSpan" id="kobo.335.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.336.1">SMB</span></strong><span class="koboSpan" id="kobo.337.1">), which were popular during the WannaCry ransomware campaign, which </span><a id="_idIndexMarker238"/><span class="koboSpan" id="kobo.338.1">leveraged the EternalBlue vulnerability in the Windows OS SMB installation. </span><span class="koboSpan" id="kobo.338.2">For more information, visit </span><strong class="source-inline"><span class="koboSpan" id="kobo.339.1">https://cve.mitre.org/cgi- bin/cvename.cgi?name=CVE-2017-0144</span></strong><span class="koboSpan" id="kobo.340.1">.</span></p>
<p><span class="koboSpan" id="kobo.341.1">In order to address containment, an organization should have a clear idea of the network topology. </span><span class="koboSpan" id="kobo.341.2">This type of network awareness can be achieved through outputs of network discovery tools, up-to-date network diagrams, system inventories, and vulnerability scans. </span><span class="koboSpan" id="kobo.341.3">This data should be shared with the CSIRT so that an overall view of the network can be achieved. </span><span class="koboSpan" id="kobo.341.4">From here, the CSIRT should coordinate containment plans with network operations personnel so that an overall containment strategy can be crafted, and the potential damage of an incident limited. </span><span class="koboSpan" id="kobo.341.5">Having network operations personnel as part of the technical support personnel goes a long way in ensuring this process is streamlined and containment is achieved as quickly as possible.</span></p>
<p><span class="koboSpan" id="kobo.342.1">One other aspect of how infrastructure is managed that has a direct impact on incident management is that of change management. </span><span class="koboSpan" id="kobo.342.2">Mature IT infrastructures usually have a well-documented and governed change management process in place. </span><span class="koboSpan" id="kobo.342.3">During an incident, however, the CSIRT and support personnel cannot wait for change management authorization and a proper change window to implement changes. </span><span class="koboSpan" id="kobo.342.4">When exercising containment strategies, IT and organizational leadership should fully understand that changes are going to be made based on the incident. </span><span class="koboSpan" id="kobo.342.5">This does not absolve the CSIRT and IT personnel from exercising due care and ensuring that changes are well documented.</span></p>
<p><span class="koboSpan" id="kobo.343.1">In terms of containing a malware outbreak such as a ransomware attack, there are several strategies that can be employed. </span><span class="koboSpan" id="kobo.343.2">Ideally, organizations should have some ability to isolate </span><a id="_idIndexMarker239"/><span class="koboSpan" id="kobo.344.1">segments of the network from each other, but in the event that this is not possible, CSIRT and IT personnel can take one or more of the following measures:</span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.345.1">Physical containment</span></strong><span class="koboSpan" id="kobo.346.1">: In this case, the physical connection to the network is removed </span><a id="_idIndexMarker240"/><span class="koboSpan" id="kobo.347.1">from the system. </span><span class="koboSpan" id="kobo.347.2">This can be as simple as unplugging the network cable, disabling wireless access, or disabling the connection through the operating system. </span><span class="koboSpan" id="kobo.347.3">While this sounds simple, there are </span><a id="_idIndexMarker241"/><span class="koboSpan" id="kobo.348.1">several factors that can make this strategy challenging for even the smallest organization. </span><span class="koboSpan" id="kobo.348.2">The first is the ability to physically locate the systems impacted. </span><span class="koboSpan" id="kobo.348.3">This may be a simpler task inside a data center where the impacted systems are in the same rack, but attempting to physically locate 20 to 30 desktops in a fairly corporate environment takes a great deal of effort. </span><span class="koboSpan" id="kobo.348.4">In the time that it would take to remove 20 systems from the network, the malware could have easily spread across to other systems. </span><span class="koboSpan" id="kobo.348.5">Further compounding the difficulty of physical containment is the challenge of addressing geographically diverse systems. </span><span class="koboSpan" id="kobo.348.6">Having a data center or other operating site an hour’s drive away would necessitate having an individual on that site to perform the physical containment. </span><span class="koboSpan" id="kobo.348.7">As you can imagine, physically containing a malware outbreak or another incident can be very difficult if the scope of the incident is beyond the capability of the CSIRT. </span><span class="koboSpan" id="kobo.348.8">Physical containment should be reserved for those incidents where the scope is limited and the CSIRT personnel can immediately remove the systems from the network.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.349.1">Network containment</span></strong><span class="koboSpan" id="kobo.350.1">: A network containment strategy relies heavily on the expertise </span><a id="_idIndexMarker242"/><span class="koboSpan" id="kobo.351.1">of network engineers or architects. </span><span class="koboSpan" id="kobo.351.2">It is for this reason </span><a id="_idIndexMarker243"/><span class="koboSpan" id="kobo.352.1">that they are often included as part of the technical support personnel within the CSIRT and should be involved in any containment strategy planning. </span><span class="koboSpan" id="kobo.352.2">With this containment strategy, the network administrator(s) will be tasked with modifying switch configurations to limit the traffic from infected systems on a subnet to other portions of the network. </span><span class="koboSpan" id="kobo.352.3">This containment strategy may require modification of configurations on individual switches or using the management console. </span><span class="koboSpan" id="kobo.352.4">One aspect of this approach that needs to be addressed is how the organization handles change control. </span><span class="koboSpan" id="kobo.352.5">In many organizations, it is common practice to review any switch configuration changes as part of the normal change </span><a id="_idIndexMarker244"/><span class="koboSpan" id="kobo.353.1">control process. </span><span class="koboSpan" id="kobo.353.2">There needs </span><a id="_idIndexMarker245"/><span class="koboSpan" id="kobo.354.1">to be an exception written into that process to facilitate the rapid deployment of switch configuration changes during a declared incident. </span><span class="koboSpan" id="kobo.354.2">Network administrators should also ensure that any changes that are made are properly documented so that they can be reversed or otherwise modified during the recovery phase of an incident.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.355.1">Perimeter containment</span></strong><span class="koboSpan" id="kobo.356.1">: The perimeter firewall is an asset well suited for containment. </span><span class="koboSpan" id="kobo.356.2">In some circumstances, the perimeter firewall can be utilized in conjunction </span><a id="_idIndexMarker246"/><span class="koboSpan" id="kobo.357.1">with network containment in a Russian nesting-doll approach, where the CSIRT contains </span><a id="_idIndexMarker247"/><span class="koboSpan" id="kobo.358.1">network traffic at the perimeter and works its way to the specific subnets containing the impacted systems. </span><span class="koboSpan" id="kobo.358.2">For example, malware will often download additional code or other packages via tools such as PowerShell. </span><span class="koboSpan" id="kobo.358.3">In the event that the CSIRT has identified the external IP address that is utilized by the malware to download additional packages, it can be blocked at the firewall, thereby preventing additional damage. </span><span class="koboSpan" id="kobo.358.4">From here, the CSIRT can then work backward from the perimeter to the impacted systems. </span><span class="koboSpan" id="kobo.358.5">The organization can then leave the rule in place until such time that it is deemed no longer necessary. </span><span class="koboSpan" id="kobo.358.6">As with network containment, it is important to address any change control issues that may arise from making changes to the firewall ruleset.</span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.359.1">Virtual containment</span></strong><span class="koboSpan" id="kobo.360.1">: With the advent of cloud computing and virtualization, many </span><a id="_idIndexMarker248"/><span class="koboSpan" id="kobo.361.1">organizations have at least partially </span><a id="_idIndexMarker249"/><span class="koboSpan" id="kobo.362.1">moved systems such as servers from physical systems to virtualized systems. </span><span class="koboSpan" id="kobo.362.2">Virtualization provides a great deal of flexibility to organizations during normal operations but is also advantageous in the event that an incident may need to be contained. </span><span class="koboSpan" id="kobo.362.3">First, hypervisor software such as VMware’s ESXi platform can be utilized to remove the network connection from multiple systems at once. </span><span class="koboSpan" id="kobo.362.4">Organizations may also make use of virtual switching in much the same way as physical switches in terms of containment. </span><span class="koboSpan" id="kobo.362.5">Finally, virtualization software allows for the pausing of systems during </span><a id="_idIndexMarker250"/><span class="koboSpan" id="kobo.363.1">an incident. </span><span class="koboSpan" id="kobo.363.2">This is the preferred method, as suspending </span><a id="_idIndexMarker251"/><span class="koboSpan" id="kobo.364.1">or pausing a virtual machine during an incident preserves a good deal of evidence that can be examined later.</span></li>
</ul>
<p><span class="koboSpan" id="kobo.365.1">Once an incident is properly contained, the CSIRT and other personnel have some time to organize and begin the process of investigating the incident. </span><span class="koboSpan" id="kobo.365.2">They are also well situated to begin the process of removing the intruder and their tools from the network.</span></p>
<h1 id="_idParaDest-43"><a id="_idTextAnchor042"/><span class="koboSpan" id="kobo.366.1">Getting back to normal – eradication, recovery, and post-incident activity</span></h1>
<p><span class="koboSpan" id="kobo.367.1">Once an incident </span><a id="_idIndexMarker252"/><span class="koboSpan" id="kobo.368.1">has been properly and comprehensively investigated, it is time to move into the eradication and recovery phase. </span><span class="koboSpan" id="kobo.368.2">There may be a good deal </span><a id="_idIndexMarker253"/><span class="koboSpan" id="kobo.369.1">of haste in getting to this stage, as there is a strong desire to return to normal operations. </span><span class="koboSpan" id="kobo.369.2">While there may be business drivers at play here, rushing eradication </span><a id="_idIndexMarker254"/><span class="koboSpan" id="kobo.370.1">and recovery may reintroduce an unidentified compromised system that has been overlooked. </span><span class="koboSpan" id="kobo.370.2">In other scenarios, it could be possible to miss the patching of previously compromised systems, leaving them open to the same exploits that previously compromised them or, worse, placing a still-infected system back on the network. </span><span class="koboSpan" id="kobo.370.3">For this reason, we will thoroughly address both eradication and recovery strategies.</span></p>
<h3><span class="koboSpan" id="kobo.371.1">Eradication strategies</span></h3>
<p><span class="koboSpan" id="kobo.372.1">The unfortunate </span><a id="_idIndexMarker255"/><span class="koboSpan" id="kobo.373.1">reality with modern malware is that there is no surefire way to ensure that all malicious code has been removed. </span><span class="koboSpan" id="kobo.373.2">In the past, organizations could simply scan the system with an antivirus program to trace the offending malicious code. </span><span class="koboSpan" id="kobo.373.3">Now, with malware techniques such as process injection or DLL hijacking, even if the original code is removed, there is still a chance that the system is still infected. </span><span class="koboSpan" id="kobo.373.4">There is also the possibility that additional code that has been downloaded is also installed and will go undetected. </span><span class="koboSpan" id="kobo.373.5">As a result, most eradication strategies rely on taking infected machines and reimaging them with a known good image or reverting to a known good backup.</span></p>
<p><span class="koboSpan" id="kobo.374.1">A strategy that is often employed in the cases of malware and ransomware is to make use of three </span><a id="_idIndexMarker256"/><span class="koboSpan" id="kobo.375.1">separate </span><strong class="bold"><span class="koboSpan" id="kobo.376.1">Virtual LAN</span></strong><span class="koboSpan" id="kobo.377.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.378.1">VLAN</span></strong><span class="koboSpan" id="kobo.379.1">) segments and reimage the infected machines. </span><span class="koboSpan" id="kobo.379.2">First, all the infected machines are placed onto their own separate VLAN. </span><span class="koboSpan" id="kobo.379.3">From here, the CSIRT or system administrator will move one of the infected systems onto a secondary staging VLAN. </span><span class="koboSpan" id="kobo.379.4">The system is then reimaged with a known good image, or a known good backup is utilized. </span><span class="koboSpan" id="kobo.379.5">From here, once the system has been reimaged </span><a id="_idIndexMarker257"/><span class="koboSpan" id="kobo.380.1">or has the backup installed, it is then moved to a production VLAN, where additional monitoring is conducted to ensure that there is no remaining infection or compromise. </span><span class="koboSpan" id="kobo.380.2">The following diagram shows a simple network structure that facilitates this recovery strategy:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer014">
<span class="koboSpan" id="kobo.381.1"><img alt="" src="image/B18571_02_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.382.1">Figure 2.5 – A system’s eradication and recovery architecture</span></p>
<p><span class="koboSpan" id="kobo.383.1">While this method may be time-consuming, it is an excellent way to ensure that all systems that have been impacted have been addressed.</span></p>
<p><span class="koboSpan" id="kobo.384.1">In the case of virtual systems, if the containment strategy previously discussed has been employed, the infected virtual systems will have no network connectivity. </span><span class="koboSpan" id="kobo.384.2">From here, the most straightforward </span><a id="_idIndexMarker258"/><span class="koboSpan" id="kobo.385.1">eradication strategy is to revert systems to the last-known good snapshot. </span><span class="koboSpan" id="kobo.385.2">Once the system has been restarted, it should be connected to the VLAN with enhanced monitoring. </span><span class="koboSpan" id="kobo.385.3">It is important that in the case of reverting to snapshots, the CSIRT has a great deal of confidence in the timeline. </span><span class="koboSpan" id="kobo.385.4">If the CSIRT is unsure about the timeline of an attack, there is a possibility that the snapshot may be compromised as well. </span><span class="koboSpan" id="kobo.385.5">This is especially true in organizations that conduct snapshots regularly.</span></p>
<h3><span class="koboSpan" id="kobo.386.1">Recovery strategies</span></h3>
<p><span class="koboSpan" id="kobo.387.1">In terms of recovery, there are several tasks that the CSIRT will need to manage to bring operations back to normal. </span><span class="koboSpan" id="kobo.387.2">The first of these is to ensure that all systems—not just those that have </span><a id="_idIndexMarker259"/><span class="koboSpan" id="kobo.388.1">been through the eradication phase but all systems—are properly patched with the most up-to-date patches. </span><span class="koboSpan" id="kobo.388.2">This is critical in instances where the attacker has taken advantage of a zero-day exploit or a relatively new vulnerability. </span><span class="koboSpan" id="kobo.388.3">In cases where a patch is not forthcoming from the manufacturer, the CSIRT should recommend additional security controls to mitigate any residual risk.</span></p>
<p><span class="koboSpan" id="kobo.389.1">A second piece of the recovery phase is for the CSIRT to work with IT and information security personnel in crafting additional detection and prevention alerts. </span><span class="koboSpan" id="kobo.389.2">During the examination of the evidence when determining the root cause, or in the containment phase, the CSIRT may have provided data for detection and prevention controls. </span><span class="koboSpan" id="kobo.389.3">The CSIRT should work with other personnel to augment those with additional detective and preventive rules. </span><span class="koboSpan" id="kobo.389.4">These additional rules may be specific to the incident or may pertain to the specific vulnerabilities identified.</span></p>
<p><span class="koboSpan" id="kobo.390.1">Third, any changes that were made to the infrastructure should be reviewed. </span><span class="koboSpan" id="kobo.390.2">These changes can be initially reviewed by the CSIRT and IT personnel to determine whether they are still required or can be removed. </span><span class="koboSpan" id="kobo.390.3">If changes are required in the long term, they should be evaluated by the organization’s change control, and approved according to the change control process.</span></p>
<p><span class="koboSpan" id="kobo.391.1">Fourth, before the incident can be closed out, it is good practice to conduct a full vulnerability scan of all systems. </span><span class="koboSpan" id="kobo.391.2">This is critical to ensure that any systems that have been compromised have been addressed. </span><span class="koboSpan" id="kobo.391.3">Additionally, this step will also address any other systems that may not have been impacted by the security incident, ensuring that they are nonetheless patched for any security vulnerabilities.</span></p>
<p><span class="koboSpan" id="kobo.392.1">Finally, at the </span><a id="_idIndexMarker260"/><span class="koboSpan" id="kobo.393.1">end of an incident, it is important to conduct an </span><strong class="bold"><span class="koboSpan" id="kobo.394.1">After-Action Review</span></strong><span class="koboSpan" id="kobo.395.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.396.1">AAR</span></strong><span class="koboSpan" id="kobo.397.1">). </span><span class="koboSpan" id="kobo.397.2">This review goes over the entire incident from start to finish. </span><span class="koboSpan" id="kobo.397.3">All actions taken by the CSIRT personnel are reviewed. </span><span class="koboSpan" id="kobo.397.4">In addition, the plans and playbooks </span><a id="_idIndexMarker261"/><span class="koboSpan" id="kobo.398.1">that were utilized are also reviewed in light of the incident actions. </span><span class="koboSpan" id="kobo.398.2">Any deficiencies, such as a lack of specific tools, training, or processes, should be brought up so that they may be corrected. </span><span class="koboSpan" id="kobo.398.3">The output of this AAR should be documented as part of the overall incident documentation.</span></p>
<h3><span class="koboSpan" id="kobo.399.1">Post-incident activity</span></h3>
<p><span class="koboSpan" id="kobo.400.1">There are often many lessons that can be gleaned from an incident investigation and the activity associated </span><a id="_idIndexMarker262"/><span class="koboSpan" id="kobo.401.1">with the incident response. </span><span class="koboSpan" id="kobo.401.2">These hard-won lessons should be captured as soon as the organization has returned to normal operations. </span><span class="koboSpan" id="kobo.401.3">The best way to address this is through an AAR. </span><span class="koboSpan" id="kobo.401.4">All individuals that were involved in the incident should be brought together, either virtually or, if possible, together in the same location. </span><span class="koboSpan" id="kobo.401.5">Usually, the IC serves as the lead in this effort, with another individual who functions as the scribe to capture all the pertinent details.</span></p>
<p><span class="koboSpan" id="kobo.402.1">Overall, an AAR of the incident should examine not only what went right during the incident but also what went wrong and therefore needs improvement. </span><span class="koboSpan" id="kobo.402.2">The following is a list of sample questions that can be asked as part of the AAR:</span></p>
<ul>
<li><span class="koboSpan" id="kobo.403.1">How was the incident detected and was this detection made in a timely manner?</span></li>
<li><span class="koboSpan" id="kobo.404.1">What was the initial severity indicated?</span></li>
<li><span class="koboSpan" id="kobo.405.1">Were the escalation procedures sufficient to capture the needed information?</span></li>
<li><span class="koboSpan" id="kobo.406.1">What containment strategies were implemented? </span><span class="koboSpan" id="kobo.406.2">How effective were they?</span></li>
<li><span class="koboSpan" id="kobo.407.1">Was there sufficient evidence/time to determine the root cause of the incident?</span></li>
<li><span class="koboSpan" id="kobo.408.1">Were communications between CSIRT elements clear, concise, and timely?</span></li>
</ul>
<p><span class="koboSpan" id="kobo.409.1">This list should serve as a starting point for the overall AAR. </span><span class="koboSpan" id="kobo.409.2">Depending on the severity and length of the incident, the AAR may take anywhere from minutes to a few hours to address all salient </span><a id="_idIndexMarker263"/><span class="koboSpan" id="kobo.410.1">points and identify gaps in the organization’s capability. </span><span class="koboSpan" id="kobo.410.2">The goal here is to capture this information and integrate it into the improvement of CSIRT policies and procedures.</span></p>
<h1 id="_idParaDest-44"><a id="_idTextAnchor043"/><span class="koboSpan" id="kobo.411.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.412.1">Planning for an incident is critical. </span><span class="koboSpan" id="kobo.412.2">Equally critical is the proper management of an incident. </span><span class="koboSpan" id="kobo.412.3">This involves several elements that each CSIRT must address during the life of an incident.</span></p>
<p><span class="koboSpan" id="kobo.413.1">Proper logistics provide the necessary elements for the CSIRT to function. </span><span class="koboSpan" id="kobo.413.2">Having strategies to communicate incident information to leadership, third parties, and customers keeps these stakeholders informed, lessens speculation, and ensures that compliance requirements are met. </span><span class="koboSpan" id="kobo.413.3">Incident investigation allows the CSIRT to properly identify the attack and the scope and limit damage via a proper containment strategy. </span><span class="koboSpan" id="kobo.413.4">Finally, these elements are all part of eradicating an adversary’s ability to access a network and helping an organization to return to normal. </span><span class="koboSpan" id="kobo.413.5">As we stated at the beginning of this book, everyone has a plan until they get hit in the face. </span><span class="koboSpan" id="kobo.413.6">The real value of a CSIRT to an organization is not in the plans and playbooks, but in how well they perform when an incident occurs.</span></p>
<p><span class="koboSpan" id="kobo.414.1">The next chapter will expand on the incident investigation portion of incident management by providing the digital forensics framework to which CSIRT personnel adhere.</span></p>
<h1 id="_idParaDest-45"><a id="_idTextAnchor044"/><span class="koboSpan" id="kobo.415.1">Questions</span></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.416.1">Which of the following containment strategies is the most difficult to perform?</span><ol><li><span class="koboSpan" id="kobo.417.1">Physical</span></li><li><span class="koboSpan" id="kobo.418.1">Network</span></li><li><span class="koboSpan" id="kobo.419.1">Perimeter</span></li><li><span class="koboSpan" id="kobo.420.1">Virtual</span></li></ol></li>
<li><span class="koboSpan" id="kobo.421.1">A cyber security breach can have an impact on which of the following?</span><ol><li><span class="koboSpan" id="kobo.422.1">Confidentiality</span></li><li><span class="koboSpan" id="kobo.423.1">Integrity</span></li><li><span class="koboSpan" id="kobo.424.1">Availability</span></li><li><span class="koboSpan" id="kobo.425.1">All of the above</span></li></ol></li>
<li><span class="koboSpan" id="kobo.426.1">Attribution is critical and has to be completed for a successful incident investigation.</span><ol><li><span class="koboSpan" id="kobo.427.1">True</span></li><li><span class="koboSpan" id="kobo.428.1">False</span></li></ol></li>
</ol>
<h1 id="_idParaDest-46"><a id="_idTextAnchor045"/><span class="koboSpan" id="kobo.429.1">Further reading</span></h1>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.430.1">NIST SP 800-61 Rev 2, Computer Security Incident Handling Guide</span></em><span class="koboSpan" id="kobo.431.1">, at </span><a href="https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final"><span class="koboSpan" id="kobo.432.1">https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final</span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.433.1">ENISA Incident Handling in Live Role Playing Handbook</span></em><span class="koboSpan" id="kobo.434.1">, at </span><strong class="source-inline"><span class="koboSpan" id="kobo.435.1">https://www.enisa. </span><span class="koboSpan" id="kobo.435.2">europa.eu/topics/trainings-for-cybersecurity-specialists/online-training-material/documents/incident-handling-in-live-role-playing-handbook/view</span></strong></li>
<li><em class="italic"><span class="koboSpan" id="kobo.436.1">Incident Handler’s Handbook</span></em><span class="koboSpan" id="kobo.437.1"> by Patrick Kral, SANS Reading Room, at </span><a href="https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901"><span class="koboSpan" id="kobo.438.1">https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901</span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.439.1">MITRE Ten Strategies of a World-Class Cybersecurity Operations Center</span></em><span class="koboSpan" id="kobo.440.1">, at </span><a href="https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf"><span class="koboSpan" id="kobo.441.1">https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf</span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.442.1">Security Orchestration Automation and Response (SOAR)</span></em> <a href="https://www.inquisitllc.com/wp-content/uploads/2020/05/White-Paper-Security-Orchestration-Automation-and-Response.pdf"><span class="koboSpan" id="kobo.443.1">https://www.inquisitllc.com/wp-content/uploads/2020/05/White-Paper-Security-Orchestration-Automation-and-Response.pdf</span></a></li>
</ul>
</div>
</body></html>