<html><head></head><body><div class="chapter" title="Chapter&#xA0;3.&#xA0;Evidence Acquisition from iDevices"><div class="titlepage"><div><div><h1 class="title"><a id="ch03"/>Chapter 3. Evidence Acquisition from iDevices</h1></div></div></div><p>The purpose of this chapter is to introduce techniques and tools used for the acquisition of data from an iDevice. In the first part of the chapter, we will go through the boot process, the data security features, and the encryption used by Apple. The second part deals with the different acquisition methods <span class="strong"><strong>Apple File Conduit</strong></span> (<span class="strong"><strong>AFC</strong></span>) protocol, iTunes backup, Apple File Relay protocol, and physical), providing a description of state-of-the-art techniques for cracking or bypassing the lock code. Finally, in the last part, we will introduce the concept of jailbreaking, which is useful for the physical acquisition of the latest devices.</p><div class="section" title="iOS boot process and operating modes"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec23"/>iOS boot process and operating modes</h1></div></div></div><p>The boot process of an iOS device is composed of three steps: <span class="strong"><strong>Low Level Bootloader</strong></span> (<span class="strong"><strong>LLB</strong></span>), <span class="strong"><strong>iBoot</strong></span>, and <span class="strong"><strong>iOS kernel</strong></span>. To guarantee the integrity of the different components, all the steps involved in the boot process are signed. The signature for LLB is verified by the Apple Root CA public key, contained in the Boot ROM code. Then, LLB verifies and executes iBoot, which then verifies and executes the iOS kernel. Consequently, all the components are signed by Apple. There are a lot of studies, papers, and books related to the iOS boot process and on how to overcome the protection implemented by Apple (you can find all the details in <span class="emphasis"><em><a class="link" href="apa.html" title="Appendix A. References">Appendix A</a></em></span>, <span class="emphasis"><em>References</em></span>). We suggest that you read the latest version of the Apple paper <span class="emphasis"><em>iOS Security</em></span>, <span class="emphasis"><em>Apple</em></span>, <span class="emphasis"><em>May 2016</em></span>.</p><p>From the point of view of a forensic analyst, it is important to know that iDevices can operate in the following three different modes:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Normal</strong></span>: This mode is the traditional iOS user interface.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Recovery</strong></span>: This mode is used to perform activation and upgrades on an iDevice. It can be activated by holding down the Home button on a powered off device and connecting it to a computer via the USB cable.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Device firmware upgrade</strong></span> (<span class="strong"><strong>DFU</strong></span>): This mode is used by an iDevice during the iOS upgrades and when one of the processes in verification boot chain fails. It can be activated by holding down the Home and the Power button together (with the device powered on or off) for 10 seconds, and then it is necessary to release the Power button and hold the Home button for 10 seconds more.</li></ul></div><p>Both Recovery and DFU modes are really useful for the physical acquisition of iDevices, as we will show later in the dedicated section.</p></div></div>
<div class="section" title="iOS data security"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec24"/>iOS data security</h1></div></div></div><p>A complete description of iOS data security is out of the scope of this book, but we wish to give you just an overview (taken from the Apple paper <span class="emphasis"><em>iOS Security</em></span> and from Christian D'Orazio's thesis; refer to <span class="emphasis"><em><a class="link" href="apa.html" title="Appendix A. References">Appendix A</a></em></span>, <span class="emphasis"><em>References</em></span>) of the hardware and software security features.</p><div class="section" title="Hardware security features"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec15"/>Hardware security features</h2></div></div></div><p>Every iDevice, starting from iPhone 3GS, has a dedicated AES 256-bit crypto engine built in between the flash storage and the main system memory. The purposes of this processor are to accelerate the encryption and decryption operations and to protect user data so that it remains encrypted on the device's flash memory. A <span class="strong"><strong>unique ID</strong></span> (<span class="strong"><strong>UID</strong></span>) is associated with each device and allows data to be cryptographically tied to a particular device. The UID cannot be read directly and it is used as an AES 256-bit key to generate encryption keys that protect user data. These encryption keys, known as <span class="strong"><strong>EMF</strong></span> and <span class="strong"><strong>Dkey</strong></span> (<span class="strong"><strong>Class D Key</strong></span>), are stored in a specific area of the flash memory called <span class="strong"><strong>PLOG block</strong></span> (or <span class="strong"><strong>Effaceable Storage</strong></span>). When the device deletes this area it makes the whole volume unreadable and the content is completely and definitely encrypted, with no way to recover it.</p></div><div class="section" title="File data protection"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec16"/>File data protection</h2></div></div></div><p>As described by Apple in the paper <span class="emphasis"><em>iOS Security</em></span> (refer to <span class="emphasis"><em><a class="link" href="apa.html" title="Appendix A. References">Appendix A</a></em></span>, <span class="emphasis"><em>References</em></span>):</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"In addition to the hardware encryption features built into iOS devices, Apple uses a technology called Data Protection to further protect data stored in flash memory on the device."</em></span></p></blockquote></div><p>Apple implements an encrypted HFS+ volume, in which each file is assigned to a class, depending on the type of data and the security level required. The paper also states that:</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"Every time a file on the data partition is created, Data Protection creates a new 256-bit key (the per-file key) and gives it to the hardware AES engine, which uses the key to encrypt the file as it is written to flash memory using AES CBC mode."</em></span></p></blockquote></div><p>The per-file key is then wrapped with the key of the class to which the file belongs. The wrapped per-file key is stored in the <code class="literal">cprotect</code> attribute, which is part of the file's metadata contained in the <code class="literal">Attributes</code> file. The paper further states that:</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"When a file is opened, its metadata is decrypted with the filesystem key, revealing the wrapped per-file key and a notation on which class protects it. The per-file key is unwrapped with the class key, then supplied to the hardware AES engine, which decrypts the file as it is read from flash memory."</em></span></p></blockquote></div><p>It is important to note that the filesystem key can be erased, and in that case the content of every file becomes definitely unreadable. There are four basic classes that use different policies to determine when file content is accessible and where the class keys are stored. With the exception of the Dkey, all class keys are stored in the <code class="literal">Keybag</code> system, which is a file that contains master keys for each one of the classes available, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_001.jpg" alt="File data protection"/></div><p>Class D offers the lowest security level because the Dkey is not derived from the passcode but wrapped in the <code class="literal">PLOG</code> area with a value (<code class="literal">Key0x835</code>) that can be retrieved by communicating with the kernel. From a forensics point of view, it is important to note that all the files created by a native iOS application, except e-mail messages and related attachments, belong to Class D. It means that all the cryptographic keys required to decrypt a file can be retrieved without knowing or cracking the passcode.</p></div></div>
<div class="section" title="Unique device identifier"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec25"/>Unique device identifier</h1></div></div></div><p>Every single iDevice produced is identified by a <span class="strong"><strong>Unique Device ID</strong></span> (<span class="strong"><strong>UDID</strong></span>), as is explained in The iPhone Wiki (<a class="ulink" href="http://theiphonewiki.com/wiki/UDID">http://theiphonewiki.com/wiki/UDID</a>). It can be calculated as the <span class="strong"><strong>SHA-1</strong></span> hash of a particular 60- or 59-character long string that can be obtained as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An 11-character or 12-character long (on newer devices) serial number (exactly like it is written in the <span class="strong"><strong>Settings</strong></span> app)</li><li class="listitem" style="list-style-type: disc">A 15-character long IMEI number without spaces (on older devices), empty string for iPod touch and the Wi-Fi model iPad devices, or a 13-character ECID in decimal with no leading zeroes (on newer devices)<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note4"/>Note</h3><p>The ECID is the Electronic Chip ID. For more information, refer to <a class="ulink" href="https://theiphonewiki.com/wiki/ECID">https://theiphonewiki.com/wiki/ECID</a>.</p></div></div></li><li class="listitem" style="list-style-type: disc">A 17-character long Wi-Fi MAC address (letters in lowercase, including colons). For the iPod touch first generation, use <code class="literal">00:00:00:00:00:00</code></li><li class="listitem" style="list-style-type: disc">A 17-character long Bluetooth MAC address (letters in lowercase, including colons)</li></ul></div><div class="section" title="Case study - UDID calculation on iPhone 6s"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec17"/>Case study - UDID calculation on iPhone 6s</h2></div></div></div><p>On iPhone 6s, the UDID is calculated as follows:</p><div class="mediaobject"><img src="graphics/image_03_002.jpg" alt="Case study - UDID calculation on iPhone 6s"/></div><p>If the device is unlocked, the serial number, Wi-Fi MAC address, and Bluetooth can be obtained by tapping <span class="strong"><strong>About</strong></span> from <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>General</strong></span> on the device's main screen, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_003.jpg" alt="Case study - UDID calculation on iPhone 6s"/></div><p>The ECID can be obtained as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Put the device in Recovery mode.</li><li class="listitem">Open Windows <span class="strong"><strong>Device Manager</strong></span>, navigate to <span class="strong"><strong>Universal Serial Bus controllers</strong></span> | <span class="strong"><strong>Apple Mobile Device USB Driver</strong></span>, right-click on it, and select <span class="strong"><strong>Properties</strong></span>.</li><li class="listitem">Click on <span class="strong"><strong>Details</strong></span>, search and select <span class="strong"><strong>Device Instance Path</strong></span> in the drop-down menu, and copy the text to a text file.</li><li class="listitem">On a Mac OS X, navigate to <span class="strong"><strong>System Information</strong></span> | <span class="strong"><strong>System Report</strong></span> and look in the USB entry under <span class="strong"><strong>Hardware</strong></span>.<div class="mediaobject"><img src="graphics/image_03_004.jpg" alt="Case study - UDID calculation on iPhone 6s"/></div></li></ol></div><p>In this example we have the following entries:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Serial number</strong></span>: <code class="literal">F17QT811GRY9</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>ECID</strong></span>: <code class="literal">0016611E28BB0226</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Wi-Fi MAC address</strong></span>: <code class="literal">1C:5C:F2:7F:7A:20</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Bluetooth MAC address</strong></span>: <code class="literal">1C:5C:F2:7F:7A:21</code></li></ul></div><p>Before calculating the UDID, we need to convert the hex value for ECID to a decimal number, so <code class="literal">16611E28BB0226</code> corresponds to <code class="literal">6299231647892006</code>. Moreover the letters in the Wi-Fi MAC address and in the Bluetooth MAC address must be converted to lower case.</p><p>The UDID can be calculated as follows:</p><p><code class="literal">SHA1(F17QT811GRY962992316478920061c:5c:f2:7f:7a:201c:5c:f2:7f:7a:21) = 3bf682ebc55c5673d586e0273af0dfb72d1994a2</code></p><p>The calculated value can be verified using iTunes, after connecting the device to the computer, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_005.jpg" alt="Case study - UDID calculation on iPhone 6s"/></div><p>Otherwise, the UDID can also be verified using the <code class="literal">ideviceinfo</code> tool introduced in <a class="link" href="ch02.html" title="Chapter 2. Introduction to iOS Devices">Chapter 2</a>, <span class="emphasis"><em>Introduction to iOS Devices</em></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_006.jpg" alt="Case study - UDID calculation on iPhone 6s"/></div></div></div>
<div class="section" title="Lockdown certificate"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec26"/>Lockdown certificate</h1></div></div></div><p>The first time you connect an unlocked iDevice to a computer and run the iTunes software, a pairing/sync certificate, known as a <span class="strong"><strong>lockdown</strong></span> certificate, is created on the computer's hard drive. Depending on the operating system in which iTunes is installed, lockdown certificates are stored in the following folders:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Windows 7/8/10</strong></span>: <code class="literal">C:\Program Data\Apple\Lockdown</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Windows Vista</strong></span>: <code class="literal">C:\Users\[username]\AppData\roaming\Apple Computer\Lockdown</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Windows XP</strong></span>: <code class="literal">C:\Documents and Settings\[username]\Application Data\Apple Computer\Lockdown</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mac OS X</strong></span>: <code class="literal">/var/db/lockdown</code></li></ul></div><p>In older version of Mac OS X lockdown certificates are stored in <code class="literal">/Users/[username]/Library/Lockdown/</code>.</p><p>Within these paths, there is a lockdown certificate for each device that was ever connected to the computer. The certificate is a <code class="literal">plist</code> file called <code class="literal">&lt;UDID&gt;.plist</code>, where <code class="literal">UDID</code> corresponds with the unique identifier of the iDevice, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_007.jpg" alt="Lockdown certificate"/></div><p>Once the certificate for a specific device has been generated, it remains valid until the user resets the device to factory settings. If the device is turned on and has been unlocked at least once in the last 48 hours (from iOS 8), the certificate can be used to bypass passcode to both obtain a backup and extract files through the AFC service. Of fundamental importance to the forensic acquisition of data is the fact that the certificate can be copied to another machine.</p><p>Starting from iOS 7.0, when you connect a device, two pop-up authorizations are displayed. The first popup appears on the computer in iTunes and it asks the user to click on <span class="strong"><strong>Continue</strong></span>.</p><div class="mediaobject"><img src="graphics/image_03_008.jpg" alt="Lockdown certificate"/></div><p>The second popup appears on the iDevice screen once unlocked, and requires the user to click on the <span class="strong"><strong>Trust</strong></span> button to allow pairing with the computer.</p><div class="mediaobject"><img src="graphics/image_03_009.jpg" alt="Lockdown certificate"/></div></div>
<div class="section" title="Search and seizure"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec27"/>Search and seizure</h1></div></div></div><p>If you have to deal with a search and seizure of an iDevice, it is really important to perform some steps. We have three scenarios: device turned off, device turned on and unlocked at the time of search and seizure, and device turned on and locked at the time of search and seizure:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">If the device is turned on and locked, do the following:<p>If the passcode is set, acquire the content from the device as soon as possible or keep the device on and in charge.</p><p>If the passcode is not set, turn it off.</p></li><li class="listitem">If the device is off, leave it off.</li><li class="listitem">Set <span class="strong"><strong>Auto-Lock</strong></span> to <span class="strong"><strong>Never</strong></span> from <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>General</strong></span> | <span class="strong"><strong>Auto-Lock</strong></span>.</li><li class="listitem">Check whether the passcode is set or not from <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Passcode</strong></span>.</li><li class="listitem">If the device is on and unlocked, turn on <span class="strong"><strong>Airplane Mode</strong></span> in <span class="strong"><strong>Settings:</strong></span><p>Check if the device displays the <span class="strong"><strong>iPhone requires your passcode after restarting</strong></span> message, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_010.jpg" alt="Search and seizure"/></div></li><li class="listitem">Turn on <span class="strong"><strong>Airplane Mode</strong></span> using Apple <span class="strong"><strong>Control Center</strong></span>, which can be activated with a single swipe, even with locked device if such access has not been disabled by the user.</li><li class="listitem">Keep the phone on and charging.</li><li class="listitem">Seize any computer that could have been used to synchronize or simply authorize the iDevice, because there you can possibly find a lockdown certificate that will allow access to the data.</li><li class="listitem">Acquire the data as soon as possible because the lockdown certificate is valid only if the device remains on and in any case no more than 48 hours.</li></ol></div></div>
<div class="section" title="iOS device acquisition"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec28"/>iOS device acquisition</h1></div></div></div><p>Once you have identified the specific model that you need to acquire, it becomes important to understand the best technique to use. The type of acquisition depends basically on the following seven parameters:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Device model</li><li class="listitem" style="list-style-type: disc">iOS version</li><li class="listitem" style="list-style-type: disc">Passcode (not set, simple passcode, or complex passcode)</li><li class="listitem" style="list-style-type: disc">Device status (on or off)</li><li class="listitem" style="list-style-type: disc">Availability of a pairing certificate</li><li class="listitem" style="list-style-type: disc">Presence of a backup password</li><li class="listitem" style="list-style-type: disc">Device jailbroken or not</li></ul></div><p>Nowadays, in the forensic community the following four techniques are used to access data stored on iDevices:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Apple File Conduit</strong></span>: This technique consists of a direct interaction with a powered on device, typically through non-forensic software, and permits obtaining a reduced set of the filesystem</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>iTunes Backup</strong></span>: This technique consists of a partial filesystem acquisition through the iTunes backup feature or using a forensic acquisition tool that uses the iTunes libraries</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Advanced logical</strong></span>: This technique is based on Apple File Relay and was introduced for the first time by the researcher Jonathan Zdziarski</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Physical</strong></span>: This technique generates a traditional forensic image for both the system and data partition</li></ul></div><div class="section" title="Apple File Conduit acquisition"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec18"/>Apple File Conduit acquisition</h2></div></div></div><p>The acquisition through the AFC service can be carried out with all iDevices, regardless of the operating system version. It requires that the device is not protected with a passcode, the passcode is known, or the analyst has a valid lockdown certificate. The conditions and the kind of data that you can get with this kind of acquisition have changed a lot through the various versions of iOS.</p><p>Starting from iOS 9, if the device is unlocked or with a valid lockdown certificate, it is only possible to extract multimedia information (photos, videos, music, and so on) and the related configuration files (for example, the iTunes library, the database of the Photo application, and so on). Moreover, in previous versions up to iOS 8.3, it was also possible to access the data folders of third-party applications, with the phone unlocked or with a valid lockdown certificate. It is also interesting to note that this method allows us to extract the <code class="literal">Crash Reports</code> folder from the device, which contains the error logs generated by the operating system and installed applications and the live System Log. Neither of these will be present on an acquisition made through iTunes backup, as will be explained in <a class="link" href="ch06.html" title="Chapter 6. Analyzing iOS Devices">Chapter 6</a>, <span class="emphasis"><em>Analyzing iOS Devices</em></span>, and in some cases, these files can contain very important information. It is therefore advisable to take this into account while choosing the acquisition method.</p><p>To make that kind of acquisition, you can use various types of software known as iDevice browsers.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note5"/>Note</h3><p>This activity is performed with a non-forensic tool that also permits writing operations, so the analyst must operate very carefully to avoid accidental erasure.</p></div></div><p>The most used tools on Windows and Mac for this type of acquisition are <span class="strong"><strong>iFunBox</strong></span>, <span class="strong"><strong>iTools</strong></span>, <span class="strong"><strong>iBackup Bot</strong></span>, <span class="strong"><strong>iMazing</strong></span>, <span class="strong"><strong>iExplorer</strong></span>, and <span class="strong"><strong>WonderShare Dr.Fone</strong></span>. These tools require the installation of an updated version of iTunes because they use its libraries to communicate with the device. Before connecting the device to your computer, you should ensure that in <span class="strong"><strong>iTunes</strong></span> | <span class="strong"><strong>Preferences</strong></span> | <span class="strong"><strong>Devices</strong></span>, the <span class="strong"><strong>Prevent iPods, iPhones, and iPads from syncing automatically</strong></span> option is enabled, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_011.jpg" alt="Apple File Conduit acquisition"/></div><div class="section" title="Case study - AFC acquisition with iBackupBot"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec41"/>Case study - AFC acquisition with iBackupBot</h3></div></div></div><p><span class="strong"><strong>iBackupBot</strong></span> is a commercial tool for Windows that allows access to connected iOS devices to perform both direct extraction via AFC protocol and the generation of backups in iTunes format. The trial version allows loading and extracting information from the device.</p><p>Once the software has been downloaded, installed, and run, simply connect the device to acquire and wait for the related information to load. In the following screenshot you can see an example related to an <span class="strong"><strong>iPad 2 (GSM)</strong></span> running iOS 8.3, which shows the main characteristics of the device (<span class="strong"><strong>Serial Number</strong></span>, <span class="strong"><strong>Unique Identifier</strong></span>, <span class="strong"><strong>Bluetooth Address</strong></span>, <span class="strong"><strong>Wi-Fi Address</strong></span>, and so on) and the backup encryption configuration status (that is, if it's enabled or not):</p><div class="mediaobject"><img src="graphics/image_03_012.jpg" alt="Case study - AFC acquisition with iBackupBot"/></div><p>Clicking on <span class="strong"><strong>User Applications</strong></span> shows the list of all applications installed by the user, reporting the size of the application and of its data, plus the version that is currently installed:</p><div class="mediaobject"><img src="graphics/image_03_013.jpg" alt="Case study - AFC acquisition with iBackupBot"/></div><p>The <span class="strong"><strong>App File Sharing</strong></span> option provides access to application data whose developers have decided to share data. This feature is used to allow, typically through iTunes, the exchange of files between the device and a computer. All shared files from the applications can be extracted directly from the device. The functionality is often used in applications where the user needs to create and/or modify the contents (for example, the Office Suites app) or manage files (for example, the Compression app).</p><p>The following screenshot shows an example on the WinZip application. By right-clicking on one or more files you can export them to a folder on your computer. Pay attention to the fact that this access is read-write, and the graphical interface provides also a <span class="strong"><strong>New Folder</strong></span> button that allows the creation of content on the device.</p><div class="mediaobject"><img src="graphics/image_03_014.jpg" alt="Case study - AFC acquisition with iBackupBot"/></div><p>The <span class="strong"><strong>Raw File System</strong></span> option allows you to navigate within the part of the device's filesystem that is made available through the AFC protocol. As already mentioned, it mainly includes media data (<code class="literal">DCIM</code> folder), books loaded into the iBooks app (<code class="literal">Books</code> folder), iTunes library (<code class="literal">iTunes_Control</code> folder), and files downloaded by the user or the applications (<code class="literal">Downloads</code> folder). Similar to the previous option, files and folders can be extracted from the device to the computer.</p><div class="mediaobject"><img src="graphics/image_03_015.jpg" alt="Case study - AFC acquisition with iBackupBot"/></div><p>Lastly, the <span class="strong"><strong>Tools</strong></span> option allows the file extraction of the <code class="literal">System Log</code> and the <code class="literal">Crash Report</code> folder.</p><p>The <code class="literal">System Log</code> can be exported in text format and contains the latest information on the activity of the device. It is useful if extracted in the immediacy or, in general, to support the information attached to the acquisition reports and demonstrate at least in part the inevitable changes made to the system during extraction.</p><div class="mediaobject"><img src="graphics/image_03_016.jpg" alt="Case study - AFC acquisition with iBackupBot"/></div><p>The <code class="literal">Crash Report</code> folder can be extracted in a similar way as the previous options. Typically, it contains the information about the last 24-48 hours of device usage, but the amount of information present is not determinable a priori, because it is affected by several parameters. As will be detailed in <a class="link" href="ch06.html" title="Chapter 6. Analyzing iOS Devices">Chapter 6</a>, <span class="emphasis"><em>Analyzing iOS Devices</em></span>, these logs may contain information that cannot be extracted by other methods.</p><div class="mediaobject"><img src="graphics/image_03_017.jpg" alt="Case study - AFC acquisition with iBackupBot"/></div></div></div><div class="section" title="iTunes backup"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec19"/>iTunes backup</h2></div></div></div><p><span class="strong"><strong>iTunes backup</strong></span> acquisition allows the analyst to recover more information than the AFC acquisition and in a more forensics way as it creates a backup for the device without altering any data. Regarding the passcode, the conditions are similar to direct acquisition: the analyst must know the passcode or have a valid lockdown certificate to perform this kind of acquisition. Before connecting the device, you also need to disable automatic syncing in the iTunes software. This acquisition can be performed in two ways, <span class="emphasis"><em>using iTunes</em></span> or <span class="emphasis"><em>using forensic software</em></span>.</p><div class="section" title="Acquisition with iTunes"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec42"/>Acquisition with iTunes</h3></div></div></div><p>The acquisition through iTunes can be done in a very simple way using the backup function of the device. Once you start iTunes, you need to click on the name of the device to access detailed information. At this point, you need to check how the device is configured in relation to the backup operation. There may be the following three cases:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The device is configured to perform a local backup not protected by a password</li><li class="listitem" style="list-style-type: disc">The device is configured to perform a local backup with a password previously set by the device owner</li><li class="listitem" style="list-style-type: disc">The device is configured to backup to iCloud</li></ul></div><p>In the first two cases, simply click on the <span class="strong"><strong>Back Up Now</strong></span> button to start the backup on the computer, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_018.jpg" alt="Acquisition with iTunes"/></div><p>If the user has not chosen a password, the created backup can be analyzed with various tools. Otherwise, the analyst needs to crack the backup password before starting the analysis. Both the password cracking and backup structures will be discussed in <a class="link" href="ch04.html" title="Chapter 4. Evidence Acquisition and Analysis from iTunes Backup">Chapter 4</a>, <span class="emphasis"><em>Evidence Acquisition and Analysis from iTunes Backup</em></span>.</p><p>In the third case, before starting the backup, the analyst must change the option from <span class="strong"><strong>iCloud</strong></span> to <span class="strong"><strong>This computer</strong></span>. In this way, the backup will be performed locally and will not overwrite any existing data present in the previous backups on iCloud. The data acquisition from iCloud will be explained in <a class="link" href="ch05.html" title="Chapter 5. Evidence Acquisition and Analysis from iCloud">Chapter 5</a>, <span class="emphasis"><em>Evidence Acquisition and Analysis from iCloud</em></span>.</p><div class="mediaobject"><img src="graphics/image_03_019.jpg" alt="Acquisition with iTunes"/></div></div><div class="section" title="Acquisition with forensic tools"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec43"/>Acquisition with forensic tools</h3></div></div></div><p>In the market, there are various forensic tools that can perform backup acquisition, for example, Cellebrite UFED 4PC/UFED Touch/UFED Physical Analyzer, Oxygen Forensic® Starter/Analyst/Detective, Mobile Phone Examiner, MobilEdit!, Lantern, and XRY.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note6"/>Note</h3><p>For a detailed reference list, refer to <a class="link" href="apb.html" title="Appendix B. Tools for iOS Forensics">Appendix B</a>, <span class="emphasis"><em>Tools for iOS Forensics</em></span>.</p></div></div></div><div class="section" title="Case study - iTunes backup acquisition with Oxygen Forensic Analyst"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec44"/>Case study - iTunes backup acquisition with Oxygen Forensic Analyst</h3></div></div></div><p><span class="strong"><strong>Oxygen Forensic</strong></span> software is a commercial product that allows forensic analysts to perform iTunes backup acquisition of an iOS device. It is available in three licensing modes, <span class="strong"><strong>Starter</strong></span>, <span class="strong"><strong>Analyst</strong></span>, and <span class="strong"><strong>Detective</strong></span>.</p><p>To start the extraction, it is necessary to click on the <span class="strong"><strong>Connect device</strong></span> button on the main screen, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_020.jpg" alt="Case study - iTunes backup acquisition with Oxygen Forensic Analyst"/></div><p>The software will then begin the extraction procedure, and you can choose the type of connection you want to start. You can choose between <span class="strong"><strong>Auto device connection</strong></span> and <span class="strong"><strong>Manual device selection</strong></span>, as shown in the following screenshot. For iDevices, it is generally sufficient to select the first option.</p><div class="mediaobject"><img src="graphics/image_03_021.jpg" alt="Case study - iTunes backup acquisition with Oxygen Forensic Analyst"/></div><p>The software starts searching for a connected iDevice. If the device is locked with a passcode, the software asks the analyst to insert the passcode or to provide a lockdown certificate. The software provides the UDID for the iDevice, so it is easier for the analyst to search it on a computer previously synced with the device itself. If the analyst knows the passcode, he/she needs to insert it into the device, authorize the computer, and click on <span class="strong"><strong>I entered the passcode. Press to connect</strong></span>. Otherwise, he/she can choose the <span class="strong"><strong>Select lockdown plist</strong></span> option and provide the tool with a valid lockdown certificate.</p><div class="mediaobject"><img src="graphics/image_03_022.jpg" alt="Case study - iTunes backup acquisition with Oxygen Forensic Analyst"/></div><p>If the certificate is correct, the software displays a confirmation screen with a button to start the connection to the device, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_023.jpg" alt="Case study - iTunes backup acquisition with Oxygen Forensic Analyst"/></div><p>At this point, the software displays information specific to the connected device (model, IMEI number, iOS version, and boot loader), as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_024.jpg" alt="Case study - iTunes backup acquisition with Oxygen Forensic Analyst"/></div><p>The investigator can then enter information about the case, and if known, the backup password for the device.</p><div class="mediaobject"><img src="graphics/image_03_025.jpg" alt="Case study - iTunes backup acquisition with Oxygen Forensic Analyst"/></div><p>Then, the analyst can select the data they want to extract by choosing the ones supported by this method, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_026.jpg" alt="Case study - iTunes backup acquisition with Oxygen Forensic Analyst"/></div><p>When clicking on the <span class="strong"><strong>Next</strong></span> button, the acquisition procedure starts and displays a progress bar. It should be noted that during the extraction, the software also proceeds with parsing all the data found, including the search for deleted records within the database stored in the phone (for example, calls, SMS, chat, and so on). For this reason, the acquisition may require a large amount of time, but after that the analyst is ready to parse the data within the software, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_027.jpg" alt="Case study - iTunes backup acquisition with Oxygen Forensic Analyst"/></div><p>If the device has a backup password previously set by the user, Oxygen can work with <span class="strong"><strong>Passware Kit Forensic</strong></span> (if installed on the computer used to acquire data) trying to make an attack on the backup password. If the examiner knows the password, he/she has the chance to finish the attack and enter it manually. At the end of the cracking process, if the password has been detected, the software proceeds with the extraction of all the data, in a similar way as described previously. If the password is not found, the software extracts only the multimedia content (images, video, books, and so on) and does not provide information about the applications preinstalled or installed by the user:</p><div class="mediaobject"><img src="graphics/image_03_028.jpg" alt="Case study - iTunes backup acquisition with Oxygen Forensic Analyst"/></div></div></div><div class="section" title="Advanced logical acquisition"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec20"/>Advanced logical acquisition</h2></div></div></div><p>The advanced logical acquisition method was first introduced by the iOS security researcher Jonathan Zdziarski in his tool, <span class="strong"><strong>Waterboard</strong></span>, released in June 2013. The author's description in his article states:</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"Waterboard is an open source iOS forensic imaging tool, capable of performing an advanced logical acquisition of iOS devices by utilizing extended services and back doors in Apple's built-in lockdown services. These services can bypass Apple's mobile backup encryption and other encryption to deliver a clear text copy of much of the filesystem to any machine that can or has previously paired with the device."</em></span></p></blockquote></div><p>A detailed explanation can be found in the paper <span class="emphasis"><em>Identifying Back Doors</em></span>, <span class="emphasis"><em>Attack Points</em></span>, <span class="emphasis"><em>and Surveillance Mechanisms in iOS Devices</em></span>, by <span class="emphasis"><em>Jonathan Zdziarski</em></span> (refer to <a class="link" href="apa.html" title="Appendix A. References">Appendix A</a>, <span class="emphasis"><em>References</em></span>). Currently, the Waterboard tool is no longer available and supported by Zdziarski, but there are few forensic tools offering the same feature, UFED Physical Analyzer, Oxygen Forensics Toolkit, and AccessData MPE.</p><p>This method has been made unavailable starting from iOS 8, also due to the discovery of Zdziarski. On devices not yet updated, which are running iOS 7, the method is still usable; but even in this case it is necessary that the device is unlocked or that a valid lockdown certificate is available.</p><div class="section" title="Case study - advanced logical acquisition with UFED Physical Analyzer"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec45"/>Case study - advanced logical acquisition with UFED Physical Analyzer</h3></div></div></div><p>UFED Physical Analyzer is a software product from Cellebrite UFED and supplied with the purchase of UFED Touch or UFED 4PC. The advanced logical acquisition in UFED Physical Analyzer can be started through the main interface of the software under the menu item, <span class="strong"><strong>iOS Device Extraction</strong></span> under <span class="strong"><strong>Extract</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_029.jpg" alt="Case study - advanced logical acquisition with UFED Physical Analyzer"/></div><p>The analyst can now choose <span class="strong"><strong>Advanced Logical extraction</strong></span>.</p><div class="mediaobject"><img src="graphics/image_03_030.jpg" alt="Case study - advanced logical acquisition with UFED Physical Analyzer"/></div><p>The software requires you to connect the turned-on device using the correct cable (30-pin connector or Lightning 8-pin connector), as shown as follows:</p><div class="mediaobject"><img src="graphics/image_03_031.jpg" alt="Case study - advanced logical acquisition with UFED Physical Analyzer"/></div><p>The device must be powered on and unlocked; otherwise, the software displays a message stating <span class="strong"><strong>The iOS device is locked or untrusted</strong></span>. To proceed, the analyst must unlock the device with the passcode or provide the right lockdown certificate.</p><div class="mediaobject"><img src="graphics/image_03_032.jpg" alt="Case study - advanced logical acquisition with UFED Physical Analyzer"/></div><p>The software checks whether a password is set on the backup device and shows two possible methods for the acquisition: <span class="strong"><strong>Method 1</strong></span> corresponds to a device backup, while <span class="strong"><strong>Method 2</strong></span> allows the analyst to extract data using both the AFC protocol and the lockdown service (advanced logical acquisition). If the device is jailbroken then <span class="strong"><strong>Method 3</strong></span> will show up to allow a complete filesystem dump.</p><div class="mediaobject"><img src="graphics/image_03_033.jpg" alt="Case study - advanced logical acquisition with UFED Physical Analyzer"/></div><p>If the device has a backup password with <span class="strong"><strong>Method 1</strong></span>, the analyst must know the password or crack it (as explained in <a class="link" href="ch04.html" title="Chapter 4. Evidence Acquisition and Analysis from iTunes Backup">Chapter 4</a>, <span class="emphasis"><em>Evidence Acquisition and Analysis from iTunes Backup</em></span>), while with <span class="strong"><strong>Method 2</strong></span>, it is possible to extract part of the data even without cracking the backup password. For this reason, when you need to acquire a device with a backup password, it is advisable to perform both acquisitions. In this way, you can definitely see some information, thanks to <span class="strong"><strong>Method 2</strong></span>, and try to recover more details by cracking the encrypted acquisition carried out with <span class="strong"><strong>Method 1</strong></span>.</p><p>If the device does not have a backup password then Physical Analyzer will propose the option to encrypt the backup with a known password. This is because certain files, such as the keychain, are in this case encrypted with the chosen backup password and so it is possible to recover more information (that is, user stored passwords).</p><p>Once you select the extraction method, the software initiates the procedure requiring the user to set the destination folder. Scanning takes a variable time depending on the chosen method (<span class="strong"><strong>Method 1</strong></span> is performed in a single step and is faster than <span class="strong"><strong>Method 2</strong></span>, which requires three steps), the memory size of the device, and the space occupied by files (especially media files such as pictures, videos, music, and so on).</p><p>Once the acquisition is complete, the software displays a report showing the amount of extracted data and the time taken, as shown in the following screenshot. From this window, the analyst can choose whether to return to the home screen or open the acquisition made in UFED Physical Analyzer for the analysis activities.</p><div class="mediaobject"><img src="graphics/image_03_034.jpg" alt="Case study - advanced logical acquisition with UFED Physical Analyzer"/></div></div></div><div class="section" title="Physical acquisition with forensic tools"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec21"/>Physical acquisition with forensic tools</h2></div></div></div><p><span class="strong"><strong>Physical acquisition</strong></span> allows most of the content from an iOS device to be extracted. Unlike the AFC, backup, and advanced logical methods, the analyst can obtain a forensic copy of the device's internal NAND storage and access all the files stored there. Some examples of interesting information that can only be retrieved through physical acquisition are the e-mail messages and log files of the device. The physical acquisition is based on hardware vulnerabilities during the boot process. For this reason, this operation is not invasive on the data stored on the iDevice because it uploads an alternative operating system directly into RAM through which it can launch acquisition commands. Currently, it is supported on the first iPhone model 3G/3GS/4, iPad 1, and iPod touch 1/2/3/4.</p><p>If the device is not protected by a passcode, the physical acquisition can be carried out without problems by creating an image of both system and data partitions.</p><p>If the iDevice is protected with a passcode, it is necessary to highlight the following two cases:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If the passcode is simple (4 digits), it can be cracked in 20 to 30 minutes, depending on the device type</li><li class="listitem" style="list-style-type: disc">If the passcode is complex (multidigit or alphanumeric) the analyst has the following two options:</li><li class="listitem" style="list-style-type: disc">Try a brute force or a dictionary attack on the passcode.</li><li class="listitem" style="list-style-type: disc">Perform the physical acquisition without cracking the passcode. In this case, the physical acquisition will decode all the data whose encryption does not depend on the passcode, while other data (for example, e-mail, stored passwords, and so on) cannot be decrypted.</li></ul></div><p>Several forensic tools can perform physical acquisition, such as iPhone data protection tools, UFED Physical Analyzer, Elcomsoft iOS Forensic Toolkit, Lantern, AccessData MPE+, iXAM, and XRY.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note7"/>Note</h3><p>For a more comprehensive and detailed list of tools, books, and papers related to physical acquisition, refer to <a class="link" href="apa.html" title="Appendix A. References">Appendix A</a>, <span class="emphasis"><em>References</em></span>, and <a class="link" href="apb.html" title="Appendix B. Tools for iOS Forensics">Appendix B</a>, <span class="emphasis"><em>Tools for iOS Forensics</em></span>.</p></div></div><div class="section" title="Case study - physical acquisition with UFED Physical Analyzer"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec46"/>Case study - physical acquisition with UFED Physical Analyzer</h3></div></div></div><p>Physical acquisition using UFED Physical Analyzer can be started through the main interface of the software from the menu item <span class="strong"><strong>iOS Device Extraction</strong></span>, under <span class="strong"><strong>Extract</strong></span>, as follows:</p><div class="mediaobject"><img src="graphics/image_03_035.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><p>The device must be powered off and then the analyst can connect the correct cable to the computer (and not yet to the iDevice).</p><div class="mediaobject"><img src="graphics/image_03_036-1.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><p>Now, the investigator must connect the device in <span class="strong"><strong>Recovery</strong></span> mode. It means that they need to press and hold the Home button and connect the device, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_037-2.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><p>The software displays the information related to the device (the <span class="strong"><strong>iOS version</strong></span>, <span class="strong"><strong>serial number</strong></span>, <span class="strong"><strong>Board</strong></span>, <span class="strong"><strong>IBoot firmware version</strong></span>, <span class="strong"><strong>Chip ID</strong></span>, and so on), as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/image_03_038-1.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><p>Now, the device must be set in DFU mode by pressing the <span class="strong"><strong>Power</strong></span> and <span class="strong"><strong>Home</strong></span> buttons together, and release the Power button 3 seconds after the device's screen becomes black.</p><div class="mediaobject"><img src="graphics/image_03_039-1.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><p>The software uploads the boot loader in memory and provides the analyst with two options: <span class="strong"><strong>Physical Extraction</strong></span> and <span class="strong"><strong>File System Extraction</strong></span>, as shown in the following screenshot. The first one extracts a physical image of the encrypted data partition, so the extraction can be viewed in UFED Physical Analyzer and in other analysis tools. UFED also provides information about the passcode protection. If the device is not protected by a passcode, it can start the acquisition immediately and decrypt all the files.</p><div class="mediaobject"><img src="graphics/image_03_040-1.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><p>Otherwise, it depends on the passcode type. If the device has a simple passcode (four digits), it can be cracked in 20 to 30 minutes (depending on the iDevice type) by choosing the <span class="strong"><strong>Passcode recovery</strong></span> option.</p><div class="mediaobject"><img src="graphics/image_03_041.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><div class="mediaobject"><img src="graphics/image_03_042.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><div class="mediaobject"><img src="graphics/image_03_043.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><p>At the end of the cracking stage, the software shows the passcode and gives the opportunity to start the acquisition, as follows:</p><div class="mediaobject"><img src="graphics/image_03_044.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><p>If the device has a complex passcode, the analyst has two options: either acquire a physical image without cracking the passcode (this means that some data will not be available, for example, e-mails, and stored passwords) or try to crack the passcode with a dictionary attack.</p><div class="mediaobject"><img src="graphics/image_03_045.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><div class="mediaobject"><img src="graphics/image_03_046.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div><div class="mediaobject"><img src="graphics/image_03_047.jpg" alt="Case study - physical acquisition with UFED Physical Analyzer"/></div></div></div></div>
<div class="section" title="Dealing with a locked iDevice"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec29"/>Dealing with a locked iDevice</h1></div></div></div><p>The main problem, as already mentioned in the description of the various acquisition methods, is the presence of a lock code set by the user.</p><p>For devices up to iPhone 4, iPad 1, and iPod touch up to version 4, you can work around the presence of a lock code with the ability to load into RAM an operating system different from the original iOS: if the passcode is simple (four digits) the brute force time is a maximum of 30 minutes, increasing by several orders of magnitude (months or years) as the complexity of the passcode increases. In any case, for these types of device, the encryption is restricted to certain types of file (mainly e-mails and third-party application data), while for the system data the encryption does not depend on the passcode: for this reason, a physical acquisition allows access to such data.</p><p>For the later devices, that is, all those also compatible with iOS 9, there are three available techniques to violate or bypass the passcode lock:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Use a valid lockdown certificate</li><li class="listitem" style="list-style-type: disc">Use a tool that allows submitting the passcode to the device via USB port instead of the touch screen</li><li class="listitem" style="list-style-type: disc">Get support from companies that developed proprietary techniques able to brute force the passcode</li></ul></div><p>The first technique is applicable to all versions of iOS, including iOS 9. In this case, it is necessary that two conditions are met: the device, even if locked, must have been found switched on and maintained in this condition, and the same must have been unlocked at least once in the past 48 hours. It is therefore clear that this method should be used immediately with respect to the seizure or discovery of the device, immediately seeking a computer that may hold a valid certificate and proceeding with an acquisition as quickly as possible. The use of a valid certificate allows for all devices, including those with iOS 9, the acquisition by AFC Protocol, and acquisition through backup. On devices with iOS 7 it also allows to make the advanced logical acquisition.</p><p>The second method can be used on all devices but only up to iOS 8.1. Several hardware devices have been made available on the market and are all based, essentially, on the principle of passing the passcode via USB and not through the touch screen. The best-known and most commonly used forensic software is the UFED User Lock Code Recovery Tool by Cellebrite, available in the licenses of the software UFED 4PC and UFED Touch. It runs on iOS 7. Other devices, which are not born as forensic tools but very much used in the community, are IP-BOX, MFC dongle, SecureView's svStrike, and HDB Box.</p><p>These devices, through an additional adapter, can also be used on operating systems up to iOS 8.1. It's important to note that none of these tools manage to overcome the limitation, which can be activated by the user, of secure wiping after 10 incorrect attempts at entering the code: this limitation stays in place also when the code is submitted to the phone through the USB port. For this reason, these techniques need to be applied if and only if it is certain that wiping is not active on the device.</p><div class="mediaobject"><img src="graphics/image_03_048.jpg" alt="Dealing with a locked iDevice"/></div><p>The alternative solution is to get support from some specialized company that has developed proprietary techniques to recover the passcode that have not yet been implemented in software and hardware on the market. At the time of writing this edition of the book, the only company offering this service is Cellebrite through the <span class="strong"><strong>Cellebrite Advanced Investigative Services</strong></span> (<span class="strong"><strong>CAIS</strong></span>) center. As reported in the company's website (<a class="ulink" href="http://www.cellebrite.com/Pages/cellebrite-unlocking-services-now-available-for-apple-ios-9-and-samsung-galaxy-s6-and-s7-devices">http://www.cellebrite.com/Pages/cellebrite-unlocking-services-now-available-for-apple-ios-9-and-samsung-galaxy-s6-and-s7-devices</a>), the service is available for all devices with a 32-bit processor (that is, iPhone 4s/5/5c, iPad 2/3G/4G, iPad mini 1G, and iPod touch 5G) with any version of iOS 8 operating system (that is, 8 - 8.0/8.0.1/8.0.2/8.1/8.1 .1/8.1.2/8.1.3/8.2/8.3/8.4/8.4.1) or iOS 9 operating system (that is, 9.0/9.0.1/9.0.2/9.1/9.2/9.2.1/9.3/9.3.1/9.3.2). The company ensures that there will be no physical invasiveness on the device (that is, there is no need of any hardware intervention) and the non-activation of the wiping function after 10 incorrect attempts.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note8"/>Note</h3><p><span class="strong"><strong>From a Real Case</strong></span></p><p>At the beginning of 2016, one of the authors of the book was appointed Expert Witness from the Court of Milan as part of the criminal proceedings against Alexander Boettcher, accused together with his girlfriend Martina Levato, of having made four acid attacks against her ex-boyfriends. At the time when the couple was arrested (December 2014), Boettcher got his iPhone 5 running iOS 8.0 seized, which was locked with a 4-digit passcode that he said he did not remember. At that time, there were no known techniques that allowed bypassing the code without activating Apple protection systems (for example, wiping encryption keys after 10 incorrect entries), and for this reason the prosecutor and the Judiciary Police have decided to analyze the other devices, finding a backup on the computer of the suspect made in September 2014. During the hearings in January 2016, it was deemed to be useful by the Judges evaluating new possibilities to access the data. They then appointed one of the authors asking technical advice to evaluate new possibilities in this regard. The consultant therefore decided to contact the CAIS service offered by the company Cellebrite and in February 2016 brought the phone to their EU headquarters in Munich, Germany, where the passcode was detected after two days of work, allowing in this way the acquisition of the device through the backup mode and AFC protocol. The news has been the subject of attention by the Italian national press for the notoriety of the case, and the international press, given the temporal proximity with having Apple vs. FBI (refer, for example, to <span class="emphasis"><em>Apple-FBI Case: this is how the iPhone for the investigation of acid attacks in Milan was unlocked</em></span> - <a class="ulink" href="http://www.lastampa.it/2016/03/01/tecnologia/news/come-stato-sbloccato-liphone-nel-caso-delle-aggressioni-con-lacido-a-milano-3hmkkOwVQsiCFtkjjJbt5O/pagina.html">http://www.lastampa.it/2016/03/01/tecnologia/news/come-stato-sbloccato-liphone-nel-caso-delle-aggressioni-con-lacido-a-milano-3hmkkOwVQsiCFtkjjJbt5O/pagina.html</a>, and <span class="emphasis"><em>It Might Cost The FBI Just $ 1.500 To Get Into Terrorist's iPhone</em></span>: <a class="ulink" href="http://www.forbes.com/sites/thomasbrewster/2016/03/23/cellebrite-apple-iphone-fbi-syed-farook-alexander-boettcher/">http://www.forbes.com/sites/thomasbrewster/2016/03/23/cellebrite-apple-iphone-fbi-syed-farook-alexander-boettcher/</a>).</p></div></div><p>In addition to these techniques, other methods have been used in practice to bypass the lock code. The best known are the use of vulnerabilities on the specific version of the operating system that allow access to the device's screen (often associated with the application Siri), or forcing the generation of a backup to iCloud and bringing the device into the proximity of a known Wi-Fi network.</p></div>
<div class="section" title="iOS device jailbreaking"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec30"/>iOS device jailbreaking</h1></div></div></div><p><span class="strong"><strong>iOS jailbreaking</strong></span> is the process of removing limitations on the iOS devices through the use of software and hardware exploits. It enables root access to the iOS filesystem and allows additional applications not available in the official Apple App Store to be downloaded. Various jailbreaking tools have been developed; an always updated list can be found at <a class="ulink" href="http://theiphonewiki.com/wiki/Jailbreak">http://theiphonewiki.com/wiki/Jailbreak</a>. Currently, the latest available tools are <span class="strong"><strong>Evasi0n</strong></span> (<a class="ulink" href="http://evasi0n.com/">http://evasi0n.com/</a>) for iOS 7, <span class="strong"><strong>Taig</strong></span> (<a class="ulink" href="http://www.taig.com/en/">http://www.taig.com/en/</a>) for iOS 8, and <span class="strong"><strong>Pangu</strong></span> (<a class="ulink" href="http://en.pangu.io/">http://en.pangu.io/</a>) for iOS 7, 8, and 9.</p><p>Jailbreaking is an invasive activity on the device system partition, so it cannot be considered as a forensic operation. However, it is useful to note that for devices after iPhone 4, it is the only way to make a physical acquisition. It is therefore necessary that the device is already jailbroken or that the investigator can jailbreak it. On newer devices, in order to jailbreak the device, the analyst needs to know the passcode, since it requires actions to be performed directly on the unlocked device.</p><div class="section" title="Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec22"/>Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit</h2></div></div></div><p>At the time of writing, jailbreaking is supported up to iOS 9.3.3 by Pangu jailbreaking, and the <span class="strong"><strong>Elcomsoft iOS Forensic Toolkit</strong></span> (<span class="strong"><strong>EIFT</strong></span>) software is the only commercial tool that permits a physical acquisition of a jailbroken device. It currently works on both 32- and 64-bit devices, but in the first case, it can extract a physical image, while in the second it can recover a full filesystem dump of the device. It is important to mention that although a physical image is different from a filesystem image, in the current state of the art there is effectively no difference between a filesystem and a physical image of these devices from a usable content point of view, because the unallocated space of a physical image is encrypted, and at the time of writing, there are still no known techniques to carve and decrypt from the unallocated space. As a result, you are effectively getting the content of a filesystem image with your physical image because you can't read the unallocated areas. Moreover, both Cellebrite and MPE+ support getting a full filesystem dump of jailbroken devices.</p><p>If the seized device is already jailbroken and the root password was not changed by the user (recall from <a class="link" href="ch01.html" title="Chapter 1. Digital and Mobile Forensics">Chapter 1</a>, <span class="emphasis"><em>Digital and Mobile Forensics</em></span>, that the default root password is <span class="emphasis"><em>alpine</em></span>) it is also possible to try cracking the passcode.</p><p>This commercial tool can be used both on Windows or Mac. The following screenshots show the acquisition procedure performed with EIFT version 2.0 of a jailbroken iPad mini first generation with a passcode and iOS 9.0.2.</p><div class="mediaobject"><img src="graphics/image_03_049.jpg" alt="Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit"/></div><p>The wizard is very simple and basically involves the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Get the passcode (option <code class="literal">3</code>)</li><li class="listitem">Extraction of the encryption keys (option <code class="literal">4</code>)</li><li class="listitem">Physical acquisition of the system partition (in plain text) and data partition (encrypted) (option <code class="literal">6</code>)</li><li class="listitem">Decryption of the data partition with the extracted keys (option <code class="literal">7</code>)</li></ol></div><p>The first step loads a tool on the device to crack the passcode and then, with a simple passcode in this case, starts the cracking activity. At the end, it prints the passcode on the screen and saves it in a <code class="literal">.txt</code> file.</p><div class="mediaobject"><img src="graphics/image_03_050.jpg" alt="Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit"/></div><p>The second step extracts encryption keys from the device; these keys are necessary to decrypt the physical acquisition. It saves the decryption keys in a <code class="literal">plist</code> file (default name <code class="literal">keys.plist</code>) and prints the backup password (if it exists) and the AppleID for the device on the screen.</p><div class="mediaobject"><img src="graphics/image_03_051.jpg" alt="Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit"/></div><p>The third step creates a forensic image of the system and data partition. The first one is not encrypted, while the second one is. This step produces in output two DD files; the second one needs to be decrypted.</p><div class="mediaobject"><img src="graphics/image_03_052.jpg" alt="Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit"/></div><p>The fourth step takes as input the encrypted data partition and the <code class="literal">keys.plist</code> file and produces an unencrypted version of the DD image as output. This image can be imported and analyzed in various tools, both specifically for mobile devices (for example, UFED Physical Analyzer, Oxygen Forensic, and Internet Evidence Finder) or traditional forensics toolkit (for example, Encase, FTK, and X-Ways).</p><div class="mediaobject"><img src="graphics/image_03_053.jpg" alt="Case study - physical acquisition with Elcomsoft iOS Forensic Toolkit"/></div></div></div>
<div class="section" title="Apple support for law enforcement"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec31"/>Apple support for law enforcement</h1></div></div></div><p>On a regular basis, Apple publishes a document on its website called <span class="emphasis"><em>Legal Process Guidelines for U.S. Law Enforcement</em></span>. These guidelines contain information on how to request Apple support to recover information from iCloud or from an iDevice, and specify the data that Apple, in some cases, can extract from a passcode-protected device. Apple's latest available version (<a class="ulink" href="https://www.apple.com/privacy/docs/legal-process-guidelines-us.pdf">https://www.apple.com/privacy/docs/legal-process-guidelines-us.pdf</a>) states:</p><p>"For all devices running iOS 8.0 and later versions, Apple will not perform iOS data extractions as data extraction tools are no longer effective. The files to be extracted are protected by an encryption key that is tied to the user's passcode, which Apple does not possess. For iOS devices running iOS versions earlier than iOS 8.0, upon receipt of a valid search warrant issued upon a showing of probable cause, Apple can extract certain categories of active data from passcode locked iOS devices. Specifically, the user generated active files on an iOS device that are contained in Apple's native apps and for which the data is not encrypted using the passcode ("user generated active files"), can be extracted and provided to law enforcement on external media. Apple can perform this data extraction process on iOS devices running iOS 4 through iOS 7. Please note the only categories of user generated active files that can be provided to law enforcement, pursuant to a valid search warrant, are: SMS, iMessage, MMS, photos, videos, contacts, audio recording, and call history. Apple cannot provide: e-mail, calendar entries, or any third-party app data."</p><p>This method was used by the South Africa police, who requested help from Apple in order to access data stored on Oscar Pistorious' iPhone.</p><div class="section" title="Apple versus FBI - The San Bernardino shooting case"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec23"/>Apple versus FBI - The San Bernardino shooting case</h2></div></div></div><p>In December 2015, 14 innocent people lost their lives in the San Bernardino terrorist attack. The shooters, killed by the police, had managed to destroy all their devices but one prior to the attack, the work phone of Syed Rizwan Farook.</p><p>Farook's phone was an iPhone 5s, running iOS 8, protected with a four-digit pin code, and it was found powered off (although there is quite some confusion on this point, as at a first stage the device appeared to have been found powered on). As you have learned in this chapter, there is no known technique that's able to bypass and unlock a device in this scenario. The only chance the FBI had was to try the luck of guessing/brute forcing the correct PIN within the first nine attempts before the device would wipe itself after 10 incorrect PIN entries. For this reason, on February 2016, the FBI reached Apple with a compelling order (<a class="ulink" href="https://assets.documentcloud.org/documents/2714005/SB-Shooter-Order-Compelling-Apple-Asst-iPhone.pdf">https://assets.documentcloud.org/documents/2714005/SB-Shooter-Order-Compelling-Apple-Asst-iPhone.pdf</a>) asking to provide assistance to accomplish the following:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">It will bypass or disable the autoerase function whether or not it has been enabled</li><li class="listitem">It will enable the FBI to submit passcodes to the SUBJECT DEVICE for testing electronically via the physical device port, Bluetooth, Wi-Fi, or other protocol available</li><li class="listitem">It will ensure that when the FBI submits passcodes to the SUBJECT DEVICE, software running on the device will not purposefully introduce any additional delay between passcode attempts beyond what is incurred by Apple hardware</li></ol></div><p>Furthermore, in the court order, it was also specified that Apple's assistance may include providing software to the FBI that will be coded by Apple with a unique identifier of the phone so that the software would only load and execute on the SUBJECT DEVICE. What all this means is that the FBI asked Apple to develop a backdoor into iOS devices.</p><p>Apple refused to comply with the order stating, in an open letter by its CEO, Tim Cook (<a class="ulink" href="http://www.apple.com/customer-letter/">http://www.apple.com/customer-letter/</a>), that:</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"The United States government has demanded that Apple take an unprecedented step which threatens the security of our customers. We oppose this order, which has implications far beyond the legal case at hand. This moment calls for public discussion, and we want our customers and people around the country to understand what is at stake."</em></span></p></blockquote></div><p>On March 28, the FBI announced that it had unlocked the suspect's iPhone with a third party's help, without giving any further details on the <span class="emphasis"><em>who</em></span> and the <span class="emphasis"><em>how</em></span>. Coincidently enough, on the very same day, the FBI cut an order of <span class="emphasis"><em>$218,004.85</em></span> to Cellebrite (<a class="ulink" href="https://www.fpds.gov/ezsearch/fpdsportal?q=cellebrite+CONTRACTING_AGENCY_NAME%3A%22FEDERAL+BUREAU+OF+INVESTIGATION%22+PIID%3A%22DJF161200G0004569%22&amp;s=FPDSNG.COM&amp;templateName=1.4.4&amp;indexName=awardfull&amp;x=0&amp;y=0&amp;sortBy=SIGNED_DATE&amp;desc=Y">https://www.fpds.gov/ezsearch/fpdsportal?q=cellebrite+CONTRACTING_AGENCY_NAME%3A%22FEDERAL+BUREAU+OF+INVESTIGATION%22+PIID%3A%22DJF161200G0004569%22&amp;s=FPDSNG.COM&amp;templateName=1.4.4&amp;indexName=awardfull&amp;x=0&amp;y=0&amp;sortBy=SIGNED_DATE&amp;desc=Y</a>), which of course led the speculation on the identity of the third party who was able to unlock the iPhone. However, on April 7, the FBI Director, James Comey, indicated that the tool had cost more than $1.3 million and the Washington Post reported, from an anonymous source, that the FBI had paid professional hackers which used a zero-day vulnerability to bypass the 10 PIN attempt limitation, allowing the FBI to brute force the four-digit PIN without the risk of wiping the device (<a class="ulink" href="https://www.washingtonpost.com/world/national-security/fbi-paid-professional-hackers-one-time-fee-to-crack-san-bernardino-iphone/2016/04/12/5397814a-00de-11e6-9d36-33d198ea26c5_story.html">https://www.washingtonpost.com/world/national-security/fbi-paid-professional-hackers-one-time-fee-to-crack-san-bernardino-iphone/2016/04/12/5397814a-00de-11e6-9d36-33d198ea26c5_story.html</a>).</p><p>Leaving out the legal and ethical aspects, there are still a few things worth considering. First of all, it is clear that, technically speaking, Apple would have been able to comply with the court order, but as the last point on the resolution proves, there were other ways to obtain the result. Another point to highlight is that the only reason the FBI was able to make such a request is because the user had chosen a weak four-digit PIN. If he had picked a complex passcode instead, it would have been unfeasible to brute force it even without the 10 attempts limitation due to the password derivation function used by Apple (<code class="literal">PBKDF2</code>), in which the encryption routines implement an 80 ms delay to compute the key, resulting in six years just to brute force a six-digit alphanumeric key, and as an obvious consequence, exponentially more time for longer keys.</p><p>Last but not least, there was one big mistake made by the FBI from a forensics point of view. As soon as the iPhone had been recovered, the FBI made the San Bernardino County (which was the legal owner of the phone) reset the iCloud password. If the iPhone had really been found switched off, this would not have made difference since, in order to connect to a Wi-Fi network, a valid access code was required to be entered at least once after reboot. However, if the phone was found powered on, as it may look like from conflicting statements and testimonies, resetting the password made the automatic iCloud backup unfeasible as the iCloud password on the phone would still have been the old (at this point invalid) one.</p><p>Finally, this has definitely been a controversial case for different reasons, but nevertheless an interesting case study to learn from.</p></div></div>
<div class="section" title="iOS Acquisition&#xA0;-&#xA0;choose the best method"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec32"/>iOS Acquisition - choose the best method</h1></div></div></div><p>As you may have probably understood from reading this chapter, being able to choose the right technique to acquire an iOS device is not trivial and it depends on many different parameters. In this section we try to list, for each of the different device families, the best acquisition method available depending on the different versions of the operating system and whether a passcode is set or not.</p><div class="section" title="iPhone 3G/3GS/4, iPad 1"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec24"/>iPhone 3G/3GS/4, iPad 1</h2></div></div></div><p>For these devices, it is always advisable to perform a physical acquisition using one of the forensic software that supports it. If a simple passcode is set (four digits), it is always possible to crack it in a short time, and therefore obtain a forensic image of the device's internal memory (both data and system partitions). In the case of a complex passcode being set, it is possible to obtain a physical acquisition, although not all files in it will be decrypted.</p></div><div class="section" title="iPhone 4s, 5, 5c, iPad 2/3/4, iPad Mini 1"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec25"/>iPhone 4s, 5, 5c, iPad 2/3/4, iPad Mini 1</h2></div></div></div><p>For these devices, we must distinguish according to the presence of the passcode and the operating system version.</p><p>In the case of devices with no passcode, it is always possible to carry out the acquisition via the AFC protocol (with varying results depending on the operating system version, but always with the ability to extract the Crash Logs) and via iTunes backup</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note9"/>Note</h3><p>The user may have set a password on the backup and such a password can be cracked offline as described in <a class="link" href="ch04.html" title="Chapter 4. Evidence Acquisition and Analysis from iTunes Backup">Chapter 4</a>, <span class="emphasis"><em>Evidence Acquisition and Analysis from iTunes Backup</em></span>.</p></div></div><p>On devices with iOS 7, it is also possible to acquire via advanced logical.</p><p>In the case of devices protected by passcode, we have several techniques depending on the operating system version. Until iOS 7, you can do the following: use a lockdown certificate to carry out the acquisition directly (via AFC, advanced logical, or Backup), use the Apple service in support of law enforcement, use the CAIS service offered by Cellebrite, use a hardware tool to unlock the device (for example, IP-BOX) or detect the presence of an iCloud backup (refer to <a class="link" href="ch05.html" title="Chapter 5. Evidence Acquisition and Analysis from iCloud">Chapter 5</a>, <span class="emphasis"><em>Evidence Acquisition and Analysis from iCloud</em></span> for details). Starting from iOS 8, it is no longer possible to get support from Apple, while you still can, with certain limitations, use the lockdown certificate (only for backup and AFC acquisitions, and only if the phone was found switched on and unlocked at least once in the past 48 hours) and hardware devices for unlocking (up to iOS 8.1). The use of CAIS service by Cellebrite and iCloud backup is also a viable option.</p></div><div class="section" title="iPhone 5s, 6, 6Plus, 6s, 6s Plus, iPad Air 1/2, iPad Mini 2/3/4, iPad Pro"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec26"/>iPhone 5s, 6, 6Plus, 6s, 6s Plus, iPad Air 1/2, iPad Mini 2/3/4, iPad Pro</h2></div></div></div><p>Similar to the previous section, an unlocked device can always be acquired via the AFC protocol and iTunes backup. For devices such as iPhone 5s, iPad Air, and iPad Mini 2 with iOS 7 it is also possible to acquire via advanced logical.</p><p>In the case of locked devices, we have to distinguish by device and operating system version.</p><p>For devices such as iPhone 5s, iPad Air, and iPad Mini 2 with iOS 7, it is possible to use the lockdown certificate, request support from Apple, or use unlocking hardware devices.</p><p>For all devices with iOS 8 or 9, the only practicable roads are using a valid lockdown certificate or acquiring iCloud backups.</p></div><div class="section" title="Apple TV"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec27"/>Apple TV</h2></div></div></div><p>The acquisition of data from Apple TV devices is particularly complex, as there are no available native backup procedures. Tests carried out by the authors on the Apple TV version 3 have allowed us to understand that the AFC protocol is active on the device. Since the device cannot be password protected, this method is always applicable.</p><p>The following screenshots show the general details extracted with the iTools software from an Apple TV version 3:</p><div class="mediaobject"><img src="graphics/image_03_054-1.jpg" alt="Apple TV"/></div><p>Real Time Log permits us to identify the latest activities performed by the device (that is, last days of activity, Wi-Fi connection, and so on).</p><div class="mediaobject"><img src="graphics/image_03_055-1.jpg" alt="Apple TV"/></div><p>With iTools, it is also possible to extract Crash Logs, which allow the reconstruction of a timeline of the device's usage.</p><div class="mediaobject"><img src="graphics/image_03_056-1.jpg" alt="Apple TV"/></div><p>Finally, it is also possible to extract a limited part of the filesystem containing, for example, the iTunes library, from which you can locate the account information used and the purchases made.</p><div class="mediaobject"><img src="graphics/image_03_057-1.jpg" alt="Apple TV"/></div></div><div class="section" title="Apple Watch"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec28"/>Apple Watch</h2></div></div></div><p>The acquisition of the Apple Watch data is still a little explored and tested area. Of particular interest is the presentation of Sarah Edwards and Heather Mahalik <span class="emphasis"><em>Times a' Ticking... to Forensicate the Apple Watch</em></span>, in 2015. The presentation shows the test results of the analysis of an iPhone backup device synchronized with an Apple Watch and the identification of different information of interest (information about the device, installed applications, address book, e-mails, voicemails, passbook, and so on)</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec33"/>Summary</h1></div></div></div><p>In this chapter, we introduced the four most commonly used methods to acquire data from iDevices-AFC, iTunes backup, advanced logical, and physical. The backup acquisition can be performed on any device but the device needs to be unlocked, the analyst needs to know the passcode, or the analyst has a valid lockdown certificate extracted from a computer the device was previously synced with. If the user sets a password on the backup, the resulting acquisition is encrypted and so the analyst needs to try cracking the backup password (this topic is covered in detail in <a class="link" href="ch04.html" title="Chapter 4. Evidence Acquisition and Analysis from iTunes Backup">Chapter 4</a>, <span class="emphasis"><em>Evidence Acquisition and Analysis from iTunes Backup</em></span>). If the device is locked and the analyst doesn't know the code, or he/she doesn't have a valid lockdown certificate, other techniques are available request Apple support (up to iOS 7), use a hardware unlocking tool (up to iOS 8.1), use a third-party service (up to iOS 9.3.2 and limited to 32-bit devices) or search for a backup on iCloud.</p><p>The advanced logical acquisition can be performed with the same conditions of the backup acquisition, but it can bypass the restrictions imposed by the backup password and extract the contents in clear text without the need to crack the backup password. Apple stopped this method from working starting from iOS 8.0.</p><p>Physical acquisition depends on the device and the operating system installed as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">iPhone 2G/3G/3GS and iPod touch 1/2 with iOS 3 don't implement encryption and so it is always possible to perform physical acquisition and the lock code can be cracked instantaneously. The resulting image is not encrypted. So, it is possible to carve deleted records.</li><li class="listitem" style="list-style-type: disc">On iPhone 3GS/4, iPad 1, and iPod touch 3/4 with iOS 4/5/6/7, it is always possible to perform physical acquisition. If the lock code is four digits long, it can be cracked in less than 20 minutes. So, it is possible to recover all the files. If a complex passcode is in use, the analyst can try to crack it with a brute force or dictionary attack. If it's not possible to crack it, it is possible to perform physical acquisition, and decode the filesystem (with the extracted filesystem key) and all the files whose encryption does not depend on passcode.</li><li class="listitem" style="list-style-type: disc">On iPhone 4s/5/5c, iPad2/3/4, iPad mini 1, and iPod touch 5 with iOS 4/5/6/7/8/9, physical acquisition is possible only if the device is already jailbroken or if it is possible to jailbreak it (this means that the analyst must know the code).</li><li class="listitem" style="list-style-type: disc">On iPhone 5s/6/6 Plus/6s/6s Plus, iPad Air 1/2, iPad mini 2/3/4, and iPad Pro, it is not currently possible to perform a physical acquisition although there are studies and research on it. If the device is jailbroken it is possible, to extract a full filesystem dump.</li></ul></div><p>In <a class="link" href="ch04.html" title="Chapter 4. Evidence Acquisition and Analysis from iTunes Backup">Chapter 4</a>, <span class="emphasis"><em>Evidence Acquisition and Analysis from iTunes Backup</em></span>, we will see how to acquire and analyze forensics evidences in the case of an iTunes Backup.</p></div>
<div class="section" title="Self-test questions"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec34"/>Self-test questions</h1></div></div></div><p>Q1. What is the mode in which iOS devices operate to upgrade the operating system called?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Normal</li><li class="listitem">Recovery</li><li class="listitem">Device Firmware Upgrade</li><li class="listitem">Update</li></ol></div><p>Q2. Where are the lockdown certificates stored on Windows 7/8?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem"><code class="literal">C:\Program Data\Apple\Lockdown</code></li><li class="listitem"><code class="literal">C:\Users\[username]\AppData\Roaming\Apple Computer\Lockdown</code></li><li class="listitem"><code class="literal">C:\Users\[username]\AppData\Local\Apple Computer\Lockdown</code></li><li class="listitem"><code class="literal">C:\Windows\Apple Computer\Lockdown</code></li></ol></div><p>Q3. Which of the following tools can be used to perform physical acquisition of a jailbroken iPhone 4s?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">iOS Forensic Toolkit</li><li class="listitem">Oxygen Forensics Suite</li><li class="listitem">Cellebrite UFED Touch</li><li class="listitem">Mobile Phone Examiner</li></ol></div><p>Q4. What is the latest iPhone model that can be physically acquired even if it is not jailbroken?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">iPhone 3GS</li><li class="listitem">iPhone 4</li><li class="listitem">iPhone 5</li><li class="listitem">iPhone 6</li></ol></div><p>Q5. What is the device identifier for iOS devices called?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">ECID</li><li class="listitem">UDID</li><li class="listitem">Serial Number</li><li class="listitem">MAC Address</li></ol></div></div></body></html>