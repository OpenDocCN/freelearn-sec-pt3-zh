- en: Windows Drive Acquisition
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following recipes:'
  prefs: []
  type: TYPE_NORMAL
- en: Drive acquisition in E01 format with FTK Imager
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Drive acquisition in RAW format with dc3dd
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mounting forensic images with Arsenal Image Mounter
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Before you can begin analysing evidence from a source, it first of all needs
    to be imaged. This describes a forensic process in which an exact copy of a drive
    is made. This is an important step, especially if evidence needs to be taken to
    court, because forensic investigators must be able to demonstrate that they have
    not altered the evidence in any way.
  prefs: []
  type: TYPE_NORMAL
- en: The term *forensic image* can refer to either a physical or a logical image.
    Physical images are precise replicas of the drives they reference, whereas a logical
    image is a copy of a certain volume within that drive. In general, logical images
    show what the machineâ€™s user will have seen and dealt with, whereas physical images
    give a more comprehensive overview of how the device works at a higher level.
  prefs: []
  type: TYPE_NORMAL
- en: A *hash value* is generated to verify the authenticity of the acquired image.
    Hash values are essentially cryptographic digital fingerprints which show whether
    a particular item is an exact copy of another. Altering even the smallest bit
    of data will generate a completely new hash value, thus demonstrating that the
    two items are not the same. When a forensic investigator images a drive, they
    should generate a hash value for both the original drive and the acquired image.
    Some pieces of forensic software will do this for you.
  prefs: []
  type: TYPE_NORMAL
- en: There are a number of tools available for imaging hard drives, some of which
    are free and open source. However, the most popular way for forensic analysts
    to image hard drives is by using one of the more well-known forensic software
    vendors' solutions. This is because it is imperative to be able to explain how
    the image was acquired and its integrity, especially if you are working on a case
    that will be taken to court.
  prefs: []
  type: TYPE_NORMAL
- en: Once you have your image, you will then be able to analyze the digital evidence
    from a device without directly interfering with the device itself.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we will be looking at various tools that can help you to image
    a Windows drive, and taking you through the process of acquisition.
  prefs: []
  type: TYPE_NORMAL
- en: Drive acquisition in E01 format with FTK Imager
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: FTK Imager is an imaging and data preview tool by AccessData which allows an
    examiner not only to create forensic images in different formats, including RAW,
    SMART, E01, and AFF, but also to preview data sources in a forensically sound
    manner. In the first recipe of this chapter, we will show you how to create a
    forensic image of a hard drive from a Windows system in E01 format.
  prefs: []
  type: TYPE_NORMAL
- en: E01 or EnCase's Evidence File is a standard format for forensic images in law
    enforcement. Such images consist of a header with case info, including acquisition
    date and time, examiner's name, acquisition notes, and password (optional), a
    bit-by-bit copy of an acquired drive (consisting of data blocks, verified with
    its own CRC or Cyclical Redundancy Check), and a footer with MD5 hash for the
    bitstream.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: First of all, let's download **FTK Imager** from AccessData's website. To do
    this, go to the Products and Services tab, and after that, to Product Downloads.
    Now choose DIGITAL FORENSICS, and then FTK Imager. At the time of writing, the
    most up-to-date version is 3.4.3, so click the green DOWNLOAD PAGE button on the
    right. Now you should be able to see the download page. Click on DOWNLOAD NOW
    and fill in the form. After this, the download link will be sent to the email
    address that you provided.
  prefs: []
  type: TYPE_NORMAL
- en: The installation process is quite straightforward; all you need to do is just
    click Next a few times, so we won't cover it in the recipe.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'There are two ways of initiating the drive imaging process:'
  prefs: []
  type: TYPE_NORMAL
- en: Using the Create Disk Image button from the toolbar (Figure 3.1)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/0c215dce-4ac6-4b97-92e8-83ba8ed40d3d.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 3.1\. Create Disk Image button on the toolbar
  prefs: []
  type: TYPE_NORMAL
- en: Using the Create Disk Image... option from the File menu (Figure 3.2)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b4a72003-bff9-47c4-89dc-842ff85da717.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 3.2\. Create Disk Image... option in the File Menu
  prefs: []
  type: TYPE_NORMAL
- en: You can choose whichever option you prefer.
  prefs: []
  type: TYPE_NORMAL
- en: 'The first window you see is Select Source. Here, you have five options:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Physical Drive**: This allows you to choose a physical drive as the source,
    with all partitions and unallocated space.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Logical Drive**: This allows you to choose a logical drive as the source,
    for example `E:\ drive`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Image File**: This allows you to choose an image file as the source, for
    example, if you need to convert your forensic image from one format to another.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Contents of a Folder**: This allows you to choose a folder as the source.
    Of course, no deleted files will be included.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Fernico Device**: This allows you to restore images from multiple CD/DVDs.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Of course we want to image the whole drive to be able to work with deleted
    data and unallocated space, so:'
  prefs: []
  type: TYPE_NORMAL
- en: Let's choose the Physical Drive option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The evidence source mustn't be altered in any way, so make sure you are using
    a hardware write blocker. You can use the one from Tableau, for example. These
    devices allow acquisition of drive contents without creating the possibility of
    modifying the data.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/75543208-243e-4fcc-b45e-936e516dbc78.png)*Figure 3.3\. FTK Imager Select
    Source window*'
  prefs: []
  type: TYPE_NORMAL
- en: Click Next and you'll see the next window - Select Drive.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now you should choose the source drive from the drop-down menu, in our case
    it's **\\.\PHYSICALDRIVE2**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d4acb6e1-9631-4493-8bc3-3268c9718bff.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 3.4\. FTK Imager Select Drive window
  prefs: []
  type: TYPE_NORMAL
- en: Now that the source drive has been chosen, click Finish.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The next window is - Create Image. We'll get back to this window soon, but for
    now, just click Add...
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: It's time to choose the destination image type. As we decided to create our
    image in EnCase's Evidence File format, let's choose E01.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/120a8641-19a7-49d8-8261-b015321ea3e2.png)*Figure 3.5\. FTK Imager Select
    Image Type window*'
  prefs: []
  type: TYPE_NORMAL
- en: Click Next and you'll see the Evidence Item Information window.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Here, we have five fields to fill in: Case Number, Evidence Number, Unique
    Description, Examiner, and Notes. All fields are optional.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/a692c888-f994-4461-9315-92c67af89c30.png)**Figure 3.6\. FTK Imager
    Evidence Item Information window**'
  prefs: []
  type: TYPE_NORMAL
- en: Fill in the fields, or skip them if you prefer, then click **Next**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now choose the image destination. You can use the Browse button for this.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Also, you should fill in the image filename.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you want your forensic image to be split, choose a fragment size (in megabytes).
    E01 format supports compression, so if you want to reduce the image size, you
    can use this feature. As you can see in figure 3.7, we have chosen 6\. And if
    you want the data in the image to be secured, use the AD Encryption feature.
  prefs: []
  type: TYPE_NORMAL
- en: AD Encryption is a whole image encryption, so not only is the raw data encrypted,
    but so is any metadata. Each segment or file of the image is encrypted with a
    randomly generated image key using AES-256.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/21d3a62b-600c-437b-917f-b8366c91e4bb.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 3.7\. FTK Imager Select Image Destination window
  prefs: []
  type: TYPE_NORMAL
- en: We are almost done.
  prefs: []
  type: TYPE_NORMAL
- en: Click **Finish** and you'll see the Create Image window again.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now look at the three options at the bottom of the window.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The verification process is very important, so make sure the Verify images
    after they are created option is ticked; it helps you to be sure that the source
    and the image are equal. The Precalculate Progress Statistics option is also very
    useful: it will show you the estimated time of arrival during the imaging process.
    The last option will create directory listings of all files in the image for you,
    but of course, it takes time, so use it only if you need to.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/c2ab361d-0aca-43b1-8a0c-243b3fe3b5a3.png)*Figure 3.8\. FTK Imager Create
    Image window*'
  prefs: []
  type: TYPE_NORMAL
- en: All you need to do now is click Start.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Great, the imaging process has been started! Once the image has been created,
    the verification process starts.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, you'll get a Drive/Image Verify Results window, like the one shown
    in figure 3.9.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/de1a5368-5039-4e88-82ee-a2bd14f8451e.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 3.9\. FTK Imager Drive/Image Verify Results window
  prefs: []
  type: TYPE_NORMAL
- en: 'As you can see, in our case the source and the image are identical: both hashes
    matched. In the folder with the image, you will also find an info file with valuable
    information such as the drive model, serial number, source data size, sector count,
    MD5 and SHA1 checksums, and so on.'
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: FTK Imager uses the physical drive of your choice as the source and creates
    a bit-by-bit image of it in EnCase's Evidence File format. During the verification
    process, MD5 and SHA1 hashes of the image and the source are compared.
  prefs: []
  type: TYPE_NORMAL
- en: See more
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The FTK Imager download page:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://accessdata.com/product-download/digital-forensics/ftk-imager-version-3.4.3](http://accessdata.com/product-download/digital-forensics/ftk-imager-version-3.4.3)'
  prefs: []
  type: TYPE_NORMAL
- en: 'The FTK Imager User Guide:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://ad-pdf.s3.amazonaws.com/Imager/3_4_3/FTKImager_UG.pdf](https://ad-pdf.s3.amazonaws.com/Imager/3_4_3/FTKImager_UG.pdf)'
  prefs: []
  type: TYPE_NORMAL
- en: Drive acquisition in RAW format with dc3dd
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: DC3DD (by Jesse Kornblum) is a patched version of the classic GNU dd utility
    with some computer forensics features. For example, the fly hashing with a number
    of algorithms, such as MD5, SHA-1, SHA-256, and SHA-512, showing the progress
    of the acquisition process, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can find a compiled standalone version of DC3DD for Windows at SourceForge.
    Just download the ZIP or 7z archive, unpack it, and you are ready to go.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The steps for drive acquisition in RAW format using dc3dd are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Open Windows Command Prompt, change directory (you can use **cd** command to
    do it) to the one with `dc3dd.exe`, and type the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Press *Enter* and the acquisition process will start.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Of course, your command will be a bit different, so let''s find out what each
    part of it means:'
  prefs: []
  type: TYPE_NORMAL
- en: '**if** - stands for input file. Originally, dd was a Linux utility, and in
    case you didn''t know, everything is a file in Linux. As you can see in our command,
    we put the physical drive 2 here (this is the drive we wanted to image, but in
    your case it may be another drive, depending on the number of drives connected
    to your workstation).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**of** - stands for output file. Here, you should type the destination of your
    image in RAW format. In our case, it''s `X:\ drive` and `147-2017.dd` file.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**hash** - as has already been said, DC3DD supports four hashing algorithms:
    MD5, SHA-1, SHA-256, and SHA-512\. We chose SHA-256, but you can choose whichever
    one you like.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**log** - here, you should type the destination for the logs. You will find
    the image version, image hash, and so on in this file once acquisition is completed.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: DC3DD creates a bit-by-bit image of the source drive in RAW format, so the size
    of the image will be the same as the source, and it calculates the image hash
    using an algorithm of the examiner's choice, in our case SHA-256.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The DC3DD download page:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://sourceforge.net/projects/dc3dd/files/dc3dd/7.2%20-%20Windows/](https://sourceforge.net/projects/dc3dd/files/dc3dd/7.2%20-%20Windows/)'
  prefs: []
  type: TYPE_NORMAL
- en: Mounting forensic images with Arsenal Image Mounter
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Arsenal Image Mounter is an open source tool developed by Arsenal Recon. It
    can help a digital forensic examiner to mount a forensic image or virtual machine
    disk in Windows. It supports both E01 (and EX01) and RAW forensic images, so you
    can use it with any of the images we created in the previous recipes.
  prefs: []
  type: TYPE_NORMAL
- en: 'It''s very important to note that Arsenal Image Mounter mounts the contents
    of disk images as complete disks. The tool supports all file systems you can find
    on Windows drives: NTFS, ReFS, FAT32, and exFAT. Also, it has temporary write
    support for images, which is a very useful feature, for example, if you want to
    boot the system from the image you are examining.'
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Go to the Arsenal Image Mounter web page on the Arsenal Recon website and click
    on the download button to download the ZIP archive. At the time of writing, the
    latest version of the tool is 2.0.010, so in our case, the archive has the name
    **Arsenal_Image_Mounter_v2.0.010.0_x64.zip**. Extract it to a location of your
    choice and you are ready to go, no installation is required.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There two ways to choose an image for mounting in Arsenal Image Mounter.
  prefs: []
  type: TYPE_NORMAL
- en: You can use the File menu (and choose **Mount image...**) or
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Mount image button, as shown in figure 3.10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/7a959659-7f41-48b3-a2e3-bf12ddae565f.png)*Figure 3.10\. Arsenal Image
    Mounter main window*'
  prefs: []
  type: TYPE_NORMAL
- en: When you choose the Mount image... option from the File menu or click on the
    Mount image button, the Open window will pop up - here you should choose an image
    for mounting.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The next window you will see is Mount options, like the one in figure 3.11.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/207a9009-a7e5-4c46-ab17-4849c6af0406.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 3.11\. *Arsenal Image Mounter Mount options window*
  prefs: []
  type: TYPE_NORMAL
- en: 'As you can see, there are a few options here:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Read only** - if you choose this option, the image is mounted in read-only
    mode, so no write operations are allowed. (Do you still remember that you mustn''t
    alter the evidence in any way? Of course, it''s already an image, not the original
    drive, but nevertheless.)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Fake disk signature** - if an all-zero disk signature is found on the image,
    Arsenal Image Mounter reports a random disk signature to Windows, so it''s mounted
    properly.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Write temporary** - if you choose this option, the image is mounted in read-write
    mode, but all modifications are written not in the original image file, but to
    a temporary differential file instead.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Write original** - again, this option mounts the image in read-write mode,
    but this time the original image file will be modified.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Sector size** - this option allows you to choose the sector size.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create "removable" disk device - this option emulates the attachment of a USB
    thumb drive.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Choose the options you think you need and click OK.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We decided to mount our image as Read Only. Now you can see a hard drive icon
    on the main window of the tool - the image is mounted.
  prefs: []
  type: TYPE_NORMAL
- en: If you mounted only one image and want to unmount it, select the image and click
    on Remove selected. If you have a few mounted images and want to unmount all of
    them, click on the Remove all button.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Arsenal Image Mounter mounts forensic images or virtual machine disks as complete
    disks in read-only or read-write mode. Later, a digital forensics examiner can
    access their contents even with Windows Explorer.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The Arsenal Image Mounter page on the Arsenal Recon website: [https://arsenalrecon.com/apps/image-mounter/](https://arsenalrecon.com/apps/image-mounter/)'
  prefs: []
  type: TYPE_NORMAL
