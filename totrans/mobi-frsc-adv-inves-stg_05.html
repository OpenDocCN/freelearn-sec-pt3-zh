<html><head></head><body>

  <div class="chapter" title="Chapter 5. iOS &#x2013; Introduction and Physical Acquisition">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch05"/>Chapter 5. iOS – Introduction and Physical Acquisition</h1>

        </div>

      </div>

    </div>

    <p>It was in January 2007 that Apple released the first version of the iPhone. Since then, the global smartphone market has never been the same.</p>

    <p>With the advent of Android devices, the relative share of iOS-based mobile phones has been declining steadily over the years. With iPhone accounting for nearly 14% of all smartphones sold in Q2 2015 (according to <a class="ulink" href="http://www.idc.com/prodserv/smartphone-os-market-share.jsp">http://www.idc.com/prodserv/smartphone-os-market-share.jsp</a>), the rest of the market is dominated by Android.</p>

    <p>In absolute terms, there are still a lot of old iOS devices around. Approximately 74.4 million iPhones were sold during Q1 2015 alone.</p>

    <p>In the U.S., iPhones account for 35.58% of the subscriber base in Q3 2015 (source: <a class="ulink" href="http://bgr.com/2015/10/01/iphone-market-share-q3-2015-android/">http://bgr.com/2015/10/01/iphone-market-share-q3-2015-android/</a>). With that many iOS smartphones used throughout the U.S., the need for iOS forensics remains strong.</p>

    <p>In this chapter, we will discuss the options available for acquiring information from iOS devices. We will also discuss physical acquisition in detail, discussing the tools and practical steps required to perform physical acquisition. In this chapter, we will cover the following topics:</p>

    <div class="itemizedlist">

      <ul class="itemizedlist">

        <li class="listitem" style="list-style-type: disc">Security implications of Apple iOS and how they affect available acquisition options</li>

        <li class="listitem" style="list-style-type: disc">Generations of Apple hardware and the difference between legacy, recent 32-bit, and modern 64-bit devices</li>

        <li class="listitem" style="list-style-type: disc">The need for jailbreak</li>

        <li class="listitem" style="list-style-type: disc">Different iOS acquisition methods and when to use them</li>

        <li class="listitem" style="list-style-type: disc">Physical acquisition in detail—tools, techniques, and practical steps</li>

      </ul>

    </div>

    <div class="section" title="iOS forensics – introduction">

      <div class="titlepage">

        <div>

          <div>

            <h1 class="title" id="toc_1"><a id="ch05lvl1sec26"/>iOS forensics – introduction</h1>

          </div>

        </div>

      </div>

      <p>Different devices require different acquisition techniques. The different versions of iOS require different acquisition paths, each having its own vector of attack. While in Apple's sector, we don't nearly see such a wide diversity of devices and heavily-customized versions of the operating system (each with its own vulnerabilities), there are still a lot of devices available.</p>

      <div class="section" title="Generations of Apple hardware">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_2"><a id="ch05lvl2sec44"/>Generations of Apple hardware</h2>

            </div>

          </div>

        </div>

        <p>iOS is a closed operating system that's only supported on Apple-manufactured hardware. As a result, we don't have to deal with a dozen different manufacturers and thousands of models. By Q2 2015, Apple had released ten iPhone models, five models of iPod Touch, six full-size iPads, and three models of iPad mini.</p>

        <p>While general information and up-to-date specifications of Apple hardware can be viewed at <a class="ulink" href="https://en.wikipedia.org/wiki/List_of_iOS_devices">https://en.wikipedia.org/wiki/List_of_iOS_devices</a> , there are several things not mentioned in the official specs that can make the device more or less susceptible to physical acquisition.</p>

        <p>Early generations of Apple devices had a vulnerability in Trusted Boot, allowing attackers to bypass signature verification while booting in the DFU mode. As the signature-verification code was located in device's read-only memory, Apple was never able to patch this vulnerability in existing devices. This vulnerability allowed mobile forensic specialists to create tools for unconditional, always-working physical acquisition of susceptible iOS devices (for example, Elcomsoft iOS Forensic Toolkit at <a class="ulink" href="https://www.elcomsoft.com/eift.html">https://www.elcomsoft.com/eift.html</a>).</p>

        <div class="note" title="Note" style="">

          <div class="inner">

            <h3 class="title" id="toc_3"><a id="tip27"/>Tip</h3>

            <p>Unconditional physical acquisition regardless of iOS version and jailbreak status is available on iPhone 3G, 3GS, and 4; iPod Touch 1st through 4th gen; and the original iPad.</p>

          </div>

        </div>

        <p>In newer generations of hardware, Apple fixed the vulnerability, making physical acquisition a much more complicated process.</p>

        <p>As a result, devices using 32-bit processors, including iPhone 4S, iPhone 5, iPhone 5C, iPad 2+, iPad Mini, and iPod Touch 5th gen can only be acquired if jailbroken (either by the user or by the investigator, if the passcode is known).</p>

        <p>What about Apple's newest generation devices using 64-bit chipsets? Physical acquisition is available for all 64-bit Apple devices, such as iPhone 5S, iPhone 6, and iPhone 6 Plus; iPad 2 and newer; iPad Air and Air 2; and iPad Mini 2 and 3, using Elcomsoft iOS Forensic Toolkit. The acquisition process requires a jailbroken device; the passcode must be known and must be removed in the device's <span class="strong"><strong>Security</strong></span> settings prior to the acquisition.</p>

        <p>How likely are you to encounter a 32-bit Apple device? While there are no direct statistics about how many devices of each generation are still in active use, we can estimate these numbers by looking at the official iOS version stats. While Apple is known to deliver updates to the latest iOS and even to the old versions of their products, these devices have limited capabilities and timeframe during which they may receive updates. As a result, the latest version of iOS supported on iPhone 4, for example, was iOS 7.1.2; while all newer devices support iOS 8.</p>

        <p>By February 2016, Apple claimed (<a class="ulink" href="https://developer.apple.com/support/app-store/">https://developer.apple.com/support/appstore/</a>) that around 76% of its users will have already upgraded to iOS 9. Approximately 17% of Apple users use iOS 8, while earlier versions represent only 7% of Apple's user base.</p>

        <p>In terms of hardware, this means that early generation devices such as iPhone, iPhone 3G, and 3GS are only marginally represented (2% market share). Since iPhone 4 supports iOS 7.x, it can be counted as part of the 7% group (using iOS 7). Most iPhones, however, are using iOS 9 (76%) or iOS 8 (17%), which means that they are iPhone 4S, 5, 5C, 5S, 6, and 6 Plus.</p>

      </div>

      <div class="section" title="Is jailbreak required?">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_4"><a id="ch05lvl2sec45"/>Is jailbreak required?</h2>

            </div>

          </div>

        </div>

        <p>As physical acquisition requires low-level access to the data partition, physical acquisition is only possible on jailbroken iOS devices. Other acquisition methods, for example, logical and over-the-air acquisition do not require a jailbreak.</p>

      </div>

      <div class="section" title="Geolocation information">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_5"><a id="ch05lvl2sec46"/>Geolocation information</h2>

            </div>

          </div>

        </div>

        <p>It's no news that iOS devices equipped with cellular modules periodically collect and store geolocation information. iOS devices are capable of capturing information about nearby cellular towers and Wi-Fi access points in range, even if the device is not connected to them. This information is stored in plain unencrypted form in a <code class="literal">cache_encryptedA.db</code> file. The file keeps tracking information about cellular towers and Wi-Fi networks in range for up to 45 days. The official Apple statement says:</p>

        <div class="blockquote">

          <blockquote class="blockquote">

            <p> <span class="emphasis"><em>The iPhone is not logging your location. Rather, it's maintaining a database of Wi-Fi hotspots and cell towers around your current location, some of which may be located more than one hundred miles away from your iPhone, to help your iPhone rapidly and accurately calculate its location when requested. Calculating a phone's location using just GPS satellite data can take up to several minutes. iPhone can reduce this time to just a few seconds by using Wi-Fi hotspot and cell tower data to quickly find GPS satellites, and even triangulate its location using just Wi-Fi hotspot and cell tower data when GPS is not available (such as indoors or in basements). These calculations are performed live on the iPhone using a crowd-sourced database of Wi-Fi hotspot and cell tower data that is generated by tens of millions of iPhones sending the geo-tagged locations of nearby Wi-Fi hotspots and cell towers in an anonymous and encrypted form to Apple.</em></span> </p>

          </blockquote>

        </div>

        <p>Notably, the <code class="literal">cache_encryptedA.db</code> file is not stored in device backups, either cloud or made with iTunes. Since there is no end-user access to system files in Apple iOS, the device must be jailbroken in order to retrieve the file. Naturally, the <code class="literal">cache_encryptedA.db</code> is always retrieved as part of the physical acquisition process. Mobile forensic tools (for example, Oxygen Forensic Toolkit) can parse the file and display the user's tracking information as shown in the following image:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0065.jpeg" alt="Geolocation information"/>

        </div>

        <p> </p>

        <p> </p>

        <div class="mediaobject">

          <img src="0066.jpeg" alt="Geolocation information"/>

          <div class="caption">

            <p>Geolocation information</p>

          </div>

        </div>

        <p> </p>

        <p>The ability to extract geolocation information is one of the major benefits of physical acquisition over logical extraction. If physical acquisition is not available for a particular device, attempting a jailbreak and manually pulling <code class="literal">cache_encryptedA.db</code> will be worth the effort if you need access to the suspect's location history.</p>

        <p>Additional sources of geolocation history may also be available, including photo EXIF tags and application data (if geolocation was enabled and allowed by the user).</p>

      </div>

      <div class="section" title="Where is the information stored?">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_6"><a id="ch05lvl2sec47"/>Where is the information stored?</h2>

            </div>

          </div>

        </div>

        <p>Obviously, the phone itself is viewed as a primary source of data, and rightfully so. However, what if the phone is locked and the passcode is unknown? Also, what if you don't have the phone?</p>

        <p>Information collected by a smartphone is stored in (and can be retrieved from) numerous places. An Apple phone can back up its data to a PC via iTunes or to Apple's own cloud service (iCloud/iCloud Drive) via Wi-Fi. As a result, you may be dealing with a set of backup files (with or without a password), or just have a computer that does not have a single backup file, but was used to sync with iCloud.</p>

        <p>Sometimes you'll have it all: a phone, set of offline backups, and computer in sync with iCloud. More often than not, you're going to need information right away, or <span class="emphasis"><em>the sooner the better</em></span>. What is the optimal route for getting as much information as possible in the shortest time? The answer depends on what exactly do you have on your hands.</p>

      </div>

      <div class="section" title="iOS acquisition methods overview">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_7"><a id="ch05lvl2sec48"/>iOS acquisition methods overview</h2>

            </div>

          </div>

        </div>

        <p>While different methods exist to help extract the content of mobile devices, the choice of one or another method will usually depend on what you have available. Do you have a working iPhone? You can try physical acquisition, but only if the device falls within the compatibility matrix. Do you have access to the computer that was used to sync with the phone? Search for mobile backups. If you can find an iTunes backup, you can use logical acquisition to break into the backup and extract information. Was that computer used to sync with iCloud? Look for the iCloud authentication token. If found, the token can be used to connect to the user's iCloud account on bypassing the login and password. Do you happen to know the user's Apple ID, BlackBerry ID, or Windows Live account and password? Cloud forensics will help you download data from the cloud.</p>

        <p>To choose an acquisition method, refer to the following table:</p>

        <div class="informaltable">

          <table border="1"><colgroup><col/><col/><col/><col/></colgroup><tbody><tr><td> <p> <span class="strong"><strong>I have...</strong></span> </p> </td><td> <p> <span class="strong"><strong>Physical acquisition</strong></span> </p> </td><td> <p> <span class="strong"><strong>Logical acquisition (backup analysis)</strong></span> </p> </td><td> <p> <span class="strong"><strong>Cloud forensics</strong></span> </p> </td></tr><tr><td> <p>Physical device (iPhone, iPad, or iPod Touch)</p> </td><td> <p>YES*</p> </td><td> <p>MAYBE</p> </td><td> <p>MAYBE</p> </td></tr><tr><td> <p>Computer that was synced with (or trusted by) the phone/tablet</p> </td><td> <p>N/A</p> </td><td> <p>N/A</p> </td><td> <p>MAYBE</p> </td></tr><tr><td> <p>The iOS device and the computer that it was synced with (or trusted by)</p> </td><td> <p>N/A</p> </td><td> <p>MAYBE*****</p> </td><td> <p>MAYBE</p> </td></tr><tr><td> <p>iTunes backup</p> </td><td> <p>N/A</p> </td><td> <p>YES**</p> </td><td> <p>MAYBE</p> </td></tr><tr><td> <p>Apple ID login and password</p> </td><td> <p>N/A</p> </td><td> <p>N/A</p> </td><td> <p>YES***</p> </td></tr><tr><td> <p>iCloud authentication token</p> </td><td> <p>N/A</p> </td><td> <p>N/A</p> </td><td> <p>YES****</p> </td></tr></tbody></table>

        </div>

        <p>*Physical acquisition is only available for certain devices. Refer to <a class="link" href="ch06.html" title="Chapter 6. iOS Logical and Cloud Acquisition">Chapter 6</a>, <span class="emphasis"><em>iOS Logical and Cloud Acquisition</em></span> for detailed compatibility matrix.</p>

        <p>**Certain backups may be protected with long, complex passwords. There is no guaranteed recovery timeframe or successful password recovery guarantee on password-protected backups.</p>

        <p>***Apple's two-factor authentication complicates things a little bit. If two-factor authentication is activated for a certain Apple ID, access to the secondary authentication unit (such as a trusted device, recovery key, or app-specific password) is required. Microsoft takes a similar approach to two-factor authentication. At this time, Elcomsoft products only support two-factor authentication for Apple devices.</p>

        <p>****Authentication tokens may have an expiration (depending on the iOS version). Their exact lifespan is currently not known. While we experienced some tokens extracted with the ATEX tool from the <span class="strong"><strong>Control Panel</strong></span> to expire in one hour (iOS 8.x, for cloud backups only), we did not have this experience in other cases. We are continuing extensive testing to find out. Notably, authentication tokens <span class="emphasis"><em>live</em></span> longer for cloud files. iOS 9 moved cloud backups to iCloud Drive; its authentication tokens currently don't have an expiration date (or have a very long lifespan). Finally, authentication tokens are invalidated when the user changes their account password or explicitly logs out from the cloud on a given computer.</p>

        <p>*****If you have a computer that was synced with the device and the iOS device itself, you may be able to extract the decryption key and force the device to make a backup, without even knowing the password. However, this is only possible if the iOS device was not rebooted after the last time it synced with the computer. Interestingly, even if automatic synchronization is not enabled on the iOS device, the device prompts whether to trust the computer after you plug it in. If the answer is <span class="emphasis"><em>yes</em></span>, a pair of cryptographic keys will be created (on the device and on the computer).</p>

      </div>

      <div class="section" title="iOS acquisition methods compared">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_8"><a id="ch05lvl2sec49"/>iOS acquisition methods compared</h2>

            </div>

          </div>

        </div>

        <p>In an unlikely event, if you possess the physical device, a copy of its offline backup, and the user's Apple ID/password (or a binary authentication token collected from the user's PC), which acquisition method should you choose?</p>

        <p>The answer depends on how quickly you need the data, and whether or not you require access to deleted files and the keychain. Physical acquisition is by far the best acquisition method—if your device is supported. Cloud acquisition can return current and past data, while the offline backup can be the easiest (if not password-protected) or the slowest (if password-protected) to recover.</p>

        <p>The different acquisition methods offer various benefits over one another.</p>

        <p>For iOS devices, physical acquisition is the method of choice if available (refer to the <span class="emphasis"><em>Compatibility matrix</em></span> section in the next chapter). Physical acquisition offers the following benefits:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">Access to complete information stored in the mobile device (if passcode is known or recovered)</li>

            <li class="listitem" style="list-style-type: disc">Guaranteed timeframe (if passcode is known or a four-digit passcode is used)</li>

            <li class="listitem" style="list-style-type: disc">Extremely high acquisition speed</li>

            <li class="listitem" style="list-style-type: disc">Potential access to certain deleted data (for example, contacts and messages) stored in SQLite databases</li>

            <li class="listitem" style="list-style-type: disc">Access to keychain information (if passcode is known or can be recovered)</li>

            <li class="listitem" style="list-style-type: disc">Access to up to 45 days of geolocation tracking data</li>

          </ul>

        </div>

        <p>Logical acquisition of iOS devices involves the analysis of offline backups produced by Apple iTunes. Logical acquisition offers the following benefits:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">Access to most information stored in the mobile device</li>

            <li class="listitem" style="list-style-type: disc">No guaranteed recovery timeframe for password-protected backups</li>

            <li class="listitem" style="list-style-type: disc">Potential access to certain deleted data (for example, contacts and messages) stored in SQLite databases</li>

            <li class="listitem" style="list-style-type: disc">Access to keychain information is possible (if a decryption key was extracted from the device via physical acquisition)</li>

            <li class="listitem" style="list-style-type: disc">Keychain data can be retrieved from password-protected backups</li>

            <li class="listitem" style="list-style-type: disc">Long complex password may altogether prevent the recovery</li>

          </ul>

        </div>

        <p>Cloud acquisition is available for mobile devices running Apple iOS, BlackBerry, and Windows Phone 8/8.1. Cloud acquisition offers the following benefits:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">Access to most information stored in the mobile device</li>

            <li class="listitem" style="list-style-type: disc">Access to certain files accessed from the device (but not actually stored in the device)</li>

            <li class="listitem" style="list-style-type: disc">Recovery time highly dependent on connection speed and available cloud throughput</li>

            <li class="listitem" style="list-style-type: disc">Potential access to certain deleted data (for example, contacts and messages) stored in SQLite databases</li>

            <li class="listitem" style="list-style-type: disc">iOS: Access to keychain information is possible if a decryption key was extracted from the device via physical acquisition</li>

            <li class="listitem" style="list-style-type: disc">iOS: Two-factor authentication may disallow cloud access even if login and password are known (can be bypassed if a valid, non-expired authentication token is available)</li>

          </ul>

        </div>

        <p>Finally, it is possible to perform chip-off acquisition by extracting data directly from the memory chips (special hardware and skills are required). Chip-off acquisition has the following properties:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">On older devices, it is possible to extract all information except encrypted (keychain).</li>

            <li class="listitem" style="list-style-type: disc">Recent generation iOS devices rely extensively on encrypted storage. As a result, most user data will remain encrypted with strong, non-extractable encryption keys.</li>

            <li class="listitem" style="list-style-type: disc">Guaranteed timeframe, but limited amount of accessible data.</li>

            <li class="listitem" style="list-style-type: disc">Extremely high acquisition speed.</li>

            <li class="listitem" style="list-style-type: disc">No access to keychain information or historical location data.</li>

          </ul>

        </div>

        <p>The following table summarizes the possible outcome of the various acquisition methods:</p>

        <div class="informaltable">

          <table border="1"><colgroup><col/><col/><col/><col/><col/></colgroup><tbody><tr><td> </td><td> <p> <span class="strong"><strong>Physical acquisition</strong></span> </p> </td><td> <p> <span class="strong"><strong>Logical acquisition</strong></span> </p> </td><td> <p> <span class="strong"><strong>Cloud forensics</strong></span> </p> </td><td> <p> <span class="strong"><strong>Chip-off</strong></span> </p> </td></tr><tr><td> <p>Approximate timeframe</p> </td><td> <p>35-50 minutes (depending on device model)</p> </td><td> <p> </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Instant (unprotected backups)</li><li class="listitem" style="list-style-type: disc">Unknown (password-protected)</li></ul></div><p> </p> </td><td> <p>0-4 hours (depending on connection speed and data volume)</p> </td><td> <p>1-4 hours (depending on skill level)</p> </td></tr><tr><td> <p>Keychain recovery</p> </td><td> <p>Yes</p> </td><td> <p> </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">No (unprotected backups), unless <span class="strong"><strong>securityd</strong></span> is available</li><li class="listitem" style="list-style-type: disc">Yes (password-protected)</li></ul></div><p> </p> </td><td> <p>No (unless securityd is available)</p> </td><td> <p>No</p> </td></tr><tr><td> <p>Access to deleted files</p> </td><td> <p>No*</p> </td><td> <p>No</p> </td><td> <p>No</p> </td><td> <p>No</p> </td></tr><tr><td> <p>Access to deleted SQLite records</p> </td><td> <p>Yes</p> </td><td> <p>Yes</p> </td><td> <p>Yes</p> </td><td> <p>Yes</p> </td></tr><tr><td> <p>Up to 45 days of geolocation tracking data</p> </td><td> <p>Yes</p> </td><td> <p>No</p> </td><td> <p>No</p> </td><td> <p>Yes</p> </td></tr><tr><td> <p>Possible issues</p> </td><td> <p>Last-generation devices must be jailbroken (refer to <span class="emphasis"><em>Compatibility matrix</em></span>)</p> </td><td> <p>Long and complex passwords may prevent the recovery</p> </td><td> <p> </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Apple ID/password or authentication token required</li><li class="listitem" style="list-style-type: disc">Two-factor authentication</li><li class="listitem" style="list-style-type: disc">Notification e-mail</li></ul></div><p> </p> </td><td> <p> </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Only for iOS 1 through 4</li><li class="listitem" style="list-style-type: disc">Recent devices use complete hardware encryption</li><li class="listitem" style="list-style-type: disc">Encrypted data non-recoverable and non-decryptable</li><li class="listitem" style="list-style-type: disc">Chip-off acquisition is <span class="emphasis"><em>not available</em></span> for recent iOS devices</li></ul></div><p> </p> </td></tr></tbody></table>

        </div>

        <p>*Accessing deleted files is possible for iOS 1.x through 3.x. However, the chances of encountering an iOS version that old are close to none.</p>

      </div>

      <div class="section" title="iOS advanced logical acquisition">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_9"><a id="ch05lvl2sec50"/>iOS advanced logical acquisition</h2>

            </div>

          </div>

        </div>

        <p>A while ago, a so-called advanced logical acquisition method was introduced by Jonathan Zdziarski. It was a very popular acquisition method while it lasted. The examiner still had to possess an unlocked device, but if this was the case, it was possible to obtain more information compared to pure logical acquisition (backup analysis).</p>

        <p>Compared to pure logical acquisition, advanced logical acquisition offered the following benefits:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">iTunes backup password could not stop accessing personal data such as contacts or text messages that were not protected with any password</li>

            <li class="listitem" style="list-style-type: disc">More application data, including log files, could be extracted</li>

          </ul>

        </div>

        <p>The method was short-lived as Apple patched the vulnerability used by this acquisition method by hiding the corresponding service. Since iOS 8, only app-shared documents (for example, documents edited by an office app or videos watched with a media player) can be extracted with this method.</p>

      </div>

      <div class="section" title="iOS physical acquisition">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_10"><a id="ch05lvl2sec51"/>iOS physical acquisition</h2>

            </div>

          </div>

        </div>

        <p>Physical acquisition is the most comprehensive acquisition method available for iOS devices. Other platforms (for example, Android, BlackBerry OS, BlackBerry 10, and Windows-based devices) can be acquired by one of the lower-level techniques, such as JTAG, ISP, or chip-off. These acquisition techniques are not available for iOS devices due to mandatory full-disk encryption that is enforced out of the box, regardless of whether the user sets up additional security. Physical acquisition returns significantly more information compared to any other method, such as logical acquisition or backup analysis. Data stored in Apple's protected storage, the keychain, is exclusively available via the physical process.</p>

        <p>Physical acquisition is very decisive: it either works or it doesn't. If it works, you can expect to image the entire device in under 40 minutes, even a 32-GB iPhone 4, which is among the slowest. Devices with larger storage can take longer; however, there is no uncertainty as in attempting to attack backup passwords. ElcomSoft developed a physical acquisition toolkit for iOS devices:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0067.jpeg" alt="iOS physical acquisition"/>

        </div>

        <p> </p>

        <p>Starting with the release of iPhone 4S, featuring stronger security compared to all legacy devices, physical acquisition became increasingly difficult for each new generation of iOS devices. Up to this day, physical acquisition support of newer iOS devices is only available in Elcomsoft iOS Forensic Toolkit.</p>

        <p>It is important to note that unrestricted, unlimited, and guaranteed physical acquisition is only available for older Apple devices (refer to the <span class="emphasis"><em>Compatibility matrix</em></span> section in the following chapter). Starting with iPhone 4S (or iPad 2), a successful physical acquisition requires the examiner to either know the user's original passcode (in order to install jailbreak) or have a jailbroken device. If a device is locked with a passcode, installing jailbreak is not possible, and the device cannot be acquired. In addition to jailbreak, an OpenSSH tool from Cydia must be installed.</p>

        <p>On jailbroken devices, Elcomsoft iOS Forensic Toolkit can break the original passcode with brute force or dictionary attack. Passcode recovery speed on jailbroken iPhone 5 and 5C devices is approximately 15.5 passcodes per second, allowing iOS Forensic Toolkit to break typical four-digit passcodes in about 10 minutes. However, one can easily dump the device even without the passcode; as a result, downloaded mail and keychain data will remain encrypted.</p>

        <p>On iOS devices equipped with a 64-bit platform and Secure Enclave, physical acquisition is even more limited. On such devices, one must know the passcode and be able to remove it from device settings (that's in addition to jailbreaking the device). Even then, keychain can be extracted, but it cannot be decrypted on 64-bit devices.</p>

      </div>

      <div class="section" title="Physical acquisition benefits">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_11"><a id="ch05lvl2sec52"/>Physical acquisition benefits</h2>

            </div>

          </div>

        </div>

        <p>Physical acquisition offers numerous benefits over other acquisition methods. Fixed timeframe and guaranteed delivery are just a few things to be mentioned.</p>

        <p>Physical acquisition offers the following benefits:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">Acquires complete bit-precise device images</li>

            <li class="listitem" style="list-style-type: disc">Unallocated space is extracted, but cannot be decrypted on recent versions of iOS</li>

            <li class="listitem" style="list-style-type: disc">Decrypts keychain items and extracts device keys</li>

            <li class="listitem" style="list-style-type: disc">Guaranteed timeframe: 20 to 50 minutes for 32 GB models</li>

            <li class="listitem" style="list-style-type: disc">Zero footprint</li>

            <li class="listitem" style="list-style-type: disc">Passcode not required (for older devices or if jailbreak is installed)</li>

            <li class="listitem" style="list-style-type: disc">Simple four-digit passcodes recovered in 10-40 minutes (for older or jailbroken devices)</li>

          </ul>

        </div>

        <p>Physical is the only acquisition method that can extract the following information:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Cached (downloaded) mail</strong></span>: Regardless of the type of e-mail account, cached mail is not available in offline or online backups. Downloaded mail can be also acquired via so-called <span class="emphasis"><em>advanced logical acquisition</em></span>, which exploits some undocumented iOS services and requires either a passcode or a pairing record from a trusted computer. Additionally, cached mail can be obtained via the 64-bit physical acquisition process.</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Geolocation data</strong></span>: While iTunes and iCloud backups contain only limited geolocation data (for example, extracted from geotagged images), physical acquisition can extract significantly more detail about the user's location. This includes frequent locations and location data requested by applications and system services on the device. Location data is requested (and stored) on certain events, such as using maps, calibrating the compass, ad tracking, browsing web pages, requesting the user's location, looking up wireless networks, and so on. By extracting location data with physical acquisition, one can reconstruct the suspect's whereabouts with a great deal of precision.</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>System logs and crash logs</strong></span>: This shows the applications launched or installed.</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Cached application data</strong></span>: This provides cached web pages, typed addresses, and any Web data that is cached by third-party apps. Many iOS apps are Web-based, so the amount of cached data available via physical acquisition can be overwhelming.</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Certain types of deleted data</strong></span>: This includes deleted contacts, text messages, and iMessages (can be also extracted from SQLite databases with logical acquisition).</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Keychain</strong></span>: In Apple devices, this protected storage is used to store highly sensitive information, such as passwords to websites and online accounts, financial information, and any data written to protected storage by third-party applications. With different classes of protection, only some keychain items can be decrypted when processing a backup. Physical acquisition allows decrypting the entire keychain, extracting all available information.</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Extended keychain acquisition</strong></span>: Apple changed the keychain format in iOS 7. In iOS 8, Apple moved a lot more data into the keychain. Since iOS 7, devices registered to a certain Apple ID may contain a cached copy of the iCloud keychain for that Apple account (subject to user authorization). If iCloud keychain is available, its extraction may enable access to passwords and credit card information stored in other Apple devices sharing the same Apple ID.</li>

          </ul>

        </div>

      </div>

      <div class="section" title="What's unique about physical acquisition?">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_12"><a id="ch05lvl2sec53"/>What's unique about physical acquisition?</h2>

            </div>

          </div>

        </div>

        <p>Is physical acquisition still worth the effort? Jailbroken iOS devices are rare in the wild. However, the possibility to jailbreak iOS devices is still there, especially considering the number of devices that have been collected as evidence are waiting for a long time. We still believe that physical is the way to go if it's available for a given device. Here are the reasons why:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">Apple has a new policy to <span class="strong"><strong>turn down</strong></span> government information requests for devices running iOS 8 or 9, Secure Enclave or not. Apple fiercely defends its policy. Handing over the device to Apple will no longer result in receiving its full image if the device is running iOS 8 and newer, even if Apple faces legal action (<a class="ulink" href="https://www.apple.com/privacy/government-information-requests/">https://www.apple.com/privacy/government-information-requests/</a>)</li>

            <li class="listitem" style="list-style-type: disc">In some regions, Apple runs certified refurbished programs, still selling refurbished 32-bit phones at a cheaper price. For example, refurbished iPhone 4S and 5 units accounted for as much as 46% of all iPhones sold through retail channels in Russia in Q1 2015.</li>

            <li class="listitem" style="list-style-type: disc">Physical acquisition still returns significantly more information compared to any other acquisition method (remember, chip-off is not available for Apple devices). E-mail messages, application data, logs, location, and a lot of other data never makes it into backups.</li>

            <li class="listitem" style="list-style-type: disc">Full keychain extraction is exclusive to physical acquisition (32-bit devices only). Decrypting the keychain is only possible on devices without Secure Enclave. This includes records encrypted with device-specific keys. While some keychain items can be extracted from password-protected iTunes backups, many items cannot be decrypted without a device-specific key.</li>

            <li class="listitem" style="list-style-type: disc">Physical acquisition (32-bit process) can help extract the securityd (0x835) key from the device. This key can be used for complete keychain decryption. Additionally, this very key can be used to decrypt keychain items from iCloud backups and local iTunes backups that are not encrypted with a password.</li>

            <li class="listitem" style="list-style-type: disc">Physical acquisition of 32-bit devices returns a standard DMG disk image (HFS+ filesystem), while the same process on 64-bit devices returns a TAR archive that contains the complete directory structure of the device.</li>

          </ul>

        </div>

        <p>As far as we know, Elcomsoft iOS Forensic Toolkit is the only non-Apple tool that can do physical acquisition of iPhone 4S, 5, and 5C, and especially the newer 64-bit devices.</p>

      </div>

      <div class="section" title="The future of physical acquisition">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_13"><a id="ch05lvl2sec54"/>The future of physical acquisition</h2>

            </div>

          </div>

        </div>

        <p>Unconditional physical acquisition is only supported for legacy devices. With every new iteration of iOS, and with every new hardware revision starting with iPhone 4S, Apple has been improving security, making physical acquisition increasingly difficult.</p>

        <p>The release of iOS 8 was an important benchmark, making physical acquisition even tougher. The following two major things have changed with iOS 8:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">All user data is now stored in a container encrypted with passcode-dependent keys</li>

            <li class="listitem" style="list-style-type: disc">A hardware-level five-second delay is added for passcode attempts (newer hardware only)</li>

          </ul>

        </div>

        <p>iOS 8 moved most user data under the stricter controls. Messages, photos, contacts, call logs, and many other things are now stored inside a passcode-protected container. Once the phone is rebooted, the decryption key is lost, and the data becomes unavailable until the user enters the correct passcode. However, if the device is unlocked at least once, most data (except for the keychain) is decrypted and remains decrypted until the device is powered off. This is exactly what's used by the 64-bit acquisition process.</p>

        <p>What about brute forcing the passcode? With A7- and A8-based devices (iPhone 5S, 6, and 6 Plus), Apple introduced a hardware-level five-second delay for passcode attempts. Here's what Apple has to say:</p>

        <div class="blockquote">

          <blockquote class="blockquote">

            <p> <span class="emphasis"><em>On a device with an A7 processor, the key operations are performed by the Secure Enclave, which also enforces a 5-second delay between repeated failed unlocking requests. This provides a governor against brute-force attacks in addition to safeguards enforced by iOS. (Source: <a class="ulink" href="https://www.apple.com/br/ipad/business/docs/iOS_Security_EN_Feb14.pdf">https://www.apple.com/br/ipad/business/docs/iOS_Security_EN_Feb14.pdf</a>.)</em></span> </p>

          </blockquote>

        </div>

        <p>While it is not exactly known whether the delay is hardcoded or can be disabled with software, third-party acquisition tools can no longer try more than one passcode every five seconds. This means that there are about 14 hours to try all possible combinations of a four-digit passcode. With longer and stronger numeric or alphanumeric passcodes, brute-force attacks are no longer feasible.</p>

        <p>At this time, physical acquisition is available for all existing devices equipped with 32-bit and 64-bit chipsets. A working jailbreak is mandatory to perform physical acquisition. Additionally, the passcode must be known (and removed for 64-bit devices) in order to acquire the maximum amount of information.</p>

      </div>

      <div class="section" title="Physical acquisition compatibility matrix">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_14"><a id="ch05lvl2sec55"/>Physical acquisition compatibility matrix</h2>

            </div>

          </div>

        </div>

        <p>Physical acquisition is a great technique. Unfortunately, at this time, physical acquisition has limited availability. Newer Apple devices (starting with iPhone 4S and iPad 2) have stronger security, which limits our ability to perform physical acquisition. Today, the following devices can be acquired with this method:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">iPhone 3G, 3GS, and 4 (GSM and CDMA models)</li>

            <li class="listitem" style="list-style-type: disc">iPhone 4S, 5, and 5C***</li>

            <li class="listitem" style="list-style-type: disc">iPod Touch (1st through 4th generations)</li>

            <li class="listitem" style="list-style-type: disc">iPod Touch 5th gen ***</li>

            <li class="listitem" style="list-style-type: disc">iPad (1st generation only)</li>

            <li class="listitem" style="list-style-type: disc">iPad 2***</li>

            <li class="listitem" style="list-style-type: disc">iPad with Retina display (3rd and 4th generations)***</li>

            <li class="listitem" style="list-style-type: disc">iPad Mini***</li>

          </ul>

        </div>

        <p>These devices can run any of the following operating systems:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">iOS 1 through 3 (up to 3.1.3)</li>

            <li class="listitem" style="list-style-type: disc">iOS 4.x—up to iOS 4.3.5 (up to iOS 4.2.10 for iPhone 4 CDMA)</li>

            <li class="listitem" style="list-style-type: disc">iOS 5.x</li>

            <li class="listitem" style="list-style-type: disc">iOS 6.x</li>

            <li class="listitem" style="list-style-type: disc">iOS 7.0</li>

            <li class="listitem" style="list-style-type: disc">iOS 7.1 (with Pangu 1.2+ jailbreak)</li>

            <li class="listitem" style="list-style-type: disc">iOS 8.x and 9.x****</li>

          </ul>

        </div>

        <p> </p>

        <div class="mediaobject">

          <img src="0068.jpeg" alt="Physical acquisition compatibility matrix"/>

        </div>

        <p> </p>

        <p>*Devices running iOS versions prior to 3.0 do not have Data Protection enabled, and their user partition is not encrypted.</p>

        <p>**Devices originally shipped with iOS 3.x, including those running iOS 4/5 that were upgraded from iOS 3.x without performing <code class="literal">erase install</code> (that is, using the <span class="strong"><strong>Update</strong></span> option in iTunes as opposed to <span class="strong"><strong>Restore</strong></span>), do not have Data Protection enabled, and user partitions are not encrypted. Therefore, the decryption is not required.</p>

        <p>***iPhone 4S, iPhone 5, iPhone 5C, iPad 2+, iPad Mini, and iPod Touch 5th gen can be recovered if the passcode is known or if the device is jailbroken (iOS 5 through 9).</p>

        <p>****Physical acquisition of newer devices (iPhone 4S and newer) remains subject to jailbreak availability. Jailbreaking the device and recovering (and in some cases, removing) the passcode is mandatory as all user data is now encrypted with passcode-dependent keys (as a comparison, iOS 7 used encryption this strong exclusively for keychain and mail protection).</p>

        <p>*****Physical acquisition for 64-bit models (iPhone 5S/6/6S/Plus, iPad mini 2/3/4, iPad Air / Air 2, and iPad Pro) is available via a different acquisition process referred to specifically as <span class="strong"><strong>physical acquisition for 64-bit devices</strong></span>. Jailbreaking the device and removing passcode protection in iOS settings is mandatory. Acquisition of 64-bit iOS devices is covered in a separate chapter.</p>

      </div>

      <div class="section" title="Unallocated space – unavailable since iOS 4">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_15"><a id="ch05lvl2sec56"/>Unallocated space – unavailable since iOS 4</h2>

            </div>

          </div>

        </div>

        <p>Unallocated space is only available via physical acquisition if you are acquiring a device running iOS 3.x or older. Since these are very old versions of iOS, you are extremely unlikely to ever encounter one in real life. If you do, you'll be able to use Elcomsoft iOS Forensic Toolkit to bypass passcode protection and extract the complete image of the device along with unallocated space.</p>

        <p>Since iOS 4, Apple uses passcode-dependent encryption of the filesystem. iOS does not keep encryption keys to areas that are not occupied by files. After a file is deleted, the system destroys encryption keys for corresponding data blocks. As a result, decrypting these unallocated areas is not possible at the time of physical acquisition. In the case of in-house physical acquisition performed with Elcomsoft iOS Forensic Toolkit or any other third-party tool, unallocated disk space will be extracted, but not decrypted.</p>

        <p>What <span class="emphasis"><em>can</em></span> be recovered is SQLite records that contain deleted text messages, call log, and chat entries. However, the process is far from simple and requires the use of specialized software or SQLite-specific expertise.</p>

      </div>

      <div class="section" title="Sending device to Apple">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_16"><a id="ch05lvl2sec57"/>Sending device to Apple</h2>

            </div>

          </div>

        </div>

        <p>In its privacy policy (<a class="ulink" href="https://www.apple.com/privacy/government-information-requests/">https://www.apple.com/privacy/government-information-requests/</a>), Apple clearly states the following:</p>

        <div class="blockquote">

          <blockquote class="blockquote">

            <p> <span class="emphasis"><em>On devices running iOS 8, your personal data such as photos, messages (including attachments), email, contacts, call history, iTunes content, notes, and reminders is placed under the protection of your passcode. Unlike our competitors, Apple cannot bypass your passcode and therefore cannot access this data. So it's not technically feasible for us to respond to government warrants for the extraction of this data from devices in their possession running iOS 8.</em></span> </p>

          </blockquote>

        </div>

        <p>Analyzing the way the system works on newer 64-bit devices, we tend to believe that the preceding statement is true.</p>

        <p>While it is not currently possible to request a decrypted device image from Apple due to their new policy based on the technical features of iOS 8, law enforcement agencies can still send Apple devices running an older version of iOS in order to obtain their unencrypted images. In such cases, Apple provides a full decrypted image of the device (with keychains being a possible exception if the passcode is not known).</p>

      </div>

      <div class="section" title="The role of passcode">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_17"><a id="ch05lvl2sec58"/>The role of passcode</h2>

            </div>

          </div>

        </div>

        <p>Passcode is key to iOS security. Even if it's just a simple PIN number consisting of only four digits, in reality, a passcode is key to some of the strongest security models in the mobile world. This passcode, combined with a unique and very long string of binary data (hardware encryption key), is used to generate a unique and extremely strong encryption key. The device then encrypts the device's sensitive data, including text messages, e-mail, photos, and so on, using this encryption key and a government-standard AES encryption algorithm.</p>

        <p>It is important to note that it is impossible to generate the encryption key without having access to the device's hardware encryption key, and it is impossible to get access to that hardware encryption key even after disassembling the device to small bits. Without the correct passcode, passcode-encrypted data will remain encrypted, even if the complete image is extracted.</p>

        <p>In other words, some parts of the iOS device are likely to remain encrypted unless the original passcode is known (this is especially true with the latest iOS releases). Recovering the original passcode is only possible on the device itself.</p>

        <p>Older versions of iOS did not encrypt all user data using the passcode. We could break into those devices and retrieve almost everything even without a passcode. This is no longer the case with iOS 8.</p>

        <p>The following chart summarizes whether you require a passcode for successful acquisition:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>iOS 1.x through 3.x</strong></span>: Here, the passcode is not required. All data is accessible. The passcode is instantly recovered and displayed.</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>iOS 4.0 through 7.x</strong></span>: The passcode is not required, but highly recommended. Some data is protected with passcode-dependent keys:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">E-mail messages</li><li class="listitem" style="list-style-type: disc">Keychain items</li><li class="listitem" style="list-style-type: disc">Certain third-party application data if the app requested secure access</li></ul></div><p> </p></li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>iOS 8 and 9</strong></span>: The passcode is mandatory for successful acquisition. Most user information is protected with passcode-based keys.</li>

          </ul>

        </div>

      </div>

      <div class="section" title="Physical acquisition of iOS 8 and 9">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_18"><a id="ch05lvl2sec59"/>Physical acquisition of iOS 8 and 9</h2>

            </div>

          </div>

        </div>

        <p>iOS 9 is the latest and most secure version of Apple's mobile operating system. According to Apple, by February 2016, approximately 76% of Apple customers already upgraded to the latest iOS, while 17% of users still used iOS 8. Only 7% of devices were running iOS 7 or earlier (source: <a class="ulink" href="https://developer.apple.com/support/app-store/">https://developer.apple.com/support/app-store/</a>).</p>

        <p>In iOS 8, Apple further strengthened the security of iOS devices. The 8th and 9th generations of Apple's mobile operating system encrypt more information than ever. Data encryption is not new on Apple devices. It's been in place for a number of years. What is new is the amount of data the phone will store in the encrypted form. In iOS 8, Apple moved things such as e-mails, messages, photos, and videos into the encrypted part of the phone. Once again, a lot of information that was previously accessible (and highly valuable for investigations) is moved into passcode-protected part of the phone, making physical acquisition of a device without knowing the correct passcode nearly useless. Apple claims iOS 8 and newer to be so secure that the company is to deny government requests to extract information even if provided with a working device (source: <a class="ulink" href="https://www.apple.com/privacy/government-information-requests/">https://www.apple.com/privacy/government-information-requests/</a>).</p>

        <p>From a practical standpoint, this means that you must break a passcode in order to properly image a device running iOS 8 or 9. In order to break a passcode on one of the newer devices (iPhone 4S, iPad 2, and their newer generations), you'll need to have the device jailbroken or unlocked. Breaking a passcode is still possible on non-jailbroken devices earlier than iPhone 4S and on the original iPad. At this time (February 2016), the only forensic tool providing physical acquisition support for iOS 8 and 9 devices is Elcomsoft iOS Forensic Toolkit. The tool supports 32-bit and 64-bit devices that are either jailbroken or can be jailbroken by the investigator. Without a jailbreak (and not knowing the passcode), the ONLY information that remains accessible via physical acquisition is call log and text message history. In addition, when performing physical acquisition of 64-bit devices, the passcode must be removed in device Security settings prior to acquisition.</p>

        <p>More information on how Apple encrypts information and what's changed in iOS 8 is available at the following URLs:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://www.slate.com/articles/technology/future_tense/2014/09/ios_8_encryption_why_apple_won_t_unlock_your_iphone_for_the_police.html">http://www.slate.com/articles/technology/future_tense/2014/09/ios_8_encryption_why_apple_won_t_unlock_your_iphone_for_the_police.html</a></li>

            <li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://blog.cryptographyengineering.com/2014/10/why-cant-apple-decrypt-your-iphone.html?m=1">http://blog.cryptographyengineering.com/2014/10/why-cant-apple-decrypt-your-iphone.html?m=1</a></li>

          </ul>

        </div>

        <p> </p>

        <div class="mediaobject">

          <img src="0069.jpeg" alt="Physical acquisition of iOS 8 and 9"/>

        </div>

        <p> </p>

      </div>

      <div class="section" title="Tools for iOS physical acquisition">

        <div class="titlepage">

          <div>

            <div>

              <h2 class="title" id="toc_19"><a id="ch05lvl2sec60"/>Tools for iOS physical acquisition</h2>

            </div>

          </div>

        </div>

        <p>Physical acquisition of iOS devices requires the use of a dedicated acquisition tool. Elcomsoft offers iOS Forensic Toolkit (<a class="ulink" href="http://www.elcomsoft.com/eift.html">http://www.elcomsoft.com/eift.html</a>), a tool offering physical-acquisition support for more models than any competing product.</p>

        <p>Note that the following page contains videos demonstrating how to use the toolkit to acquire an iPhone:</p>

        <p> <a class="ulink" href="http://www.elcomsoft.com/ios_forensic_toolkit_video.html">http://www.elcomsoft.com/ios_forensic_toolkit_video.html</a> </p>

      </div>

    </div>

  </div>




  <div class="section" title="Tutorial &#x2013; physical acquisition with Elcomsoft iOS Forensic Toolkit">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch05lvl1sec27"/>Tutorial – physical acquisition with Elcomsoft iOS Forensic Toolkit</h1>

        </div>

      </div>

    </div>

    <p>Let's use iOS Forensic Toolkit to extract the content of an iPhone. However, first let's take a look at what actually happens at the time the tool performs physical acquisition.</p>

    <div class="section" title="What the does the tool do?">

      <div class="titlepage">

        <div>

          <div>

            <h2 class="title" id="toc_1"><a id="ch05lvl2sec61"/>What the does the tool do?</h2>

          </div>

        </div>

      </div>

      <p>The first step of the acquisition process involves putting the device into a so-called <span class="strong"><strong>DFU</strong></span> mode (<span class="strong"><strong>Debug and Firmware Upgrade</strong></span>) with a combination of Home and Power buttons. Elcomsoft iOS Forensic Toolkit displays tips on how to put the device to this mode.</p>

      <p>Once the device is in its DFU mode, we can use its <span class="emphasis"><em>F</em></span> function, emulating a firmware upgrade. However, instead of Apple's original firmware, the Toolkit attempts to load an altered one. The device will verify the new firmware by checking its digital signature via bootrom functions (these are read-only and can't be switched off). Now, if we're acquiring an iPhone 4 or earlier, the Toolkit can use a bootrom exploit that allows skipping the check and sideloading the altered firmware into device volatile memory (RAM). In this case, device storage remains unaltered as all operations are performed exclusively in the device's volatile memory.</p>

      <p>If we are acquiring an iPhone 4S, the bootrom exploit that we could use with earlier iPhones is not available. As a result, the Toolkit uses a different method that only works if the device is jailbroken. With this method, the Toolkit connects to the device via OpenSSH and installs and launches acquisition tools. This method alters the content of the device by installing acquisition tools. This must be taken into account and documented appropriately in order to keep the process forensically sound.</p>

      <div class="section" title="Prerequisites">

        <div class="titlepage">

          <div>

            <div>

              <h3 class="title" id="toc_2"><a id="ch05lvl3sec31"/>Prerequisites</h3>

            </div>

          </div>

        </div>

        <p>You'll need a working iOS device, a compatible cable to connect it to your computer, and a copy of Elcomsoft iOS Forensic Toolkit (which requires a USB dongle to operate).</p>

        <p>Please note the following:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">The imaging tool must be installed in order to acquire the device</li>

            <li class="listitem" style="list-style-type: disc">If no jailbreak is installed, you'll have to enter the device into the DFU mode (Device Firmware Upgrade mode) with a combination of Home and Power keys</li>

            <li class="listitem" style="list-style-type: disc">Physical acquisition for Apple's 64-bit devices is available via a separate process (refer to <span class="emphasis"><em>Acquiring 64-bit Apple devices</em></span>)</li>

            <li class="listitem" style="list-style-type: disc">Passcodes can only be recovered in the DFU mode</li>

          </ul>

        </div>

        <p> <span class="strong"><strong>Step 0 - connecting the device</strong></span>: Connect the Apple device to your computer using the appropriate USB cable. Launch iOS Forensic Toolkit.</p>

        <p> <span class="strong"><strong>Step 1 - entering the DFU mode</strong></span>: If you are imaging a device for which there is a known way to enter the DFU mode, consider it luck. In iOS Forensic Toolkit, enter <code class="literal">1</code>, as shown in the following screenshot:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0070.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p>If you are imaging a newer device, such as iPhone 4S, iPhone 5, iPhone 5C, iPad 2, iPad 3, iPad 4, and newer), physical acquisition will only be available if you either know the correct passcode or if the device is jailbroken. To acquire such a device, skip directly to step 3:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0071.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p>You'll see interactive instructions on how to enter your device into the DFU mode:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0072.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p> </p>

        <div class="mediaobject">

          <img src="0073.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p>It's a bit tricky to master this in the first try. Take your time and make several attempts until you succeed. When you have your device in the DFU mode, go to step 2.</p>

        <p>Note that having the device in the DFU mode or having a jailbroken/unlocked unit is essential to recover the original passcode.</p>

        <p> <span class="strong"><strong>Step 2 - loading RAM disk</strong></span>: During this step, you'll be loading the acquisition code into the Apple device. The code will be loaded into the device's volatile memory (RAM) and will not modify any of its content. To load the RAM disk, perform either of the following actions:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">Agree to load RAM disk when prompted</li>

            <li class="listitem" style="list-style-type: disc">Press <code class="literal">2</code> on the main screen and follow the instructions:</li>

          </ul>

        </div>

        <p> </p>

        <div class="mediaobject">

          <img src="0074.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p>The device will display the Elcomsoft logo when RAM disk is loaded.</p>

        <p>Note that, starting with iOS 4, loading RAM disk is a mandatory prerequisite for recovering the passcode.</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0075.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p> <span class="strong"><strong>Step 3 - recovering the passcode</strong></span>: This step used to be optional a year ago. Today, making an attempt to recover a passcode is mandatory to obtain any meaningful information. If you already have the correct passcode, skip to the next step.</p>

        <p>Whether you need to recover the passcode to acquire the user data depends on the version of iOS used in the device:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>iOS 1.x through 3.x</strong></span>: The passcode is not required. All data is accessible. The passcode is instantly recovered and displayed.</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>iOS 4.0 through 7.x</strong></span>: The passcode is not required, but highly recommended. Some data is protected with passcode-dependent keys:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">E-mail messages</li><li class="listitem" style="list-style-type: disc">Keychain items</li><li class="listitem" style="list-style-type: disc">Certain third-party application data if the app requested secure access</li></ul></div><p> </p></li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>iOS 8 and 9</strong></span>: The passcode is mandatory for successful acquisition. Most user information is protected with passcode-based keys.</li>

          </ul>

        </div>

        <p>If you read the earlier chapters, you will know that the passcode is key to Apple's security. In older devices and early versions of iOS, the passcode was used to generate a secure encryption key protecting the information stored in Apple's secure storage, the keychain. Even in older devices and early releases of iOS, protected data included bits such as account passwords, credit card data, Wi-Fi passwords, and a lot of other information essential to an investigation.</p>

        <p>With the release of iOS 7 and subsequent upgrade to iOS 8 (and iOS 9 later on), the role of the passcode has increased dramatically. In modern devices running iOS 8 or 9, passcode-protected partition now stores more information than ever. In fact, pretty much everything of interest is now stored on a passcode-protected disk. E-mail and text messages, passwords, picture and video captures with the phone's camera, and a lot of other information is now encrypted. As a result, imaging the device without having a passcode today will return much less information than it did a year ago. In order to decrypt information stored in the protected area, one must first recover the passcode.</p>

        <p>Due to the way Apple has designed and implemented its security model, recovering passcodes is only possible using the original device. While using a computer or a cluster of GPU-accelerated workstations to recover passcodes sounds tempting, it is impossible even in theory.</p>

        <p>Apple devices can use standard numeric (four-digit PIN), long numeric, and full alphanumeric passcodes. These types of passcodes can be recovered with iOS Forensic Toolkit by either brute forcing or using a dictionary attack (if breaking an alphanumeric passcode).</p>

        <p>Note that you'll need to load the RAM disk first (as described in the previous step) to recover passcodes for devices running iOS 4 or later.</p>

        <p>Another thing to note is the speed of breaking the passcode. Passcode recovery is slow! It's slow on purpose, by design. Apple carefully balanced algorithms used in its various devices, apparently targeting the time required to verify a passcode at approximately 80 ms per passcode. As a result, recovering a four-digit passcode may take around 35 minutes; brute forcing will take a little longer, and alphanumeric passcode may take forever.</p>

        <p>With iOS Forensic Toolkit, recovering a passcode is engaged by entering the <code class="literal">3</code> (<span class="strong"><strong>Get Passcode</strong></span>) command on the home screen. You'll see the following window:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0076.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p>You'll have the option to (<span class="strong"><strong>1</strong></span>) view the type of passcode (numeric four-digit, numeric long, alphanumeric), (<span class="strong"><strong>2</strong></span>) brute force a four-digit PIN, (<span class="strong"><strong>3</strong></span>) perform a dictionary attack on an alphanumeric passcode, or (<span class="strong"><strong>4</strong></span>) use the fully manual option.</p>

        <p>While we've seen some limited success in recovering longer alphanumeric passcodes, majority of iPhone users opt for simple four-digit passcodes. Brute forcing such passcodes by enumerating all of the possible combinations takes approximately 35 minutes on iPhone 4S. After entering <code class="literal">2</code>, you'll see the progress report window. The currently tried passcode will be displayed:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0077.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p>Once the correct passcode is discovered, it will be displayed. Write it down and press <span class="emphasis"><em>Enter</em></span> to continue to extract device keys:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0078.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p> <span class="strong"><strong>Step 4 - extracting device keys</strong></span>: In order to be able to decrypt information stored on the encrypted partition (as a reminder, this includes user passwords, e-mail, messages, and so on), you will need to obtain device keys and keychain data. In iOS Forensic Toolkit, use the <code class="literal">4</code> (<code class="literal">GET KEYS)</code> command. This action is mandatory, you cannot skip it. Without the keys, neither the keychain nor the device image can be decrypted:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0079.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p>To obtain device keys and keychain, enter <code class="literal">4</code>.</p>

        <p>In order to successfully obtain device keys and keychain data, you will need to provide the device passcode (if non-empty):</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0080.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p> </p>

        <div class="mediaobject">

          <img src="0081.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p> <span class="strong"><strong>Step 5 - decrypting keychain items</strong></span>: Some of the most valuable information stored in the iPhone, iPod Touch, or iPad is kept in the system's protected storage called keychain. Secured information is protected with strong passcode-dependent encryption keys (that's why you need to recover the passcode in order to obtain these keys and decrypt the keychain). With every iOS release, Apple moves more data to keychain storage. Depending on the iOS version, protected information may include e-mail account passwords, messages, Wi-Fi passwords, passwords entered into websites and certain third-party apps, financial information, documents, and so on.</p>

        <p>Keychain decryption is instant. To decrypt the keychain, enter <code class="literal">5</code> on the tools' main screen:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0082.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p> <span class="strong"><strong>Step 6 - performing acquisition</strong></span>: When capturing an iOS device via a physical link, you will have two distinct options:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">In option 1, you can capture the entire image of the device (the <code class="literal">IMAGE DISK</code> command, <code class="literal">6</code>)</li>

            <li class="listitem" style="list-style-type: disc">In option 2, you can download user's files as a UNIX-style tarball (the <code class="literal">TAR FILES</code> command, <code class="literal">8</code>)</li>

          </ul>

        </div>

        <p>The option to download individual files is sometimes referred to as <span class="strong"><strong>logical acquisition</strong></span>, yet we prefer using that term for the acquisition method involving the analysis of offline backup produced with Apple iTunes. Downloading individual files is a faster option with on-the-fly decryption. However, if you opt to download the files, you'll be missing any information that might be stored in unallocated disk space.</p>

        <p>On the other hand, the <code class="literal">IMAGE DISK</code> command performs the complete physical imaging of the device. When we talk about <span class="emphasis"><em>physical acquisition</em></span>, we usually mean this option. With disk imaging, you'll be downloading a bit-precise copy of the device; no on-the-fly decryption is performed. As a result, you'll need to decrypt the disk later by using the <code class="literal">DECRYPT DISK</code> tool (command <code class="literal">7</code>).</p>

        <p>Let's see what happens when you enter <code class="literal">6</code> (<code class="literal">IMAGE DISK</code>). First, you'll see the list of available partitions. Typically, you'll see the <span class="strong"><strong>System</strong></span> partition (which is normally unencrypted, and contains system files and applications) and the <span class="strong"><strong>User</strong></span> partition (which would be normally encrypted). To select a partition to image, enter its number in the prompt:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0083.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p>After you've selected a partition to image, the acquisition process will begin immediately. It may take around 35 to 90 minutes to image the device, depending on the model and storage capacity. If you opt for filesystem-level acquisition as in the <code class="literal">8</code> command, the time required to acquire the device will depend on the amount of user data actually stored in the device. If the user does not have a lot of data, the acquisition in that mode can be really fast:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0084.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p> <span class="strong"><strong>Step 7 - decrypting the disk</strong></span>: After acquiring the disk image in the previous step, you'll end up with one unencrypted (system) and most probably an encrypted (user) partition. In order to be able to analyze user data, you'll need to decrypt the partition first. The decryption is performed by choosing the <code class="literal">7</code> command (<code class="literal">DECRYPT DISK</code>) from the main window:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0085.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p> </p>

        <div class="mediaobject">

          <img src="0086.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p> </p>

        <div class="mediaobject">

          <img src="0087.jpeg" alt="Prerequisites"/>

        </div>

        <p> </p>

        <p>That's it! You just acquired an iOS device and have the data ready for analysis. The data is saved in a standard DMG image. To analyze information, you can use one of the many third-party forensic tools. If you are using a Mac PC, in order to manually access information contained in the DMG image, you can simply mount the image into the system (read-only). If you are using a Windows PC, you will need to install an HFS+ driver, such as Paragon HFS+, available at <a class="ulink" href="http://www.paragon-software.com/home/hfs-windows/">http://www.paragon-software.com/home/hfs-windows/</a> . Either way, after mounting the image, you will be able to access the individual files and databases available in the device.</p>

      </div>

    </div>

    <div class="section" title="Acquiring 64-bit Apple devices">

      <div class="titlepage">

        <div>

          <div>

            <h2 class="title" id="toc_3"><a id="ch05lvl2sec62"/>Acquiring 64-bit Apple devices</h2>

          </div>

        </div>

      </div>

      <p>Elcomsoft iOS Forensic Toolkit is the only tool on the market (as of December 2015) that allows physical acquisition of Apple's 64-bit devices. The tool comes with the ability of acquiring information from jailbroken 64-bit iPhones, such as Apple iPhone 5S, 6/6S/Plus, and 64-bit iPads, including iPad mini 2-4, iPad Air/Air2, and iPad Pro.</p>

      <p>The 64-bit acquisition process differs significantly from the old methods that were used to extract data from 32-bit devices. The new method is backward compatible with 32-bit iPhones and iPads; however, if you have a choice, we recommend sticking with the old and proven acquisition routine if you've got a 32-bit iPhone to extract.</p>

      <p>Note that a working jailbreak is absolutely mandatory for the new acquisition process to work.</p>

      <p>If you don't want to read the theory, you can skip directly to the <span class="emphasis"><em>Performing physical acquisition on a 64-bit iOS device</em></span> section.</p>

      <div class="section" title="Comparing 64-bit process and traditional physical acquisition">

        <div class="titlepage">

          <div>

            <div>

              <h3 class="title" id="toc_4"><a id="ch05lvl3sec32"/>Comparing 64-bit process and traditional physical acquisition</h3>

            </div>

          </div>

        </div>

        <p>In order to successfully operate on Apple's 64-bit devices, the new acquisition process must work within the limits of the target platform. Apple's 64-bit platform implements much stricter security compared to legacy devices based on older hardware; as a result, there are certain limitations to 64-bit acquisition that one never has to deal with when acquiring 32-bit hardware.</p>

        <p>The first difference between the two acquisition methods lies in the output data format. The 32-bit physical acquisition process returns the complete bit-precise image of the device by accessing the data in raw mode. The 64-bit platform implements stronger protection, making it possible to dump a disk image, but it never releases the encryption keys required to decrypt files. For this reason, the 64-bit acquisition process is limited to using higher-level access for capturing the filesystem in the form of a Unix-style TAR archive. Mind you, the archive contains the same data as a raw dump produced by the traditional process. However, keychain items cannot be decrypted. Analyzing the filesystem image is also a bit more complicated compared to processing the full DMG image, as DMG images are supported by virtually all mobile forensic tools, while filesystem dumps are not as widely supported.</p>

        <p>Here comes the second difference between the two acquisition methods. The 64-bit process can <span class="emphasis"><em>extract</em></span> the keychain database from the device. However, with no access to the securityd device key, the new process cannot <span class="emphasis"><em>decrypt</em></span> the keychain. Therefore, stored Web forms and passwords, as well as other data put into keychain, will remain inaccessible (at least for the time being).</p>

        <p>Finally, you must unlock the device with the correct passcode and remove passcode protection in iOS settings before the extraction.</p>

        <p>Finally, the 64-bit acquisition process is significantly more invasive, compared to the old 32-bit process. This means that every step of the acquisition process and every modification done to the content of the device must be carefully documented; otherwise, extracted evidence may not be admissible.</p>

        <p>To sum it up, the 64-bit process has the following limitations compared to physical acquisition for 32-bit devices:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">Keychain extracted, but <span class="emphasis"><em>not</em></span> decrypted</li>

            <li class="listitem" style="list-style-type: disc">HFS+ filesystem image (64-bit) versus bit-precise image (32-bit)</li>

            <li class="listitem" style="list-style-type: disc">Passcode must be removed in iOS settings prior to acquisition (64-bit)</li>

            <li class="listitem" style="list-style-type: disc">Highly invasive, requires careful documentation for evidence to remain admissible</li>

          </ul>

        </div>

      </div>

    </div>

    <div class="section" title="Supported devices and iOS versions">

      <div class="titlepage">

        <div>

          <div>

            <h2 class="title" id="toc_5"><a id="ch05lvl2sec63"/>Supported devices and iOS versions</h2>

          </div>

        </div>

      </div>

      <p>Hardware wise, the 64-bit acquisition process supports all of the following devices regardless of the version of iOS they are running (assuming that a working jailbreak exists for this version of iOS):</p>

      <div class="itemizedlist">

        <ul class="itemizedlist">

          <li class="listitem" style="list-style-type: disc">iPhone 5S, 6, 6 Plus, 6S, and 6S Plus</li>

          <li class="listitem" style="list-style-type: disc">iPad Air, Air 2, and Pro</li>

          <li class="listitem" style="list-style-type: disc">iPad mini Retina and iPad mini 3 and 4</li>

          <li class="listitem" style="list-style-type: disc">iPod Touch 6th gen</li>

        </ul>

      </div>

      <p>The new acquisition process requires unrestricted access to the filesystem, and therefore, it relies heavily on a device being jailbroken. Since new versions of iOS are a constant challenge for jailbreakers, you may be out of luck (at least for a while) if you encounter a device running the latest version of iOS that does not have a jailbreak so far. At this time (December 2015), iOS 9.1 and 9.2 Beta still don't have a working jailbreak, so you will be unable to use the new acquisition process on any of these devices.</p>

      <div class="section" title="Performing physical acquisition on a 64-bit iOS device">

        <div class="titlepage">

          <div>

            <div>

              <h3 class="title" id="toc_6"><a id="ch05lvl3sec33"/>Performing physical acquisition on a 64-bit iOS device</h3>

            </div>

          </div>

        </div>

        <p>The internals of the 64-bit acquisition process differ significantly from how it works on 32-bit devices. As a result, an extra step is required to perform physical acquisition on an iPhone 5S, 6/6S, or any of the Plus versions.</p>

        <p> <span class="strong"><strong>Step 1 - on your iOS device</strong></span>:</p>

        <div class="orderedlist">

          <ol class="orderedlist arabic">

            <li class="listitem"><span class="strong"><strong>Ensure that the device is jailbroken</strong></span>: Physical acquisition for 64-bit devices is exclusive to jailbroken iPhones, iPads, and iPods. If it is not jailbroken, proceed to <span class="emphasis"><em>Install jailbreak</em></span>.</li>

            <li class="listitem">If OpenSSH is not installed, install it from Cydia (<a class="ulink" href="https://cydia.saurik.com/openssh.html">https://cydia.saurik.com/openssh.html</a>) or by following the instructions at <a class="ulink" href="http://www.cydiaos.com/install-openssh-on-iphone-ipod-without-cydia/">http://www.cydiaos.com/install-openssh-on-iphone-ipod-without-cydia/</a>.</li>

            <li class="listitem">Unlock the device by supplying the correct passcode.</li>

            <li class="listitem">If the passcode is empty, go to iOS Forensic Toolkit.</li>

            <li class="listitem">Disable passcode protection in iOS Settings.<p>iOS 8 (no Touch ID): <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Passcode Lock</strong></span> | <span class="strong"><strong>Turn Passcode Off</strong></span>:</p></li>

          </ol>

        </div>

        <p> </p>

        <div class="mediaobject">

          <img src="0088.jpeg" alt="Performing physical acquisition on a 64-bit iOS device"/>

        </div>

        <p> </p>

        <p> <span class="strong"><strong>Step 2 - install jailbreak</strong></span> </p>

        <p>Jailbreaking iOS 8 and 9 is a cumbersome process without guaranteed outcome. Depending on the version of iOS, you may need to follow different steps and use different tools to jailbreak.</p>

        <p>For example, installing a Pangu jailbreak on iOS 9.0.1-9.0.2 may get stuck at 85% with an error message. If that happens, you will need to open the Photos app after the first reboot (and before putting the device into the <span class="strong"><strong>Airplane mode</strong></span>) to ensure that at least one photo exists on the device. Opening (and leaving) the Photos app may be enough to carry on; however, there can be other numerous obstacles in installing jailbreak.</p>

        <p> <span class="strong"><strong>What you need to know</strong></span> </p>

        <p>In order to jailbreak an iOS device, you'll need to disable several protection layers. In order to do this, you may need to specify the correct Apple ID password and enter the correct passcode (if either or both protection layers are enabled).</p>

        <p> <span class="strong"><strong>Preparing for jailbreak</strong></span> </p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">Before jailbreaking, you will need to unlock the iOS device using the correct passcode</li>

            <li class="listitem" style="list-style-type: disc">Check whether <span class="strong"><strong>Find My Phone</strong></span> is enabled. If it is, in iOS Settings, disable <span class="strong"><strong>Find My Phone</strong></span> (Apple ID password required):</li>

          </ul>

        </div>

        <p> </p>

        <div class="mediaobject">

          <img src="0089.jpeg" alt="Performing physical acquisition on a 64-bit iOS device"/>

        </div>

        <p> </p>

        <p>TaiG and Pangu jailbreaks require disabling Touch ID and passcode protection. If you haven't disabled them during the previous step, do it now. Check whether passcode protection is enabled (if you had to enter a passcode in order to unlock the device, it is.) If enabled, disable <span class="strong"><strong>Touch ID</strong></span> and <span class="strong"><strong>Passcode</strong></span> in iOS <span class="strong"><strong>Settings</strong></span> (original passcode required):</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0090.jpeg" alt="Performing physical acquisition on a 64-bit iOS device"/>

        </div>

        <p> </p>

        <p> <span class="strong"><strong>Install jailbreak</strong></span> </p>

        <p>For iOS 8.x (all versions), use TaiG jailbreak and follow the instructions at <a class="ulink" href="http://www.taig.com/en/">http://www.taig.com/en/</a> .</p>

        <p>For iOS 9 through 9.0.2, use Pangu jailbreak and follow the instructions at <a class="ulink" href="http://en.pangu.io/">http://en.pangu.io/</a>.</p>

        <p>For iOS 9.1 and 9.2, at this time, no jailbreak is available (may change in the future).</p>

        <p> <span class="strong"><strong>Step 3 - connect the device</strong></span> </p>

        <p>Once your device is jailbroken, you may connect it to your computer via the Lightning cable. Launch iOS Forensic Toolkit. The majority of options are unavailable for 64-bit devices. The 64-bit acquisition process is available under the <code class="literal">TAR FILES</code> command.</p>

        <p> <span class="strong"><strong>Step 4 - use iOS Forensic Toolkit</strong></span>:</p>

        <div class="orderedlist">

          <ol class="orderedlist arabic">

            <li class="listitem"><span class="strong"><strong>Launch the Toolkit</strong></span>:<p> </p><div class="mediaobject"><img src="0091.jpeg" alt="Performing physical acquisition on a 64-bit iOS device"/></div><p> </p></li>

            <li class="listitem"><span class="strong"><strong>Use the <span class="strong"><strong>TAR FILES</strong></span> command (item 8) from the main menu</strong></span>: This will return a Unix-style TAR archive of the filesystem, complete with all application data. The keychain database will also be extracted; however, it won't be decrypted as keychain decryption keys are not accessible on 64-bit devices:<p> </p><div class="mediaobject"><img src="0092.jpeg" alt="Performing physical acquisition on a 64-bit iOS device"/></div><p> </p><p> </p><div class="mediaobject"><img src="0093.jpeg" alt="Performing physical acquisition on a 64-bit iOS device"/></div><p> </p><p>If prompted, enter the root password. By default, the root password is <code class="literal">alpine</code>. You will need to enter the password twice.</p><p>Re-enter the root password:</p><p> </p><div class="mediaobject"><img src="0094.jpeg" alt="Performing physical acquisition on a 64-bit iOS device"/></div><p> </p></li>

            <li class="listitem"><span class="strong"><strong>Specify the file name</strong></span>: The path is relative to the home directory:<p> </p><div class="mediaobject"><img src="0095.jpeg" alt="Performing physical acquisition on a 64-bit iOS device"/></div><p> </p></li>

            <li class="listitem"><span class="strong"><strong>Wait while the filesystem is being extracted</strong></span>: This can be a lengthy process, especially when acquiring devices with a large amount of data (in our lab, it took us about 10 minutes to pull 7.5 GB of data):<p> </p><div class="mediaobject"><img src="0096.jpeg" alt="Performing physical acquisition on a 64-bit iOS device"/></div><p> </p></li>

            <li class="listitem"><span class="strong"><strong>When the process is finished, disconnect the device and proceed to analyze the data</strong></span>:<p> </p><div class="mediaobject"><img src="0097.jpeg" alt="Performing physical acquisition on a 64-bit iOS device"/></div><p> </p></li>

          </ol>

        </div>

      </div>

      <div class="section" title="What is available via 64-bit physical acquisition">

        <div class="titlepage">

          <div>

            <div>

              <h3 class="title" id="toc_7"><a id="ch05lvl3sec34"/>What is available via 64-bit physical acquisition</h3>

            </div>

          </div>

        </div>

        <p>The 64-bit acquisition process returns the full filesystem of the device, including the keychain (which, unfortunately, cannot be decrypted). We were able to access all the following data that is <span class="emphasis"><em>not</em></span> available in either iTunes or iCloud backups:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">Location data (<code class="literal">/private/var/root/Library/Caches/locationd</code>)</li>

            <li class="listitem" style="list-style-type: disc">Downloaded mail (<code class="literal">/private/var/mobile/Library/Mail</code>)</li>

            <li class="listitem" style="list-style-type: disc">Health data (<code class="literal">/private/var/mobile/Library/Health</code>)</li>

            <li class="listitem" style="list-style-type: disc">Music (<code class="literal">/private/var/mobile/Media/iTunes_Control/Music</code>)</li>

            <li class="listitem" style="list-style-type: disc">Detailed battery usage (<code class="literal">/private/var/mobile/Library/BatteryLife</code>)</li>

            <li class="listitem" style="list-style-type: disc">Application data and caches (<code class="literal">/private/var/mobile/Containers/Data/Application/<application id="">, /private/var/mobile/Library/Caches</application></code>)</li>

            <li class="listitem" style="list-style-type: disc">Mobile Safari cache—history, recent searches, and more (<code class="literal">/private/var/mobile/Containers/Data/Application/4FF7BF97-4B3B-4964-ACD8-974AADB8D4F8/Library/Safari</code>)</li>

            <li class="listitem" style="list-style-type: disc">Lockdown certificate info (<code class="literal">/private/var/root/Library/Lockdown</code>)</li>

            <li class="listitem" style="list-style-type: disc">CPU usage data (<code class="literal">/private/var/mobile/Library/CoreDuet</code>)</li>

            <li class="listitem" style="list-style-type: disc">Push notifications (<code class="literal">/private/var/mobile/Library/ApplePushService</code>)</li>

            <li class="listitem" style="list-style-type: disc">Battery usage (<code class="literal">/private/var/mobile/Library/BatteryLife</code>)</li>

            <li class="listitem" style="list-style-type: disc">Configuration files (<code class="literal">/private/var/mobile/Library/Preferences</code>)</li>

            <li class="listitem" style="list-style-type: disc">Network and data usage (<code class="literal">/private/var/networkd, /private/var/wireless/Library/Databases</code>)</li>

            <li class="listitem" style="list-style-type: disc">Various log files (<code class="literal">/private/var/log, /private/var/logs, /private/var/wireless/Library/Logs, /private/var/mobile/Library/Logs</code>)</li>

            <li class="listitem" style="list-style-type: disc">SHM and WAL files for all SQLite databases (delayed transactions)</li>

            <li class="listitem" style="list-style-type: disc">Applications activity (<code class="literal">/private/var/mobile/Library/AggregateDictionary</code>)</li>

            <li class="listitem" style="list-style-type: disc">Spotlight data (<code class="literal">/private/var/mobile/Library/Spotlight</code>)</li>

            <li class="listitem" style="list-style-type: disc">Keyboard cache (<code class="literal">/private/var/mobile/Library/Keyboard</code>)</li>

          </ul>

        </div>

        <p>The logs include information on application install/uninstall, restoring from backup, syncing and pairing, application crashes, GSM network connections, iCloud access (by app), iOS updates, application crash logs, info on device on/off, diagnostics and security logs, and more.</p>

        <p>Caches include a lot more than just the application cache. In addition to this, you'll get cache of the data downloaded over the Internet, screenshots of applications' recent state (at the time they were suspended), information stored in the clipboard of the device, and much more.</p>

        <p>There is quite more data to analyze, especially in the <code class="literal">/private/var/mobile/Library</code> folder.</p>

        <p>Interestingly, some of this data is also available when performing acquisition of a locked device, even if you don't know the passcode.</p>

      </div>

      <div class="section" title="Locked device with unknown passcode">

        <div class="titlepage">

          <div>

            <div>

              <h3 class="title" id="toc_8"><a id="ch05lvl3sec35"/>Locked device with unknown passcode</h3>

            </div>

          </div>

        </div>

        <p>The new acquisition process can be used to pull some information from 32-bit and 64-bit devices that are locked with an unknown passcode (jailbreak required). This includes devices that were powered on (or rebooted) and never unlocked. Jailbreak is absolutely mandatory; we cannot pull anything from a non-jailbroken device with an unknown passcode!</p>

        <p>The amount of information that can be extracted varies depending on whether the device was unlocked at least once after it powered on or rebooted. If the device was never unlocked after a reboot, only a very limited dataset is available. However, if the user entered the correct passcode at least once, a lot of information (such as the SMS database, contacts database, Wi-Fi password, and so on) is decrypted and can be extracted later on, even after the device is subsequently locked.</p>

        <p>The following data can be pulled from jailbroken, passcode-locked devices:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc">Some geolocation data (cellular tower and compass calibration data, including coordinates)</li>

            <li class="listitem" style="list-style-type: disc">Incoming calls (numbers only) and text messages</li>

            <li class="listitem" style="list-style-type: disc">App and system logs (installs and updates, net access logs, and so on)</li>

            <li class="listitem" style="list-style-type: disc">SQLite temp files, including <span class="strong"><strong>write-ahead logs</strong></span> (<span class="strong"><strong>WAL</strong></span>)</li>

          </ul>

        </div>

        <p>What exactly may or may not be available from a locked device depends, in particular, on whether or not the device was unlocked at least once after booting up. For example, incoming text messages will be placed in a temporary, unencrypted database if the device was never unlocked after booting up. However, if the device was unlocked at least once, all text messages will be transferred into the encrypted database even if they were received while the device was subsequently locked. As a result, if a device was unlocked at least once and it has a jailbreak installed, it may be possible to pull a lot more data compared to devices that were never unlocked after the boot. This is one of the reasons why you should do your best to prevent seized devices from switching off (using the Faraday bag and charger routine).</p>

      </div>

      <div class="section" title="Viewing and analyzing the image">

        <div class="titlepage">

          <div>

            <div>

              <h3 class="title" id="toc_9"><a id="ch05lvl3sec36"/>Viewing and analyzing the image</h3>

            </div>

          </div>

        </div>

        <p>The 64-bit acquisition process returns an archived (<code class="literal">.TAR</code>) image of the device's filesystem. If you are using Windows, simply extracting the files and folders from the TAR archive may not return the complete content of the archive as some files and folders may contain characters that are not allowed in NTFS or exFAT. You can either allow the archiver to rename these files or extract information onto a mounted HFS/HFS+ volume:</p>

        <p> </p>

        <div class="mediaobject">

          <img src="0098.jpeg" alt="Viewing and analyzing the image"/>

        </div>

        <p> </p>

        <p>If you are using a macOS X computer, you could simply mount the DMG image (extracted via the 32-bit process) as a virtual disk. However, the 64-bit process does not return a DMG image, meaning that you'll have to manually extract the filesystem from the TAR archive and analyze the files individually. Converting a TAR image of the filesystem into a mountable DMG image is possible; we are currently working on a tool to perform the conversion on-the-fly during acquisition. Stay tuned for iOS Forensic Toolkit 2.1!</p>

        <p>If you are using a Windows PC to analyze the extracted dataset, you may need to install a third-party tool in order to mount the HFS+ volume. We assembled the following list of tools to help you mount the HFS+ volume on a Windows PC:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>HFSExplorer</strong></span>: <a class="ulink" href="http://www.catacombae.org/hfsexplorer/">http://www.catacombae.org/hfsexplorer/</a> (free)</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Paragon HFS+ for Windows</strong></span>: <a class="ulink" href="https://www.paragon-software.com/home/hfs-windows/">https://www.paragon-software.com/home/hfs-windows/</a> (free or $19.95)</li>

            <li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mediafour MacDrive</strong></span>: <a class="ulink" href="http://www.mediafour.com/software/macdrive/">http://www.mediafour.com/software/macdrive/</a> ($49.99)</li>

          </ul>

        </div>

        <p>You can also try using BootCamp drivers:</p>

        <div class="itemizedlist">

          <ul class="itemizedlist">

            <li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://forums.macrumors.com/threads/apple-hfs-windows-driver-download.1368010/">http://forums.macrumors.com/threads/apple-hfs-windows-driver-download.1368010/</a></li>

            <li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://lpmv.epfl.ch/page-109141-en.html">http://lpmv.epfl.ch/page-109141-en.html</a></li>

          </ul>

        </div>

        <p>Analyzing the extracted dataset is available with many forensic tools. We found BlackLight by BlackBag Technologies to work great on both macOS X and Windows platforms:</p>

        <p> <a class="ulink" href="https://www.blackbagtech.com/software-products/blacklight.html">https://www.blackbagtech.com/software-products/blacklight.html</a> </p>

      </div>

      <div class="section" title="Potential legal implications">

        <div class="titlepage">

          <div>

            <div>

              <h3 class="title" id="toc_10"><a id="ch05lvl3sec37"/>Potential legal implications</h3>

            </div>

          </div>

        </div>

        <p>Physical acquisition for 64-bit devices is a more invasive process compared to acquisition methods available for old hardware. It involves modifying system settings (removing passcode protection), and it does write files onto the phone (OpenSSH must be installed on the device for the process to work). If the device does not have a jailbreak installed, it must be jailbroken prior to acquisition, which once again, modifies the system and data partitions.</p>

        <p>With all that in mind, evidence obtained with the new extraction process may not be admissible in court unless every step is properly documented. Producing and obtaining device backups (making the device produce an offline backup via iTunes or an online one via iCloud) prior to attempting physical acquisition is highly recommended. You can use Elcomsoft Phone Breaker (<a class="ulink" href="https://www.elcomsoft.com/eppb.html">https://www.elcomsoft.com/eppb.html</a>) to decrypt the local backup or download one from iCloud.</p>

      </div>

    </div>

  </div>




  <div class="section" title="Summary">

    <div class="titlepage">

      <div>

        <div>

          <h1 class="title"><a id="ch05lvl1sec28"/>Summary</h1>

        </div>

      </div>

    </div>

    <p>This chapter introduced iOS forensics, detailing available acquisition options for different generations of Apple iOS devices. We reviewed the various acquisition options and learned how to perform physical acquisition of an iOS device using Elcomsoft iOS Forensic Toolkit. We also took a brief look at other acquisition techniques, which will be detailed in the next chapter.</p>

  </div>

</body></html>