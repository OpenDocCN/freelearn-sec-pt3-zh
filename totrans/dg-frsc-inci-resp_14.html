<html><head></head><body>
<div id="_idContainer288">
<h1 class="chapter-number" id="_idParaDest-232"><a id="_idTextAnchor239"/><span class="koboSpan" id="kobo.1.1">14</span></h1>
<h1 id="_idParaDest-233"><a id="_idTextAnchor240"/><span class="koboSpan" id="kobo.2.1">Ransomware Preparation and Response</span></h1>
<p><span class="koboSpan" id="kobo.3.1">With the availability of cryptocurrency, threat actors have been given the necessary tools to extract payment from victims without fear of being caught. </span><span class="koboSpan" id="kobo.3.2">This has led directly to the rise of ransomware, an attack where threat actors deploy malware that encrypts the victim’s files and extorts payment for the victim to get them back. </span><span class="koboSpan" id="kobo.3.3">Over the last 10 years, the development of more sophisticated tools and techniques to compromise victims has led to ransomware attacks impacting governments, large healthcare institutions, and major corporations, all to extract the maximum amount of ransom to enrich the various </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">threat actors.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">Given the prolific nature of ransomware, it is a good bet that incident responders will have to respond to these types of attacks. </span><span class="koboSpan" id="kobo.5.2">To address incidents involving ransomware more effectively, analysts should be familiar with the tactics and techniques, along with the response actions, that will bring them back up and running if an </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">attack occurs.</span></span></p>
<p><span class="koboSpan" id="kobo.7.1">In this chapter, we will focus on the background elements, as </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">outlined here:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.9.1">History </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">of ransomware</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">Conti ransomware </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">case study</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Proper </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">ransomware preparation</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Eradication </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">and recovery</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.17.1">With a solid foundation in place, we will examine specific investigative and analysis techniques in the </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">next chapter.</span></span></p>
<h1 id="_idParaDest-234"><a id="_idTextAnchor241"/><span class="koboSpan" id="kobo.19.1">History of ransomware</span></h1>
<p><span class="koboSpan" id="kobo.20.1">Even though a version of malware</span><a id="_idIndexMarker1155"/><span class="koboSpan" id="kobo.21.1"> that encrypts data has been around since the late 1980s, the current explosion in ransomware coincides with the development of cryptocurrency. </span><span class="koboSpan" id="kobo.21.2">This is the ability to anonymously send and receive digital currency that has allowed ransomware threat actors to execute attacks and extract payment</span><a id="_idIndexMarker1156"/><span class="koboSpan" id="kobo.22.1"> from their victims while remaining anonymous. </span><span class="koboSpan" id="kobo.22.2">Over the past decade, this type of attack has gone through an evolution in terms of sophistication but has largely remained consistent with some core TTPs, such as an initial infection followed by propagating the ransomware and encrypting a user’s files with the intent to extract payment for the decryption key. </span><span class="koboSpan" id="kobo.22.3">We will briefly discuss some of the key variants in this evolution, as seen in the </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">following diagram:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer280">
<span class="koboSpan" id="kobo.24.1"><img alt="Figure 14.1 – A brief history of ransomware " src="image/B18571_14_001.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.25.1">Figure 14.1 – A brief history of ransomware</span></p>
<h2 id="_idParaDest-235"><a id="_idTextAnchor242"/><span class="koboSpan" id="kobo.26.1">CryptoLocker</span></h2>
<p><span class="koboSpan" id="kobo.27.1">The first ransomware attacks</span><a id="_idIndexMarker1157"/><span class="koboSpan" id="kobo.28.1"> took place between</span><a id="_idIndexMarker1158"/><span class="koboSpan" id="kobo.29.1"> September 2013 and May 2014 and utilized the </span><strong class="bold"><span class="koboSpan" id="kobo.30.1">CryptoLocker</span></strong><span class="koboSpan" id="kobo.31.1"> ransomware variant. </span><span class="koboSpan" id="kobo.31.2">This variant was delivered via malicious email attachments</span><a id="_idIndexMarker1159"/><span class="koboSpan" id="kobo.32.1"> and the </span><strong class="bold"><span class="koboSpan" id="kobo.33.1">Gameover ZeuS</span></strong><span class="koboSpan" id="kobo.34.1"> botnet. </span><span class="koboSpan" id="kobo.34.2">This variant of ransomware used the 2,048-bit RSA key to encrypt local files and mapped network drives. </span><span class="koboSpan" id="kobo.34.3">The attack also informed the victim that their files were encrypted, along with directions on how to pay the ransom. </span><span class="koboSpan" id="kobo.34.4">The attackers were halted through law enforcement intervention that ended up taking down the Gameover ZeuS botnet in May 2014. </span><span class="koboSpan" id="kobo.34.5">This intervention even included an indictment of the Russian national Evgeniy Bogachev for his alleged involvement in maintaining the botnet associated with </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">the attacks.</span></span></p>
<h2 id="_idParaDest-236"><a id="_idTextAnchor243"/><span class="koboSpan" id="kobo.36.1">CryptoWall</span></h2>
<p><span class="koboSpan" id="kobo.37.1">The next major variant</span><a id="_idIndexMarker1160"/><span class="koboSpan" id="kobo.38.1"> to hit victim</span><a id="_idIndexMarker1161"/><span class="koboSpan" id="kobo.39.1"> machines was </span><strong class="bold"><span class="koboSpan" id="kobo.40.1">CryptoWall</span></strong><span class="koboSpan" id="kobo.41.1">, coming to prominence after the demise of the CryptoLocker variant. </span><span class="koboSpan" id="kobo.41.2">Much like CryptoLocker, this combined Trojan-ransomware variant used a 2,048-bit RSA encryption algorithm</span><a id="_idIndexMarker1162"/><span class="koboSpan" id="kobo.42.1"> to encrypt the victim’s files. </span><span class="koboSpan" id="kobo.42.2">The primary delivery</span><a id="_idIndexMarker1163"/><span class="koboSpan" id="kobo.43.1"> mechanism of the malware is through compressed files containing </span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">PDF documents.</span></span></p>
<h2 id="_idParaDest-237"><a id="_idTextAnchor244"/><span class="koboSpan" id="kobo.45.1">CTB-Locker</span></h2>
<p><span class="koboSpan" id="kobo.46.1">At about the same time</span><a id="_idIndexMarker1164"/><span class="koboSpan" id="kobo.47.1"> the CryptoWall and CryptoLocker</span><a id="_idIndexMarker1165"/><span class="koboSpan" id="kobo.48.1"> variants were prominent, the </span><strong class="bold"><span class="koboSpan" id="kobo.49.1">CTB-Locker</span></strong><span class="koboSpan" id="kobo.50.1"> variant was also infecting victims’ systems. </span><span class="koboSpan" id="kobo.50.2">Delivered mostly through malicious email attachments or fake downloads, this variant did add</span><a id="_idIndexMarker1166"/><span class="koboSpan" id="kobo.51.1"> some additional features, such as the use of </span><strong class="bold"><span class="koboSpan" id="kobo.52.1">The Onion Routing</span></strong><span class="koboSpan" id="kobo.53.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.54.1">TOR</span></strong><span class="koboSpan" id="kobo.55.1">) network for Command and Control, as well as deleting the Volume Shadow Copy of infected systems to </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">inhibit recovery.</span></span></p>
<p><span class="koboSpan" id="kobo.57.1">One additional feature that CTB-Locker</span><a id="_idIndexMarker1167"/><span class="koboSpan" id="kobo.58.1"> leveraged was the affiliate model or </span><strong class="bold"><span class="koboSpan" id="kobo.59.1">Ransomware-as-a-Service</span></strong><span class="koboSpan" id="kobo.60.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.61.1">RaaS</span></strong><span class="koboSpan" id="kobo.62.1">). </span><span class="koboSpan" id="kobo.62.2">In this model, independent threat actors are given access to the ransomware and associated tools to conduct the attacks with a portion of their ransom being paid to the threat actors running the </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">ransomware operation.</span></span></p>
<h2 id="_idParaDest-238"><a id="_idTextAnchor245"/><span class="koboSpan" id="kobo.64.1">TeslaCrypt</span></h2>
<p><span class="koboSpan" id="kobo.65.1">While most ransomware</span><a id="_idIndexMarker1168"/><span class="koboSpan" id="kobo.66.1"> encrypts a wide variety</span><a id="_idIndexMarker1169"/><span class="koboSpan" id="kobo.67.1"> of files, the </span><strong class="bold"><span class="koboSpan" id="kobo.68.1">TeslaCrypt</span></strong><span class="koboSpan" id="kobo.69.1"> variant targeted files associated with online gaming. </span><span class="koboSpan" id="kobo.69.2">The initial version of TeslaCrypt would encrypt saved games, player profiles, and game modifications. </span><span class="koboSpan" id="kobo.69.3">It was only in later versions that the variant would encrypt more Microsoft and other common files.  </span><span class="koboSpan" id="kobo.69.4">TeslaCrypt utilized the Angler Adobe Flash exploit to infect systems using an asymmetrical encryption key. </span><span class="koboSpan" id="kobo.69.5">The initial versions contained a flaw in the encryption scheme and decrypters were released by Cisco Talos. </span><span class="koboSpan" id="kobo.69.6">In May 2016, the TeslaCrypt threat actors ceased their operations and released a </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">decryption key.</span></span></p>
<h2 id="_idParaDest-239"><a id="_idTextAnchor246"/><span class="koboSpan" id="kobo.71.1">SamSam</span></h2>
<p><span class="koboSpan" id="kobo.72.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.73.1">SamSam</span></strong><span class="koboSpan" id="kobo.74.1"> ransomware variant</span><a id="_idIndexMarker1170"/><span class="koboSpan" id="kobo.75.1"> originated</span><a id="_idIndexMarker1171"/><span class="koboSpan" id="kobo.76.1"> in Iran, as indicated by the indictment of two Iranian nationals Faramarz Shahi Savandi and Mohammed Mehdi Shah Mansouri. </span><span class="koboSpan" id="kobo.76.2">Throughout their campaign, the SamSam ransomware infected over 200 organizations in the United States, collecting an estimated $6 million from victims. </span><span class="koboSpan" id="kobo.76.3">The attacks</span><a id="_idIndexMarker1172"/><span class="koboSpan" id="kobo.77.1"> leveraged vulnerabilities in the </span><strong class="bold"><span class="koboSpan" id="kobo.78.1">Remote Desktop Protocol</span></strong><span class="koboSpan" id="kobo.79.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.80.1">RDP</span></strong><span class="koboSpan" id="kobo.81.1">) or Java-based web servers to gain an initial foothold in the victim’s network. </span><span class="koboSpan" id="kobo.81.2">From there, the threat actors</span><a id="_idIndexMarker1173"/><span class="koboSpan" id="kobo.82.1"> would move laterally and encrypt</span><a id="_idIndexMarker1174"/><span class="koboSpan" id="kobo.83.1"> as many systems as possible with a 2,048-bit RSA </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">encryption algorithm.</span></span></p>
<h2 id="_idParaDest-240"><a id="_idTextAnchor247"/><span class="koboSpan" id="kobo.85.1">Locky</span></h2>
<p><span class="koboSpan" id="kobo.86.1">One common tactic that’s used by ransomware</span><a id="_idIndexMarker1175"/><span class="koboSpan" id="kobo.87.1"> threat actors is the use of a macro-enabled Microsoft Word</span><a id="_idIndexMarker1176"/><span class="koboSpan" id="kobo.88.1"> document. </span><span class="koboSpan" id="kobo.88.2">Using phishing techniques, victims are enticed to open the document with macros enabled. </span><span class="koboSpan" id="kobo.88.3">Once this is done, the macro downloads a Trojan virus that encrypts the system. </span><span class="koboSpan" id="kobo.88.4">The threat actors behind </span><strong class="bold"><span class="koboSpan" id="kobo.89.1">Locky</span></strong><span class="koboSpan" id="kobo.90.1"> used this technique to great effect across a variety of victims. </span><span class="koboSpan" id="kobo.90.2">Using either an RSA or AES cipher, the malware variant can encrypt files on the drive, removable drives, and </span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">network-connected drives.</span></span></p>
<h2 id="_idParaDest-241"><a id="_idTextAnchor248"/><span class="koboSpan" id="kobo.92.1">WannaCry</span></h2>
<p><span class="koboSpan" id="kobo.93.1">A short-lived</span><a id="_idIndexMarker1177"/><span class="koboSpan" id="kobo.94.1"> but devastating attack, </span><strong class="bold"><span class="koboSpan" id="kobo.95.1">WannaCry</span></strong><span class="koboSpan" id="kobo.96.1"> was a high-profile attack</span><a id="_idIndexMarker1178"/><span class="koboSpan" id="kobo.97.1"> that impacted over 200,000 computers across the globe. </span><span class="koboSpan" id="kobo.97.2">This attack used the recently disclosed Eternal Blue exploit, which leveraged a vulnerability in the Microsoft SMB</span><a id="_idIndexMarker1179"/><span class="koboSpan" id="kobo.98.1"> service using the backdoor tool </span><strong class="bold"><span class="koboSpan" id="kobo.99.1">DoublePulsar</span></strong><span class="koboSpan" id="kobo.100.1">, which allowed the ransomware to install and copy itself to other systems. </span><span class="koboSpan" id="kobo.100.2">The WannaCry attack lasted only a few hours on May 12, 2017, after a security researcher, Marcus Hutchins, discovered a kill switch that prevented additional infections. </span><span class="koboSpan" id="kobo.100.3">After additional research, the United States and the United Kingdom both attributed the attack to the North </span><span class="No-Break"><span class="koboSpan" id="kobo.101.1">Korean government.</span></span></p>
<h2 id="_idParaDest-242"><a id="_idTextAnchor249"/><span class="koboSpan" id="kobo.102.1">Ryuk</span></h2>
<p><span class="koboSpan" id="kobo.103.1">Thought to be the work</span><a id="_idIndexMarker1180"/><span class="koboSpan" id="kobo.104.1"> of the Russian cybercriminal</span><a id="_idIndexMarker1181"/><span class="koboSpan" id="kobo.105.1"> group Wizard Spider, Ryuk has the distinction of demanding the top three highest payments in 2020. </span><span class="koboSpan" id="kobo.105.2">This shows the group behind </span><strong class="bold"><span class="koboSpan" id="kobo.106.1">Ryuk</span></strong><span class="koboSpan" id="kobo.107.1"> targets large organizations for large payouts. </span><span class="koboSpan" id="kobo.107.2">The ransomware can shut down 180 services and 40 processes to ensure the maximum impact on the victim’s systems. </span><span class="koboSpan" id="kobo.107.3">The data is encrypted with an AES-256 symmetric key that is further encrypted with a 4,096-bit RSA key, making the encrypted files near impossible</span><a id="_idIndexMarker1182"/><span class="koboSpan" id="kobo.108.1"> to recover without the key. </span><span class="koboSpan" id="kobo.108.2">Making use of the RaaS, Ryuk uses </span><strong class="bold"><span class="koboSpan" id="kobo.109.1">Download-as-a-Service</span></strong><span class="koboSpan" id="kobo.110.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.111.1">DaaS</span></strong><span class="koboSpan" id="kobo.112.1">), in which the malware coders use a third party to deliver the ransomware to </span><span class="No-Break"><span class="koboSpan" id="kobo.113.1">the target.</span></span></p>
<p><span class="koboSpan" id="kobo.114.1">Ryuk also uses a more complex multi-stage attack. </span><span class="koboSpan" id="kobo.114.2">In this case, a phishing email is sent to a victim. </span><span class="koboSpan" id="kobo.114.3">Once the attachment, such as a macro-enabled Word</span><a id="_idIndexMarker1183"/><span class="koboSpan" id="kobo.115.1"> document, is opened, an additional tool, referred to as a dropper, is used. </span><span class="koboSpan" id="kobo.115.2">These droppers, such as BazarBackdoor or Trickbot, will often be used to add additional tools for command and control. </span><span class="koboSpan" id="kobo.115.3">Once control is established, the ransomware is loaded </span><span class="No-Break"><span class="koboSpan" id="kobo.116.1">and executed.</span></span></p>
<p><span class="koboSpan" id="kobo.117.1">Ryuk is closely related</span><a id="_idIndexMarker1184"/><span class="koboSpan" id="kobo.118.1"> to another prolific variant, Conti. </span><span class="koboSpan" id="kobo.118.2">This variant represents a highly</span><a id="_idIndexMarker1185"/><span class="koboSpan" id="kobo.119.1"> sophisticated tool that combines the elements of ransomware variants from past versions into a highly </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">impactful attack.</span></span></p>
<h1 id="_idParaDest-243"><a id="_idTextAnchor250"/><span class="koboSpan" id="kobo.121.1">Conti ransomware case study</span></h1>
<p><span class="koboSpan" id="kobo.122.1">One of the most prolific ransomware</span><a id="_idIndexMarker1186"/><span class="koboSpan" id="kobo.123.1"> variants to hit is Conti. </span><span class="koboSpan" id="kobo.123.2">There are two aspects to Conti that make it stand out in terms of threat actors. </span><span class="koboSpan" id="kobo.123.3">The first of these aspects is that Conti is a RaaS threat actor. </span><span class="koboSpan" id="kobo.123.4">This type of threat actor uses an affiliate model where highly skilled recruits are found on hacking forums. </span><span class="koboSpan" id="kobo.123.5">From there, they are provided the tools and techniques necessary to execute the initial stage: attack and deploy ransomware. </span><span class="koboSpan" id="kobo.123.6">The original coders of the Conti variant are then provided a fee of anywhere between 10 to 30 percent of </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">the ransom.</span></span></p>
<p><span class="koboSpan" id="kobo.125.1">The second of these is that Conti affiliates will often exfiltrate data, along with encrypting files. </span><span class="koboSpan" id="kobo.125.2">This data is then held “hostage” by the affiliate for ransom. </span><span class="koboSpan" id="kobo.125.3">If the victim organization did not pay in time, the data would be released. </span><span class="koboSpan" id="kobo.125.4">Conti affiliates were even able to use a website both on the internet and on the dark web to post </span><span class="No-Break"><span class="koboSpan" id="kobo.126.1">the data.</span></span></p>
<p><span class="koboSpan" id="kobo.127.1">Before being shut down, the Conti variant and the affiliates used a wide variety of tools and techniques that serve as a good case study of how ransomware threat actors operate. </span><span class="koboSpan" id="kobo.127.2">In this case, first, we will look at the affiliate’s background, disclosures, and the TTPs that the group and its affiliates use as part of </span><span class="No-Break"><span class="koboSpan" id="kobo.128.1">their attacks.</span></span></p>
<h2 id="_idParaDest-244"><a id="_idTextAnchor251"/><span class="koboSpan" id="kobo.129.1">Background</span></h2>
<p><span class="koboSpan" id="kobo.130.1">The RaaS model</span><a id="_idIndexMarker1187"/><span class="koboSpan" id="kobo.131.1"> was first observed in December 2019. </span><span class="koboSpan" id="kobo.131.2">The name Conti refers to the specific variant of malware that is used, often deployed with the Trickbot Trojan developed by the threat actor Wizard Spider. </span><span class="koboSpan" id="kobo.131.3">This group, first seen in September 2016, is believed to be based in Russia and is a sophisticated financially motivated </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">threat actor.</span></span></p>
<p><span class="koboSpan" id="kobo.133.1">While operational, the RaaS threat actors tied to Conti have attacked a variety of organizations, including the government and large enterprises. </span><span class="koboSpan" id="kobo.133.2">Even during the COVID-19 pandemic, the affiliates had carried out attacks against 16 separate healthcare or first-responder networks. </span><span class="koboSpan" id="kobo.133.3">Some of these attacks carried a ransom of 25 million </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">dollars US.</span></span></p>
<p><span class="koboSpan" id="kobo.135.1">One key facet of the affiliate model that Conti utilizes is the sophisticated task division within the overall organization. </span><span class="koboSpan" id="kobo.135.2">There are specific teams that handle the technical aspects of initial access and then hand off the remaining work to another team. </span><span class="koboSpan" id="kobo.135.3">There are also specific teams that handle the ransomware negotiations with the </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">victim organization.</span></span></p>
<p><span class="koboSpan" id="kobo.137.1">Conti also added a new element to the already lucrative ransomware threat by adding another extortion element to their attacks. </span><span class="koboSpan" id="kobo.137.2">Conti set up websites both on the publicly available internet and the dark web where they would threaten the release of exfiltrated data to the public if their demands were not met. </span><span class="koboSpan" id="kobo.137.3">This was done to force more pressure on victims to pay the ransom to not only get their data decrypted but also save themselves from the embarrassment of </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">public disclosure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer281">
<span class="koboSpan" id="kobo.139.1"><img alt="Figure 14.2 – Conti disclosure site " src="image/B18571_14_002.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.140.1">Figure 14.2 – Conti disclosure site</span></p>
<p><span class="koboSpan" id="kobo.141.1">On the same website, Conti actors also threatened retaliation for the crisis that began with the Russian invasion of Ukraine in 2022. </span><span class="koboSpan" id="kobo.141.2">This declaration was followed by increased attacks by the group against targets in Ukraine. </span><span class="koboSpan" id="kobo.141.3">The major difference was that the attacks were carried out against government networks and critical infrastructure in a departure from the ransom </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">extraction motive:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer282">
<span class="koboSpan" id="kobo.143.1"><img alt="Figure 14.3 – Conti Ukraine response " src="image/B18571_14_003.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.144.1">Figure 14.3 – Conti Ukraine response</span></p>
<p><span class="koboSpan" id="kobo.145.1">In its short 2 years of operations, Conti </span><a id="_idIndexMarker1188"/><span class="koboSpan" id="kobo.146.1">and its affiliates became a major threat to organizations, ranging from government, healthcare, critical infrastructure, and large corporations. </span><span class="koboSpan" id="kobo.146.2">Their sophisticated model of task division and technical ability made it a model for potential future threat actors to emulate. </span><span class="koboSpan" id="kobo.146.3">Given this, it caught many by surprise when the group ceased its operations in May 2022, shutting down its infrastructure, including its disclosure site. </span><span class="koboSpan" id="kobo.146.4">Affiliate members then went on to other groups. </span><span class="koboSpan" id="kobo.146.5">One event may have accelerated the group’s demise and that was the disclosure of internal documents and tools by an </span><span class="No-Break"><span class="koboSpan" id="kobo.147.1">affiliate member.</span></span></p>
<h2 id="_idParaDest-245"><a id="_idTextAnchor252"/><span class="koboSpan" id="kobo.148.1">Operational disclosure</span></h2>
<p><span class="koboSpan" id="kobo.149.1">On August 5, 2021, a user with the screen</span><a id="_idIndexMarker1189"/><span class="koboSpan" id="kobo.150.1"> name </span><strong class="source-inline"><span class="koboSpan" id="kobo.151.1">m1Geelka</span></strong><span class="koboSpan" id="kobo.152.1"> posted to the Russian language cybersecurity forum </span><strong class="source-inline"><span class="koboSpan" id="kobo.153.1">xss.is</span></strong><span class="koboSpan" id="kobo.154.1"> the technical and operational manuals used by the Conti ransomware group and its affiliates. </span><span class="koboSpan" id="kobo.154.2">The user posted a link to download the manuals and software from a file-sharing site for anyone with access to the forum. </span><span class="koboSpan" id="kobo.154.3">This post was soon deleted but for security researchers, it was a bonanza of data and intelligence into the </span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">group’s operations:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer283">
<span class="koboSpan" id="kobo.156.1"><img alt="Figure 14.4 – Conti disclosure " src="image/B18571_14_004.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.157.1">Figure 14.4 – Conti disclosure</span></p>
<p><span class="koboSpan" id="kobo.158.1">The disclosures</span><a id="_idIndexMarker1190"/><span class="koboSpan" id="kobo.159.1"> are still currently available at </span><a href="https://share.vx-underground.org/Conti/"><span class="koboSpan" id="kobo.160.1">https://share.vx-underground.org/Conti/</span></a><span class="koboSpan" id="kobo.161.1"> and include updates from additional disclosures of the Conti group’s TTPs from February and March 2022. </span><span class="koboSpan" id="kobo.161.2">For example, the disclosed documents included screen captures of the use of tools such as Cobalt Strike, as </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer284">
<span class="koboSpan" id="kobo.163.1"><img alt="Figure 14.5 – Conti Cobalt Strike use " src="image/B18571_14_005.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.164.1">Figure 14.5 – Conti Cobalt Strike use</span></p>
<p><span class="koboSpan" id="kobo.165.1">The disclosures</span><a id="_idIndexMarker1191"/><span class="koboSpan" id="kobo.166.1"> included other key details of the group’s operations and methods. </span><span class="koboSpan" id="kobo.166.2">This included chat logs, source code, and manuals related to tool use. </span><span class="koboSpan" id="kobo.166.3">The unique feature of this disclosure was the near complete picture of the threat actors and their affiliate’s operational methods and tools. </span><span class="koboSpan" id="kobo.166.4">Using this data, we can get a picture of the specific tactics and techniques a sophisticated ransomware group can employ and better prepare to defend and detect </span><span class="No-Break"><span class="koboSpan" id="kobo.167.1">against them.</span></span></p>
<h2 id="_idParaDest-246"><a id="_idTextAnchor253"/><span class="koboSpan" id="kobo.168.1">Tactics and techniques</span></h2>
<p><span class="koboSpan" id="kobo.169.1">Conti affiliates utilize a variety</span><a id="_idIndexMarker1192"/><span class="koboSpan" id="kobo.170.1"> of tactics and techniques. </span><span class="koboSpan" id="kobo.170.2">In this section, we will examine some of the more common of these as there is significant overlap with those used by affiliates and other ransomware threat actors. </span><span class="koboSpan" id="kobo.170.3">For a complete breakdown of the TTPs associated with the Conti ransomware</span><a id="_idIndexMarker1193"/><span class="koboSpan" id="kobo.171.1"> variant, consult the MITRE ATT&amp;CK profile at </span><a href="https://attack.mitre.org/software/S0575/"><span class="koboSpan" id="kobo.172.1">https://attack.mitre.org/software/S0575/</span></a><span class="koboSpan" id="kobo.173.1">. </span><span class="koboSpan" id="kobo.173.2">For context on an actual Conti ransomware campaign, the </span><strong class="bold"><span class="koboSpan" id="kobo.174.1">Cybersecurity and Infrastructure Agency</span></strong><span class="koboSpan" id="kobo.175.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.176.1">CISA</span></strong><span class="koboSpan" id="kobo.177.1">) published an advisory concerning</span><a id="_idIndexMarker1194"/><span class="koboSpan" id="kobo.178.1"> the Conti threat actors with a detailed breakdown of the MITRE ATT&amp;CK tactics that were observed</span><a id="_idIndexMarker1195"/><span class="koboSpan" id="kobo.179.1"> during over a thousand </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">attacks: </span></span><a href="https://www.cisa.gov/uscert/sites/default/files/publications/AA21-265A-Conti_Ransomware_TLP_WHITE.pdf"><span class="No-Break"><span class="koboSpan" id="kobo.181.1">https://www.cisa.gov/uscert/sites/default/files/publications/AA21-265A-Conti_Ransomware_TLP_WHITE.pdf</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.182.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.183.1">Initial access</span></h3>
<p><span class="koboSpan" id="kobo.184.1">The primary method</span><a id="_idIndexMarker1196"/><span class="koboSpan" id="kobo.185.1"> that Conti leverages is </span><strong class="bold"><span class="koboSpan" id="kobo.186.1">Spear Phishing campaigns [T1566.001]</span></strong><span class="koboSpan" id="kobo.187.1"> or the use of </span><strong class="bold"><span class="koboSpan" id="kobo.188.1">Malicious Links [1566.002]</span></strong><span class="koboSpan" id="kobo.189.1"> contained within an email. </span><span class="koboSpan" id="kobo.189.2">Emails </span><a id="_idIndexMarker1197"/><span class="koboSpan" id="kobo.190.1">will often contain a macro-enabled Microsoft Word document</span><a id="_idIndexMarker1198"/><span class="koboSpan" id="kobo.191.1"> with a filename deliberately chosen to entice a user to open the attachment. </span><span class="koboSpan" id="kobo.191.2">In other incidents, the Conti affiliates have been known to use compromised credentials to connect to internet-exposed systems with RDP enabled. </span><span class="koboSpan" id="kobo.191.3">This allows them to establish a foothold within the network without the need to send a </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">phishing email.</span></span></p>
<p><span class="koboSpan" id="kobo.193.1">Other affiliates used pretext calls, where they pretended to be a helpdesk person and had the user download a remote access software such as GoToAssist. </span><span class="koboSpan" id="kobo.193.2">From there, the attacker can place malware or other tools to begin the </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">follow-on actions.</span></span></p>
<h3><span class="koboSpan" id="kobo.195.1">Execution</span></h3>
<p><span class="koboSpan" id="kobo.196.1">Once the macro-enabled</span><a id="_idIndexMarker1199"/><span class="koboSpan" id="kobo.197.1"> Word document</span><a id="_idIndexMarker1200"/><span class="koboSpan" id="kobo.198.1"> is opened, the macro will often execute a Windows PowerShell script to execute the </span><strong class="bold"><span class="koboSpan" id="kobo.199.1">Command and Scripting Interpreter: PowerShell [T1059.001]</span></strong><span class="koboSpan" id="kobo.200.1"> technique. </span><span class="koboSpan" id="kobo.200.2">This script is often used to download a secondary payload, often a RAT such as Trickbot, Qbot, or Bazar. </span><span class="koboSpan" id="kobo.200.3">This establishes the initial foothold into the </span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">victim’s network.</span></span></p>
<p><span class="koboSpan" id="kobo.202.1">A few methods must be used to execute the malware. </span><span class="koboSpan" id="kobo.202.2">One technique that’s often used by Contin affiliates is to warp the RAT in a DLL file. </span><span class="koboSpan" id="kobo.202.3">This file </span><a id="_idIndexMarker1201"/><span class="koboSpan" id="kobo.203.1">will then be placed in a directory. </span><span class="koboSpan" id="kobo.203.2">The Windows </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">rundll32.exe</span></strong><span class="koboSpan" id="kobo.205.1"> executable will be used to execute the RAT in what is referred to as a </span><strong class="bold"><span class="koboSpan" id="kobo.206.1">System Binary Proxy Execution: Rundll32 [T1218.011]</span></strong><span class="koboSpan" id="kobo.207.1">. </span><span class="koboSpan" id="kobo.207.2">This technique is still seen in the wild, even though many EDR tools can detect </span><span class="No-Break"><span class="koboSpan" id="kobo.208.1">such behavior.</span></span></p>
<p><span class="koboSpan" id="kobo.209.1">It is here that we will also start looking at the tool Cobalt Strike. </span><span class="koboSpan" id="kobo.209.2">This tool is often found in ransomware incidents and is commonly associated with Conti. </span><span class="koboSpan" id="kobo.209.3">This tool is a commercial post-exploitation tool that has a wide range of functionality within an integrated system. </span><span class="koboSpan" id="kobo.209.4">Cobalt Strike also includes other common post-exploitation frameworks such as Metasploit and post-exploitation tools such as Mimikatz, which can be used for a variety of credential threat and abuse attacks. </span><span class="koboSpan" id="kobo.209.5">The overall look and feel of the tool are similar to that of Armitage, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer285">
<span class="koboSpan" id="kobo.211.1"><img alt="Figure 14.6 – Cobalt Strike GUI " src="image/B18571_14_006.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.212.1">Figure 14.6 – Cobalt Strike GUI</span></p>
<p><span class="koboSpan" id="kobo.213.1">Cobalt Strike</span><a id="_idIndexMarker1202"/><span class="koboSpan" id="kobo.214.1"> will often be executed alongside or in place of the RAT that is executed at this stage of </span><span class="No-Break"><span class="koboSpan" id="kobo.215.1">the attack.</span></span></p>
<h3><span class="koboSpan" id="kobo.216.1">Privilege escalation</span></h3>
<p><span class="koboSpan" id="kobo.217.1">Wizard Spider</span><a id="_idIndexMarker1203"/><span class="koboSpan" id="kobo.218.1"> has been observed loading a malicious DLL file</span><a id="_idIndexMarker1204"/><span class="koboSpan" id="kobo.219.1"> into an existing or running process in an attack referred to as </span><strong class="bold"><span class="koboSpan" id="kobo.220.1">Process Injection: Dynamic-link Library Injection [T1055.001]</span></strong><span class="koboSpan" id="kobo.221.1">. </span><span class="koboSpan" id="kobo.221.2">In this technique, the attacker can inject arbitrary code into a running process. </span><span class="koboSpan" id="kobo.221.3">This allows the attackers to execute the malicious code and bypass detection. </span><span class="koboSpan" id="kobo.221.4">Depending on the process written to, the malicious code may also be run at </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">elevated privileges.</span></span></p>
<h3><span class="koboSpan" id="kobo.223.1">Defense evasion</span></h3>
<p><span class="koboSpan" id="kobo.224.1">Modern antivirus and EDR</span><a id="_idIndexMarker1205"/><span class="koboSpan" id="kobo.225.1"> solutions have gotten much better at detecting malware, exploits, and other malicious activity on endpoints. </span><span class="koboSpan" id="kobo.225.2">Ransomware threat actors such as Conti use a variety of methods to ensure that they are not detected and stopped. </span><span class="koboSpan" id="kobo.225.3">In addition to process injection, the Cobalt Strike platform</span><a id="_idIndexMarker1206"/><span class="koboSpan" id="kobo.226.1"> has additional functionality that allows threat actors</span><a id="_idIndexMarker1207"/><span class="koboSpan" id="kobo.227.1"> to maintain stealth. </span><span class="koboSpan" id="kobo.227.2">For example, the tool uses the </span><strong class="bold"><span class="koboSpan" id="kobo.228.1">Obfuscated Files or Information [T1027]</span></strong><span class="koboSpan" id="kobo.229.1"> technique by hashing API Windows API calls so that antivirus or EDR tools do not identify any of the suspicious API calls associated with Cobalt </span><span class="No-Break"><span class="koboSpan" id="kobo.230.1">Strike usage.</span></span></p>
<p><span class="koboSpan" id="kobo.231.1">One additional defense evasion tactic that is often observed not only with Conti but many of the ransomware threat actors is the use of Base64 encoding for PowerShell scripts. </span><span class="koboSpan" id="kobo.231.2">This provides a measure of obfuscation by doesn’t write specific commands to the storage. </span><span class="koboSpan" id="kobo.231.3">Instead, it relies on PowerShell to decode and execute the commands. </span><span class="koboSpan" id="kobo.231.4">For example, the following Windows Event Log entry shows the </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">Base64-encoded script:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer286">
<span class="koboSpan" id="kobo.233.1"><img alt="Figure 14.7 – Base64-encoded PowerShell script " src="image/B18571_14_007.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.234.1">Figure 14.7 – Base64-encoded PowerShell script</span></p>
<h3><span class="koboSpan" id="kobo.235.1">Credential access</span></h3>
<p><span class="koboSpan" id="kobo.236.1">Accessing or creating</span><a id="_idIndexMarker1208"/><span class="koboSpan" id="kobo.237.1"> valid credentials with elevated privileges is critical to the lateral movement components of ransomware attacks. </span><span class="koboSpan" id="kobo.237.2">Conti utilizes a few different tools and techniques to gain access to credentials. </span><span class="koboSpan" id="kobo.237.3">The first of these is the use of the Sysinternals tool </span><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">procdump.exe</span></strong><span class="koboSpan" id="kobo.239.1">. </span><span class="koboSpan" id="kobo.239.2">This</span><a id="_idIndexMarker1209"/><span class="koboSpan" id="kobo.240.1"> tool is used in the </span><strong class="bold"><span class="koboSpan" id="kobo.241.1">OS Credential Dumping: LSASS Memory [T1003.001]</span></strong><span class="koboSpan" id="kobo.242.1"> technique, where it is leveraged to dump the </span><strong class="bold"><span class="koboSpan" id="kobo.243.1">Local Security Authority Subsystem Service</span></strong><span class="koboSpan" id="kobo.244.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.245.1">LSASS</span></strong><span class="koboSpan" id="kobo.246.1">), which contains the Windows </span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">OS</span></span><span class="No-Break"><a id="_idIndexMarker1210"/></span><span class="No-Break"><span class="koboSpan" id="kobo.248.1"> credentials.</span></span></p>
<p><span class="koboSpan" id="kobo.249.1">Conti has also used the post-exploitation tool Mimikatz to perform a similar type of action as the Windows Sysinternals tool </span><strong class="source-inline"><span class="koboSpan" id="kobo.250.1">procdump.exe</span></strong><span class="koboSpan" id="kobo.251.1">. </span><span class="koboSpan" id="kobo.251.2">The binary and associated files are available on GitHub at </span><a href="https://github.com/ParrotSec/mimikatz"><span class="koboSpan" id="kobo.252.1">https://github.com/ParrotSec/mimikatz</span></a><span class="koboSpan" id="kobo.253.1">. </span><span class="koboSpan" id="kobo.253.2">Mimikatz can also obtain the plaintext passwords of user and administrator accounts on the system, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.254.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer287">
<span class="koboSpan" id="kobo.255.1"><img alt="Figure 14.8 – Mimikatz " src="image/B18571_14_008.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.256.1">Figure 14.8 – Mimikatz</span></p>
<p><span class="koboSpan" id="kobo.257.1">Mimikatz can also acquire Kerberos tickets, along with other features, to obtain access to valid credentials. </span><span class="koboSpan" id="kobo.257.2">Post-exploitation</span><a id="_idIndexMarker1211"/><span class="koboSpan" id="kobo.258.1"> frameworks such as Metasploit and Cobalt Strike </span><span class="No-Break"><span class="koboSpan" id="kobo.259.1">include Mimikatz.</span></span></p>
<h3><span class="koboSpan" id="kobo.260.1">Discovery</span></h3>
<p><span class="koboSpan" id="kobo.261.1">Once an established foothold</span><a id="_idIndexMarker1212"/><span class="koboSpan" id="kobo.262.1"> has been achieved, ransomware actors such as Conti will need to map the internal network to determine the best way to impact as many systems as possible. </span><span class="koboSpan" id="kobo.262.2">In some instances, this includes running command-line tools such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">net localgroup</span></strong><span class="koboSpan" id="kobo.264.1">. </span><span class="koboSpan" id="kobo.264.2">Conti has been known to use the network discovery functionality within Cobalt Strike. </span><span class="koboSpan" id="kobo.264.3">Finally, for more complex networks, you can use the Active Directory mapping tool Bloodhound, available at </span><a href="https://github.com/BloodHoundAD/BloodHound"><span class="koboSpan" id="kobo.265.1">https://github.com/BloodHoundAD/BloodHound</span></a><span class="koboSpan" id="kobo.266.1">. </span><span class="koboSpan" id="kobo.266.2">This tool allows the attacker to not only map the network but also provide a visual graph. </span><span class="koboSpan" id="kobo.266.3">This, in turn, may provide insight into the best </span><span class="No-Break"><span class="koboSpan" id="kobo.267.1">attack path.</span></span></p>
<h3><span class="koboSpan" id="kobo.268.1">Lateral movement</span></h3>
<p><span class="koboSpan" id="kobo.269.1">Before executing</span><a id="_idIndexMarker1213"/><span class="koboSpan" id="kobo.270.1"> this tactic, the malicious activity is largely contained to a few systems that have either been compromised with the initial execution of the RAT or have been compromised by additional tools. </span><span class="koboSpan" id="kobo.270.2">The next phase after discovery is lateral movement. </span><span class="koboSpan" id="kobo.270.3">This is where Conti actors are attempting to compromise as many systems as possible so that the impact of the ransomware will be sufficient to cause the victim to pay </span><span class="No-Break"><span class="koboSpan" id="kobo.271.1">the ransom.</span></span></p>
<p><span class="koboSpan" id="kobo.272.1">Lateral movement for ransomware is largely dependent on having access to credentials, often with elevated privileges</span><a id="_idIndexMarker1214"/><span class="koboSpan" id="kobo.273.1"> that allow the use of remote access either through the </span><strong class="bold"><span class="koboSpan" id="kobo.274.1">Server Message Block</span></strong><span class="koboSpan" id="kobo.275.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.276.1">SMB</span></strong><span class="koboSpan" id="kobo.277.1">) or RDP. </span><span class="koboSpan" id="kobo.277.2">In the case of SMB, the</span><a id="_idIndexMarker1215"/><span class="koboSpan" id="kobo.278.1"> specific technique is referred to as </span><strong class="bold"><span class="koboSpan" id="kobo.279.1">Remote Services: SMB/Windows Admin Shares [T1021.002]</span></strong><span class="koboSpan" id="kobo.280.1">. </span><span class="koboSpan" id="kobo.280.2">In this technique, the attacker will often use the Windows Sysinternals tool PsExec to connect to and write to the ADMIN$ network share. </span><span class="koboSpan" id="kobo.280.3">They are then able to execute additional commands or transfer malicious tools </span><span class="No-Break"><span class="koboSpan" id="kobo.281.1">and executables.</span></span></p>
<p><span class="koboSpan" id="kobo.282.1">Another technique</span><a id="_idIndexMarker1216"/><span class="koboSpan" id="kobo.283.1"> that is often leveraged is </span><strong class="bold"><span class="koboSpan" id="kobo.284.1">Remote Services: Remote Desktop Protocol [1021.001]</span></strong><span class="koboSpan" id="kobo.285.1">. </span><span class="koboSpan" id="kobo.285.2">In this case, Conti can leverage the </span><strong class="bold"><span class="koboSpan" id="kobo.286.1">Virtual Network Computing</span></strong><span class="koboSpan" id="kobo.287.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.288.1">VNC</span></strong><span class="koboSpan" id="kobo.289.1">) functionality of Cobalt Strike to connect</span><a id="_idIndexMarker1217"/><span class="koboSpan" id="kobo.290.1"> to additional systems running RDP. </span><span class="koboSpan" id="kobo.290.2">From here, they can execute additional commands or place additional tools on newly </span><span class="No-Break"><span class="koboSpan" id="kobo.291.1">compromised systems.</span></span></p>
<p><span class="koboSpan" id="kobo.292.1">An aspect of these techniques</span><a id="_idIndexMarker1218"/><span class="koboSpan" id="kobo.293.1"> is that they depend on having access to legitimate </span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">administrator-level credentials.</span></span></p>
<h3><span class="koboSpan" id="kobo.295.1">Command and Control</span></h3>
<p><span class="koboSpan" id="kobo.296.1">One of the key components</span><a id="_idIndexMarker1219"/><span class="koboSpan" id="kobo.297.1"> of the Cobalt Strike post-exploitation tool is its ability to customize Command and Control infrastructure. </span><span class="koboSpan" id="kobo.297.2">The tool makes use of listeners, which are configured by the threat actor. </span><span class="koboSpan" id="kobo.297.3">Threat actors can configure the listener to use a variety of TCP and UDP protocols such as DNS, HTTP, </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">and HTTPS.</span></span></p>
<p><span class="koboSpan" id="kobo.299.1">In addition to the listener, threat actors can also configure an array of malleable C2 profiles. </span><span class="koboSpan" id="kobo.299.2">These profiles allow the threat actor to obfuscate the C2 traffic to bypass detection mechanisms such as intrusion detection or intrusion prevention systems. </span><span class="koboSpan" id="kobo.299.3">For example, the following section of a malleable profile was taken from </span><a href="https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/amazon.profile"><span class="koboSpan" id="kobo.300.1">https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/amazon.profile</span></a><span class="koboSpan" id="kobo.301.1">. </span><span class="koboSpan" id="kobo.301.2">In this profile, the C2 traffic is designed to mimic normal HTTP traffic. </span><span class="koboSpan" id="kobo.301.3">One specific portion that is worth examining is </span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.303.1">
set sleeptime "5000";
set jitter    "0";
set maxdns    "255";
set useragent "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko";</span></pre>
<p><span class="koboSpan" id="kobo.304.1">In this portion of the profile, various settings have been configured. </span><span class="koboSpan" id="kobo.304.2">The first is the sleep time, which is the interval in seconds when the C2 beacon reaches out to the external C2 system for instructions. </span><span class="koboSpan" id="kobo.304.3">To bypass IDS systems that look for this type of beaconing behavior, a jitter is set. </span><span class="koboSpan" id="kobo.304.4">This is a random time that can be set that either adds or removes the sleep time so that there is a randomization of the beaconing activity. </span><span class="koboSpan" id="kobo.304.5">The other key piece of data is the user agent, which the profile uses to appear to be a web browser initiating the connection. </span><span class="koboSpan" id="kobo.304.6">A casual review of any network traffic would show that user </span><span class="No-Break"><span class="koboSpan" id="kobo.305.1">agent string.</span></span></p>
<p><span class="koboSpan" id="kobo.306.1">These malleable profiles are openly available and provide Cobalt Strike with the ability to appear like legitimate traffic. </span><span class="koboSpan" id="kobo.306.2">In even a small network, this traffic between the Cobalt Strike system and the victim</span><a id="_idIndexMarker1220"/><span class="koboSpan" id="kobo.307.1"> systems would blend in with all the other traffic that is traversing the ingress/egress point of </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">the network.</span></span></p>
<h2 id="_idParaDest-247"><a id="_idTextAnchor254"/><span class="koboSpan" id="kobo.309.1">Exfiltration</span></h2>
<p><span class="koboSpan" id="kobo.310.1">One of the key facets</span><a id="_idIndexMarker1221"/><span class="koboSpan" id="kobo.311.1"> of Conti that separated it from other earlier groups or campaigns was the theft of data, as well as encryption. </span><span class="koboSpan" id="kobo.311.2">In this case, Conti</span><a id="_idIndexMarker1222"/><span class="koboSpan" id="kobo.312.1"> used common tools such as WinSCP</span><a id="_idIndexMarker1223"/><span class="koboSpan" id="kobo.313.1"> or PuTTY to send aggregated data via </span><strong class="bold"><span class="koboSpan" id="kobo.314.1">Secure File Transfer Protocol</span></strong><span class="koboSpan" id="kobo.315.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.316.1">SFTP</span></strong><span class="koboSpan" id="kobo.317.1">) or through the simple HTTPS technique </span><strong class="bold"><span class="koboSpan" id="kobo.318.1">Exfiltration Over Web </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.319.1">Service [T1567]</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.320.1">.</span></span></p>
<h2 id="_idParaDest-248"><a id="_idTextAnchor255"/><span class="koboSpan" id="kobo.321.1">Impact</span></h2>
<p><span class="koboSpan" id="kobo.322.1">The Conti group is associated</span><a id="_idIndexMarker1224"/><span class="koboSpan" id="kobo.323.1"> with the Conti ransomware, which encrypts</span><a id="_idIndexMarker1225"/><span class="koboSpan" id="kobo.324.1"> data on infected systems in line with the MITRE ATT&amp;CK technique </span><strong class="bold"><span class="koboSpan" id="kobo.325.1">Data Encrypted for Impact [T1486]</span></strong><span class="koboSpan" id="kobo.326.1">. </span><span class="koboSpan" id="kobo.326.2">The Conti ransomware utilizes functions such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.327.1">CreateIoCompletionPort()</span></strong><span class="koboSpan" id="kobo.328.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.329.1">PostQueuedCompletionStatus()</span></strong><span class="koboSpan" id="kobo.330.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.331.1">GetQueuedCompletionPort()</span></strong><span class="koboSpan" id="kobo.332.1"> to encrypt files with an AES-256 encryption key that is paired with an RSA-4096 public encryption key. </span><span class="koboSpan" id="kobo.332.2">One unique feature of the Conti variant is that it will bypass </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">.exe</span></strong><span class="koboSpan" id="kobo.334.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">.dll</span></strong><span class="koboSpan" id="kobo.336.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.337.1">.lnk</span></strong><span class="koboSpan" id="kobo.338.1"> files and not </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">encrypt them.</span></span></p>
<p><span class="koboSpan" id="kobo.340.1">Conti can also execute the </span><strong class="bold"><span class="koboSpan" id="kobo.341.1">Service Stop [1489]</span></strong><span class="koboSpan" id="kobo.342.1"> technique by stopping 146 separate</span><a id="_idIndexMarker1226"/><span class="koboSpan" id="kobo.343.1"> Windows OS services or processes. </span><span class="koboSpan" id="kobo.343.2">These services are related to backups and security tools. </span><span class="koboSpan" id="kobo.343.3">This allows the ransomware to execute properly and removes any ability for the victim to leverage a backup for database or other </span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">restoration purposes.</span></span></p>
<p><span class="koboSpan" id="kobo.345.1">Finally, the Conti ransomware can </span><strong class="bold"><span class="koboSpan" id="kobo.346.1">Inhibit System Recovery [T1490]</span></strong><span class="koboSpan" id="kobo.347.1"> by deleting the Volume Shadow Copy</span><a id="_idIndexMarker1227"/><span class="koboSpan" id="kobo.348.1"> using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.349.1">vssadmin</span></strong><span class="koboSpan" id="kobo.350.1"> command. </span><span class="koboSpan" id="kobo.350.2">Again, this removes the ability of the victim to restore the system after the encryption process. </span><span class="koboSpan" id="kobo.350.3">Essentially, if Conti is successfully executed, it has an almost certain chance to encrypt all but a limited number of files, making the </span><span class="No-Break"><span class="koboSpan" id="kobo.351.1">system unusable.</span></span></p>
<h1 id="_idParaDest-249"><a id="_idTextAnchor256"/><span class="koboSpan" id="kobo.352.1">Proper ransomware preparation</span></h1>
<p><span class="koboSpan" id="kobo.353.1">Ransomware attacks are devastating</span><a id="_idIndexMarker1228"/><span class="koboSpan" id="kobo.354.1"> to an enterprise. </span><span class="koboSpan" id="kobo.354.2">Not many incidents short of a natural disaster have the impact that a ransomware attack has. </span><span class="koboSpan" id="kobo.354.3">While an APT-style network intrusion that aims to gain access to confidential data is severe, they often do not leave the entire network encrypted, especially if they are attempting to maintain a level of stealth so that the intrusion </span><span class="No-Break"><span class="koboSpan" id="kobo.355.1">goes undetected.</span></span></p>
<p><span class="koboSpan" id="kobo.356.1">In preparing for a ransomware attack, organizations should focus on two specific areas. </span><span class="koboSpan" id="kobo.356.2">The first is to make the network and endpoints resilient to the impact of a ransomware attack. </span><span class="koboSpan" id="kobo.356.3">This approach functions under the assumption that the threat actor may gain access to a system, but that proper preparation will leave them with little in terms of tools or methods to carry their attack any further from an initial foothold. </span><span class="koboSpan" id="kobo.356.4">The second preparation step is to ensure that the CSIRT is familiar with the TTPs of ransomware threat actors and is ready to meet the challenge of containing and removing a threat actor from </span><span class="No-Break"><span class="koboSpan" id="kobo.357.1">the network.</span></span></p>
<h2 id="_idParaDest-250"><a id="_idTextAnchor257"/><span class="koboSpan" id="kobo.358.1">Ransomware resiliency</span></h2>
<p><span class="koboSpan" id="kobo.359.1">Being resilient</span><a id="_idIndexMarker1229"/><span class="koboSpan" id="kobo.360.1"> against ransomware simply means that we acknowledge that the threat exists and has a chance of at least stopping the attack at the endpoint. </span><span class="koboSpan" id="kobo.360.2">If that does not work, the organization can limit the reach and associated impact so that only a few select systems are impacted and normal operations can continue. </span><span class="koboSpan" id="kobo.360.3">A ransomware resilience strategy should incorporate </span><span class="No-Break"><span class="koboSpan" id="kobo.361.1">the following:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.362.1">Endpoint detection and response</span></strong><span class="koboSpan" id="kobo.363.1">: We covered a wide range of forensics</span><a id="_idIndexMarker1230"/><span class="koboSpan" id="kobo.364.1"> tools in the previous chapters with a focus on mostly open-source versions. </span><span class="koboSpan" id="kobo.364.2">In this case, an EDR is a commercial product that combines a next-generation antivirus with endpoint visibility and response. </span><span class="koboSpan" id="kobo.364.3">The main advantage of an EDR over a traditional antivirus solution is that EDR tools often include behavioral detection, as well as signature detection. </span><span class="koboSpan" id="kobo.364.4">For example, we saw the use of Base64-encoded PowerShell scripts and the use of </span><strong class="source-inline"><span class="koboSpan" id="kobo.365.1">rundll32.exe</span></strong><span class="koboSpan" id="kobo.366.1"> to execute malicious code. </span><span class="koboSpan" id="kobo.366.2">While the use of PowerShell or </span><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">rundll32.exe</span></strong><span class="koboSpan" id="kobo.368.1"> is not in and of itself malicious, the use of the command line to run DLL files or Base64-encoded PowerShell is often indicative</span><a id="_idIndexMarker1231"/><span class="koboSpan" id="kobo.369.1"> of </span><span class="No-Break"><span class="koboSpan" id="kobo.370.1">malicious behavior.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.371.1">System hygiene</span></strong><span class="koboSpan" id="kobo.372.1">: As we saw in the Conti ransomware</span><a id="_idIndexMarker1232"/><span class="koboSpan" id="kobo.373.1"> overview, the group would often make use of Windows Sysinternals tools as part of their overall attack. </span><span class="koboSpan" id="kobo.373.2">Couple that with the use of local administrator accounts and the compromise of a single system may pose a significant risk. </span><span class="koboSpan" id="kobo.373.3">Systems administrators should ensure that deployed endpoints are limited in tools to those that are necessary. </span><span class="koboSpan" id="kobo.373.4">Removing RDP access, local administrator accounts, and tools such as ProcDump or PsExec can make it more difficult to move laterally and infect </span><span class="No-Break"><span class="koboSpan" id="kobo.374.1">other systems.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.375.1">There are several industry-accepted</span><a id="_idIndexMarker1233"/><span class="koboSpan" id="kobo.376.1"> standards for system hardening, such as the </span><strong class="bold"><span class="koboSpan" id="kobo.377.1">Security Technical Implementation Guides</span></strong><span class="koboSpan" id="kobo.378.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.379.1">STIGs</span></strong><span class="koboSpan" id="kobo.380.1">), which provide details on how to configure and harden a variety of systems. </span><span class="koboSpan" id="kobo.380.2">Other guides are available. </span><span class="koboSpan" id="kobo.380.3">Each organization has to determine its risk and apply the appropriate hardening as it sees necessary. </span><span class="koboSpan" id="kobo.380.4">The overall goal, no matter how the systems are hardened, is to make it difficult for the threat actor to operate in </span><span class="No-Break"><span class="koboSpan" id="kobo.381.1">your network.</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.382.1">Network topology</span></strong><span class="koboSpan" id="kobo.383.1">: One aspect that stands out concerning</span><a id="_idIndexMarker1234"/><span class="koboSpan" id="kobo.384.1"> ransomware attacks that impact the entire network is a “flat” network topology. </span><span class="koboSpan" id="kobo.384.2">In this topology, all systems can speak to others. </span><span class="koboSpan" id="kobo.384.3">For example, a LAN segment for accounts payable would be able to reach research and development, even though there is no need for these systems to communicate with each other. </span><span class="koboSpan" id="kobo.384.4">In short, a flat network allows the ransomware threat actor to propagate across the entire enterprise using compromised credentials and their tool </span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">of choice.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.386.1">The answer to this is to build a network topology in the same way a shipbuilder goes about designing a container ship. </span><span class="koboSpan" id="kobo.386.2">Below the waterline, the ship has watertight compartments so that if the ship’s hull is compromised, water can only come into that compartment alone, keeping the ship above water. </span><span class="koboSpan" id="kobo.386.3">The network topology should function in much the same way, where different LAN segment communications</span><a id="_idIndexMarker1235"/><span class="koboSpan" id="kobo.387.1"> are limited to only necessary communication. </span><span class="koboSpan" id="kobo.387.2">The practice of </span><strong class="bold"><span class="koboSpan" id="kobo.388.1">network segmentation</span></strong><span class="koboSpan" id="kobo.389.1"> creates specific “watertight” compartments</span><a id="_idIndexMarker1236"/><span class="koboSpan" id="kobo.390.1"> that limit the ability of a threat actor to </span><span class="No-Break"><span class="koboSpan" id="kobo.391.1">move laterally.</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.392.1">Multi-factor authentication</span></strong><span class="koboSpan" id="kobo.393.1">: Remote access is a critical component</span><a id="_idIndexMarker1237"/><span class="koboSpan" id="kobo.394.1"> when managing even a small enterprise network. </span><span class="koboSpan" id="kobo.394.2">However, the issue is that threat actors will often use these to their advantage</span><a id="_idIndexMarker1238"/><span class="koboSpan" id="kobo.395.1"> in spreading ransomware. </span><span class="koboSpan" id="kobo.395.2">It is advisable to have a </span><strong class="bold"><span class="koboSpan" id="kobo.396.1">multi-factor authentication</span></strong><span class="koboSpan" id="kobo.397.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.398.1">MFA</span></strong><span class="koboSpan" id="kobo.399.1">) mechanism in place to limit the ability of a threat actor to move laterally if they can compromise an </span><span class="No-Break"><span class="koboSpan" id="kobo.400.1">administrator account.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.401.1">Secure backups</span></strong><span class="koboSpan" id="kobo.402.1">: As part of the evolving ransomware</span><a id="_idIndexMarker1239"/><span class="koboSpan" id="kobo.403.1"> threat, we have seen groups such as Conti interfere with the ability of organizations to recover from a ransomware attack. </span><span class="koboSpan" id="kobo.403.2">In the case of Conti, this has included removing the Volume Shadow Copy from systems that have been infected. </span><span class="koboSpan" id="kobo.403.3">Other groups</span><a id="_idIndexMarker1240"/><span class="koboSpan" id="kobo.404.1"> have even gone so far as conducting network discovery to find network-connected </span><strong class="bold"><span class="koboSpan" id="kobo.405.1">Storage Area Networks</span></strong><span class="koboSpan" id="kobo.406.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.407.1">SANs</span></strong><span class="koboSpan" id="kobo.408.1">) that contained backups and encrypting those as well, essentially leaving the organization with no backups. </span><span class="koboSpan" id="kobo.408.2">As a result, organizations should assess their backup strategy and potentially use offline backups or a cloud solution that is in line with their recovery point and recovery </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">time objectives.</span></span></li>
</ul>
<h2 id="_idParaDest-251"><a id="_idTextAnchor258"/><span class="koboSpan" id="kobo.410.1">Prepping the CSIRT</span></h2>
<p><span class="koboSpan" id="kobo.411.1">There are a few additional steps</span><a id="_idIndexMarker1241"/><span class="koboSpan" id="kobo.412.1"> related to ransomware that should be included</span><a id="_idIndexMarker1242"/><span class="koboSpan" id="kobo.413.1"> in any incident response plan or playbook. </span><span class="koboSpan" id="kobo.413.2">The following are some of the key considerations when it comes to responding </span><span class="No-Break"><span class="koboSpan" id="kobo.414.1">to ransomware:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.415.1">Rapid isolation or containment</span></strong><span class="koboSpan" id="kobo.416.1">: The most significant risk from ransomware is how rapidly it can spread. </span><span class="koboSpan" id="kobo.416.2">It can take as little as a few hours for the threat actor to complete their objective. </span><span class="koboSpan" id="kobo.416.3">To counter this, incident responders should ensure that containment can be quickly executed on key technologies such as routers, switches, and firewalls. </span><span class="koboSpan" id="kobo.416.4">The stumbling block of this rapid containment is the need to clear decisions with leadership before such actions take place. </span><span class="koboSpan" id="kobo.416.5">This increases the time necessary to contain the attack. </span><span class="koboSpan" id="kobo.416.6">The best option is to, before an incident, discuss under what circumstances the network or security team will cut off communications between network segments or the internet so that they have the authority to take actions to stem </span><span class="No-Break"><span class="koboSpan" id="kobo.417.1">the attack.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.418.1">Keep up to date on TTPs</span></strong><span class="koboSpan" id="kobo.419.1">: Ransomware threat actors will continually change their TTPs to keep ahead of the preventive and detective technology in use in modern enterprises. </span><span class="koboSpan" id="kobo.419.2">Some of these changes can be subtle and in other instances can manifest as significant changes. </span><span class="koboSpan" id="kobo.419.3">In either case, threat intelligence sources are critical to understanding the threat, how they operate, and how best to align preventive and </span><span class="No-Break"><span class="koboSpan" id="kobo.420.1">detective controls.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.421.1">Tabletop exercises</span></strong><span class="koboSpan" id="kobo.422.1">: Finally, one specific action that incident responders can take is to craft and facilitate a </span><strong class="bold"><span class="koboSpan" id="kobo.423.1">tabletop exercise</span></strong><span class="koboSpan" id="kobo.424.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.425.1">TTX</span></strong><span class="koboSpan" id="kobo.426.1">) for technical and leadership</span><a id="_idIndexMarker1243"/><span class="koboSpan" id="kobo.427.1"> that walks through the entire incident life cycle to ensure that all units are aligned and key decisions are made before the incident. </span><span class="koboSpan" id="kobo.427.2">This ensures that actions that are executed during a live incident</span><a id="_idIndexMarker1244"/><span class="koboSpan" id="kobo.428.1"> are preplanned and can decrease the time necessary</span><a id="_idIndexMarker1245"/><span class="koboSpan" id="kobo.429.1"> to make key decisions, thereby reducing the </span><span class="No-Break"><span class="koboSpan" id="kobo.430.1">incident’s impact.</span></span></li>
</ul>
<h1 id="_idParaDest-252"><a id="_idTextAnchor259"/><span class="koboSpan" id="kobo.431.1">Eradication and recovery</span></h1>
<p><span class="koboSpan" id="kobo.432.1">If a ransomware attack</span><a id="_idIndexMarker1246"/><span class="koboSpan" id="kobo.433.1"> was successful in an</span><a id="_idIndexMarker1247"/><span class="koboSpan" id="kobo.434.1"> organization, it is important to have a plan at hand to bring the organization back up and running as quickly as possible. </span><span class="koboSpan" id="kobo.434.2">Additionally, as we have seen, these attacks are highly sophisticated and involve complex malware that can embed itself deep into the operating system. </span><span class="koboSpan" id="kobo.434.3">This makes ensuring that the threat has been entirely removed from the network difficult. </span><span class="koboSpan" id="kobo.434.4">As a result, there are specific ways to contain, eradicate, and recover from a ransomware incident that can ensure the best </span><span class="No-Break"><span class="koboSpan" id="kobo.435.1">possible outcome.</span></span></p>
<h2 id="_idParaDest-253"><a id="_idTextAnchor260"/><span class="koboSpan" id="kobo.436.1">Containment</span></h2>
<p><span class="koboSpan" id="kobo.437.1">Containing a</span><a id="_idIndexMarker1248"/><span class="koboSpan" id="kobo.438.1"> ransomware incident involves two major actions. </span><span class="koboSpan" id="kobo.438.2">The first is to remove the capability of the adversary to exercise C2 over compromised systems. </span><span class="koboSpan" id="kobo.438.3">Adversaries often use a combination of commercial and open source tools such as Cobalt Strike or Metasploit, which use a variety of connection types. </span><span class="koboSpan" id="kobo.438.4">The goal of the initial investigation involves examining systems to identify the nature of the C2 infrastructure and communications so that they can </span><span class="No-Break"><span class="koboSpan" id="kobo.439.1">be blocked.</span></span></p>
<p><span class="koboSpan" id="kobo.440.1">The second major action is to remove the ability of the adversary to move laterally or to infect additional systems. </span><span class="koboSpan" id="kobo.440.2">The key facet of ransomware attacks is the adversary’s objective to infect as many systems as possible, thereby increasing the chances that a victim will pay </span><span class="No-Break"><span class="koboSpan" id="kobo.441.1">the ransom.</span></span></p>
<h3><span class="koboSpan" id="kobo.442.1">Firewall rules</span></h3>
<p><span class="koboSpan" id="kobo.443.1">For incidents</span><a id="_idIndexMarker1249"/><span class="koboSpan" id="kobo.444.1"> that are not contained within a LAN segment and have the possibility of causing enterprise-wide damage, a firewall rule that removes all internet connections should be considered until such time the Command and Control mechanism and its associated indicators are identified and a more targeted firewall ruleset can be configured. </span><span class="koboSpan" id="kobo.444.2">The obvious challenge with this type of containment strategy is that critical systems will be adversely impacted. </span><span class="koboSpan" id="kobo.444.3">Every situation is different, and the specific circumstances should be evaluated before taking </span><span class="No-Break"><span class="koboSpan" id="kobo.445.1">this step.</span></span></p>
<h3><span class="koboSpan" id="kobo.446.1">Disabling SMB communication</span></h3>
<p><span class="koboSpan" id="kobo.447.1">Adversaries often make use</span><a id="_idIndexMarker1250"/><span class="koboSpan" id="kobo.448.1"> of the SMB function in a Windows enterprise environment. </span><span class="koboSpan" id="kobo.448.2">Containing a ransomware incident requires removing this functionality. </span><span class="koboSpan" id="kobo.448.3">For example, you should disable SMBv1 across the entire enterprise permanently (if enabled). </span><span class="koboSpan" id="kobo.448.4">You should disable SMBv2/v3 temporarily if an alert or triage investigation suggests that the protocol is being utilized for lateral movement. </span><span class="koboSpan" id="kobo.448.5">Microsoft</span><a id="_idIndexMarker1251"/><span class="koboSpan" id="kobo.449.1"> recommends that SMB v2/3 is not permanently disabled. </span><span class="koboSpan" id="kobo.449.2">Further guidance from Microsoft is available </span><span class="No-Break"><span class="koboSpan" id="kobo.450.1">at </span></span><a href="https://support.microsoft.com/en-us/help/2696547/detect-enable-disable-smbv1-smbv2-smbv3-in-windows-and-windows-server"><span class="No-Break"><span class="koboSpan" id="kobo.451.1">https://support.microsoft.com/en-us/help/2696547/detect-enable-disable-smbv1-smbv2-smbv3-in-windows-and-windows-server</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.452.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.453.1">Disabling administrative shares</span></h3>
<p><span class="koboSpan" id="kobo.454.1">Another target</span><a id="_idIndexMarker1252"/><span class="koboSpan" id="kobo.455.1"> of both network exploitation and ransomware attacks is finding and accessing network administrative shares. </span><span class="koboSpan" id="kobo.455.2">Fortalice Solutions recommends blocking admin shares as they are often used by the adversary to spread files or as a source for scripts </span><span class="No-Break"><span class="koboSpan" id="kobo.456.1">or commands:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.457.1">Option 1</span></strong><span class="koboSpan" id="kobo.458.1">: To block admin shares, a recommended solution is to push out a GPO preference that applies to the computers to edit </span><span class="No-Break"><span class="koboSpan" id="kobo.459.1">the registry:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.460.1">
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters</span></pre></li>
</ul>
<p><span class="koboSpan" id="kobo.461.1">Create a new </span><strong class="source-inline"><span class="koboSpan" id="kobo.462.1">DWORD</span></strong><span class="koboSpan" id="kobo.463.1"> value here, named </span><strong class="source-inline"><span class="koboSpan" id="kobo.464.1">AutoShareWks</span></strong><span class="koboSpan" id="kobo.465.1">. </span><span class="koboSpan" id="kobo.465.2">Leave the value data set to Zero. </span><span class="koboSpan" id="kobo.465.3">This may require you to restart the host. </span><span class="koboSpan" id="kobo.465.4">For further information, the following blog provides additional guidance and examples of registry value </span><span class="No-Break"><span class="koboSpan" id="kobo.466.1">changes: </span></span><a href="https://winaero.com/blog/disable-administrative-shares-in-windows-10-windows-8-and-windows-7/"><span class="No-Break"><span class="koboSpan" id="kobo.467.1">https://winaero.com/blog/disable-administrative-shares-in-windows-10-windows-8-and-windows-7/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.468.1">.</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.469.1">Option 2</span></strong><span class="koboSpan" id="kobo.470.1">: From the Windows command line, enter </span><span class="No-Break"><span class="koboSpan" id="kobo.471.1">the following:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.472.1">
for %i in (C$ IPC$ ADMIN$) do net share %i /delete OR net stop LanmanServer</span></pre></li>
</ul>
<p><span class="koboSpan" id="kobo.473.1">Disabling admin shares may cause some adverse impacts. </span><span class="koboSpan" id="kobo.473.2">The following blog post provides some guidance on what to expect</span><a id="_idIndexMarker1253"/><span class="koboSpan" id="kobo.474.1"> when admin shares are </span><span class="No-Break"><span class="koboSpan" id="kobo.475.1">missing: </span></span><a href="https://support.microsoft.com/en-us/help/842715/overview-of-problems-that-may-occur-when-administrative-shares-are-missing"><span class="No-Break"><span class="koboSpan" id="kobo.476.1">https://support.microsoft.com/en-us/help/842715/overview-of-problems-that-may-occur-when-administrative-shares-are-missing</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.477.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.478.1">Restricting PowerShell use</span></h3>
<p><span class="koboSpan" id="kobo.479.1">Adversaries</span><a id="_idIndexMarker1254"/><span class="koboSpan" id="kobo.480.1"> will often make use of PowerShell as part</span><a id="_idIndexMarker1255"/><span class="koboSpan" id="kobo.481.1"> of delivering ransomware. </span><span class="koboSpan" id="kobo.481.2">Tools such as PowerSploit are configured to exploit PowerShell’s ability to conduct a wide range of actions across the enterprise. </span><span class="koboSpan" id="kobo.481.3">If PowerShell must be enabled in the environment due to dependent</span><a id="_idIndexMarker1256"/><span class="koboSpan" id="kobo.482.1"> third-party applications, ensure</span><a id="_idIndexMarker1257"/><span class="koboSpan" id="kobo.483.1"> legacy PowerShell v2 is disabled</span><a id="_idIndexMarker1258"/><span class="koboSpan" id="kobo.484.1"> as it allows runtime bypassing of the constrained language mode and the </span><strong class="bold"><span class="koboSpan" id="kobo.485.1">Antimalware Scan </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.486.1">Interface</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.487.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.488.1">AMSI</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.489.1">).</span></span></p>
<h3><span class="koboSpan" id="kobo.490.1">Restricting remote access</span></h3>
<p><span class="koboSpan" id="kobo.491.1">Remote access applications</span><a id="_idIndexMarker1259"/><span class="koboSpan" id="kobo.492.1"> such as RDP should be disabled until the incident is contained or an MFA solution is in place. </span><span class="koboSpan" id="kobo.492.2">RDP can be disabled via GPO. </span><span class="koboSpan" id="kobo.492.3">One concern that is often voiced at this point by incident responders is that removing RDP during an incident may impact their ability to acquire evidence. </span><span class="koboSpan" id="kobo.492.4">While this may be true, the real impact of leaving RDP enabled can be significant. </span><span class="koboSpan" id="kobo.492.5">This is where tools and techniques for remote evidence capture are critical – it allows the responders to remove the ability for attackers to access other systems while also allowing the responders to acquire the </span><span class="No-Break"><span class="koboSpan" id="kobo.493.1">necessary evidence.</span></span></p>
<h2 id="_idParaDest-254"><a id="_idTextAnchor261"/><span class="koboSpan" id="kobo.494.1">Eradication</span></h2>
<p><span class="koboSpan" id="kobo.495.1">Eradication involves removing the threat actor</span><a id="_idIndexMarker1260"/><span class="koboSpan" id="kobo.496.1"> from the network. </span><span class="koboSpan" id="kobo.496.2">This includes removing any malware the threat actor implanted, any additional tools that were used, and any credentials that may have been compromised. </span><span class="koboSpan" id="kobo.496.3">While simple in concept, the reality of modern ransomware attacks is that they use a variety of persistence mechanisms to ensure that the threat actors continue to have access. </span><span class="koboSpan" id="kobo.496.4">Additionally, much of the data that is on systems is </span><span class="No-Break"><span class="koboSpan" id="kobo.497.1">already encrypted.</span></span></p>
<p><span class="koboSpan" id="kobo.498.1">The challenge for responders is that without a complete and thorough investigation, it is difficult to determine how far the threat actors were able to compromise systems. </span><span class="koboSpan" id="kobo.498.2">For example, RATs associated with ransomware attacks can place persistence mechanisms in scheduled tasks or implant scripts in the registry to execute at every startup. </span><span class="koboSpan" id="kobo.498.3">Completely reverse-engineering the malware will provide this data but the best option is to </span><span class="No-Break"><span class="koboSpan" id="kobo.499.1">start fresh.</span></span></p>
<p><span class="koboSpan" id="kobo.500.1">Removing the threat actor</span><a id="_idIndexMarker1261"/><span class="koboSpan" id="kobo.501.1"> from infected systems</span><a id="_idIndexMarker1262"/><span class="koboSpan" id="kobo.502.1"> often requires</span><a id="_idIndexMarker1263"/><span class="koboSpan" id="kobo.503.1"> a complete rebuild from a trusted </span><strong class="bold"><span class="koboSpan" id="kobo.504.1">Gold Image</span></strong><span class="koboSpan" id="kobo.505.1"> or an image that is a known good. </span><span class="koboSpan" id="kobo.505.2">The best place to start this process is the </span><strong class="bold"><span class="koboSpan" id="kobo.506.1">Business Continuity Plan</span></strong><span class="koboSpan" id="kobo.507.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.508.1">BCP</span></strong><span class="koboSpan" id="kobo.509.1">) or </span><strong class="bold"><span class="koboSpan" id="kobo.510.1">Business Resumption Plan</span></strong><span class="koboSpan" id="kobo.511.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.512.1">BRP</span></strong><span class="koboSpan" id="kobo.513.1">). </span><span class="koboSpan" id="kobo.513.2">This outlines how to reconstruct systems from backups or reimage and redeploy</span><a id="_idIndexMarker1264"/> <span class="No-Break"><span class="koboSpan" id="kobo.514.1">the image.</span></span></p>
<h2 id="_idParaDest-255"><a id="_idTextAnchor262"/><span class="koboSpan" id="kobo.515.1">Recovery</span></h2>
<p><span class="koboSpan" id="kobo.516.1">Recovery operations</span><a id="_idIndexMarker1265"/><span class="koboSpan" id="kobo.517.1"> should be carefully executed to ensure that an infected system is not reintroduced</span><a id="_idIndexMarker1266"/><span class="koboSpan" id="kobo.518.1"> into the network. </span><span class="koboSpan" id="kobo.518.2">If there is sufficient evidence, a full </span><strong class="bold"><span class="koboSpan" id="kobo.519.1">root cause analysis</span></strong><span class="koboSpan" id="kobo.520.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.521.1">RCA</span></strong><span class="koboSpan" id="kobo.522.1">) should be conducted before moving to the recovery stage. </span><span class="koboSpan" id="kobo.522.2">This ensures that all vulnerabilities or system configurations that were exploited by the threat actor are discovered and can be corrected as part of the process. </span><span class="koboSpan" id="kobo.522.3">Further, systems should only be reintroduced upon a clean security tool scan with the appropriate security controls that have been updated with the IOCs located during </span><span class="No-Break"><span class="koboSpan" id="kobo.523.1">the incident.</span></span></p>
<p><span class="koboSpan" id="kobo.524.1">Recovery operations can be broken down into two broad categories. </span><span class="koboSpan" id="kobo.524.2">The first of these is eradicating and redeploying systems to the enterprise architecture. </span><span class="koboSpan" id="kobo.524.3">In </span><a href="B18571_02.xhtml#_idTextAnchor028"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.525.1">Chapter 2</span></em></span></a><span class="koboSpan" id="kobo.526.1">, we discussed the architecture necessary to recover from </span><span class="No-Break"><span class="koboSpan" id="kobo.527.1">an incident.</span></span></p>
<h3><span class="koboSpan" id="kobo.528.1">Recovery network architecture</span></h3>
<p><span class="koboSpan" id="kobo.529.1">In </span><a href="B18571_02.xhtml#_idTextAnchor028"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.530.1">Chapter 2</span></em></span></a><span class="koboSpan" id="kobo.531.1">, we examined</span><a id="_idIndexMarker1267"/><span class="koboSpan" id="kobo.532.1"> a sample recovery architecture for recovering from an incident. </span><span class="koboSpan" id="kobo.532.2">The following is a more detailed and technical examination</span><a id="_idIndexMarker1268"/><span class="koboSpan" id="kobo.533.1"> of this recovery method, specifically tailored </span><span class="No-Break"><span class="koboSpan" id="kobo.534.1">to ransomware:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.535.1">Configure three separate </span><strong class="bold"><span class="koboSpan" id="kobo.536.1">Virtual Local Area </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.537.1">Networks</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.538.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.539.1">VLANs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.540.1">):</span></span><ul><li><strong class="bold"><span class="koboSpan" id="kobo.541.1">Infected VLAN</span></strong><span class="koboSpan" id="kobo.542.1">: This is the network where all infected systems</span><a id="_idIndexMarker1269"/><span class="koboSpan" id="kobo.543.1"> are hosted. </span><span class="koboSpan" id="kobo.543.2">This can be the production network in circumstances where a large number of systems are infected. </span><span class="koboSpan" id="kobo.543.3">Ideally, this should be configured as a </span><span class="No-Break"><span class="koboSpan" id="kobo.544.1">separate network.</span></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.545.1">Staging VLAN</span></strong><span class="koboSpan" id="kobo.546.1">: This VLAN is used for incident</span><a id="_idIndexMarker1270"/><span class="koboSpan" id="kobo.547.1"> triage, reimaging, patching, security tool installs, and preparing </span><span class="No-Break"><span class="koboSpan" id="kobo.548.1">for redeployment:</span></span><ul><li><span class="koboSpan" id="kobo.549.1">The internet should only be enabled for triage, reimaging, software updates, and updates to </span><span class="No-Break"><span class="koboSpan" id="kobo.550.1">security technology</span></span></li><li><span class="koboSpan" id="kobo.551.1">Possibility to enable PXE boot </span><span class="No-Break"><span class="koboSpan" id="kobo.552.1">for reimaging</span></span></li><li><span class="koboSpan" id="kobo.553.1">Enable all security tools such as host intrusion detection, antivirus, or endpoint detection and response to detect and quarantine any potential malware </span><span class="No-Break"><span class="koboSpan" id="kobo.554.1">or exploits</span></span></li><li><span class="koboSpan" id="kobo.555.1">Monitor systems for reinfection before moving to </span><span class="No-Break"><span class="koboSpan" id="kobo.556.1">clean them</span></span></li></ul></li><li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.557.1">Clean VLAN</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.558.1">:</span></span><ul><li><span class="koboSpan" id="kobo.559.1">A dully new network</span><a id="_idIndexMarker1271"/><span class="koboSpan" id="kobo.560.1"> with no connection to the “dirty” or “</span><span class="No-Break"><span class="koboSpan" id="kobo.561.1">staging” VLANs</span></span></li><li><span class="koboSpan" id="kobo.562.1">This will likely involve a new </span><span class="No-Break"><span class="koboSpan" id="kobo.563.1">local domain</span></span></li><li><span class="koboSpan" id="kobo.564.1">Only move systems to here when they are proven to </span><span class="No-Break"><span class="koboSpan" id="kobo.565.1">be clean</span></span></li></ul></li></ul></li>
</ul>
<p><span class="koboSpan" id="kobo.566.1">If a domain controller has been</span><a id="_idIndexMarker1272"/><span class="koboSpan" id="kobo.567.1"> compromised, new domain controllers should be built from scratch and a known good backup should be deployed </span><span class="No-Break"><span class="koboSpan" id="kobo.568.1">on top.</span></span></p>
<h3><span class="koboSpan" id="kobo.569.1">Enterprise password reset</span></h3>
<p><span class="koboSpan" id="kobo.570.1">Many ransomware</span><a id="_idIndexMarker1273"/><span class="koboSpan" id="kobo.571.1"> attacks will impact the domain controllers, along with other systems. </span><span class="koboSpan" id="kobo.571.2">If the threat actor can identify the domain controller and can compromise the </span><strong class="source-inline"><span class="koboSpan" id="kobo.572.1">NTDS.DIT</span></strong><span class="koboSpan" id="kobo.573.1"> file – the database containing the credentials for the entire enterprise – a global password reset will have to be conducted using the </span><span class="No-Break"><span class="koboSpan" id="kobo.574.1">following process:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.575.1">Change the passwords of all accounts in highly </span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">privileged groups.</span></span></li>
<li><span class="koboSpan" id="kobo.577.1">Roll</span><a id="_idIndexMarker1274"/><span class="koboSpan" id="kobo.578.1"> KRBGT </span><span class="No-Break"><span class="koboSpan" id="kobo.579.1">twice (</span></span><span class="No-Break"><span class="koboSpan" id="kobo.580.1">https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/manage/ad-forest-recovery-resetting-the-krbtgt-password</span></span><span class="No-Break"><span class="koboSpan" id="kobo.581.1">).</span></span></li>
<li><span class="koboSpan" id="kobo.582.1">Change the built-in local admin passwords and possibly deny </span><span class="No-Break"><span class="koboSpan" id="kobo.583.1">remote login:</span></span><ul><li><span class="koboSpan" id="kobo.584.1">Use Microsoft’s </span><strong class="bold"><span class="koboSpan" id="kobo.585.1">Local Administrator Password Solution</span></strong><span class="koboSpan" id="kobo.586.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.587.1">LAPS</span></strong><span class="koboSpan" id="kobo.588.1">) to randomize the local administrator</span><a id="_idIndexMarker1275"/><span class="koboSpan" id="kobo.589.1"> password on every endpoint to stop lateral movement and store it in Active Directory if it’s </span><span class="No-Break"><span class="koboSpan" id="kobo.590.1">manually needed</span></span></li></ul></li>
<li><span class="koboSpan" id="kobo.591.1">Force password change on the next login for all general </span><span class="No-Break"><span class="koboSpan" id="kobo.592.1">user accounts.</span></span></li>
<li><span class="koboSpan" id="kobo.593.1">Disable the ability of the Windows operating</span><a id="_idIndexMarker1276"/><span class="koboSpan" id="kobo.594.1"> system to cache credentials on any device</span><a id="_idIndexMarker1277"/><span class="koboSpan" id="kobo.595.1"> where credentials are not </span><span class="No-Break"><span class="koboSpan" id="kobo.596.1">needed (</span></span><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-access-do-not-allow-storage-of-passwords-and-credentials-for-network-authentication"><span class="No-Break"><span class="koboSpan" id="kobo.597.1">https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-access-do-not-allow-storage-of-passwords-and-credentials-for-network-authentication</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.598.1">).</span></span></li>
</ol>
<h3><span class="koboSpan" id="kobo.599.1">Remote access MFA</span></h3>
<p><span class="koboSpan" id="kobo.600.1">It is highly recommended</span><a id="_idIndexMarker1278"/><span class="koboSpan" id="kobo.601.1"> that any remote access to systems connected to the internal network have MFA enabled. </span><span class="koboSpan" id="kobo.601.2">Adversaries are continuing to make use of legitimate credentials and accessing remote systems that leverage only a </span><span class="No-Break"><span class="koboSpan" id="kobo.602.1">single factor.</span></span></p>
<h3><span class="koboSpan" id="kobo.603.1">Enhanced logging</span></h3>
<p><span class="koboSpan" id="kobo.604.1">When systems are redeployed, there should be increased</span><a id="_idIndexMarker1279"/><span class="koboSpan" id="kobo.605.1"> monitoring. </span><span class="koboSpan" id="kobo.605.2">This will increase the likelihood that any systems that may have been compromised and not properly recovered can be identified before a significant impact. </span><span class="koboSpan" id="kobo.605.3">The following are some additional monitoring steps for Windows Event and System logs that are important to have forwarded to a SIEM or other log </span><span class="No-Break"><span class="koboSpan" id="kobo.606.1">management solution:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.607.1">Deploy Sysmon where possible (especially on domain controllers or </span><span class="No-Break"><span class="koboSpan" id="kobo.608.1">critical systems).</span></span></li>
<li><span class="koboSpan" id="kobo.609.1">Enable Security Event Log – Permitted a Connection &amp; Bind to Port (5156, 5158 </span><span class="No-Break"><span class="koboSpan" id="kobo.610.1">Event IDs).</span></span></li>
<li><span class="koboSpan" id="kobo.611.1">Enable Security Event Log – IPC$ Connections (5140,5145 </span><span class="No-Break"><span class="koboSpan" id="kobo.612.1">Event IDs).</span></span></li>
<li><span class="koboSpan" id="kobo.613.1">Ensure that PowerShell version 5 has been deployed across all systems. </span><span class="koboSpan" id="kobo.613.2">PowerShell version 5 allows for enhanced logging, which can help you identify misuse of PowerShell. </span><span class="koboSpan" id="kobo.613.3">Logging will need to be configured using Group Policy to the </span><span class="No-Break"><span class="koboSpan" id="kobo.614.1">following settings:</span></span><ul><li><span class="koboSpan" id="kobo.615.1">Turn on Module </span><span class="No-Break"><span class="koboSpan" id="kobo.616.1">Logging: Enabled.</span></span></li><li><span class="koboSpan" id="kobo.617.1">Turn on PowerShell Script Block </span><span class="No-Break"><span class="koboSpan" id="kobo.618.1">Logging: Enabled.</span></span></li><li><span class="koboSpan" id="kobo.619.1">Turn on Script Execution: </span><span class="No-Break"><span class="koboSpan" id="kobo.620.1">Not Configured.</span></span></li><li><span class="koboSpan" id="kobo.621.1">Turn on PowerShell </span><span class="No-Break"><span class="koboSpan" id="kobo.622.1">Transcription: Enabled.</span></span></li><li><span class="koboSpan" id="kobo.623.1">Set the default source path for Update-Help: </span><span class="No-Break"><span class="koboSpan" id="kobo.624.1">Not Configured.</span></span></li><li><span class="koboSpan" id="kobo.625.1">Local log retention will need to be configured to keep at least 90 days of logs present on each server. </span><span class="koboSpan" id="kobo.625.2">Logs should forward immediately to the centralized log storage system for longer-term retention </span><span class="No-Break"><span class="koboSpan" id="kobo.626.1">and analysis.</span></span></li></ul></li>
</ol>
<p><span class="koboSpan" id="kobo.627.1">It is obvious that recovery</span><a id="_idIndexMarker1280"/><span class="koboSpan" id="kobo.628.1"> is a critical component and that organizations may want to get this done as quickly as possible. </span><span class="koboSpan" id="kobo.628.2">With that being said, this process must be systematic and take the threat into account. </span><span class="koboSpan" id="kobo.628.3">Not walking through the recovery process in a TTX or rushing the processes increases the chance that a still-infected system is reintroduced to the network and the ransomware attack will </span><span class="No-Break"><span class="koboSpan" id="kobo.629.1">begin again.</span></span></p>
<h1 id="_idParaDest-256"><a id="_idTextAnchor263"/><span class="koboSpan" id="kobo.630.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.631.1">Ransomware is a threat that will be around us for the foreseeable future. </span><span class="koboSpan" id="kobo.631.2">In this chapter, we looked at the history of ransomware, the common TTPs in use by threat actors such as Conti, how to align our incident response to that threat, and finally how to contain, eradicate, and recover from it. </span><span class="koboSpan" id="kobo.631.3">Understanding these TTPs gives us insight into how to detect and prevent such attacks. </span><span class="koboSpan" id="kobo.631.4">Understanding the response element allows us to respond appropriately and limit </span><span class="No-Break"><span class="koboSpan" id="kobo.632.1">the impact.</span></span></p>
<p><span class="koboSpan" id="kobo.633.1">In the next chapter, we will examine specific investigative and </span><span class="No-Break"><span class="koboSpan" id="kobo.634.1">analysis techniques.</span></span></p>
<h1 id="_idParaDest-257"><a id="_idTextAnchor264"/><span class="koboSpan" id="kobo.635.1">Questions</span></h1>
<p><span class="koboSpan" id="kobo.636.1">Answer the following questions to test your knowledge of </span><span class="No-Break"><span class="koboSpan" id="kobo.637.1">this chapter:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.638.1">Which threat actor is related to both Ryuk </span><span class="No-Break"><span class="koboSpan" id="kobo.639.1">and Conti?</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.640.1">AtomicSquirrel</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.641.1">BadWitch</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.642.1">Wizard Spider</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.643.1">BlackEnergy</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.644.1">In the event of a Domain Controller compromise, it is important to perform a global </span><span class="No-Break"><span class="koboSpan" id="kobo.645.1">password reset.</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.646.1">True</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.647.1">False</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.648.1">What is the critical component that </span><span class="No-Break"><span class="koboSpan" id="kobo.649.1">drives ransomware?</span></span><ol><li><span class="koboSpan" id="kobo.650.1">Commonly </span><span class="No-Break"><span class="koboSpan" id="kobo.651.1">available RATs</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.652.1">Cryptocurrency</span></span></li><li><span class="koboSpan" id="kobo.653.1">Commercial penetration </span><span class="No-Break"><span class="koboSpan" id="kobo.654.1">testing tools</span></span></li><li><span class="koboSpan" id="kobo.655.1">Poor </span><span class="No-Break"><span class="koboSpan" id="kobo.656.1">security hygiene</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.657.1">Threat actor lateral movement can be inhibited by which of </span><span class="No-Break"><span class="koboSpan" id="kobo.658.1">the following?</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.659.1">MFA</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.660.1">Limiting RDP</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.661.1">Limiting SMB</span></span></li><li><span class="koboSpan" id="kobo.662.1">All of </span><span class="No-Break"><span class="koboSpan" id="kobo.663.1">the above</span></span></li></ol></li>
</ol>
<h1 id="_idParaDest-258"><a id="_idTextAnchor265"/><span class="koboSpan" id="kobo.664.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.665.1">Refer to the following resources for more details about the topics covered in </span><span class="No-Break"><span class="koboSpan" id="kobo.666.1">this chapter:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.667.1">Preventing </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.668.1">Ransomware</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.669.1">: </span></span><a href="https://www.packtpub.com/product/preventing-ransomware/9781788620604 "><span class="No-Break"><span class="koboSpan" id="kobo.670.1">https://www.packtpub.com/product/preventing-ransomware/9781788620604</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.671.1">Incident Response Techniques for Ransomware </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.672.1">Attacks</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.673.1">: </span></span><span class="No-Break"><span class="koboSpan" id="kobo.674.1">https://www.packtpub.com/product/incident-response-techniques-for-ransomware-attacks/9781803240442</span></span></li>
</ul>
</div>
</body></html>