<html><head></head><body>
		<div><h1 id="_idParaDest-5"><a id="_idTextAnchor004"/>Preface</h1>
			<p>New and developing technologies inevitably bring new types of malware with them, creating a huge demand for IT professionals who can keep that malware at bay. With the help of this updated edition of <em class="italic">Mastering Malware Analysis</em>, you’ll add valuable reverse engineering skills to your CV and learn how to protect organizations in the most efficient way.</p>
			<p>This book will familiarize you with multiple universal patterns behind different malicious software types and teach you how to analyze them using a variety of approaches. You’ll learn how to examine malware code and determine the damage it can cause to systems to ensure that the right prevention or remediation steps are followed. As you cover all aspects of malware analysis for Windows, Linux, macOS, and mobile platforms in detail, you’ll also get to grips with obfuscation, anti-debugging, and other advanced anti-reverse engineering techniques.</p>
			<p>The skills you acquire in this cybersecurity book will help you deal with pretty much all types of modern malware, strengthening defenses and preventing or promptly mitigating breaches regardless of the platforms involved.</p>
			<p>By the end of this book, you will have learned to efficiently analyze samples, investigate suspicious activity, and build innovative solutions to handle malware incidents.</p>
			<h1 id="_idParaDest-6"><a id="_idTextAnchor005"/>Who this book is for</h1>
			<p>If you are a malware researcher, forensic analyst, IT security administrator, or anyone looking to secure against malicious software or investigate malicious code, this book is for you. This new edition is suited to all levels of knowledge, including complete beginners, but any prior exposure to programming or cybersecurity will further help speed up your learning process.</p>
			<h1 id="_idParaDest-7"><a id="_idTextAnchor006"/>What this book covers</h1>
			<p><a href="B18500_01.xhtml#_idTextAnchor014"><em class="italic">Chapter 1</em></a>, <em class="italic">Cybercrime, APT Attacks, and Research Strategies</em>, dives into various types of attacks and associated malware, giving you an idea about attack stages and the logic behind them. In addition, we will learn different approaches and technologies that are universal to all platforms and help malware analysts do their jobs.</p>
			<p><a href="B18500_02.xhtml#_idTextAnchor043"><em class="italic">Chapter 2</em></a>, <em class="italic">A Crash Course in Assembly and Programming Basics</em>, covers the basics of the most widely used architectures, from the well-known x86 and x64 <strong class="bold">Instruction Set Architectures</strong> (<strong class="bold">ISAs</strong>) to solutions powering multiple mobile and <strong class="bold">Internet of Things</strong> (<strong class="bold">IoT</strong>) devices that are often misused by malware families.</p>
			<p><a href="B18500_03.xhtml#_idTextAnchor084"><em class="italic">Chapter 3</em></a>, <em class="italic">Basic Static and Dynamic Analysis for x86/x64</em>, covers the core fundamentals that you need to know in order to reverse engineer 32-bit and 64-bit malware on the Windows platform, focusing on file formats and basic concepts of static and dynamic analysis.</p>
			<p><a href="B18500_04.xhtml#_idTextAnchor238"><em class="italic">Chapter 4</em></a>, <em class="italic">Unpacking, Decryption, and Deobfuscation</em>, teaches you how to identify packed samples, how to unpack them, how to deal with different encryption algorithms—from simple ones, such as sliding key encryption, to more complex algorithms, such as 3DES, AES, and RSA—and how to deal with API encryption, string encryption, and network traffic encryption.</p>
			<p><a href="B18500_05.xhtml#_idTextAnchor446"><em class="italic">Chapter 5</em></a>, <em class="italic">Inspecting Process Injection and API Hooking</em>, explores various process injection techniques, including DLL injection and process hollowing (an advanced technique that was introduced by Stuxnet), and explains how to deal with them. Later, we will look at API hooking, IAT hooking, and other hooking techniques that are used by malware authors and how to handle them.</p>
			<p><a href="B18500_06.xhtml#_idTextAnchor554"><em class="italic">Chapter 6</em></a>, <em class="italic">Bypassing Anti-Reverse Engineering Techniques</em>, covers various anti-reverse engineering techniques that malware authors use to protect their code against analysis. We will familiarize ourselves with various approaches, from detecting the debugger and other analysis tools to VM detection, even covering attacking anti-malware tools and products.</p>
			<p><a href="B18500_07.xhtml#_idTextAnchor669"><em class="italic">Chapter 7</em></a>, <em class="italic">Understanding Kernel-Mode Rootkits</em>, digs deeper into the Windows kernel and its internal structure and mechanisms. We will cover different techniques used by malware authors to hide the presence of their malware from users and antivirus products. </p>
			<p><a href="B18500_08.xhtml#_idTextAnchor811"><em class="italic">Chapter 8</em></a>, <em class="italic">Handling Exploits and Shellcode</em>, looks at the common types of vulnerabilities, the functions of shellcode and the various ways it can be implemented, exploit mitigation techniques and how attackers try to bypass them, and how to analyze MS Office and PDF malware.</p>
			<p><a href="B18500_09.xhtml#_idTextAnchor946"><em class="italic">Chapter 9</em></a>, <em class="italic">Reversing Bytecode Languages – .NET, Java, and More</em>, looks at how the beauty of cross-platform compiled programs is in their flexibility, as you don’t need to port each program to different systems. In this chapter, we will take a look at how malware authors leverage these advantages for evil purposes and learn how to perform quick and efficient analyses of such samples.</p>
			<p><a href="B18500_10.xhtml#_idTextAnchor1106"><em class="italic">Chapter 10</em></a>, <em class="italic">Scripts and Macros – Reversing, Deobfuscation, and Debugging</em>, focuses on analyzing all types of malicious scripts, including but not limited to Batch and Bash, PowerShell, VBS, JavaScript, and different types of MS Office macros.</p>
			<p><a href="B18500_11.xhtml#_idTextAnchor1188"><em class="italic">Chapter 11</em></a>, <em class="italic">Dissecting Linux and IoT Malware</em>, focuses on malware for Linux and Unix-like systems. We will cover file formats that are used on these systems, go through various static and dynamic analysis techniques, and explain malware’s behavior using real-world examples.</p>
			<p><a href="B18500_12.xhtml#_idTextAnchor1327"><em class="italic">Chapter 12</em></a>, <em class="italic">Introduction to macOS and iOS Threats</em>, looks at various threats that target the users of macOS and iOS and explores how to analyze them.</p>
			<p><a href="B18500_13.xhtml#_idTextAnchor1503"><em class="italic">Chapter 13</em></a>, <em class="italic">Analyzing Android Malware Samples</em>, dives into the internals of the most popular mobile operating system in the world, explores existing and potential attack vectors, and provides detailed guidelines on how to analyze malware targeting Android users.</p>
			<h1 id="_idParaDest-8"><a id="_idTextAnchor007"/>To get the most out of this book</h1>
			<div><div><img src="img/B18500_Preface_Table_1.jpg" alt=""/>
				</div>
			</div>
			<p><em class="italic">There are way more tools mentioned in the book with examples; these are some of the most important ones.</em></p>
			<p><strong class="bold">If you are using the digital version of this book, we advise you to type the code yourself or access the code from the book’s GitHub repository (a link is available in the next section). Doing so will help you avoid any potential errors related to the copying and pasting of code.</strong></p>
			<p><em class="italic">The syntax of the IDA scripting language may change slightly over time. If something stops working, refer to the official documentation.</em></p>
			<h1 id="_idParaDest-9"><a id="_idTextAnchor008"/>Download the example code files</h1>
			<p>You can download the example code files for this book from GitHub at <a href="https://github.com/PacktPublishing/Mastering-Malware-Analysis-Second-edition">https://github.com/PacktPublishing/Mastering-Malware-Analysis-Second-edition</a>. If there’s an update to the code, it will be updated in the GitHub repository.</p>
			<p>We also have other code bundles from our rich catalog of books and videos available at <a href="https://github.com/PacktPublishing/">https://github.com/PacktPublishing/</a>. Check them out!</p>
			<h1 id="_idParaDest-10"><a id="_idTextAnchor009"/>Download the color images</h1>
			<p>We also provide a PDF file that has color images of the screenshots and diagrams used in this book. You can download it here: <a href="https://packt.link/uFbey">https://packt.link/uFbey</a>.</p>
			<h1 id="_idParaDest-11"><a id="_idTextAnchor010"/>Conventions used</h1>
			<p>There are a number of text conventions used throughout this book.</p>
			<p><code>Code in text</code>: Indicates code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. Here is an example: Notably, IDT was used to pass data to kernel mode in Windows 2000 and earlier before <code>sysenter</code> became the preferred method of doing this.</p>
			<p>A block of code is set as follows:</p>
			<pre class="source-code">
push Arg02
push Arg01
call Func01</pre>
			<p>Any command-line input or output is written as follows:</p>
			<pre>sc create &lt;service_name&gt; type= own binpath= &lt;path_to_executable&gt;</pre>
			<p><strong class="bold">Bold</strong>: Indicates a new term, an important word, or words that you see onscreen. For instance, words in menus or dialog boxes appear in <strong class="bold">bold</strong>. Here is an example: In VirtualBox, open the VM's settings and go to the <strong class="bold">Serial Ports</strong> category.</p>
			<p class="callout-heading">Tips or Important Notes</p>
			<p class="callout">Appear like this.</p>
			<h1 id="_idParaDest-12"><a id="_idTextAnchor011"/>Get in touch</h1>
			<p>Feedback from our readers is always welcome.</p>
			<p><strong class="bold">General feedback</strong>: If you have questions about any aspect of this book, email us at <a href="http://customercare@packtpub.com">customercare@packtpub.com</a> and mention the book title in the subject of your message.</p>
			<p><strong class="bold">Errata</strong>: Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you would report this to us. Please visit <a href="http://www.packtpub.com/support/errata">www.packtpub.com/support/errata</a> and fill in the form.</p>
			<p><strong class="bold">Piracy</strong>: If you come across any illegal copies of our works in any form on the internet, we would be grateful if you would provide us with the location address or website name. Please contact us at <a href="http://copyright@packt.com">copyright@packt.com</a> with a link to the material.</p>
			<p><strong class="bold">If you are interested in becoming an author</strong>: If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, please visit <a href="http://authors.packtpub.com">authors.packtpub.com</a>.</p>
			<h1 id="_idParaDest-13"><a id="_idTextAnchor012"/>Share Your Thoughts</h1>
			<p>Once you’ve read <em class="italic">Mastering Malware Analysis, Second Edition</em>, we’d love to hear your thoughts! <a href="https://packt.link/r/1803240245">Please click here to go straight to the Amazon review page</a> for this book and share your feedback.</p>
			<p>Your review is important to us and the tech community and will help us make sure we’re delivering excellent quality content.</p>
		</div>
	

		<div><h1 id="_idParaDest-14"><a id="_idTextAnchor013"/>Part 1 Fundamental Theory</h1>
		</div>
		<div><p>In this section, you will be introduced to the core concepts required to successfully perform the static analysis of samples for various platforms, including the basics of architecture and assembly. While you may already have some prior knowledge of the x86 family, less common architectures, such as PowerPC or SH-4, are also extensively targeted by malware nowadays, so they shouldn’t be underestimated.</p>
			<p>In this section are the following chapters:</p>
			<ul>
				<li><a href="B18500_01.xhtml#_idTextAnchor014"><em class="italic">Chapter 1</em></a><em class="italic">, Cybercrime, APT Attacks, and Research Strategies</em></li>
				<li><a href="B18500_02.xhtml#_idTextAnchor043"><em class="italic">Chapter 2</em></a><em class="italic">, A Crash Course in Assembly and Programming Basics</em></li>
			</ul>
		</div>
		<div><div></div>
		</div>
		<div><div></div>
		</div>
		<div><div></div>
		</div>
	</body></html>