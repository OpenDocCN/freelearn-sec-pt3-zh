<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Email and Instant Messaging Forensics</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will cover the following recipes:</p>
<ul>
<li>Outlook mailbox parsing with Intella</li>
<li>Thunderbird mailbox parsing with Autopsy</li>
<li>Webmail analysis with Magnet AXIOM</li>
<li>Skype forensics with Belkasoft Evidence Center</li>
<li>Skype forensics with <span>SkypeLogView</span></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p>Accessing a suspect's communications via email and instant messengers will help you to solve lots of cases; and you will be asked to find and extract such artifacts very often. It doesn't matter if the case is a phishing attack, intellectual property theft, or a terrorist act - a computer forensic examiner must be able to locate, parse, and analyze a suspect's digital communications.</p>
<p>In this chapter, we will show you how to parse and analyze artifacts from the most common Windows email clients - Microsoft Outlook, Mozilla Thunderbird, and Skype instant messenger.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Outlook mailbox parsing with Intella</h1>
                </header>
            
            <article>
                
<p>Intella is a very powerful digital forensic and eDiscovery tool capable of processing, searching, and analyzing <strong>Electronically Stored Information</strong> (<strong>ESI</strong>). One of its main features is visual analytics. This feature can help an examiner to understand <span>the ESI and custodian relationships better. In this recipe, we will show you how to parse an Outlook mailbox with this tool.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>If you don't have a valid Intella license, you can get a free 14-day trial version from Vound Software's website (check the <em>See also</em> section). You will also need a <kbd>PST</kbd> or <kbd>OST</kbd> file to follow this recipe. It's easy to get one: simply use your own email address with Outlook, then go to <kbd>C:\Users\%USERNAME%\AppData\Local\Microsoft\Outlook</kbd> and get your file. This will be your evidence source, in our case an <kbd>OST</kbd> file.</p>
<div class="packt_infobox"><span>PST files are used for POP3, IMAP, and web-based mail accounts, while OST files are used when a user has an Exchange account and wants to work offline.</span></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>We can start the process by following the given steps:</p>
<ol>
<li>Start by creating a new case. To do this, run Intella (you'll see Intella Case Manager), type your name (in our case it's <kbd>Test</kbd>), and click the <span class="packt_screen">Add...</span> button, as shown in the following figure:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="453" width="569" class="image-border" src="assets/5084cecf-a08a-470b-ae7e-ac6ea6f3c2b6.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 9.1. Adding a new case</div>
<ol start="2">
<li>Using the <strong><span class="packt_screen">Add Case</span></strong> dialog, an examiner can <span class="packt_screen">Create a new case</span>, <span class="packt_screen">Open a shared case</span>, <span class="packt_screen">Add an existing case,</span> or <span class="packt_screen">Import a case</span>.</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="303" width="378" class="image-border" src="assets/86019c26-aca4-4d46-be12-db3ba7781f7f.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.2. Add Case dialog</div>
<ol start="3">
<li>As we have decided to create a new case, let's choose <strong><span class="packt_screen">Create a new case</span></strong>. Now you can see a few fields to fill in. Also you can choose a folder for storing the temporary indexing files - it improves the indexing speed!</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="382" width="439" class="image-border" src="assets/8bb4e037-5a76-4e0e-aa24-4b8f6efb15db.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.3. Creating a new case</div>
<ol start="4">
<li>It's time to choose our evidence source. As we already mentioned, we are going to use an <kbd>OST</kbd> file, so let's choose the <span class="packt_screen">File or Folder</span> option, as shown in the following figure:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="396" width="516" class="image-border" src="assets/e5900a9a-f025-4d82-b925-77047aba27db.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.4. Adding a new source</div>
<ol start="5">
<li>In our case, the file is named <kbd>test.ost</kbd> and is located in the root of <kbd>E:\ drive</kbd>, as you can see in the following figure:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="76" width="594" class="image-border" src="assets/a960f484-d095-4922-b2d2-c11906334e52.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.5. Adding a file to process</div>
<ol start="6">
<li>If you don't like the original name of the source, you can change it to one you like. Also, you should choose the right time zone, or just choose UTC if the right time zone is unknown.</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="476" width="622" class="image-border" src="assets/778f04e0-7fef-485b-aa16-b8b16ed3c02e.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.6. Choosing the source name and the time zone</div>
<ol start="7">
<li>OK, let's choose the items we want to process. In our case, they are the following:
<ul>
<li>Mail archives: we are processing an Outlook mailbox, so this is very important</li>
<li>Archives: can be attached to emails</li>
<li>Images embedded in emails and documents</li>
<li>Deleted emails</li>
<li>Text fragments from unsupported and unrecognized file types</li>
</ul>
</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img style="font-size: 1em" height="475" width="626" class="image-border" src="assets/324da438-04ef-460d-9a78-6f9a87fd3ef8.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 9.7. Choosing items to process</div>
<ol start="8">
<li>You can skip two next windows and start evidence processing. Once indexing is complete, you will see the overview, as shown in the following figure:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="458" width="477" class="image-border" src="assets/424a3906-357e-4427-8fcc-6dadd1821920.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.8. Indexing the evidence source</div>
<ol start="9">
<li>Click <strong><span class="packt_screen">Finish</span></strong> and you'll see the main window with three tabs; look at the following figure:</li>
</ol>
<div><img class="image-border" src="assets/72d5190c-c470-42d2-91da-4505b00c9611.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.9. Intella Search tab</div>
<ol start="10">
<li>As you can see, we have 44 items, including the 19 that were recovered. Now we can search the indexed data using different keywords and facets, such as email addresses, phone numbers, author, date, type, and so on. Also, we can use this tab to create cluster maps, histograms, and social graphs, which can be very useful.</li>
<li>OK, let's go to the <strong><span class="packt_screen">Insight</span></strong> tab, as shown in the following figure:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="377" width="803" class="image-border" src="assets/d99a8a63-e4ac-46c1-8388-4452856aebee.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 9.10. Intella Insight tab</div>
<p style="padding-left: 60px">Here we have the evidence overview. For example, Intella shows us that we are dealing with Microsoft Outlook, we have 19 recovered artifacts, six email messages, and 44 items in total.</p>
<ol start="12">
<li>Let's check the last tab - <strong><span class="packt_screen">Keywords</span></strong>. Look at the following figure:</li>
</ol>
<div><img class="image-border" src="assets/d2415598-62c9-42c0-a11d-4c3ec1f71164.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.11. Intella Keywords tab</div>
<p style="padding-left: 60px">First of all, you can use this tab to add custom keyword lists - it can save you time! Also, you can choose where you want to search. For example, if you want to look for keywords only in the emails' subjects, then you can uncheck all options first and choose only 'Title/Subject'.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Intella indexes the chosen evidence source and enables a computer forensic examiner to search through the indexed data. It can also be used to create cluster maps, histograms, social graphs, and so on.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>Intella overview:</p>
<p><a href="https://www.vound-software.com/individual-solutions" target="_blank">https://www.vound-software.com/individual-solutions</a></p>
<p>Introduction to Outlook Data Files (<kbd>.pst</kbd> and <kbd>.ost</kbd>):</p>
<p><a href="https://support.office.com/en-us/article/Introduction-to-Outlook-Data-Files-pst-and-ost-6d4197ec-1304-4b81-a17d-66d4eef30b78" target="_blank">https://support.office.com/en-us/article/Introduction-to-Outlook-Data-Files-pst-and-ost-6d4197ec-1304-4b81-a17d-66d4eef30b78</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Thunderbird mailbox parsing with Autopsy</h1>
                </header>
            
            <article>
                
<p>Thunderbird is a free and open source mail client from Mozilla, the developers of the Firefox browser. If a user doesn't use Outlook, they are likely to use Thunderbird. In this recipe, we will show you how to extract data from Thunderbird MBOX files with a free and open source digital forensics platform â€” <strong>Autopsy</strong>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Thunderbird stores mail data in MBOX files. These files can be found at the following location:</p>
<p><kbd>C:\Users\%USERNAME%\AppData\Roaming\Thunderbird\Profiles</kbd></p>
<p>Here you will find a user profile folder, which can be exported and processed with a piece of forensic software, in our case Autopsy.</p>
<p>Of course, you can use the whole forensic image for processing, but if you use only the profile folder, it saves you a lot of time.</p>
<p>Get a Thunderbird profile folder or a forensic image, and start Autopsy. If you haven't installed it already, use the download link in the 'See also' section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>We can start the process by following the given steps:</p>
<ol>
<li>Start by creating a new case and filling in the case details. We are planning to use a Thunderbird profile folder as the source, so in the <strong><span class="packt_screen">Select Data Source</span></strong> window, we choose <strong><span class="packt_screen">Logical Files</span></strong>.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/6474c26d-3633-4114-92eb-befec203be7a.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.12. Selecting data source in Autopsy</div>
<p style="padding-left: 60px">Also, you can choose the display name for your evidence source. You will notice that we have named it <strong><span class="packt_screen">Thunderbird Test</span></strong>.</p>
<ol start="2">
<li>It's time to choose Ingest Modules. We highly recommend always choosing the <strong><span class="packt_screen">Keyword Search</span></strong> module, as this is very helpful. Of course, this time make sure <strong><span class="packt_screen">Email Parser</span></strong> is ticked.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/cf63d196-81de-48db-8500-d79059e496f1.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.13. Configuring ingest modules in Autopsy</div>
<ol start="3">
<li>Once your data source is processed, you can analyze the results. You can find these in the <span class="packt_screen">Email Messages</span> section on the left, as shown in the following figure:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/ed449d10-bd0d-43ff-94ae-b77d9d913fdb.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.14. Parsed email messages</div>
<ol start="4">
<li>As you can see, there are 487 email messages extracted by Autopsy. On the right, you can find everything you need for analysis: sender, recipient, message body, timestamps, and so on.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Autopsy processes the data source specified by a computer forensic examiner and extracts the email data from supported containers, such as MBOX and PST.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>Autopsy download page:</p>
<p><a href="http://sleuthkit.org/autopsy/download.php" target="_blank">http://sleuthkit.org/autopsy/download.php</a></p>
<p>MBOX Email Format:</p>
<p><a href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000383.shtml" target="_blank">https://www.loc.gov/preservation/digital/formats/fdd/fdd000383.shtml</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Webmail analysis with Magnet AXIOM</h1>
                </header>
            
            <article>
                
<p>As you may know, some people (including the authors) use only webmail and no mail clients. Is it possible to recover such forensic artifacts from a drive image? The answer is - yes! And in this recipe, we will show you how to recover webmail activity with Oleg's favorite digital forensic tool - Magnet AXIOM.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We are sure that you already have AXIOM installed on your workstation. So run the tool and create a new case. Now, the most interesting thing is the evidence source. If you have already walked through the recipe <em>Extracting Web Browser Data from Pagefile.sys</em> in <a href="ec4705f6-5645-4d2c-b404-4e9cb9fd02c4.xhtml">Chapter 8</a>, <em>Web Browser Forensics,</em> you may guess what we are going to do next. Yes, webmail artifacts can be extracted from <kbd>pagefile.sys</kbd>, <kbd>swapfile.sys</kbd> and <kbd>hiberfil.sys</kbd>. So you can use one of these files as the data source, or the whole forensic image - AXIOM will find and parse data from these files automatically.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>We can start the process by following the given steps:</p>
<ol>
<li>Process your data source with AXIOM Process; don't forget to include <kbd>pagefile.sys</kbd> and <kbd>hiberfil.sys</kbd>, and make sure mail artifacts are checked. Once the processing phase is finished, go to AXIOM Examine and look at the <span class="packt_screen">EMAIL</span> section. Here you will find extracted email artifacts, including webmail, in our case Gmail, as shown in the following figure:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="92" width="183" class="image-border" src="assets/893c8695-94df-4aef-a778-65ccdf770a50.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.15. Extracted webmail artifacts</div>
<ol start="2">
<li>As you can see, 194 Gmail Webmail artifacts have been extracted. Let's check the source of these artifacts, the first artifact in particular. Click on the artifact and check the <span class="packt_screen">EVIDENCE INFORMATION</span> section.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="148" width="317" class="image-border" src="assets/a6586594-0bf6-437c-8806-d19b5e506a02.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.16. Artifact information</div>
<p style="padding-left: 60px">Look at the preceding figure and you'll see that the artifact is extracted from hiberfil.sys. You can also see the addresses, which are very important for documentation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Magnet AXIOM walks through the hiberfil.sys (or pagefile.sys) file and extracts available webmail artifacts, such as <span>Google's Gmail, Microsoft's Hotmail/Outlook.com, and Yahoo Mail.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>Modern windows hibernation file analysis:</p>
<p><a href="https://www.504ensics.com/uploads/publications/modern-windows-hibernation.pdf">https://www.504ensics.com/uploads/publications/modern-windows-hibernation.pdf</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Skype forensics with Belkasoft Evidence Center</h1>
                </header>
            
            <article>
                
<p>On modern Windows systems Skype is installed by default, so it's very important for a forensic examiner to extract user data from this application. This can be calls, messages, transferred or received files, and so on. In this recipe, we will show you how to parse these valuable artifacts with Belkasoft Evidence Center.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>First of all, you should get a Skype profile folder. Again, you can use a forensic image, but to save time for testing purposes, we recommend using a profile folder as the data source. You can find Skype profile folders (yes, there can be more than one folder, as multiple accounts can be used on the same device) here:</p>
<p class="p1"><kbd>C:\Users\%USERNAME%\AppData\Roaming\Skype\</kbd></p>
<p>Once you get it, make sure Belkasoft Evidence Center (valid licence or trial) is installed on your workstation, and we are ready to start.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>We can start the process by following the given steps:</p>
<ol>
<li>Create a new case and add the profile folder you previously exported as the data source. Use <strong><span class="packt_screen">Selected folder</span></strong>, as shown in the following figure:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="475" width="503" class="image-border" src="assets/d3b81acb-3e56-4e1d-8e94-de64ed38d502.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.17. Adding the data source in Belkasoft Evidence Center</div>
<ol start="2">
<li>Let's choose the right data type. We have a Skype profile folder, so go to <span class="packt_screen">Chats</span>, find <span class="packt_screen">Skype,</span> and tick it. Click <span class="packt_screen">Finish</span> and wait a bit for the data to be parsed, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="446" width="473" class="image-border" src="assets/075f0d8f-84da-4952-9faf-c67b237d8e58.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.18. Choosing data types in Belkasoft Evidence Center</div>
<ol start="3">
<li>Once the data is processed, you can work with the <span class="packt_screen">Overview</span> or <span class="packt_screen">Case Explorer</span> tabs to analyze the extracted data, including calls, messages (including voice), pictures, and so on. It's important to note that Belkasoft Evidence Center also extracts deleted messages from the Skype database (main.db), and analyzes <kbd>chatsync</kbd> files, which may include messages, that are not included in the main database.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Belkasoft Evidence Center processes the data source specified by a computer forensic examiner, and extracts Skype artifacts from the available sources, including SQLite free lists, unallocated space, <kbd>chatsync</kbd> files, <kbd>pagefile.sys</kbd>, <kbd>hiberfil.sys</kbd>, and so on.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>Belkasoft Evidence Center Trial:</p>
<p><a href="https://belkasoft.com/trial">https://belkasoft.com/trial</a></p>
<p>Recovering Destroyed SQLite Evidence, iPhone/Android Messages, Cleared Skype Logs:</p>
<p><a href="https://belkasoft.com/recover-destroyed-sqlite-evidence-skype-and-iphone-logs">https://belkasoft.com/recover-destroyed-sqlite-evidence-skype-and-iphone-logs</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Skype forensics with SkypeLogView</h1>
                </header>
            
            <article>
                
<p>It's always good to have some free pieces of software in your toolkit. There are some free and open source tools for Skype forensics, and one of them is SkypeLogView by NirSoft. You are already familiar with some NirSoft tools, and in this recipe we will show you how to use SkypeLogView for Skype forensicating.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Download SkypeLogView from NirSoft's website (check the <em>See also</em> section for the download link). At the time of writing, the most recent version of the tool is 1.55. Unpack the archive and you are ready to go. You can use the Skype profile folder exported for the previous recipe.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>We can start the process by following the given steps:</p>
<ol>
<li>Start the tool, and you will see a data source window, like the one in the following figure:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="159" width="485" class="image-border" src="assets/c7471c59-0502-4fa0-9bea-fbaa816b43ce.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 9.19. Adding the data source in SkypeLogView</div>
<ol start="2">
<li>All you need now is to click <span class="packt_screen">OK</span> and the magic begins, as shown in the following figure:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="371" width="496" class=" image-border" src="assets/c12f2666-7b58-4e9e-8e58-c303f0de0c9a.png"/></div>
<ol start="3">
<li>Of course, you can sort the extracted data using different columns. If you want the timestamp to be displayed in GMT, go to <strong><span class="packt_screen">Options</span> - <span class="packt_screen">Show Time in GMT</span></strong>.</li>
<li>Finally, you can create an HTML report. To do this, go to <strong><span class="packt_screen">View</span> - <span class="packt_screen">HTML Report</span></strong>.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>SkypeLogView uses an examiner specified folder and extracts available Skype artifacts, such as chats, voicemails, calls, and so on. Also an examiner can create an HTML report for all or for user-selected artifacts.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p><span>SkypeLogView download page:</span></p>
<p><a href="http://www.nirsoft.net/utils/skype_log_view.html" target="_blank">http://www.nirsoft.net/utils/skype_log_view.html</a></p>


            </article>

            
        </section>
    </body></html>