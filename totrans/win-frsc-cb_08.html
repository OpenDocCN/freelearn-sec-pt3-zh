<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Web Browser Forensics</h1>
                </header>
            
            <article>
                
<p class="mce-root">In this chapter, we will cover the following recipes:</p>
<ul>
<li>Mozilla Firefox analysis with BlackBag BlackLight</li>
<li>Google Chrome analysis with Magnet AXIOM</li>
<li>Microsoft Internet Explorer and Microsoft Edge analysis with Belkasoft Evidence Center</li>
<li>Extracting web browser data from Pagefile.sys</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p><span>It is hard to imagine </span>a case where web browser artifacts are useless. Child abuse material, intellectual property theft, cyber harassment, malware - browser artifacts will help to solve all sorts of cases. Nowadays, a huge number of web browsers are available. Some provide their users with increased privacy options, others do not. But even if the suspect uses a private browser, such as notorious Tor, a computer forensic examiner is able to extract some data, for example from swap and hibernation files (check the last recipe in this chapter) or a memory dump.</p>
<p>In this chapter, we will show you how to perform web browser forensics with some forensic tools you have already dealt with, such as Magnet AXIOM and Belkasoft Evidence Center, and some new ones, such as BlackBag's BlackLight.</p>
<p>Finally, you will learn how to defeat some anti-forensic techniques using swap (<kbd>pagefile.sys</kbd> and <kbd>swapfile.sys</kbd>) and hibernation files. Let's go!</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Mozilla Firefox analysis with BlackBag's BlackLight</h1>
                </header>
            
            <article>
                
<p>BlackBag's BlackLight is a very powerful digital forensic tool which we usually use for Mac OS X (macOS) forensicating. But, of course, Mac is not the only platform it supports. You can also use it for Android, iOS, and Windows forensics. What's more, you can use BlackLight both on Windows and macOS workstations, meaning that you can analyze Windows forensic images on a Mac! In this recipe, we will show you how to use BlackLight for Mozilla Firefox forensics.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>If you are not a licensed user of BlackLight, you can request a trial licence on the BlackBag website. Use the REQUEST TRIAL button on the BlackLight page, fill in your personal information, such as first and last names, phone number, city, email, and so on, and click on SUBMIT. You'll get your trial key and product download links via email, so make sure you have submitted your real email, ideally a government or business one.</p>
<p>Now you need to get a folder with Firefox files for analysis. If you have a Windows XP system, look here:</p>
<p><kbd><span>C:\Documents and Settings\%USERNAME%\Application Data\Mozilla\Firefox\</span></kbd></p>
<p>If you are dealing with a Windows Vista system (or later), look here:</p>
<p><kbd><span>C:\Users\admin\AppData\Roaming\Mozilla\Firefox\Profiles\%PROFILE%.default</span></kbd></p>
<p>Among other files, you'll find a bunch of valuable SQLite databases. These databases contain information about browsing history, downloads and so on, and BlackLight will help us to extract and analyze this data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>The steps for Mozilla Firefox analysis are as follows: </p>
<ol>
<li>Open BlackLight and create a new case. To do this, go to <span class="packt_screen">File - New Case</span>, or just click on the <strong>New...</strong> button, and choose your case location. Once you have saved the case, you can start filling in the necessary fields and choose the right time zone, as shown in the following figure:</li>
</ol>
<p><img class="image-border" src="assets/62c9911d-741d-4a75-b7f9-a3a65cf7132f.png"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 8.1. Case details</div>
<ol start="2">
<li>Now we are ready to add evidence. Click on the green <span class="packt_screen">Add</span> button in front of <strong><span class="packt_screen">EVIDENCE</span></strong>. As we have already exported a Firefox profile folder, click on the green <span class="packt_screen">Add</span> button again, then the <span class="packt_screen">Add folder</span> button, and choose the folder you exported.</li>
</ol>
<div class="packt_figref CDPAlignCenter CDPAlign"><img class="image-border" src="assets/d4f71c7a-963a-421d-a27a-00c23edbff13.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 8.2. Adding evidence</div>
<ol start="3">
<li>Once the data has been processed, you should find the extracted data in the <strong><span class="packt_screen">Internet</span></strong> tab. If, for some reason, this tab does not have the desired contents, you can analyze Firefox SQLite databases manually - BlackLight has a powerful built-in SQLite browser!</li>
</ol>
<p style="padding-left: 60px">Let's use it and analyze <kbd>places.sqlite</kbd> - an SQLite database that contains information about the suspect's browsing history. Go to the <span class="packt_screen">Browser </span>tab, choose the database, and use the <span class="packt_screen">Preview</span> feature to examine it with BlackLight SQLite browser.</p>
<p class="packt_figref CDPAlignLeft CDPAlign"><img height="561" width="1219" class="alignnone size-full wp-image-1328 image-border" src="assets/31eb6a75-59c1-4b50-9f34-3191b3ed3a30.png"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 8.3. Manual analysis of 'places.sqlite' SQLite database</div>
<ol start="4">
<li class="mce-root">Date/Time feature. Have you noticed the <strong><span class="packt_screen">Recovered Fragments</span></strong> table? This can help an examiner to recover deleted data - in our case, deleted web history records.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p class="mce-root">BlackLight analyzes Firefox databases and extracts available data (including deleted data) for further examination, including history, bookmarks, downloads, forms data, cookies, and so on. Also, a built-in SQLite browser enables the examiner to analyze these databases manually.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>BlackBag BlackLight page: <a href="https://www.blackbagtech.com/blacklight.html">https://www.blackbagtech.com/blacklight.html</a></p>
<p><span>BlackBag BlackLight Quick Start Guide: </span><a href="https://www.blackbagtech.com/resources/quickstart-guides/quickstart-guide-blacklight.html">https://www.blackbagtech.com/resources/quickstart-guides/quickstart-guide-blacklight.html</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Google Chrome analysis with Magnet AXIOM</h1>
                </header>
            
            <article>
                
<p>Google Chrome is another very popular web browser. You will find its artifacts during many forensic examinations, not only on Windows systems, but also macOS, Linux, and even mobile platforms. With the help of this recipe you will learn how to parse Google Chrome artifacts with Magnet AXIOM.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Of course, you can use the whole forensic image as the source, but it is much faster to extract the Google Chrome folder from the user's profile, as this greatly reduces the dataset that has to be parsed. Here is where you can find the folders you need:</p>
<p>Windows XP:</p>
<p><kbd>C:\Documents and Settings\%USERNAME%\Local Settings\Application Data\Google\Chrome</kbd></p>
<p>Windows Vista and above:</p>
<p><kbd>C:\Users\%USERNAME%\AppData\Local\Google\Chrome</kbd></p>
<p>Export the folder, make sure Magnet AXIOM with a valid licence or trial is installed on your forensic workstation, and you are ready to go.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p class="mce-root">Create a new case in AXIOM, use the folder you exported as the evidence source, and make sure Google Chrome is chosen in the artifacts list. As soon as all these steps are performed, run evidence analysis. It won't take too much time, but you'll get lots of useful forensic artifacts. The artifacts extracted in our case are shown in the following figure.</p>
<div class="CDPAlignCenter CDPAlign"><img height="467" width="267" class="image-border" src="assets/c9fab597-ddd9-4e83-b751-59e768b40fe8.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 8.4. Google Chrome artifacts extracted with Magnet AXIOM</div>
<p>As you can see in the preceding figure, there are quite a lot of artifacts. Let's dive a bit deeper.</p>
<ul>
<li><strong>Chrome Autofill Profiles</strong> are profiles used by Chrome to fill in form fields automatically.</li>
<li><strong>Chrome Bookmarks</strong> are webpages bookmarked by the user.</li>
<li><strong>Chrome Cache Records</strong> are files downloaded by the browser to speed up the loading of  webpages. This can include pictures, HTML, javascript, and so on.</li>
<li><strong>Chrome Cookies</strong> - small files which contain information about websites visited by the user.</li>
<li><strong>Chrome Current Session</strong> - information about the current session.</li>
<li><strong>Chrome Current Tabs</strong> - tabs opened in the current session.</li>
<li><strong>Chrome Downloads</strong> - files downloaded with Google Chrome.</li>
<li><strong>Chrome FavIcons</strong> - favicons from the Chrome address bar.</li>
<li><strong>Chrome Keyword Search Terms</strong> - keywords entered by the user.</li>
<li><strong>Chrome Last Session</strong> - information about the previous session.</li>
<li><strong>Chrome Last Tabs</strong> - tabs opened in the previous session.</li>
<li><strong>Chrome Logins</strong> - the user's login information saved by Chrome.</li>
<li><strong>Chrome Shortcuts</strong> - shortcuts for user entered URLs.</li>
<li><strong>Chrome Sync Accounts</strong> - user accounts used for syncing to the cloud.</li>
<li><strong>Chrome Sync Data</strong> - data synced to the cloud.</li>
<li><strong>Chrome Top Sites</strong> - most frequently visited websites.</li>
<li><strong>Chrome Web History</strong> - websites the user visited (unique visits only).</li>
<li><strong>Chrome Web Visits</strong> - websites the user visited (all visits).</li>
</ul>
<p>Also, AXIOM uses a carving technique to recover deleted data from Chrome databases.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Magnet AXIOM finds and parses Google Chrome artifacts from a forensic image, drive, folder, or file specified by a digital forensic examiner. Parsed artifacts are divided into several groups to make forensicating even more convenient. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p class="entry-title">Digital Forensics: Artifact Profile Google Chrome:</p>
<p><a href="https://www.magnetforensics.com/artifact-profiles/artifact-profile-google-chrome/">https://www.magnetforensics.com/artifact-profiles/artifact-profile-google-chrome/</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Microsoft Internet Explorer and Microsoft Edge analysis with Belkasoft Evidence Center</h1>
                </header>
            
            <article>
                
<p>Hopefully, you have already added Belkasoft Evidence Center to your Windows forensic toolkit. As you will remember, it can help you to carve data out of memory dumps. Of course, this is not the only task it can help you to solve. It has robust support for hundreds of Windows operating system forensic artifacts, including different web browsers. In this recipe, we will show you how to use it for Microsoft Internet Explorer and Microsoft Edge forensic analysis.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>If you already have Belkasoft Evidence Center installed, just start the tool. Otherwise, use the trial download link from the <em>See also</em> section to obtain a trial version of the tool. You will need a Windows 10 image, as we are planning to analyze Microsoft Edge data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>The steps for Microsoft Edge analysis and Microsoft Internet Explorer Analysis using Belkasoft Evidence Center are as follows:  </p>
<ol>
<li>First of all, let's create a new case. Fill in the case information, choose the <span class="packt_screen">Root folder</span> (the case folder will be created automatically), and don't forget to make sure you choose the right time zone from the drop-down menu. If you want, you can add a case description as well.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="413" width="496" class="image-border" src="assets/918e2b32-a560-4262-b1da-9ba2344e70a9.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 8.5. Creating a new case <span><span>in Belkasoft Evidence Center</span></span></div>
<ol start="2">
<li>Now it's time to choose a data source. As you can see in the following figure, we have a number of options here. This time, we are going to choose a drive image. We have a test image named <kbd>Browsers.E01</kbd>. If you have created an image of a Windows 10 drive, you can use it for this recipe, otherwise, find such a system and solidify your knowledge by imaging it. Also, you can create a Windows 10 virtual machine and use its virtual disk - such disks are also supported by Belkasoft Evidence Center. </li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="479" width="510" class="image-border" src="assets/ecf27ce4-0814-4b4e-93cd-12a8a191640e.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 8.6. Adding a data source in Belkasoft Evidence Center</div>
<ol start="3">
<li>Let's choose the forensic artifacts we want to search for. First, click on the <span class="packt_screen">Select none </span>to uncheck all data types. Now go to <span class="packt_screen">Browsers</span>, scroll down to <span class="packt_screen">Windows</span> on the left pane, and choose <span class="packt_screen">Edge,</span> and then <span class="packt_screen">Internet Explorer</span>. Don't forget to tick the <span class="packt_screen">Carve</span> option to extract even more data!</li>
</ol>
<div class="packt_figref CDPAlignCenter CDPAlign"><img height="449" width="476" class="image-border" src="assets/fb36bc0f-88ef-467c-a3c2-5791d0b17eb4.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 8.7. Choosing data types in Belkasoft Evidence Center</div>
<p>  Once the image has been processed, you'll see all the results in both the <span class="packt_screen">Overview</span> and <span class="packt_screen">Case Explorer</span> tabs.</p>
<div class="packt_figref CDPAlignCenter CDPAlign"><img height="95" width="169" class="image-border" src="assets/7150ce8b-c127-4229-9d2c-e39677ca6c1e.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 8.8. Overview tab</div>
<ol start="4">
<li>If you dig deeper and analyze browser history artifacts, you will notice that all of them are marked as <span class="packt_screen">Internet Explorer 10+</span>. This is because both Internet Explorer and Edge store history records in the same database, located at: <kbd>C:\Users\%USERNAME%\AppData\Local\Microsoft\Windows\WebCache\WebCacheV01.dat</kbd></li>
</ol>
<p style="padding-left: 60px">Also, you can see the <span class="packt_screen">Typed URLs</span> section in the preceding figure. These URLs are <span>typed by the user directly   into the browser's address bar, and are stored in the registry. You can learn more about Windows Registry   forensics in <a href="b0744ad4-0b69-4f94-8ba3-ab97e53116f8.xhtml">Chapter 6</a>, <em>Windows Registry Analysis.</em></span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Belkasoft Evidence Center walks through all files and folders and extracts available data from web browsers. If carving is enabled, it also extracts data from unallocated space.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p>Belkasoft Evidence Center download page:</p>
<p><a href="https://belkasoft.com/get">https://belkasoft.com/get</a></p>
<p>Internet Explorer developer documentation:</p>
<p><a href="https://msdn.microsoft.com/en-us/library/hh772401(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/hh772401(v=vs.85).aspx</a></p>
<p>Microsoft Edge developer documentation:</p>
<p><a href="https://docs.microsoft.com/en-us/microsoft-edge/">https://docs.microsoft.com/en-us/microsoft-edge/</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Extracting web browser data from Pagefile.sys</h1>
                </header>
            
            <article>
                
<p>You already know that you can extract quite a lot of useful forensic artifacts from a memory dump. But there is more: you can perform memory forensics even without a memory dump! There are files on the drive that contain some parts of memory. These files are <kbd>pagefile.sys</kbd>, <kbd>swapfile.sys</kbd>, and <kbd>hiberfil.sys</kbd>, and they are located at the system root (<kbd>C:\</kbd>). In this recipe, we will show you how to extract browser data from <kbd>pagefile.sys</kbd> with Belkasoft Evidence Center.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>First of all, make sure you have Belkasoft Evidence Center with a valid licence (or a trial version) installed on your workstation. Then, use a tool of your choice, for example FTK Imager, to export data from your own system or from a forensic image you acquired earlier. As soon as you have this, you are ready to go.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>The steps to extract web browser data from <kbd>Pagefile.sys</kbd> are as follows:</p>
<ol>
<li>Start by creating a new case in Belkasoft Evidence Center - you already know how to do this. Then, add the <kbd>pagefile.sys</kbd> file you exported previously as the evidence source.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="474" width="501" class="image-border" src="assets/10d0f627-8459-40bf-a66f-6c26138942e8.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 8.9. Adding pagefile.sys as the evidence source</div>
<ol start="2">
<li>As we are planning to extract web browser artifacts and are dealing with a Windows system, let's choose corresponding data types, as in the following figure:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="448" width="474" class="image-border" src="assets/ee364d60-cda0-498c-9e79-30aad4141730.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Figure 8.10. Choosing data types</div>
<ol start="3">
<li>Click <span class="packt_screen">Finish</span> and the processing will start. Once the processing phase has finished, go to the <span class="packt_screen">Overview</span> tab and check the results.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="436" width="911" class="image-border" src="assets/00a6b9f4-44b0-4858-95e5-244a058f0ba7.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Figure 8.11. Processing results</div>
<p style="padding-left: 60px">  As you can see in the preceding figure, we have 2289 URLs extracted from pagefile.sys! Impressive,   isn't it? You can do the same with two other files: swapfile.sys and hiberfil.sys.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Belkasoft Evidence Center walks through <kbd>Pagefile.sys</kbd> and extracts records from available web browsers. If a digital forensic examiner chooses more data types, it can extract even more data, including images, messages, emails, and so on.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<p class="entry-title">What is the Page File for anyway?</p>
<p><a href="https://blogs.technet.microsoft.com/askperf/2007/12/14/what-is-the-page-file-for-anyway/">https://blogs.technet.microsoft.com/askperf/2007/12/14/what-is-the-page-file-for-anyway/</a></p>
<p>Analyzing hibernation and page files:</p>
<p><a href="http://ru.belkasoft.com/ru/bec/en/Hibernation_And_Page_Files_Investigation.asp">http://ru.belkasoft.com/ru/bec/en/Hibernation_And_Page_Files_Investigation.asp</a></p>


            </article>

            
        </section>
    </body></html>