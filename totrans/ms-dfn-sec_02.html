<html><head></head><body>
		<div><h1 id="_idParaDest-15"><em class="italic"><a id="_idTextAnchor014"/>Chapter 1</em>: A Refresher on Defensive Security Concepts </h1>
			<p><em class="italic">Cybersecurity is no longer an exclusive matter of the IT department, it is increasingly an issue that needs to be understood by the company's leadership and a challenge that involves the awareness and knowledge of each of the members of the organization. </em></p>
			<p><em class="italic">– Rogelio Umaña - Senior Partner | Digital Transformation for RDP Consulting</em></p>
			<p>Understanding the core cybersecurity concepts is key to becoming a master. A master is not just defined by their experience in relation to a given technology, but also by their deep understanding of the topics and the proper use of the technological jargon and concepts. </p>
			<p>As a cybersecurity expert, you may be engaged by the media who want to know more about the latest attack, or called by the government to be part of a team of advisors in cybersecurity. In both cases, you will have to be prepared to speak up and provide your expert opinion, and this chapter will prepare you to be so well-grounded in cybersecurity concepts that you are able to speak as a master!</p>
			<p>As part of this journey, we're going to cover the following main topics:</p>
			<ul>
				<li>A deep dive into the core of cybersecurity</li>
				<li>Managing cybersecurity's legendary pain point: <em class="italic">Passwords</em></li>
				<li>How to master defense-in-depth</li>
				<li>A comprehensive explanation of the Blue and Red teams</li>
			</ul>
			<h1 id="_idParaDest-16"><a id="_idTextAnchor015"/>Technical requirements</h1>
			<p>There are no technical requirements for this chapter, but you may need a cup of Java (to prepare your brain for the tons of knowledge that you are about to receive). </p>
			<p>Now, let's get ready for our learning adventure.</p>
			<h1 id="_idParaDest-17"><a id="_idTextAnchor016"/>Deep dive into the core of cybersecurity</h1>
			<p>A master<a id="_idIndexMarker000"/> possesses a higher knowledge and understanding of their domain. In this case, you should understand all the concepts, terminology, and attacks to confidently speak as a cybersecurity expert. It is not about repeating what you are told; it is about acquiring a level of understanding in which you can explain all these topics to the point that everyone will understand them (even if they are not familiar with IT concepts). </p>
			<h2 id="_idParaDest-18"><a id="_idTextAnchor017"/>The cybersecurity triad </h2>
			<p>A CISO once<a id="_idIndexMarker001"/> told me: If you want to see whether the person talking about an attack really knows their business, just ask: What element of the <strong class="bold">CIA triad</strong> is being impacted by this attack? If no response is forthcoming, that person is a newbie. If the answer is not clear or lacking in arguments, that person is a junior, but if the response clearly outlines what elements of the triad will be affected by the attack and why, then you are talking with an expert.</p>
			<p><em class="italic">This triad is especially important when working on defensive security because it will help you to prioritize the risks based on the impact and how that impact correlates with the business.</em></p>
			<p>This is especially important for organizations as this helps them to identify priority areas to invest in (and to provide more resources) to reduce the impact or damage to the company in the event of a cyber attack. For example, an attack on the availability of the informational web page of an HR company may result in a minimal impact on the business, while an attack on the confidential information that they manage could be catastrophic. </p>
			<div><div><img src="img/Figure_1.1_B16290.jpg" alt="Figure 1.1 – CIA triad&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.1 – CIA triad</p>
			<p><em class="italic">Figure 1.1</em> shows the three components of the <strong class="bold">CIA triad</strong>: <strong class="bold">Confidentiality</strong>, <strong class="bold">Integrity</strong>, and <strong class="bold">Availability</strong>. Now, let's <a id="_idIndexMarker002"/>take an in-depth look at each of these three concepts.</p>
			<h3>Confidentiality</h3>
			<p>The attacks<a id="_idIndexMarker003"/> affecting confidentiality are based on access by an unauthorized person to the company's data. But how do you know who can access which kinds of data? The best way to respond to this question is by following the best practice that says that all companies must have their data classified and labeled based on its sensitivity. That way, you can effectively determine how to put in place the appropriate controls. The data can be classified as follows: </p>
			<ul>
				<li><strong class="bold">Restricted</strong>: This is the most important data the company possesses as it may include trade secrets that, if disclosed, could have a catastrophic impact on the company.</li>
				<li><strong class="bold">Confidential</strong>: This is data that companies must keep confidential (on a need-to-know basis). Many times, this type of data is associated with some external regulations, and sanctions and fines may apply if disclosed.</li>
				<li><strong class="bold">Private</strong>: This is less sensitive data. However, it is not intended for public consumption and should be maintained within the organization.</li>
				<li><strong class="bold">Public</strong>: This is data that is intended for public distribution (most of the time, it is available and<a id="_idIndexMarker004"/> indexed online).</li>
			</ul>
			<h3>Integrity</h3>
			<p>Besides<a id="_idIndexMarker005"/> keeping the data confidential, we also need to ensure that data is not altered by a malicious actor. In fact, we need to ensure that appropriate mechanisms are in place to ensure that the data will only be changed by authorized parties. </p>
			<p>This is especially relevant if your company runs a transactional website (such as an e-commerce website) because an attacker may attack your database and create or modify discount codes and, by the time you discover the issue, your merchandise may already be sold and delivered for a fraction of the original price.</p>
			<p>What makes these attacks more dangerous is that the attacker will not just apply this discount to their purchase but for everyone. Therefore, you may find 1,000 orders discounted by 99%, making it harder for you to identify who performed the attack.</p>
			<p>The most famous <em class="italic">hacks</em> to banks were caused because the integrity of the data was compromised.</p>
			<p>Therefore, due to the impact of these kinds of attacks, companies must proactively and constantly invest time and resources to prevent them. </p>
			<h3>Availability</h3>
			<p>These attacks<a id="_idIndexMarker006"/> aim to disrupt the availability of a given system, network, or web resource. </p>
			<p>Except for online stores, these are the less dangerous type of attack; however, such attacks are also the most common type of attack. In fact, the majority of the attacks performed by Hacktivist groups aim to disrupt system availability.</p>
			<h2 id="_idParaDest-19"><a id="_idTextAnchor018"/>Types of attacks</h2>
			<p>To implement a good<a id="_idIndexMarker007"/> defensive strategy, you must understand the current threat landscape and the most common types of attacks—<em class="italic">you cannot be protected against the unknown</em>. Some sources separate the attacks by type based on the area of impact; for example, network attacks and physical attacks. However, such a high-level categorization is too simple for a master like you, so instead, I am going to provide you with an extensive and up-to-date list of the most common types of attacks<a id="_idIndexMarker008"/> that you may encounter today, as seen in <em class="italic">Figure 1.2</em>:</p>
			<div><div><img src="img/Figure_1.2_B16290.jpg" alt="Figure 1.2 – Cybersecurity threat landscape&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.2 – Cybersecurity threat landscape</p>
			<p>Now, let's explore each of these categories so as to have a better understanding of the current threat landscape.</p>
			<h3>Malware</h3>
			<p>Everyone is<a id="_idIndexMarker009"/> familiar with this type of attack. In fact, almost everyone will be affected by this type of attack at least once in their life. However, while most of them can be prevented with good and up-to-date antivirus software, it is worthwhile keeping an eye on new threats to ensure that our protection mechanisms are capable of dealing with new threats.</p>
			<p>To enhance the efficacy of these types of attacks, normally they are used in conjunction with other tactics to spread it, for example, by using social engineering.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">There are several types of malware, including RAT, Trojans, Worms, Ransomware, Spyware, and more. Each of them is different and you must understand their unique characteristics to be able to appropriately defend against them.</p>
			<p>As a fun fact, I recall when I discovered that the reason for me having to re-install the OS of my mom's computer every week was due to my brother believing in his <em class="italic">good luck</em> when surfing the <a id="_idIndexMarker010"/>internet: </p>
			<div><div><img src="img/Figure_1.3_B16290.jpg" alt="Figure 1.3 – Samples of &quot;You Won&quot; malware&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.3 – Samples of "You Won" malware</p>
			<p>Now, let's look <a id="_idIndexMarker011"/>at the <strong class="bold">biggest</strong> threat to the security of any corporation, infiltration through <strong class="bold">social engineering</strong>:</p>
			<h3>Social engineering</h3>
			<p>As technology <a id="_idIndexMarker012"/>enthusiasts, we often focus on <a id="_idIndexMarker013"/>securing our systems and networks. In fact, we may invest a lot of time, effort, and resources in building a robust cybersecurity environment, but that will not be complete until you include the weakest actor, the user.</p>
			<p>I have seen many cases when a company suffers a catastrophic attack, not because their expensive systems were breached, not because they were attacked by a sophisticated zero-day vulnerability, but because an employee inadvertently provided their credentials to an attacker.</p>
			<p>This topic is normally overlooked, and criminals know that, so you must understand and apply all the strategies, mechanisms, and systems to avoid these types of attacks in your organization. In <a href="B16290_04_Final_JC_ePub.xhtml#_idTextAnchor092"><em class="italic">Chapter 4</em></a>, <em class="italic">Patching Layer 8</em>, we will go in deep about how to defend against attacks including phishing, spear phishing, whaling, pharming, and more.</p>
			<h3>Man-in-the-middle attacks</h3>
			<p>Imagine you are <a id="_idIndexMarker014"/>on a date in the mall, and you <a id="_idIndexMarker015"/>want to show a video, but Murphy's law intervenes and your internet speed is extremely slow. However, there is a Wi-Fi network called <strong class="bold">Free Wi-Fi</strong> – sounds like a miracle, right? Well, let me tell you that it is not your lucky day. Chances are that a cybercriminal knows that cellular reception is poor in that area and lays a trap to capture all your data without you even noticing it.</p>
			<p>While this is a simplistic case of a man-in-the-middle-attack, it shows you how easy it is to achieve it.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">In terms of techniques, the criminal may use one of the many available, such as session hijacking, IP spoofing, replay, or eavesdropping. These will be covered in depth in <a href="B16290_08_Final_JC_ePub.xhtml#_idTextAnchor193"><em class="italic">Chapter 8</em></a>, <em class="italic">Enhancing Your Network Defensive Skills</em>.</p>
			<h3>Denial-of-service attack</h3>
			<p>The all-time <a id="_idIndexMarker016"/>favorite attack employed<a id="_idIndexMarker017"/> by<a id="_idIndexMarker018"/> hacktivists, the <strong class="bold">Distributed Denial-of-Service</strong> (<strong class="bold">DDoS</strong>) attack, is very interesting because it may affect you in two ways, as an attacker, and as a target. As mentioned earlier, the impact of these kinds of attacks depends on the nature of business; however, your infrastructure can be used by an attacker to launch a Botnet-based attack on another company and that will have serious implications for your company regardless of the type of business.</p>
			<p class="callout-heading">Botnets</p>
			<p class="callout">A Botnet is a network of infected devices that are remotely controlled by an attacker (normally using a command and control server) to perform a plurality of tasks without the consent and knowledge of the owner of the device. The controlled or infected machines are normally called zombies and, as mentioned, they will perform background tasks such as DDoS attacks, sending spam, and mining cryptocurrency (Bitcoins). </p>
			<p>One interesting variant of these attacks is the SYN flood attack. This attack is very interesting and clever, and it is based on the TCP three-way handshake. But wait, what is a TCP three-way handshake?</p>
			<p>Let me do an analogy to explain it: Imagine that you (the client) need a cab (the server), so you decided to call the cab (SYN). When the cab arrives, it informs you that it is at the gate (SYN-ACK) and waits for your confirmation to pass (ACK). Now, imagine that you never confirm and keep calling more cabs. Eventually, your driveway will be full of cabs, preventing the arrival of any other car to your house.</p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_1.4_B16290.jpg" alt="Figure 1.4 – SYN flood attack&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.4 – SYN flood attack</p>
			<p>I know this <strong class="bold">SYN Flood Attack</strong> may sound very technical, but that doesn't make it less common. Additionally, there <a id="_idIndexMarker019"/>are many other ways <a id="_idIndexMarker020"/>to execute a <strong class="bold">DDOS attack</strong>, and another cool example is the <strong class="bold">teardrop attack</strong>.</p>
			<h4>Teardrop attack</h4>
			<p>The teardrop <a id="_idIndexMarker021"/>attack leverages an old vulnerability in <a id="_idIndexMarker022"/>which the system tries to reassemble fragmented packets, but since they were corrupted, the system crashes (by taking the CPU to 100%). As mentioned, this is an old vulnerability and an up-to-date system should not be affected. However, there is a new version called <strong class="bold">FragmentSmack</strong>, which affects current OSes, including Windows 10 and Linux distributions (see CVE-2018-5391). The good thing is that there are already patches for both.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">As a walkaround in Windows systems, you can disable packet reassembly as follows:</p>
			<p class="callout"><code>Netsh int ipv4 set global reassemblylimit=0</code></p>
			<p class="callout"><code>Netsh int ipv6 set global reassemblylimit=0</code></p>
			<p>There are other types of DDoS attacks, including the <strong class="bold">Ping of Death</strong> and <strong class="bold">Smurf Attacks</strong> (using ICMP packets), but these are old attacks that you should be already familiar with, so I am not<a id="_idIndexMarker023"/> going<a id="_idIndexMarker024"/> to waste your time on them.</p>
			<h3>Zero-day exploits</h3>
			<p>These types <a id="_idIndexMarker025"/>of attacks are one of the most dangerous <a id="_idIndexMarker026"/>ones because they will hit us by surprise.</p>
			<p>When dealing with these types of attacks, reacting fast is the <em class="italic">key</em>. In fact, you need to be on the lookout for new vulnerabilities <em class="italic">all the time</em>, so that you can understand them, evaluate whether they affect your infrastructure, and find a workaround or mitigation until an official solution or patch is released.</p>
			<p>There are many sites and blogs with cybersecurity news; however, as you may know, fake news is prevalent, so you will need to make sure you use a responsible source that provides you with the best information. Personally, I would recommend that you use the following sites<a id="_idIndexMarker027"/> to stay up to date with the latest vulnerabilities and threats:</p>
			<ul>
				<li><a href="https://nakedsecurity.sophos.com">https://nakedsecurity.sophos.com</a></li>
				<li><a href="https://www.darkreading.com">https://www.darkreading.com</a></li>
				<li><a href="http://krebsonsecurity.com">http://krebsonsecurity.com</a><p class="callout-heading">RSS feeds are cool</p><p class="callout">As a side note, I suggest you use RSS feeds to subscribe to the sites above to get all the news in real time. You can get them on your phone using a widget or app or you can add them to your messaging app. For example, I use Slack and the integration is very cool (<a href="https://slack.com/help/articles/218688467-Add-RSS-feeds-to-Slack">https://slack.com/help/articles/218688467-Add-RSS-feeds-to-Slack</a>).</p></li>
			</ul>
			<h3>DNS attacks</h3>
			<p>I recall the <a id="_idIndexMarker028"/>times <a id="_idIndexMarker029"/>when you modify the host file on a Windows 2000 machine just to have some fun by redirecting pages around. However, things have changed and now there are many more sophisticated DNS-related attacks. </p>
			<div><div><img src="img/Figure_1.5_B16290.jpg" alt="Figure 1.5 – Old school DNS attacks&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.5 – Old school DNS attacks</p>
			<p>Now, let's take a look at<a id="_idIndexMarker030"/> everything you need to know about the most <a id="_idIndexMarker031"/>popular DNS attacks today.</p>
			<h3>DNS hijacking</h3>
			<p>In this attack, the <a id="_idIndexMarker032"/>computer is normally affected by<a id="_idIndexMarker033"/> malware that points the computer to the attacker's DNS server instead of a trusted DNS, allowing the attacker to control and redirect all the traffic.</p>
			<p>Here are some defensive measures that can be taken: </p>
			<ul>
				<li>Protect endpoints against malware attacks.</li>
				<li>Always check the URL of the site.</li>
				<li>When possible, type the URL instead of clicking on links (especially from emails)</li>
				<li>Implement DNSSEC.</li>
				<li>Check and/or monitor the <strong class="bold">Host</strong> file for modifications.</li>
				<li>You can also use this web page to check whether your DNS is compromised: <a href="https://forms.fbi.gov/check-to-see-if-your-computer-is-using-rogue-DNS">https://forms.fbi.gov/check-to-see-if-your-computer-is-using-rogue-DNS</a>.</li>
			</ul>
			<h3>Man-in-the-middle </h3>
			<p>This attack <a id="_idIndexMarker034"/>uses the same principle as<a id="_idIndexMarker035"/> the one mentioned previously. It is about intercepting a DNS request and replaying it with a bogus website in response. To achieve this, the attacker intercepts the request between the victim and the real DNS to provide the user with a response to a malicious site. </p>
			<p>Here are some<a id="_idIndexMarker036"/> defensive measures that can be <a id="_idIndexMarker037"/>taken:</p>
			<ul>
				<li>Avoid connecting to open hotspots.</li>
				<li>Avoid connecting to public networks.</li>
				<li>Avoid connecting to free Wi-Fi.</li>
			</ul>
			<h3>DNS router attack</h3>
			<p>In this case, the <a id="_idIndexMarker038"/>attacker leverages a vulnerability<a id="_idIndexMarker039"/> on the router to perform the redirection to the malicious site.</p>
			<p>Here are some defensive measures that can be taken:</p>
			<ul>
				<li>Change the default <strong class="bold">admin</strong> and <strong class="bold">connection</strong> passwords on your network devices (routers, access points, and so on).</li>
				<li>Keep the firmware of your network devices up to date.</li>
				<li>Try purchasing network devices of known reputation (a bad quality firmware device may be vulnerable).</li>
			</ul>
			<h3>DNS cache poisoning </h3>
			<p>This is very <a id="_idIndexMarker040"/>similar to DNS hijacking, but in this case, the<a id="_idIndexMarker041"/> attacker just modifies the DNS cache to send future requests to malicious sites.</p>
			<p>The following diagram depicts an exemplary embodiment of a cache poisoning attack: </p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_1.6_B16290.jpg" alt="Figure 1.6 – Cache poisoning attack flow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.6 – Cache poisoning attack flow</p>
			<p>But don't worry, here are some defensive measures that you can take against this threat:</p>
			<ul>
				<li>Place your<a id="_idIndexMarker042"/> DNS resolvers inside your<a id="_idIndexMarker043"/> firewall.</li>
				<li>Remove unnecessary DNS resolvers to reduce risks.</li>
				<li>DNS servers must be hardened to ensure all unnecessary services are removed (thus reducing the points of failure and potential vulnerabilities).</li>
				<li>Use a random source port, randomize the query ID, and use random case (uppercase/lowercase) in domain names.</li>
				<li>Flush your DNS cache macOS (Catalina):<pre><strong class="bold">sudo killall -HUP mDNSResponder</strong></pre></li>
				<li>Flush your DNS cache Windows:<pre><strong class="bold">ipconfig /Flushdns</strong></pre></li>
				<li>Clear your browser cache.</li>
			</ul>
			<p>Additionally, in case you have a system exposed to <em class="italic">external users</em>, it is recommended to implement a <strong class="bold">"reboot and restore" system</strong>, so in case someone changes the DNS locally, those values will be deleted (and restored to their original values) once the computer is <a id="_idIndexMarker044"/>rebooted or the user is logged out.</p>
			<h3>Domain hijacking and redirection</h3>
			<p>This attack is<a id="_idIndexMarker045"/> aimed at web<a id="_idIndexMarker046"/> resources (web<a id="_idIndexMarker047"/> pages, web apps, and so on). Here, the attacker will modify the DNS on your domain registrant to send all the traffic aimed at your page to another server. Here, the attackers use misspelled names or letters that look similar to the original to fool the user into believing that they are accessing the real site. </p>
			<p>Here are the defensive measures that can be taken: </p>
			<ul>
				<li>Register your domains with a trusted company.</li>
				<li>Avoid registering domains with several vendors.</li>
				<li>Use crazy long random passwords for your DNS admin account (based on a password manager).</li>
			</ul>
			<p>Let's consider an example. </p>
			<p>Do you think these two domains are the same: <code>I2C2x.com</code> and <code>l2C2x.com</code>?</p>
			<p>They look the same, but they are not, and that is one of the tactics used on these types of attacks (and also in some phishing attacks) to trick the victim into thinking that they are on the original site when they are not.</p>
			<p>In this example, the first domain has an uppercase <code>i</code>, while in the second example, it uses a lowercase <code>L</code>, similar to the eye, but clearly not the same domain.</p>
			<h3>DNS tunneling </h3>
			<p>This is a very clever<a id="_idIndexMarker048"/> attack in which the attacker uses DNS<a id="_idIndexMarker049"/> queries and responses to exfiltrate data without detection. This exfiltration mechanism allows the attacker to bypass most network controls. However, this attack is very complex as it requires the attacker to have control over the machine where the data resides (normally by using a command and control malware), the internal DNS server, an external DNS server, and a domain.</p>
			<p>Normal DNS query:</p>
			<pre>C:\Users\Cesar&gt; Nslookup mysite.com
Server:  dns.google
Address:  8.8.8.8
Non-authoritative answer:
Name:    mysite.com
Address:  168.82.172.128</pre>
			<p>DNS tunneled query:</p>
			<pre>C:\Users\Cesar&gt; Nslookup company_exfiltrated_data123.com
Server:  dns.google
Address:  8.8.8.8
*** dns.google can't find company_exfiltrated_data123.com: Non-existent domain</pre>
			<p>Here are the<a id="_idIndexMarker050"/> defensive <a id="_idIndexMarker051"/>measures that can be taken:</p>
			<ul>
				<li>Set up monitors to track anomalies on DNS traffic (many of these attacks exponentially increase the number of DNS queries to exfiltrate large amounts of data).</li>
				<li>Analyze DNS queries to identify anomalies.<p class="callout-heading">DNS tunneling tools</p><p class="callout">There are several tools for exfiltrating the data, including <code>dns2tcp</code> and <code>heyoka</code>, and some other tools designed to sniff the content of the DNS queries, including <code>dnshunter</code> and <code>reassemble_dns</code>.</p></li>
			</ul>
			<p>Remember that this is a sample list that you can use as a baseline, but there are many other types of attacks that I won't mention here but will be covered later, for example, IoT attacks, web-based attacks, and more. However, keep in mind that a master should continue researching to stay up to date and always be <a id="_idIndexMarker052"/>on the lookout for new threats and <a id="_idIndexMarker053"/>vulnerabilities.</p>
			<h1 id="_idParaDest-20"><a id="_idTextAnchor019"/>Managing cybersecurity's legendary pain point: Passwords</h1>
			<p>Passwords are probably<a id="_idIndexMarker054"/> the biggest pain for us in our job. The interesting part is that for the last 14 years, many experts have been saying that passwords will disappear, but despite all the new authentication technologies, passwords are still around and probably will stay with us for a long time. Therefore, as security experts, we need to constantly look for innovative ways to protect against password-based attacks and that's why, in this chapter, we will review the most common types of attack and how to protect you and your infrastructure against them.</p>
			<h2 id="_idParaDest-21"><a id="_idTextAnchor020"/>Password breaches</h2>
			<p>Nowadays, it is <a id="_idIndexMarker055"/>becoming a very common sight to see a new data breach (exposing the emails, usernames, and passwords of millions of users to the internet) almost every month or week. Therefore, while you cannot control the level of security that other companies put on your personal data, there are some extra steps that you can take to prevent being impacted by those attacks.</p>
			<p class="callout-heading"><strong class="bold">Note:</strong></p>
			<p class="callout">If you haven't already done so, check whether your account has already been compromised. You can do this on the famous site <a href="https://haveibeenpwned.com">https://haveibeenpwned.com</a> and <a href="https://dehashed.com/">https://dehashed.com/</a>.</p>
			<p>One of the cool features that you can find on those pages is the ability to search by email, user, or even by a password. Also, those sites will tell you some very interesting information, such as the name of the hacks in which your data was exposed, username details (in case the site uses a custom username instead of an email), and the hash of the compromised passwords.</p>
			<h3>Defensive measures</h3>
			<p>I was struggling<a id="_idIndexMarker056"/> to decide whether I should add this step or not (because this may be obvious for a pro like you); however, if I don't add this, some people may call me out on this, so here it is: If your password is found on any of those sites, then change your passwords (all of them):</p>
			<ul>
				<li>Use or enable multi-factor or multi-step authentication when available.</li>
				<li>Migrate to stronger password-less solutions when available (such as Microsoft Authenticator). </li>
			</ul>
			<p>But wait, Cesar, aren't you going to recommend password vaults? Actually no, because a password vault will not help you in these kinds of attacks because it doesn't matter if your password is <em class="italic">CesarRocks</em> or <em class="italic">Iam_having-a.greattimereadingthisbookin2021</em> because both <a id="_idIndexMarker057"/>will be disclosed in the same way, as a hash that may look like this: 31b54027af2ed2299b2bd7fda556d782.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Do you want to decode a hash? You may use a page such as <a href="https://md5hashing.net/hash">https://md5hashing.net/hash</a>, which uses hash matching (dictionary tables) to decode a hash.</p>
			<h3>Multi-factor versus multi-step authentication</h3>
			<p>There <a id="_idIndexMarker058"/>are still people who use these two terms interchangeably, but as a master in security, you must know the difference.</p>
			<p>Multi-factor means that you are using at least two different factors during the authentication process. This includes the original three (something I know, something I have, something I am), plus two more that researchers are introducing: somewhere I am (this is enabled by geoposition and geofencing technologies) and my personal favorite, something you do (this is enabled by IoT devices). </p>
			<p>An example of this will be your bank asking you to move your writs to the right to authenticate. This movement will be captured by the accelerometers in your smartwatch and that data shared by using a secure API with the bank.</p>
			<h2 id="_idParaDest-22"><a id="_idTextAnchor021"/>Social engineering attacks using compromised passwords</h2>
			<p>This is an interesting<a id="_idIndexMarker059"/> attack<a id="_idIndexMarker060"/> because it requires no technical knowledge on the part of the attacker, which makes this a very common and dangerous threat.</p>
			<p>Here, the attacker gathers email/password combinations from published password breaches and uses them to trick people into believing that they have been hacked for a long time and that the hacker contains sensitive information about the person. There are several variants of these attacks that vary from telling the victim that the hacker accessed the webcam and have compromised videos/photos of the victim, or that the hacker got access to the browsing history and that it will publish the victim's "dirty" website <a id="_idIndexMarker061"/>history<a id="_idIndexMarker062"/> unless some payment is made.</p>
			<div><div><img src="img/Figure_1.7_B16290.jpg" alt="Figure 1.7 – Example of a scam email&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.7 – Example of a scam email</p>
			<p>As a security expert, you may have fun when receiving an email like this one, but remember, as a professional, your mission is to help others from falling victim to these kinds of attacks, from family and friends to coworkers, and especially high-end targets, such as executives of your company. The best way to deal with these kinds of attacks is through education. In fact, user education is one of the keys pillars for any cybersecurity strategy. This topic is so important that I decided to create an entire chapter for you!</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Use your social media as a tool to let others know that this is a hoax. Try to post something related to these kinds of attacks on your LinkedIn, Facebook, and Instagram accounts at least every 3 months. This simple act may save your friends a lot of trouble and money while helping you to grow your social eminence.</p>
			<p class="callout">As a <a id="_idIndexMarker063"/>cybersecurity expert, you have<a id="_idIndexMarker064"/> great powers, but also great responsibilities.</p>
			<h2 id="_idParaDest-23"><a id="_idTextAnchor022"/>Brute-force attacks</h2>
			<p>One of the most <a id="_idIndexMarker065"/>common attacks on passwords<a id="_idIndexMarker066"/> is brute-force attacks. By far the most famous app to achieve this is John the reaper, in which you can customize the attack to reduce the time required to expose a password.</p>
			<p>In these types of attacks, password complexity (and size) matters, so let me use some math to prove it.</p>
			<p>We have two variables: the spectrum of possibilities (S) and the password length (L). In the alphabet, we have 26 characters, so it means our spectrum of possibilities is 26, but that is considering just one case, because if we use lowercase and uppercase, then it increases to 26+26 = 52.</p>
			<p>This means that if we have an 8-character password (L) with just lowercase letters (S), the number of possibilities will be <em class="italic">SL</em>, or, in this case, <em class="italic">268</em>, which means around 200 billion combinations. </p>
			<p>Some of you may think that 200 billion is a huge number of possibilities to guess, but a modern computer can guess 100 billion combinations every second, which means that our 8-character password with just lowercase can be cracked in 2 seconds.</p>
			<p>But no worries, all we have to do is to increase the spectrum of possibilities (S) as follows:</p>
			<ul>
				<li>By adding numbers, the spectrum (S) increases by 10. This is equal to <em class="italic">368</em>, which can be guessed in 30 seconds.</li>
				<li>By adding special characters as well, the spectrum (S) increases by 32. This is equal to <em class="italic">688</em>, which can be guessed in 1.5 hours</li>
				<li>By adding uppercase, too, the spectrum (S) increases by 26. This is equal to <em class="italic">948</em>, which can be guessed in 20 hours.</li>
			</ul>
			<p>All this math proves that an 8-character password is no longer secure. Therefore, to be considered secure, a password should be at least 10 characters long and include all of the above. This math is very important, especially to support the requirements to determine the <a id="_idIndexMarker067"/>password policy of your<a id="_idIndexMarker068"/> organization (and gain the buy-in from users and executives). </p>
			<p class="callout-heading">Tip</p>
			<p class="callout">If you want to check the password strength without having to do all the math, I recommend the following site: <a href="https://www.grc.com/haystack.htm">https://www.grc.com/haystack.htm</a></p>
			<h2 id="_idParaDest-24"><a id="_idTextAnchor023"/>Dictionary attacks</h2>
			<p>This is similar to <a id="_idIndexMarker069"/>a brute-force attack, but instead of<a id="_idIndexMarker070"/> guessing the password, it uses a <strong class="bold">dictionary</strong> with the most common passwords.</p>
			<p>You can find dictionaries with millions of passwords. In fact, some of them are so big that they can make Notepad crash. So, to make it easier for the attacker, most dictionaries are sorted by topic, region, language, or by source (normally from a password breach).</p>
			<p>As mentioned, this attack is different from the attacker's point of view, but the same tips provided earlier work for this type of attack.</p>
			<p>If you want to see what dictionaries look like, here you can see many dictionaries sorted by several factors: <a href="http://www.md5this.com/tools/wordlists.html">http://www.md5this.com/tools/wordlists.html</a>.</p>
			<p class="callout-heading">Test yourself</p>
			<p class="callout">Take a look at these two passwords and think which one is more secure, and then go to the link above and see the results:</p>
			<p class="callout"><code>Lol********</code></p>
			<p class="callout"><code>C4b-6W@8#5</code></p>
			<h2 id="_idParaDest-25"><a id="_idTextAnchor024"/>Creating a secure password</h2>
			<p>If there has<a id="_idIndexMarker071"/> ever been a never-ending debate, it is probably the one about password strength. My grandpa used to say: Avoid talking about religion, politics, and soccer because it will always end in a fight and you will lose many friends. Well, I think that "password strength" conversations should also be included on that list. </p>
			<p>I remember being on a board of experts from all around the world discussing very challenging topics and, despite our differences, we were able to agree on all topics but one: <em class="italic">passwords!</em></p>
			<p>Some experts believe in pure length (such as using long phrases), others in complexity (they want something unreadable), others want both, but the most controversial topic is around <em class="italic">password expiration</em>. There are mainly two parties – the dictatorial and the user friendly.</p>
			<p>The dictatorial don't care about the user experience, they just want to create the rules and leave it up to the user to figure out how to comply (even if this means writing the password on a sticky note below the keyboard).</p>
			<p>On the other hand, the user-friendly group uses a more <em class="italic">empathic</em> approach by analyzing how realistic it would be for users to comply with a given rule without adopting bad practices.</p>
			<p>In that context, instead of taking one side or the other, you must make your decisions based on facts (data never lies). Therefore, to create a bulletproof password expiration policy, I recommend that you find a response to the following questions:</p>
			<ul>
				<li>How technical is my audience?</li>
				<li>How educated are they in terms of passwords?</li>
				<li>Can you apply segmentation based on user roles? (Privileged users will change their password every 90 days, while regular users will do this every 180 days).</li>
				<li>Do I have the infrastructure to enforce this policy?</li>
				<li>Can you apply segmentation based on the data/systems accessed/used?</li>
				<li>Do they have the tools and training to create/store/manage complex passwords?</li>
			</ul>
			<p>Additionally, there are <em class="italic">Three Golden Rules</em> to help you improve password security within your organization:</p>
			<ol>
				<li><strong class="bold">Implement password vaults</strong>: By default, people don't trust putting all your credentials on an app. In this case, you need to educate users and show them all the benefits of using a password vault (starting with the fact that this is better than having the password on a post-it under your keyboard).<p>But don't go the hard way by making a policy and forcing everyone to implement it. Instead, lead by example, show the people how much you love using your password vault, how easy it is to use it, and how convenient it is to log on to all your apps with a single click. Brag about how you have a unique <em class="italic">bullet proof</em> 80-character password for each of your accounts, <em class="italic">yes, a different password for each account</em>. Let them know that this is not just for corporate usage, but for<a id="_idIndexMarker072"/> their personal life, show them how confident you are that your boyfriend will never be able to guess your password because you will never have to tape it (never be afraid of shouldering again), just a single click and bam!, you are connected to your account. The only thing you need is a password vault app (there are many free and even open source options) and a master password to unlock it (since you only need to remember one, make sure this one is secure). <em class="italic">Remember that passphrases are always a good option</em>. </p><p>Once people see how easy this is, they will love it and begin asking for it (so instead of you chasing them to implement it, they will chase you to have it). If you want to reduce costs, you can try KeePass, it has everything you need and is free and open source. Another option is to use LastPass; they have a great version for free, but also offer some extra options that may be useful to your organization for a very low cost.</p><p class="callout-heading">Tip</p><p class="callout">To create a passphrase, try using a sentence that you won't forget, such as <em class="italic">I remember the day when I met my girlfriend at Walmart</em>, or <em class="italic">I would never eat a burger again at Happy Burger</em>.</p></li>
				<li><strong class="bold">Once everyone loves it, create a policy and a system to enforce it</strong>: Make sure that a policy is created, approved, and published before applying any enforcement mechanism. Otherwise, you may end up with a lot of complaints and unnecessary support tickets due to <em class="italic">password issues</em>.</li>
				<li><strong class="bold">Don't be a ruler, be a leader</strong>: Instead of defining a crazy password policy that no one understands and everyone hates, create some training or webinars relating to passwords, as well as the dangers and consequences of a data leak caused by a <a id="_idIndexMarker073"/>weak password. If time allows, perform some real demonstrations, set a Kali machine with John the reaper, and show how you can crack any 8-character passwords in no time. Remember: A document is better than nothing, audio is better than a document, a video is better than audio, but nothing beats a real-time demonstration. In the beginning, you may think that it is very time-consuming, but based on experience, all the time and effort you invest in face-to-face training and demonstrations is time well invested.</li>
			</ol>
			<p>Once people understand the consequences of using a weak password and the advantages associated with your password policies, they won't see them as a pain, but as a tool that can save their job.</p>
			<h2 id="_idParaDest-26"><a id="_idTextAnchor025"/>Managing passwords at the enterprise level</h2>
			<p>While the previous<a id="_idIndexMarker074"/> pages were intended to help you improve your password management skills, there are still some additional security considerations that you must follow when managing passwords at the enterprise level. Now, let's explore the main threats that you may encounter when managing this kind of environment.</p>
			<h3>Hash attacks</h3>
			<p>As mentioned<a id="_idIndexMarker075"/> previously, passwords <a id="_idIndexMarker076"/>are not stored in plain text (well, at least they shouldn't be), so normally they are stored as <strong class="bold">hashes</strong>. Hashes are normally called one-way hash functions, meaning that they were created to be <em class="italic">mathematically impossible</em> to create a reverse function to obtain the plain text based on the hashed value.</p>
			<p>This sounds very cool, clever, and secure, <em class="italic">but it is NOT! </em>(I think hackers are way cleverer).</p>
			<p>To crack them, hackers use <a id="_idIndexMarker077"/>something called <strong class="bold">Rainbow tables</strong>. The concept is very simple. Basically, it is a database of hash/plain text combinations that can be used to determine the corresponding text of a given hash and this is possible because the hash value of a word or phrase will always be the same.</p>
			<p>Rainbow tables are huge (they may contain billions of combinations), making this kind of attack very dangerous.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">If you want to play around with rainbow tables, you can visit this site where you can download a big collection of them: <a href="https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm">https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm</a>.</p>
			<p>However, do not worry! There is a way to defend against Rainbow table attacks; you just need to do what you do when you get a salad….<em class="italic">Add Salt and Pepper!</em></p>
			<h3>Defensive solution – Using salt and pepper</h3>
			<p>Despite the<a id="_idIndexMarker078"/> funny<a id="_idIndexMarker079"/> name of this technique, this is actually a very powerful mechanism for protecting against Rainbow table attacks and it is actually simpler than what you may expect.</p>
			<h4>The salt</h4>
			<p>This entails <a id="_idIndexMarker080"/>adding randomly generated text to your password before being hashed. This salt is then saved on the same password database to be used for further authentication:</p>
			<pre>$Salt = random_bytes [$Salt]
$Hash = SHA [$password + $Salt]</pre>
			<p><em class="italic">Why should the salt be random?</em> If the salt is the same, then the attacker will be able to identify users using the same password as seen here:</p>
			<pre>$Salt = random_bytes [$Salt]
$Bob_Psswd = [$password + $Salt] | Hash= 68586044d92547df605b
$Jake_Psswd = [$password + $Salt] | Hash= 68586044d92547df605b</pre>
			<p>But if they use a different (randomly created) salt, the hash will be completely different and therefore an<a id="_idIndexMarker081"/> attacker won't be able to determine whether they are the same: </p>
			<pre>$BobSalt = random_bytes [$Salt]
$JakeSalt = random_bytes [$Salt]
$Bob_Psswd = [$password + $BobSalt]   | Hash = 10db4775dc38f4
$Jake_Psswd = [$password + $JakeSalt] | Hash = dc74116ef9525h</pre>
			<p>So, as seen in the preceding example, even if Bob and Jake use the same password, the attacker won't be able to determine that because the salt used is different.</p>
			<h4>The pepper</h4>
			<p>As mentioned, the<a id="_idIndexMarker082"/> hash and the salt are stored in the same database, so if an attacker can access the database, the hash can be compromised even if salted.</p>
			<p>To reduce that risk, we can add another string of characters (just like the salt), but this time this value is saved in another location, converting this new string as a <em class="italic">secret</em> to the attacker because even if the main database is compromised, the <em class="italic">pepper</em> will remain secret: </p>
			<pre>$Pepper = I.am.the.Pepper
$BobSalt = random_bytes [$Salt]
$JakeSalt = random_bytes [$Salt]
$Bob_Psswd = [$password+$BobSalt+$Pepper]   | Hash = h1k477g56
$Jake_Psswd = [$password+$JakeSalt+$Pepper] | Hash = o28l4115h</pre>
			<p>In the preceding example, we can see how the password is composed on the basis of three variables (the password, the salt, and the pepper), which increases the complexity exponentially to crack it. </p>
			<p>In terms of the implementation, it is up to you if you want the salt to be added in front of the password or at the end of the password. The important thing is that it is added before the hash is created. As my math teacher used to say: <em class="italic">the order of the factors does not alter the product</em>.</p>
			<p>Also, it could be <a id="_idIndexMarker083"/>difficult to implement a dynamic salt on legacy systems. In those cases, I strongly recommend the use of salt and pepper to increase the security of the system.</p>
			<p><em class="italic">Salt efficiency is about randomness, pepper is about secrecy.</em></p>
			<p>You can use the same pepper for all passwords on the same system, but my suggestion to you is to use a <strong class="bold">different pepper for each system</strong> (if one is compromised, it will not compromise all your systems).</p>
			<h2 id="_idParaDest-27"><a id="_idTextAnchor026"/>Bonus track</h2>
			<p>Let me share<a id="_idIndexMarker084"/> with you the latest research associated with trying to resolve the password problems (hardware and software):</p>
			<h3>Enhanced password authentication </h3>
			<p>This is a super <a id="_idIndexMarker085"/>interesting system that I developed with <em class="italic">Rhonda Childress,</em> Deputy CISO at Kyndryl, about a system that leverages a USB vulnerability and transforms it into a clever solution to the password problem. Here is the link to the full patent pending disclosure: <a href="https://patents.google.com/patent/US20200092282A1/en">https://patents.google.com/patent/US20200092282A1/en</a>.</p>
			<h3>Wireless injection of passwords</h3>
			<p>This idea was part <a id="_idIndexMarker086"/>of some research conducted with my friend and security expert <em class="italic">John Feezell</em>, in which we wanted to take password vaults to another level by enabling a true plug-and-play solution to wireless inject passwords from a password vault. The beauty of this system is that it does not require the installation of any special driver and firmware and yet can still work on any OS. You can check the details at the following link: <a href="https://patents.google.com/patent/US20190163893A1/en">https://patents.google.com/patent/US20190163893A1/en</a>.</p>
			<h3>Keyboard injection of passwords</h3>
			<p>This is an<a id="_idIndexMarker087"/> improved version of the previous idea in which we added another layer of security and leverage the currently connected keyboard as the input mechanism to inject the password as normal keystrokes: <a href="https://patents.google.com/patent/US20200074069A1/en">https://patents.google.com/patent/US20200074069A1/en</a>.</p>
			<p>We covered a lot of good information about the main risks related to passwords and how to address them from the point of view of the users and the infrastructure. Now is the time to jump to the next level and see how we can create the best defensive security strategy based on interconnected layers of systems, methods, and techniques.</p>
			<h1 id="_idParaDest-28"><a id="_idTextAnchor027"/>Mastering defense in depth </h1>
			<p>Back in the old <a id="_idIndexMarker088"/>days, people relied on perimeter defense, which is erecting a virtual fence to prevent non-authorized people from getting into your systems.</p>
			<div><div><img src="img/Figure_1.8_B16290.jpg" alt="Figure 1.8 – Single-layer perimeter defense&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.8 – Single-layer perimeter defense</p>
			<p>However, the threat landscape has evolved, and we must do the same!</p>
			<p>While perimeter defense is mostly based on a single layer of protection (normally a network layer), <strong class="bold">Defense in Depth</strong> (<strong class="bold">DiD</strong>) takes this further by applying a plurality of security layers in which each layer offers a new line of defense against an attack.</p>
			<p>Normally, those layers are independent and each of them provides a different security mechanism that increases the overall security. The benefit of this independence is that a vulnerability that affects one layer may be irrelevant to the other layer. This is a great advantage over a <a id="_idIndexMarker089"/>pyramidal model where, if the foundation is affected, the rest will fall.</p>
			<p>However, this independence also has its downside in terms of the complexity of the operations. In this case, managing all the different layers (configuration, test, updates, maintenance) is not an easy task, but who says that our job will be easy!</p>
			<h2 id="_idParaDest-29"><a id="_idTextAnchor028"/>Factors to consider when creating DiD models</h2>
			<p>Most DiD models<a id="_idIndexMarker090"/> create the layers based on technology; however, if you want to apply DiD as a master, you must also consider the following two very important factors: <strong class="bold">People</strong> and <strong class="bold">Processes</strong>.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">The DiD model can be applied at a macro level (to the entire organization) or at a micro level (to a single system or technology). This means that once you master this method, you can use it to create your overall security strategy, as well as use it to create the security strategy to secure your web apps.</p>
			<p>Now, let's analyze<a id="_idIndexMarker091"/> these two factors in detail.</p>
			<h3>The people</h3>
			<p>People are often<a id="_idIndexMarker092"/> pointed to as the biggest threat in cybersecurity…and they are! And we are not talking about the criminals; we are talking about your company employees who are responsible for many of the security breaches, either as a result of an inadvertent error or by being used by an attacker to gain access to some systems or data.</p>
			<p>Therefore, we must consider the human factor when developing our defense strategy. Ignore this and your strategy will be doomed. </p>
			<p>The very first step here for you is to segment the company employees by access type. Users should be created on a need-to-know/need-to-do basis. This segmentation of employees should be performed as part of your identity and management process and while, in the beginning, it may be a time-consuming process, in the end, I assure you that the investment is well worth it.</p>
			<h4>Admin rights</h4>
			<p>Some companies <a id="_idIndexMarker093"/>started to adopt a policy to provide admin rights to all employees over their work computers. The justification is related to the huge cost associated with having a support team in charge of helping the user every time they need to install software, hardware, update, or plugin.</p>
			<p>But what about the cost of reinstalling a machine following a malware infection? What about the cost associated with the installation of corrupted drivers? What about the cost of a data leak due to the installation of a trojan? What about the legal cost of the installation of unlicensed or restricted software? Those are some of the questions that you may ask senior management in case they want to provide admin rights to everyone. Remember, it is your responsibility to help your organization to understand that security will always be above usability and user experience.</p>
			<p>Are you saying this should not be done? No, I am just saying that this needs to be carefully analyzed from the cybersecurity perspective to ensure that if applied, all appropriate<a id="_idIndexMarker094"/> controls are in place to reduce the risks mentioned earlier.</p>
			<h3>The processes</h3>
			<p>You must have <a id="_idIndexMarker095"/>an in-depth understanding of the organization that you are tasked with defending. You can achieve this by understanding all the company's processes (or at least the core of them). Once you know them, it will be easier for you to identify vulnerabilities and risks where others don't!</p>
			<p>I understand that as a technical person, you may hate processes and the associated (and mostly) outdated documentation that it brings, but trust me, if you know them, you will bring an exceptional value that very few are capable of providing to their organization.</p>
			<p>Another reason for you familiarizing yourself with this is because you will have to eventually create your own processes. One good tip is to create your processes in alignment with the organizational processes; this will enable you to reduce risks while closing any potential gaps.</p>
			<p>Additionally, I suggest you evaluate/analyze those three factors (<strong class="bold">Technology</strong>, <strong class="bold">People</strong>, and <strong class="bold">Processes</strong>) from two perspectives: <strong class="bold">Internal</strong> and <strong class="bold">External</strong>.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">I suggest you do an inventory of your technology, processes, and types of employees, and then evaluate the risks (internal/external) associated with each of them, as shown in the following diagram.</p>
			<div><div><img src="img/Figure_1.9_B16290.jpg" alt="Figure 1.9 – Risk evaluation matrix based on three factors&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.9 – Risk evaluation matrix based on three factors</p>
			<p>Now that we have reviewed the factors that need to be considered and how to manage them, it is time to move forward to understand how to determine which assets will be defended by our <a id="_idIndexMarker096"/>DiD model and how to prioritize them.</p>
			<h2 id="_idParaDest-30"><a id="_idTextAnchor029"/>Asset identification</h2>
			<p>In an ideal <a id="_idIndexMarker097"/>world, you would apply the strongest defense across the entire organization, but as you may know, that is not realistic because the stronger the security, the more expensive the cost.</p>
			<p>Therefore, before moving forward, you must analyze your systems and data and sort them to prioritize the defense strategy for each type.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Once you have identified the different systems and data, create a <em class="italic">Kanban-like</em> board in which the columns are the levels of security (with an associated cost), and then schedule a meeting with relevant upper management (CEO, CFO) and ask them to place the different systems and data in the desired security level (columns). This is a great tool for you when it comes to supporting your budget request, but also when delegating the responsibility of the security level selected for each system/infrastructure or dataset.</p>
			<p>The following diagram is an example of a Kanban-like board that can be used to determine <strong class="bold">Asset priorities</strong> (based on impact) and also to support budget requests made to upper management:</p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_1.10_B16290.jpg" alt="Figure 1.10 – Sample Kanban-like board for asset classification&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.10 – Sample Kanban-like board for asset classification</p>
			<p>Now it is time to <a id="_idIndexMarker098"/>create the layers of your DiD model.</p>
			<h2 id="_idParaDest-31"><a id="_idTextAnchor030"/>Defense by layers</h2>
			<p>Here, you will <a id="_idIndexMarker099"/>use the inputs from the asset prioritization that we just created to develop the best-layered model based on your resources.</p>
			<p>There is an open debate ongoing about whether it is better to have one super strong control or multiple good controls.</p>
			<p>Let's look at some pros and cons of a sample scenario so that you can draw your own conclusions.</p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_1.11_B16290.jpg" alt="Figure 1.11 – Single strong control versus the multi-control approach&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.11 – Single strong control versus the multi-control approach</p>
			<p>There are two ways<a id="_idIndexMarker100"/> to create your layers, by means of the functionality of the control or by technology, as explained next.</p>
			<h3>Creating layers by type or functionality of the control</h3>
			<p>Here, you<a id="_idIndexMarker101"/> create the layers based on the <strong class="bold">functionality</strong> or <strong class="bold">type</strong> of controls.</p>
			<p>The idea is that you correlate what you are trying to secure against the controls applicable to it. For example, there will be cases in which corrective controls may not be relevant, while in other cases, it should be the priority. <em class="italic">Remember that in security, everything needs to be tailor-made based on the business.</em></p>
			<div><div><img src="img/Figure_1.12_B16290.jpg" alt="Figure 1.12 – Layered security by the control function&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.12 – Layered security by the control function</p>
			<p><em class="italic">Figure 1.12</em> shows a full layered model that includes the most popular controls layered by their function. For example, an electrified fence to <em class="italic">prevent</em> someone from entering the building, a Camera system to <em class="italic">detect</em> intruders, a security guard to <em class="italic">deter</em> potential intruders, biometric <a id="_idIndexMarker102"/>authentication or geolocation as an alternative method to <em class="italic">compensate</em> a more expensive mechanism, a backup to perform the <em class="italic">recovery</em> following a disaster, and a "<strong class="bold">Reboot to restore" software</strong> (like a deep freeze) to <em class="italic">correct</em> any issue or misconfiguration on a given system.</p>
			<h3>Creating layers by technology</h3>
			<p>Here you create <a id="_idIndexMarker103"/>layers of controls based on the technology used, despite the fact that they provide the same functionality. For example, you may implement several methods or technologies on a critical system to detect intruders (IDS, audits, logs, and so on). </p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_1.13_B16290.jpg" alt="Figure 1.13 – Layered security by technology&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.13 – Layered security by technology</p>
			<p>In the preceding diagram, you can see an example of how you can create layers based on the technology. For example, a camera and a sensor may both be a detective control, but both use different technologies to achieve it. This model is very useful when you want to increase<a id="_idIndexMarker104"/> the focus on a given functionality, for example, implementing a plurality of technologies to provide a special focus on detection or prevention.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">To make things more interesting, remember that layers can also be further defined on three categories of controls: administrative, physical, and technical. I know that you are already familiar with those categories (so there is no need to waste ink in explaining them), but I just want you to keep in mind that you can add components from the three categories on the same layer.</p>
			<h3>Which approach is better?</h3>
			<p>This will <a id="_idIndexMarker105"/>depend on your infrastructure, and that is why performing an in-depth analysis of the environment is key.</p>
			<p>Remember that the logic behind this is <strong class="bold">to make things harder for an attacker</strong> and you can achieve <a id="_idIndexMarker106"/>that with both methods.</p>
			<h3>Benefits of a security by layer model</h3>
			<p>There are a lot<a id="_idIndexMarker107"/> of benefits associated with the implementation of a <em class="italic">Security by layer</em> approach and <em class="italic">Figure 1.14</em> highlights some of them for you to consider whether they can be beneficial for your defensive security strategy:</p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_1.14_B16290.jpg" alt="Figure 1.14 – Benefits of implementing a security by layer model&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 1.14 – Benefits of implementing a security by layer model</p>
			<p>Additionally, upper management will also benefit from implementing this type of security model as this enables the company to perform a better allocation of cybersecurity resources.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Layered models were designed to work in isolation, which means that there is no communication between the layers. However, the latest research studies confirm that interconnecting the layers will improve the system as one layer may learn from the other one to better protect against an upcoming threat. </p>
			<p>Keep in mind (like everything else in security) that a layered model that works today may be obsolete in 2 years, so you need to constantly evaluate your layers to determine if they still offer<a id="_idIndexMarker108"/> the required level of security.</p>
			<h2 id="_idParaDest-32"><a id="_idTextAnchor031"/>Bonus track</h2>
			<p>I know you want to see the latest and greatest technologies, so here are a couple of systems recently developed that can be implemented on layered security models.</p>
			<h3>Mobile device feature disablement </h3>
			<p>This is a <a id="_idIndexMarker109"/>very interesting project (patented in the US) that I worked on recently with my friend and master inventor, <em class="italic">Eric Rueger</em>. The idea is a system that prevents the execution of a plurality of systems on a mobile device based on a plurality of factors such as time and location. Therefore, this is a state-of-the-art system that can be applied to the preventive or detective layer of the model. Here is the link: <a href="https://patents.google.com/patent/US10594855B2/en">https://patents.google.com/patent/US10594855B2/en</a>.</p>
			<h3>Cognitive security adjustments based on the user</h3>
			<p>If you want to <a id="_idIndexMarker110"/>see one real example of how you can add AI to a preventive layer (and take your layered model to the next level), take a look at this patent pending in which the system monitors the user's emotional state and level of attention to determine whether the user's computer should be automatically locked to prevent unauthorized access or the inadvertent disclosure of sensitive information. In terms of the development of this system, I had the privilege to work with one of the most prolific inventors in human history, <em class="italic">Greg Boss</em>: <a href="https://patents.google.com/patent/US20190180013A1">https://patents.google.com/patent/US20190180013A1</a>.</p>
			<h1 id="_idParaDest-33"><a id="_idTextAnchor032"/>Comparing the blue and red teams</h1>
			<p>The blue<a id="_idIndexMarker111"/> team <a id="_idIndexMarker112"/>is the defense team, the one in charge of the policies, processes, methods, and technologies aimed at preventing a cybersecurity incident (which is probably you).</p>
			<p>On the other hand, the red team is a team of professionals trained to find vulnerabilities. They will use their skills to find a way to gain access to a given system or data.</p>
			<p>They will basically follow the same steps that an attacker would, but instead of exposing your data or selling it to the highest bidder, they will create a beautiful report that you can use to detect your vulnerabilities and create strategies to correct them.</p>
			<p>Some big companies may have their own red team, but this is very expensive, and resources may be underutilized, so most of the companies just hire them on a regular basis to test their infrastructure and gather valuable data to improve.</p>
			<p>Like many other topics in cybersecurity, there is an open debate about red teams and pentesting, so to make things easier for the reader, pentesting will be defined as one of the tasks carried out by a red team.</p>
			<p>As a<a id="_idIndexMarker113"/> defensive <a id="_idIndexMarker114"/>security professional, there are many factors that you must know about in relation to pentesting, such as the types of testing, pentesting services, and their benefits.</p>
			<h3>Types of pentesting</h3>
			<p>A pentest is <a id="_idIndexMarker115"/>classified based on the level of knowledge and access that you grant them prior to the test. The categories are as follows:</p>
			<h4>Black box</h4>
			<p>In this type of <a id="_idIndexMarker116"/>testing, the red team is not provided with any information about the target. This is commonly used when testing an entire infrastructure to find global vulnerabilities. Here, the red team will have to start by performing an initial discovery phase and move across layers to find any vulnerable spots.</p>
			<p>This kind of testing is more <em class="italic">generic</em> and normally involves no collaboration between the teams. In fact, this is regularly performed as some type of <em class="italic">audit</em> in which just senior management knows about the execution of the test. This is normally done to perform a real test and without the security team being on alert.</p>
			<p>This is normally the most complex, resource-intense, and extensive test of the three.</p>
			<h4>Gray box</h4>
			<p>Here you <a id="_idIndexMarker117"/>provide the red team with some details about the target while obscuring others. For example, you may ask to test a given application and provide the architecture of said application, but more detailed information, such <a id="_idIndexMarker118"/>as the source code and users, will be obscured.</p>
			<h4>White box</h4>
			<p>In this type of <a id="_idIndexMarker119"/>testing, you provide the red team with a lot of data about the tested system/infrastructure, including blueprints, users, code, and any other document related to the system/infrastructure being tested.</p>
			<p>While this may seem as making life easier for the red team, this type is more about a collaborative environment between the blue and red teams to perform more targeted testing.</p>
			<h3>Pentesting services</h3>
			<p>You can<a id="_idIndexMarker120"/> pretty much test anything; however, here is a list of the most common types of pentesting offered:</p>
			<ul>
				<li>Network services</li>
				<li>Databases</li>
				<li>Web applications</li>
				<li>Web services</li>
				<li>APIs</li>
				<li>Wireless networks</li>
				<li>BYOD</li>
				<li>VPN</li>
				<li>Social engineering</li>
				<li>Physical intrusions</li>
				<li>Code/applications</li>
			</ul>
			<h3>Benefits of pentesting</h3>
			<p>Many <a id="_idIndexMarker121"/>organizations are still reluctant to perform some type of pentesting on their environments, so let me share with you some benefits to motivate a company to use this great asset:</p>
			<ul>
				<li>External feedback about your infrastructure, including weak points, vulnerabilities, and improvement areas</li>
				<li>An opportunity to close security gaps before they are exploited by criminals</li>
				<li>Objective evaluation</li>
				<li>Support of your continuous improvement initiatives</li>
				<li>External validation of your hard work!!!<p class="callout-heading">Tips</p><p class="callout">Hiring a dedicated red team may be expensive; however, if you have someone in your team with offensive skills, you can leverage that experience to perform mini testing (like a mini purple team).</p><p class="callout">Having a purple team does not replace the need for a red team as the inputs from an external "unbiased" tester provide additional insights and value.</p><p class="callout">Be careful when hiring a red team as they will handle very sensitive information about the company. Here, the rule is that you should always work with a partner that you can trust.</p><p class="callout">Involve your legal team and make sure that a confidentiality and data privacy contract is signed with the red team.</p></li>
			</ul>
			<h1 id="_idParaDest-34"><a id="_idTextAnchor033"/>Summary</h1>
			<p>In this chapter, we reviewed a set of very interesting types of attacks, including teardrop attacks, SYN flood attacks, and many types of DNS attack, as well as how to defend your infrastructure against them.</p>
			<p>We also learned how to better deal with password-based attacks, not just from the user's point of view, but also from an enterprise point of view. Additionally, we learned how to create a DiD model and how to take advantage of layers to secure your data.</p>
			<p>Finally, we concluded the chapter by understanding how you can leverage the benefits of having (or hiring) a blue or red team in your organization.</p>
			<p>Now, let's move on to the next chapter, where we are going to understand how to manage risks on an enterprise level by leveraging the NIST cybersecurity framework. Also, we will see how to create a world-class BCP and DRP to enhance the availability and survivability of your organization.</p>
			<h1 id="_idParaDest-35"><a id="_idTextAnchor034"/>Further reading</h1>
			<p>This book was designed to be focused on <em class="italic">Defensive Security</em>; however, if you want to read more about <em class="italic">Offensive Security</em>, take a look at this book about the strategies employed by offensive security teams (red teams): <a href="https://www.packtpub.com/product/cybersecurity-attacks-red-team-strategies/9781838828868">https://www.packtpub.com/product/cybersecurity-attacks-red-team-strategies/9781838828868</a>. </p>
		</div>
	</body></html>