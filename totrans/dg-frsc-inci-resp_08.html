<html><head></head><body>
<div id="_idContainer144">
<h1 class="chapter-number" id="_idParaDest-134"><a id="_idTextAnchor136"/><span class="koboSpan" id="kobo.1.1">8</span></h1>
<h1 id="_idParaDest-135"><a id="_idTextAnchor137"/><span class="koboSpan" id="kobo.2.1">Forensic Imaging</span></h1>
<p><span class="koboSpan" id="kobo.3.1">One critical task that incident response analysts often must perform is imaging digital evidence. </span><span class="koboSpan" id="kobo.3.2">As we discussed in prior chapters, a great deal of evidence related to an incident can be found within log files, memory, and other areas and can be acquired relatively quickly. </span><span class="koboSpan" id="kobo.3.3">In some incidents, such as internal malicious activity (for example, fraud, industrial espionage, or data leakage), a more detailed search for evidence may be required. </span><span class="koboSpan" id="kobo.3.4">This evidence includes master file table entries, files, and specific user data that is contained on the hard drive of a suspect system. </span><span class="koboSpan" id="kobo.3.5">If incident response analysts encounter such circumstances, they will be required to obtain an image of a suspect drive. </span><span class="koboSpan" id="kobo.3.6">As with any aspect of digital forensics, obtaining a usable and court-defensible image depends on the appropriate tools, techniques, and documentation </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">being used.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">This chapter will explore the fundamental concepts of digital imaging and the preparation and tools that are needed to acquire a forensically sound image of a physical drive or another logical volume. </span><span class="koboSpan" id="kobo.5.2">More specifically, we will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.7.1">Understanding </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">forensic imaging</span></span></li>
<li><span class="koboSpan" id="kobo.9.1">Tools </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">for imaging</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">Preparing a </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">staging drive</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Using </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">write blockers</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.15.1">Imaging techniques</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.16.1">While this chapter presents some very technical and process-driven material, it is important that responders understand imaging. </span><span class="koboSpan" id="kobo.16.2">This process is critical to producing images that can be relied on for </span><strong class="bold"><span class="koboSpan" id="kobo.17.1">root cause analysis</span></strong><span class="koboSpan" id="kobo.18.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.19.1">RCA</span></strong><span class="koboSpan" id="kobo.20.1">) and potential </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">courtroom use.</span></span></p>
<h1 id="_idParaDest-136"><a id="_idTextAnchor138"/><span class="koboSpan" id="kobo.22.1">Understanding forensic imaging</span></h1>
<p><span class="koboSpan" id="kobo.23.1">Imaging a storage </span><a id="_idIndexMarker639"/><span class="koboSpan" id="kobo.24.1">drive is a process where details matter. </span><span class="koboSpan" id="kobo.24.2">This section provides a solid foundation on forensic imaging, how it is accomplished, the various types of digital imaging processes, and the various proprietary </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">file formats.</span></span></p>
<p><span class="koboSpan" id="kobo.26.1">Having a solid understanding of the facets of forensic imaging is important for incident response analysts. </span><span class="koboSpan" id="kobo.26.2">Understanding the tools, techniques, and procedures involved ensures that evidence is handled properly and that analysts have confidence in the evidence they’ve acquired. </span><span class="koboSpan" id="kobo.26.3">In addition, understanding the necessary terminology allows analysts to accurately prepare reports and testify as to their findings if the </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">need arises.</span></span></p>
<h2 id="_idParaDest-137"><a id="_idTextAnchor139"/><span class="koboSpan" id="kobo.28.1">Image versus copy</span></h2>
<p><span class="koboSpan" id="kobo.29.1">One of the first</span><a id="_idIndexMarker640"/><span class="koboSpan" id="kobo.30.1"> concepts that should be understood is the difference between forensic imaging and copying. </span><span class="koboSpan" id="kobo.30.2">Copying files from a suspect hard drive or another medium only provides analysts with the actual data associated with that file. </span><span class="koboSpan" id="kobo.30.3">Imaging, on the other hand, allows the analyst to capture the entire drive. </span><span class="koboSpan" id="kobo.30.4">This includes areas such as slack space, unallocated space, and possibly accessing deleted files. </span><span class="koboSpan" id="kobo.30.5">Imaging also maintains metadata on the volume, including file timestamps. </span><span class="koboSpan" id="kobo.30.6">This becomes critical if a timeline analysis is conducted to determine when specific files were accessed </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">or deleted.</span></span></p>
<p><span class="koboSpan" id="kobo.32.1">Often, the terms </span><em class="italic"><span class="koboSpan" id="kobo.33.1">cloning</span></em><span class="koboSpan" id="kobo.34.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.35.1">imaging</span></em><span class="koboSpan" id="kobo.36.1"> are utilized in place of each other. </span><span class="koboSpan" id="kobo.36.2">This is a common improper use of terminology in the IT realm. </span><span class="koboSpan" id="kobo.36.3">When cloning a drive, a one-to-one copy of the drive is made. </span><span class="koboSpan" id="kobo.36.4">This means that the drive can then be inserted into a system and booted. </span><span class="koboSpan" id="kobo.36.5">Cloning a drive is often done to make a fully functional backup of a critical drive. </span><span class="koboSpan" id="kobo.36.6">While a cloned drive contains all the necessary files, it is cumbersome to work with, especially with forensic tools. </span><span class="koboSpan" id="kobo.36.7">As a result, an image file is taken. </span><span class="koboSpan" id="kobo.36.8">An image of a drive contains all the necessary files; its configuration permits a detailed examination while utilizing </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">forensic tools.</span></span></p>
<h2 id="_idParaDest-138"><a id="_idTextAnchor140"/><span class="koboSpan" id="kobo.38.1">Logical versus physical volumes</span></h2>
<p><span class="koboSpan" id="kobo.39.1">The second</span><a id="_idIndexMarker641"/><span class="koboSpan" id="kobo.40.1"> concept that needs to be </span><a id="_idIndexMarker642"/><span class="koboSpan" id="kobo.41.1">understood </span><a id="_idIndexMarker643"/><span class="koboSpan" id="kobo.42.1">is the types of volumes that can be imaged. </span><span class="koboSpan" id="kobo.42.2">Volumes can be separated into physical or logical volumes. </span><span class="koboSpan" id="kobo.42.3">Physical volumes can be thought of as containing the entirety of a hard drive. </span><span class="koboSpan" id="kobo.42.4">This includes any partitions, as well as the </span><strong class="bold"><span class="koboSpan" id="kobo.43.1">master boot record</span></strong><span class="koboSpan" id="kobo.44.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.45.1">MBR</span></strong><span class="koboSpan" id="kobo.46.1">). </span><span class="koboSpan" id="kobo.46.2">When</span><a id="_idIndexMarker644"/><span class="koboSpan" id="kobo.47.1"> imaging a physical volume, the analyst captures all of this data. </span><span class="koboSpan" id="kobo.47.2">In contrast, a logical volume is a part of the overall hard drive. </span><span class="koboSpan" id="kobo.47.3">For example, in a hard drive that is divided into the MBR and two partitions, a logical volume would be the </span><strong class="source-inline"><span class="koboSpan" id="kobo.48.1">D:</span></strong><span class="koboSpan" id="kobo.49.1"> drive. </span><span class="koboSpan" id="kobo.49.2">When imaging a logical volume, the analyst would only capture data contained within the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.50.1">D:</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.51.1"> drive.</span></span></p>
<p><span class="koboSpan" id="kobo.52.1">The following diagram illustrates data that is captured while imaging either a physical or </span><span class="No-Break"><span class="koboSpan" id="kobo.53.1">logical volume:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer116">
<span class="koboSpan" id="kobo.54.1"><img alt="Figure 8.1 – Physical versus logical volumes " src="image/B18571_08_001.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.55.1">Figure 8.1 – Physical versus logical volumes</span></p>
<p><span class="koboSpan" id="kobo.56.1">The type of incident </span><a id="_idIndexMarker645"/><span class="koboSpan" id="kobo.57.1">that is being</span><a id="_idIndexMarker646"/><span class="koboSpan" id="kobo.58.1"> investigated </span><a id="_idIndexMarker647"/><span class="koboSpan" id="kobo.59.1">largely dictates the type of imaging that is conducted. </span><span class="koboSpan" id="kobo.59.2">For example, if an analyst can identify a potentially malicious file being executed from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.60.1">D:</span></strong><span class="koboSpan" id="kobo.61.1"> drive and is intent on only capturing that data, it might be faster to acquire a logical image of only that volume. </span><span class="koboSpan" id="kobo.61.2">Furthermore, a logical acquisition may be necessary in cases</span><a id="_idIndexMarker648"/><span class="koboSpan" id="kobo.62.1"> where </span><strong class="bold"><span class="koboSpan" id="kobo.63.1">Full Disk Encryption</span></strong><span class="koboSpan" id="kobo.64.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.65.1">FDE</span></strong><span class="koboSpan" id="kobo.66.1">) is being used. </span><span class="koboSpan" id="kobo.66.2">Without the encryption key, logically acquiring files while the system is running is often the only option </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">that’s available.</span></span></p>
<p><span class="koboSpan" id="kobo.68.1">The one key drawback that a logical image has is that it will not capture unallocated data or data that is not part of the filesystem. </span><span class="koboSpan" id="kobo.68.2">Deleted files and other trace evidence will not be part of a logical image. </span><span class="koboSpan" id="kobo.68.3">In cases where an activity such as employee misconduct is suspected, the analyst will need to trace as much activity as possible, so a full image of the physical volume will be conducted. </span><span class="koboSpan" id="kobo.68.4">Time isn’t a necessary </span><span class="No-Break"><span class="koboSpan" id="kobo.69.1">factor here.</span></span></p>
<p><span class="koboSpan" id="kobo.70.1">In </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.71.1">Chapter 5</span></em></span><span class="koboSpan" id="kobo.72.1">, we discussed the acquisition of evidence such as log files and running memory from a live or powered-up system. </span><span class="koboSpan" id="kobo.72.2">In much the same way, incident response analysts have the capability to obtain a logical volume from a running system. </span><span class="koboSpan" id="kobo.72.3">This technique is referred to as live imaging. </span><span class="koboSpan" id="kobo.72.4">Live imaging may be the best option if a potentially compromised system cannot be taken offline—say, in a </span><strong class="bold"><span class="koboSpan" id="kobo.73.1">high availability</span></strong><span class="koboSpan" id="kobo.74.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.75.1">HA</span></strong><span class="koboSpan" id="kobo.76.1">) production </span><a id="_idIndexMarker649"/><span class="koboSpan" id="kobo.77.1">server—and potential evidence is located within a </span><span class="No-Break"><span class="koboSpan" id="kobo.78.1">logical volume.</span></span></p>
<p><span class="koboSpan" id="kobo.79.1">Dead imaging is performed on a system that has been powered down and the hard drive removed. </span><span class="koboSpan" id="kobo.79.2">In this type of imaging, the analyst can capture the entire disk, including all the volumes and the MBR. </span><span class="koboSpan" id="kobo.79.3">This may become necessary in incidents where analysts want to ensure that </span><a id="_idIndexMarker650"/><span class="koboSpan" id="kobo.80.1">they capture the</span><a id="_idIndexMarker651"/><span class="koboSpan" id="kobo.81.1"> entirety </span><a id="_idIndexMarker652"/><span class="koboSpan" id="kobo.82.1">of the source evidence so that there is no location that hasn’t </span><span class="No-Break"><span class="koboSpan" id="kobo.83.1">been examined.</span></span></p>
<h2 id="_idParaDest-139"><a id="_idTextAnchor141"/><span class="koboSpan" id="kobo.84.1">Types of image files</span></h2>
<p><span class="koboSpan" id="kobo.85.1">Another </span><a id="_idIndexMarker653"/><span class="koboSpan" id="kobo.86.1">aspect of forensic imaging that an analyst should </span><a id="_idIndexMarker654"/><span class="koboSpan" id="kobo.87.1">have knowledge of is the types of image files that can be created and leveraged during an investigation. </span><span class="koboSpan" id="kobo.87.2">There are several types of image files, some of which are very specialized, but for the purposes of this book, we will focus on the three most common types of evidence files that analysts will most likely create and work with during </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">an incident:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.89.1">Raw images</span></strong><span class="koboSpan" id="kobo.90.1">: A raw image</span><a id="_idIndexMarker655"/><span class="koboSpan" id="kobo.91.1"> file contains only the data from the imaged volume. </span><span class="koboSpan" id="kobo.91.2">No additional data is provided in this type of image, although some imaging tools, such as FTK Imager, include a separate file with imaging information. </span><span class="koboSpan" id="kobo.91.3">Raw image outputs include the </span><strong class="source-inline"><span class="koboSpan" id="kobo.92.1">.raw</span></strong><span class="koboSpan" id="kobo.93.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.94.1">.img</span></strong><span class="koboSpan" id="kobo.95.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.96.1">.dd</span></strong><span class="koboSpan" id="kobo.97.1"> extensions. </span><span class="koboSpan" id="kobo.97.2">Some software, such as the Linux </span><strong class="source-inline"><span class="koboSpan" id="kobo.98.1">dd</span></strong><span class="koboSpan" id="kobo.99.1"> command, provides a flexible option when speed and compatibility with forensic tools may be </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">an issue.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.101.1">Advanced Forensics File Format</span></strong><span class="koboSpan" id="kobo.102.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.103.1">AFF4</span></strong><span class="koboSpan" id="kobo.104.1">): AFF4 is an </span><a id="_idIndexMarker656"/><span class="koboSpan" id="kobo.105.1">open source format for image files. </span><span class="koboSpan" id="kobo.105.2">First proposed in 2009, the format is</span><a id="_idIndexMarker657"/><span class="koboSpan" id="kobo.106.1"> used to support several tools, such as </span><strong class="bold"><span class="koboSpan" id="kobo.107.1">Google Rapid </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.108.1">Response</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.109.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.110.1">GRR</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">).</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.112.1">EnCase evidence files</span></strong><span class="koboSpan" id="kobo.113.1">: An EnCase</span><a id="_idIndexMarker658"/><span class="koboSpan" id="kobo.114.1"> evidence file, or E01 or EX01 file, is a proprietary file format that was developed by OpenText as part of its EnCase forensic tools in 1998. </span><span class="koboSpan" id="kobo.114.2">This format was based on the </span><strong class="bold"><span class="koboSpan" id="kobo.115.1">Expert Witness Format</span></strong><span class="koboSpan" id="kobo.116.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.117.1">EWF</span></strong><span class="koboSpan" id="kobo.118.1">), which was found in ASR Data’s Expert Witness</span><a id="_idIndexMarker659"/><span class="koboSpan" id="kobo.119.1"> Compression Format. </span><span class="koboSpan" id="kobo.119.2">The E01 file contains metadata about the image. </span><span class="koboSpan" id="kobo.119.3">The metadata that is contained in both the header and footer captures and stores information about the drive type, operating system, and timestamps. </span><span class="koboSpan" id="kobo.119.4">Another key feature of an E01 file is the inclusion </span><a id="_idIndexMarker660"/><span class="koboSpan" id="kobo.120.1">of a </span><strong class="bold"><span class="koboSpan" id="kobo.121.1">Cyclical Redundancy Check</span></strong><span class="koboSpan" id="kobo.122.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.123.1">CRC</span></strong><span class="koboSpan" id="kobo.124.1">). </span><span class="koboSpan" id="kobo.124.2">This CRC is a file integrity verification that takes place after every 64 KB of data is written to the image file. </span><span class="koboSpan" id="kobo.124.3">The CRC ensures the integrity of the preceding block of data over the entire image file. </span><span class="koboSpan" id="kobo.124.4">Finally, an E01 file contains</span><a id="_idIndexMarker661"/><span class="koboSpan" id="kobo.125.1"> a </span><strong class="bold"><span class="koboSpan" id="kobo.126.1">Message Digest 5</span></strong><span class="koboSpan" id="kobo.127.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.128.1">MD5</span></strong><span class="koboSpan" id="kobo.129.1">) hash within the footer of the file. </span><span class="koboSpan" id="kobo.129.2">The following diagram illustrates which components of an E01 file</span><a id="_idIndexMarker662"/><span class="koboSpan" id="kobo.130.1"> are created during the </span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">imaging</span></span><span class="No-Break"><a id="_idIndexMarker663"/></span><span class="No-Break"><span class="koboSpan" id="kobo.132.1"> process:</span></span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer117">
<span class="koboSpan" id="kobo.133.1"><img alt="Figure 8.2 – E01 file format " src="image/B18571_08_002.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.134.1">Figure 8.2 – E01 file format</span></p>
<h2 id="_idParaDest-140"><a id="_idTextAnchor142"/><span class="koboSpan" id="kobo.135.1">SSD versus HDD</span></h2>
<p><span class="koboSpan" id="kobo.136.1">Another key</span><a id="_idIndexMarker664"/><span class="koboSpan" id="kobo.137.1"> facet of imaging that incident response </span><a id="_idIndexMarker665"/><span class="koboSpan" id="kobo.138.1">analysts need to understand is </span><a id="_idIndexMarker666"/><span class="koboSpan" id="kobo.139.1">how to image specific storage media—specifically, understanding the difference between a </span><strong class="bold"><span class="koboSpan" id="kobo.140.1">hard disk drive</span></strong><span class="koboSpan" id="kobo.141.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.142.1">HDD</span></strong><span class="koboSpan" id="kobo.143.1">) and a </span><strong class="bold"><span class="koboSpan" id="kobo.144.1">solid-state drive</span></strong><span class="koboSpan" id="kobo.145.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.146.1">SSD</span></strong><span class="koboSpan" id="kobo.147.1">). </span><span class="koboSpan" id="kobo.147.2">Understanding this difference has become critical, with SSDs being much more common, especially in endpoints such as laptops and </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">desktop computers.</span></span></p>
<p><span class="koboSpan" id="kobo.149.1">The main difference between the two goes down to the smallest details of how information is stored. </span><span class="koboSpan" id="kobo.149.2">Traditional spinning HDDs store information by changing magnetic polarity on actual spinning disks. </span><span class="koboSpan" id="kobo.149.3">Therefore, digital forensic and incident response analysts need to be aware of magnetic fields when handling evidence and why dropping an HDD would often prove fatal for </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">the disk.</span></span></p>
<p><span class="koboSpan" id="kobo.151.1">The one aspect of HDDs that is of interest to digital forensic examiners is how data is handled. </span><span class="koboSpan" id="kobo.151.2">The data is written to the disk and stays within the sectors that have been assigned to the data. </span><span class="koboSpan" id="kobo.151.3">When a user deletes a file, it is not removed. </span><span class="koboSpan" id="kobo.151.4">The data may be complete or partially overwritten, and with proper imaging tools, this data can be located and reconstructed </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">for analysis.</span></span></p>
<p><span class="koboSpan" id="kobo.153.1">Because of how HDDs work and the potential for reconstruction of data, it is a good practice to create a physical disk image. </span><span class="koboSpan" id="kobo.153.2">This involves powering down the system by removing the source of power, not through the operating system shutdown. </span><span class="koboSpan" id="kobo.153.3">This preserves the state of the drive now the analyst has accessed it. </span><span class="koboSpan" id="kobo.153.4">In those circumstances where this is not possible, a logical image can be taken from a live and </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">powered-up system.</span></span></p>
<p><span class="koboSpan" id="kobo.155.1">SSDs, on the other hand, hold information based on the state of electrons in cells in the SSD. </span><span class="koboSpan" id="kobo.155.2">This type of data storage uses instructions found on the </span><strong class="bold"><span class="koboSpan" id="kobo.156.1">printed circuit board</span></strong><span class="koboSpan" id="kobo.157.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.158.1">PCB</span></strong><span class="koboSpan" id="kobo.159.1">) that </span><a id="_idIndexMarker667"/><span class="koboSpan" id="kobo.160.1">controls how data is handled on the SSD. </span><span class="koboSpan" id="kobo.160.2">The first set of instructions is garbage collection. </span><span class="koboSpan" id="kobo.160.3">When a user deletes a file, the operating system sends instructions to the chipset indicating that the file is marked for deletion, and the PCB can reset the electrons in that space to neutral, thereby removing the data. </span><span class="koboSpan" id="kobo.160.4">This operating system instruction is often</span><a id="_idIndexMarker668"/><span class="koboSpan" id="kobo.161.1"> referred to as </span><strong class="bold"><span class="koboSpan" id="kobo.162.1">TRIM</span></strong><span class="koboSpan" id="kobo.163.1">. </span><span class="koboSpan" id="kobo.163.2">For example, entering the </span><strong class="source-inline"><span class="koboSpan" id="kobo.164.1">fsutil behavior query disabledeletenotify</span></strong><span class="koboSpan" id="kobo.165.1"> command into Windows’ Command Prompt </span><a id="_idIndexMarker669"/><span class="koboSpan" id="kobo.166.1">will </span><a id="_idIndexMarker670"/><span class="koboSpan" id="kobo.167.1">produce </span><a id="_idIndexMarker671"/><span class="koboSpan" id="kobo.168.1">the following output if the OS is using </span><span class="No-Break"><span class="koboSpan" id="kobo.169.1">an SSD:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer118">
<span class="koboSpan" id="kobo.170.1"><img alt="Figure 8.3 – TRIM operations enabled " src="image/B18571_08_003.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"> </p>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.171.1">Figure 8.3 – TRIM operations enabled</span></p>
<p><span class="koboSpan" id="kobo.172.1">Another feature of SSD chipsets that is of concern to digital forensic and incident response analysts is wear leveling. </span><span class="koboSpan" id="kobo.172.2">The electrons in an SSD have a finite lifespan and cannot be continually turned on and off. </span><span class="koboSpan" id="kobo.172.3">If the operating system only uses the first 100 GB of the drive, it may wear that section out, making the drive useless. </span><span class="koboSpan" id="kobo.172.4">To prevent this, SSDs make use of wear leveling, where data is continually moved to different locations on the drive, thereby reducing the potential of making the drive unusable. </span></p>
<p><span class="koboSpan" id="kobo.173.1">These two features mean that traditional write blockers that are used to ensure that no changes are made to the disk during imaging do not work, as the PCB manages how data is written and leveled on the SSD. </span><span class="koboSpan" id="kobo.173.2">While imaging is possible, the analysts cannot ensure that no changes were made to the disk during the process. </span><span class="koboSpan" id="kobo.173.3">To limit these changes, analysts should image an SSD in the condition that they found it. </span><span class="koboSpan" id="kobo.173.4">If the system is powered off, remove</span><a id="_idIndexMarker672"/><span class="koboSpan" id="kobo.174.1"> the drive from the system and</span><a id="_idIndexMarker673"/><span class="koboSpan" id="kobo.175.1"> image. </span><span class="koboSpan" id="kobo.175.2">If</span><a id="_idIndexMarker674"/><span class="koboSpan" id="kobo.176.1"> the system is on, it has to be </span><span class="No-Break"><span class="koboSpan" id="kobo.177.1">imaged live.</span></span></p>
<h1 id="_idParaDest-141"><a id="_idTextAnchor143"/><span class="koboSpan" id="kobo.178.1">Tools for imaging</span></h1>
<p><span class="koboSpan" id="kobo.179.1">As with much </span><a id="_idIndexMarker675"/><span class="koboSpan" id="kobo.180.1">of the previous material we covered, there are several tools available to a responder for imaging drives. </span><span class="koboSpan" id="kobo.180.2">Understanding these tools provides responders with knowledge about which tool to apply to </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">an incident.</span></span></p>
<p><span class="koboSpan" id="kobo.182.1">While there is no court or legal body that certifies digital forensics imaging tools, there are several methods and associated tools that represent best practices when acquiring disk evidence. </span><span class="koboSpan" id="kobo.182.2">Let’s go over </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">these now:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.184.1">FTK Imager</span></strong><span class="koboSpan" id="kobo.185.1">: FTK Imager is</span><a id="_idIndexMarker676"/><span class="koboSpan" id="kobo.186.1"> provided as a free software application by Access Data. </span><span class="koboSpan" id="kobo.186.2">This GUI-based application allows for the forensically sound acquisition of logical and physical volumes, memory, and other protected files and outputs those images in a variety of formats. </span><span class="koboSpan" id="kobo.186.3">In addition, FTK Imager Lite is a self-contained application that can be run on removable media for the acquisition of digital evidence from running systems (this will be covered in detail later in </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">this chapter).</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.188.1">EnCase Imager</span></strong><span class="koboSpan" id="kobo.189.1">: Provided by Guidance Software, EnCase Imager is another forensic </span><a id="_idIndexMarker677"/><span class="koboSpan" id="kobo.190.1">application that allows responders to acquire digital evidence from a variety of systems. </span><span class="koboSpan" id="kobo.190.2">As with FTK Imager, EnCase Imager can also be run on an external drive for the acquisition of </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">running systems.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.192.1">AFF4 Imager</span></strong><span class="koboSpan" id="kobo.193.1">: AFF4 Imager</span><a id="_idIndexMarker678"/><span class="koboSpan" id="kobo.194.1"> is a command-line executable that serves as the basis for tools such as WinPmem. </span><span class="koboSpan" id="kobo.194.2">AFF4 Imager can be used to acquire logical and physical disks such as EnCase or FTK Imager. </span><span class="koboSpan" id="kobo.194.3">One advantage of AFF4 Imager is that it can be used to carve out files based on time creation, to slit volumes, and to decrease imaging time </span><span class="No-Break"><span class="koboSpan" id="kobo.195.1">with compression.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.196.1">dd</span></strong><span class="koboSpan" id="kobo.197.1">: An old Linux standby </span><a id="_idIndexMarker679"/><span class="koboSpan" id="kobo.198.1">that can be used to image drives or volumes. </span><span class="koboSpan" id="kobo.198.2">Responders will most likely use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.199.1">dd</span></strong><span class="koboSpan" id="kobo.200.1"> command when using Linux-based forensic platforms for </span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">evidence acquisition.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.202.1">Virtualization tools</span></strong><span class="koboSpan" id="kobo.203.1">: With the wide adoption of virtualization, responders are most likely</span><a id="_idIndexMarker680"/><span class="koboSpan" id="kobo.204.1"> going to have to acquire at least a portion of their evidence from virtual systems. </span><span class="koboSpan" id="kobo.204.2">There is an advantage to this, though: the entire system can be offloaded for analysis. </span><span class="koboSpan" id="kobo.204.3">Depending on the virtualization software, acquisition can be accomplished by pausing the system and offloading the entire directory containing the system. </span><span class="koboSpan" id="kobo.204.4">This can also be accomplished using the snapshot feature of many virtualization </span><span class="No-Break"><span class="koboSpan" id="kobo.205.1">software platforms.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.206.1">The imaging tools you decide to use will depend on the organization, your training and experience, and which other forensic tools are in use. </span><span class="koboSpan" id="kobo.206.2">For example, if an organization uses the </span><strong class="bold"><span class="koboSpan" id="kobo.207.1">Forensic Toolkit</span></strong><span class="koboSpan" id="kobo.208.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.209.1">FTK</span></strong><span class="koboSpan" id="kobo.210.1">) for </span><a id="_idIndexMarker681"/><span class="koboSpan" id="kobo.211.1">analysis, it may be best to use FTK Imager as part of the process. </span><span class="koboSpan" id="kobo.211.2">With any imaging tool, it is good practice to ensure that the tool functions properly </span><a id="_idIndexMarker682"/><span class="koboSpan" id="kobo.212.1">and that responders have been adequately trained in </span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">its use.</span></span></p>
<p><span class="koboSpan" id="kobo.214.1">Once an imaging tool is selected, the next step is to ensure that the other hardware is ready. </span><span class="koboSpan" id="kobo.214.2">This includes ensuring that the destination of stored media is </span><span class="No-Break"><span class="koboSpan" id="kobo.215.1">correctly prepared.</span></span></p>
<h1 id="_idParaDest-142"><a id="_idTextAnchor144"/><span class="koboSpan" id="kobo.216.1">Preparing a staging drive</span></h1>
<p><span class="koboSpan" id="kobo.217.1">Just as important </span><a id="_idIndexMarker683"/><span class="koboSpan" id="kobo.218.1">as learning how to handle the</span><a id="_idIndexMarker684"/><span class="koboSpan" id="kobo.219.1"> evidence drive, having a forensically sound stage drive to which evidence will be imaged is critical. </span><span class="koboSpan" id="kobo.219.2">Responders will be walked through how to prepare </span><span class="No-Break"><span class="koboSpan" id="kobo.220.1">this item.</span></span></p>
<p><span class="koboSpan" id="kobo.221.1">Beyond having the necessary hardware and software to perform forensic imaging, it is critical to pre-stage a location to hold the image or evidence file. </span><span class="koboSpan" id="kobo.221.2">For incident response teams, the best thing to utilize as an evidence repository is an external USB or FireWire disk drive. </span><span class="koboSpan" id="kobo.221.3">This allows a degree of portability as incident responders may have to investigate an incident offsite or at a variety of locations without the benefit of a </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">forensic laboratory.</span></span></p>
<p><span class="koboSpan" id="kobo.223.1">There are two tasks that need to be performed on evidence drives prior to their use. </span><span class="koboSpan" id="kobo.223.2">The first is to ensure that the repository is free of any data. </span><span class="koboSpan" id="kobo.223.3">Incident response teams should have a policy and procedure that dictate that an evidence drive be wiped prior to each use. </span><span class="koboSpan" id="kobo.223.4">This includes drives that are new in box. </span><span class="koboSpan" id="kobo.223.5">This is since a number of manufacturers ship drives with backup software or other data that needs to be removed prior </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">to use.</span></span></p>
<p><span class="koboSpan" id="kobo.225.1">Wiping further ensures that previously utilized drives are free of any trace data from another incident. </span><span class="koboSpan" id="kobo.225.2">This ensures that the evidence collected on a properly wiped drive is not contaminated with </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">unrelated data.</span></span></p>
<p><span class="koboSpan" id="kobo.227.1">This is easily accomplished through a wiping program. </span><span class="koboSpan" id="kobo.227.2">There are several programs, both free and commercial, that can be utilized for this. </span><span class="koboSpan" id="kobo.227.3">For example, the Eraser program from Heidi Computers is a freeware wiping utility that can be utilized for both file and volume wiping (Eraser can be downloaded </span><span class="No-Break"><span class="koboSpan" id="kobo.228.1">at </span></span><a href="https://eraser.heidi.ie/"><span class="No-Break"><span class="koboSpan" id="kobo.229.1">https://eraser.heidi.ie/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.230.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.231.1">In the following example, a 2 TB external hard drive will be erased and prepared for use as an evidence drive. </span><span class="koboSpan" id="kobo.231.2">The following sequence should be repeated every time a drive is going to be placed into a state that can be utilized for </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">incident investigation:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.233.1">Start the Eraser application. </span><span class="koboSpan" id="kobo.233.2">In the GUI, click </span><strong class="bold"><span class="koboSpan" id="kobo.234.1">Erase Schedule</span></strong><span class="koboSpan" id="kobo.235.1"> and then </span><strong class="bold"><span class="koboSpan" id="kobo.236.1">New Task</span></strong><span class="koboSpan" id="kobo.237.1">. </span><span class="koboSpan" id="kobo.237.2">You </span><a id="_idIndexMarker685"/><span class="koboSpan" id="kobo.238.1">should then see a window </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">like this:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer119">
<span class="koboSpan" id="kobo.240.1"><img alt="Figure 8.4 – Setting Eraser task " src="image/B18571_08_004.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.241.1">Figure 8.4 – Setting Eraser task</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.242.1">Now, a task </span><a id="_idIndexMarker686"/><span class="koboSpan" id="kobo.243.1">name can be assigned. </span><span class="koboSpan" id="kobo.243.2">This is helpful when you wish to properly document the erasure of the evidence drive. </span><span class="koboSpan" id="kobo.243.3">Click the </span><strong class="bold"><span class="koboSpan" id="kobo.244.1">Add Data</span></strong><span class="koboSpan" id="kobo.245.1"> button. </span><span class="koboSpan" id="kobo.245.2">This will open </span><span class="No-Break"><span class="koboSpan" id="kobo.246.1">another window:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer120">
<span class="koboSpan" id="kobo.247.1"><img alt="Figure 8.5 – Eraser drive selection " src="image/B18571_08_005.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.248.1">Figure 8.5 – Eraser drive selection</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.249.1">For </span><strong class="bold"><span class="koboSpan" id="kobo.250.1">Target type</span></strong><span class="koboSpan" id="kobo.251.1">, select </span><strong class="bold"><span class="koboSpan" id="kobo.252.1">Drive/Partition</span></strong><span class="koboSpan" id="kobo.253.1">. </span><span class="koboSpan" id="kobo.253.2">In the </span><strong class="bold"><span class="koboSpan" id="kobo.254.1">Settings</span></strong><span class="koboSpan" id="kobo.255.1"> area, there will be a drop-down</span><a id="_idIndexMarker687"/><span class="koboSpan" id="kobo.256.1"> list of partitions and drive letters. </span><span class="koboSpan" id="kobo.256.2">Pay </span><a id="_idIndexMarker688"/><span class="koboSpan" id="kobo.257.1">very close attention to the drive letters that are assigned to the various drives and ensure that the external drive that requires wiping is selected. </span><span class="koboSpan" id="kobo.257.2">In this case, a new Seagate external HDD is being utilized. </span><span class="koboSpan" id="kobo.257.3">Finally, select an erasure method. </span><span class="koboSpan" id="kobo.257.4">There are several different options for wiping drives. </span><span class="koboSpan" id="kobo.257.5">In this case, the </span><strong class="bold"><span class="koboSpan" id="kobo.258.1">US DoD 5220.22-M (8-306./E) (3 Pass)</span></strong><span class="koboSpan" id="kobo.259.1"> wiping option </span><span class="No-Break"><span class="koboSpan" id="kobo.260.1">is selected:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer121">
<span class="koboSpan" id="kobo.261.1"><img alt="Figure 8.6 – Erasure method selection " src="image/B18571_08_006.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.262.1">Figure 8.6 – Erasure method selection</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.263.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.264.1">OK</span></strong><span class="koboSpan" id="kobo.265.1">. </span><span class="koboSpan" id="kobo.265.2">Now, the</span><a id="_idIndexMarker689"/><span class="koboSpan" id="kobo.266.1"> wiping task will be</span><a id="_idIndexMarker690"/><span class="koboSpan" id="kobo.267.1"> listed in the </span><strong class="bold"><span class="koboSpan" id="kobo.268.1">Erase </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.269.1">Schedule</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.270.1"> section:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer122">
<span class="koboSpan" id="kobo.271.1"><img alt="Figure 8.7 – Erase Schedule " src="image/B18571_08_007.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.272.1">Figure 8.7 – Erase Schedule</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.273.1">Right-click the </span><strong class="bold"><span class="koboSpan" id="kobo.274.1">Partition: Seagate Expansion Drive (E:)</span></strong><span class="koboSpan" id="kobo.275.1"> task and click </span><strong class="bold"><span class="koboSpan" id="kobo.276.1">Run</span></strong> <strong class="bold"><span class="koboSpan" id="kobo.277.1">Now</span></strong><span class="koboSpan" id="kobo.278.1">. </span><span class="koboSpan" id="kobo.278.2">This will start the wiping process. </span><span class="koboSpan" id="kobo.278.3">As we mentioned previously, ensure that the correct evidence drive is </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">being wiped.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.280.1">Depending</span><a id="_idIndexMarker691"/><span class="koboSpan" id="kobo.281.1"> on </span><a id="_idIndexMarker692"/><span class="koboSpan" id="kobo.282.1">the size of the drive and the system that is performing the wipe, this process can take hours or even days. </span><span class="koboSpan" id="kobo.282.2">Once it's complete, the incident response analyst should capture any information that verifies that the evidence drive has been properly wiped. </span><span class="koboSpan" id="kobo.282.3">This is important information to include in a written forensic analysis report as it demonstrates that the incident response analyst took appropriate measures to ensure that all evidence files were free from corruption or commingling with other files on the </span><span class="No-Break"><span class="koboSpan" id="kobo.283.1">evidence drive.</span></span></p>
<p><span class="koboSpan" id="kobo.284.1">It is recommended that incident response analysts have several drives available and that these drives be pre-wiped before any incident. </span><span class="koboSpan" id="kobo.284.2">This will allow incident response analysts to immediately utilize a wiped drive instead of having to wipe a drive on-site, which wastes time that would be better spent on </span><span class="No-Break"><span class="koboSpan" id="kobo.285.1">incident-related activities.</span></span></p>
<p><span class="koboSpan" id="kobo.286.1">A second preparation step that can be undertaken is to encrypt the evidence drive. </span><span class="koboSpan" id="kobo.286.2">Software such as VeraCrypt or another disk encryption platform can be utilized to encrypt the partition of the evidence drive that contains the evidence files. </span><span class="koboSpan" id="kobo.286.3">Incident response analysts dealing with confidential information such as credit cards or medical records should encrypt the evidence drive, regardless of whether it leaves the facility </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">or not.</span></span></p>
<p><span class="koboSpan" id="kobo.288.1">Two methods can be leveraged to encrypt the evidence drive. </span><span class="koboSpan" id="kobo.288.2">The first is to utilize encryption software on the forensic workstation that is utilized in the imaging process. </span><span class="koboSpan" id="kobo.288.3">This approach is limited to imaging on drives that have been removed from the system and imaged on dedicated systems that have the encryption software installed. </span><span class="koboSpan" id="kobo.288.4">A second option is to include encryption software on the evidence drive. </span><span class="koboSpan" id="kobo.288.5">In the previous section, an evidence drive was divided into two partitions. </span><span class="koboSpan" id="kobo.288.6">One partition was set aside for evidence files, while the second partition was utilized for tools such as those used for dumping memory files or imaging. </span><span class="koboSpan" id="kobo.288.7">In this scenario, the encryption software can be loaded in the tools partition, and the drive can be encrypted during the evidence imaging process. </span><span class="koboSpan" id="kobo.288.8">This limits the number of changes that are made to the system </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">under investigation.</span></span></p>
<p><span class="koboSpan" id="kobo.290.1">Once a drive is </span><a id="_idIndexMarker693"/><span class="koboSpan" id="kobo.291.1">prepared, another layer of protection is</span><a id="_idIndexMarker694"/><span class="koboSpan" id="kobo.292.1"> needed to ensure that no changes are made to the suspect system during the imaging process. </span><span class="koboSpan" id="kobo.292.2">To ensure that no changes are made, responders should be familiar with and know how to use </span><span class="No-Break"><span class="koboSpan" id="kobo.293.1">write blockers.</span></span></p>
<h1 id="_idParaDest-143"><a id="_idTextAnchor145"/><span class="koboSpan" id="kobo.294.1">Using write blockers</span></h1>
<p><span class="koboSpan" id="kobo.295.1">Write blockers </span><a id="_idIndexMarker695"/><span class="koboSpan" id="kobo.296.1">are critical components and ensure that</span><a id="_idIndexMarker696"/><span class="koboSpan" id="kobo.297.1"> evidence is not tainted during the imaging process. </span><span class="koboSpan" id="kobo.297.2">In this section, responders will be exposed to physical and software </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">write blockers.</span></span></p>
<p><span class="koboSpan" id="kobo.299.1">A key tenet of digital forensics is to ensure that no changes are made to digital evidence while processing and examining it. </span><span class="koboSpan" id="kobo.299.2">Any change, no matter how slight, has the potential to bring the entire examination into question. </span><span class="koboSpan" id="kobo.299.3">There is a distinct possibility that the evidence may even be excluded from legal proceedings if the responder is unable to articulate how they ensured that the evidence was not tainted during the examination. </span><span class="koboSpan" id="kobo.299.4">As a result, it is important to understand how write blockers maintain the integrity of </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">digital evidence.</span></span></p>
<p><span class="koboSpan" id="kobo.301.1">Write blockers come in two different types. </span><span class="koboSpan" id="kobo.301.2">The first of these is a software write blocker. </span><span class="koboSpan" id="kobo.301.3">This software sits between the operating system and the evidence. </span><span class="koboSpan" id="kobo.301.4">These are often part of any digital forensics tools that are used during the examination phase. </span><span class="koboSpan" id="kobo.301.5">They ensure that there is read-only access to the evidence file and that, during the examination, no changes have been made to the evidence. </span><span class="koboSpan" id="kobo.301.6">For example, the FTK Imager tool, which will be explored extensively in this chapter, ensures that the acquisition of digital evidence is done without any writes to </span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">the disk.</span></span></p>
<p><span class="koboSpan" id="kobo.303.1">Another type of write blocker is a physical or hardware write blocker. </span><span class="koboSpan" id="kobo.303.2">As its name indicates, this is a physical piece of hardware that sits between the evidence drive and the system performing the acquisition. </span><span class="koboSpan" id="kobo.303.3">Data is allowed to pass from the evidence disk to the analysis system but not the other way around. </span><span class="koboSpan" id="kobo.303.4">The use of this device allows responders to clearly demonstrate that no evidence was altered during the </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">acquisition phase.</span></span></p>
<p><span class="koboSpan" id="kobo.305.1">Which type of </span><a id="_idIndexMarker697"/><span class="koboSpan" id="kobo.306.1">write blocker is used is largely dependent </span><a id="_idIndexMarker698"/><span class="koboSpan" id="kobo.307.1">on the type of acquisition that is being conducted. </span><span class="koboSpan" id="kobo.307.2">Ideally, responders should choose tools and techniques that clearly demonstrate that they took every reasonable precaution to ensure that the evidence has not been altered. </span><span class="koboSpan" id="kobo.307.3">Doing so significantly decreases the risk that the evidence will be excluded from any legal proceedings, and also affords the responder the ability to rely on the evidence while making a root </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">cause determination.</span></span></p>
<p><span class="koboSpan" id="kobo.309.1">With a properly staged drive and write </span><a id="_idTextAnchor146"/><span class="koboSpan" id="kobo.310.1">blocker in place, responders are now able to move on and image </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">evidence drives.</span></span></p>
<h1 id="_idParaDest-144"><a id="_idTextAnchor147"/><span class="koboSpan" id="kobo.312.1">Imaging techniques</span></h1>
<p><span class="koboSpan" id="kobo.313.1">This section is </span><a id="_idIndexMarker699"/><span class="koboSpan" id="kobo.314.1">the main part of this chapter in which we will focus on techniques that are available to responders who are called upon to image an </span><span class="No-Break"><span class="koboSpan" id="kobo.315.1">evidence drive.</span></span></p>
<p><span class="koboSpan" id="kobo.316.1">Once a proper repository has been configured for the image file, the incident response analyst is ready to acquire the necessary evidence. </span><span class="koboSpan" id="kobo.316.2">Responders will encounter suspect systems that are either powered on or have been shut down. </span><span class="koboSpan" id="kobo.316.3">Based on the state that responders find the suspect system in, they will have to utilize one of the following techniques. </span><span class="koboSpan" id="kobo.316.4">In any incident, no matter which technique is utilized, incident responders should be prepared </span><a id="_idIndexMarker700"/><span class="koboSpan" id="kobo.317.1">to properly document their actions for any subsequent </span><span class="No-Break"><span class="koboSpan" id="kobo.318.1">forensic report.</span></span></p>
<h2 id="_idParaDest-145"><a id="_idTextAnchor148"/><span class="koboSpan" id="kobo.319.1">Dead imaging</span></h2>
<p><span class="koboSpan" id="kobo.320.1">Dead imaging is </span><a id="_idIndexMarker701"/><span class="koboSpan" id="kobo.321.1">conducted on media that is not </span><a id="_idIndexMarker702"/><span class="koboSpan" id="kobo.322.1">powered on and, in the case of hard drives, removed from the potentially compromised system. </span><span class="koboSpan" id="kobo.322.2">In terms of evidence preparation, this method is the most comprehensive as it allows the complete preservation and analysis of a physical volume. </span><span class="koboSpan" id="kobo.322.3">There are several methods and tools available, both commercial and freeware, that allow proper imaging. </span><span class="koboSpan" id="kobo.322.4">In addition to software, incident response analysts will often make use of a hardware write blocker. </span><span class="koboSpan" id="kobo.322.5">These devices ensure that no changes are made to the suspect media. </span><span class="koboSpan" id="kobo.322.6">As we discussed in </span><a href="B18571_01.xhtml#_idTextAnchor013"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.323.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.324.1">, it is critical to be able to demonstrate to a court of law that no changes were made to the </span><span class="No-Break"><span class="koboSpan" id="kobo.325.1">original evidence.</span></span></p>
<p><span class="koboSpan" id="kobo.326.1">One advantage of imaging a hard drive or other digital media in this manner is that the process can be predefined and repeatable. </span><span class="koboSpan" id="kobo.326.2">Having a predefined process that is formalized as part of incident response planning and the procedure itself ensures that evidence is handled in a forensically </span><span class="No-Break"><span class="koboSpan" id="kobo.327.1">sound manner.</span></span></p>
<p><span class="koboSpan" id="kobo.328.1">One tool that is extremely useful in dead imaging is FTK Imager. </span><span class="koboSpan" id="kobo.328.2">This tool, provided by Access Data, is a forensically sound platform for acquiring a </span><span class="No-Break"><span class="koboSpan" id="kobo.329.1">disk image.</span></span></p>
<h3><span class="koboSpan" id="kobo.330.1">Imaging using FTK Imager</span></h3>
<p><span class="koboSpan" id="kobo.331.1">The following</span><a id="_idIndexMarker703"/><span class="koboSpan" id="kobo.332.1"> process</span><a id="_idIndexMarker704"/><span class="koboSpan" id="kobo.333.1"> uses a hard drive and FTK Imager to produce a forensically sound image for analysis. </span><span class="koboSpan" id="kobo.333.2">Rushing or deviating from these steps may create a situation where the responder may not be able to rely on the evidence’s integrity, thereby making potential </span><span class="No-Break"><span class="koboSpan" id="kobo.334.1">evidence unreliable:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.335.1">The first step is to physically inspect the evidence. </span><span class="koboSpan" id="kobo.335.2">Two primary focal points should be inspected. </span><span class="koboSpan" id="kobo.335.3">The first is the chain of custody form. </span><span class="koboSpan" id="kobo.335.4">Any time that you are taking custody of evidence, you should have access to the form, ensure that all steps are properly documented, and complete the entry with </span><span class="No-Break"><span class="koboSpan" id="kobo.336.1">your information.</span></span></li>
<li><span class="koboSpan" id="kobo.337.1">Then, you need to inspect the evidence packaging to ensure that no seals have been breached. </span><span class="koboSpan" id="kobo.337.2">One quick way to document this is to take a photo of the evidence in the </span><span class="No-Break"><span class="koboSpan" id="kobo.338.1">original packaging:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer123">
<span class="koboSpan" id="kobo.339.1"><img alt="Figure 8.8 – Packaging integrity check " src="image/B18571_08_008.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.340.1">Figure 8.8 – Packaging integrity check</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.341.1">In </span><a id="_idIndexMarker705"/><span class="koboSpan" id="kobo.342.1">the </span><a id="_idIndexMarker706"/><span class="koboSpan" id="kobo.343.1">preceding photo, we have captured all the information concerning the piece of evidence and demonstrated that, prior to imaging, the integrity of the evidence has been maintained. </span><span class="koboSpan" id="kobo.343.2">After the seal has been broken, you need to take another photo of the contents of </span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">the packaging:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer124">
<span class="koboSpan" id="kobo.345.1"><img alt="Figure 8.9 – Example disk photo " src="image/B18571_08_009.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.346.1">Figure 8.9 – Example disk photo</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.347.1">Once a photo </span><a id="_idIndexMarker707"/><span class="koboSpan" id="kobo.348.1">of</span><a id="_idIndexMarker708"/><span class="koboSpan" id="kobo.349.1"> the piece of evidence has been taken, you should ensure that it matches the chain of custody form. </span><span class="koboSpan" id="kobo.349.2">Errors can occur in an incident, and this is one way to ensure that mistakes in the chain of custody are corrected as early as possible. </span><span class="koboSpan" id="kobo.349.3">By confirming the chain of custody, any mix-ups can be rectified. </span><span class="koboSpan" id="kobo.349.4">The next step is to configure the physical write blocker. </span><span class="koboSpan" id="kobo.349.5">In this case, a Tableau TK35u USB 3.0 Forensic IDE/SATA Bridge Kit is utilized as a physical write blocker. </span><span class="koboSpan" id="kobo.349.6">The suspect drive is attached via the included SATA drive adapter and a FireWire connection is made to the imaging laptop. </span><span class="koboSpan" id="kobo.349.7">When utilizing a physical write blocker, ensure that the device indicates proper functioning, as </span><span class="No-Break"><span class="koboSpan" id="kobo.350.1">demonstrated here:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer125">
<span class="koboSpan" id="kobo.351.1"><img alt="Figure 8.10 – Physical write blocker setup " src="image/B18571_08_010.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.352.1">Figure 8.10 – Physical write blocker setup</span></p>
<p><span class="koboSpan" id="kobo.353.1">With the </span><a id="_idIndexMarker709"/><span class="koboSpan" id="kobo.354.1">physical </span><a id="_idIndexMarker710"/><span class="koboSpan" id="kobo.355.1">write blocker in place, the suspect drive is now ready for imaging. </span><span class="koboSpan" id="kobo.355.2">In this example, the FTK Imager freeware application will be used. </span><span class="koboSpan" id="kobo.355.3">FTK Imager requires administrator privileges to run. </span><span class="koboSpan" id="kobo.355.4">Open the executable; the following screen </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">will appear:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer126">
<span class="koboSpan" id="kobo.357.1"><img alt="Figure 8.11 – FTK Imager main menu " src="image/B18571_08_011.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.358.1">Figure 8.11 – FTK Imager main menu</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.359.1">Click</span><a id="_idIndexMarker711"/><span class="koboSpan" id="kobo.360.1"> on </span><strong class="bold"><span class="koboSpan" id="kobo.361.1">File</span></strong><span class="koboSpan" id="kobo.362.1"> and</span><a id="_idIndexMarker712"/><span class="koboSpan" id="kobo.363.1"> then </span><strong class="bold"><span class="koboSpan" id="kobo.364.1">Create Disk Image</span></strong><span class="koboSpan" id="kobo.365.1">. </span><span class="koboSpan" id="kobo.365.2">This will open a window where you can select the media source. </span><span class="koboSpan" id="kobo.365.3">In this case, select </span><strong class="bold"><span class="koboSpan" id="kobo.366.1">Physical Drive</span></strong><span class="koboSpan" id="kobo.367.1"> so that the entire drive, including the MBR, will be captured for further analysis. </span><span class="koboSpan" id="kobo.367.2">Then, </span><span class="No-Break"><span class="koboSpan" id="kobo.368.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.369.1">Next</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.370.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer127">
<span class="koboSpan" id="kobo.371.1"><img alt="Figure 8.12 – FTK Imager source selection " src="image/B18571_08_012.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.372.1">Figure 8.12 – FTK Imager source selection</span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.373.1">The next</span><a id="_idIndexMarker713"/><span class="koboSpan" id="kobo.374.1"> window </span><a id="_idIndexMarker714"/><span class="koboSpan" id="kobo.375.1">allows the analyst to select which drive will be imaged. </span><span class="koboSpan" id="kobo.375.2">Incident response analysts should pay close attention to ensure that they are imaging the correct device since all devices that are visible to the operating system are listed. </span><span class="koboSpan" id="kobo.375.3">Here, you need to pay attention to the storage space of the drives to differentiate between the suspect and image drives. </span><span class="koboSpan" id="kobo.375.4">In this case, four separate drives are listed. </span><span class="koboSpan" id="kobo.375.5">Two are drives contained within the imaging laptop. </span><span class="koboSpan" id="kobo.375.6">Another drive is the destination drive. </span><span class="koboSpan" id="kobo.375.7">In this case, the third drive, labeled </span><strong class="source-inline"><span class="koboSpan" id="kobo.376.1">\\.\PHYSICALDRIVE2</span></strong><span class="koboSpan" id="kobo.377.1">, is the correct suspect drive. </span><span class="koboSpan" id="kobo.377.2">Highlight this drive and </span><span class="No-Break"><span class="koboSpan" id="kobo.378.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.379.1">Finish</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.380.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer128">
<span class="koboSpan" id="kobo.381.1"><img alt="Figure 8.13 – Suspect drive selection " src="image/B18571_08_013.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.382.1">Figure 8.13 – Suspect drive selection</span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.383.1">Once the suspect</span><a id="_idIndexMarker715"/><span class="koboSpan" id="kobo.384.1"> drive</span><a id="_idIndexMarker716"/><span class="koboSpan" id="kobo.385.1"> has been selected, set the destination drive. </span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">Click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.387.1">Add…</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.388.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer129">
<span class="koboSpan" id="kobo.389.1"><img alt="Figure 8.14 – FTK Imager Create Image window " src="image/B18571_08_014.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.390.1">Figure 8.14 – FTK Imager Create Image window</span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.391.1">At this</span><a id="_idIndexMarker717"/><span class="koboSpan" id="kobo.392.1"> point, choose</span><a id="_idIndexMarker718"/><span class="koboSpan" id="kobo.393.1"> the type of image file you want to create. </span><span class="koboSpan" id="kobo.393.2">Four options are available. </span><span class="koboSpan" id="kobo.393.3">In this case, </span><strong class="bold"><span class="koboSpan" id="kobo.394.1">E01</span></strong><span class="koboSpan" id="kobo.395.1"> needs to be selected. </span><span class="koboSpan" id="kobo.395.2">Click </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.396.1">Next &gt;</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.397.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer130">
<span class="koboSpan" id="kobo.398.1"><img alt="Figure 8.15 – FTK Imager Select Image Type window " src="image/B18571_08_015.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.399.1">Figure 8.15 – FTK Imager Select Image Type window</span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.400.1">In the next </span><a id="_idIndexMarker719"/><span class="koboSpan" id="kobo.401.1">window, enter</span><a id="_idIndexMarker720"/><span class="koboSpan" id="kobo.402.1"> information specific to the image. </span><span class="koboSpan" id="kobo.402.2">We will discuss reporting in </span><a href="B18571_13.xhtml#_idTextAnchor220"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.403.1">Chapter 13</span></em></span></a><span class="koboSpan" id="kobo.404.1">. </span><span class="koboSpan" id="kobo.404.2">For now, the analyst should complete the fields with as much detail as possible since this information will be included in the forensic report. </span><span class="koboSpan" id="kobo.404.3">Once the fields have been filled in, click </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.405.1">Next &gt;</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.406.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer131">
<span class="koboSpan" id="kobo.407.1"><img alt="Figure 8.16 – FTK Imager Evidence Item Information window " src="image/B18571_08_016.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.408.1">Figure 8.16 – FTK Imager Evidence Item Information window</span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.409.1">In the next </span><a id="_idIndexMarker721"/><span class="koboSpan" id="kobo.410.1">window, verify </span><a id="_idIndexMarker722"/><span class="koboSpan" id="kobo.411.1">that the image destination and filenames are correct. </span><span class="koboSpan" id="kobo.411.2">In addition to this, you’ll be able to set the image fragmentation size and compression. </span><span class="koboSpan" id="kobo.411.3">The fragmentation size can be set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.412.1">0</span></strong><span class="koboSpan" id="kobo.413.1"> since this is where the entire disk image will be contained within a single file. </span><span class="koboSpan" id="kobo.413.2">For now, the defaults will be utilized since mounting a disk image that is fragmented is not an issue. </span><span class="koboSpan" id="kobo.413.3">Once the information you’ve entered has been verified as correct, </span><span class="No-Break"><span class="koboSpan" id="kobo.414.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.415.1">Finish</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.416.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer132">
<span class="koboSpan" id="kobo.417.1"><img alt="Figure 8.17 – FTK Imager Select Image Destination window " src="image/B18571_08_017.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.418.1">Figure 8.17 – FTK Imager Select Image Destination window</span></p>
<ol>
<li value="11"><span class="koboSpan" id="kobo.419.1">Now, the </span><strong class="bold"><span class="koboSpan" id="kobo.420.1">Create Image</span></strong><span class="koboSpan" id="kobo.421.1"> window will open. </span><span class="koboSpan" id="kobo.421.2">This is the final stage and is where the analyst can cancel the creation of the image file. </span><span class="koboSpan" id="kobo.421.3">There are also two options that the analyst</span><a id="_idIndexMarker723"/><span class="koboSpan" id="kobo.422.1"> should </span><a id="_idIndexMarker724"/><span class="koboSpan" id="kobo.423.1">enable, depending on the use case. </span><span class="koboSpan" id="kobo.423.2">The first of these involves FTK Imager verifying the image after it’s been created. </span><span class="koboSpan" id="kobo.423.3">In this feature, FTK Imager will verify that no changes have been made and that the image file is complete and without errors. </span><span class="koboSpan" id="kobo.423.4">Second, FTK Imager can create a list of all files on the image. </span><span class="koboSpan" id="kobo.423.5">This may be handy for the analyst in the event that a specific file(s) has evidentiary value. </span><span class="koboSpan" id="kobo.423.6">The analyst will be able to determine whether the file is on this system. </span><span class="koboSpan" id="kobo.423.7">This can save time if several drives have to be examined. </span><span class="koboSpan" id="kobo.423.8">Once all the settings have been verified, </span><span class="No-Break"><span class="koboSpan" id="kobo.424.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.425.1">Start</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.426.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer133">
<span class="koboSpan" id="kobo.427.1"><img alt="Figure 8.18 – FTK Imager Create Image window " src="image/B18571_08_018.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.428.1">Figure 8.18 – FTK Imager Create Image window</span></p>
<ol>
<li value="12"><span class="koboSpan" id="kobo.429.1">FTK Imager will </span><a id="_idIndexMarker725"/><span class="koboSpan" id="kobo.430.1">then</span><a id="_idIndexMarker726"/><span class="koboSpan" id="kobo.431.1"> begin the process of imaging the drive. </span><span class="koboSpan" id="kobo.431.2">This can take several hours or even days, depending on the size of the drive being imaged, the available processing speed of the imaging system, and the type of connection (FireWire, USB, and so on) to the imaging system. </span><span class="koboSpan" id="kobo.431.3">While this is happening, the following window </span><span class="No-Break"><span class="koboSpan" id="kobo.432.1">will appear:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer134">
<span class="koboSpan" id="kobo.433.1"><img alt="Figure 8.19 – FTK Imager Creating Image window " src="image/B18571_08_019.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.434.1">Figure 8.19 – FTK Imager Creating Image window</span></p>
<ol>
<li value="13"><span class="koboSpan" id="kobo.435.1">Once FTK Imager has completed the imaging process, a window will open. </span><span class="koboSpan" id="kobo.435.2">In this window, FTK Imager </span><a id="_idIndexMarker727"/><span class="koboSpan" id="kobo.436.1">will provide the incident response </span><a id="_idIndexMarker728"/><span class="koboSpan" id="kobo.437.1">analyst with detailed information. </span><span class="koboSpan" id="kobo.437.2">Something that should be of concern to analysts is the hashes that have been computed for both the drive and the image. </span><span class="koboSpan" id="kobo.437.3">In this case, both the MD5 </span><a id="_idIndexMarker729"/><span class="koboSpan" id="kobo.438.1">and </span><strong class="bold"><span class="koboSpan" id="kobo.439.1">Secure Hash Algorithm 1</span></strong><span class="koboSpan" id="kobo.440.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.441.1">SHA1</span></strong><span class="koboSpan" id="kobo.442.1">) hashes match, indicating that the imaging process captured the drive properly and that no changes have been made to the evidence that was taken from the suspect drive. </span><span class="koboSpan" id="kobo.442.2">It’s good practice to include this information as part of the </span><span class="No-Break"><span class="koboSpan" id="kobo.443.1">forensic report:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer135">
<span class="koboSpan" id="kobo.444.1"><img alt="Figure 8.20 – FTK Imager result verification " src="image/B18571_08_020.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.445.1">Figure 8.20 – FTK Imager result verification</span></p>
<ol>
<li value="14"><span class="koboSpan" id="kobo.446.1">Navigate to the evidence drive. </span><span class="koboSpan" id="kobo.446.2">Here, the entire image can be located. </span><span class="koboSpan" id="kobo.446.3">Depending on how FTK has been configured regarding fragment size, there may be several files or a single evidence file. </span><span class="koboSpan" id="kobo.446.4">In addition to the evidence files, FTK Imager provides a full list of all files on the </span><span class="No-Break"><span class="koboSpan" id="kobo.447.1">hard drive.</span></span></li>
<li><span class="koboSpan" id="kobo.448.1">Finally, FTK Imager provides a text file with detailed information concerning the imaging process. </span><span class="koboSpan" id="kobo.448.2">This information should be captured and included with any subsequent forensic reporting. </span><span class="koboSpan" id="kobo.448.3">At this point, the imaging process has been completed and the evidence drive needs to be returned to </span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">secure storage.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.450.1">Dead imaging provides</span><a id="_idIndexMarker730"/><span class="koboSpan" id="kobo.451.1"> the</span><a id="_idIndexMarker731"/><span class="koboSpan" id="kobo.452.1"> most forensically sound acquisition; however, there may be times when responders will have to image a system that is powered on. </span><span class="koboSpan" id="kobo.452.2">This would necessitate the responder to perform live imaging of a </span><span class="No-Break"><span class="koboSpan" id="kobo.453.1">suspect system.</span></span></p>
<h2 id="_idParaDest-146"><a id="_idTextAnchor149"/><span class="koboSpan" id="kobo.454.1">Live imaging</span></h2>
<p><span class="koboSpan" id="kobo.455.1">In live imaging, the </span><a id="_idIndexMarker732"/><span class="koboSpan" id="kobo.456.1">system is running, and the</span><a id="_idIndexMarker733"/><span class="koboSpan" id="kobo.457.1"> analyst uses a USB storage drive to house the imaging program and the storage area. </span><span class="koboSpan" id="kobo.457.2">One simple technique is to simply copy the FTK Imager directory installed on an imaging workstation to a USB and execute it from there on the target system. </span><span class="koboSpan" id="kobo.457.3">Before that, though, the</span><a id="_idIndexMarker734"/><span class="koboSpan" id="kobo.458.1"> analyst should perform a few checks on </span><span class="No-Break"><span class="koboSpan" id="kobo.459.1">the system.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.460.1">Exterro FTK Imager guidance</span></p>
<p class="callout"><span class="koboSpan" id="kobo.461.1">FTK Imager can easily be configured to run from a USB device. </span><span class="koboSpan" id="kobo.461.2">It is recommended that analysts have at least one or two of these handy. </span><span class="koboSpan" id="kobo.461.3">For detailed information on how to configure a USB device, consult the Exterro </span><span class="No-Break"><span class="koboSpan" id="kobo.462.1">website: </span></span><a href="https://exterro.freshdesk.com/support/solutions/articles/69000765662-run-ftk-imager-from-a-flash-drive-imager-lite"><span class="No-Break"><span class="koboSpan" id="kobo.463.1">https://exterro.freshdesk.com/support/solutions/articles/69000765662-run-ftk-imager-from-a-flash-drive-imager-lite</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.464.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.465.1">Pre-imaging checks</span></h3>
<p><span class="koboSpan" id="kobo.466.1">Introduced over a</span><a id="_idIndexMarker735"/><span class="koboSpan" id="kobo.467.1"> decade ago, Microsoft BitLocker is the native FDE solution used on Windows OS systems. </span><span class="koboSpan" id="kobo.467.2">In addition to BitLocker, there are a host of FDE products. </span><span class="koboSpan" id="kobo.467.3">These solutions make it difficult for incident response analysts to conduct an analysis of a system. </span><span class="koboSpan" id="kobo.467.4">A handy tool to determine if a system is using BitLocker is Magnet Forensics’ Encrypted Disk Detector tool, available </span><span class="No-Break"><span class="koboSpan" id="kobo.468.1">at </span></span><a href="https://www.magnetforensics.com/resources/encrypted-disk-detector/"><span class="No-Break"><span class="koboSpan" id="kobo.469.1">https://www.magnetforensics.com/resources/encrypted-disk-detector/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.470.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.471.1">Simply download the tool and run it via the command line. </span><span class="koboSpan" id="kobo.471.2">For example, the following screenshot shows that the target system is </span><span class="No-Break"><span class="koboSpan" id="kobo.472.1">running BitLocker:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer136">
<span class="koboSpan" id="kobo.473.1"><img alt="Figure 8.21 – Encrypted Disk Detector " src="image/B18571_08_021.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.474.1">Figure 8.21 – Encrypted Disk Detector</span></p>
<p><span class="koboSpan" id="kobo.475.1">An additional check that should be performed is determining if the system has an HDD or SSD and if TRIM </span><a id="_idIndexMarker736"/><span class="koboSpan" id="kobo.476.1">is enabled. </span><span class="koboSpan" id="kobo.476.2">Refer to the previous section on SSDs for the specific command that can be run. </span></p>
<h2 id="_idParaDest-147"><a id="_idTextAnchor150"/><span class="koboSpan" id="kobo.477.1">Virtual systems</span></h2>
<p><span class="koboSpan" id="kobo.478.1">Responders </span><a id="_idIndexMarker737"/><span class="koboSpan" id="kobo.479.1">will </span><a id="_idIndexMarker738"/><span class="koboSpan" id="kobo.480.1">often encounter virtual servers and even workstations as part of an investigation. </span><span class="koboSpan" id="kobo.480.2">Virtualized systems can be acquired by simply exporting a </span><a id="_idIndexMarker739"/><span class="koboSpan" id="kobo.481.1">paused </span><strong class="bold"><span class="koboSpan" id="kobo.482.1">virtual machine</span></strong><span class="koboSpan" id="kobo.483.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.484.1">VM</span></strong><span class="koboSpan" id="kobo.485.1">) to a removable drive. </span><span class="koboSpan" id="kobo.485.2">In other instances, responders can make use of the snapshot feature of a virtual system. </span><span class="koboSpan" id="kobo.485.3">This creates a separate file that can be analyzed at the date and time a snapshot is taken. </span><span class="koboSpan" id="kobo.485.4">In either case, responders should make sure that the drive has been sanitized properly and that the proper documentation has </span><span class="No-Break"><span class="koboSpan" id="kobo.486.1">been addressed.</span></span></p>
<p><span class="koboSpan" id="kobo.487.1">To acquire a VM, simply pause the system and then move the entire directory to the external media. </span><span class="koboSpan" id="kobo.487.2">(In some instances, this can even be accomplished remotely.) In Windows virtual platforms such as VMware, several files make up the </span><span class="No-Break"><span class="koboSpan" id="kobo.488.1">virtual image:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer137">
<span class="koboSpan" id="kobo.489.1"><img alt="Figure 8.22 – ESXi VM files " src="image/B18571_08_022.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.490.1">Figure 8.22 – ESXi VM files</span></p>
<p><span class="koboSpan" id="kobo.491.1">Let us look at</span><a id="_idIndexMarker740"/><span class="koboSpan" id="kobo.492.1"> some </span><a id="_idIndexMarker741"/><span class="koboSpan" id="kobo.493.1">of </span><span class="No-Break"><span class="koboSpan" id="kobo.494.1">the files:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.495.1">.vmdk</span></strong><span class="koboSpan" id="kobo.496.1">: This is the virtual disk image file. </span><span class="koboSpan" id="kobo.496.2">This is the logical volume where the virtual operating system and files reside. </span><span class="koboSpan" id="kobo.496.3">Obtaining these files is much like imaging the </span><strong class="source-inline"><span class="koboSpan" id="kobo.497.1">C:</span></strong><span class="koboSpan" id="kobo.498.1"> drive on a </span><span class="No-Break"><span class="koboSpan" id="kobo.499.1">physical system.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.500.1">.vmem</span></strong><span class="koboSpan" id="kobo.501.1">: The </span><strong class="source-inline"><span class="koboSpan" id="kobo.502.1">.vmem</span></strong><span class="koboSpan" id="kobo.503.1"> file is the virtual memory file. </span><span class="koboSpan" id="kobo.503.2">This is the storage area for the virtual RAM or physical memory. </span><span class="koboSpan" id="kobo.503.3">This file can be exported and combined with an additional file for analysis using the methods that will be discussed in </span><a href="B18571_10.xhtml#_idTextAnchor173"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.504.1">Chapter 10</span></em></span></a><span class="No-Break"><span class="koboSpan" id="kobo.505.1">.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.506.1">.vmss</span></strong><span class="koboSpan" id="kobo.507.1">: The VMware suspended state file saves the running configuration of a suspended VM. </span><span class="koboSpan" id="kobo.507.2">This includes process and network connection data. </span><span class="koboSpan" id="kobo.507.3">This file is combined with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.508.1">.vmem</span></strong><span class="koboSpan" id="kobo.509.1"> file to provide the </span><span class="No-Break"><span class="koboSpan" id="kobo.510.1">system memory.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.511.1">.vmsn</span></strong><span class="koboSpan" id="kobo.512.1">: This is the virtual snapshot state file. </span><span class="koboSpan" id="kobo.512.2">This file contains the state of the system when the snapshots </span><span class="No-Break"><span class="koboSpan" id="kobo.513.1">were taken.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.514.1">Incident responders can use these files in several ways. </span><span class="koboSpan" id="kobo.514.2">First, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.515.1">.vmdk</span></strong><span class="koboSpan" id="kobo.516.1"> file can be mounted the same way as an image file can in various digital forensics software platforms. </span><span class="koboSpan" id="kobo.516.2">These will be discussed in </span><a href="B18571_09.xhtml#_idTextAnchor156"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.517.1">Chapter 9</span></em></span></a><span class="koboSpan" id="kobo.518.1">. </span><span class="koboSpan" id="kobo.518.2">Second, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.519.1">.vmsn</span></strong><span class="koboSpan" id="kobo.520.1"> file can be used to reconstruct the system by simply copying the file and working with the facsimile. </span><span class="koboSpan" id="kobo.520.2">From here, responders can look at the behavior of the system or extract evidence without impacting the original </span><strong class="source-inline"><span class="koboSpan" id="kobo.521.1">.</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.522.1">vmsn</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.523.1"> file.</span></span></p>
<p><span class="koboSpan" id="kobo.524.1">Finally, the running memory that is captured through the </span><strong class="source-inline"><span class="koboSpan" id="kobo.525.1">.vmem</span></strong><span class="koboSpan" id="kobo.526.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.527.1">.vmss</span></strong><span class="koboSpan" id="kobo.528.1"> files can be analyzed in much the same way you would analyze other memory captures. </span><span class="koboSpan" id="kobo.528.2">To obtain the proper forensic data, the two files must be combined. </span><span class="koboSpan" id="kobo.528.3">This can be done by utilizing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.529.1">vmss2core.exe</span></strong><span class="koboSpan" id="kobo.530.1"> tool, which is included as part of the VMware suite of tools. </span><span class="koboSpan" id="kobo.530.2">To combine these files, the following command syntax needs to </span><span class="No-Break"><span class="koboSpan" id="kobo.531.1">be used:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.532.1">
C:\VirtualTools\vmss2core.exe -W "InfectedServer.vmss" "InfectedServer.vmem"</span></pre>
<p><span class="koboSpan" id="kobo.533.1">The preceding command will produce a memory dump in the directory containing the </span><span class="No-Break"><span class="koboSpan" id="kobo.534.1">two files.</span></span></p>
<p><span class="koboSpan" id="kobo.535.1">Although virtualization is common in large enterprises, it should not represent a significant challenge. </span><span class="koboSpan" id="kobo.535.2">In some ways, the ability to simply pause a system and extract all the necessary files makes extracting the necessary </span><span class="No-Break"><span class="koboSpan" id="kobo.536.1">evidence faster.</span></span></p>
<p><span class="koboSpan" id="kobo.537.1">Thus far, the focus has been on Windows tools for imaging. </span><span class="koboSpan" id="kobo.537.2">Another option available to incident </span><a id="_idIndexMarker742"/><span class="koboSpan" id="kobo.538.1">responders</span><a id="_idIndexMarker743"/><span class="koboSpan" id="kobo.539.1"> is the use of Linux imaging tools. </span><span class="koboSpan" id="kobo.539.2">There are a variety of tools that provide write-blocking and imaging capabilities that are often </span><span class="No-Break"><span class="koboSpan" id="kobo.540.1">open source.</span></span></p>
<h2 id="_idParaDest-148"><a id="_idTextAnchor151"/><span class="koboSpan" id="kobo.541.1">Linux imaging</span></h2>
<p><a href="B18571_03.xhtml#_idTextAnchor046"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.542.1">Chapter 3</span></em></span></a><span class="koboSpan" id="kobo.543.1"> provided</span><a id="_idIndexMarker744"/><span class="koboSpan" id="kobo.544.1"> an overview of various forensic</span><a id="_idIndexMarker745"/><span class="koboSpan" id="kobo.545.1"> tools that are available to the incident response analyst. </span><span class="koboSpan" id="kobo.545.2">Some of these tools include Linux distributions that can be leveraged during an incident for various digital forensics tasks. </span><span class="koboSpan" id="kobo.545.3">The following example will demonstrate how a Linux distribution with forensics applications can be deployed to capture a forensically sound image of a potentially </span><span class="No-Break"><span class="koboSpan" id="kobo.546.1">compromised computer.</span></span></p>
<p><span class="koboSpan" id="kobo.547.1">The combination of a Linux distribution and a bootable USB device is an option you can use to conduct forensic imaging of potentially compromised systems. </span><span class="koboSpan" id="kobo.547.2">Incident response analysts may find themselves in a situation where multiple systems need to be imaged and the analysts have only one write blocker. </span><span class="koboSpan" id="kobo.547.3">A great deal of time will be wasted if the analyst must image each one of these systems in sequence. </span><span class="koboSpan" id="kobo.547.4">In this situation, the analyst can avoid this by creating a bootable USB drive for each system and imaging each one at the same time. </span><span class="koboSpan" id="kobo.547.5">All that the analyst needs are an evidence drive and a bootable USB drive for each source of evidence. </span><span class="koboSpan" id="kobo.547.6">Utilizing this technique will allow the analyst to image each system at the same time, saving time that is better spent on </span><span class="No-Break"><span class="koboSpan" id="kobo.548.1">other activities.</span></span></p>
<p><span class="koboSpan" id="kobo.549.1">In this </span><a id="_idIndexMarker746"/><span class="koboSpan" id="kobo.550.1">scenario, the </span><strong class="bold"><span class="koboSpan" id="kobo.551.1">Computer Aided INvestigative Environment</span></strong><span class="koboSpan" id="kobo.552.1"> Live (</span><strong class="bold"><span class="koboSpan" id="kobo.553.1">CAINE</span></strong><span class="koboSpan" id="kobo.554.1">) Linux distribution will be utilized to image the hard drive from a potentially compromised system. </span><span class="koboSpan" id="kobo.554.2">First, the system is powered off and the bootable USB device containing the CAINE OS is installed. </span><span class="koboSpan" id="kobo.554.3">The suspect system is then powered on. </span><span class="koboSpan" id="kobo.554.4">Incident response analysts should be aware of how to change the boot order of a system to ensure that it boots to the USB device. </span><span class="koboSpan" id="kobo.554.5">Analysts should also be prepared to immediately power down the system if it attempts to boot into the native OS and not the USB device. </span><span class="koboSpan" id="kobo.554.6">Let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.555.1">get started:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.556.1">Ensure that the system with the suspect drive is powered off. </span><span class="koboSpan" id="kobo.556.2">Insert the forensic OS drive into</span><a id="_idIndexMarker747"/><span class="koboSpan" id="kobo.557.1"> one </span><a id="_idIndexMarker748"/><span class="koboSpan" id="kobo.558.1">of the available USB ports. </span><span class="koboSpan" id="kobo.558.2">Now, power on the computer and access the BIOS. </span><span class="koboSpan" id="kobo.558.3">This is usually a combination of the function (</span><em class="italic"><span class="koboSpan" id="kobo.559.1">fn</span></em><span class="koboSpan" id="kobo.560.1">) key and the </span><em class="italic"><span class="koboSpan" id="kobo.561.1">F2</span></em><span class="koboSpan" id="kobo.562.1">, </span><em class="italic"><span class="koboSpan" id="kobo.563.1">F8</span></em><span class="koboSpan" id="kobo.564.1">, or </span><em class="italic"><span class="koboSpan" id="kobo.565.1">F12</span></em><span class="koboSpan" id="kobo.566.1"> key. </span><span class="koboSpan" id="kobo.566.2">If the system starts the host operating system shut down the system and try again. </span><span class="koboSpan" id="kobo.566.3">It is a good practice to find out how to access the BIOS for the system before starting </span><span class="No-Break"><span class="koboSpan" id="kobo.567.1">the process.</span></span></li>
<li><span class="koboSpan" id="kobo.568.1">Once you boot into the forensic OS, insert the evidence drive into another available USB port. </span><span class="koboSpan" id="kobo.568.2">Open the terminal and type the </span><span class="No-Break"><span class="koboSpan" id="kobo.569.1">following command:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.570.1">caine@caine:~$sudo fdisk -l</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.571.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.572.1">fdisk -l</span></strong><span class="koboSpan" id="kobo.573.1"> command lists all partitions that are visible to the CAINE OS. </span><span class="koboSpan" id="kobo.573.2">The output will look </span><span class="No-Break"><span class="koboSpan" id="kobo.574.1">like this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer138">
<span class="koboSpan" id="kobo.575.1"><img alt="Figure 8.23 – fdisk output data " src="image/B18571_08_023.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.576.1">Figure 8.23 – fdisk output data</span></p>
<p><span class="koboSpan" id="kobo.577.1">In the preceding screenshot, the first disk indicated is SDA, with 447.13 GB of storage. </span><span class="koboSpan" id="kobo.577.2">Further down, the SDA disk is divided into three separate partitions. </span><span class="koboSpan" id="kobo.577.3">The partition labeled SDA2 is the boot partition. </span><span class="koboSpan" id="kobo.577.4">With the SDA3 partition, it has a size of 387.7 GB, as shown by the cursor arrow. </span><span class="koboSpan" id="kobo.577.5">This is the data storage area where the </span><a id="_idIndexMarker749"/><span class="koboSpan" id="kobo.578.1">bulk </span><a id="_idIndexMarker750"/><span class="koboSpan" id="kobo.579.1">of the digital evidence will be located. </span><span class="koboSpan" id="kobo.579.2">It is the SDA disk that will </span><span class="No-Break"><span class="koboSpan" id="kobo.580.1">be imaged.</span></span></p>
<p><span class="koboSpan" id="kobo.581.1">Scrolling down through the output, the evidence and CAINE OS drive are </span><span class="No-Break"><span class="koboSpan" id="kobo.582.1">also visible:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer139">
<span class="koboSpan" id="kobo.583.1"><img alt="Figure 8.24 – fdisk output data " src="image/B18571_08_024.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.584.1">Figure 8.24 – fdisk output data</span></p>
<p><span class="koboSpan" id="kobo.585.1">In the preceding screenshots, there are three separate disks, each with its own partitions. </span><span class="koboSpan" id="kobo.585.2">The disk labeled </span><strong class="source-inline"><span class="koboSpan" id="kobo.586.1">/dev/sdc</span></strong><span class="koboSpan" id="kobo.587.1"> is the USB drive that contains the CAINE OS that</span><a id="_idIndexMarker751"/><span class="koboSpan" id="kobo.588.1"> the</span><a id="_idIndexMarker752"/><span class="koboSpan" id="kobo.589.1"> system has been booted from. </span><span class="koboSpan" id="kobo.589.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.590.1">/dev/sdb</span></strong><span class="koboSpan" id="kobo.591.1"> disk is the evidence drive that the system will be imaged to. </span><span class="koboSpan" id="kobo.591.2">Finally, the target system is labeled </span><span class="No-Break"><span class="koboSpan" id="kobo.592.1">as </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.593.1">/dev/sda</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.594.1">.</span></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.595.1">After identifying the proper target drive of the system, we want to confirm that the imaging process will not change the data. </span><span class="koboSpan" id="kobo.595.2">The CAINE OS has a built-in software write blocker. </span><span class="koboSpan" id="kobo.595.3">On the desktop, you will find </span><strong class="bold"><span class="koboSpan" id="kobo.596.1">Block on/off</span></strong><span class="koboSpan" id="kobo.597.1">, which is the title of the actual path to the software write blockers. </span><span class="koboSpan" id="kobo.597.2">This opens the software write blocker that will be utilized. </span><span class="koboSpan" id="kobo.597.3">While examining the list of devices, you will see that the only one that is </span><a id="_idIndexMarker753"/><span class="koboSpan" id="kobo.598.1">writable is </span><strong class="bold"><span class="koboSpan" id="kobo.599.1">SDB</span></strong><span class="koboSpan" id="kobo.600.1">, which we previously identified as the evidence drive. </span><span class="koboSpan" id="kobo.600.2">The other drives are set to read-only. </span><span class="koboSpan" id="kobo.600.3">This assures the incident response analysts that the imaging process will not alter the target drive (it is a good idea for analysts to take a screenshot of such information for </span><span class="No-Break"><span class="koboSpan" id="kobo.601.1">subsequent reporting):</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer140">
<span class="koboSpan" id="kobo.602.1"><img alt="Figure 8.25 – UnBlock device selection " src="image/B18571_08_025.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.603.1">Figure 8.25 – UnBlock device selection</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.604.1">After verifying</span><a id="_idIndexMarker754"/><span class="koboSpan" id="kobo.605.1"> that the evidence drive </span><a id="_idIndexMarker755"/><span class="koboSpan" id="kobo.606.1">is in place and that the target system has been set to read-only, configure the evidence drive so that it is mounted properly. </span><span class="koboSpan" id="kobo.606.2">Create a directory called </span><strong class="source-inline"><span class="koboSpan" id="kobo.607.1">Disk_Images</span></strong><span class="koboSpan" id="kobo.608.1"> or a similar name as a repository for this and any subsequent disk images using the </span><span class="No-Break"><span class="koboSpan" id="kobo.609.1">following command:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.610.1">caine@caine:~$ sudo mkdir /mnt/Disk_Images</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.611.1">Next, mount the SDB disk on the mount directory that was created in the last step with the following command. </span><span class="koboSpan" id="kobo.611.2">Make note that in this case, it is the larger disk partition of the </span><span class="No-Break"><span class="koboSpan" id="kobo.612.1">evidence drive:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.613.1">caine@caine:~$sudo mount /dev/sdb2 /mnt/Disk_Images</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.614.1">Now, the evidence drive has been mounted on the mount point that </span><span class="No-Break"><span class="koboSpan" id="kobo.615.1">was created.</span></span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.616.1">Next, change the directory to the evidence drive by using the </span><span class="No-Break"><span class="koboSpan" id="kobo.617.1">following command:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.618.1">caine@caine:~$ cd /mnt/Disk_Images</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.619.1">Make a directory for the system’s specific image file. </span><span class="koboSpan" id="kobo.619.2">In this case, the directory will contain the incident number </span><strong class="source-inline"><span class="koboSpan" id="kobo.620.1">Incident2022-034</span></strong><span class="koboSpan" id="kobo.621.1">, as the directory. </span><span class="koboSpan" id="kobo.621.2">It is a good idea to make this directory tie indirectly with the incident in some fashion. </span><span class="koboSpan" id="kobo.621.3">The following command will create the </span><span class="No-Break"><span class="koboSpan" id="kobo.622.1">proper directory:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.623.1">caine@caine:~$ mkdir Incident2022-034</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.624.1">Change to the directory created in </span><em class="italic"><span class="koboSpan" id="kobo.625.1">step 7</span></em><span class="koboSpan" id="kobo.626.1"> by executing the </span><span class="No-Break"><span class="koboSpan" id="kobo.627.1">following command:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.628.1">caine@caine :/ mnt /Disk_Images$ cd Incident2022-034</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.629.1">Now that you’re in the proper directory, all you need to do is image the suspect drive. </span><span class="koboSpan" id="kobo.629.2">There </span><a id="_idIndexMarker756"/><span class="koboSpan" id="kobo.630.1">are several tools available for </span><a id="_idIndexMarker757"/><span class="koboSpan" id="kobo.631.1">doing this. </span><span class="koboSpan" id="kobo.631.2">In this example, the Dc3dd tool will be used. </span><span class="koboSpan" id="kobo.631.3">This tool was developed by the </span><strong class="bold"><span class="koboSpan" id="kobo.632.1">Department of Defense Cyber Crime Center</span></strong><span class="koboSpan" id="kobo.633.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.634.1">DC3</span></strong><span class="koboSpan" id="kobo.635.1">) forensic </span><a id="_idIndexMarker758"/><span class="koboSpan" id="kobo.636.1">specialist Jesse Kornblum. </span><span class="koboSpan" id="kobo.636.2">This application has additional features that aren’t found in the dd Linux imaging application. </span><span class="koboSpan" id="kobo.636.3">These include error reporting and multiple hashing algorithms that can be leveraged on the fly. </span><span class="koboSpan" id="kobo.636.4">To start the imaging process, enter the </span><span class="No-Break"><span class="koboSpan" id="kobo.637.1">following command:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.638.1">caine@caine:/mnt/Disk_Images/Incident2022-034$ dc3dd if=dev/sda of=ACMELaptop056.img hash=md5 log=ACMELaptop56.txt</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.639.1">The preceding command contains </span><strong class="source-inline"><span class="koboSpan" id="kobo.640.1">dc3dd</span></strong><span class="koboSpan" id="kobo.641.1">. </span><span class="koboSpan" id="kobo.641.2">Start by imaging the disk at </span><strong class="source-inline"><span class="koboSpan" id="kobo.642.1">sda</span></strong><span class="koboSpan" id="kobo.643.1"> to the evidence drive and output the image file with the </span><span class="No-Break"><span class="koboSpan" id="kobo.644.1">name </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.645.1">ACMELaptop056</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.646.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.647.1">The command also has Dc3dd hash the image file with the MD5 algorithm. </span><span class="koboSpan" id="kobo.647.2">Finally, an </span><strong class="source-inline"><span class="koboSpan" id="kobo.648.1">ACMELaptop56.txt</span></strong><span class="koboSpan" id="kobo.649.1"> log file is created that can be utilized for reporting purposes. </span><span class="koboSpan" id="kobo.649.2">Running the command produces the </span><span class="No-Break"><span class="koboSpan" id="kobo.650.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer141">
<span class="koboSpan" id="kobo.651.1"><img alt="Figure 8.26 – dc3dd command and output " src="image/B18571_08_026.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.652.1">Figure 8.26 – dc3dd command and output</span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.653.1">Depending on the size of the drive, this process can take hours. </span><span class="koboSpan" id="kobo.653.2">During this time, the analyst can keep track of any progress that is made. </span><span class="koboSpan" id="kobo.653.3">Upon completion, the application will produce some output indicating how many sectors were utilized for input and how many sectors were used as an output to the image file. </span><span class="koboSpan" id="kobo.653.4">Ideally, these should be the same. </span><span class="koboSpan" id="kobo.653.5">Finally, an MD5 hash of the image file is calculated </span><a id="_idIndexMarker759"/><span class="koboSpan" id="kobo.654.1">and utilized as a part of </span><span class="No-Break"><span class="koboSpan" id="kobo.655.1">the</span></span><span class="No-Break"><a id="_idIndexMarker760"/></span><span class="No-Break"><span class="koboSpan" id="kobo.656.1"> output:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer142">
<span class="koboSpan" id="kobo.657.1"><img alt="Figure 8.27 – Dc3dd imaging completion " src="image/B18571_08_027.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.658.1">Figure 8.27 – Dc3dd imaging completion</span></p>
<ol>
<li value="11"><span class="koboSpan" id="kobo.659.1">Examining the evidence drive from a Windows system reveals the image and log file that were created </span><span class="No-Break"><span class="koboSpan" id="kobo.660.1">with Dc3dd:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer143">
<span class="koboSpan" id="kobo.661.1"><img alt="Figure 8.28 – Dc3dd output files " src="image/B18571_08_028.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.662.1">Figure 8.28 – Dc3dd output files</span></p>
<ol>
<li value="12"><span class="koboSpan" id="kobo.663.1">Examining the log file reveals the following information, all of which should be incorporated</span><a id="_idIndexMarker761"/><span class="koboSpan" id="kobo.664.1"> into any </span><span class="No-Break"><span class="koboSpan" id="kobo.665.1">subsequent </span></span><span class="No-Break"><a id="_idIndexMarker762"/></span><span class="No-Break"><span class="koboSpan" id="kobo.666.1">reporting:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.667.1">
dc3dd 7.2.646 started at 2022-05-24 22:17:14 +0200</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.668.1">
compiled options:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.669.1">
command line: dc3dd if=/dev/sda of=ACMELaptop056.img hash=md5 log=ACMELaptop56.txt</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.670.1">
device size: 937703088 sectors (probed),   480,103,981,056 bytes</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.671.1">
sector size: 512 bytes (probed)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.672.1">
480103981056 bytes ( 447 G ) copied ( 100% ), 11176,1 s, 41 M/s</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.673.1">
input results for device `/dev/sda':</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.674.1">
   937703088 sectors in</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.675.1">
   0 bad sectors replaced by zeros</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.676.1">
   9fc8eb158e5665a05875f4f5f2e6f791 (md5)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.677.1">
output results for file `ACMELaptop056.img':</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.678.1">
   937703088 sectors out</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.679.1">
dc3dd completed at 2022-05-25 01:23:30 +0200</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.680.1">Linux is a viable option when it comes to acquiring disk evidence. </span><span class="koboSpan" id="kobo.680.2">One significant advantage it has is that it is easy to scale. </span><span class="koboSpan" id="kobo.680.3">In the event that multiple systems have to be acquired, responders can use several USB storage drives and Linux USB devices and acquire them in parallel, rather than waiting for software to become available. </span><span class="koboSpan" id="kobo.680.4">CAINE is an excellent option for this as the included write blocker also affords a measure of evidence integrity in </span><span class="No-Break"><span class="koboSpan" id="kobo.681.1">the process.</span></span></p>
<p><span class="koboSpan" id="kobo.682.1">Imaging is a critical process for responders to understand. </span><span class="koboSpan" id="kobo.682.2">The incident will often dictate which technique should be used. </span><span class="koboSpan" id="kobo.682.3">In any incident, though, responders should ensure that the process is </span><a id="_idIndexMarker763"/><span class="koboSpan" id="kobo.683.1">conducted in a sound manner as the </span><a id="_idIndexMarker764"/><span class="koboSpan" id="kobo.684.1">subsequent investigation will often rely on data acquired from </span><span class="No-Break"><span class="koboSpan" id="kobo.685.1">these systems.</span></span></p>
<h1 id="_idParaDest-149"><a id="_idTextAnchor152"/><span class="koboSpan" id="kobo.686.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.687.1">Not every incident will dictate the need to obtain an image from a potentially compromised hard drive or another volume. </span><span class="koboSpan" id="kobo.687.2">Regardless, incident response analysts should be familiar with, and able to perform, this function when called upon. </span><span class="koboSpan" id="kobo.687.3">The evidence that’s found on a hard drive may be critical to determining a sequence of events or to obtaining actual files that can aid in determining the root cause of an incident. </span><span class="koboSpan" id="kobo.687.4">This is the central reason why responders need to understand the fundamentals of imaging and the tools and processes involved, how to create a stage drive, how to use write blockers, and how to execute any of the imaging techniques we mentioned in this chapter. </span><span class="koboSpan" id="kobo.687.5">As with any process that’s performed in a forensic discipline, imaging should be conducted in a systematic manner in which all the steps are followed and properly documented. </span><span class="koboSpan" id="kobo.687.6">This will ensure that any evidence that’s obtained will be sound and admissible in </span><span class="No-Break"><span class="koboSpan" id="kobo.688.1">a courtroom.</span></span></p>
<p><span class="koboSpan" id="kobo.689.1">In the next chapter, we will discuss examining network-based evidence in relation to the network activity that is associated with </span><span class="No-Break"><span class="koboSpan" id="kobo.690.1">an incident.</span></span></p>
<h1 id="_idParaDest-150"><a id="_idTextAnchor153"/><span class="koboSpan" id="kobo.691.1">Questions</span></h1>
<ol>
<li value="1"><span class="koboSpan" id="kobo.692.1">What are the two types of write blockers? </span><span class="koboSpan" id="kobo.692.2">(</span><span class="No-Break"><span class="koboSpan" id="kobo.693.1">Select two)</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.694.1">Hardware</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.695.1">Digital</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.696.1">Software</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.697.1">Court-approved</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.698.1">Responders should ensure that any storage drive that’s used for imaging is properly sanitized before </span><span class="No-Break"><span class="koboSpan" id="kobo.699.1">each use.</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.700.1">True</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.701.1">False</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.702.1">What type of imaging is used to acquire the entire physical volume of </span><span class="No-Break"><span class="koboSpan" id="kobo.703.1">a drive?</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.704.1">Dead imaging</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.705.1">Live imaging</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.706.1">Remote imaging</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.707.1">Hardware imaging</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.708.1">Which imaging application is found only on </span><span class="No-Break"><span class="koboSpan" id="kobo.709.1">Linux systems?</span></span><ol><li><span class="No-Break"><span class="koboSpan" id="kobo.710.1">FTK Imager</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.711.1">EnCase Imager</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.712.1">AFF4</span></span></li><li><span class="No-Break"><span class="koboSpan" id="kobo.713.1">dd</span></span></li></ol></li>
</ol>
<h1 id="_idParaDest-151"><a id="_idTextAnchor154"/><span class="koboSpan" id="kobo.714.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.715.1">Refer to the following resources for more information about the topics covered in </span><span class="No-Break"><span class="koboSpan" id="kobo.716.1">this chapter:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.717.1">FTK Imager </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.718.1">Guide</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.719.1">: </span></span><a href="https://d1kpmuwb7gvu1i.cloudfront.net/Imager/4_7_1/FTKImager_UserGuide.pdf"><span class="No-Break"><span class="koboSpan" id="kobo.720.1">https://d1kpmuwb7gvu1i.cloudfront.net/Imager/4_7_1/FTKImager_UserGuide.pdf</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.721.1">NIST Computer Forensic Tools &amp; Techniques </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.722.1">Catalog</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.723.1">: </span></span><a href="https://toolcatalog.nist.gov/search/index.php?ff_id=1"><span class="No-Break"><span class="koboSpan" id="kobo.724.1">https://toolcatalog.nist.gov/search/index.php?ff_id=1</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.725.1">An Overview of Disk Imaging Tool in Computer </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.726.1">Forensics</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.727.1">: </span></span><a href="https://www.sans.org/reading-room/whitepapers/incident/overview-disk-imaging-tool-computer-forensics-643"><span class="No-Break"><span class="koboSpan" id="kobo.728.1">https://www.sans.org/reading-room/whitepapers/incident/overview-disk-imaging-tool-computer-forensics-643</span></span></a></li>
</ul>
</div>


<div class="Content" id="_idContainer145">
<h1 id="_idParaDest-152"><a id="_idTextAnchor155"/><span class="koboSpan" id="kobo.1.1">Part 3: Evidence Analysis</span></h1>
<p><span class="koboSpan" id="kobo.2.1">Having completed the acquisition of digital evidence in Part 2, Part 3 will focus on the proper analysis techniques of digital forensics. </span><span class="koboSpan" id="kobo.2.2">This part will focus on the proper tools and techniques to determine the root cause of </span><span class="No-Break"><span class="koboSpan" id="kobo.3.1">an incident.</span></span></p>
<p><span class="koboSpan" id="kobo.4.1">This part comprises the </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">following chapters:</span></span></p>
<ul>
<li><a href="B18571_09.xhtml#_idTextAnchor156"><em class="italic"><span class="koboSpan" id="kobo.6.1">Chapter 9</span></em></a><em class="italic"><span class="koboSpan" id="kobo.7.1">, Analyzing Network Evidence</span></em></li>
<li><a href="B18571_10.xhtml#_idTextAnchor173"><em class="italic"><span class="koboSpan" id="kobo.8.1">Chapter 10</span></em></a><em class="italic"><span class="koboSpan" id="kobo.9.1">, Analyzing System Memory</span></em></li>
<li><a href="B18571_11.xhtml#_idTextAnchor188"><em class="italic"><span class="koboSpan" id="kobo.10.1">Chapter 11</span></em></a><em class="italic"><span class="koboSpan" id="kobo.11.1">, Analyzing System Storage</span></em></li>
<li><a href="B18571_12.xhtml#_idTextAnchor204"><em class="italic"><span class="koboSpan" id="kobo.12.1">Chapter 12</span></em></a><em class="italic"><span class="koboSpan" id="kobo.13.1">, Analyzing Log Files</span></em></li>
<li><a href="B18571_13.xhtml#_idTextAnchor220"><em class="italic"><span class="koboSpan" id="kobo.14.1">Chapter 13</span></em></a><em class="italic"><span class="koboSpan" id="kobo.15.1">, Writing the Incident Report</span></em></li>
</ul>
</div>
<div>
<div id="_idContainer146">
</div>
</div>
</body></html>