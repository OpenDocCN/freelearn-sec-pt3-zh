- en: Chapter 4. Evidence Acquisition and Analysis from iTunes Backup
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The goal of this chapter is to introduce you to the different types of local
    backups (encrypted or unencrypted), the structure of a backup, the techniques
    and software available to extract meaningful data from it, and to show you how
    to crack an encrypted backup while extracting the password saved in it. These
    concepts are really useful because sometimes the analyst may not have the iOS
    device or cannot access it, but may have access to a computer containing an iTunes
    backup.
  prefs: []
  type: TYPE_NORMAL
- en: iTunes backup
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Apple iTunes software allows users to create two different types of local
    (meaning stored on a local computer) backup of their iOS devices-encrypted and
    unencrypted. An unencrypted backup is completely accessible, while an encrypted
    one is protected with a password chosen by the owner of the device. The first
    time that the user sets a password for the backup, it is saved inside the iDevice,
    and every subsequent backup is encrypted with the same password (until the user
    decides to change or remove it). For this reason, if a password has already been
    set when performing a forensic acquisition, we would get an encrypted backup (refer
    to [Chapter 3](ch03.html "Chapter 3. Evidence Acquisition from iDevices"), *Evidence
    Acquisition from iDevices*, for the different techniques used to acquire a device
    with a backup password set).
  prefs: []
  type: TYPE_NORMAL
- en: iTunes backup folders
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The folder where the backup data is stored depends on your computer''s operating
    system. iTunes saves the backup files in these folders:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Mac**: `~/Library/Application Support/MobileSync/Backup/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Windows XP**: `\Documents and Settings\(username)\Application Data\Apple
    Computer\MobileSync\Backup\`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Windows Vista, Windows 7, Windows 8, and Windows 10**: `\Users\(username)\AppData\Roaming\Apple
    Computer\MobileSync\Backup\`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Inside these folders, there is a subfolder for each iDevice that has been backed
    up with the same computer. The name of the subfolder is equivalent to the UDID
    of the device, which is a 40-character-long hexadecimal string. This means that
    iTunes holds only one backup for each device and copies only the files that have
    been modified since the last backup. When a device is updated to a new OS version
    and then restored, the last backup created before the update is not overwritten
    the first time you create a new backup. In particular, the old backup folder is
    renamed by appending the timestamp of the backup at the end of the folder name.
  prefs: []
  type: TYPE_NORMAL
- en: iTunes backup content
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'According to Apple specifications (refer to the article available at [http://support.apple.com/kb/ht4946](http://support.apple.com/kb/ht4946),
    as mentioned in [Appendix A](apa.html "Appendix A. References"), *References*),
    an iTunes backup includes nearly all of your device''s data and settings, but doesn''t
    contain the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Content from the iTunes and App Stores, or PDFs downloaded directly to iBooks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Content synced from iTunes, such as imported MP3s, videos, books, and photos
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Photos already stored in the cloud, such as My Photo Stream, and iCloud Photo
    Library
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Touch ID settings
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Apple Pay information and settings
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Activity, Health, Website, and Keychain data (although these elements are available
    in an encrypted backup)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'One of the main differences between an unencrypted backup and an encrypted
    one are related to the `Keychain` file. Inside an unencrypted backup, this file
    is saved encrypted with a key that depends on the device''s UID, and therefore
    cannot be cracked offline or reactivated on a different device from the one used
    to generate the backup. Instead, in an encrypted backup, the `Keychain` file is
    encrypted with the backup password. This can be technically explained as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: If the device does not have a backup password set by the user, when performing
    the acquisition, it is possible to create an encrypted backup choosing a known
    password, and later be able to access the passwords saved in the Keychain without
    the need to crack anything
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If the device has a backup password set by the user, when performing the acquisition,
    it is possible to create an encrypted backup, and then trying to crack the password
    in order to extract those saved in the keychain
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'In particular, the `Keychain` file contains the following types of passwords:'
  prefs: []
  type: TYPE_NORMAL
- en: Passwords and settings of the Wi-Fi networks the device has been connected to
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Passwords of the e-mail accounts configured in Apple Mail
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VPN credentials
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Credentials (passwords or tokens) of all third-party apps that use keychain
    as the password container
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: iTunes backup structure
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In a backup folder, there are some standard files with fixed names and contents
    and hundreds of files with long hashed filenames consisting of 40 hexadecimal
    characters. The file name acts like a unique identifier for every file copied
    from the iDevice. In fact, each file is named as the result of an SHA-1 hash calculated
    on the original full name of the file in the following form:'
  prefs: []
  type: TYPE_NORMAL
- en: '`Domain-[subdomain-]fullpath/filename.ext`'
  prefs: []
  type: TYPE_NORMAL
- en: 'Consider the following example:'
  prefs: []
  type: TYPE_NORMAL
- en: '`AppDomain-com.skype.skype-Library/Preferences/com.skype.skype.plist`'
  prefs: []
  type: TYPE_NORMAL
- en: Here, `AppDomain` is the name of domain, `Com.skype.skype` is the subdomain,
    and `Library/Preferences/com.skype.skype.plist` is the path and the name of file.
  prefs: []
  type: TYPE_NORMAL
- en: Calculating the SHA-1 hash for `AppDomain-com.skype.skype-Library/Preferences/com.skype.skype.plist`
    gives us `bc0e135b1c68521fa4710e3edadd6e74364fc50a`.
  prefs: []
  type: TYPE_NORMAL
- en: This is actually the 40-character-long string we're talking about in this context.
  prefs: []
  type: TYPE_NORMAL
- en: The meaning of the elements named in the domain and subdomain is explained later
    in this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Standard backup files
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'These files are created by the backup service and store information about the
    backup itself. The most useful files are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '`Info.plist`: This is a `plist` file in plain text and stores data about the
    backed up device (such as date of backup creation, phone number, device name,
    GUID, ICCID, IMEI, product type, iOS version, serial numbers, sync settings, UDID,
    and so on) and the iTunes software used to create the backup (iTunes version number
    and iTunes settings):![Standard backup files](img/B05100_04_01.jpg)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Manifest.plist`: This is a `plist` file and it describes the content of the
    backup. Inside this file, we can find the list of applications installed on the
    backed up device. For every application, there is the name and the particular
    version. Inside the file, there is also the date the backup was made, the backup
    type (encrypted versus unencrypted), and some information about the iDevice (for
    example, if the passcode was set on the device at the time of backup) and the
    iTunes software used:![Standard backup files](img/B05100_04_02.jpg)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Status.plist`: This is a `plist` file in the binary format, and it stores
    information about the status of completion of the backup, whether the backup was
    made successfully or not:![Standard backup files](img/B05100_04_03.jpg)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Manifest.mbdb`: This is a binary file that stores the descriptions of all
    the other files in the backup folder. It contains a record for each element in
    the backup (including symbolic link and folders, which of course don''t have a
    corresponding element among the backup files). Each record contains the following
    parameters:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Domain**: This shows the domain the element belongs to. Domains are a way
    to functionally categorize elements in the device backup.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Path**: This shows the full path of the element.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Link Target**: This shows the target of the element if the element itself
    is a symbolic link.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**DataHash**: This contains the SHA-1 hash of file content.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**User ID and Group ID**: These contain the owner and the group IDs.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**m. time**: This shows the time (in the Unix time format) when the actual
    content of the file was last modified.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**a. time**: This shows the time when the file was last accessed.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**c. time**: This shows the time when changes were last made to the file or
    to the folder''s node.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Length**: This shows the size of the file in bytes (size is 0 for link or
    folder).'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Mode and inode**: These contain the Unix file permissions and the inode number.
    A really interesting thing to note from a forensics point of view is that these
    four files are stored unencrypted , even if the backup is encrypted with password.
    It means that the information contained there is accessible without cracking the
    password.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'For a detailed explanation of the analysis of an encrypted backup, we suggest
    you read the research performed by Hal Pomeranz (refer to [Appendix A](apa.html
    "Appendix A. References"), *References*). The preceding parameters are explained
    in the following diagram:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Standard backup files](img/B05100_04_04.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The first level of the hierarchy of the backup files is their domain. The domain
    for each file is written in its corresponding record in the `Manifest.mbdb` file.
    Each file has a domain name chosen from the following list:'
  prefs: []
  type: TYPE_NORMAL
- en: '**App domain**: This contains data related to the installed apps.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**App Group domain**: This is found starting from iOS 9 and contains specific
    data for third-party apps.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**App Plugin domain**: This is found starting from iOS 9 and contains plugins
    of third-party apps.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Camera Roll domain**: This contains multimedia elements related to the Camera
    application, such as images, videos, video previews, and image thumbnails.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Health domain**: This is found starting from iOS 9 and contains personal
    health data. This domain is available only in encrypted backup.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Home domain**: This contains data related to the standard application that
    comes preinstalled with iOS.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Keychain domain**: This contains encrypted data related to the keychain.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Managed Preferences domain**: This does not typically contain data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Media domain**: This contains multimedia elements not related to the Camera
    application, such as multimedia elements from MMSes and audio recordings.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Mobile Device domain**: This contains the provisioning profiles.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Root domain**: This contains cache data related to the geolocation capabilities
    of the device.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**System Preferences domain**: This contains configuration files for core components
    of iOS.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Wireless domain**: This contains data about the mobile phone component of
    the device.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Elements in the App domain are further divided into subdomains related to the
    applications they belong to, while elements in the other domains don't use this
    feature. When the subdomain is used, the domain string is written as `<domain>-<subdomain>`.
    Details about the backup structure are available at [https://theiphonewiki.com/wiki/ITunes_Backup](https://theiphonewiki.com/wiki/ITunes_Backup).
  prefs: []
  type: TYPE_NORMAL
- en: Case study - parsing Manifest.mbdb with Mbdbls Python script
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Mbdbls is an open source Python script written by Hal Pomeranz and available
    on his GitHub account (refer to [Appendix B](apb.html "Appendix B. Tools for iOS
    Forensics"), *Tools For iOS Forensics*). It parses a `Maninfest.mbdb` file and
    for each file, it extracts domain, path and filename, creation date, last accessed
    date, last modified date, and size. The following screenshot shows the execution
    of Mbdbls on a SANS SIFT workstation VM against a `Manifest.mbdb`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - parsing Manifest.mbdb with Mbdbls Python script](img/B05100_04_05.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The tool provides various options for the output: for example, it can order
    by creation, last modified or last accessed dates or by file size. Be careful
    to take into consideration the appropriate time zone setting.'
  prefs: []
  type: TYPE_NORMAL
- en: iTunes backup relevant files
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This section provides a complete overview of the most relevant files and folders
    available in a backup. For every file or folder, the full path (`domain-subdomain`)
    and a description are provided. Only the system and pre-installed apps are listed.
    A more detailed analysis of these files is provided in [Chapter 6](ch06.html "Chapter 6. Analyzing
    iOS Devices"), *Analyzing iOS Devices:*
  prefs: []
  type: TYPE_NORMAL
- en: 'Domain: `SystemPreferencesDomain/SystemConfiguration/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.accounts.exists.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Information about accounts configured in the device and grouped
    by type (for example, Apple, Google, Facebook, E-mail, and so on).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_06.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `HomeDomain/Library/Accounts/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `Account3.sqlite`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Details of the accounts configured in the device (for example,
    username and type of stored credentials such as password, OAuth, and so on).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_07.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `DatabaseDomain/lsd/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.lsdidentifiers.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Launch Services Daemon Identifiers information and correlation
    between the application name and GUID.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_08.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `HealthDomain/Health`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `healthdb.sqlite`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: List of devices and applications that accessed/updates user''s
    health information from `healthdb_secure.sqlite`, and related timestamp of the
    event.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `RootDomain/Library/Preferences`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.preferences.network.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Airplane mode enabled or disabled at the time of backup.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_09.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `RootDomain/Library/Preferences`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.MobileBackup.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Information about the last device reset. In particular, it contains
    the backup version of iOS, the iOS version installed on the device at the time
    of recovery, the recovery date, and whether the backup was restored from iCloud.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_10.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `RootDomain/Library/Preferences`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `GlobalPreferences`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Language set.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_11.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `SystemPreferencesDomain/SystemConfiguration/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.wifi.plist - preferences.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Information about the Wi-Fi networks configured in the device.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_12.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `SystemPreferencesDomain/SystemConfiguration/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.network.identification.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: TCP/IP settings for latest connections (both Wi-Fi and cellular
    networks).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_13.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `SystemPreferencesDomain/SystemConfiguration/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.radios.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Airplane mode enabled or disabled at the time of backup.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_14.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `SystemPreferencesDomain/SystemConfiguration/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.mobilegestalt.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Device name.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_15.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `WirelessDomain/Library/Preferences/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.commcenter.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Telco provider in use and information about the SIM card.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_16.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `WirelessDomain/Library/Preferences/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.commcenter.counts.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Statistics on the use of data and cellular network (for example,
    bytes received/sent, SMS received/sent, and so on).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_17.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `WirelessDomain/Library/Preferences/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.commcenter.callservices.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: iCloud account e-mail address.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_18.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `WirelessDomain/Library/Preferences/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `csidata`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Device settings for cellular network (for example, cellular data
    enabled/disabled).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/MobileBluetooth/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.MobileBluetooth.ledevices.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Information about the Bluetooth devices seen by the iOS device.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/TCC`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `TCC.db`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Access privileges assigned to the applications (for example, Address
    Book, Photos, Facebook, Microphone, Camera, and so on).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/SpringBoard`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `IconState.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Arrangement of the icons within the SpringBoard, divided by window.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/AddressBook/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `AddressBook.sqlitedb`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: User personal contacts, such as names, phone numbers, e-mail addresses,
    and so on.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/AddressBook/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `AddressBookImage.sqlitedb`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Images associated with the contacts in the Address Book.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/Calendar/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `Calendar.sqlitedb`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: All the user''s calendars and associated events.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/CallHistoryDB/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `CallHistory.storedata`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: The list of outgoing, incoming, and missed calls made through
    the cellular network, as well as FaceTime.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `WirelessDomain/Library/CallHistory/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `Call_history.db`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: File used as Call History database until iOS 7\. If the phone
    has been upgraded or restored, you can find information on old calls.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/Voicemail/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `Voicemail.db`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Voicemail database.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/SMS/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `sms.db`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: SMS and iMessages sent and received, including the date it has
    been received, read, and delivered (for iMessage), the text, and the type (sent/received).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/SMS/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Folder name: `Drafts`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Drafts of both SMS and iMessage.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `MediaDomain/Library/SMS/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Folder name: `Attachments`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Attachments received via MMS.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Folder name: `DataAccess`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: It contains a subfolder for each mailbox configured within the
    Mail application. Inside each subfolder, there is a file named `mboxCache.plist`
    containing the structure of the mailbox folder.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/Mail`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `Recents`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Information about the receivers and sent date of e-mails recently
    sent.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![iTunes backup relevant files](img/B05100_04_19.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Domain: `AppDomain/com.apple.mobilemail/Preferences/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename:  `com.apple.mobilemail.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`com.apple.MailAccount-ExtProperties.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Apple Mail application configuration and settings of the configured
    accounts.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/Notes`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `Notes.sqlite`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Saved notes, grouped by account. Starting from iOS 9.3, users
    can optionally encrypt every single note with a password.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `HomeDomain/Library/Safari/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `bookmarks.db`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Safari bookmarks.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `AppDomain/com.apple.mobilesafari/Library/Preferences/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.mobilesafari.it`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Safari configuration file.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `AppDomain/com.apple.mobilesafari/Library/Safari/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `History.db`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Safari navigation history.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `AppDomain/com.apple.mobilesafari/Library/Safari/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `SuspendedState.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: It contains the status of all currently active tabs in Safari.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `AppDomain/com.apple.mobilesafari/Library/Safari/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Folder name: `Thumbnails`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: It contains the thumbnails in the PNG format of the currently
    active Safari pages.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `AppDomain/com.apple.mobilesafari/Library/WebKit/WebSiteData`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Folder name: `LocalStorage`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: The `LocalStorage` database stored by websites. May contain specific
    information stored by the site and are useful to determine the URL accessed even
    though it''s no longer present in the history.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `AppDomain/com.apple.Maps/Library/Preferences`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `com.apple.Maps.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Apple Maps application configuration. It contains a list of recently
    searched addresses.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `AppDomain/com.apple.Maps/Library/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Folder name: `Maps`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: It contains several files related to the usage of Apple Maps application.
    Files are binary type and with the `.mapsdata` extension (for example, `History.mapsdata`),
    but you can pull strings with the addresses of places.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `CameraRollDomain/Media/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Folder name: `DCIM`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: It contains videos and pictures taken from the device camera or
    saved from other third-party applications (for example, WhatsApp, Facebook, and
    so on). The pictures taken with the device camera are stored in the JPG format
    while the videos are in the MOV format. Moreover, it contains several subfolders
    where the files are actually stored, these names contain an increasing number
    (that is 100APPLE, 101APPLE, 102APPLE, and so on), and each of these folders may
    contain up to 1000 files.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `CameraRollDomain/Media/DCIM`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Folder name: `.THMB`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Contains picture thumbnails in the JPG format.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `CameraRollDomain/Media/PhotoData/MISC/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Filename: `DCIM_APPLE.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Information about the active folder and the number of files.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `CameraRollDomain/Media/PhotoData/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Folder name: `Thumbnails`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Four files in the proprietary ITHMB format, one for each possible
    thumbnail size.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Domain: `CameraRollDomain/Media/PhotoData/Thumbnails/V2/`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Folder name: `DCIM`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Description: Contains a subfolder for each picture with thumbnail in the JPG
    format.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: iTunes backup data extraction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are several tools available to extract data from an iTunes backup-some
    open source software, as well as some commercial products. These tools allow you
    to have complete access to the data in case of an unencrypted backup and partial
    access in case of an encrypted one (in particular the content of the files will
    not be visible unless you know the backup password or you have been able to crack
    it). Among the most interesting and powerful tools for accessing and extracting
    data from a backup, there is forensic software (UFED Physical Analyzer, Oxygen
    Forensic® Suite, AccessData MPE+, EnCase, Elcomsoft Phone Viewer, and so on),
    commercial software for data extraction (iBackup Bot, iPhone Backup Extractor,
    DiskAid, Wondershare Dr. Fone, and so on), and freeware/open source software for
    data extraction (iPhone Backup Analyzer and iPhone Analyzer). A detailed list
    is provided in [Appendix B](apb.html "Appendix B. Tools for iOS Forensics"), *Tools
    for iOS Forensics*. Another option is to recover the backup content on your own
    simply with a hex editor. In this case, we suggest you to read the article available
    at [http://resources.infosecinstitute.com/ios-5-backups-part-1/](http://resources.infosecinstitute.com/ios-5-backups-part-1/).
  prefs: []
  type: TYPE_NORMAL
- en: Case study - iTunes backup parsing with iBackupBot
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: iBackupBot is a commercial tool for Windows that allows access to iTunes backup
    stored on a local computer. The trial version allows in any case loading and extracting
    information from a backup.
  prefs: []
  type: TYPE_NORMAL
- en: Once the software is executed, it automatically loads all the backups stored
    in the predefined iTunes Backup folder, but another backup can be opened through
    the **File** menu. In the left-hand pane, all the loaded backups are listed and
    all the domains can be browsed, while in the central pane general information
    about the device is shown (device name, iOS version, phone number, serial number,
    UDID, IMEI, and so on).
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup parsing with iBackupBot](img/B05100_04_20.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Browsing a backup reveals files that are grouped with respect to their specific
    domain. **System Files** contains all domains referring to iOS settings and data.
    Third-party app data is in **User App Files**, **App Group Files**, and **App
    Plugin Files**. The user can open a file by simply double -clicking on it because
    the software contains integrated `plist` and SQLite viewers:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup parsing with iBackupBot](img/B05100_04_21.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The **User Information Manager** option parses some of the most common data
    stored in a backup, specifically the following: **Contacts**, SMS/MMS **Messages**,
    **Call History**, **Calendar**, **Notes**, **Recent Email** (only To: e-mail address,
    date, and time), **Safari Bookmarks**, and **Safari History**:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup parsing with iBackupBot](img/B05100_04_22.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Multimedia File Manager** provides a view of media files stored in the backup
    and specifically the **Camera Roll** domain files, **Voice Mail**, **Voice Memo**,
    and **Other Multimedia files** (for example, SMS/MMS attachments, WhatsApp media
    files, and so on).'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup parsing with iBackupBot](img/B05100_04_23.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Case study - iTunes backup analysis with iPBA
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: iPhone Backup Analyzer is a tool developed by the Italian researcher Mario Piccinelli,
    and it provides a simple way to browse through the backup folder and perform a
    forensic analysis of an iDevice backup. It was released as open source software
    under the MIT license, and since it is written in Python, it should be cross-platform
    (Mac, Linux, and Windows).
  prefs: []
  type: TYPE_NORMAL
- en: 'The main goal behind the development is to provide a way to analyze the contents
    of the iPhone backup. It is meant to be used by anyone who wants to easily study
    what the backup contains, be they a forensics expert, an iOS developer, or just
    an interested iPhone user. The software is also packed with utilities to easily
    browse through the content formatted in a ready-to-use way, such as messages,
    contacts, Safari bookmarks, and so on. Its complete feature set can be summarized
    in the following diagram:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup analysis with iPBA](img/B05100_04_24.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'In a Windows environment, after downloading the tool, you need to unzip it
    to a folder and launch the executable `iPBA2.exe` file. By navigating to **File**
    | **Open Archive**, you can choose the folder containing the backup. The software
    parses and analyzes the backup and provides a graphical way to browse through
    it:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup analysis with iPBA](img/B05100_04_25.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'By right-clicking on a `plist` or SQLite file, the analyst can view the file
    content. For example, in the following screenshot, you can see the content of
    the `Manifest.plist` file:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup analysis with iPBA](img/B05100_04_26.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'In the following screenshot, you can see the contents of a Call History SQLite
    database:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup analysis with iPBA](img/B05100_04_27.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'By choosing an item from the **Plugins** menu, you can also analyze useful
    information from the backup. Currently, the software offers 14 plugins: **Address
    Book Browser**, **Call History**, **Phone Info Browser**, **Known Networks**,
    **Network Identification**, **Note Browser**, **Safari History Browser**, **Safari
    State Explorer**, **Safari Bookmarks**, **Skype Browser**, **Messages Browser**,
    **Thumbnails Browser**, **Viber Browser**, and **WhatsApp Browser**. In the following
    screenshot, you can see, for example, the known Wi-Fi networks plugin:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup analysis with iPBA](img/B05100_04_28.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Case study - iTunes backup analysis with Oxygen Forensic Analyst
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Oxygen Forensic Analyst is a commercial tool that has already been introduced
    in [Chapter 3](ch03.html "Chapter 3. Evidence Acquisition from iDevices"), *Evidence
    Acquisition from iDevices*. This tool enables you to acquire data from an iDevice
    and also to import a previously created iTunes backup.
  prefs: []
  type: TYPE_NORMAL
- en: 'In order to import a backup, it is enough to click on **Import File** from
    the main window and navigate to **Import Apple backup/image** | **Import iTunes
    backup...**:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup analysis with Oxygen Forensic Analyst](img/B05100_04_29.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'When selecting a folder containing a backup, the tool shows the `Manifest.plist`
    file, which has to be chosen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup analysis with Oxygen Forensic Analyst](img/B05100_04_30.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The software recognizes the backup structure and proposes an options screen
    where the investigator can decide whether they want to only do the backup conversion,
    or if they also want the application to do the parsing of applications'' databases.
    Similarly, it is also possible to ask the software to recover deleted records
    within the database:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup analysis with Oxygen Forensic Analyst](img/B05100_04_31.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The software then starts the analysis process and allows users to analyze the
    backup content. In [Chapter 6](ch06.html "Chapter 6. Analyzing iOS Devices"),
    *Analyzing iOS Devices*, we will see a further example of the analysis performed
    with Oxygen Forensic Analyst:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes backup analysis with Oxygen Forensic Analyst](img/B05100_04_32.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Encrypted iTunes backup cracking
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'As we explained in [Chapter 3](ch03.html "Chapter 3. Evidence Acquisition from
    iDevices"), *Evidence Acquisition from iDevices*, and in the first part of this
    chapter, an iTunes backup can be encrypted with a password chosen by the iDevice
    user. When you seize an iDevice with a backup password already set, or if you
    have a computer with a previously created encrypted backup, you can try to crack
    the backup using a dedicated tool. Currently, we were able to find only three
    software packages that can be used to crack an encrypted backup: EPB, Passware
    Forensic, and iPhone Backup Unlocker.'
  prefs: []
  type: TYPE_NORMAL
- en: Case study - iTunes encrypted backup cracking with EPB
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As mentioned on the product's website, Elcomsoft Phone Breaker enables forensic
    access to password-protected backups for smartphones and portable devices based
    on the Apple iOS platforms. The password recovery tool supports Apple devices
    running iOS, including iPhone, iPad, and iPod touch devices of all generations
    released to date.
  prefs: []
  type: TYPE_NORMAL
- en: 'After launching the tool, the first step is to load the encrypted backup by
    clicking on the **Decrypt backup** option from the main window (**Tools**) and
    selecting **Decrypt backup**, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes encrypted backup cracking with EPB](img/B05100_04_33.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The software automatically provides a list of encrypted backups,  saved in
    the default backup folder of the user who is executing the tool:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes encrypted backup cracking with EPB](img/B05100_04_34.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The analyst can choose one of the proposed encrypted backups or choose another
    folder containing other encrypted backups. After selecting the backup, the tool
    asks the analyst where they want to save the decrypted backup and, if known, to
    provide the backup password:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes encrypted backup cracking with EPB](img/B05100_04_35.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'By clicking on **Attempt Password Recovery**, the user can select the type
    of cracking they want to perform. You can choose between two options: **Dictionary
    Attack** or **Brute-Force Attack**, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes encrypted backup cracking with EPB](img/B05100_04_36.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'In the first case, the analyst can provide a custom dictionary file, as shown
    in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes encrypted backup cracking with EPB](img/B05100_04_37.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'In the second case, the analyst can decide the parameters for the brute-force
    attack, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes encrypted backup cracking with EPB](img/B05100_04_38.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'If the cracking procedure is successful, the tool provides the password to
    the analyst and gives the options to decrypt the backup (so that it can be analyzed
    with one of the tools previously mentioned):'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes encrypted backup cracking with EPB](img/B05100_04_40.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Otherwise, it is possible to show the keychain content with the username and
    password for the Wi-Fi network connection, e-mail accounts configured in the Mail
    app, stored Internet passwords, and stored passwords from other apps:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Case study - iTunes encrypted backup cracking with EPB](img/B05100_04_39.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we explained the most useful information about an iTunes backup
    related to the forensic analysis of an iOS device. In particular, we illustrated
    how the backup is structured and how to parse it with commercial and open source
    tools. We also explained the differences between an unencrypted and encrypted
    backup and suggested some ways to try to crack the backup password. A really interesting
    point about the iTunes backup is that if the device does not have a backup password
    already set by its owner, when preforming the acquisition, you can create an encrypted
    backup, choosing a known password in order to be able to access the password saved
    in the `Keychain` file without the need for cracking. Instead, if you happen to
    have an encrypted backup for which you are not able to crack the password, it
    is anyway possible to analyze the `plist` files and the content of the `Manifest.mbdb`
    file, recovering in this way the list of all files present inside that backup.
    In the next chapter, how to recover data from the user iCloud account with either
    its credentials or authentication token will be explained.
  prefs: []
  type: TYPE_NORMAL
- en: Self-test questions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Q1\. In which folder are the iOS devices backup stored in Windows 7?
  prefs: []
  type: TYPE_NORMAL
- en: '`C:\Users\[username]\AppData\Roaming\Apple Computer\MobileSync\Backup`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`C:\Users\[username]\AppData\Local\Apple Computer\MobileSync\Backup`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`C:\Users\[username]\AppData\Apple Computer\MobileSync\Backup`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`C:\Program Data\Apple Computer\MobileSync\Backup`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Q2\. Which file contains information about the backup (such as backup date,
    device name, and so on)?
  prefs: []
  type: TYPE_NORMAL
- en: '`Manifest.plist`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`Info.plist`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`Status.plist`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`Manifest.mbdb`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Q3\. Which file contains the description of all the files in the backup folder?
  prefs: []
  type: TYPE_NORMAL
- en: '`Manifest.plist`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`Info.plist`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`Status.plist`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`Manifest.mbdb`'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Q4\. Which backup domain contains multimedia elements related to the camera?
  prefs: []
  type: TYPE_NORMAL
- en: App domain
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Camera Roll domain
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Media domain
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Keychain domain
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
