- en: Email and Instant Messaging Forensics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following recipes:'
  prefs: []
  type: TYPE_NORMAL
- en: Outlook mailbox parsing with Intella
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Thunderbird mailbox parsing with Autopsy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Webmail analysis with Magnet AXIOM
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Skype forensics with Belkasoft Evidence Center
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Skype forensics with SkypeLogView
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Accessing a suspect's communications via email and instant messengers will help
    you to solve lots of cases; and you will be asked to find and extract such artifacts
    very often. It doesn't matter if the case is a phishing attack, intellectual property
    theft, or a terrorist act - a computer forensic examiner must be able to locate,
    parse, and analyze a suspect's digital communications.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we will show you how to parse and analyze artifacts from the
    most common Windows email clients - Microsoft Outlook, Mozilla Thunderbird, and
    Skype instant messenger.
  prefs: []
  type: TYPE_NORMAL
- en: Outlook mailbox parsing with Intella
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Intella is a very powerful digital forensic and eDiscovery tool capable of processing,
    searching, and analyzing **Electronically Stored Information** (**ESI**). One
    of its main features is visual analytics. This feature can help an examiner to
    understand the ESI and custodian relationships better. In this recipe, we will
    show you how to parse an Outlook mailbox with this tool.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If you don''t have a valid Intella license, you can get a free 14-day trial
    version from Vound Software''s website (check the *See also* section). You will
    also need a `PST` or `OST` file to follow this recipe. It''s easy to get one:
    simply use your own email address with Outlook, then go to `C:\Users\%USERNAME%\AppData\Local\Microsoft\Outlook`
    and get your file. This will be your evidence source, in our case an `OST` file.'
  prefs: []
  type: TYPE_NORMAL
- en: PST files are used for POP3, IMAP, and web-based mail accounts, while OST files
    are used when a user has an Exchange account and wants to work offline.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We can start the process by following the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Start by creating a new case. To do this, run Intella (you''ll see Intella
    Case Manager), type your name (in our case it''s `Test`), and click the Add...
    button, as shown in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5084cecf-a08a-470b-ae7e-ac6ea6f3c2b6.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.1\. Adding a new case
  prefs: []
  type: TYPE_NORMAL
- en: Using the **Add Case** dialog, an examiner can Create a new case, Open a shared
    case, Add an existing case, or Import a case.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/86019c26-aca4-4d46-be12-db3ba7781f7f.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.2\. Add Case dialog
  prefs: []
  type: TYPE_NORMAL
- en: As we have decided to create a new case, let's choose **Create a new case**.
    Now you can see a few fields to fill in. Also you can choose a folder for storing
    the temporary indexing files - it improves the indexing speed!
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/8bb4e037-5a76-4e0e-aa24-4b8f6efb15db.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.3\. Creating a new case
  prefs: []
  type: TYPE_NORMAL
- en: 'It''s time to choose our evidence source. As we already mentioned, we are going
    to use an `OST` file, so let''s choose the File or Folder option, as shown in
    the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/e5900a9a-f025-4d82-b925-77047aba27db.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.4\. Adding a new source
  prefs: []
  type: TYPE_NORMAL
- en: 'In our case, the file is named `test.ost` and is located in the root of `E:\
    drive`, as you can see in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a960f484-d095-4922-b2d2-c11906334e52.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.5\. Adding a file to process
  prefs: []
  type: TYPE_NORMAL
- en: If you don't like the original name of the source, you can change it to one
    you like. Also, you should choose the right time zone, or just choose UTC if the
    right time zone is unknown.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/778f04e0-7fef-485b-aa16-b8b16ed3c02e.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.6\. Choosing the source name and the time zone
  prefs: []
  type: TYPE_NORMAL
- en: 'OK, let''s choose the items we want to process. In our case, they are the following:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Mail archives: we are processing an Outlook mailbox, so this is very important'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Archives: can be attached to emails'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Images embedded in emails and documents
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Deleted emails
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Text fragments from unsupported and unrecognized file types
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/324da438-04ef-460d-9a78-6f9a87fd3ef8.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.7\. Choosing items to process
  prefs: []
  type: TYPE_NORMAL
- en: 'You can skip two next windows and start evidence processing. Once indexing
    is complete, you will see the overview, as shown in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/424a3906-357e-4427-8fcc-6dadd1821920.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.8\. Indexing the evidence source
  prefs: []
  type: TYPE_NORMAL
- en: 'Click **Finish** and you''ll see the main window with three tabs; look at the
    following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/72d5190c-c470-42d2-91da-4505b00c9611.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.9\. Intella Search tab
  prefs: []
  type: TYPE_NORMAL
- en: As you can see, we have 44 items, including the 19 that were recovered. Now
    we can search the indexed data using different keywords and facets, such as email
    addresses, phone numbers, author, date, type, and so on. Also, we can use this
    tab to create cluster maps, histograms, and social graphs, which can be very useful.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'OK, let''s go to the **Insight** tab, as shown in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d99a8a63-e4ac-46c1-8388-4452856aebee.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.10\. Intella Insight tab
  prefs: []
  type: TYPE_NORMAL
- en: Here we have the evidence overview. For example, Intella shows us that we are
    dealing with Microsoft Outlook, we have 19 recovered artifacts, six email messages,
    and 44 items in total.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s check the last tab - **Keywords**. Look at the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d2415598-62c9-42c0-a11d-4c3ec1f71164.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.11\. Intella Keywords tab
  prefs: []
  type: TYPE_NORMAL
- en: First of all, you can use this tab to add custom keyword lists - it can save
    you time! Also, you can choose where you want to search. For example, if you want
    to look for keywords only in the emails' subjects, then you can uncheck all options
    first and choose only 'Title/Subject'.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Intella indexes the chosen evidence source and enables a computer forensic examiner
    to search through the indexed data. It can also be used to create cluster maps,
    histograms, social graphs, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Intella overview:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://www.vound-software.com/individual-solutions](https://www.vound-software.com/individual-solutions)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Introduction to Outlook Data Files (`.pst` and `.ost`):'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://support.office.com/en-us/article/Introduction-to-Outlook-Data-Files-pst-and-ost-6d4197ec-1304-4b81-a17d-66d4eef30b78](https://support.office.com/en-us/article/Introduction-to-Outlook-Data-Files-pst-and-ost-6d4197ec-1304-4b81-a17d-66d4eef30b78)'
  prefs: []
  type: TYPE_NORMAL
- en: Thunderbird mailbox parsing with Autopsy
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Thunderbird is a free and open source mail client from Mozilla, the developers
    of the Firefox browser. If a user doesn't use Outlook, they are likely to use
    Thunderbird. In this recipe, we will show you how to extract data from Thunderbird
    MBOX files with a free and open source digital forensics platform â€” **Autopsy**.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Thunderbird stores mail data in MBOX files. These files can be found at the
    following location:'
  prefs: []
  type: TYPE_NORMAL
- en: '`C:\Users\%USERNAME%\AppData\Roaming\Thunderbird\Profiles`'
  prefs: []
  type: TYPE_NORMAL
- en: Here you will find a user profile folder, which can be exported and processed
    with a piece of forensic software, in our case Autopsy.
  prefs: []
  type: TYPE_NORMAL
- en: Of course, you can use the whole forensic image for processing, but if you use
    only the profile folder, it saves you a lot of time.
  prefs: []
  type: TYPE_NORMAL
- en: Get a Thunderbird profile folder or a forensic image, and start Autopsy. If
    you haven't installed it already, use the download link in the 'See also' section.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We can start the process by following the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Start by creating a new case and filling in the case details. We are planning
    to use a Thunderbird profile folder as the source, so in the **Select Data Source**
    window, we choose **Logical Files**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6474c26d-3633-4114-92eb-befec203be7a.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.12\. Selecting data source in Autopsy
  prefs: []
  type: TYPE_NORMAL
- en: Also, you can choose the display name for your evidence source. You will notice
    that we have named it **Thunderbird Test**.
  prefs: []
  type: TYPE_NORMAL
- en: It's time to choose Ingest Modules. We highly recommend always choosing the
    **Keyword Search** module, as this is very helpful. Of course, this time make
    sure **Email Parser** is ticked.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/cf63d196-81de-48db-8500-d79059e496f1.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.13\. Configuring ingest modules in Autopsy
  prefs: []
  type: TYPE_NORMAL
- en: 'Once your data source is processed, you can analyze the results. You can find
    these in the Email Messages section on the left, as shown in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ed449d10-bd0d-43ff-94ae-b77d9d913fdb.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.14\. Parsed email messages
  prefs: []
  type: TYPE_NORMAL
- en: 'As you can see, there are 487 email messages extracted by Autopsy. On the right,
    you can find everything you need for analysis: sender, recipient, message body,
    timestamps, and so on.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Autopsy processes the data source specified by a computer forensic examiner
    and extracts the email data from supported containers, such as MBOX and PST.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Autopsy download page:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://sleuthkit.org/autopsy/download.php](http://sleuthkit.org/autopsy/download.php)'
  prefs: []
  type: TYPE_NORMAL
- en: 'MBOX Email Format:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://www.loc.gov/preservation/digital/formats/fdd/fdd000383.shtml](https://www.loc.gov/preservation/digital/formats/fdd/fdd000383.shtml)'
  prefs: []
  type: TYPE_NORMAL
- en: Webmail analysis with Magnet AXIOM
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As you may know, some people (including the authors) use only webmail and no
    mail clients. Is it possible to recover such forensic artifacts from a drive image?
    The answer is - yes! And in this recipe, we will show you how to recover webmail
    activity with Oleg's favorite digital forensic tool - Magnet AXIOM.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We are sure that you already have AXIOM installed on your workstation. So run
    the tool and create a new case. Now, the most interesting thing is the evidence
    source. If you have already walked through the recipe *Extracting Web Browser
    Data from Pagefile.sys* in [Chapter 8](ec4705f6-5645-4d2c-b404-4e9cb9fd02c4.xhtml),
    *Web Browser Forensics,* you may guess what we are going to do next. Yes, webmail
    artifacts can be extracted from `pagefile.sys`, `swapfile.sys` and `hiberfil.sys`.
    So you can use one of these files as the data source, or the whole forensic image
    - AXIOM will find and parse data from these files automatically.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We can start the process by following the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Process your data source with AXIOM Process; don''t forget to include `pagefile.sys`
    and `hiberfil.sys`, and make sure mail artifacts are checked. Once the processing
    phase is finished, go to AXIOM Examine and look at the EMAIL section. Here you
    will find extracted email artifacts, including webmail, in our case Gmail, as
    shown in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/893c8695-94df-4aef-a778-65ccdf770a50.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.15\. Extracted webmail artifacts
  prefs: []
  type: TYPE_NORMAL
- en: As you can see, 194 Gmail Webmail artifacts have been extracted. Let's check
    the source of these artifacts, the first artifact in particular. Click on the
    artifact and check the EVIDENCE INFORMATION section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a6586594-0bf6-437c-8806-d19b5e506a02.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.16\. Artifact information
  prefs: []
  type: TYPE_NORMAL
- en: Look at the preceding figure and you'll see that the artifact is extracted from
    hiberfil.sys. You can also see the addresses, which are very important for documentation.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Magnet AXIOM walks through the hiberfil.sys (or pagefile.sys) file and extracts
    available webmail artifacts, such as Google's Gmail, Microsoft's Hotmail/Outlook.com,
    and Yahoo Mail.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Modern windows hibernation file analysis:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://www.504ensics.com/uploads/publications/modern-windows-hibernation.pdf](https://www.504ensics.com/uploads/publications/modern-windows-hibernation.pdf)'
  prefs: []
  type: TYPE_NORMAL
- en: Skype forensics with Belkasoft Evidence Center
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: On modern Windows systems Skype is installed by default, so it's very important
    for a forensic examiner to extract user data from this application. This can be
    calls, messages, transferred or received files, and so on. In this recipe, we
    will show you how to parse these valuable artifacts with Belkasoft Evidence Center.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'First of all, you should get a Skype profile folder. Again, you can use a forensic
    image, but to save time for testing purposes, we recommend using a profile folder
    as the data source. You can find Skype profile folders (yes, there can be more
    than one folder, as multiple accounts can be used on the same device) here:'
  prefs: []
  type: TYPE_NORMAL
- en: '`C:\Users\%USERNAME%\AppData\Roaming\Skype\`'
  prefs: []
  type: TYPE_NORMAL
- en: Once you get it, make sure Belkasoft Evidence Center (valid licence or trial)
    is installed on your workstation, and we are ready to start.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We can start the process by following the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Create a new case and add the profile folder you previously exported as the
    data source. Use **Selected folder**, as shown in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d3b81acb-3e56-4e1d-8e94-de64ed38d502.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.17\. Adding the data source in Belkasoft Evidence Center
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s choose the right data type. We have a Skype profile folder, so go to
    Chats, find Skype, and tick it. Click Finish and wait a bit for the data to be
    parsed, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/075f0d8f-84da-4952-9faf-c67b237d8e58.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.18\. Choosing data types in Belkasoft Evidence Center
  prefs: []
  type: TYPE_NORMAL
- en: Once the data is processed, you can work with the Overview or Case Explorer
    tabs to analyze the extracted data, including calls, messages (including voice),
    pictures, and so on. It's important to note that Belkasoft Evidence Center also
    extracts deleted messages from the Skype database (main.db), and analyzes `chatsync`
    files, which may include messages, that are not included in the main database.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Belkasoft Evidence Center processes the data source specified by a computer
    forensic examiner, and extracts Skype artifacts from the available sources, including
    SQLite free lists, unallocated space, `chatsync` files, `pagefile.sys`, `hiberfil.sys`,
    and so on.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Belkasoft Evidence Center Trial:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://belkasoft.com/trial](https://belkasoft.com/trial)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Recovering Destroyed SQLite Evidence, iPhone/Android Messages, Cleared Skype
    Logs:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://belkasoft.com/recover-destroyed-sqlite-evidence-skype-and-iphone-logs](https://belkasoft.com/recover-destroyed-sqlite-evidence-skype-and-iphone-logs)'
  prefs: []
  type: TYPE_NORMAL
- en: Skype forensics with SkypeLogView
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: It's always good to have some free pieces of software in your toolkit. There
    are some free and open source tools for Skype forensics, and one of them is SkypeLogView
    by NirSoft. You are already familiar with some NirSoft tools, and in this recipe
    we will show you how to use SkypeLogView for Skype forensicating.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Download SkypeLogView from NirSoft's website (check the *See also* section for
    the download link). At the time of writing, the most recent version of the tool
    is 1.55\. Unpack the archive and you are ready to go. You can use the Skype profile
    folder exported for the previous recipe.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We can start the process by following the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Start the tool, and you will see a data source window, like the one in the
    following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c7471c59-0502-4fa0-9bea-fbaa816b43ce.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9.19\. Adding the data source in SkypeLogView
  prefs: []
  type: TYPE_NORMAL
- en: 'All you need now is to click OK and the magic begins, as shown in the following
    figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c12f2666-7b58-4e9e-8e58-c303f0de0c9a.png)'
  prefs: []
  type: TYPE_IMG
- en: Of course, you can sort the extracted data using different columns. If you want
    the timestamp to be displayed in GMT, go to **Options - Show Time in GMT**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finally, you can create an HTML report. To do this, go to **View - HTML Report**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: SkypeLogView uses an examiner specified folder and extracts available Skype
    artifacts, such as chats, voicemails, calls, and so on. Also an examiner can create
    an HTML report for all or for user-selected artifacts.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'SkypeLogView download page:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://www.nirsoft.net/utils/skype_log_view.html](http://www.nirsoft.net/utils/skype_log_view.html)'
  prefs: []
  type: TYPE_NORMAL
