<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Parsing Third-Party Application Files</h1>
                </header>
            
            <article>
                
<p>Third-party applications have taken the smartphone community by storm. Most smartphone owners have more than one app on their device that they rely on to chat, game, get directions, or share pictures. According to <a href="https://www.statista.com/statistics/276623/number-of-apps-available-in-leading-app-stores/" target="_blank"><span class="URLPACKT">https://www.statista.com/statistics/276623/number-of-apps-available-in-leading-app-stores/</span></a>, there are almost 5 million apps worldwide for various smartphones. Apple's App Store offers approximately 1.8 million apps, Google Play offers 2.47 million, Amazon offers 600,000, and Windows offers 670,000. This number is expected to grow exponentially through 2020.</p>
<p>The goal of this chapter is to introduce you to the various applications seen on Android, iOS devices, and Windows Phones. Each application will vary due to versions and devices, but their underlying structures are similar. We will look at how the data is stored and why preference files are important to your investigation.</p>
<p>We will cover the following topics in detail in this chapter:</p>
<ul>
<li>Different third-party applications</li>
<li>How applications are stored on iOS devices</li>
<li>How applications are stored on Android devices</li>
<li>Windows Phone application storage</li>
<li>How to use both commercial and open source solutions to parse application data</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction to third-party applications</h1>
                </header>
            
            <article>
                
<p>Third-party applications are an integral part of mobile device investigations; often, the key artifacts seem to exist within an application. This requires you to understand where application data is stored on the device, how application data is saved for that platform, and which tool best helps to uncover the evidence. Manual parsing is often a key factor when examining third-party applications on any smartphone. While some commercial tools, such as Belkasoft Evidence Center or Magnet AXIOM, are known for application parsing support, no tool is perfect and it's virtually impossible for tools to keep up with the frequent updates that are released for each application.</p>
<p>Most often, you'll find that the commercial tools available parse the most popular applications on the market. For example, when Facebook purchased WhatsApp, Belkasoft, Cellebrite, Magnet Forensics, and Oxygen Forensics started supporting this application. Facebook is extremely popular, but data isn't always extracted or parsed, due to security features that are built into the app—this is where all apps differ. Our best advice is to test, test, and test! You can download an app, populate data, and examine the results to see how your view of the evidence compares to your actual evidence. This practice will enable you to understand how updates change the artifacts, how evidence locations change, and how to manually extract artifacts that your tools are missing. Additionally, reverse-engineering an app and analyzing its code will help you to identify where the data is stored and how it is stored.</p>
<p>Most applications do not require a data plan for use; they can fully function via a Wi-Fi network, which means that apps can still function if a person travels to a region in which their device would not usually work. For example, when I travel, I rely on Skype, Viber, and WhatsApp to call and text family and friends. To use these apps, all that is required is that my smartphone is connected to Wi-Fi.</p>
<p>We have already addressed some third-party application extraction and analysis tips in this book. In addition to this, we discussed the files that need to be examined to understand and analyze application data in <a href="4f92f4a2-f8f9-4274-96eb-da9174fc6772.xhtml" target="_blank">Chapter 5</a>, <em>iOS Data Analysis and Recovery</em>; <a href="5bb0cc1b-d89c-408a-b2c9-6b946519151d.xhtml" target="_blank">Chapter 10</a>, <em>Android Data Analysis and Recovery</em>; <a href="882decf1-336b-416f-98ab-dadecc71efef.xhtml" target="_blank">Chapter 11</a>, <em>Android App Analysis, Malware, and Reverse Engineering</em>; and <a href="27f60ffc-e0b7-4aa1-8737-541ca9569908.xhtml" target="_blank">Chapter 12</a>, <em>Windows Phone Forensics</em>. This chapter will dive deeper into the applications and relevant files and will prepare you for the analysis of these artifacts. Each application has a purpose. Most tools provide support for the most popular application in each category. The rest is up to you. A quick look at the applications presented by the Oxygen Forensic Detective tool is shown in the following screenshot. As expected, these are not all of the applications that are present on the device; rather, these are just the ones that the tool knows how to parse:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1279 image-border" src="assets/49408e34-8b84-4cd5-8764-a977cde19a72.png" style="width:53.17em;height:35.42em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Example of applications parsed by Oxygen Forensic Detective on an Apple device</div>
<p>In the next section, we will analyze some of the widely used chat applications. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Chat applications</h1>
                </header>
            
            <article>
                
<p>Chat applications are among the most common applications on the market. These applications provide users with the ability to chat or call outside the standard services offered by the network service provider. These apps may often be more secure compared to other apps. By secure, we mean that the apps may offer encryption, private profiles, private group chats, and more. Additionally, these apps enable the user to message or call others without the need for a data plan, as Wi-Fi provides all of the access that they need. Facebook Messenger, WhatsApp, Skype, Tango, and Snapchat are some of the more popular applications.</p>
<p>Parsing artifacts from chat applications is not always simple. Often, multiple tools and methods will be required to extract all of the data within them. Commercial tools may only parse a portion of the data, forcing you to learn how to examine and recover all data or miss evidence. In the following screenshot, Oxygen Forensic Detective is being used to parse chat messages from Tango on an Android device. Note that the message does not show the image in the table. However, this image can be <em>pieced</em> back into the message (notice the screenshot that is shown with an arrow pointing to the message to which it belongs), to provide an overall picture of what was being shared in a conversation. This was a manual process and was not performed by the tool:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/c930b1ea-e278-4655-9f7d-8740d267df75.png" style="width:55.83em;height:32.83em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">An example of piecing application chat logs back together</div>
<p>Next, we will take a look at GPS apps. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">GPS applications</h1>
                </header>
            
            <article>
                
<p>Most users branch out from their standard phone apps for GPS support. This includes getting directions to locations and obtaining maps for areas of interest. Common GPS applications include Waze and Google Maps. Waze goes beyond just providing directions, as it also alerts the user to road hazards, traffic, and police officers that are to be found along the route they are driving:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1280 image-border" src="assets/ccc15cc6-3637-4f76-928b-14f0ddcd735a.png" style="width:20.75em;height:34.08em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">The Waze application</div>
<p>Other applications that store location information include Twitter, Instagram, Facebook, and Foursquare. These applications enable a user to alert friends and followers to their location when they create a post or share an image or video. All of these transactions are tracked within the app. Understanding this is key to uncovering additional artifacts that are not reported by your forensic tool.</p>
<p>When examining location information from GPS applications, it is best to assume that you need to manually examine the databases and preference files that are associated with that application. We recommend using your forensic tool to triage the data on the device and then dive deeply into the artifacts, which will be discussed later in this chapter. An example of Waze being parsed by UFED Physical Analyzer can be found in the following screenshot. Here, we can see that the user had 5 favorite locations, 74 mapped locations, and 70 recent directions. All of this information must be manually verified if it pertains to the investigation. This is because the tool cannot determine whether the user typed the address, whether it was suggested, or whether the user even traveled to that location. Proper skills are required by you to tie a user to a specific location, and this takes more than a forensic tool:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/ebd2ec73-72a1-41ba-bf0c-5be1d329e63f.png" style="width:15.08em;height:16.83em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">The Waze application in UFED Physical Analyzer</div>
<p>We will now analyze some of the popular secure messaging apps. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Secure applications</h1>
                </header>
            
            <article>
                
<p>If data is secure and self-destructing, did it ever even exist? Ignore the claims of data retention and hunt for that data, as these apps often make claims that are simply untrue. Although applications are designed with security in mind, updates are released quickly and quality assurance checks may not be strong enough to catch everything. On occasion, you will find an app with an encrypted or non-existent database, but the file includes a journal, write-ahead logs, or shared memory files that contain portions of chats that were supposed to be encrypted. In addition to this, the user can save media files that are shared, take screenshots of conversations, and do much more. Often, you may uncover the images, audio, and video files that were shared and supposed to be encrypted.</p>
<p>Some popular secure messaging applications include Telegram, Wickr, and Signal. Some of these are encrypted, where nothing is recoverable. However, this all depends on the device, the OS running on the smartphone, and the version of the app. The security level of these apps is publicly advertised, but again, take this with a grain of salt. You should always assume that there could be a vulnerability in the app that may provide you with access forensically. Dig for this evidence!</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Financial applications</h1>
                </header>
            
            <article>
                
<p>Applications that utilize financial information, such as credit card information and personal banking, are required to be encrypted and secure. iOS devices will not acquire these apps without an Apple ID and password. Even if you have the user's Apple ID and password, the data extracted should still be encrypted. Some examples of financial applications include Google Pay, Microsoft Wallet, PayPal, Apple Pay, and in-app purchases. When you examine a device, you may see that the app was installed with the associated application metadata, but account information and transactions will not be accessible.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Social networking applications</h1>
                </header>
            
            <article>
                
<p>Commercial support for social networking applications is strong as they are the most popular apps downloaded from app stores. These applications allow users to make posts, share locations, chat publicly and privately, and essentially catalog their lives. Common social networking applications include Facebook, Twitter, and Instagram. Often, users will enable one app, such as Instagram, to have access to Facebook and Twitter so that posting is seamless. Hence, when examining devices, the user may find multiple copies of the same file or conversation due to the sharing that takes place between apps.</p>
<p>When examining these apps with commercial tools, it is common for chats and contacts to be parsed, meaning that other data may be overlooked. Again, this means you must look at the data dump to ensure that nothing is missed. As an example, we are going to take a look at Twitter. This application stores a lot of information that may require more than one tool to parse. Additionally, the user may have to manually examine the database files to ensure that all artifacts have been recovered.</p>
<p>Let's take a look at what the tool was able to extract. As stated several times in this book, start with what the tool is telling you is installed, and then formulate keywords and methods to dig deep into the filesystem. We can see the user account information for Twitter, as well as the file path where this data is being extracted, in the following screenshot:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/a888cff6-5849-4f5b-a9dd-de45d0032ec1.png" style="width:31.42em;height:43.83em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Twitter as parsed by Magnet AXIOM</div>
<p>The next logical step is to view what the tool can tell you about the application and how it was used. Magnet AXIOM provided the following information for Twitter account usage. Note that both public tweets and private messages (DMs) are recovered:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/2d1b1bb4-aec4-4736-ba9b-89758f31e1b0.png" style="width:21.42em;height:7.17em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Twitter usage by Magnet AXIOM</div>
<p>After examining what was parsed by the tool, the database files should be examined to ensure that nothing was missed. This is not always simple, as each account and function may have a unique database. By function, we mean that contacts may be stored in one database while chats and account information are stored in another. Once you become more familiar with common applications, you will know where to look first.</p>
<p>In the following screenshot, we can see all of the databases that are associated with Twitter. Again, start with what you know and dig deeper:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/18ddd4ee-fc75-447a-a810-1934b38a18e5.png" style="width:57.08em;height:25.67em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Twitter databases containing user activity</div>
<p>Each database may contain unique data that can be parsed for additional artifacts. These applications also contain unique <kbd>user_id</kbd> values, which can be used as keywords to search for other devices with traces of communication within an investigation.</p>
<p>Custom queries can be written to parse Twitter databases of interest. A good example of how to do this is shown as follows. This query is specific to parsing Twitter contacts:</p>
<pre>SELECT _id AS "Index", <br/>user_id AS "User ID", <br/>username AS "Username", <br/>name AS "Name", <br/>datetime (profile_created/1000,'UNIXEPOCH','localtime') AS "Profile Created", <br/>description AS "Twitter Description", <br/>web_url AS "Website URL",<br/>location AS "Location",<br/>followers AS "Followers", <br/>friends AS "Following", <br/>users.statuses AS "Number of Tweets",<br/>image_url AS "Profile Image URL", <br/>datetime (updated/1000,'UNIXEPOCH','localtime') AS "Profile Updated" <br/>FROM users</pre>
<p>So far, we have looked at various kinds of third-party apps and how tools can aid an investigator in extracting the data. We will now look at some of the fundamental concepts that will help an investigator while analyzing the data. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Encoding versus encryption</h1>
                </header>
            
            <article>
                
<p>The terms <em>encoding</em> and <em>encryption</em> are used so frequently when discussing applications and smartphone data that they are often confused. Encoding is essentially the process of obfuscating a message or piece of information to appear as raw code. In some cases, the goal of encoding is to make the data unrecognizable to the computer or the user. In reality, the primary goal of encoding is to transform the input into a different format using a publicly available scheme. In other words, anyone can easily decode an encoded value. Encryption, however, transforms the data using a key to keep its content confidential. So, encrypted text can only be reversed if you have the key.</p>
<p>Most applications claim that they encrypt data or that the data is never saved to disk. While this is true for some, most are simply encoded. Encoding options can vary, but the most common option for smartphone data is <kbd>Base64</kbd>. Messaging apps often rely on <kbd>Base64</kbd> encoding to make the data appear to be hidden or <em>safe</em>. A common artifact of <kbd>Base64</kbd> is the padding of the data with <kbd><strong>=</strong></kbd> when the encoded bytes are not divisible by three.</p>
<p>A few years ago, Oxygen Forensics and Autopsy were two of the few tools that supported the decoding of <kbd>Base64</kbd> payloads from applications derived from smartphones. For these tools to parse the data, they must support the application containing the encoding. Currently, MSAB, UFED Physical Analyzer, and Magnet IEF provide <kbd>Base64</kbd> decoding support.</p>
<p>An example of <kbd>Base64</kbd>-encoded messages is shown in the following screenshot. This data is from the Tango chat application:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/f655051e-181e-4305-b4c4-6a01de20cf84.png" style="width:53.67em;height:11.75em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Base64-encoded Tango messages</div>
<p>Encryption is a bit more difficult as the app itself may not even provide access to the encrypted data. For example, you may find that the database directory or the cells containing the encrypted data are simply empty. Occasionally, you will have access to the encrypted blobs within the databases, but this data cannot always be decrypted. Again, when you face encrypted data, look elsewhere. Have you examined the journal and write-ahead logs? Have you examined the cache and media directories? Have you examined the SD card? These are common questions you will often have to ask yourself to ensure that you are not relying on your forensic tools too much and that you are covering your bases to ensure nothing is overlooked. As we've explained, start with what you know. We know that the cache and database directories store user data, so this is a great place to start your manual examination, as you can see in the following screenshot:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/f1f11126-50f7-40e9-9b59-7b876f339b45.png" style="width:13.17em;height:23.83em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Data storage locations for applications</div>
<p>In the following sections, we will cover how applications store their data within the device and the significance of various types of storage options. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">iOS, Android, and Windows Phone application data storage</h1>
                </header>
            
            <article>
                
<p>Almost all applications rely on SQLite for data storage. These databases can be stored internally on the device or the SD card for relevant phones. When SQLite is used, temporary memory files are commonly associated with each database to make SQLite more efficient. These files are <span><strong>rollback journals</strong> (<strong>JOURNAL</strong>),</span> <strong>Write-Ahead Logs</strong> (<strong>WAL</strong>) and <strong>Shared Memory</strong> (<strong>SHM</strong>) files. These files may contain data that is not present in the SQLite database. We can see several WAL and SHM files associated with various WhatsApp database files in the following screenshot:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/bc0d34c6-f5a1-4571-b8d5-4717dc3718e3.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">An SHM file and WAL example</div>
<p>In addition to SQLite databases, other devices rely on Plist, XML, JSON, and DAT files for application data storage, account data storage, purchase information, and user preferences. These files will be discussed in the Android, iOS, and Windows Phone sections of this chapter.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">iOS applications</h1>
                </header>
            
            <article>
                
<p>Apple relies on SQLite and Plist as common locations for application data storage. On occasion, JSON files will be used for application data. Examining applications recovered from an iOS device can be overwhelming. We suggest you start with what you know and what your tool is telling you. Examine the <span class="packt_screen">Installed Applications</span> listed by your tool of choice. From here, go directly to the applications directory and ensure that nothing is being overlooked. When a user deletes an app, the databases often remain and the link to the installed application is simply broken. Examining all areas of the iOS device will prevent you from missing data:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/1b5a1602-8c76-4f5f-a509-a4a6773c3430.png" style="width:22.33em;height:37.83em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Installed applications on an iPhone</div>
<p>After examining the installed applications, search the <kbd>Library</kbd> and <kbd>Documents</kbd> directories for any relevant Plist files that may contain application artifacts. Finally, examine the <kbd>Media</kbd> directory on the iPhone as well as the one associated with the app to recover additional artifacts, such as shared photos, videos, audio files, and profile pictures. In the following screenshot, we are examining the <kbd>Media</kbd> directory associated with the WhatsApp application:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/aa9b77c5-5c14-4590-84cb-67041f507fd8.png" style="width:28.25em;height:20.42em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Application data on an iPhone</div>
<p>We will now take a look at data storage in Android applications. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Android applications</h1>
                </header>
            
            <article>
                
<p>Android devices rely heavily on SQLite for application storage. The preference files for each application are often in the DAT or XML file formats. More so than an iOS device, examining applications on an Android device may be one of the most tedious tasks. This is due to the various locations where data may be stored. The best place to start is with a tool that will provide a listing of what is installed on the device. Next, go to the subdirectories off of the <kbd>/Root</kbd> directory. Remember, these applications may possess unique names and may be difficult to locate.</p>
<p>You may have to research the application to gain a better understanding of the filenames that are associated with each of them. The following screenshot is an example of application directories on an Android device:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/32bdadd7-354e-42df-bae9-7abdbb5b3e17.png" style="width:18.75em;height:26.08em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Application data on an Android device</div>
<p>Each of these application directories will contain a lot of data to examine. We recommend starting with the <kbd>Databases</kbd> and <kbd>Cache</kbd> directories and then expanding your analysis to other locations on the device. The next locations to examine include the <kbd>Media</kbd> and <kbd>Cache</kbd> partitions. If the data appears to be missing or is claimed to have been deleted, do not forget to examine the <kbd>Downloads</kbd> directory on the device and SD card.</p>
<p>Application data can exist in several locations in the <kbd>Media</kbd> directories. Using a tool, such as UFED Physical Analyzer, which provides keyword-searching capabilities spanning beyond parsed items, will really help to locate artifacts pertaining to specific applications. We are looking at the large amount of data stored in the <kbd>Media</kbd> directory on an Android device in the following screenshot. This data is unique from what is stored in the application directories that were discussed previously. Each location needs to be thoroughly examined to ensure that nothing is missed. It is important that you take what you learned in previous chapters to analyze Android application data:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/434b512d-f3fa-454e-bac4-11c15e28b915.png" style="width:21.75em;height:27.00em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Unique application data in the Media directory</div>
<p>We will now look at apps installed on Windows Phone and their acquisition. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Windows Phone applications</h1>
                </header>
            
            <article>
                
<p>Applications found on Windows Phones are no different from those found on iOS and Android devices. SQLite is the most common format used for data storage. However, not all devices allow for SQLite files to be stored internally on the phone. For these devices, all application data will be found on the SD card. Some may view this as lucky because it saves us from having to examine several locations on the device, but the SD card and the applications themselves may be encrypted.</p>
<p>Where possible, it is best to remove the SD card and acquire it using a forensic tool. When this is not possible, the next best method would be to try to acquire the SD card through the phone using a forensic tool. Again, this will often result in missed data. By the way of a final effort, live analysis can be completed by mounting the device and using Windows Explorer to view the applications stored on the device and SD card, as discussed in <a href="27f60ffc-e0b7-4aa1-8737-541ca9569908.xhtml" target="_blank">Chapter 12</a>, <em>Windows Phone Forensics</em>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Forensic methods used to extract third-party application data</h1>
                </header>
            
            <article>
                
<p>Almost all commercial tools will attempt to support the extraction of third-party applications. We recommend that you test your tools thoroughly and often, if you rely on tool output for your investigative results. This is because the apps are updated so frequently that it is nearly impossible for the tools not to miss something. You must learn about the applications, how they work, and how the devices store data for each app. We strongly recommend that you use your tool to triage the case and then dive into the data to manually extract anything that the tools miss. Make sure that you only include factual data in your forensic report and not everything that the tools parse, as the tools cannot decipher the difference between a device and human creation. Only a trained examiner can do this with confidence.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Commercial tools</h1>
                </header>
            
            <article>
                
<p>As you have seen in this book, there are many tools that can handle the job of smartphone forensics. However, there are a few that really shine when it comes to parsing application data. Magnet AXIOM, Oxygen Forensic Detective, and UFED Physical Analyzer are a few that do a good job of recovering data from the application categories discussed in this chapter. We will take a quick look at how to leverage each of these tools to parse application data. Keep in mind that these tools will not find every application and will not parse all data for applications.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Oxygen Forensic Detective</h1>
                </header>
            
            <article>
                
<p>Oxygen Forensic Detective can be used to examine application data. For this example, we are assuming that acquisition is complete and we are simply attempting to analyze the data. Note that Oxygen is capable of acquiring and analyzing smartphones. In this example, we acquired the device with Cellebrite UFED and analyzed it with Oxygen. To load a data dump of a device and examine its application artifacts, perform the following steps:</p>
<ol>
<li>Launch Oxygen Forensic Detective.</li>
<li>Select the <span class="packt_screen">Import File</span> option and choose your image. Multiple image formats are supported for ingestion into Oxygen.</li>
<li>After parsing is complete, start examining the parsed applications:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/642330ba-f606-4cab-955d-3118c5f06be6.png" style="width:20.33em;height:42.08em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">The Oxygen Forensic Detective application view</div>
<ol start="4">
<li>Next, start examining applications of interest by clicking on the application and examining all of the associated files.</li>
</ol>
<ol start="5">
<li>Once you select the application, you will be presented with the data that was parsed and the full file path from where the data was extracted. Use this path to manually verify the findings. We are looking at the Pinterest application in the following screenshot. Note how the container, file, and table of interest are provided and hyperlinked for the user. The tool is even encouraging you to dig deeper and verify the findings:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/a23b2beb-e972-4f38-8ab0-5f52a70f71f2.png" style="width:38.83em;height:25.42em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Oxygen Detective Pinterest example</div>
<p style="padding-left: 60px">Oxygen Detective has built-in features for keyword searching, bookmarking, and reporting. In addition, the SQLite Database and Plist Viewer will provide you with a method for examining relevant application data</p>
<ol start="6">
<li>Report all account information, chats, messages, locations, and any other data of interest, as this provides relevance to your investigation.</li>
</ol>
<p>The next tool that we will be looking at is Magnet AXIOM.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Magnet AXIOM</h1>
                </header>
            
            <article>
                
<p>Magnet AXIOM has been known as one of the leaders in internet and application parsing for digital media. It is just as strong with mobile devices. Again, one tool cannot do the job, but AXIOM has proven to be the strongest and parses the most applications from Android, iOS, and Windows Phones. To use AXIOM to examine application artifacts, perform the following steps:</p>
<ol>
<li>Launch AXIOM, create a new case, and then select <span class="packt_screen">MOBILE</span> (note that if <span class="packt_screen">MOBILE</span> is grayed out, you need to obtain a license that provides mobile support from Magnet Forensics):</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/4f5feaea-1537-44b5-837b-babc73d2f642.png" style="width:32.83em;height:14.75em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Selecting the evidence source</div>
<ol start="2">
<li>Select <span><span class="packt_screen">LOAD EVIDENCE</span></span> and navigate to your image file. More than one image can be loaded and parsed at the same time.</li>
</ol>
<ol start="3">
<li>Select <span><span class="packt_screen">GO TO ARTIFACT DETAILS</span></span> and determine what you want to parse. We recommend selecting all of the apps:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/b455f982-2e6f-4d23-b930-b48af873c7b6.png" style="width:74.33em;height:35.17em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Magnet AXIOM supported artifacts</div>
<ol start="4">
<li>Select <span class="packt_screen">ANALYZE EVIDENCE</span>.</li>
</ol>
<ol start="5">
<li>Once complete, you can use Artifacts:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/19788e19-81b0-4f25-87f6-53dbbe9618ab.png" style="width:16.33em;height:31.58em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Application Artifacts in Magnet AXIOM</div>
<p>The first step in the examination is to review what has been parsed by AXIOM. In the preceding screenshot, we can see that Telegram was parsed. Start your examination in the most relevant location. For example, if you are looking for <span class="packt_screen">Telegram Chats</span>, go right to that location and start examining the artifacts. Note that <span class="packt_screen">Messages</span> and <span class="packt_screen">Chats</span> are pulled into two different categories. This is common when private messaging is used. All relevant application containers should be examined. Additionally, AXIOM provides the full file path from which the data was recovered. Use another tool to navigate to this file for verification and manual examination.</p>
<p>AXIOM also provides logical keyword search (it will search what it can parse and nothing else), bookmarking, and reporting. Make sure that you only report factual application artifacts and incorporate these into your final forensic report.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">UFED Physical Analyzer</h1>
                </header>
            
            <article>
                
<p>Physical Analyzer is one of the most well-known mobile forensic tools on the market. This tool is one of the best platforms to manually conduct an examination in addition to leveraging the data parsed by the tool. For application analysis, Physical Analyzer is good at parsing chats and contacts for each supported application. For data that is not parsed, Physical Analyzer provides an analytical platform that enables the user to browse the filesystem to uncover additional artifacts. Keyword searching is robust in this tool and is capable of searching raw hex as well as parsed data. In addition, a SQLite viewer is included.</p>
<p>To conduct a forensic examination of application data in Physical Analyzer, perform the following steps to get started:</p>
<ol>
<li>Launch Physical Analyzer by double-clicking on the UFED shortcut image file or by double-clicking the tool icon.</li>
<li>Load the image file and wait until parsing completes.</li>
<li>Examine the parsed artifacts, as shown in the following screenshot:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/5a0d3c0b-ce5a-4147-8d02-8c50eba95407.png" style="width:13.75em;height:27.92em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Data parsed by Physical Analyzer</div>
<p>We recommend examining what is parsed and referring to the hyperlink of where the data is being extracted. Navigate to this path and then examine the entire application directory.</p>
<p>To find the application directory, leverage built-in keyword searching capabilities to aid in the investigation. Remember, you may have to conduct research to determine the filenames associated with the app if this is not apparent. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Open source/free tools</h1>
                </header>
            
            <article>
                
<p>For those on a budget, it is possible to examine application data from smartphones using open source solutions and cheap tools. These solutions are more difficult to use, and they are often not the answer for those new to forensics who need the assistance of a tool in data extraction and analysis. Examining application data is tedious, and if you do not know where to look, you will likely need to spend some money to get a head start. Tools such as Andriller can be purchased for around $500. While this is not free, it's also not $10,000, which is what some of the other commercial tools cost. In the following section, we will cover a few of our favorite tools that are useful in parsing application data from smartphones.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Working with Autopsy</h1>
                </header>
            
            <article>
                
<p>Autopsy is one of the best tools for filesystem examinations. Unfortunately, iOS parsing is not provided in Autopsy, but it still may be useful for filesystem images. Autopsy can be downloaded from <a href="http://sleuthkit.org/autopsy/" target="_blank"><span class="URLPACKT">http://sleuthkit.org/autopsy/</span></a>. When using Autopsy, the Android Analyzer module will parse some application data from the device. Let's look at how to use Autopsy for Android image analysis.</p>
<p>To use Autopsy, download the software and install it on a Windows machine and follow these instructions. Make sure that you are always using the latest version:</p>
<ol>
<li>Launch Autopsy.</li>
<li>Create a new case:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/3b909366-f2b9-4eb0-bdcc-8a9864017ded.png" style="width:33.42em;height:12.25em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Autopsy case creation</div>
<ol start="3">
<li>Select <span class="packt_screen">Next</span> and then click on <span class="packt_screen">Finish</span>.</li>
<li>Navigate to your image file and select <span class="packt_screen">Next</span>.</li>
<li>Select the modules that you wish to run. <span class="packt_screen">Keyword Search</span> and <span class="packt_screen">Android Analyzer</span> will be the most fruitful for an Android device:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/e2a81c28-ed26-43f0-98c0-cdb8ae6fe76a.png" style="width:33.00em;height:21.17em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Autopsy module selection</div>
<p>Ingest Modules are tools built into Autopsy that can be run when the case has started or at any point afterward. The default modules in this version of Autopsy are as follows:</p>
<ul>
<li><span class="packt_screen">Recent Activity</span>: This extracts recent user activity such as web browsing, recently used documents, and installed programs.</li>
<li><span class="packt_screen">Hash Lookup</span>: This identifies known and notable files using supplied hash databases, such as a standard NSRL database. It also allows importing custom hash databases.</li>
<li><span class="packt_screen">File Type Identification</span>: This matches file types based on binary signatures.</li>
<li><span class="packt_screen">Archive Extractor</span>: This extracts archive files (<kbd>.zip</kbd>, <kbd>.rar</kbd>, <kbd>.arj</kbd>, <kbd>.7z</kbd>, <kbd>.gzip</kbd>, <kbd>.bzip2</kbd>, and <kbd>.tar</kbd>). It automatically extracts these file types and puts their contents into the directory tree.</li>
<li><span class="packt_screen">EXIF Parser</span>: This ingests JPEG files and retrieves their EXIF metadata.</li>
<li><span class="packt_screen">Keyword Search</span>: This performs file indexing and periodic search using keywords and regular expressions in lists. It allows the loading of custom keywords/lists.</li>
<li><span class="packt_screen">Email Parser</span>: This module detects and parses <kbd>mbox</kbd> and <kbd>pst</kbd>/<kbd>ost</kbd> files and populates email artifacts in the blackboard.</li>
<li><span class="packt_screen">Extension Mismatch Detector</span>: These are flag files that have a non-standard extension based on their file types.</li>
<li><span class="packt_screen">E01 Verifier</span>: This validates the integrity of E01 files.</li>
<li><span class="packt_screen">Android Analyzer</span>: This extracts Android system and third-party app data.</li>
<li><span class="packt_screen">Interesting Files Identifier</span>: This identifies interesting items, as defined.</li>
</ul>
<p>Also, you can install third-party modules for Autopsy. Some of them are really useful for Android forensics. A good example is Parse SQLite DB by Mark McKinnon. This module parses any SQLite database it finds and <span>imports it into the extracted content. This and other modules can be downloaded from this GitHub: </span><a href="https://github.com/markmckinnon/Autopsy-Plugins" target="_blank">https://github.com/markmckinnon/Autopsy-Plugins</a></p>
<p>Autopsy provides access to filesystem data faster than any commercial or open source tool available. Knowing where to go from there is the hard part. So, again, start with anything that is in the extracted content and then dive into the filesystem to examine the files discussed in this book and any relevant application data, as shown in the following screenshot:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/9777a725-0ae7-4458-ac1f-2982a5ce00f0.png" style="width:9.92em;height:36.83em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Browsing the filesystem with Autopsy</div>
<p>Once you have identified applications of interest, start with what is parsed and then examine the relevant database, cache, and preference files. Autopsy includes basic SQLite Viewer that can be used for triage purposes. If you need to run queries, we recommend using DB Browser for SQLite or browsers included in commercial products, for example, Belkasoft Evidence Center, especially if you want to analyze data from free lists and unallocated space.</p>
<p>Android Analyzer can decode some artifacts automatically, for example, contacts, calls, and SMS. The following screenshot shows the results of the decoded SMS messages:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/ee4af3a4-2329-486f-9b48-ca21b9216f06.png" style="width:70.83em;height:17.75em;"/></div>
<div class="mce-root packt_figref CDPAlignCenter CDPAlign">SMS messages decoded by Autopsy</div>
<p>Now, we will be looking at some more methods of extracting data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Other methods of extracting application data</h1>
                </header>
            
            <article>
                
<p>One of the easiest ways to parse application data is to create custom SQLite queries and Python scripts to parse data of interest. We have discussed several suggestions and examples of queries and scripts throughout this book. Python is one of the best solutions because it is free and we have full access to its libraries. One thing to keep in mind is that our scripts have to be updated frequently to keep up with application updates. Also, make sure that your encoding schemas are correct to prevent application artifacts from being missed or not interpreted correctly.</p>
<p>In addition to Python scripts, free parsers that support application extraction already exist. WhatsApp Extract is a free tool for both Android and iOS that will extract WhatsApp application data from devices. Often, this free tool will extract more data than the commercial solutions, depending on the permissions the user allocated during installation. Others, such as Mari DeGrazia (<a href="http://az4n6.blogspot.in/p/downloads.html" target="_blank">http://az4n6.blogspot.in/p/downloads.html</a>), Adrian Leong (<a href="https://github.com/cheeky4n6monkey/4n6-scripts" target="_blank"><span class="URLPACKT">https://github.com/cheeky4n6monkey/4n6-scripts</span></a>), Sarah Edwards (<a href="https://github.com/mac4n6" target="_blank">https://github.com/mac4n6</a>), and Alexis Brignoni (<a href="https://github.com/abrignoni" target="_blank">https://github.com/abrignoni</a>) have developed scripts to parse applications, recover deleted data from SQLite free pages, decode <kbd>Base64</kbd>, and more. We recommend using what is already available before developing your own.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we learned about how to successfully parse and extract data from popular third-party apps. Many apps are not what they claim to be. Never trust what you read about apps, as quality assurance testing across apps is not consistent, and we have determined several vulnerabilities and security flaws over the years that provide us with methods of piecing application data back together. Also, application updates will change the way we need to look at the data found. Understanding each smartphone and how it stores application data is the first step toward successfully examining applications on smartphones. Knowing that updates may change data locations, encoding, and encryption, as well as how your tool functions, is one of the hardest concepts for examiners to grasp. It is your job to learn the capabilities of the application to uncover the most data from the mobile device.</p>
<p>Understanding how an application works is hard enough without having to consider how to extract artifacts. As you have read in this book, there are many ways to parse data from smartphones. One tool is never enough, and the reality is that mobile forensics can be expensive. We hope that we have provided you with a practical guide that teaches you how to acquire and analyze artifacts that are recovered from smartphones. Take what you've learned and apply it immediately to your methods to conduct mobile forensics or use it to make you more prepared in your next job. Remember that practice, testing, and training will make you better at your job and will help you to perfect the art of mobile forensics.</p>


            </article>

            
        </section>
    </body></html>